
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../terminal-shortcut/">
      
      
        <link rel="next" href="../swap-find/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.9">
    
    
      
        <title>zabbix6検証 - 总有刁民想要害朕</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#apache" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="总有刁民想要害朕" class="md-header__button md-logo" aria-label="总有刁民想要害朕" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            总有刁民想要害朕
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              zabbix6検証
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="总有刁民想要害朕" class="md-nav__button md-logo" aria-label="总有刁民想要害朕" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    总有刁民想要害朕
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          ansbile
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          ansbile
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ansbile/" class="md-nav__link">
        ansbileオプション
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ansbile_async/" class="md-nav__link">
        ansbile_async
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../awk/" class="md-nav__link">
        awk
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sed/" class="md-nav__link">
        sed
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fio/" class="md-nav__link">
        fio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../MB-MiB%E7%9A%84%E5%8C%BA%E5%88%AB/" class="md-nav__link">
        MB_MiB的区别
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          MegaRAID
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          MegaRAID
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../megacli/" class="md-nav__link">
        megacli
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../megaraid/" class="md-nav__link">
        megaraid
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          PostgreSQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          PostgreSQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../psql-vs-mysql/" class="md-nav__link">
        MySQLとPostgreSQLコマンド比較表
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../psql-conf/" class="md-nav__link">
        从零开始学PostgreSQL (二)： 配置文件
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          MySQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          MySQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-ssl/" class="md-nav__link">
        MySQL安全SSL介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" class="md-nav__link">
        Explain详解与索引最佳实践
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-status-variables/" class="md-nav__link">
        Mysqlサーバーステータス変数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql/" class="md-nav__link">
        Mysql参数优化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../isolation/" class="md-nav__link">
        事务隔离级别
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../show-engine-innodb-status/" class="md-nav__link">
        innodb status解读
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../show-engine-innodb-status2/" class="md-nav__link">
        innodb status解读2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../undo-log/" class="md-nav__link">
        undo-log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../buffer-pool/" class="md-nav__link">
        Buffer-Pool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../my-cnf/" class="md-nav__link">
        mysql5.7性能提升一百倍调优宝典
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-table/" class="md-nav__link">
        MySQL-table
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/" class="md-nav__link">
        MySQLビルド
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-add-del-user/" class="md-nav__link">
        Mysqlユーザ作成削除
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-sysbench/" class="md-nav__link">
        Mysql sysbench
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-dummy/" class="md-nav__link">
        ダミーデータを作成
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-kill/" class="md-nav__link">
        mysqladmin kill
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        学习笔记
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql8-basic/" class="md-nav__link">
        Mysql8
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_19" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9_19" id="__nav_9_19_label" tabindex="0">
          MGR
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_19_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9_19">
          <span class="md-nav__icon md-icon"></span>
          MGR
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-group-replication/" class="md-nav__link">
        3種類のMGR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-mgr/" class="md-nav__link">
        MGR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-group-replication-how-to-elect-the-new-primary-node/" class="md-nav__link">
        MGR 如何选举新的主节点
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-mgr-copy/" class="md-nav__link">
        転載MGR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-ha/" class="md-nav__link">
        mysql+keepalived搭建教程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-clone/" class="md-nav__link">
        mysqlクローン機能
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          MySQL DUMP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          MySQL DUMP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql_backup/" class="md-nav__link">
        Mysql バックアップツール
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mydumper/" class="md-nav__link">
        mydumper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          Python Tips
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Python Tips
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-styleguide/" class="md-nav__link">
        Python风格规范
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-config/" class="md-nav__link">
        Python程序配置文件管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-decorator/" class="md-nav__link">
        装饰器
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-dunder/" class="md-nav__link">
        5种下划线
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-function/" class="md-nav__link">
        传入参数的几种方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python/" class="md-nav__link">
        非常规的技巧
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-mysql/" class="md-nav__link">
        操作mysql基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/" class="md-nav__link">
        Re 模块
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/" class="md-nav__link">
        字符串拼接总结
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/" class="md-nav__link">
        代码并行
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../py-pip/" class="md-nav__link">
        使用 Python Pip 的 10 个技巧
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Regular-Expression/" class="md-nav__link">
        正規表現
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/" class="md-nav__link">
        タグVLAN
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sar/" class="md-nav__link">
        sar
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/" class="md-nav__link">
        Bash编程超详细语法总结
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
          iptables
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          iptables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables/" class="md-nav__link">
        iptables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_1/" class="md-nav__link">
        iptables概念(1)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_2/" class="md-nav__link">
        iptables实际操作之规则查询(2)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_3/" class="md-nav__link">
        iptables规则管理(3)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_4/" class="md-nav__link">
        iptables匹配条件总结之一(4)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_5/" class="md-nav__link">
        iptables匹配条件总结之二（常用扩展模块）(5)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_6/" class="md-nav__link">
        iptables扩展匹配条件之’–tcp-flags’(6)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_7/" class="md-nav__link">
        iptables扩展之udp扩展与icmp扩展(7)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_8/" class="md-nav__link">
        iptables扩展模块之state扩展(8)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_9/" class="md-nav__link">
        iptables的黑白名单机制(9)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_10/" class="md-nav__link">
        iptables自定义链(10)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_11/" class="md-nav__link">
        iptables之网络防火墙(11)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_12/" class="md-nav__link">
        iptables动作总结之一(12)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_13/" class="md-nav__link">
        iptables动作总结之二(13)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_14/" class="md-nav__link">
        iptables小结之常用套路(14)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
          virt
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_17">
          <span class="md-nav__icon md-icon"></span>
          virt
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../virt-migrate/" class="md-nav__link">
        KVM迁移
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_18" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_18" id="__nav_18_label" tabindex="0">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_18_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_18">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../centos7-set-kernel/" class="md-nav__link">
        centos7-set-kernel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../centos-network-device-naming/" class="md-nav__link">
        centos-network-device-naming
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Linux-Performance/" class="md-nav__link">
        Linux Performance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/" class="md-nav__link">
        Linux-shell-逻辑运算符-逻辑表达式详解
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../busybox/" class="md-nav__link">
        busybox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linux-img/" class="md-nav__link">
        rocky img 作成
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../osinfo-query/" class="md-nav__link">
        osinfo-query更新
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_19" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_19" id="__nav_19_label" tabindex="0">
          LVM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_19_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_19">
          <span class="md-nav__icon md-icon"></span>
          LVM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/" class="md-nav__link">
        LVM逻辑卷基本概念及LVM的工作原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linux-lvm/" class="md-nav__link">
        LVM逻辑卷的建立、扩容和减容
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lvm-snapshot/" class="md-nav__link">
        LVM-snapshot
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../macOS%E8%BD%AF%E4%BB%B6%E7%BC%96%E8%AF%91%E6%97%B6%E6%89%BE%E4%B8%8D%E5%88%B0%E5%A4%B4%E6%96%87%E4%BB%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-%E6%9B%B4%E6%96%B010-15/" class="md-nav__link">
        macOS软件编译时找不到头文件解决方法[更新10.15]
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ubnt/" class="md-nav__link">
        ubnt
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../vim/" class="md-nav__link">
        VIM
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../teslak20c/" class="md-nav__link">
        Tesla K20c をゲーム用に改造してみた
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../terminal-shortcut/" class="md-nav__link">
        ターミナルを使うためのショートカット集
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_25" checked>
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_25" id="__nav_25_label" tabindex="0">
          Zabbix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_25_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_25">
          <span class="md-nav__icon md-icon"></span>
          Zabbix
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          zabbix6検証
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        zabbix6検証
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#url" class="md-nav__link">
    参考URL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#idpw" class="md-nav__link">
    デフォルトID/PW
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    検証サーバ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#centos7-zabbix-agent2-install" class="md-nav__link">
    CentOS7 zabbix-agent2 install
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ubuntu-zabbix" class="md-nav__link">
    Ubuntu zabbixのインストール
  </a>
  
    <nav class="md-nav" aria-label="Ubuntu zabbixのインストール">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    警告
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mysql8" class="md-nav__link">
    MySQL8のインストール
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zabbix-ha" class="md-nav__link">
    Zabbix HA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    テンプレートについて
  </a>
  
    <nav class="md-nav" aria-label="テンプレートについて">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zabbix_server" class="md-nav__link">
    zabbix_serverから取得した情報
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zabbix" class="md-nav__link">
    zabbix テンプレート上対応してないアイテム
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql40" class="md-nav__link">
    MySQL4.0の特別対応
  </a>
  
    <nav class="md-nav" aria-label="MySQL4.0の特別対応">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentconf" class="md-nav__link">
    agent側のconf設定
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_26" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_26" id="__nav_26_label" tabindex="0">
          SWAP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_26_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_26">
          <span class="md-nav__icon md-icon"></span>
          SWAP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../swap-find/" class="md-nav__link">
        Swapを使ってるプロセスを探す
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../swap-schema/" class="md-nav__link">
        Swap原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../swap-linux/" class="md-nav__link">
        Linux内存回收与swap
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../pfctl/" class="md-nav__link">
        pfctlのコマンドを毎回忘れるのでメモ
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_28" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_28" id="__nav_28_label" tabindex="0">
          Prometheus
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_28_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_28">
          <span class="md-nav__icon md-icon"></span>
          Prometheus
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prometheus/" class="md-nav__link">
        prometheus構築
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysqld_exporter_flags/" class="md-nav__link">
        mysqld_exporterコレクタFlags
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#url" class="md-nav__link">
    参考URL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#idpw" class="md-nav__link">
    デフォルトID/PW
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    検証サーバ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#centos7-zabbix-agent2-install" class="md-nav__link">
    CentOS7 zabbix-agent2 install
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ubuntu-zabbix" class="md-nav__link">
    Ubuntu zabbixのインストール
  </a>
  
    <nav class="md-nav" aria-label="Ubuntu zabbixのインストール">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    警告
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mysql8" class="md-nav__link">
    MySQL8のインストール
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#zabbix-ha" class="md-nav__link">
    Zabbix HA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    テンプレートについて
  </a>
  
    <nav class="md-nav" aria-label="テンプレートについて">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zabbix_server" class="md-nav__link">
    zabbix_serverから取得した情報
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zabbix" class="md-nav__link">
    zabbix テンプレート上対応してないアイテム
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql40" class="md-nav__link">
    MySQL4.0の特別対応
  </a>
  
    <nav class="md-nav" aria-label="MySQL4.0の特別対応">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentconf" class="md-nav__link">
    agent側のconf設定
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="apache">公式インストール手順書(apacheバージョン)<a class="headerlink" href="#apache" title="Permanent link">&para;</a></h1>
<ul>
<li>https://www.zabbix.com/download?zabbix=6.0&amp;os_distribution=ubuntu&amp;os_version=20.04_focal&amp;db=mysql&amp;ws=apache</li>
</ul>
<h2 id="url">参考URL<a class="headerlink" href="#url" title="Permanent link">&para;</a></h2>
<ul>
<li>https://densan-hoshigumi.com/server/zabbix60-ha-installation</li>
</ul>
<h2 id="idpw">デフォルトID/PW<a class="headerlink" href="#idpw" title="Permanent link">&para;</a></h2>
<ul>
<li>ID:Admin</li>
<li>PW:zabbix</li>
</ul>
<h2 id="_1">検証サーバ<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>http://192.168.1.1/zabbix/zabbix.php?action=dashboard.view</li>
<li>http://192.168.1.2/zabbix/zabbix.php?action=dashboard.view</li>
</ul>
<h2 id="centos7-zabbix-agent2-install">CentOS7 zabbix-agent2 install<a class="headerlink" href="#centos7-zabbix-agent2-install" title="Permanent link">&para;</a></h2>
<ul>
<li>ca-certificates update<ul>
<li>
<details class="note">
<summary>ca-certificates update</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># yum install ca-certificates -y</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>zabbix-agent2-6.0.5-1.el7.x86_64.rpm<span class="w"> </span>download<span class="p">&amp;</span>install
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>download</p>
<ul>
<li>
<details class="note">
<summary>download</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># wget https://repo.zabbix.com/zabbix/6.0/rhel/7/x86_64/zabbix-agent2-6.0.5-1.el7.x86_64.rpm</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>install</p>
<ul>
<li>
<details class="note">
<summary>install</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">#インストール前</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># rpm -aq | grep zabbix</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>zabbix-release-3.0-1.el7.noarch
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>zabbix-agent-3.0.3-1.el7.x86_64
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c1">#インストール後</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># rpm -aq | grep zabbix</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>zabbix-release-3.0-1.el7.noarch
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>zabbix-agent-3.0.3-1.el7.x86_64
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>zabbix-agent2-6.0.5-1.el7.x86_64
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># ll</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>total<span class="w"> </span><span class="m">5</span>.4M
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4</span>.0K<span class="w"> </span>Jun<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">14</span>:59<span class="w"> </span>.
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>drwxr-xr-x<span class="w"> </span><span class="m">7</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4</span>.0K<span class="w"> </span>Jun<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">12</span>:32<span class="w"> </span>..
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.4K<span class="w"> </span>Jun<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">12</span>:32<span class="w"> </span>userparameter_mysql.conf
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">5</span>.4M<span class="w"> </span>May<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">20</span>:39<span class="w"> </span>zabbix-agent2-6.0.5-1.el7.x86_64.rpm
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># rpm -aq | grep zabbix</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>zabbix-agent-3.0.3-1.el7.x86_64
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>zabbix-release-3.0-1.el7.noarch
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="o">[</span>root@mysql1000<span class="w"> </span>mysql_agent<span class="o">]</span><span class="c1"># yum install zabbix-agent2-6.0.5-1.el7.x86_64.rpm</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>Loaded<span class="w"> </span>plugins:<span class="w"> </span>fastestmirror
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>Examining<span class="w"> </span>zabbix-agent2-6.0.5-1.el7.x86_64.rpm:<span class="w"> </span>zabbix-agent2-6.0.5-1.el7.x86_64
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>Marking<span class="w"> </span>zabbix-agent2-6.0.5-1.el7.x86_64.rpm<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>installed
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>Resolving<span class="w"> </span>Dependencies
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>--&gt;<span class="w"> </span>Running<span class="w"> </span>transaction<span class="w"> </span>check
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>---&gt;<span class="w"> </span>Package<span class="w"> </span>zabbix-agent2.x86_64<span class="w"> </span><span class="m">0</span>:6.0.5-1.el7<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>installed
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>--&gt;<span class="w"> </span>Processing<span class="w"> </span>Dependency:<span class="w"> </span>libpcre2-8.so.0<span class="o">()(</span>64bit<span class="o">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>package:<span class="w"> </span>zabbix-agent2-6.0.5-1.el7.x86_64
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>Loading<span class="w"> </span>mirror<span class="w"> </span>speeds<span class="w"> </span>from<span class="w"> </span>cached<span class="w"> </span>hostfile
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="w"> </span>*<span class="w"> </span>elrepo:<span class="w"> </span>ftp.ne.jp
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="w"> </span>*<span class="w"> </span>epel:<span class="w"> </span>ftp.iij.ad.jp
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>--&gt;<span class="w"> </span>Running<span class="w"> </span>transaction<span class="w"> </span>check
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>---&gt;<span class="w"> </span>Package<span class="w"> </span>pcre2.x86_64<span class="w"> </span><span class="m">0</span>:10.23-2.el7<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>installed
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>--&gt;<span class="w"> </span>Finished<span class="w"> </span>Dependency<span class="w"> </span>Resolution
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>Dependencies<span class="w"> </span><span class="nv">Resolved</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a><span class="o">=========================================================================================================================================================================================</span>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a><span class="w"> </span>Package<span class="w">                                  </span>Arch<span class="w">                              </span>Version<span class="w">                                   </span>Repository<span class="w">                                                    </span><span class="nv">Size</span>
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a><span class="o">=========================================================================================================================================================================================</span>
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>Installing:
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a><span class="w"> </span>zabbix-agent2<span class="w">                            </span>x86_64<span class="w">                            </span><span class="m">6</span>.0.5-1.el7<span class="w">                               </span>/zabbix-agent2-6.0.5-1.el7.x86_64<span class="w">                             </span><span class="m">17</span><span class="w"> </span>M
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>Installing<span class="w"> </span><span class="k">for</span><span class="w"> </span>dependencies:
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a><span class="w"> </span>pcre2<span class="w">                                    </span>x86_64<span class="w">                            </span><span class="m">10</span>.23-2.el7<span class="w">                               </span>base<span class="w">                                                         </span><span class="m">201</span><span class="w"> </span>k
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>Transaction<span class="w"> </span><span class="nv">Summary</span>
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a><span class="o">=========================================================================================================================================================================================</span>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a>Install<span class="w">  </span><span class="m">1</span><span class="w"> </span>Package<span class="w"> </span><span class="o">(</span>+1<span class="w"> </span>Dependent<span class="w"> </span>package<span class="o">)</span>
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a>
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a>Total<span class="w"> </span>size:<span class="w"> </span><span class="m">18</span><span class="w"> </span>M
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a>Total<span class="w"> </span>download<span class="w"> </span>size:<span class="w"> </span><span class="m">201</span><span class="w"> </span>k
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a>Installed<span class="w"> </span>size:<span class="w"> </span><span class="m">18</span><span class="w"> </span>M
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a>Is<span class="w"> </span>this<span class="w"> </span>ok<span class="w"> </span><span class="o">[</span>y/d/N<span class="o">]</span>:<span class="w"> </span>y
</span><span id="__span-2-55"><a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a>
</span><span id="__span-2-56"><a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># rpm -aq | grep zabbix</span>
</span><span id="__span-2-57"><a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a>zabbix-agent-3.0.3-1.el7.x86_64
</span><span id="__span-2-58"><a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a>zabbix-release-3.0-1.el7.noarch
</span><span id="__span-2-59"><a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a>zabbix-agent2-6.0.5-1.el7.x86_64
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>agent2.conf</p>
<ul>
<li>
<details class="note">
<summary>agent2.conf</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># grep -v ^\# /etc/zabbix/zabbix_agent2.conf  | grep -v ^\$</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nv">PidFile</span><span class="o">=</span>/var/run/zabbix/zabbix_agent2.pid
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="nv">LogFile</span><span class="o">=</span>/var/log/zabbix/zabbix_agent2.log
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="nv">LogFileSize</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nv">Server</span><span class="o">=</span><span class="m">192</span>.168.1.1,192.168.1.2
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="nv">ListenPort</span><span class="o">=</span><span class="m">10059</span><span class="w">               </span>&lt;&lt;--<span class="w"> </span>agent1（10050）と被らないようにPortを変更する。
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="nv">ServerActive</span><span class="o">=</span><span class="m">192</span>.168.1.1,192.168.1.2
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="nv">Hostname</span><span class="o">=</span>node1
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="nv">HostnameItem</span><span class="o">=</span>system.hostname
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="nv">Include</span><span class="o">=</span>/etc/zabbix/zabbix_agent2.d/*.conf
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="nv">ControlSocket</span><span class="o">=</span>/tmp/agent.sock
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="nv">Include</span><span class="o">=</span>./zabbix_agent2.d/plugins.d/*.conf
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># systemctl enable zabbix-agent2.service</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># systemctl restart zabbix-agent2.service</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="c1"># 対象IPの許可を追加</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># vi /root/bin/iptables.sh</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-s<span class="w"> </span><span class="m">192</span>.168.1.0/24<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1"># netstat -nlpt</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>Active<span class="w"> </span>Internet<span class="w"> </span>connections<span class="w"> </span><span class="o">(</span>only<span class="w"> </span>servers<span class="o">)</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>Proto<span class="w"> </span>Recv-Q<span class="w"> </span>Send-Q<span class="w"> </span>Local<span class="w"> </span>Address<span class="w">           </span>Foreign<span class="w"> </span>Address<span class="w">         </span>State<span class="w">       </span>PID/Program<span class="w"> </span>name
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.1:25<span class="w">            </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">1017</span>/master
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:10050<span class="w">           </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">31319</span>/zabbix_agentd
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:3306<span class="w">            </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">6041</span>/mysqld
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:22<span class="w">              </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">851</span>/sshd
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>::1:25<span class="w">                  </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">1017</span>/master
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::10050<span class="w">                </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">31319</span>/zabbix_agentd
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::10059<span class="w">                </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">8723</span>/zabbix_agent2<span class="w">      </span>&lt;&lt;--<span class="w">  </span>10059でagent2が利用中
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::9104<span class="w">                 </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">19474</span>/./mysqld_expo
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::22<span class="w">                   </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">851</span>/sshd
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="o">[</span>root@node1<span class="w"> </span><span class="o">]</span><span class="c1">#</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>MySQL監視用アカウント追加</p>
<ul>
<li>
<details class="note">
<summary>MySQL監視用アカウント追加</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># MySQLを監視用ユーザ</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>CREATE<span class="w"> </span>USER<span class="w"> </span><span class="s1">&#39;zbx_monitor&#39;</span>@<span class="s1">&#39;%&#39;</span><span class="w"> </span>IDENTIFIED<span class="w"> </span>BY<span class="w"> </span><span class="s1">&#39;password&#39;</span><span class="p">;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>GRANT<span class="w"> </span>REPLICATION<span class="w"> </span>CLIENT,PROCESS,SHOW<span class="w"> </span>DATABASES,SHOW<span class="w"> </span>VIEW<span class="w"> </span>ON<span class="w"> </span>*.*<span class="w"> </span>TO<span class="w"> </span><span class="s1">&#39;zbx_monitor&#39;</span>@<span class="s1">&#39;%&#39;</span><span class="p">;</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
</ul>
<h2 id="ubuntu-zabbix">Ubuntu zabbixのインストール<a class="headerlink" href="#ubuntu-zabbix" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>パッケージインストール前にca-certificatesを更新</p>
<ul>
<li>
<details class="note">
<summary>ca-certificatesを更新</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>ca-certificates
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>Install Zabbix repository</p>
<ul>
<li>
<details class="note">
<summary>Install</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># wget https://repo.zabbix.com/zabbix/6.0/ubuntu/pool/main/z/zabbix-release/zabbix-release_6.0-1+ubuntu20.04_all.deb</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c1"># dpkg -i zabbix-release_6.0-1+ubuntu20.04_all.deb</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c1"># apt update</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>apt updateエラー時</p>
<ul>
<li>
<details class="note">
<summary>updateエラー時</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># &quot;Ubuntu 20.04.4 LTS&quot;の場合、apt update時エラー発生することがあります。</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>root@zbx-test02:~/work#<span class="w"> </span>apt<span class="w"> </span>update
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>Hit:1<span class="w"> </span>http://ftp.tsukuba.wide.ad.jp/Linux/ubuntu<span class="w"> </span>focal<span class="w"> </span>InRelease
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>Hit:2<span class="w"> </span>http://ftp.tsukuba.wide.ad.jp/Linux/ubuntu<span class="w"> </span>focal-updates<span class="w"> </span>InRelease
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>Hit:3<span class="w"> </span>https://repo.zabbix.com/zabbix/6.0/ubuntu<span class="w"> </span>focal<span class="w"> </span>InRelease
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>Hit:4<span class="w"> </span>http://archive.ubuntu.com/ubuntu<span class="w"> </span>focal<span class="w"> </span>InRelease
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>Get:5<span class="w"> </span>http://archive.ubuntu.com/ubuntu<span class="w"> </span>focal-updates<span class="w"> </span>InRelease<span class="w"> </span><span class="o">[</span><span class="m">114</span><span class="w"> </span>kB<span class="o">]</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>Get:6<span class="w"> </span>http://archive.ubuntu.com/ubuntu<span class="w"> </span>focal-backports<span class="w"> </span>InRelease<span class="w"> </span><span class="o">[</span><span class="m">108</span><span class="w"> </span>kB<span class="o">]</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>Get:7<span class="w"> </span>http://archive.ubuntu.com/ubuntu<span class="w"> </span>focal-security<span class="w"> </span>InRelease<span class="w"> </span><span class="o">[</span><span class="m">114</span><span class="w"> </span>kB<span class="o">]</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>Fetched<span class="w"> </span><span class="m">336</span><span class="w"> </span>kB<span class="w"> </span><span class="k">in</span><span class="w"> </span>2s<span class="w"> </span><span class="o">(</span><span class="m">135</span><span class="w"> </span>kB/s<span class="o">)</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>Reading<span class="w"> </span>package<span class="w"> </span>lists...<span class="w"> </span>Done
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>Building<span class="w"> </span>dependency<span class="w"> </span>tree
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>Reading<span class="w"> </span>state<span class="w"> </span>information...<span class="w"> </span>Done
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>All<span class="w"> </span>packages<span class="w"> </span>are<span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span>date.
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>N:<span class="w"> </span>Skipping<span class="w"> </span>acquire<span class="w"> </span>of<span class="w"> </span>configured<span class="w"> </span>file<span class="w"> </span><span class="s1">&#39;main/binary-i386/Packages&#39;</span><span class="w"> </span>as<span class="w"> </span>repository<span class="w"> </span><span class="s1">&#39;https://repo.zabbix.com/zabbix/6.0/ubuntu focal InRelease&#39;</span><span class="w"> </span>doesn<span class="s1">&#39;t support architecture &#39;</span>i386<span class="err">&#39;</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>root@zbx-test02:~/work#<span class="w"> </span>l
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="c1"># 対策</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>--<span class="w"> </span>デフォルト
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="c1"># cat /etc/apt/sources.list.d/zabbix.list</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>deb<span class="w"> </span>https://repo.zabbix.com/zabbix/6.0/ubuntu<span class="w"> </span>focal<span class="w"> </span>main
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>deb-src<span class="w"> </span>https://repo.zabbix.com/zabbix/6.0/ubuntu<span class="w"> </span>focal<span class="w"> </span>main
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>--<span class="w"> </span>変更後
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>root@zbx-test02:~/work#<span class="w"> </span>cat<span class="w"> </span>/etc/apt/sources.list.d/zabbix.list
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>deb<span class="w">  </span><span class="o">[</span><span class="nv">arch</span><span class="o">=</span>amd64<span class="o">]</span><span class="w"> </span>https://repo.zabbix.com/zabbix/6.0/ubuntu<span class="w"> </span>focal<span class="w"> </span>main
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>deb-src<span class="w">  </span><span class="o">[</span><span class="nv">arch</span><span class="o">=</span>amd64<span class="o">]</span><span class="w"> </span>https://repo.zabbix.com/zabbix/6.0/ubuntu<span class="w"> </span>focal<span class="w"> </span>main
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>root@zbx-test02:~/work#
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>Install Zabbix server, frontend, agent</p>
<ul>
<li>
<details class="note">
<summary>Install Zabbix server, frontend, agent</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># apt install zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="c1"># apt install language-pack-ja-base language-pack-ja</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>Create initial database</p>
<ul>
<li>
<details class="note">
<summary>initial database</summary>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="o">#</span><span class="w"> </span><span class="n">mysql</span><span class="w"> </span><span class="o">-</span><span class="n">uroot</span><span class="w"> </span><span class="o">-</span><span class="n">p</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">password</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="k">global</span><span class="w"> </span><span class="n">validate_password</span><span class="p">.</span><span class="n">policy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;LOW&quot;</span><span class="p">;</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">zabbix</span><span class="w"> </span><span class="nb">character</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">utf8mb4</span><span class="w"> </span><span class="k">collate</span><span class="w"> </span><span class="n">utf8mb4_bin</span><span class="p">;</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">zabbix</span><span class="o">@</span><span class="n">localhost</span><span class="w"> </span><span class="n">identified</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="s1">&#39;password&#39;</span><span class="p">;</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">grant</span><span class="w"> </span><span class="k">all</span><span class="w"> </span><span class="k">privileges</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">zabbix</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">zabbix</span><span class="o">@</span><span class="n">localhost</span><span class="p">;</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="o">#</span><span class="w"> </span><span class="err">監視用ユーザ追加</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="o">##</span><span class="w"> </span><span class="n">MySQL５</span><span class="err">．１</span><span class="p">,</span><span class="n">MySQL５</span><span class="err">．</span><span class="mi">5</span><span class="p">,</span><span class="n">MySQL５</span><span class="err">．</span><span class="mi">7</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;zbx_monitor&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;password&#39;</span><span class="p">;</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">GRANT</span><span class="w"> </span><span class="n">REPLICATION</span><span class="w"> </span><span class="n">CLIENT</span><span class="p">,</span><span class="n">PROCESS</span><span class="p">,</span><span class="k">SHOW</span><span class="w"> </span><span class="n">DATABASES</span><span class="p">,</span><span class="k">SHOW</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;zbx_monitor&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span><span class="p">;</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">quit</span><span class="p">;</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="o">#</span><span class="w"> </span><span class="n">MySQL4</span><span class="p">.</span><span class="mi">0</span><span class="err">の場合</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="mi">09</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">16</span><span class="w"> </span><span class="n">root</span><span class="o">@</span><span class="n">localhost</span><span class="p">[(</span><span class="k">none</span><span class="p">)]</span><span class="o">&gt;</span><span class="w"> </span><span class="k">GRANT</span><span class="w"> </span><span class="n">REPLICATION</span><span class="w"> </span><span class="n">CLIENT</span><span class="p">,</span><span class="n">PROCESS</span><span class="p">,</span><span class="k">SHOW</span><span class="w"> </span><span class="n">DATABASES</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="o">`</span><span class="n">zbx_monitor</span><span class="o">`@</span><span class="s1">&#39;%&#39;</span><span class="w">  </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;password&#39;</span><span class="p">;</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>初期データの投入</p>
<ul>
<li>On Zabbix server host import initial schema and data. You will be prompted to enter your newly created password.</li>
<li>
<details class="note">
<summary>初期データの投入</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># zcat /usr/share/doc/zabbix-sql-scripts/mysql/server.sql.gz | mysql -uzabbix -ppassword zabbix</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c1"># NOT WORK</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c1"># OK</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>root@zbx-test:~#<span class="w"> </span>cp<span class="w"> </span>/usr/share/doc/zabbix-sql-scripts/mysql/server.sql.gz<span class="w"> </span>/root/work/
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>root@zbx-test:~/work#<span class="w"> </span>gzip<span class="w">  </span>-d<span class="w"> </span>server.sql.gz
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>root@zbx-test:~/work#<span class="w"> </span>mysql<span class="w"> </span>zabbix<span class="w"> </span>&lt;<span class="w"> </span>server.sql
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>Configure the database for Zabbix server</p>
<ul>
<li>
<details class="note">
<summary>Configure the database for Zabbix server</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>Edit<span class="w"> </span>file<span class="w"> </span>/etc/zabbix/zabbix_server.conf
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="nv">DBPassword</span><span class="o">=</span>password
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>Start Zabbix server and agent processes</p>
<ul>
<li>
<details class="note">
<summary>Start Zabbix server and agent processes</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># systemctl restart zabbix-server zabbix-agent apache2</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c1"># systemctl enable zabbix-server zabbix-agent apache2</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>Font問題</p>
<ul>
<li>https://ray-channel.hateblo.jp/entry/2022/04/12/001451#Zabbix6%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB</li>
<li>
<details class="note">
<summary>Font問題</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>root@zbx-test:~/work#<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>fonts-ipafont<span class="w"> </span>fonts-ipafont-gothic<span class="w"> </span>fonts-ipafont-mincho
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>root@zbx-test:~/work#<span class="w"> </span>cp<span class="w"> </span>/usr/share/fonts/truetype/fonts-japanese-gothic.ttf<span class="w"> </span>/usr/share/zabbix/fonts/<span class="w">　　</span>&lt;--必要ないかも
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>root@zbx-test:~/work#<span class="w"> </span>ln<span class="w"> </span>-sf<span class="w"> </span>/usr/share/fonts/opentype/ipafont-gothic/ipag.ttf<span class="w"> </span>/etc/alternatives/zabbix-frontend-font
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>zabbix-agent2のCentOS７インストール</p>
<ul>
<li>
<details class="note">
<summary>zabbix-agent2のCentOS７インストール</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1"># wget https://repo.zabbix.com/zabbix/6.0/rhel/7/x86_64/zabbix-agent2-6.0.5-1.el7.x86_64.rpm --no-check-certificate</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1"># yum install zabbix-agent2</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>zabbix-agentのHOME問題(必要ないかも)</p>
<ul>
<li>
<details class="note">
<summary>zabbix-agentのHOME問題</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>root@zbx-test:~/work#<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>php-gd<span class="w"> </span>php-bcmath<span class="w"> </span>php-mbstring<span class="w"> </span>php-xml<span class="w"> </span>php-ldap<span class="w"> </span>php-json
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1"># mkdir /var/lib/zabbix</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1"># chown zabbix:zabbix /var/lib/zabbix</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1"># cp /etc/zabbix/mysql/my.cnf /var/lib/zabbix/</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1">#</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>zabbix_server log level</p>
<ul>
<li>https://unam.hatenadiary.jp/entry/2018/03/21/143227</li>
<li>
<details class="note">
<summary>zabbix_server log level</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>pollerのレベルを3から4に上げる場合、以下のコマンドを入力します。
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>sudo<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span><span class="nv">log_level_increase</span><span class="o">=</span>poller
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>元に戻す場合
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>sudo<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span><span class="nv">log_level_decrease</span><span class="o">=</span>poller
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>zabbix_server db.size</p>
<ul>
<li>
<details class="note">
<summary>zabbix_server db.size</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>root@zbx-test:~#<span class="w"> </span>/usr/bin/zabbix_get<span class="w"> </span>-s<span class="w"> </span>node1<span class="w"> </span>-k<span class="w">  </span>mysql.db.size<span class="o">[</span><span class="s2">&quot;localhost&quot;</span>,<span class="s2">&quot;zbx_monitor&quot;</span>,<span class="s2">&quot;password&quot;</span>,<span class="s2">&quot;information_schema&quot;</span><span class="o">]</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="m">163840</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>root@zbx-test:~#
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>root@zbx-test:~#<span class="w"> </span>/usr/bin/zabbix_get<span class="w"> </span>-s<span class="w"> </span>node1<span class="w"> </span>-k<span class="w">  </span>mysql.version<span class="o">[</span><span class="s2">&quot;localhost&quot;</span>,<span class="s2">&quot;zbx_monitor&quot;</span>,<span class="s2">&quot;password&quot;</span><span class="o">]</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="m">5</span>.7.28-log
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>root@zbx-test:~#
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>zabbix_agent2</p>
<ul>
<li>agent2を使う場合</li>
<li>
<details class="note">
<summary>設定-&gt;ホスト-&gt;mysqlxxx-&gt;マクロ</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="o">{</span><span class="nv">$MYSQL</span>.DSN<span class="o">}</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>tcp://localhost:3306
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="o">{</span><span class="nv">$MYSQL</span>.PASSWORD<span class="o">}</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>password
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="o">{</span><span class="nv">$MYSQL</span>.USER<span class="o">}</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>zbx_monitor
</span></code></pre></div></details>
</li>
<li>
<details class="note">
<summary>zabbix_agent2.confの設定</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1"># grep -v ^\# /etc/zabbix/zabbix_agent2.d/plugins.d/mysql.conf  | grep -v ^\$</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>Plugins.Mysql.Sessions.Prod.User<span class="o">=</span>zbx_monitor
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>Plugins.Mysql.Sessions.Prod.Password<span class="o">=</span>password
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1">#</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1"># grep -v ^\# /etc/zabbix/zabbix_agent2.conf  | grep -v ^\$</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="nv">PidFile</span><span class="o">=</span>/var/run/zabbix/zabbix_agent2.pid
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="nv">HostnameItem</span><span class="o">=</span>system.hostname
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="nv">RefreshActiveChecks</span><span class="o">=</span><span class="m">300</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="nv">BufferSize</span><span class="o">=</span><span class="m">300</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="nv">Timeout</span><span class="o">=</span><span class="m">30</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="nv">LogFile</span><span class="o">=</span>/var/log/zabbix/zabbix_agent2.log
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="nv">LogFileSize</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="nv">Server</span><span class="o">=</span><span class="m">192</span>.168.1.1
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="nv">ServerActive</span><span class="o">=</span><span class="m">192</span>.168.1.1
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="nv">Hostname</span><span class="o">=</span>Zabbix<span class="w"> </span>server
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="nv">Include</span><span class="o">=</span>/etc/zabbix/zabbix_agent2.d/*.conf
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="nv">ControlSocket</span><span class="o">=</span>/tmp/agent.sock
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="nv">Include</span><span class="o">=</span>./zabbix_agent2.d/plugins.d/*.conf
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1">#</span>
</span></code></pre></div></details>
</li>
<li>rootでzabbix_agent2を実行したい場合<ul>
<li>https://www.zabbix.com/documentation/current/en/manual/appendix/install/run_agent_as_root</li>
<li>
<details class="note">
<summary>rootでzabbix_agent2を実行したい場合</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1"># cat /usr/lib/systemd/system/zabbix-agent2.service</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="o">[</span>Unit<span class="o">]</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="nv">Description</span><span class="o">=</span>Zabbix<span class="w"> </span>Agent<span class="w"> </span><span class="m">2</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="nv">After</span><span class="o">=</span>syslog.target
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="nv">After</span><span class="o">=</span>network.target
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="o">[</span>Service<span class="o">]</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="nv">Environment</span><span class="o">=</span><span class="s2">&quot;CONFFILE=/etc/zabbix/zabbix_agent2.conf&quot;</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="nv">EnvironmentFile</span><span class="o">=</span>-/etc/sysconfig/zabbix-agent2
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="nv">Type</span><span class="o">=</span>simple
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="nv">Restart</span><span class="o">=</span>on-failure
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="nv">PIDFile</span><span class="o">=</span>/run/zabbix/zabbix_agent2.pid
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="nv">KillMode</span><span class="o">=</span>control-group
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="nv">ExecStart</span><span class="o">=</span>/usr/sbin/zabbix_agent2<span class="w"> </span>-c<span class="w"> </span><span class="nv">$CONFFILE</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="nv">ExecStop</span><span class="o">=</span>/bin/kill<span class="w"> </span>-SIGTERM<span class="w"> </span><span class="nv">$MAINPID</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="nv">RestartSec</span><span class="o">=</span>10s
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="nv">User</span><span class="o">=</span>zabbix<span class="w">       </span>&lt;&lt;--<span class="w"> </span>ここをrootに変更
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="nv">Group</span><span class="o">=</span>zabbix<span class="w">      </span>&lt;&lt;--<span class="w"> </span>ここをrootに変更
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="o">[</span>Install<span class="o">]</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1">#</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="o">[</span>root@node1<span class="w"> </span>work<span class="o">]</span><span class="c1"># systemctl daemon-reload</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>zabbix_server conf</p>
<ul>
<li>
<details class="note">
<summary>zabbix_server conf</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="nv">StartPollers</span><span class="o">=</span><span class="m">20</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c1"># 轮询器的 pre-foked（与分配）实例进程数量</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="nv">StartIPMIPollers</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="c1"># IPMI 进程轮询器数量</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="nv">StartPreprocessors</span><span class="o">=</span><span class="m">3</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="c1"># 预处理进程轮询器数量</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="nv">StartPollersUnreachable</span><span class="o">=</span><span class="m">10</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="c1"># 不可达主机轮询器（包括 IPMI 和 Java，SNMP等）的 Pre-forked (预分配)实例数量。</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="c1"># 如果启动了常规，IPMI或Java轮询器，则至少运行一个无法访问主机的轮询器。</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="nv">StartHistoryPollers</span><span class="o">=</span><span class="m">5</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="c1"># 历史数据处理进程轮询器</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="c1"># 作为历史数据处理的轮询，zabbix为了数据的存储的可读性，他把数据存储后分成了历史数据和趋势数据，</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="c1"># 历史数据有一个单独的轮询器进行处理。</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="nv">StartTrappers</span><span class="o">=</span><span class="m">5</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="c1"># Trap类型进程轮询器数量</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="c1"># 包括接受的是Active模式， 以zabbix的Sender的Trap发过来的数据</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a><span class="nv">StartPinger</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a><span class="c1"># ICMP PING进程轮询器</span>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a>
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a><span class="nv">StartDiscoverers</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a><span class="c1"># 自动发现进程轮询器</span>
</span><span id="__span-21-28"><a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a>
</span><span id="__span-21-29"><a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a><span class="nv">StartHTTPPollers</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-21-30"><a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="c1"># HTTP进程轮询器</span>
</span><span id="__span-21-31"><a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a>
</span><span id="__span-21-32"><a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a><span class="nv">StartTimers</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-21-33"><a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a><span class="c1"># 定时器的 per-forked(预分配)实例数量。定时器处理维护周期。</span>
</span><span id="__span-21-34"><a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a>
</span><span id="__span-21-35"><a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a><span class="nv">StartEscalators</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-21-36"><a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a><span class="c1"># 扩容程序的 per-forked(预分配)实例数量。3.0后开始支持。</span>
</span><span id="__span-21-37"><a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a>
</span><span id="__span-21-38"><a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a><span class="nv">StartAlerters</span><span class="o">=</span><span class="m">3</span>
</span><span id="__span-21-39"><a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a><span class="c1"># 告警程序的 per-forked(预分配)实例数量。3.4后开始支持。</span>
</span><span id="__span-21-40"><a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a>
</span><span id="__span-21-41"><a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a><span class="nv">StartVMwareCollectors</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-21-42"><a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a><span class="c1"># VM 数据收集进程</span>
</span><span id="__span-21-43"><a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a>
</span><span id="__span-21-44"><a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a><span class="nv">SNMPTrapperFile</span><span class="o">=</span>/var/log/snmptrap/snmptarp.log
</span><span id="__span-21-45"><a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a><span class="c1"># SNMP Trap 文件路径</span>
</span><span id="__span-21-46"><a id="__codelineno-21-46" name="__codelineno-21-46" href="#__codelineno-21-46"></a><span class="c1"># 被动接受监控机器发过来的数据所存储的文件</span>
</span><span id="__span-21-47"><a id="__codelineno-21-47" name="__codelineno-21-47" href="#__codelineno-21-47"></a>
</span><span id="__span-21-48"><a id="__codelineno-21-48" name="__codelineno-21-48" href="#__codelineno-21-48"></a><span class="nv">CacheSize</span><span class="o">=</span>128M
</span><span id="__span-21-49"><a id="__codelineno-21-49" name="__codelineno-21-49" href="#__codelineno-21-49"></a><span class="c1"># 配置换成大小，以字节为单位。 存储主机，监控项和触发器数据的共享内存大小。</span>
</span><span id="__span-21-50"><a id="__codelineno-21-50" name="__codelineno-21-50" href="#__codelineno-21-50"></a><span class="c1"># 如果频繁访问数据库的话，会对数据库造成很大压力，所以说这是一个轮询。很多存储主机，监控项和触发器数据，实际上在启动的瞬间查询出来，放在历史的缓存中，</span>
</span><span id="__span-21-51"><a id="__codelineno-21-51" name="__codelineno-21-51" href="#__codelineno-21-51"></a><span class="c1"># 通过读取缓存数据交换，这是最快的一种方式。</span>
</span><span id="__span-21-52"><a id="__codelineno-21-52" name="__codelineno-21-52" href="#__codelineno-21-52"></a>
</span><span id="__span-21-53"><a id="__codelineno-21-53" name="__codelineno-21-53" href="#__codelineno-21-53"></a><span class="nv">HistoryCacheSize</span><span class="o">=</span>64M
</span><span id="__span-21-54"><a id="__codelineno-21-54" name="__codelineno-21-54" href="#__codelineno-21-54"></a><span class="c1"># 历史缓存的大小，以字节为单位。用于存储历史数据的共享内存大小。</span>
</span><span id="__span-21-55"><a id="__codelineno-21-55" name="__codelineno-21-55" href="#__codelineno-21-55"></a>
</span><span id="__span-21-56"><a id="__codelineno-21-56" name="__codelineno-21-56" href="#__codelineno-21-56"></a><span class="nv">HistoryIndexCacheSize</span><span class="o">=</span>16M
</span><span id="__span-21-57"><a id="__codelineno-21-57" name="__codelineno-21-57" href="#__codelineno-21-57"></a><span class="c1"># 历史索引缓存大小，以字节为单位。用于索引存储在历史缓存中的历史数据的共享内存大小。索引缓存一个监控项大约需要100字节。zabbix3.0后开始支持。</span>
</span><span id="__span-21-58"><a id="__codelineno-21-58" name="__codelineno-21-58" href="#__codelineno-21-58"></a><span class="c1"># 缓存的大小和索引的大小大约为4倍左右的差距</span>
</span><span id="__span-21-59"><a id="__codelineno-21-59" name="__codelineno-21-59" href="#__codelineno-21-59"></a>
</span><span id="__span-21-60"><a id="__codelineno-21-60" name="__codelineno-21-60" href="#__codelineno-21-60"></a><span class="nv">TrendCacheSize</span><span class="o">=</span>16M
</span><span id="__span-21-61"><a id="__codelineno-21-61" name="__codelineno-21-61" href="#__codelineno-21-61"></a><span class="c1"># 趋势缓存的大小，以字节为单位。 用于存储趋势数据的共享内存大小。</span>
</span><span id="__span-21-62"><a id="__codelineno-21-62" name="__codelineno-21-62" href="#__codelineno-21-62"></a>
</span><span id="__span-21-63"><a id="__codelineno-21-63" name="__codelineno-21-63" href="#__codelineno-21-63"></a><span class="nv">TrendFunctionCacheSize</span><span class="o">=</span>32M
</span><span id="__span-21-64"><a id="__codelineno-21-64" name="__codelineno-21-64" href="#__codelineno-21-64"></a><span class="c1"># 趋势函数缓存的大小，以字节为单位。用于缓存计算的趋势函数数据的共享内存大小。</span>
</span><span id="__span-21-65"><a id="__codelineno-21-65" name="__codelineno-21-65" href="#__codelineno-21-65"></a>
</span><span id="__span-21-66"><a id="__codelineno-21-66" name="__codelineno-21-66" href="#__codelineno-21-66"></a><span class="nv">ValueCacheSize</span><span class="o">=</span>128M
</span><span id="__span-21-67"><a id="__codelineno-21-67" name="__codelineno-21-67" href="#__codelineno-21-67"></a><span class="c1"># 历史值缓存的大小，以字节为单位。用于缓存监控项历史数据请求的共享内存大小。</span>
</span><span id="__span-21-68"><a id="__codelineno-21-68" name="__codelineno-21-68" href="#__codelineno-21-68"></a><span class="c1"># 设置为0将禁用缓存（不推荐）。但值缓存耗尽共享内存时，每5分钟会向服务器日志写入一条告警消息。</span>
</span><span id="__span-21-69"><a id="__codelineno-21-69" name="__codelineno-21-69" href="#__codelineno-21-69"></a>
</span><span id="__span-21-70"><a id="__codelineno-21-70" name="__codelineno-21-70" href="#__codelineno-21-70"></a><span class="nv">Timeout</span><span class="o">=</span><span class="m">4</span>
</span><span id="__span-21-71"><a id="__codelineno-21-71" name="__codelineno-21-71" href="#__codelineno-21-71"></a><span class="c1"># 指定等待 agent代理，SNMP设备或外部检查的时间（秒）</span>
</span><span id="__span-21-72"><a id="__codelineno-21-72" name="__codelineno-21-72" href="#__codelineno-21-72"></a>
</span><span id="__span-21-73"><a id="__codelineno-21-73" name="__codelineno-21-73" href="#__codelineno-21-73"></a><span class="nv">LogSlowQueries</span><span class="o">=</span><span class="m">3000</span>
</span><span id="__span-21-74"><a id="__codelineno-21-74" name="__codelineno-21-74" href="#__codelineno-21-74"></a><span class="c1"># 数据库慢查询记录时间（以毫秒为单位）。0 - 不记录慢查询。此选项从Debuglevel=3开始启用。</span>
</span><span id="__span-21-75"><a id="__codelineno-21-75" name="__codelineno-21-75" href="#__codelineno-21-75"></a>
</span><span id="__span-21-76"><a id="__codelineno-21-76" name="__codelineno-21-76" href="#__codelineno-21-76"></a><span class="nv">AllowRoot</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-21-77"><a id="__codelineno-21-77" name="__codelineno-21-77" href="#__codelineno-21-77"></a><span class="c1"># 使用root用户运行， 1 允许root用户运行， 0 禁止root用户运行。</span>
</span><span id="__span-21-78"><a id="__codelineno-21-78" name="__codelineno-21-78" href="#__codelineno-21-78"></a>
</span><span id="__span-21-79"><a id="__codelineno-21-79" name="__codelineno-21-79" href="#__codelineno-21-79"></a><span class="nv">User</span><span class="o">=</span>zabbix
</span><span id="__span-21-80"><a id="__codelineno-21-80" name="__codelineno-21-80" href="#__codelineno-21-80"></a><span class="c1"># 运行用户</span>
</span><span id="__span-21-81"><a id="__codelineno-21-81" name="__codelineno-21-81" href="#__codelineno-21-81"></a>
</span><span id="__span-21-82"><a id="__codelineno-21-82" name="__codelineno-21-82" href="#__codelineno-21-82"></a><span class="nv">StatsAllowedIP</span><span class="o">=</span><span class="m">127</span>.0.0.1
</span><span id="__span-21-83"><a id="__codelineno-21-83" name="__codelineno-21-83" href="#__codelineno-21-83"></a><span class="c1"># 仅接受此处列出的地址的状态请求。 如果未设置此参数，则不会接受任何状态请求。</span>
</span><span id="__span-21-84"><a id="__codelineno-21-84" name="__codelineno-21-84" href="#__codelineno-21-84"></a>
</span><span id="__span-21-85"><a id="__codelineno-21-85" name="__codelineno-21-85" href="#__codelineno-21-85"></a><span class="nv">HANodeName</span><span class="o">=</span>xxx_node1
</span><span id="__span-21-86"><a id="__codelineno-21-86" name="__codelineno-21-86" href="#__codelineno-21-86"></a><span class="c1"># 高可用集群节点名称。但为空时，服务器为单机模式工作，并创建一个名称为空的节点。</span>
</span><span id="__span-21-87"><a id="__codelineno-21-87" name="__codelineno-21-87" href="#__codelineno-21-87"></a>
</span><span id="__span-21-88"><a id="__codelineno-21-88" name="__codelineno-21-88" href="#__codelineno-21-88"></a><span class="nv">NodeAddress</span><span class="o">=</span>localhost:10051
</span><span id="__span-21-89"><a id="__codelineno-21-89" name="__codelineno-21-89" href="#__codelineno-21-89"></a><span class="c1"># IP或主机名， 带有可选端口， 以覆盖前端应连接到的服务器。</span>
</span><span id="__span-21-90"><a id="__codelineno-21-90" name="__codelineno-21-90" href="#__codelineno-21-90"></a><span class="c1"># 格式：&lt;address&gt;[:port]</span>
</span><span id="__span-21-91"><a id="__codelineno-21-91" name="__codelineno-21-91" href="#__codelineno-21-91"></a><span class="c1"># 前端用于指定服务器地址的优先级为： </span>
</span><span id="__span-21-92"><a id="__codelineno-21-92" name="__codelineno-21-92" href="#__codelineno-21-92"></a><span class="c1">#    NodeAddress</span>
</span><span id="__span-21-93"><a id="__codelineno-21-93" name="__codelineno-21-93" href="#__codelineno-21-93"></a><span class="c1">#    (1) ListenIP（非设置为0.0.0.0 or ::) </span>
</span><span id="__span-21-94"><a id="__codelineno-21-94" name="__codelineno-21-94" href="#__codelineno-21-94"></a><span class="c1">#    (2) localhost(默认)</span>
</span><span id="__span-21-95"><a id="__codelineno-21-95" name="__codelineno-21-95" href="#__codelineno-21-95"></a><span class="c1">#    (3) HANodeNmme 参数</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
</ul>
<h3 id="_2">警告<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>MySQL: Buffer pool utilization is too low</p>
<ul>
<li>[ MySQL: Buffer pool utilization is too low (less than 50% for 5m)]</li>
<li>MYSQL.BUFF_UTIL.MIN.WARN の値を30に変更しても50と表示される、原因不明。</li>
</ul>
</li>
<li>
<p>MySQL: Buffer pool utilization is too low (less than {$MYSQL.BUFF_UTIL.MIN.WARN}% for 5m)</p>
<ul>
<li>buffer pool の使用率は30%以下のため、警告発生</li>
<li>検証機のため、buffer pool の使用率は低いので、警告を無視する。</li>
</ul>
</li>
<li>
<p>設定-&gt;テンプレート-&gt;MySQL by Zabbix agent 2</p>
<ul>
<li>{$MYSQL.BUFF_UTIL.MIN.WARN} を 50 から 30に変更する。</li>
</ul>
</li>
<li>
<p>MySQL: Connection errors accept per second などの取得できないアイテム</p>
<ul>
<li>https://dev.mysql.com/doc/refman/5.6/ja/server-status-variables.html#statvar_Connection_errors_accept</li>
<li>https://cedarvalley.info/zabbix-mysql-connection_errors/
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>Connection_errors_xxx
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>これらの変数は、クライアント接続プロセス中に発生したエラーについての情報を提供します。これらはグローバル専用で、すべてのホストからの接続全体で集計したエラー数を表します。これらの変数は、ホストキャッシュによって説明されないエラーを追跡し (セクション8.11.5.2「DNS ルックアップの最適化とホストキャッシュ」を参照してください)、たとえば、TCP 接続に関連付けられないエラーや、接続プロセスのきわめて早期に (IP アドレスが既知となる前も含めて) 発生するエラー、または特定の IP アドレスに固有でない (メモリー不足の状況などの) エラーなどです。これらの変数は MySQL 5.6.5 で追加されました。
</span></code></pre></div></li>
</ul>
</li>
<li>
<p>上記MySQL5.5で取得できないため、テンプレートを複製し、別名に保存しました。</p>
<ul>
<li>取得できないアイテムを削除する。</li>
<li>MySQL5.5 by Zabbix agent 2
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>MySQL: Innodb number open files
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>MySQL: Connection errors accept per second
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>MySQL: Connection errors internal per second
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>MySQL: Connection errors max connections per second
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>MySQL: Connection errors peer address per second
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>MySQL: Connection errors select per second
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>MySQL: Connection errors tcpwrap per second
</span></code></pre></div></li>
</ul>
</li>
</ul>
<h2 id="mysql8">MySQL8のインストール<a class="headerlink" href="#mysql8" title="Permanent link">&para;</a></h2>
<ul>
<li>https://www.server-world.info/query?os=Ubuntu_20.04&amp;p=mysql8&amp;f=1</li>
<li>install<ul>
<li>
<details class="note">
<summary>install</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>apt<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>mysql-server-8.0
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>root パスワードの設定<ul>
<li>
<details class="note">
<summary>install</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>ALTER<span class="w"> </span>USER<span class="w"> </span><span class="s1">&#39;root&#39;</span>@<span class="s1">&#39;localhost&#39;</span><span class="w"> </span>IDENTIFIED<span class="w"> </span>WITH<span class="w"> </span>mysql_native_password<span class="w"> </span>by<span class="w"> </span><span class="s1">&#39;password&#39;</span><span class="p">;</span>
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>mysql 初期化<ul>
<li>
<details class="note">
<summary>初期化</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>root@zbx-test:~/work#<span class="w"> </span>mysql_secure_installation
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>Securing<span class="w"> </span>the<span class="w"> </span>MySQL<span class="w"> </span>server<span class="w"> </span>deployment.
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>Enter<span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>user<span class="w"> </span>root:
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>VALIDATE<span class="w"> </span>PASSWORD<span class="w"> </span>COMPONENT<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>used<span class="w"> </span>to<span class="w"> </span><span class="nb">test</span><span class="w"> </span>passwords
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>and<span class="w"> </span>improve<span class="w"> </span>security.<span class="w"> </span>It<span class="w"> </span>checks<span class="w"> </span>the<span class="w"> </span>strength<span class="w"> </span>of<span class="w"> </span>password
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>and<span class="w"> </span>allows<span class="w"> </span>the<span class="w"> </span>users<span class="w"> </span>to<span class="w"> </span><span class="nb">set</span><span class="w"> </span>only<span class="w"> </span>those<span class="w"> </span>passwords<span class="w"> </span>which<span class="w"> </span>are
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>secure<span class="w"> </span>enough.<span class="w"> </span>Would<span class="w"> </span>you<span class="w"> </span>like<span class="w"> </span>to<span class="w"> </span>setup<span class="w"> </span>VALIDATE<span class="w"> </span>PASSWORD<span class="w"> </span>component?
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>Press<span class="w"> </span>y<span class="p">|</span>Y<span class="w"> </span><span class="k">for</span><span class="w"> </span>Yes,<span class="w"> </span>any<span class="w"> </span>other<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>No:<span class="w"> </span>y
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>There<span class="w"> </span>are<span class="w"> </span>three<span class="w"> </span>levels<span class="w"> </span>of<span class="w"> </span>password<span class="w"> </span>validation<span class="w"> </span>policy:
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>LOW<span class="w">    </span>Length<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">8</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>MEDIUM<span class="w"> </span>Length<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">8</span>,<span class="w"> </span>numeric,<span class="w"> </span>mixed<span class="w"> </span><span class="k">case</span>,<span class="w"> </span>and<span class="w"> </span>special<span class="w"> </span>characters
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a>STRONG<span class="w"> </span>Length<span class="w"> </span>&gt;<span class="o">=</span><span class="w"> </span><span class="m">8</span>,<span class="w"> </span>numeric,<span class="w"> </span>mixed<span class="w"> </span><span class="k">case</span>,<span class="w"> </span>special<span class="w"> </span>characters<span class="w"> </span>and<span class="w"> </span>dictionary<span class="w">                  </span>file
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a>Please<span class="w"> </span>enter<span class="w"> </span><span class="nv">0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>LOW,<span class="w"> </span><span class="nv">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>MEDIUM<span class="w"> </span>and<span class="w"> </span><span class="nv">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>STRONG:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a>Using<span class="w"> </span>existing<span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>root.
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a>Estimated<span class="w"> </span>strength<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>password:<span class="w"> </span><span class="m">50</span>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a>Change<span class="w"> </span>the<span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>root<span class="w"> </span>?<span class="w"> </span><span class="o">((</span>Press<span class="w"> </span>y<span class="p">|</span>Y<span class="w"> </span><span class="k">for</span><span class="w"> </span>Yes,<span class="w"> </span>any<span class="w"> </span>other<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>No<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>n
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a><span class="w"> </span>...<span class="w"> </span>skipping.
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a>By<span class="w"> </span>default,<span class="w"> </span>a<span class="w"> </span>MySQL<span class="w"> </span>installation<span class="w"> </span>has<span class="w"> </span>an<span class="w"> </span>anonymous<span class="w"> </span>user,
</span><span id="__span-26-28"><a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a>allowing<span class="w"> </span>anyone<span class="w"> </span>to<span class="w"> </span>log<span class="w"> </span>into<span class="w"> </span>MySQL<span class="w"> </span>without<span class="w"> </span>having<span class="w"> </span>to<span class="w"> </span>have
</span><span id="__span-26-29"><a id="__codelineno-26-29" name="__codelineno-26-29" href="#__codelineno-26-29"></a>a<span class="w"> </span>user<span class="w"> </span>account<span class="w"> </span>created<span class="w"> </span><span class="k">for</span><span class="w"> </span>them.<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>intended<span class="w"> </span>only<span class="w"> </span><span class="k">for</span>
</span><span id="__span-26-30"><a id="__codelineno-26-30" name="__codelineno-26-30" href="#__codelineno-26-30"></a>testing,<span class="w"> </span>and<span class="w"> </span>to<span class="w"> </span>make<span class="w"> </span>the<span class="w"> </span>installation<span class="w"> </span>go<span class="w"> </span>a<span class="w"> </span>bit<span class="w"> </span>smoother.
</span><span id="__span-26-31"><a id="__codelineno-26-31" name="__codelineno-26-31" href="#__codelineno-26-31"></a>You<span class="w"> </span>should<span class="w"> </span>remove<span class="w"> </span>them<span class="w"> </span>before<span class="w"> </span>moving<span class="w"> </span>into<span class="w"> </span>a<span class="w"> </span>production
</span><span id="__span-26-32"><a id="__codelineno-26-32" name="__codelineno-26-32" href="#__codelineno-26-32"></a>environment.
</span><span id="__span-26-33"><a id="__codelineno-26-33" name="__codelineno-26-33" href="#__codelineno-26-33"></a>
</span><span id="__span-26-34"><a id="__codelineno-26-34" name="__codelineno-26-34" href="#__codelineno-26-34"></a>Remove<span class="w"> </span>anonymous<span class="w"> </span>users?<span class="w"> </span><span class="o">(</span>Press<span class="w"> </span>y<span class="p">|</span>Y<span class="w"> </span><span class="k">for</span><span class="w"> </span>Yes,<span class="w"> </span>any<span class="w"> </span>other<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>No<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>y
</span><span id="__span-26-35"><a id="__codelineno-26-35" name="__codelineno-26-35" href="#__codelineno-26-35"></a>Success.
</span><span id="__span-26-36"><a id="__codelineno-26-36" name="__codelineno-26-36" href="#__codelineno-26-36"></a>
</span><span id="__span-26-37"><a id="__codelineno-26-37" name="__codelineno-26-37" href="#__codelineno-26-37"></a>
</span><span id="__span-26-38"><a id="__codelineno-26-38" name="__codelineno-26-38" href="#__codelineno-26-38"></a>Normally,<span class="w"> </span>root<span class="w"> </span>should<span class="w"> </span>only<span class="w"> </span>be<span class="w"> </span>allowed<span class="w"> </span>to<span class="w"> </span>connect<span class="w"> </span>from
</span><span id="__span-26-39"><a id="__codelineno-26-39" name="__codelineno-26-39" href="#__codelineno-26-39"></a><span class="s1">&#39;localhost&#39;</span>.<span class="w"> </span>This<span class="w"> </span>ensures<span class="w"> </span>that<span class="w"> </span>someone<span class="w"> </span>cannot<span class="w"> </span>guess<span class="w"> </span>at
</span><span id="__span-26-40"><a id="__codelineno-26-40" name="__codelineno-26-40" href="#__codelineno-26-40"></a>the<span class="w"> </span>root<span class="w"> </span>password<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>network.
</span><span id="__span-26-41"><a id="__codelineno-26-41" name="__codelineno-26-41" href="#__codelineno-26-41"></a>
</span><span id="__span-26-42"><a id="__codelineno-26-42" name="__codelineno-26-42" href="#__codelineno-26-42"></a>Disallow<span class="w"> </span>root<span class="w"> </span>login<span class="w"> </span>remotely?<span class="w"> </span><span class="o">(</span>Press<span class="w"> </span>y<span class="p">|</span>Y<span class="w"> </span><span class="k">for</span><span class="w"> </span>Yes,<span class="w"> </span>any<span class="w"> </span>other<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>No<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>n
</span><span id="__span-26-43"><a id="__codelineno-26-43" name="__codelineno-26-43" href="#__codelineno-26-43"></a>
</span><span id="__span-26-44"><a id="__codelineno-26-44" name="__codelineno-26-44" href="#__codelineno-26-44"></a><span class="w"> </span>...<span class="w"> </span>skipping.
</span><span id="__span-26-45"><a id="__codelineno-26-45" name="__codelineno-26-45" href="#__codelineno-26-45"></a>By<span class="w"> </span>default,<span class="w"> </span>MySQL<span class="w"> </span>comes<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>database<span class="w"> </span>named<span class="w"> </span><span class="s1">&#39;test&#39;</span><span class="w"> </span>that
</span><span id="__span-26-46"><a id="__codelineno-26-46" name="__codelineno-26-46" href="#__codelineno-26-46"></a>anyone<span class="w"> </span>can<span class="w"> </span>access.<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>also<span class="w"> </span>intended<span class="w"> </span>only<span class="w"> </span><span class="k">for</span><span class="w"> </span>testing,
</span><span id="__span-26-47"><a id="__codelineno-26-47" name="__codelineno-26-47" href="#__codelineno-26-47"></a>and<span class="w"> </span>should<span class="w"> </span>be<span class="w"> </span>removed<span class="w"> </span>before<span class="w"> </span>moving<span class="w"> </span>into<span class="w"> </span>a<span class="w"> </span>production
</span><span id="__span-26-48"><a id="__codelineno-26-48" name="__codelineno-26-48" href="#__codelineno-26-48"></a>environment.
</span><span id="__span-26-49"><a id="__codelineno-26-49" name="__codelineno-26-49" href="#__codelineno-26-49"></a>
</span><span id="__span-26-50"><a id="__codelineno-26-50" name="__codelineno-26-50" href="#__codelineno-26-50"></a>
</span><span id="__span-26-51"><a id="__codelineno-26-51" name="__codelineno-26-51" href="#__codelineno-26-51"></a>Remove<span class="w"> </span><span class="nb">test</span><span class="w"> </span>database<span class="w"> </span>and<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>it?<span class="w"> </span><span class="o">(</span>Press<span class="w"> </span>y<span class="p">|</span>Y<span class="w"> </span><span class="k">for</span><span class="w"> </span>Yes,<span class="w"> </span>any<span class="w"> </span>other<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>No<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>y
</span><span id="__span-26-52"><a id="__codelineno-26-52" name="__codelineno-26-52" href="#__codelineno-26-52"></a><span class="w"> </span>-<span class="w"> </span>Dropping<span class="w"> </span><span class="nb">test</span><span class="w"> </span>database...
</span><span id="__span-26-53"><a id="__codelineno-26-53" name="__codelineno-26-53" href="#__codelineno-26-53"></a>Success.
</span><span id="__span-26-54"><a id="__codelineno-26-54" name="__codelineno-26-54" href="#__codelineno-26-54"></a>
</span><span id="__span-26-55"><a id="__codelineno-26-55" name="__codelineno-26-55" href="#__codelineno-26-55"></a><span class="w"> </span>-<span class="w"> </span>Removing<span class="w"> </span>privileges<span class="w"> </span>on<span class="w"> </span><span class="nb">test</span><span class="w"> </span>database...
</span><span id="__span-26-56"><a id="__codelineno-26-56" name="__codelineno-26-56" href="#__codelineno-26-56"></a>Success.
</span><span id="__span-26-57"><a id="__codelineno-26-57" name="__codelineno-26-57" href="#__codelineno-26-57"></a>
</span><span id="__span-26-58"><a id="__codelineno-26-58" name="__codelineno-26-58" href="#__codelineno-26-58"></a>Reloading<span class="w"> </span>the<span class="w"> </span>privilege<span class="w"> </span>tables<span class="w"> </span>will<span class="w"> </span>ensure<span class="w"> </span>that<span class="w"> </span>all<span class="w"> </span>changes
</span><span id="__span-26-59"><a id="__codelineno-26-59" name="__codelineno-26-59" href="#__codelineno-26-59"></a>made<span class="w"> </span>so<span class="w"> </span>far<span class="w"> </span>will<span class="w"> </span>take<span class="w"> </span>effect<span class="w"> </span>immediately.
</span><span id="__span-26-60"><a id="__codelineno-26-60" name="__codelineno-26-60" href="#__codelineno-26-60"></a>
</span><span id="__span-26-61"><a id="__codelineno-26-61" name="__codelineno-26-61" href="#__codelineno-26-61"></a>Reload<span class="w"> </span>privilege<span class="w"> </span>tables<span class="w"> </span>now?<span class="w"> </span><span class="o">(</span>Press<span class="w"> </span>y<span class="p">|</span>Y<span class="w"> </span><span class="k">for</span><span class="w"> </span>Yes,<span class="w"> </span>any<span class="w"> </span>other<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>No<span class="o">)</span><span class="w"> </span>:<span class="w"> </span>y
</span><span id="__span-26-62"><a id="__codelineno-26-62" name="__codelineno-26-62" href="#__codelineno-26-62"></a>Success.
</span><span id="__span-26-63"><a id="__codelineno-26-63" name="__codelineno-26-63" href="#__codelineno-26-63"></a>
</span><span id="__span-26-64"><a id="__codelineno-26-64" name="__codelineno-26-64" href="#__codelineno-26-64"></a>All<span class="w"> </span><span class="k">done</span>!
</span><span id="__span-26-65"><a id="__codelineno-26-65" name="__codelineno-26-65" href="#__codelineno-26-65"></a>root@zbx-test:~/work#
</span></code></pre></div></details>
</li>
</ul>
</li>
</ul>
<h2 id="zabbix-ha">Zabbix HA<a class="headerlink" href="#zabbix-ha" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>https://densan-hoshigumi.com/server/zabbix60-ha-installation#Keepalivedzbx01zbx02</p>
<ul>
<li>
<details class="note">
<summary>zabbix conf</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>@<span class="w"> </span>zabbix_server.conf
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="c1">### active                                                                                   ### standby</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>root@zbx-test:~/work#<span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>^<span class="se">\#</span><span class="w"> </span>/etc/zabbix/zabbix_server.conf<span class="w">  </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>^<span class="se">\$</span><span class="w">             </span>│root@zbx-test02:~/work#<span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>^<span class="se">\#</span><span class="w"> </span>/etc/zabbix/zabbix_server.conf<span class="w">  </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>^<span class="se">\$</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="nv">LogFile</span><span class="o">=</span>/var/log/zabbix/zabbix_server.log<span class="w">                                                   </span>│LogFile<span class="o">=</span>/var/log/zabbix/zabbix_server.log
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="nv">LogFileSize</span><span class="o">=</span><span class="m">0</span><span class="w">                                                                               </span>│LogFileSize<span class="o">=</span><span class="m">0</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="nv">PidFile</span><span class="o">=</span>/run/zabbix/zabbix_server.pid<span class="w">                                                       </span>│PidFile<span class="o">=</span>/run/zabbix/zabbix_server.pid
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="nv">SocketDir</span><span class="o">=</span>/run/zabbix<span class="w">                                                                       </span>│SocketDir<span class="o">=</span>/run/zabbix
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="nv">DBName</span><span class="o">=</span>zabbix<span class="w">                                                                               </span>│DBName<span class="o">=</span>zabbix
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="nv">DBUser</span><span class="o">=</span>zabbix<span class="w">                                                                               </span>│DBUser<span class="o">=</span>zabbix
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="nv">DBPassword</span><span class="o">=</span>password<span class="w">                                                                         </span>│DBPassword<span class="o">=</span>password
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="nv">DBSocket</span><span class="o">=</span>/var/run/mysqld/mysqld.sock<span class="w">                                                        </span>│DBHost<span class="o">=</span><span class="m">192</span>.168.1.2
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="nv">SNMPTrapperFile</span><span class="o">=</span>/var/log/snmptrap/snmptrap.log<span class="w">                                              </span>│SNMPTrapperFile<span class="o">=</span>/var/log/snmptrap/snmptrap.log
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="nv">Timeout</span><span class="o">=</span><span class="m">4</span><span class="w">                                                                                   </span>│Timeout<span class="o">=</span><span class="m">4</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="nv">FpingLocation</span><span class="o">=</span>/usr/bin/fping<span class="w">                                                                </span>│FpingLocation<span class="o">=</span>/usr/bin/fping
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="nv">Fping6Location</span><span class="o">=</span>/usr/bin/fping6<span class="w">                                                              </span>│Fping6Location<span class="o">=</span>/usr/bin/fping6
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a><span class="nv">LogSlowQueries</span><span class="o">=</span><span class="m">3000</span><span class="w">                                                                         </span>│LogSlowQueries<span class="o">=</span><span class="m">3000</span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="nv">AllowRoot</span><span class="o">=</span><span class="m">1</span><span class="w">                                                                                 </span>│AllowRoot<span class="o">=</span><span class="m">1</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a><span class="nv">User</span><span class="o">=</span>root<span class="w">                                                                                   </span>│User<span class="o">=</span>root
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="nv">StatsAllowedIP</span><span class="o">=</span><span class="m">127</span>.0.0.1<span class="w">                                                                    </span>│StatsAllowedIP<span class="o">=</span><span class="m">127</span>.0.0.1
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a><span class="nv">HANodeName</span><span class="o">=</span>zbx01<span class="w">                                                                            </span>│HANodeName<span class="o">=</span>zbx02
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a><span class="nv">NodeAddress</span><span class="o">=</span><span class="m">192</span>.168.1.1:10051<span class="w">                                                               </span>│NodeAddress<span class="o">=</span><span class="m">192</span>.168.1.2:10051
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a>root@zbx-test:~/work#<span class="w">                                                                       </span>│root@zbx-test02:~/work#
</span><span id="__span-27-24"><a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a>
</span><span id="__span-27-25"><a id="__codelineno-27-25" name="__codelineno-27-25" href="#__codelineno-27-25"></a>
</span><span id="__span-27-26"><a id="__codelineno-27-26" name="__codelineno-27-26" href="#__codelineno-27-26"></a>@zabbix_agent2.conf
</span><span id="__span-27-27"><a id="__codelineno-27-27" name="__codelineno-27-27" href="#__codelineno-27-27"></a><span class="c1">### active                                                                                   ### standby</span>
</span><span id="__span-27-28"><a id="__codelineno-27-28" name="__codelineno-27-28" href="#__codelineno-27-28"></a>
</span><span id="__span-27-29"><a id="__codelineno-27-29" name="__codelineno-27-29" href="#__codelineno-27-29"></a>root@zbx-test:~/work#<span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>^<span class="se">\#</span><span class="w"> </span>/etc/zabbix/zabbix_agent2.conf<span class="w">  </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>^<span class="se">\$</span><span class="w">             </span>│root@zbx-test02:~/work#<span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>^<span class="se">\#</span><span class="w"> </span>/etc/zabbix/zabbix_agent2.conf<span class="w">  </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>^<span class="se">\$</span>
</span><span id="__span-27-30"><a id="__codelineno-27-30" name="__codelineno-27-30" href="#__codelineno-27-30"></a><span class="nv">PidFile</span><span class="o">=</span>/var/run/zabbix/zabbix_agent2.pid<span class="w">                                                   </span>│PidFile<span class="o">=</span>/var/run/zabbix/zabbix_agent2.pid
</span><span id="__span-27-31"><a id="__codelineno-27-31" name="__codelineno-27-31" href="#__codelineno-27-31"></a><span class="nv">LogFile</span><span class="o">=</span>/var/log/zabbix/zabbix_agent2.log<span class="w">                                                   </span>│LogFile<span class="o">=</span>/var/log/zabbix/zabbix_agent2.log
</span><span id="__span-27-32"><a id="__codelineno-27-32" name="__codelineno-27-32" href="#__codelineno-27-32"></a><span class="nv">LogFileSize</span><span class="o">=</span><span class="m">0</span><span class="w">                                                                               </span>│LogFileSize<span class="o">=</span><span class="m">0</span>
</span><span id="__span-27-33"><a id="__codelineno-27-33" name="__codelineno-27-33" href="#__codelineno-27-33"></a><span class="nv">Server</span><span class="o">=</span><span class="m">127</span>.0.0.1,192.168.1.1,192.168.1.2<span class="w">                                                    </span>│Server<span class="o">=</span><span class="m">127</span>.0.0.1,192.168.1.1,192.168.1.2
</span><span id="__span-27-34"><a id="__codelineno-27-34" name="__codelineno-27-34" href="#__codelineno-27-34"></a><span class="nv">ServerActive</span><span class="o">=</span><span class="m">127</span>.0.0.1,192.168.1.1,192.168.1.2<span class="w">                                              </span>│ServerActive<span class="o">=</span><span class="m">127</span>.0.0.1,192.168.1.1,192.168.1.2
</span><span id="__span-27-35"><a id="__codelineno-27-35" name="__codelineno-27-35" href="#__codelineno-27-35"></a><span class="nv">Hostname</span><span class="o">=</span>Zabbix<span class="w"> </span>server<span class="w">                                                                      </span>│Hostname<span class="o">=</span>Zabbix<span class="w"> </span>server
</span><span id="__span-27-36"><a id="__codelineno-27-36" name="__codelineno-27-36" href="#__codelineno-27-36"></a><span class="nv">Include</span><span class="o">=</span>/etc/zabbix/zabbix_agent2.d/*.conf<span class="w">                                                  </span>│Include<span class="o">=</span>/etc/zabbix/zabbix_agent2.d/*.conf
</span><span id="__span-27-37"><a id="__codelineno-27-37" name="__codelineno-27-37" href="#__codelineno-27-37"></a><span class="nv">ControlSocket</span><span class="o">=</span>/tmp/agent.sock<span class="w">                                                               </span>│ControlSocket<span class="o">=</span>/tmp/agent.sock
</span><span id="__span-27-38"><a id="__codelineno-27-38" name="__codelineno-27-38" href="#__codelineno-27-38"></a><span class="nv">Include</span><span class="o">=</span>./zabbix_agent2.d/plugins.d/*.conf<span class="w">                                                  </span>│Include<span class="o">=</span>./zabbix_agent2.d/plugins.d/*.conf
</span><span id="__span-27-39"><a id="__codelineno-27-39" name="__codelineno-27-39" href="#__codelineno-27-39"></a>root@zbx-test:~/work#<span class="w">                                                                       </span>│root@zbx-test02:~/work#
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>statusの確認</p>
<ul>
<li>
<details class="note">
<summary>status</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># Active Server</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>root@zbx-test01:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>Failover<span class="w"> </span>delay:<span class="w"> </span><span class="m">60</span><span class="w"> </span>seconds
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>Cluster<span class="w"> </span>status:
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">   </span><span class="c1">#  ID                        Name                      Address                        Status      Last Access</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="w">   </span><span class="m">1</span>.<span class="w"> </span>cl4nhimlf00019oodk3coe857<span class="w"> </span>zbx01<span class="w">                     </span><span class="m">192</span>.168.1.1:10051<span class="w">              </span>active<span class="w">      </span>5s
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="w">   </span><span class="m">2</span>.<span class="w"> </span>cl4nlsqlk0001b9r5amp9jryp<span class="w"> </span>zbx02<span class="w">                     </span><span class="m">192</span>.168.1.2:10051<span class="w">              </span>standby<span class="w">     </span>2s
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>root@zbx-test01:~/work#
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="c1"># Standby Server</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>root@zbx-test02:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>Runtime<span class="w"> </span>commands<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>executed<span class="w"> </span>only<span class="w"> </span><span class="k">in</span><span class="w"> </span>active<span class="w"> </span>mode
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>root@zbx-test02:~/work#
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>フェイルオーバー試験（HAの切り替え検証）</p>
<ul>
<li>
<details class="note">
<summary>Activeを停止</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>@<span class="w"> </span>切り替え前
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>root@zbx-test01:~/work#<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>zabbix-server.service
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>●<span class="w"> </span>zabbix-server.service<span class="w"> </span>-<span class="w"> </span>Zabbix<span class="w"> </span>Server
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">     </span>Loaded:<span class="w"> </span>loaded<span class="w"> </span><span class="o">(</span>/lib/systemd/system/zabbix-server.service<span class="p">;</span><span class="w"> </span>enabled<span class="p">;</span><span class="w"> </span>vendor<span class="w"> </span>preset:<span class="w"> </span>enabled<span class="o">)</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">     </span>Active:<span class="w"> </span>active<span class="w"> </span><span class="o">(</span>running<span class="o">)</span><span class="w"> </span>since<span class="w"> </span>Tue<span class="w"> </span><span class="m">2022</span>-06-21<span class="w"> </span><span class="m">10</span>:25:20<span class="w"> </span>JST<span class="p">;</span><span class="w"> </span>3h<span class="w"> </span>2min<span class="w"> </span>ago
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">   </span>Main<span class="w"> </span>PID:<span class="w"> </span><span class="m">101435</span><span class="w"> </span><span class="o">(</span>zabbix_server<span class="o">)</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">      </span>Tasks:<span class="w"> </span><span class="m">48</span><span class="w"> </span><span class="o">(</span>limit:<span class="w"> </span><span class="m">19174</span><span class="o">)</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">     </span>Memory:<span class="w"> </span><span class="m">57</span>.0M
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w">     </span>CGroup:<span class="w"> </span>/system.slice/zabbix-server.service
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w">             </span>├─101435<span class="w"> </span>/usr/sbin/zabbix_server<span class="w"> </span>-c<span class="w"> </span>/etc/zabbix/zabbix_server.conf
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="w">             </span>├─101436<span class="w"> </span>/usr/sbin/zabbix_server:<span class="w"> </span>ha<span class="w"> </span>manager
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>root@zbx-test01:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>Failover<span class="w"> </span>delay:<span class="w"> </span><span class="m">60</span><span class="w"> </span>seconds
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a>Cluster<span class="w"> </span>status:
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a><span class="w">   </span><span class="c1">#  ID                        Name                      Address                        Status      Last Access</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a><span class="w">   </span><span class="m">1</span>.<span class="w"> </span>cl4nhimlf00019oodk3coe857<span class="w"> </span>zbx01<span class="w">                     </span><span class="m">192</span>.168.1.1:10051<span class="w">              </span>active<span class="w">      </span>4s
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a><span class="w">   </span><span class="m">2</span>.<span class="w"> </span>cl4nlsqlk0001b9r5amp9jryp<span class="w"> </span>zbx02<span class="w">                     </span><span class="m">192</span>.168.1.2:10051<span class="w">              </span>standby<span class="w">     </span>1s
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a>root@zbx-test01:~/work#
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a>
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a>
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a>root@zbx-test01:~/work#<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>zabbix-server.service
</span><span id="__span-29-23"><a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a>root@zbx-test01:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-29-24"><a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a>zabbix_server<span class="w"> </span><span class="o">[</span><span class="m">105596</span><span class="o">]</span>:<span class="w"> </span>Cannot<span class="w"> </span>perform<span class="w"> </span>runtime<span class="w"> </span>control<span class="w"> </span>command:<span class="w"> </span>Cannot<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>service<span class="w"> </span><span class="s2">&quot;rtc&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">111</span><span class="o">]</span><span class="w"> </span>Connection<span class="w"> </span>refused.
</span><span id="__span-29-25"><a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a>root@zbx-test01:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-29-26"><a id="__codelineno-29-26" name="__codelineno-29-26" href="#__codelineno-29-26"></a>zabbix_server<span class="w"> </span><span class="o">[</span><span class="m">105598</span><span class="o">]</span>:<span class="w"> </span>Cannot<span class="w"> </span>perform<span class="w"> </span>runtime<span class="w"> </span>control<span class="w"> </span>command:<span class="w"> </span>Cannot<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>service<span class="w"> </span><span class="s2">&quot;rtc&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">111</span><span class="o">]</span><span class="w"> </span>Connection<span class="w"> </span>refused.
</span><span id="__span-29-27"><a id="__codelineno-29-27" name="__codelineno-29-27" href="#__codelineno-29-27"></a>root@zbx-test01:~/work#<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>zabbix-server.service
</span><span id="__span-29-28"><a id="__codelineno-29-28" name="__codelineno-29-28" href="#__codelineno-29-28"></a>●<span class="w"> </span>zabbix-server.service<span class="w"> </span>-<span class="w"> </span>Zabbix<span class="w"> </span>Server
</span><span id="__span-29-29"><a id="__codelineno-29-29" name="__codelineno-29-29" href="#__codelineno-29-29"></a><span class="w">     </span>Loaded:<span class="w"> </span>loaded<span class="w"> </span><span class="o">(</span>/lib/systemd/system/zabbix-server.service<span class="p">;</span><span class="w"> </span>enabled<span class="p">;</span><span class="w"> </span>vendor<span class="w"> </span>preset:<span class="w"> </span>enabled<span class="o">)</span>
</span><span id="__span-29-30"><a id="__codelineno-29-30" name="__codelineno-29-30" href="#__codelineno-29-30"></a><span class="w">     </span>Active:<span class="w"> </span>inactive<span class="w"> </span><span class="o">(</span>dead<span class="o">)</span><span class="w"> </span>since<span class="w"> </span>Tue<span class="w"> </span><span class="m">2022</span>-06-21<span class="w"> </span><span class="m">13</span>:28:51<span class="w"> </span>JST<span class="p">;</span><span class="w"> </span>30s<span class="w"> </span>ago
</span><span id="__span-29-31"><a id="__codelineno-29-31" name="__codelineno-29-31" href="#__codelineno-29-31"></a><span class="w">    </span>Process:<span class="w"> </span><span class="m">105563</span><span class="w"> </span><span class="nv">ExecStop</span><span class="o">=</span>/bin/sh<span class="w"> </span>-c<span class="w"> </span><span class="o">[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">kill</span><span class="w"> </span>-s<span class="w"> </span>TERM<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>--<span class="w"> </span><span class="nv">$MAINPID</span><span class="w"> </span><span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited,<span class="w"> </span><span class="nv">status</span><span class="o">=</span><span class="m">0</span>/SUCCESS<span class="o">)</span>
</span><span id="__span-29-32"><a id="__codelineno-29-32" name="__codelineno-29-32" href="#__codelineno-29-32"></a><span class="w">   </span>Main<span class="w"> </span>PID:<span class="w"> </span><span class="m">101435</span><span class="w"> </span><span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited,<span class="w"> </span><span class="nv">status</span><span class="o">=</span><span class="m">0</span>/SUCCESS<span class="o">)</span>
</span><span id="__span-29-33"><a id="__codelineno-29-33" name="__codelineno-29-33" href="#__codelineno-29-33"></a>
</span><span id="__span-29-34"><a id="__codelineno-29-34" name="__codelineno-29-34" href="#__codelineno-29-34"></a>Jun<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">10</span>:25:19<span class="w"> </span>zbx-test<span class="w"> </span>systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>:<span class="w"> </span>Starting<span class="w"> </span>Zabbix<span class="w"> </span>Server...
</span><span id="__span-29-35"><a id="__codelineno-29-35" name="__codelineno-29-35" href="#__codelineno-29-35"></a>Jun<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">10</span>:25:20<span class="w"> </span>zbx-test<span class="w"> </span>systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>:<span class="w"> </span>Started<span class="w"> </span>Zabbix<span class="w"> </span>Server.
</span><span id="__span-29-36"><a id="__codelineno-29-36" name="__codelineno-29-36" href="#__codelineno-29-36"></a>Jun<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">13</span>:28:49<span class="w"> </span>zbx-test01<span class="w"> </span>systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>:<span class="w"> </span>Stopping<span class="w"> </span>Zabbix<span class="w"> </span>Server...
</span><span id="__span-29-37"><a id="__codelineno-29-37" name="__codelineno-29-37" href="#__codelineno-29-37"></a>Jun<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">13</span>:28:51<span class="w"> </span>zbx-test01<span class="w"> </span>systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>:<span class="w"> </span>zabbix-server.service:<span class="w"> </span>Succeeded.
</span><span id="__span-29-38"><a id="__codelineno-29-38" name="__codelineno-29-38" href="#__codelineno-29-38"></a>Jun<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">13</span>:28:51<span class="w"> </span>zbx-test01<span class="w"> </span>systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>:<span class="w"> </span>Stopped<span class="w"> </span>Zabbix<span class="w"> </span>Server.
</span><span id="__span-29-39"><a id="__codelineno-29-39" name="__codelineno-29-39" href="#__codelineno-29-39"></a>root@zbx-test01:~/work#
</span><span id="__span-29-40"><a id="__codelineno-29-40" name="__codelineno-29-40" href="#__codelineno-29-40"></a>
</span><span id="__span-29-41"><a id="__codelineno-29-41" name="__codelineno-29-41" href="#__codelineno-29-41"></a>@<span class="w"> </span>ログの確認
</span><span id="__span-29-42"><a id="__codelineno-29-42" name="__codelineno-29-42" href="#__codelineno-29-42"></a>root@zbx-test01:~/work#<span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">15</span><span class="w">  </span>/var/log/zabbix/zabbix_server.log
</span><span id="__span-29-43"><a id="__codelineno-29-43" name="__codelineno-29-43" href="#__codelineno-29-43"></a><span class="m">1</span>.<span class="w"> </span>Failed:<span class="w"> </span>cannot<span class="w"> </span>extract<span class="w"> </span>value<span class="w"> </span>from<span class="w"> </span>json<span class="w"> </span>by<span class="w"> </span>path<span class="w"> </span><span class="s2">&quot;</span>$<span class="s2">.[?(@.id==&quot;</span>cl4i2tw6c0001e9odvm47jvrq<span class="s2">&quot;)].address.first()&quot;</span>:<span class="w"> </span>no<span class="w"> </span>data<span class="w"> </span>matches<span class="w"> </span>the<span class="w"> </span>specified<span class="w"> </span>path
</span><span id="__span-29-44"><a id="__codelineno-29-44" name="__codelineno-29-44" href="#__codelineno-29-44"></a><span class="m">101435</span>:20220621:132828.196<span class="w"> </span>failover<span class="w"> </span>delay:<span class="w"> </span><span class="m">60</span><span class="w"> </span>seconds
</span><span id="__span-29-45"><a id="__codelineno-29-45" name="__codelineno-29-45" href="#__codelineno-29-45"></a><span class="m">101435</span>:20220621:132828.196<span class="w"> </span>cluster<span class="w"> </span>status:
</span><span id="__span-29-46"><a id="__codelineno-29-46" name="__codelineno-29-46" href="#__codelineno-29-46"></a><span class="m">101435</span>:20220621:132828.196<span class="w">    </span><span class="c1">#  ID                        Name                      Address                        Status      Last Access</span>
</span><span id="__span-29-47"><a id="__codelineno-29-47" name="__codelineno-29-47" href="#__codelineno-29-47"></a><span class="m">101435</span>:20220621:132828.196<span class="w">    </span><span class="m">1</span>.<span class="w"> </span>cl4nhimlf00019oodk3coe857<span class="w"> </span>zbx01<span class="w">                     </span><span class="m">192</span>.168.1.1:10051<span class="w">              </span>active<span class="w">      </span>4s
</span><span id="__span-29-48"><a id="__codelineno-29-48" name="__codelineno-29-48" href="#__codelineno-29-48"></a><span class="m">101435</span>:20220621:132828.196<span class="w">    </span><span class="m">2</span>.<span class="w"> </span>cl4nlsqlk0001b9r5amp9jryp<span class="w"> </span>zbx02<span class="w">                     </span><span class="m">192</span>.168.1.2:10051<span class="w">              </span>standby<span class="w">     </span>1s
</span><span id="__span-29-49"><a id="__codelineno-29-49" name="__codelineno-29-49" href="#__codelineno-29-49"></a><span class="m">101435</span>:20220621:132849.020<span class="w"> </span>Got<span class="w"> </span>signal<span class="w"> </span><span class="o">[</span>signal:15<span class="o">(</span>SIGTERM<span class="o">)</span>,sender_pid:105563,sender_uid:0,reason:0<span class="o">]</span>.<span class="w"> </span>Exiting<span class="w"> </span>...
</span><span id="__span-29-50"><a id="__codelineno-29-50" name="__codelineno-29-50" href="#__codelineno-29-50"></a><span class="m">101436</span>:20220621:132849.984<span class="w"> </span>HA<span class="w"> </span>manager<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>paused
</span><span id="__span-29-51"><a id="__codelineno-29-51" name="__codelineno-29-51" href="#__codelineno-29-51"></a><span class="m">101455</span>:20220621:132849.984<span class="w"> </span>syncing<span class="w"> </span><span class="nb">history</span><span class="w"> </span>data<span class="w"> </span><span class="k">in</span><span class="w"> </span>progress...
</span><span id="__span-29-52"><a id="__codelineno-29-52" name="__codelineno-29-52" href="#__codelineno-29-52"></a><span class="m">101457</span>:20220621:132850.002<span class="w"> </span>syncing<span class="w"> </span><span class="nb">history</span><span class="w"> </span>data...<span class="w"> </span><span class="m">100</span>.000000%
</span><span id="__span-29-53"><a id="__codelineno-29-53" name="__codelineno-29-53" href="#__codelineno-29-53"></a><span class="m">101457</span>:20220621:132850.002<span class="w"> </span>syncing<span class="w"> </span><span class="nb">history</span><span class="w"> </span>data<span class="w"> </span><span class="k">done</span>
</span><span id="__span-29-54"><a id="__codelineno-29-54" name="__codelineno-29-54" href="#__codelineno-29-54"></a><span class="m">101435</span>:20220621:132851.002<span class="w"> </span>syncing<span class="w"> </span>trend<span class="w"> </span>data...
</span><span id="__span-29-55"><a id="__codelineno-29-55" name="__codelineno-29-55" href="#__codelineno-29-55"></a><span class="m">101435</span>:20220621:132851.045<span class="w"> </span>syncing<span class="w"> </span>trend<span class="w"> </span>data<span class="w"> </span><span class="k">done</span>
</span><span id="__span-29-56"><a id="__codelineno-29-56" name="__codelineno-29-56" href="#__codelineno-29-56"></a><span class="m">101436</span>:20220621:132851.069<span class="w"> </span>HA<span class="w"> </span>manager<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>stopped
</span><span id="__span-29-57"><a id="__codelineno-29-57" name="__codelineno-29-57" href="#__codelineno-29-57"></a><span class="m">101435</span>:20220621:132851.074<span class="w"> </span>Zabbix<span class="w"> </span>Server<span class="w"> </span>stopped.<span class="w"> </span>Zabbix<span class="w"> </span><span class="m">6</span>.0.5<span class="w"> </span><span class="o">(</span>revision<span class="w"> </span>8da3e1f8419<span class="o">)</span>.
</span><span id="__span-29-58"><a id="__codelineno-29-58" name="__codelineno-29-58" href="#__codelineno-29-58"></a>root@zbx-test01:~/work#
</span></code></pre></div></details>
</li>
<li>
<details class="note">
<summary>StandByの確認</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1"># 切り替え前</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>root@zbx-test02:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>Runtime<span class="w"> </span>commands<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>executed<span class="w"> </span>only<span class="w"> </span><span class="k">in</span><span class="w"> </span>active<span class="w"> </span>mode
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>root@zbx-test02:~/work#<span class="w"> </span>tail<span class="w"> </span>-f<span class="w">  </span>/var/log/zabbix/zabbix_server.log
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.236<span class="w"> </span>IPv6<span class="w"> </span>support:<span class="w">              </span>YES
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.236<span class="w"> </span>TLS<span class="w"> </span>support:<span class="w">               </span>YES
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.236<span class="w"> </span>******************************
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.236<span class="w"> </span>using<span class="w"> </span>configuration<span class="w"> </span>file:<span class="w"> </span>/etc/zabbix/zabbix_server.conf
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.293<span class="w"> </span>current<span class="w"> </span>database<span class="w"> </span>version<span class="w"> </span><span class="o">(</span>mandatory/optional<span class="o">)</span>:<span class="w"> </span><span class="m">06000000</span>/06000002
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.293<span class="w"> </span>required<span class="w"> </span>mandatory<span class="w"> </span>version:<span class="w"> </span><span class="m">06000000</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="w"> </span><span class="m">14868</span>:20220621:122723.324<span class="w"> </span>starting<span class="w"> </span>HA<span class="w"> </span>manager
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="w"> </span><span class="m">14868</span>:20220621:122723.348<span class="w"> </span>HA<span class="w"> </span>manager<span class="w"> </span>started<span class="w"> </span><span class="k">in</span><span class="w"> </span>standby<span class="w"> </span>mode
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.348<span class="w"> </span><span class="s2">&quot;zbx02&quot;</span><span class="w"> </span>node<span class="w"> </span>started<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;standby&quot;</span><span class="w"> </span>mode
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="w"> </span><span class="m">14862</span>:20220621:132723.338<span class="w"> </span><span class="s2">&quot;zbx02&quot;</span><span class="w"> </span>node<span class="w"> </span>is<span class="w"> </span>working<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;standby&quot;</span><span class="w"> </span>mode
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="c1"># 切り替え後</span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a>root@zbx-test02:~/work#<span class="w"> </span>tail<span class="w"> </span>-f<span class="w">  </span>/var/log/zabbix/zabbix_server.log
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.236<span class="w"> </span>IPv6<span class="w"> </span>support:<span class="w">              </span>YES
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.236<span class="w"> </span>TLS<span class="w"> </span>support:<span class="w">               </span>YES
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.236<span class="w"> </span>******************************
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.236<span class="w"> </span>using<span class="w"> </span>configuration<span class="w"> </span>file:<span class="w"> </span>/etc/zabbix/zabbix_server.conf
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.293<span class="w"> </span>current<span class="w"> </span>database<span class="w"> </span>version<span class="w"> </span><span class="o">(</span>mandatory/optional<span class="o">)</span>:<span class="w"> </span><span class="m">06000000</span>/06000002
</span><span id="__span-30-26"><a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.293<span class="w"> </span>required<span class="w"> </span>mandatory<span class="w"> </span>version:<span class="w"> </span><span class="m">06000000</span>
</span><span id="__span-30-27"><a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a><span class="w"> </span><span class="m">14868</span>:20220621:122723.324<span class="w"> </span>starting<span class="w"> </span>HA<span class="w"> </span>manager
</span><span id="__span-30-28"><a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a><span class="w"> </span><span class="m">14868</span>:20220621:122723.348<span class="w"> </span>HA<span class="w"> </span>manager<span class="w"> </span>started<span class="w"> </span><span class="k">in</span><span class="w"> </span>standby<span class="w"> </span>mode
</span><span id="__span-30-29"><a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a><span class="w"> </span><span class="m">14862</span>:20220621:122723.348<span class="w"> </span><span class="s2">&quot;zbx02&quot;</span><span class="w"> </span>node<span class="w"> </span>started<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;standby&quot;</span><span class="w"> </span>mode
</span><span id="__span-30-30"><a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a><span class="w"> </span><span class="m">14862</span>:20220621:132723.338<span class="w"> </span><span class="s2">&quot;zbx02&quot;</span><span class="w"> </span>node<span class="w"> </span>is<span class="w"> </span>working<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;standby&quot;</span><span class="w"> </span>mode
</span><span id="__span-30-31"><a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a>
</span><span id="__span-30-32"><a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a>↓↓↓ここから切り替え発生
</span><span id="__span-30-33"><a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a><span class="w"> </span><span class="m">14862</span>:20220621:132852.342<span class="w"> </span><span class="s2">&quot;zbx02&quot;</span><span class="w"> </span>node<span class="w"> </span>switched<span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;active&quot;</span><span class="w"> </span>mode
</span><span id="__span-30-34"><a id="__codelineno-30-34" name="__codelineno-30-34" href="#__codelineno-30-34"></a><span class="w"> </span><span class="m">14862</span>:20220621:132852.343<span class="w"> </span>server<span class="w"> </span><span class="c1">#0 started [main process]</span>
</span><span id="__span-30-35"><a id="__codelineno-30-35" name="__codelineno-30-35" href="#__codelineno-30-35"></a><span class="w"> </span><span class="m">15461</span>:20220621:132852.344<span class="w"> </span>server<span class="w"> </span><span class="c1">#1 started [service manager #1]</span>
</span><span id="__span-30-36"><a id="__codelineno-30-36" name="__codelineno-30-36" href="#__codelineno-30-36"></a><span class="w"> </span><span class="m">15462</span>:20220621:132852.345<span class="w"> </span>server<span class="w"> </span><span class="c1">#2 started [configuration syncer #1]</span>
</span><span id="__span-30-37"><a id="__codelineno-30-37" name="__codelineno-30-37" href="#__codelineno-30-37"></a><span class="w"> </span><span class="m">15466</span>:20220621:132852.630<span class="w"> </span>server<span class="w"> </span><span class="c1">#3 started [alert manager #1]</span>
</span><span id="__span-30-38"><a id="__codelineno-30-38" name="__codelineno-30-38" href="#__codelineno-30-38"></a><span class="w"> </span><span class="m">15467</span>:20220621:132852.630<span class="w"> </span>server<span class="w"> </span><span class="c1">#4 started [alerter #1]</span>
</span><span id="__span-30-39"><a id="__codelineno-30-39" name="__codelineno-30-39" href="#__codelineno-30-39"></a><span class="w"> </span><span class="m">15468</span>:20220621:132852.631<span class="w"> </span>server<span class="w"> </span><span class="c1">#5 started [alerter #2]</span>
</span><span id="__span-30-40"><a id="__codelineno-30-40" name="__codelineno-30-40" href="#__codelineno-30-40"></a>
</span><span id="__span-30-41"><a id="__codelineno-30-41" name="__codelineno-30-41" href="#__codelineno-30-41"></a><span class="c1"># statusの確認</span>
</span><span id="__span-30-42"><a id="__codelineno-30-42" name="__codelineno-30-42" href="#__codelineno-30-42"></a>root@zbx-test02:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-30-43"><a id="__codelineno-30-43" name="__codelineno-30-43" href="#__codelineno-30-43"></a>Failover<span class="w"> </span>delay:<span class="w"> </span><span class="m">60</span><span class="w"> </span>seconds
</span><span id="__span-30-44"><a id="__codelineno-30-44" name="__codelineno-30-44" href="#__codelineno-30-44"></a>Cluster<span class="w"> </span>status:
</span><span id="__span-30-45"><a id="__codelineno-30-45" name="__codelineno-30-45" href="#__codelineno-30-45"></a><span class="w">   </span><span class="c1">#  ID                        Name                      Address                        Status      Last Access</span>
</span><span id="__span-30-46"><a id="__codelineno-30-46" name="__codelineno-30-46" href="#__codelineno-30-46"></a><span class="w">   </span><span class="m">1</span>.<span class="w"> </span>cl4nhimlf00019oodk3coe857<span class="w"> </span>zbx01<span class="w">                     </span><span class="m">192</span>.168.1.1:10051<span class="w">              </span>stopped<span class="w">     </span>42s
</span><span id="__span-30-47"><a id="__codelineno-30-47" name="__codelineno-30-47" href="#__codelineno-30-47"></a><span class="w">   </span><span class="m">2</span>.<span class="w"> </span>cl4nlsqlk0001b9r5amp9jryp<span class="w"> </span>zbx02<span class="w">                     </span><span class="m">192</span>.168.1.2:10051<span class="w">              </span>active<span class="w">      </span>1s<span class="w">               </span>&lt;-<span class="w"> </span>Activeになった。
</span><span id="__span-30-48"><a id="__codelineno-30-48" name="__codelineno-30-48" href="#__codelineno-30-48"></a>root@zbx-test02:~/work#
</span></code></pre></div></details>
</li>
</ul>
</li>
<li>
<p>元に戻す検証</p>
<ul>
<li>
<details class="note">
<summary>test02サーバを停止</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>root@zbx-test02:~/work#<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>zabbix-server.service
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>root@zbx-test02:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>zabbix_server<span class="w"> </span><span class="o">[</span><span class="m">15785</span><span class="o">]</span>:<span class="w"> </span>Cannot<span class="w"> </span>perform<span class="w"> </span>runtime<span class="w"> </span>control<span class="w"> </span>command:<span class="w"> </span>Cannot<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>service<span class="w"> </span><span class="s2">&quot;rtc&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">111</span><span class="o">]</span><span class="w"> </span>Connection<span class="w"> </span>refused.
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>root@zbx-test02:~/work#
</span></code></pre></div></details>
</li>
<li>
<details class="note">
<summary>test01の確認</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>root@zbx-test01:~/work#<span class="w"> </span>tail<span class="w"> </span>-f<span class="w">  </span>/var/log/zabbix/zabbix_server.log
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="m">105884</span>:20220621:135102.065<span class="w"> </span>server<span class="w"> </span><span class="c1">#38 started [alert syncer #1]</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="m">105885</span>:20220621:135102.065<span class="w"> </span>server<span class="w"> </span><span class="c1">#39 started [history poller #1]</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="m">105882</span>:20220621:135102.065<span class="w"> </span>server<span class="w"> </span><span class="c1">#37 started [icmp pinger #1]</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="m">105888</span>:20220621:135102.066<span class="w"> </span>server<span class="w"> </span><span class="c1">#40 started [history poller #2]</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="m">105889</span>:20220621:135102.067<span class="w"> </span>server<span class="w"> </span><span class="c1">#41 started [history poller #3]</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="m">105892</span>:20220621:135102.068<span class="w"> </span>server<span class="w"> </span><span class="c1">#42 started [history poller #4]</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="m">105895</span>:20220621:135102.069<span class="w"> </span>server<span class="w"> </span><span class="c1">#44 started [availability manager #1]</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="m">105898</span>:20220621:135102.069<span class="w"> </span>server<span class="w"> </span><span class="c1">#45 started [trigger housekeeper #1]</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="m">105893</span>:20220621:135102.070<span class="w"> </span>server<span class="w"> </span><span class="c1">#43 started [history poller #5]</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="m">105901</span>:20220621:135102.073<span class="w"> </span>server<span class="w"> </span><span class="c1">#46 started [odbc poller #1]</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>^C
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>root@zbx-test01:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>Failover<span class="w"> </span>delay:<span class="w"> </span><span class="m">60</span><span class="w"> </span>seconds
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>Cluster<span class="w"> </span>status:
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a><span class="w">   </span><span class="c1">#  ID                        Name                      Address                        Status      Last Access</span>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a><span class="w">   </span><span class="m">1</span>.<span class="w"> </span>cl4nhimlf00019oodk3coe857<span class="w"> </span>zbx01<span class="w">                     </span><span class="m">192</span>.168.1.1:10051<span class="w">              </span>active<span class="w">      </span>3s
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a><span class="w">   </span><span class="m">2</span>.<span class="w"> </span>cl4nlsqlk0001b9r5amp9jryp<span class="w"> </span>zbx02<span class="w">                     </span><span class="m">192</span>.168.1.2:10051<span class="w">              </span>stopped<span class="w">     </span>22s
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a>root@zbx-test01:~/work#
</span></code></pre></div>
</details>
</li>
<li>
<details class="note">
<summary>test02のzabbix_serverを起動する後の確認</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>root@zbx-test02:~/work#<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>zabbix-server.service
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>root@zbx-test02:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>zabbix_server<span class="w"> </span><span class="o">[</span><span class="m">15785</span><span class="o">]</span>:<span class="w"> </span>Cannot<span class="w"> </span>perform<span class="w"> </span>runtime<span class="w"> </span>control<span class="w"> </span>command:<span class="w"> </span>Cannot<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>service<span class="w"> </span><span class="s2">&quot;rtc&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="m">111</span><span class="o">]</span><span class="w"> </span>Connection<span class="w"> </span>refused.
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>root@zbx-test02:~/work#<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>zabbix-server.service
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>root@zbx-test02:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>Runtime<span class="w"> </span>commands<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>executed<span class="w"> </span>only<span class="w"> </span><span class="k">in</span><span class="w"> </span>active<span class="w"> </span>mode
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>root@zbx-test02:~/work#
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>root@zbx-test01:~/work#<span class="w"> </span>zabbix_server<span class="w"> </span>-R<span class="w"> </span>ha_status
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>Failover<span class="w"> </span>delay:<span class="w"> </span><span class="m">60</span><span class="w"> </span>seconds
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>Cluster<span class="w"> </span>status:
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a><span class="w">   </span><span class="c1">#  ID                        Name                      Address                        Status      Last Access</span>
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a><span class="w">   </span><span class="m">1</span>.<span class="w"> </span>cl4nhimlf00019oodk3coe857<span class="w"> </span>zbx01<span class="w">                     </span><span class="m">192</span>.168.1.1:10051<span class="w">              </span>active<span class="w">      </span>4s
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a><span class="w">   </span><span class="m">2</span>.<span class="w"> </span>cl4nlsqlk0001b9r5amp9jryp<span class="w"> </span>zbx02<span class="w">                     </span><span class="m">192</span>.168.1.2:10051<span class="w">              </span>standby<span class="w">     </span>5s
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>root@zbx-test01:~/work#
</span></code></pre></div>
</details>
</li>
</ul>
</li>
</ul>
<h2 id="_3">テンプレートについて<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<ul>
<li>zabbix-agent2-6.0.5</li>
<li>https://git.zabbix.com/projects/ZBX/repos/zabbix/browse/templates/db/mysql_agent2?at=release%2F6.0</li>
</ul>
<p>公式ではテンプレート　MySQL by Zabbix agent 2　がサポートのはMySQL, version 5.7, 8.0だけです。</p>
<p>検証したところ、</p>
<ul>
<li>MySQL5.7、8.0がフル対応。</li>
<li>MySQL5.5はほぼ全部対応しております、一部対応してない。</li>
<li>MySQL5.1はInnoDBが未提供のため、InnoDB系のアイテム値が全部取れない。</li>
<li>MySQL4.0の場合、Angentがmysqlに接続すらできないため、全部アイテム値取れない。</li>
</ul>
<h3 id="zabbix_server">zabbix_serverから取得した情報<a class="headerlink" href="#zabbix_server" title="Permanent link">&para;</a></h3>
<ul>
<li>取得した情報<ul>
<li>
<details class="note">
<summary>取得した情報</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1"># mysql5.1</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>/usr/bin/zabbix_get<span class="w"> </span>-s<span class="w"> </span>mysql5.1-node1<span class="w"> </span>-p<span class="w"> </span><span class="m">10059</span><span class="w"> </span>-k<span class="w">  </span>mysql.get_status_variables<span class="o">[</span><span class="s2">&quot;tcp://localhost:3306&quot;</span>,<span class="s2">&quot;zbx_monitor&quot;</span>,<span class="s2">&quot;password&quot;</span><span class="o">]</span><span class="w">   </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="w">  </span><span class="s2">&quot;Compression&quot;</span>:<span class="w"> </span><span class="s2">&quot;OFF&quot;</span>,
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="w">  </span><span class="s2">&quot;Connections&quot;</span>:<span class="w"> </span><span class="s2">&quot;5407307&quot;</span>,
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="w">  </span><span class="s2">&quot;Created_tmp_disk_tables&quot;</span>:<span class="w"> </span><span class="s2">&quot;276515&quot;</span>,
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="w">  </span><span class="s2">&quot;Created_tmp_files&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="w">  </span><span class="s2">&quot;Created_tmp_tables&quot;</span>:<span class="w"> </span><span class="s2">&quot;4895334&quot;</span>,
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="w">  </span><span class="s2">&quot;Delayed_errors&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="w">  </span><span class="s2">&quot;Delayed_insert_threads&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="w">  </span><span class="s2">&quot;Delayed_writes&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="w">  </span><span class="s2">&quot;Flush_commands&quot;</span>:<span class="w"> </span><span class="s2">&quot;121&quot;</span>,
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="w">  </span><span class="s2">&quot;Handler_commit&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="w">  </span><span class="s2">&quot;Handler_delete&quot;</span>:<span class="w"> </span><span class="s2">&quot;3&quot;</span>,
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="c1"># mysql5.5</span>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>/usr/bin/zabbix_get<span class="w"> </span>-s<span class="w"> </span>mysql5.5-node2<span class="w"> </span>-p<span class="w"> </span><span class="m">10059</span><span class="w"> </span>-k<span class="w">  </span>mysql.get_status_variables<span class="o">[</span><span class="s2">&quot;tcp://localhost:3306&quot;</span>,<span class="s2">&quot;zbx_monitor&quot;</span>,<span class="s2">&quot;password&quot;</span><span class="o">]</span><span class="w">   </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a><span class="w"> </span><span class="s2">&quot;Compression&quot;</span>:<span class="w"> </span><span class="s2">&quot;OFF&quot;</span>,
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a><span class="w">  </span><span class="s2">&quot;Connections&quot;</span>:<span class="w"> </span><span class="s2">&quot;2259865&quot;</span>,
</span><span id="__span-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a><span class="w">  </span><span class="s2">&quot;Created_tmp_disk_tables&quot;</span>:<span class="w"> </span><span class="s2">&quot;116820&quot;</span>,
</span><span id="__span-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a>
</span><span id="__span-34-24"><a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a><span class="c1"># mysql5.7</span>
</span><span id="__span-34-25"><a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a>/usr/bin/zabbix_get<span class="w"> </span>-s<span class="w"> </span>mysql5.7.node3<span class="w"> </span>-p<span class="w"> </span><span class="m">10059</span><span class="w"> </span>-k<span class="w">  </span>mysql.get_status_variables<span class="o">[</span><span class="s2">&quot;tcp://localhost:3306&quot;</span>,<span class="s2">&quot;zbx_monitor&quot;</span>,<span class="s2">&quot;password&quot;</span><span class="o">]</span><span class="w">   </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>.
</span><span id="__span-34-26"><a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a>
</span><span id="__span-34-27"><a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a><span class="w">  </span><span class="s2">&quot;Compression&quot;</span>:<span class="w"> </span><span class="s2">&quot;OFF&quot;</span>,
</span><span id="__span-34-28"><a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a><span class="w">  </span><span class="s2">&quot;Connection_errors_accept&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-29"><a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a><span class="w">  </span><span class="s2">&quot;Connection_errors_internal&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-30"><a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a><span class="w">  </span><span class="s2">&quot;Connection_errors_max_connections&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-31"><a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a><span class="w">  </span><span class="s2">&quot;Connection_errors_peer_address&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-32"><a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a><span class="w">  </span><span class="s2">&quot;Connection_errors_select&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-33"><a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a><span class="w">  </span><span class="s2">&quot;Connection_errors_tcpwrap&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-34"><a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a><span class="w">  </span><span class="s2">&quot;Connections&quot;</span>:<span class="w"> </span><span class="s2">&quot;280335&quot;</span>,
</span><span id="__span-34-35"><a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a><span class="w">  </span><span class="s2">&quot;Innodb_log_waits&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-36"><a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a><span class="w">  </span><span class="s2">&quot;Innodb_log_write_requests&quot;</span>:<span class="w"> </span><span class="s2">&quot;27025149&quot;</span>,
</span><span id="__span-34-37"><a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a><span class="w">  </span><span class="s2">&quot;Innodb_log_writes&quot;</span>:<span class="w"> </span><span class="s2">&quot;30731&quot;</span>,
</span><span id="__span-34-38"><a id="__codelineno-34-38" name="__codelineno-34-38" href="#__codelineno-34-38"></a><span class="w">  </span><span class="s2">&quot;Innodb_num_open_files&quot;</span>:<span class="w"> </span><span class="s2">&quot;89&quot;</span>,
</span><span id="__span-34-39"><a id="__codelineno-34-39" name="__codelineno-34-39" href="#__codelineno-34-39"></a><span class="w">  </span><span class="s2">&quot;Innodb_os_log_fsyncs&quot;</span>:<span class="w"> </span><span class="s2">&quot;33722&quot;</span>,
</span><span id="__span-34-40"><a id="__codelineno-34-40" name="__codelineno-34-40" href="#__codelineno-34-40"></a><span class="w">  </span><span class="s2">&quot;Innodb_os_log_pending_fsyncs&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span><span id="__span-34-41"><a id="__codelineno-34-41" name="__codelineno-34-41" href="#__codelineno-34-41"></a><span class="w">  </span><span class="s2">&quot;Innodb_os_log_pending_writes&quot;</span>:<span class="w"> </span><span class="s2">&quot;0&quot;</span>,
</span></code></pre></div></details>
</li>
</ul>
</li>
</ul>
<h3 id="zabbix">zabbix テンプレート上対応してないアイテム<a class="headerlink" href="#zabbix" title="Permanent link">&para;</a></h3>
<ul>
<li>
<details class="note">
<summary>対応してないアイテム</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1"># MySQL5.5</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>MySQL５．５は下記の情報が最初からないため、取得不可
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>Connection<span class="w"> </span>errors<span class="w"> </span>accept<span class="w"> </span>per<span class="w"> </span>second<span class="w">              </span>mysql.connection_errors_accept.rate<span class="w">               </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>connections<span class="w"> </span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>Connection<span class="w"> </span>errors<span class="w"> </span>internal<span class="w"> </span>per<span class="w"> </span>second<span class="w">            </span>mysql.connection_errors_internal.rate<span class="w">             </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>connections<span class="w"> </span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>Connection<span class="w"> </span>errors<span class="w"> </span>max<span class="w"> </span>connections<span class="w"> </span>per<span class="w"> </span>second<span class="w">     </span>mysql.connection_errors_max_connections.rate<span class="w">      </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>connections<span class="w"> </span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>Connection<span class="w"> </span>errors<span class="w"> </span>peer<span class="w"> </span>address<span class="w"> </span>per<span class="w"> </span>second<span class="w">        </span>mysql.connection_errors_peer_address.rate<span class="w">         </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>connections<span class="w"> </span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>Connection<span class="w"> </span>errors<span class="w"> </span><span class="k">select</span><span class="w"> </span>per<span class="w"> </span>second<span class="w">              </span>mysql.connection_errors_select.rate<span class="w">               </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>connections<span class="w"> </span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>Connection<span class="w"> </span>errors<span class="w"> </span>tcpwrap<span class="w"> </span>per<span class="w"> </span>second<span class="w">             </span>mysql.connection_errors_tcpwrap.rate<span class="w">              </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>connections
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>Innodb<span class="w"> </span>number<span class="w"> </span>open<span class="w"> </span>files<span class="w">                         </span>mysql.innodb_num_open_files<span class="w">                       </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>system
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="c1"># MySQL5.1</span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>MySQL５．１はInnoDB系情報が最初からないため、取得不可
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a>
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Buffer<span class="w"> </span>pool<span class="w"> </span>efficiency<span class="w">                                                        </span>mysql.buffer_pool_efficiency<span class="w">                 </span>1m<span class="w">   </span>7d<span class="w"> </span>365d<span class="w">    </span>計算<span class="w">          </span>取得不可<span class="w">    </span>component:<span class="w"> </span>memory
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Buffer<span class="w"> </span>pool<span class="w"> </span>utilization<span class="w">                                                       </span>mysql.buffer_pool_utilization<span class="w">                </span>1m<span class="w">   </span>7d<span class="w"> </span>365d<span class="w">    </span>計算<span class="w">          </span>取得不可<span class="w">    </span>component:<span class="w"> </span>memory
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Calculated<span class="w"> </span>value<span class="w"> </span>of<span class="w"> </span>innodb_log_file_size<span class="w">                                      </span>mysql.innodb_log_file_size<span class="w">                   </span>1m<span class="w">   </span>7d<span class="w"> </span>365d<span class="w">    </span>計算<span class="w">          </span>取得不可<span class="w">    </span>component:<span class="w"> </span>system
</span><span id="__span-35-18"><a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>InnoDB<span class="w"> </span>buffer<span class="w"> </span>pool<span class="w"> </span>pages<span class="w"> </span>free<span class="w">                    </span>mysql.innodb_buffer_pool_pages_free<span class="w">               </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>memory<span class="w"> </span>
</span><span id="__span-35-19"><a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>InnoDB<span class="w"> </span>buffer<span class="w"> </span>pool<span class="w"> </span>pages<span class="w"> </span>total<span class="w">                   </span>mysql.innodb_buffer_pool_pages_total<span class="w">              </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>memory<span class="w"> </span>
</span><span id="__span-35-20"><a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>InnoDB<span class="w"> </span>buffer<span class="w"> </span>pool<span class="w"> </span><span class="nb">read</span><span class="w"> </span>requests<span class="w">                 </span>mysql.innodb_buffer_pool_read_requests<span class="w">            </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>memory<span class="w"> </span>
</span><span id="__span-35-21"><a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>InnoDB<span class="w"> </span>buffer<span class="w"> </span>pool<span class="w"> </span><span class="nb">read</span><span class="w"> </span>requests<span class="w"> </span>per<span class="w"> </span>second<span class="w">      </span>mysql.innodb_buffer_pool_read_requests.rate<span class="w">       </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>memory<span class="w"> </span>
</span><span id="__span-35-22"><a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>InnoDB<span class="w"> </span>buffer<span class="w"> </span>pool<span class="w"> </span>reads<span class="w">                         </span>mysql.innodb_buffer_pool_reads<span class="w">                    </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>memory<span class="w"> </span>
</span><span id="__span-35-23"><a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>InnoDB<span class="w"> </span>buffer<span class="w"> </span>pool<span class="w"> </span>reads<span class="w"> </span>per<span class="w"> </span>second<span class="w">              </span>mysql.innodb_buffer_pool_reads.rate<span class="w">               </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>memory<span class="w"> </span>
</span><span id="__span-35-24"><a id="__codelineno-35-24" name="__codelineno-35-24" href="#__codelineno-35-24"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>Innodb<span class="w"> </span>buffer<span class="w"> </span>pool<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>free<span class="w">                     </span>mysql.innodb_buffer_pool_wait_free<span class="w">                </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>memory<span class="w"> </span>
</span><span id="__span-35-25"><a id="__codelineno-35-25" name="__codelineno-35-25" href="#__codelineno-35-25"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>Innodb<span class="w"> </span>log<span class="w"> </span>written<span class="w">                               </span>mysql.innodb_os_log_written<span class="w">                       </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>system<span class="w">  </span>
</span><span id="__span-35-26"><a id="__codelineno-35-26" name="__codelineno-35-26" href="#__codelineno-35-26"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>Innodb<span class="w"> </span>number<span class="w"> </span>open<span class="w"> </span>files<span class="w">                         </span>mysql.innodb_num_open_files<span class="w">                       </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>system<span class="w"> </span>
</span><span id="__span-35-27"><a id="__codelineno-35-27" name="__codelineno-35-27" href="#__codelineno-35-27"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>InnoDB<span class="w"> </span>row<span class="w"> </span>lock<span class="w"> </span><span class="nb">time</span><span class="w">                             </span>mysql.innodb_row_lock_time<span class="w">                        </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>tables<span class="w"> </span>
</span><span id="__span-35-28"><a id="__codelineno-35-28" name="__codelineno-35-28" href="#__codelineno-35-28"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>InnoDB<span class="w"> </span>row<span class="w"> </span>lock<span class="w"> </span><span class="nb">time</span><span class="w"> </span>max<span class="w">                         </span>mysql.innodb_row_lock_time_max<span class="w">                    </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>tables<span class="w"> </span>
</span><span id="__span-35-29"><a id="__codelineno-35-29" name="__codelineno-35-29" href="#__codelineno-35-29"></a>MySQL<span class="w"> </span>by<span class="w"> </span>Zabbix<span class="w"> </span>agent<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>MySQL:<span class="w"> </span>Get<span class="w"> </span>status<span class="w"> </span>variables:<span class="w"> </span>MySQL:<span class="w"> </span>InnoDB<span class="w"> </span>row<span class="w"> </span>lock<span class="w"> </span>waits<span class="w">                            </span>mysql.innodb_row_lock_waits<span class="w">                       </span>7d<span class="w"> </span>365d<span class="w">    </span>依存アイテム<span class="w">  </span>取得不可<span class="w">    </span>component:<span class="w"> </span>innodbcomponent:<span class="w"> </span>tables<span class="w"> </span>
</span></code></pre></div></details>
</li>
</ul>
<h3 id="mysql40">MySQL4.0の特別対応<a class="headerlink" href="#mysql40" title="Permanent link">&para;</a></h3>
<p>zabbix-agent2がmysql4.0対応してないため、MySQL情報取得方法を変更する。</p>
<ul>
<li>テンプレートを新たに作成する。<ul>
<li><code>MySQL_40_by_Zabbix_agent_2</code></li>
</ul>
</li>
<li>MySQL: Get status variables のアイテムを情報取得するため、キーを変更する。<ul>
<li><code>mysql4.get_status_variables</code></li>
</ul>
</li>
<li>MySQL: Status のアイテムを情報取得するため、キーを変更する。<ul>
<li><code>mysql4.ping</code></li>
</ul>
</li>
<li>MySQL: Version のアイテムを情報取得するため、キーを変更する。<ul>
<li><code>mysql4.version</code></li>
</ul>
</li>
</ul>
<h4 id="agentconf">agent側のconf設定<a class="headerlink" href="#agentconf" title="Permanent link">&para;</a></h4>
<ul>
<li>
<details class="tip" open="open">
<summary>agent側のconf設定</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="o">[</span>root@mysql4.0-node<span class="w"> </span>~<span class="o">]</span><span class="c1"># cat /etc/zabbix/zabbix_agent2.d/userparametart_mysql.conf  | grep -v ^# | grep -v ^$</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="nv">UserParameter</span><span class="o">=</span>mysql4.get_status_variables,<span class="w"> </span>/usr/bin/mysql<span class="w">  </span>-sNX<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;show status;&quot;</span><span class="p">|</span><span class="w"> </span>/usr/local/bin/jc<span class="w"> </span>--xml<span class="w">  </span><span class="p">|</span><span class="w"> </span>/usr/bin/jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;.resultset.row&#39;</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>/usr/bin/jq<span class="w"> </span><span class="s1">&#39;reduce .[] as $p ({}; .[$p.Variable_name] = $p.Value)&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>/usr/bin/jq<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;@json&#39;</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="nv">UserParameter</span><span class="o">=</span>mysql4.version<span class="o">[</span>*<span class="o">]</span>,<span class="w"> </span>/usr/bin/mysqladmin<span class="w"> </span>--defaults-extra-file<span class="o">=</span>/root/.my.cnf<span class="w"> </span>version
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="nv">UserParameter</span><span class="o">=</span>mysql4.ping,/usr/bin/mysqladmin<span class="w"> </span>--defaults-extra-file<span class="o">=</span>/root/.my.cnf<span class="w"> </span>ping<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-c<span class="w"> </span>alive
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="nv">UserParameter</span><span class="o">=</span>mysql4.status<span class="o">[</span>*<span class="o">]</span>,/usr/bin/mysql<span class="w"> </span>--defaults-extra-file<span class="o">=</span>/root/.my.cnf<span class="w"> </span>-BNe<span class="w"> </span><span class="s2">&quot;show status like &#39;</span><span class="nv">$1</span><span class="s2">&#39;;&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $$2}&#39;</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="nv">UserParameter</span><span class="o">=</span>mysql4.variables<span class="o">[</span>*<span class="o">]</span>,/usr/bin/mysql<span class="w"> </span>--defaults-extra-file<span class="o">=</span>/root/.my.cnf<span class="w"> </span>-BNe<span class="w"> </span><span class="s2">&quot;show variables like &#39;</span><span class="nv">$1</span><span class="s2">&#39;;&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $$2}&#39;</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="o">[</span>root@mysql4.0-node<span class="w"> </span>~<span class="o">]</span><span class="c1">#</span>
</span></code></pre></div></details>
</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2022 - 2023 - lyvivian0077
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.top", "navigation.indexes", "navigation.path", "content.code.copy", "toc.follow"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fac441b0.min.js"></script>
      
    
  </body>
</html>