{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to My Docs","text":"xxx  details\u30bf\u30b0 \u6298\u308a\u305f\u305f\u307f   <pre><code>&lt;details&gt;\n&lt;summary&gt;xxx&lt;/summary&gt;\n\naaaaaaaaaaaaaaaaaaaaa\nbbbbbbbbbbbbbbbbbbb\nccccccccccccccccccccc\n&lt;/details&gt;\n</code></pre>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"#deploying-docs","title":"Deploying docs","text":"<ul> <li>https://mkdocs.nakaken88.com/use/write/</li> <li>https://dev.classmethod.jp/articles/mkdocs-and-material-for-mkdocs-tips-matome/</li> <li>https://www.mkdocs.org/getting-started/</li> <li>https://www.mkdocs.org/user-guide/deploying-your-docs/</li> </ul> <pre><code>#  python3 -m pip install --upgrade pip\n#  pip install mkdocs\n#  pip install mkdocs-material\n#  mkdocs serve -a 127.0.0.1:8000 -v\n</code></pre> <pre><code>my-project/\n    mkdocs.yml\n    docs/\norgname.github.io/\n\n\ncd ../orgname.github.io/\nmkdocs gh-deploy --config-file ../my-project/mkdocs.yml --remote-branch master\n\n  or\ncd ../my-project/\n#  mkdocs build -d ../lyvivian0077.github.io/\n\n#  cd ../lyvivian0077.github.io/\n#  git add .\n#  git commit -m 'test'\n#  git push\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/","title":"Bash\u7f16\u7a0b\u8d85\u8be6\u7ec6\u8bed\u6cd5\u603b\u7ed3","text":"<ul> <li>\u539f\u6587</li> </ul> <p>\u5728Linux\u5b66\u4e60\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u65e0\u53ef\u907f\u514d\u7684\u4f1a\u78b0\u5230\u4e00\u4e2a\u65e2\u8ba9\u4eba\u559c\u6b22\uff0c\u53c8\u4ee4\u4eba\u5934\u75bc\u7684\u795e\u5947\u7684\u4e1c\u897f\u2014\u2014bash\u7f16\u7a0b\uff0c\u5373shell\u811a\u672c\u3002 \u90a3\u4e48\u4ec0\u4e48\u662fshell\u811a\u672c\u5462\uff1fshell\u662f\u4e00\u4e2a\u547d\u4ee4\u8bed\u8a00\u89e3\u91ca\u5668\uff0c\u800cshell\u811a\u672c\u5219\u662fLinux\u547d\u4ee4\u7684\u96c6\u5408\uff0c \u6309\u7167\u9884\u8bbe\u7684\u987a\u5e8f\u4f9d\u6b21\u89e3\u91ca\u6267\u884c\uff0c\u6765\u5b8c\u6210\u7279\u5b9a\u7684\u3001\u8f83\u590d\u6742\u7684\u7cfb\u7edf\u7ba1\u7406\u4efb\u52a1\uff0c\u7c7b\u4f3c\u4e8eWindows\u4e2d\u7684\u6279\u5904\u7406\u6587\u4ef6\u3002 \u672c\u6587\u5e26\u6765\u7684\u662fbash\u7f16\u7a0b\u7684\u57fa\u7840\u8bed\u6cd5\u8bb2\u89e3\u3002</p>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash","title":"bash\u7f16\u7a0b\u4e4b\u53d8\u91cf","text":""},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_1","title":"bash\u53d8\u91cf\u7c7b\u522b","text":"<p>\u672c\u5730\u53d8\u91cf : \u53ea\u5bf9\u5f53\u524dshell\u8fdb\u7a0b\u6709\u6548\u7684\u53d8\u91cf\uff0c\u5bf9\u5176\u5b83shell\u8fdb\u7a0b\u65e0\u6548\uff0c\u5305\u5f53\u524dshell\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b</p> <pre><code>VAR_NAME=VALUE\n</code></pre> <p>\u53d8\u91cf\u8d4b\u503c : \u5411\u53d8\u91cf\u7684\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58\u6570\u636e</p> <p>\u53d8\u91cf\u5f15\u7528 : ${VAR_NAME} </p> <pre><code>\"\":\u5f31\u5f15\u7528\uff0c\u91cc\u9762\u7684\u53d8\u91cf\u4f1a\u88ab\u66ff\u6362\n'':\u5f3a\u5f15\u7528\uff0c\u91cc\u9762\u7684\u6240\u6709\u5b57\u7b26\u90fd\u662f\u5b57\u9762\u91cf\uff0c\u76f4\u63a5\u8f93\u51fa\n</code></pre> <p>\u73af\u5883\u53d8\u91cf : \u5bf9\u5f53\u524dshell\u8fdb\u7a0b\u53ca\u5176\u5b50shell\u6709\u6548\uff0c\u5bf9\u5176\u5b83\u7684shell\u8fdb\u7a0b\u65e0\u6548</p> <pre><code>\u5b9a\u4e49\uff1aexport VAR_NAME=VALUE\n\u5bfc\u51fa\uff1aexport VAR_NAME\n\u64a4\u6d88\u53d8\u91cf\uff1aunset VAR_NAME\n\u53ea\u8bfb\u53d8\u91cf\uff1areadonly VAR_NAME\n</code></pre> <p>\u5c40\u90e8\u53d8\u91cf : \u5bf9shell\u811a\u672c\u4e2d\u67d0\u4ee3\u7801\u7247\u65ad\u6709\u6548\uff0c\u901a\u5e38\u7528\u4e8e\u51fd\u6570\u672c\u5730</p> <pre><code>local VAR_NAME=VALUE\n</code></pre> <p>\u4f4d\u7f6e\u53d8\u91cf : \u7528\u6765\u63a5\u53d7\u53d8\u91cf\u6307\u5b9a\u4f4d\u7f6e\u7684\u53c2\u6570</p> <pre><code>$1,$2...,${10}\n</code></pre> <p>\u7279\u6b8a\u53d8\u91cf : shell\u5bf9\u4e00\u4e9b\u53c2\u6570\u505a\u7279\u6b8a\u5904\u7406,\u8fd9\u4e9b\u53c2\u6570\u53ea\u80fd\u88ab\u5f15\u7528\u800c\u4e0d\u80fd\u88ab\u8d4b\u503c</p> <pre><code>$#  \u4f20\u9012\u5230\u811a\u672c\u7684\u53c2\u6570\u4e2a\u6570\n$*  \u663e\u793a\u6240\u6709\u5411\u811a\u672c\u4f20\u9012\u7684\u53c2\u6570                  #\u4e0e\u4f4d\u7f6e\u53d8\u91cf\u4e0d\u540c\uff0c\u6b64\u9009\u9879\u53c2\u6570\u53ef\u8d85\u8fc79\u4e2a\n$$  \u83b7\u53d6\u5f53\u524dshell\u7684\u8fdb\u7a0b\u53f7\n$!  \u6267\u884c\u4e0a\u4e00\u4e2a\u6307\u4ee4\u7684\u8fdb\u7a0b\u53f7\n$?  \u83b7\u53d6\u6267\u884c\u7684\u4e0a\u4e00\u4e2a\u6307\u4ee4\u7684\u8fd4\u56de\u503c              #0\u4e3a\u6267\u884c\u6210\u529f\uff0c\u975e\u96f6\u4e3a\u6267\u884c\u5931\u8d25\n$-  \u663e\u793ashell\u4f7f\u7528\u7684\u5f53\u524d\u9009\u9879\uff0c\u4e0eset\u547d\u4ee4\u529f\u80fd\u76f8\u540c\n$@  \u4e0e$*\u76f8\u540c\uff0c\u4f46\u662f\u4f7f\u7528\u65f6\u52a0\u5f15\u53f7\uff0c\u5e76\u5728\u5f15\u53f7\u4e2d\u8fd4\u56de\u6bcf\u4e2a\u53c2\u6570\n</code></pre> <p>\u67e5\u770b\u53d8\u91cf :</p> <pre><code>set\uff1a\u67e5\u770b\u5f53\u524dshell\u8fdb\u7a0b\u4e2d\u7684\u6240\u6709\u53d8\u91cf\nexport, printenv, env\uff1a\u67e5\u770b\u5f53\u524dshell\u8fdb\u7a0b\u4e2d\u7684\u6240\u6709\u73af\u5883\u53d8\u91cf\n</code></pre> <p>\u53d8\u91cf\u547d\u540d :   1. \u4e0d\u80fd\u4f7f\u7528\u7a0b\u5e8f\u4e2d\u7684\u5173\u952e\u5b57\uff08\u4fdd\u7559\u5b57\uff09   2. \u53ea\u80fd\u4f7f\u7528\u6570\u5b57\u3001\u5b57\u6bcd\u548c\u4e0b\u5212\u7ebf\uff0c\u4e14\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934   3. \u8981\u89c1\u540d\u77e5\u4e49</p> <p>\u53d8\u91cf\u7c7b\u578b :</p> <pre><code>\u6570\u503c\u578b\uff1a\u7cbe\u786e\u6570\u503c(\u6574\u6570)\uff0c\u8fd1\u4f3c\u6570\u503c\uff08\u6d6e\u70b9\u578b\uff09\n\u5b57\u7b26\u578b\uff1achar,string\n\u5e03\u5c14\u578b\uff1atrue, false\n</code></pre> <p>\u7c7b\u578b\u8f6c\u6362 :</p> <pre><code>\u663e\u5f0f\u8f6c\u6362\n\u9690\u5f0f\u8f6c\u6362\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_2","title":"bash\u7684\u914d\u7f6e\u6587\u4ef6\uff1a","text":""},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#_1","title":"\u529f\u80fd\uff1a\u8bbe\u5b9a\u672c\u5730\u53d8\u91cf\uff0c\u5b9a\u4e49\u547d\u4ee4\u522b\u540d","text":"<ul> <li>profile\u7c7b\uff1a\u4e3a\u4ea4\u4e92\u5f0f\u767b\u5f55\u7684\u7528\u6237\u63d0\u4f9b\u914d\u7f6e</li> </ul> <pre><code>\u5168\u5c40\uff1a/etc/profile\u3001/etc/profile.d/*.sh\n\u7528\u6237\uff1a~/.bash_profile\n</code></pre> <ul> <li>bashrc\u7c7b\uff1a\u4e3a\u975e\u4ea4\u4e92\u5f0f\u7684\u7528\u6237\u63d0\u4f9b\u914d\u7f6e</li> </ul> <pre><code>\u5168\u5c40\uff1a/etc/bashrc\n\u7528\u6237\uff1a~/.bashrc\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_3","title":"bash\u7f16\u7a0b\u4e4b\u7f16\u5199\u683c\u5f0f\u53ca\u6267\u884c\u65b9\u5f0f","text":"<ul> <li>\u7f16\u5199\u683c\u5f0f\uff1ashell\u811a\u672c\u7b2c\u4e00\u884c\u5fc5\u987b\u9876\u683c\u5199\uff0c\u7528shebang\u5b9a\u4e49\u6307\u5b9a\u7684\u89e3\u91ca\u5668\u6765\u89e3\u91ca\u8be5\u811a\u672c\u3002</li> </ul> <pre><code>#!/bin/bash       #!\u5373\u4e3ashebang\n# \u5176\u5b83\u7684\u4ee5#\u5f00\u5934\u7684\u884c\u5747\u4e3a\u6ce8\u91ca\uff0c\u4f1a\u88ab\u89e3\u91ca\u5668\u5ffd\u7565\uff0c\u53ef\u7528\u6765\u6ce8\u91ca\u811a\u672c\u7528\u9014\u53ca\u7248\u672c\uff0c\u65b9\u4fbf\u4f7f\u7528\u7ba1\u7406\u3002\n</code></pre> <ul> <li>\u6267\u884c\u65b9\u5f0f\uff1abash\u7f16\u7a0b\u5c5e\u4e8e\u9762\u5411\u8fc7\u7a0b\u7f16\u7a0b\uff0c\u6267\u884c\u65b9\u5f0f\u5982\u4e0b\uff1a</li> </ul> <pre><code>\u987a\u5e8f\u6267\u884c\uff1a\u6309\u547d\u4ee4\u5148\u540e\u987a\u5bfb\u4f9d\u6b21\u6267\u884c\n\u9009\u62e9\u6267\u884c\uff1a\u6d4b\u8bd5\u6761\u4ef6\uff0c\u53ef\u80fd\u4f1a\u591a\u4e2a\u6d4b\u8bd5\u6761\u4ef6\uff0c\u67d0\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0c\u5219\u6267\u884c\u5bf9\u5e94\u7684\u5206\u652f\n\u5faa\u73af\u6267\u884c\uff1a\u5c06\u540c\u4e00\u6bb5\u4ee3\u7801\u53cd\u590d\u6267\u884c\u591a\u6b21\uff0c\u56e0\u6b64\uff0c\u5faa\u73af\u5fc5\u987b\u6709\u9000\u51fa\u6761\u4ef6\uff1b\u5426\u5219\uff0c\u5219\u9677\u5165\u6b7b\u5faa\u73af\n</code></pre> <ul> <li>bash\u6267\u884c\u9009\u9879\uff1a</li> </ul> <pre><code>bash -n SHELLNAME  #\u8bed\u6cd5\u6d4b\u8bd5\uff0c\u6d4b\u8bd5\u662f\u5426\u5b58\u5728\u8bed\u6cd5\u9519\u8bef\nbash -x SHELLNAME  #\u6a21\u62df\u5355\u6b65\u6267\u884c\uff0c\u663e\u793a\u6bcf\u4e00\u6b65\u6267\u884c\u8fc7\u7a0b\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_4","title":"bash\u4e4b\u7b97\u6570\u8fd0\u7b97\u4e0e\u903b\u8f91\u8fd0\u7b97","text":"<ul> <li> <p>\u7b97\u6570\u8fd0\u7b97</p> </li> <li> <p>\u5b9a\u4e49\u6574\u578b\u53d8\u91cf\uff1a</p> </li> </ul> <pre><code>let VAR_NAME=INTEGER_VALUE            #\u4f8b\u5982\uff1alet a=3\ndeclare -i VAR_NAME=INTEGER_VALUE     #declare -i a=3\n</code></pre> <ul> <li>\u5b9e\u73b0\u7b97\u672f\u8fd0\u7b97\u7684\u65b9\u5f0f\uff1a</li> </ul> <pre><code>let VAR_NAME=ARITHMATIC_EXPRESSION\nVAR_NAME=$[ARITHMATIC_EXRESSION]\nVAR_NAME=$((EXPRESSION))\nVAR_NAME=$(expr $num1 + $num2)\n</code></pre> <ul> <li>\u7b97\u672f\u8fd0\u7b97\u7b26\uff1a</li> </ul> <pre><code>+\uff1a\u52a0\u6cd5\n-\uff1a\u51cf\u6cd5\n*\uff1a\u4e58\u6cd5\n/\uff1a\u6574\u9664\n%\uff1a\u53d6\u4f59\u6570\n**\uff1a\u4e58\u5e42\n</code></pre> <p>\u6ce8\u610f\uff1a\u5373\u4f7f\u6ca1\u6709\u5b9a\u4e49\u4e3a\u6574\u578b\u53d8\u91cf\uff0c\u5b57\u7b26\u578b\u7684\u6570\u5b57\u4f9d\u7136\u53ef\u4ee5\u53c2\u4e0e\u7b97\u672f\u8fd0\u7b97\uff0cbash\u4f1a\u6267\u884c\u53d8\u91cf\u7c7b\u578b\u7684\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\u3002   - \u903b\u8f91\u8fd0\u7b97</p> <pre><code>\u5e03\u5c14\u8fd0\u7b97\uff1a\u771f\uff0c\u5047\n\u4e0e\u8fd0\u7b97\uff1a\u771f &amp;&amp; \u771f = \u771f\n        \u771f &amp;&amp; \u5047 = \u5047\n        \u5047 &amp;&amp; \u771f = \u5047\n        \u5047 &amp;&amp; \u5047 = \u5047\n\u6216\u8fd0\u7b97\uff1a\u771f || \u771f = \u771f\n  \u771f || \u5047 = \u771f\n  \u5047 || \u771f = \u771f\n  \u5047 || \u5047 = \u5047\n\u975e\u8fd0\u7b97\uff1a\uff01\u771f=\u5047\n        \uff01\u5047=\u771f\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_5","title":"bash\u7f16\u7a0b\u4e4b\u6761\u4ef6\u6d4b\u8bd5\u8bed\u53e5","text":""},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_6","title":"bash\u6761\u4ef6\u6d4b\u8bd5","text":"<p>\u6574\u578b\u6d4b\u8bd5\uff1a\u6574\u6570\u6bd4\u8f83</p> <pre><code>\u4f8b\u5982 [ $num1 -gt $num2 ]\n\n-gt: \u5927\u4e8e\u5219\u4e3a\u771f\n-lt: \u5c0f\u4e8e\u5219\u4e3a\u771f\n-ge: \u5927\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f\n-le: \u5c0f\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f\n-eq: \u7b49\u4e8e\u5219\u4e3a\u771f\n-ne: \u4e0d\u7b49\u4e8e\u5219\u4e3a\u771f\n</code></pre> <p>\u5b57\u7b26\u6d4b\u8bd5\uff1a\u5b57\u7b26\u4e32\u6bd4\u8f83</p> <pre><code>\u53cc\u76ee\uff1a\n\u4f8b\u5982[[ \"$str1\" &gt; \"$str2\" ]]\n\n&gt;: \u5927\u4e8e\u5219\u4e3a\u771f\n&lt;: \u5c0f\u4e8e\u5219\u4e3a\u771f\n&gt;=\uff1a\u5927\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f\n&lt;=\uff1a\u5c0f\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f\n==\uff1a\u7b49\u4e8e\u5219\u4e3a\u771f\n!=\uff1a\u4e0d\u7b49\u4e8e\u5219\u4e3a\u771f\n\n\n\u5355\u76ee\uff1a\n-n String: \u662f\u5426\u4e0d\u7a7a\uff0c\u4e0d\u7a7a\u5219\u4e3a\u771f\uff0c\u7a7a\u5219\u4e3a\u5047\n-z String: \u662f\u5426\u4e3a\u7a7a\uff0c\u7a7a\u5219\u4e3a\u771f\uff0c\u4e0d\u7a7a\u5219\u5047\n\n\u6587\u4ef6\u6d4b\u8bd5\uff1a\u5224\u65ad\u6587\u4ef6\u7684\u5b58\u5728\u6027\u53ca\u5c5e\u6027\u7b49\n\n-a FILE\uff1a\u5b58\u5728\u5219\u4e3a\u771f\uff1b\u5426\u5219\u5219\u4e3a\u5047\uff1b\n-e FILE: \u5b58\u5728\u5219\u4e3a\u771f\uff1b\u5426\u5219\u5219\u4e3a\u5047\uff1b\n-f FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u666e\u901a\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b\n-d FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u76ee\u5f55\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b\n-L/-h FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u7b26\u53f7\u94fe\u63a5\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b\n-b: \u5b58\u5728\u5e76\u4e14\u4e3a\u5757\u8bbe\u5907\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b\n-c: \u5b58\u5728\u5e76\u4e14\u4e3a\u5b57\u7b26\u8bbe\u5907\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\n-S: \u5b58\u5728\u5e76\u4e14\u4e3a\u5957\u63a5\u5b57\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\n-p: \u5b58\u5728\u5e76\u4e14\u4e3a\u547d\u540d\u7ba1\u9053\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\n-s FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u975e\u7a7a\u6587\u4ef6\u5219\u4e3a\u503c\uff0c\u5426\u5219\u4e3a\u5047\uff1b\n-r FILE\uff1a\u6587\u4ef6\u53ef\u8bfb\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047\n-w FILE\uff1a\u6587\u4ef6\u53ef\u5199\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047\n-x FILE\uff1a\u6587\u4ef6\u53ef\u6267\u884c\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047\nfile1 -nt file2: file1\u7684mtime\u65b0\u4e8efile2\u5219\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047\uff1b\nfile1 -ot file2\uff1afile1\u7684mtime\u65e7\u4e8efile2\u5219\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047\uff1b\n\n\u7ec4\u5408\u6761\u4ef6\u6d4b\u8bd5\uff1a\u5728\u591a\u4e2a\u6761\u4ef6\u95f4\u5b9e\u73b0\u903b\u8f91\u8fd0\u7b97\n\n\u4e0e\uff1a[ condition1 -a condition2 ]\n  condition1 &amp;&amp; condition2\n\u6216\uff1a[ condition1 -o condition2 ]\n  condition1 || condition2\n\u975e\uff1a[ -not condition ]\n  ! condition\n\u4e0e\uff1aCOMMAND1 &amp;&amp; COMMAND2\nCOMMAND1\u5982\u679c\u4e3a\u5047\uff0c\u5219COMMAND2\u4e0d\u6267\u884c\n\u6216\uff1aCOMMAND1 || COMMAND2\nCOMMAND1\u5982\u679c\u4e3a\u771f\uff0c\u5219COMMAND2\u4e0d\u6267\u884c\n\u975e\uff1a! COMMAND\n</code></pre> <p>\u6761\u4ef6\u6d4b\u8bd5\u4e4bif\u8bed\u53e5</p> <pre><code>1\u3001if\u8bed\u53e5\u4e4b\u5355\u5206\u652f\n\u8bed\u53e5\u7ed3\u6784\uff1a\nif \u6d4b\u8bd5\u6761\u4ef6;then\n   \u9009\u62e9\u5206\u652f\nfi\n\u8868\u793a\u6761\u4ef6\u6d4b\u8bd5\u72b6\u6001\u8fd4\u56de\u503c\u4e3a\u503c\uff0c\u5219\u6267\u884c\u9009\u62e9\u5206\u652f\n\u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u662f\u7528\u6237\u540d\uff1b\u5982\u679c\u6b64\u7528\u6237\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\u8be5\u7528\u6237\uff1b\n\n#\uff01/bin/bash\nif ! id $1 &amp;&gt; /dev/null;then\n  useradd $1\nfi\n\n2\u3001if\u8bed\u53e5\u4e4b\u53cc\u5206\u652f\n\u8bed\u53e5\u7ed3\u6784\uff1a\nif \u6d4b\u8bd5\u6761\u4ef6;then\n   \u9009\u62e9\u5206\u652f1\nelse\n   \u9009\u62e9\u5206\u652f2\nfi\n\n\u4e24\u4e2a\u5206\u652f\u4ec5\u6267\u884c\u5176\u4e2d\u4e4b\u4e00\n\u4f8b\uff1a\u901a\u8fc7\u547d\u4ee4\u884c\u7ed9\u5b9a\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\uff0c\u800c\u540e\u5224\u65ad\uff1a\u5982\u679c\u6b64\u6587\u4ef6\u4e2d\u5b58\u5728\u7a7a\u767d\u884c\uff0c\u5219\u663e\u793a\u5176\u7a7a\u767d\u884c\u7684\u603b\u6570\uff1b\u5426\u5219\uff0c\u5219\u663e\u793a\u65e0\u7a7a\u767d\u884c\uff1b\n#\uff01/bin/bash\nif grep \"^[[:space]]*$\" $1 &amp;&gt; /dev/null; then\n  echo \"$1 has $(grep \"^[[:space]]*$\" $1 | wc -l) blank lines.\"\nelse\n  echo \"No blank lines\"\nfi\n\n\u6ce8\u610f\uff1a\u5982\u679c\u628a\u547d\u4ee4\u6267\u884c\u6210\u529f\u4e0e\u5426\u5f53\u4f5c\u6761\u4ef6\uff0c\u5219if\u8bed\u53e5\u540e\u5fc5\u987b\u53ea\u8ddf\u547d\u4ee4\u672c\u8eab\uff0c\u800c\u4e0d\u80fd\u5f15\u7528\u3002\n\n3\u3001if\u8bed\u53e5\u4e4b\u591a\u5206\u652f\n\u8bed\u53e5\u7ed3\u6784\uff1a\nif \u6761\u4ef61;then\n     \u5206\u652f1\nelif \u6761\u4ef62;then\n     \u5206\u652f2\nelif \u6761\u4ef63;then\n     \u5206\u652f3\n      ...\nelse\n     \u5206\u652fn\nfi\n\n\u4f8b\uff1a\u4f20\u9012\u4e00\u4e2a\u7528\u6237\u540d\u7ed9\u811a\u672c\uff1a\u5982\u679c\u6b64\u7528\u6237\u7684id\u53f7\u4e3a0\uff0c\u5219\u663e\u793a\u8bf4\u8fd9\u662f\u7ba1\u7406\u5458\uff1b\u5982\u679c\u6b64\u7528\u6237\u7684id\u53f7\u5927\u4e8e\u7b49\u4e8e500\uff0c\u5219\u663e\u793a\u8bf4\u8fd9\u662f\u666e\u901a\u7528\u6237\uff1b\u5426\u5219\uff0c\u5219\u8bf4\u8fd9\u662f\u7cfb\u7edf\u7528\u6237\u3002\n#!/bin/bash\nif [ $# -lt 1 ]; then\n  echo \"Usage: `basename $0` username\"\n  exit 1\nfi\nif ! id -u $1 &amp;&gt; /dev/null; then\n  echo \"Usage: `basename $0` username\"\n  echo \"No this user $1.\"\n  exit 2\nfi\n\nif [ $(id -u $1) -eq 0 ]; then\n  echo \"Admin\"\nelif [ $(id -u $1) -ge 500 ]; then\n  echo \"Common user.\"\nelse\n  echo \"System user.\"\nfi\n</code></pre> <p>bash\u4ea4\u4e92\u5f0f\u7f16\u7a0b</p> <pre><code>read [option] \u201cprompt\u201d-p:\u76f4\u63a5\u6307\u5b9a\u4e00\u4e2a\u53d8\u91cf\u63a5\u53d7\u53c2\u6570\n-t timaout\uff1a\u6307\u5b9a\u7b49\u5f85\u63a5\u53d7\u53c2\u6570\u7684\u65f6\u95f4\n-n:\u8868\u793a\u4e0d\u6362\u884c\n\n\u4f8b\uff1a\u8f93\u5165\u7528\u6237\u540d\uff0c\u53ef\u8fd4\u56de\u5176shell\n\n#!/bin/bash\nread -p \"Plz input a username: \" userName\nif id $userName &amp;&gt; /dev/null; then\n    echo \"The shell of $userName is `grep \"^$userName\\&gt;\" /etc/passwd | cut -d: -f7`.\"\nelse\n    echo \"No such user. stupid.\"\nfi    \n</code></pre> <p>\u6761\u4ef6\u6d4b\u8bd5\u4e4bcase\u8bed\u53e5</p> <pre><code>\ncase\u8bed\u53e5\uff1a\u6709\u591a\u4e2a\u6d4b\u8bd5\u6761\u4ef6\u65f6\uff0ccase\u8bed\u53e5\u4f1a\u4f7f\u5f97\u8bed\u6cd5\u7ed3\u6784\u66f4\u660e\u6670\n\u8bed\u53e5\u7ed3\u6784\uff1a\n\ncase \u53d8\u91cf\u5f15\u7528 in\nPATTERN1)\n  \u5206\u652f1\n;;\nPATTERN2)\n  \u5206\u652f2\n;;\n...\n*)\n  \u5206\u652fn\n;;\nesac\n</code></pre> <p>PATTERN\uff1a\u7c7b\u540c\u4e8e\u6587\u4ef6\u540d\u901a\u914d\u673a\u5236\uff0c\u4f46\u652f\u6301\u4f7f\u7528|\u8868\u793a\u6216\u8005</p> <pre><code> a|b:  a\u6216\u8005b*\uff1a\u5339\u914d\u4efb\u610f\u957f\u5ea6\u7684\u4efb\u610f\u5b57\u7b26\n?: \u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26\n[]: \u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u5355\u4e2a\u5b57\u7b26\n\n\u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u5b8c\u6210\u5982\u4e0b\u4efb\u52a1\uff0c\u5176\u4f7f\u7528\u5f62\u5f0f\u5982\u4e0b\u6240\u793a\uff1a\nscript.sh {start|stop|restart|status}\n\n\u5176\u4e2d\uff1a\u5982\u679c\u53c2\u6570\u4e3a\u7a7a\uff0c\u5219\u663e\u793a\u5e2e\u52a9\u4fe1\u606f\uff0c\u5e76\u9000\u51fa\u811a\u672c\uff1b\n\u5982\u679c\u53c2\u6570\u4e3astart\uff0c\u5219\u521b\u5efa\u7a7a\u6587\u4ef6/var/lock/subsys/script\uff0c\u5e76\u663e\u793a\u201cstarting script successfully.\u201d\n\u5982\u679c\u53c2\u6570\u4e3astop\uff0c\u5219\u5220\u9664\u6587\u4ef6/var/lock/subsys/script\uff0c\u5e76\u663e\u793a\u201cStop script successfully.\u201d\n\u5982\u679c\u53c2\u6570\u4e3arestart\uff0c\u5219\u5220\u9664\u6587\u4ef6/var/locksubsys/script\u5e76\u91cd\u65b0\u521b\u5efa\uff0c\u800c\u540e\u663e\u793a\u201cRestarting script successfully.\u201d\n\u5982\u679c\u53c2\u6570\u4e3astatus\uff0c\u90a3\u4e48\uff1a\u5982\u679c\u6587\u4ef6/var/lock/subsys/script\u5b58\u5728\uff0c\u5219\u663e\u793a\u201cScript is running\u2026\u201d\uff0c\u5426\u5219\uff0c\u5219\u663e\u793a\u201cScript is stopped.\u201d\n\n#!/bin/bash\nfile='/var/lock/subsys/script'\ncase $1 in\nstart)\n  if [ -f $file ];then\n  echo \"Script is running...\"\n    exit 3\n  else\n  touch $file\n  [ $? -eq 0 ] &amp;&amp; echo \"Starting script successfully.\"\n  fi\n  ;;\nstop)\n  if [ -f $file ];then\n  rm -rf $file\n  [ $? -eq 0 ] &amp;&amp; echo \"Stop script successfully.\"\n  else\n  echo \"Script is stopped...\"\n  exit 4\n  fi\n  ;;\nrestart)\n  if [ -f $file ];then\n  rm -rf $file\n  [ $? -eq 0 ] &amp;&amp; echo \"Stop script successfully\"\n  else \n  echo \"Script is stopped...\"\n  exit 5\n  fi\n  touch $file\n  [ $? -eq 0 ] &amp;&amp; echo \"Starting script successfully\"\n  ;;\nstatus)\n  if [ -f $file ];then\n  echo \"Script is running...\"\n  else\n  echo \"Script is stopped.\"\n  fi\n  ;;\n*)\n  echo \"`basename $0` {start|stop|restart|status}\"\n  exit 2\n  ;;\n esac\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_7","title":"bash\u7f16\u7a0b\u4e4b\u5faa\u73af\u8bed\u53e5","text":"<p>\u5faa\u73af\u4e4bfor\u5faa\u73af</p> <pre><code>1\u3001for\u8bed\u53e5\u683c\u5f0f\u4e00\n\u8bed\u53e5\u7ed3\u6784\uff1a\nfor \u53d8\u91cf\u540d in \u5217\u8868; do\n    \u5faa\u73af\u4f53\ndone\n\u5217\u8868\uff1a\u53ef\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5143\u7d20\n\u5faa\u73af\u4f53\uff1a\u4f9d\u8d56\u4e8e\u8c03\u7528\u53d8\u91cf\u6765\u5b9e\u73b0\u5176\u53d8\u5316\n\u5faa\u73af\u53ef\u5d4c\u5957\n\u9000\u51fa\u6761\u4ef6\uff1a\u904d\u5386\u5143\u7d20\u5217\u8868\u7ed3\u675f\n\u4f8b\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u6b63\u6574\u6570\u4e4b\u548c\n\n#!/bin/bash\ndeclare -i sum=0\nfor i in {1..100}; do\n    let sum+=$i\ndone\necho $sum\n\n2\u3001for\u8bed\u53e5\u683c\u5f0f\u4e8c\nfor ((\u521d\u59cb\u6761\u4ef6;\u6d4b\u8bd5\u6761\u4ef6;\u4fee\u6539\u8868\u8fbe\u5f0f)); do\n      \u5faa\u73af\u4f53\ndone\n\u5148\u7528\u521d\u59cb\u6761\u4ef6\u548c\u6d4b\u8bd5\u6761\u4ef6\u505a\u5224\u65ad\uff0c\u5982\u679c\u7b26\u5408\u6d4b\u8bd5\u6761\u4ef6\u5219\u6267\u884c\u5faa\u73af\u4f53\uff0c\u518d\u4fee\u6539\u8868\u8fbe\u5f0f\uff0c\u5426\u5219\u76f4\u63a5\u8df3\u51fa\u5faa\u73af\u3002\n\n\u4f8b\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u6b63\u6574\u6570\u4e4b\u548c\uff08for\u4e8c\u5b9e\u73b0\uff09\n#!/bin/bash\ndeclare -i sum=0\nfor ((counter=1;$counter &lt;= 100; counter++)); do\n  let sum+=$counter\ndone\necho $sum\n</code></pre> <p>\u5faa\u73af\u4e4bwhile\u8bed\u53e5</p> <p>while\u9002\u7528\u4e8e\u5faa\u73af\u6b21\u6570\u672a\u77e5\uff0c\u6216\u4e0d\u4fbf\u7528for\u76f4\u63a5\u751f\u6210\u8f83\u5927\u7684\u5217\u8868\u65f6</p> <pre><code>\u8bed\u53e5\u7ed3\u6784\uff1a\nwhile \u6d4b\u8bd5\u6761\u4ef6; do\n  \u5faa\u73af\u4f53\ndone\n\u6d4b\u8bd5\u6761\u4ef6\u4e3a\u771f\uff0c\u8fdb\u5165\u5faa\u73af\uff1b\u6d4b\u8bd5\u6761\u4ef6\u4e3a\u5047\uff0c\u9000\u51fa\u5faa\u73af\n\u4f8b1\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u5076\u6570\u4e4b\u548c\uff0c\u8981\u6c42\u4f7f\u7528\u53d6\u6a21\u65b9\u6cd5\n#!/bin/bash\ndeclare -i counter=1\ndeclare -i sum=0\nwhile [ $counter -le 100 ]; do\n  if [ $[$counter%2] -eq 0 ]; then\n     let sum+=$counter\n  fi\n  let counter++\n done\necho $sum\n\n\u4f8b2\uff1a\u63d0\u793a\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u7528\u6237\u540d\uff0c\u5982\u679c\u7528\u6237\u5b58\u5728\uff0c\u5c31\u663e\u793a\u7528\u6237\u7684ID\u53f7\u548cshell\uff1b\u5426\u5219\u663e\u793a\u7528\u6237\u4e0d\u5b58\u5728\uff1b\u663e\u793a\u5b8c\u6210\u4e4b\u540e\u4e0d\u9000\u51fa\uff0c\u518d\u6b21\u91cd\u590d\u524d\u9762\u7684\u64cd\u4f5c\uff0c\u76f4\u5230\u7528\u6237\u8f93\u5165q\u6216quit\u4e3a\u6b62\n#!/bin/bash\nread -p \"Plz enter a username: \" userName\nwhile [ \"$userName\" != 'q' -a \"$userName\" != 'quit' ]; do\n  if id $userName &amp;&gt; /dev/null; then\n     grep \"^$userName\\&gt;\" /etc/passwd | cut -d: -f3,7\n  else\n    echo \"No such user.\"\n  fi\nread -p \"Plz enter a username again: \" userName\ndone\n\nwhile\u7279\u6b8a\u7528\u6cd5\uff1a\u904d\u5386\u6587\u672c\u6587\u4ef6\n\u8bed\u53e5\u7ed3\u6784\uff1a\nwhile read \u53d8\u91cf\u540d; do\n  \u5faa\u73af\u4f53\ndone &lt; /path/to/somefile\n\u53d8\u91cf\u540d\uff0c\u6bcf\u5faa\u73af\u4e00\u6b21\uff0c\u8bb0\u5fc6\u4e86\u6587\u4ef6\u4e2d\u4e00\u884c\u6587\u672c\n\n\u4f8b\uff1a\u663e\u793aID\u53f7\u4e3a\u5076\u6570\uff0c\u4e14ID\u53f7\u540cGID\u7684\u7528\u6237\u7684\u7528\u6237\u540d\u3001ID\u548cSHELL\nwhile read line; do\n  userID=`echo $line | cut -d: -f3`\n  groupID=`echo $line | cut -d: -f4`\n  if [ $[$userID%2] -eq 0 -a $userID -eq $groupID ]; then\n     echo $line | cut -d: -f1,3,7\n  fi\ndone &lt; /etc/passwd\n</code></pre> <p>\u5faa\u73af\u4e4buntil\u8bed\u53e5</p> <pre><code>\u8bed\u53e5\u7ed3\u6784\uff1a\nuntil \u6d4b\u8bd5\u6761\u4ef6; do\n      \u5faa\u73af\u4f53\ndone\n\u6d4b\u8bd5\u6761\u4ef6\u4e3a\u5047\uff0c\u8fdb\u5165\u5faa\u73af\uff1b\u6d4b\u8bd5\u6761\u4ef6\u4e3a\u771f\uff0c\u9000\u51fa\u5faa\u73af\n\n\u4f8b\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u5076\u6570\u4e4b\u548c\uff0c\u8981\u6c42\u4f7f\u7528\u53d6\u6a21\u65b9\u6cd5\uff08until\u5b9e\u73b0\uff09\n\n#!/bin/bash\ndeclare -i counter=1\ndeclare -i sum=0\nuntil [ $counter -gt 100 ]; do\n  if [ $[$counter%2] -eq 0 ]; then\n     let sum+=$counter\n  fi\n  let counter++\ndone\necho $sum\n\u4f8b\uff1a\u63d0\u793a\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u7528\u6237\u540d\uff0c\u5982\u679c\u7528\u6237\u5b58\u5728\uff0c\u5c31\u663e\u793a\u7528\u6237\u7684ID\u53f7\u548cshell\uff1b\u5426\u5219\u663e\u793a\u7528\u6237\u4e0d\u5b58\u5728\uff1b\u663e\u793a\u5b8c\u6210\u4e4b\u540e\u4e0d\u9000\u51fa\uff0c\u518d\u6b21\u91cd\u590d\u524d\u9762\u7684\u64cd\u4f5c\uff0c\u76f4\u5230\u7528\u6237\u8f93\u5165q\u6216quit\u4e3a\u6b62\uff08until\u5b9e\u73b0\uff09\n\n\n#!/bin/bash\nread -p \"Plz enter a username: \" userName\nuntil [ \"$userName\" = 'q' -a \"$userName\" = 'quit' ]; do\n  if id $userName &amp;&gt; /dev/null; then\n   grep \"^$userName\\&gt;\" /etc/passwd | cut -d: -f3,7\nelse\necho \"No such user.\"\nfi\nread -p \"Plz enter a username again: \" userName\ndone\n</code></pre> <p>\u5faa\u73af\u4e4b\u5faa\u73af\u63a7\u5236\u548cshift</p> <pre><code>\n\u5faa\u73af\u63a7\u5236\u547d\u4ee4\uff1a\nbreak\uff1a\u63d0\u524d\u9000\u51fa\u5faa\u73af\nbreak [N]: \u9000\u51faN\u5c42\u5faa\u73af\uff1bN\u7701\u7565\u65f6\u8868\u793a\u9000\u51fabreak\u8bed\u53e5\u6240\u5728\u7684\u5faa\u73af\ncontinue: \u63d0\u524d\u7ed3\u675f\u672c\u8f6e\u5faa\u73af\uff0c\u800c\u76f4\u63a5\u8fdb\u5165\u4e0b\u8f6e\u5faa\u73af\ncontinue [N]\uff1a\u63d0\u524d\u7b2cN\u5c42\u7684\u5faa\u73af\u7684\u672c\u8f6e\u5faa\u73af\uff0c\u800c\u76f4\u63a5\u8fdb\u5165\u4e0b\u8f6e\u5faa\u73af\n</code></pre> <p>\u6b7b\u5faa\u73af\uff1a</p> <pre><code>\n#while\u4f53while true; do\n      \u5faa\u73af\u4f53\ndone\n#until\u4f53\nuntil false; do\n      \u5faa\u73af\u4f53\ndone\n\n\u4f8b1\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u5224\u65ad\u7ed9\u5b9a\u7684\u7528\u6237\u662f\u5426\u767b\u5f55\u4e86\u5f53\u524d\u7cfb\u7edf\n(1) \u5982\u679c\u767b\u5f55\u4e86\uff0c\u5219\u811a\u672c\u7ec8\u6b62\uff1b\n(2) \u6bcf5\u79d2\u79cd\uff0c\u67e5\u770b\u4e00\u6b21\u7528\u6237\u662f\u5426\u767b\u5f55\uff1b\n#!/bin/bash\nwhile true; do\n    who | grep \"gentoo\" &amp;&gt; /dev/null\n    if [ $? -eq 0 ];then\nbreak\n    fi\n    sleep 5\ndone\necho \"gentoo is logged.\"\n</code></pre> <p>shift\uff1a</p> <pre><code>\u5982\u679c\u6ca1\u6709\u6570\u5b57\uff0c\u53ea\u6709shift \u5c31\u662f\u8df3\u8fc7\u4e00\u4e2a\u53c2\u6570\u83b7\u53d6\u4e0b\u4e00\u4e2a\u53c2\u6570\uff0c\u5982\u679c\u52a0\u4e0a\u6570\u5b57\uff0c\u6bd4\u5982shift 2 \uff0c\u8df3\u8fc7\u4e24\u4e2a\u53c2\u6570\u83b7\u53d6\u4e0b\u4e00\u4e2a\u53c2\u6570\u3002\n\u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u4f7f\u7528\u5f62\u5f0f\u5982\u4e0b\u6240\u793a    \nshowifinfo.sh [-i INTERFACE|-a] [-v]\n\u8981\u6c42\uff1a\n1\u3001-i\u6216-a\u4e0d\u53ef\u540c\u65f6\u4f7f\u7528\uff0c-i\u7528\u4e8e\u6307\u5b9a\u7279\u5b9a\u7f51\u5361\u63a5\u53e3\uff0c-a\u7528\u4e8e\u6307\u5b9a\u6240\u6709\u63a5\u53e3\uff1b\n\u663e\u793a\u63a5\u53e3\u7684ip\u5730\u5740\n2\u3001\u4f7f\u7528-v\uff0c\u5219\u8868\u793a\u663e\u793a\u8be6\u7ec6\u4fe1\u606f\uff0c\u663e\u793a\u63a5\u53e3\u7684ip\u5730\u5740\u3001\u5b50\u7f51\u63a9\u7801\u3001\u5e7f\u64ad\u5730\u5740\uff1b\n3\u3001\u9ed8\u8ba4\u8868\u793a\u4ec5\u4f7f\u7528-a\u9009\u9879;\n\n#!/bin/bash\nallinterface=0\nifflag=0\nverbose=0\ninterface=0\nif [ $# -eq 0 ];then\n  ifconfig | grep \"inet addr:\" | awk '{print $2}'\nfi\nwhile [ $# -ge 1 ];do\n  case $1 in \n-a)\n allinterface=1\n shift 1\n  ;;\n-i)\n  ifflag=1\n  interface=$2\n  shift 2\n  ;;\n-v)\n  verbose=1\n  shift 1\n  ;;\n  *)\necho \"error option\"\nexit 2\n  ;;\n  esac\ndone\nif [ $allinterface -eq 1 ];then\n  if [ $ifflag -eq 1 ];then\n   echo \"command not found\"\n    exit 5\n  fi\n  if [ $verbose -eq 1 ];then\n    ifconfig | grep \"inet addr:\"\n  else\n    ifconfig | grep \"inet addr:\" | awk '{print $2}'\n  fi\nfi\nif [ $ifflag -eq 1 ];then\n  if [ $allinterface -eq 1 ];then\n        echo \"command not found\"\n        exit 5\n  fi\n if [ $verbose -eq 1 ];then\n    ifconfig $interface | grep \"inet addr:\"\n  else\n    ifconfig $interface | grep \"inet addr:\" | awk '{print $2}'\n  fi\nfi\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_8","title":"bash\u7f16\u7a0b\u4e4b\u51fd\u6570","text":""},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#_2","title":"\u8bed\u6cd5\u7ed3\u6784\uff1a","text":"<pre><code>\nfunction F_NAME {    \n   \u51fd\u6570\u4f53\n  }\n\n  F_NAME() {\n    \u51fd\u6570\u4f53\n  }\n</code></pre> <p>\u53ef\u8c03\u7528\uff1a\u4f7f\u7528\u51fd\u6570\u540d\uff0c\u51fd\u6570\u540d\u51fa\u73b0\u7684\u5730\u65b9\uff0c\u4f1a\u88ab\u81ea\u52a8\u66ff\u6362\u4e3a\u51fd\u6570 \u51fd\u6570\u7684\u8fd4\u56de\u503c\uff1a \u51fd\u6570\u7684\u6267\u884c\u7ed3\u679c\u8fd4\u56de\u503c\uff1a\u4ee3\u7801\u7684\u8f93\u51fa \u51fd\u6570\u4e2d\u4f7f\u7528\u6253\u5370\u8bed\u53e5\uff1aecho, printf \u51fd\u6570\u4e2d\u8c03\u7528\u7684\u7cfb\u7edf\u547d\u4ee4\u6267\u884c\u540e\u8fd4\u56de\u7684\u7ed3\u679c \u6267\u884c\u72b6\u6001\u8fd4\u56de\u503c\uff1a \u9ed8\u8ba4\u53d6\u51b3\u4e8e\u51fd\u6570\u4f53\u6267\u884c\u7684\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u72b6\u6001\u7ed3\u679c \u81ea\u5b9a\u4e49\u9000\u51fa\u72b6\u6001\u7801\uff1areturn [0-255]</p> <p>\u6ce8\u610f\uff1a\u51fd\u6570\u4f53\u8fd0\u884c\u65f6\uff0c\u4e00\u65e6\u9047\u5230return\u8bed\u53e5\uff0c\u51fd\u6570\u5373\u8fd4\u56de\uff1b</p> <p>\u51fd\u6570\u53ef\u4ee5\u63a5\u53d7\u53c2\u6570\uff1a \u5728\u51fd\u6570\u4f53\u4e2d\u8c03\u7528\u51fd\u6570\u53c2\u6570\u7684\u65b9\u5f0f\u540c\u811a\u672c\u4e2d\u8c03\u7528\u811a\u672c\u53c2\u6570\u7684\u65b9\u5f0f\uff1a</p> <pre><code>\u4f4d\u7f6e\u53c2\u6570\n$1, $2, \u2026\n$#, $*, $@\n</code></pre> <p>\u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u5b8c\u6210\u5982\u4e0b\u529f\u80fd(\u4f7f\u7528\u51fd\u6570)\uff1a</p> <p>1\u3001\u63d0\u793a\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u53ef\u6267\u884c\u547d\u4ee4\uff1b</p> <p>2\u3001\u83b7\u53d6\u8fd9\u4e2a\u547d\u4ee4\u6240\u4f9d\u8d56\u7684\u6240\u6709\u5e93\u6587\u4ef6(\u4f7f\u7528ldd\u547d\u4ee4)\uff1b</p> <p>3\u3001\u590d\u5236\u547d\u4ee4\u81f3/mnt/sysroot/\u5bf9\u5e94\u7684\u76ee\u5f55\u4e2d</p> <p>\u89e3\u91ca\uff1a\u5047\u8bbe\uff0c\u5982\u679c\u590d\u5236\u7684\u662fcat\u547d\u4ee4\uff0c\u5176\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u8def\u5f84\u662f/bin/cat\uff0c\u90a3\u4e48\u5c31\u8981\u5c06/bin/cat\u590d\u5230/mnt/sysroot/bin/\u76ee\u5f55\u4e2d\uff0c\u5982\u679c\u590d\u5236\u7684\u662fuseradd\u547d\u4ee4\uff0c\u800cuseradd\u7684\u53ef\u6267\u884c\u6587\u4ef6\u8def\u5f84\u4e3a/usr/sbin/useradd\uff0c\u90a3\u4e48\u5c31\u8981\u5c06\u5176\u590d\u5236\u5230/mnt/sysroot/usr/sbin/\u76ee\u5f55\u4e2d\uff1b</p> <p>4\u3001\u590d\u5236\u5404\u5e93\u6587\u4ef6\u81f3/mnt/sysroot/\u5bf9\u5e94\u7684\u76ee\u5f55\u4e2d\uff1b</p> <pre><code>#!/bin/bash\ntarget=/mnt/sysroot/\n[ -d $target ] || mkdir $target\npreCommand() {\n    if which $1 &amp;&gt; /dev/null; then\n  commandPath=`which --skip-alias $1`\n  return 0\n    else\n  echo \"No such command.\"\n  return 1\n    fi\n}\n\ncommandCopy() {\n    commandDir=`dirname $1`\n    [ -d ${target}${commandDir} ] || mkdir -p ${target}${commandDir}\n    [ -f ${target}${commandPath} ] || cp $1 ${target}${commandDir}\n}\n\nlibCopy() {\n    for lib in `ldd $1 | egrep -o \"/[^[:space:]]+\"`; do\nlibDir=`dirname $lib`\n[ -d ${target}${libDir} ] || mkdir -p ${target}${libDir}\n[ -f ${target}${lib} ] || cp $lib ${target}${libDir}\n    done\n} \nread -p \"Plz enter a command: \" command\n\nuntil [ \"$command\" == 'quit' ]; do\n\n  if preCommand $command &amp;&gt; /dev/null; then\n    commandCopy $commandPath\n    libCopy $commandPath\n  fi\n\n  read -p \"Plz enter a command: \" command\ndone\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_9","title":"bash\u7f16\u7a0b\u4e4b\u4fe1\u53f7\u6355\u6349","text":"<p>trap\u547d\u4ee4\u7528\u4e8e\u5728shell\u7a0b\u5e8f\u4e2d\u6355\u6349\u5230\u4fe1\u53f7\uff0c\u4e4b\u540e\u53ef\u4ee5\u6709\u4e09\u79cd\u53cd\u5e94\u65b9\u5f0f\uff1a</p> <ul> <li>(1)\u6267\u884c\u4e00\u6bb5\u7a0b\u5e8f\u6765\u5904\u7406\u8fd9\u4e00\u4fe1\u53f7</li> <li>(2)\u63a5\u53d7\u4fe1\u53f7\u7684\u9ed8\u8ba4\u64cd\u4f5c</li> <li>(3)\u5ffd\u89c6\u8fd9\u4e00\u4fe1\u53f7</li> </ul> <p>trap\u5bf9\u4e0a\u9762\u4e09\u79cd\u65b9\u5f0f\u63d0\u4f9b\u4e86\u4e09\u79cd\u57fa\u672c\u5f62\u5f0f\uff1a</p> <p>\u7b2c\u4e00\u79cd\u5f62\u5f0f\u7684trap\u547d\u4ee4\u5728shell\u63a5\u6536\u5230signal list\u6e05\u5355\u4e2d\u6570\u503c\u76f8\u540c\u7684\u4fe1\u53f7\u65f6\uff0c\u5c06\u6267\u884c\u53cc\u5f15\u53f7\u4e2d\u7684\u547d\u4ee4\u4e32\u3002</p> <pre><code>trap 'commands' signal-list\ntrap \"commands\" signal-list\n</code></pre> <p>\u7b2c\u4e8c\u79cd\u5f62\u5f0f\u7684trap\u547d\u4ee4\u6062\u590d\u4fe1\u53f7\u7684\u9ed8\u8ba4\u64cd\u4f5c\uff1a</p> <pre><code>trap signal-list\n</code></pre> <p>\u7b2c\u4e09\u79cd\u5f62\u5f0f\u7684trap\u547d\u4ee4\u5141\u8bb8\u5ffd\u89c6\u4fe1\u53f7\uff1a</p> <pre><code>trap \" \" signal-list\ntrap 'COMMAND' SIGINT\uff08\u8868\u793a\u5173\u95ed\u8fdb\u7a0b\uff09\n</code></pre> <p>\u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u80fd\u591fping\u63a2\u6d4b\u6307\u5b9a\u7f51\u7edc\u5185\u7684\u6240\u6709\u4e3b\u673a\u662f\u5426\u5728\u7ebf,\u5f53\u6ca1\u6709\u6267\u884c\u5b8c\u65f6\u53ef\u63a5\u6536ctrl+c\u547d\u4ee4\u9000\u51fa\u3002</p> <pre><code>\n#!/bin/bash\nquitScript() {\n   echo \"Quit...\"\n}    \ntrap 'quitScript; exit 5' SIGINT\n\ncnetPing() {\n  for i in {1..254}; do\n    if ping -c 1 -W 1 $1.$i &amp;&gt; /dev/null; then\n      echo \"$1.$i is up.\"\n     else\n      echo \"$1.$i is down.\"\n    fi\n    done\n}\n\nbnetPing() {\n  for j in {0..255}; do\n    cnetPing $1.$j \n  done\n}\nanetPing() {\nfor m in {0..255}; do\nbnetPing $1.$m\ndone\n}\n\nnetType=`echo $1 | cut -d\".\" -f1`\n\nif [ $netType -ge 1 -a $netType -le 126 ]; then\nanetPing $netType\nelif [ $netType -ge 128 -a $netType -le 191 ]; then\nbnetPing $(echo $1 | cut -d'.' -f1,2)\nelif [ $netType -ge 192 -a $netType -le 223 ]; then\ncnetPing $(echo $1 | cut -d'.' -f1-3)\nelse\necho \"Wrong\"\nexit 2\nfi\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_10","title":"bash\u7f16\u7a0b\u4e4b\u6570\u7ec4","text":"<p>\u6570\u7ec4\uff1a\u8fde\u7eed\u7684\u591a\u4e2a\u72ec\u7acb\u5185\u5b58\u7a7a\u95f4\uff0c\u6bcf\u4e2a\u5185\u5b58\u7a7a\u95f4\u76f8\u5f53\u4e8e\u4e00\u4e2a\u53d8\u91cf \u6570\u7ec4\u5143\u7d20\uff1a\u6570\u7ec4\u540d+\u7d22\u5f15\uff08\u4ece0\u5f00\u59cb\u7f16\u53f7\uff09 \u7d22\u5f15\u7684\u8868\u793a\u65b9\u5f0f\uff1aa[0], a[1] \u58f0\u660e\u6570\u7ec4\uff1a</p> <pre><code>declare -a ARRAR_NAME\n</code></pre> <p>\u5173\u8054\u6570\u7ec4\uff1a</p> <pre><code>declare -A ARRAY_NAME\n</code></pre> <p>\u652f\u6301\u7a00\u758f\u683c\u5f0f\uff1a\u4ec5\u4e00\u7ef4\u6570\u7ec4  </p> <p>\u6570\u7ec4\u5143\u7d20\u7684\u8d4b\u503c\uff1a</p> <p>(1) \u4e00\u6b21\u53ea\u8d4b\u503c\u4e00\u4e2a\u5143\u7d20</p> <pre><code>a[0]=$RANDOM\n</code></pre> <p>(2) \u4e00\u6b21\u8d4b\u503c\u5168\u90e8\u5143\u7d20</p> <pre><code>a=(red blue yellow green)\n</code></pre> <p>(3) \u6307\u5b9a\u7d22\u5f15\u8fdb\u884c\u8d4b\u503c</p> <pre><code>a=([0]=green [3]=red [2]=blue [6]=yellow)\n</code></pre> <p>(4) \u7528\u6237\u8f93\u5165</p> <pre><code>read -a ARRAY\n</code></pre> <p>\u6570\u7ec4\u7684\u8bbf\u95ee\uff1a \u7528\u7d22\u5f15\u8bbf\u95ee\uff1a</p> <pre><code>ARRAY[index]\n</code></pre> <p>\u6570\u7ec4\u7684\u957f\u5ea6\uff1a</p> <pre><code>${#ARRAY[*]}\n${#ARRAY[@]}\n</code></pre> <p>\u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u751f\u621010\u4e2a\u968f\u673a\u6570\uff0c\u4fdd\u5b58\u81f3\u6570\u7ec4\u4e2d\uff1b\u800c\u540e\u663e\u793a\u6570\u7ec4\u4e0b\u6807\u4e3a\u5076\u6570\u7684\u5143\u7d20</p> <pre><code>#\uff01/bin/bash\nfor i in {0..9}; do\n    rand[$i]=$RANDOM\n    [ $[$i%2] -eq 0 ] &amp;&amp; echo \"$i:${rand[$i]}\"\ndone\n</code></pre> <p>\u4ece\u6570\u7ec4\u4e2d\u6311\u9009\u67d0\u5143\u7d20:</p> <pre><code>${ARRAY[@]:offset:number}\n</code></pre> <p>\u5207\u7247\uff1a</p> <pre><code>offset: \u504f\u79fb\u7684\u5143\u7d20\u4e2a\u6570\nnumber: \u53d6\u51fa\u7684\u5143\u7d20\u7684\u4e2a\u6570\n${ARRAY[@]:offset}\uff1a\u53d6\u51fa\u504f\u79fb\u91cf\u540e\u7684\u6240\u6709\u5143\u7d20\n${ARRAY[@]}: \u53d6\u51fa\u6240\u6709\u5143\u7d20\n</code></pre> <p>\u6570\u7ec4\u590d\u5236\uff1a\u8981\u4f7f\u7528${ARRAY[@]}</p> <pre><code>$@: \u6bcf\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u4e32\n$*: \u6240\u6709\u53c2\u6570\u662f\u4e00\u4e2a\u4e32\n</code></pre> <p>\u5411\u6570\u7ec4\u4e2d\u8ffd\u52a0\u5143\u7d20\uff1a\u975e\u7a00\u758f\u683c\u5f0f</p> <pre><code>week, \nweek[${#week[@]}]\n</code></pre> <p>\u4ece\u6570\u7ec4\u4e2d\u5220\u9664\u5143\u7d20\uff1a</p> <pre><code>unset ARRAY[index]\n</code></pre> <p>\u4f8b\uff1a\u590d\u5236\u4e00\u4e2a\u6570\u7ec4\u4e2d\u4e0b\u6807\u4e3a\u5076\u6570\u7684\u5143\u7d20\u81f3\u4e00\u4e2a\u65b0\u6570\u7ec4\u4e2d</p> <pre><code>#!/bin/bash\ndeclare -a mylogs\nlogs=(/var/log/*.log)\necho ${logs[@]}\nfor i in `seq 0 ${#logs[@]}`; do\n  if [ $[$i%2] -eq 0 ];then\n    index=${#mylogs[@]}\n     mylogs[$index]=${logs[$i]}\n  fi\ndone\necho ${mylogs[@]}\n</code></pre> <p>\u4f8b2\uff1a\u751f\u621010\u4e2a\u968f\u673a\u6570\uff0c\u5347\u5e8f\u6392\u5e8f</p> <pre><code>\n#!/bin/bash\nfor((i=0;i&lt;10;i++))\ndo\n  rnd[$i]=$RANDOM\ndone\necho -e \"total=${#rnd[@]}\\n${rnd[@]}\\nBegin to sort\"\nfor((i=9;i&gt;=1;i--))\ndo\n        for((j=0;j&lt;i;j++))\n  do\n  if [ ${rnd[$j]} -gt ${rnd[$[$j+1]]} ] ;then\n    swapValue=${rnd[$j]}\n    rnd[$j]=${rnd[$[$j+1]]}\n    rnd[$[$j+1]]=$swapValue\n  fi\n  done\ndone\necho ${rnd[@]}\n</code></pre> <p>\u4f8b3\uff1a\u6253\u5370\u4e5d\u4e5d\u4e58\u6cd5\u8868</p> <pre><code>#!/bin/bashfor((i=1;i&lt;=9;i++))\ndo \nstrLine=\"\"\n  for((j=1;i&lt;=9;j++))\n  do\n    strLine=$strLine\"$i*$j=\"$[$i*$j]\"\\t\"\n    [ $i -eq $j ] &amp;&amp; echo -e $strLine &amp;&amp; break\n  done\ndone\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_11","title":"bash\u7f16\u7a0b\u4e4b\u5b57\u7b26\u4e32\u64cd\u4f5c","text":"<p>\u5b57\u7b26\u4e32\u5207\u7247\uff1a</p> <pre><code>${string:offset:length}\n[root@scholar scripts]# string='hello word'\n[root@scholar scripts]# echo ${string:2:4}\nllo\n\n\u53d6\u5c3e\u90e8\u7684\u6307\u5b9a\u4e2a\u6570\u7684\u5b57\u7b26\uff1a\n${string: -length}\n[root@scholar scripts]# echo ${string: -2}\nrd\n\n</code></pre> <p>\u53d6\u5b50\u4e32\uff1a\u57fa\u4e8e\u6a21\u5f0f</p> <ul> <li><code>${variable#*word}</code>\uff1a\u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u5de6\u800c\u53f3\uff0c\u67e5\u627e\u7b2c\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u5b57\u7b26\u5f00\u59cb\u81f3\u6b64word\u5904\u7684\u6240\u6709\u5185\u5bb9\uff1b</li> <li>$<code>{variable##*word}</code>\uff1a\u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u5de6\u800c\u53f3\uff0c\u67e5\u627e\u6700\u540e\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u5b57\u7b26\u5f00\u59cb\u81f3\u6b64word\u5904\u7684\u6240\u6709\u5185\u5bb9\uff1b   <code>file='/var/log/messages' ${file#*/}: \u8fd4\u56de\u7684\u7ed3\u679c\u662fvar/log/messages ${file##*/}: \u8fd4\u56demessages</code></li> <li><code>${variable%word*}</code>: \u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u53f3\u800c\u5de6\uff0c\u67e5\u627e\u7b2c\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u6b64word\u5904\u81f3\u5b57\u4e32\u5c3e\u90e8\u7684\u6240\u6709\u5185\u5bb9\uff1b</li> <li><code>${variable%%world*}</code>:\u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u53f3\u800c\u5de6\uff0c\u67e5\u627e\u6700\u540e\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u6b64word\u5904\u81f3\u5b57\u4e32\u5c3e\u90e8\u7684\u6240\u6709\u5185\u5bb9\uff1b</li> </ul> <pre><code>file='/var/log/messages'\n${file%*/}: \u8fd4\u56de\u7684\u7ed3\u679c\u662f/var/log\n${file%%*/}: \u8fd4\u56de\u7ed3\u679c\u4e3a\u7a7a\n\n\u4f8b\uff1aurl=\"http://www.redhat.com:80\"\n\u53d6\u7aef\u53e3\uff1a${url##*:}\n\u53d6\u534f\u8bae\uff1a${url%%:*}\n</code></pre> <p>\u67e5\u627e\u66ff\u6362\uff1a</p> <ul> <li><code>${variable/pattern/substi}</code>: \u66ff\u6362\u7b2c\u4e00\u6b21\u51fa\u73b0</li> </ul> <pre><code>#userinfo=`tail -1 /etc/passwd\n#echo $userinfo\nscholar:x:500:500:scholar:/home/scholar:/bin/bash\n#echo ${userinfo/scholar/redhat}\nredhat:x:500:500:scholar:/home/scholar:/bin/bash\n</code></pre> <ul> <li><code>${variable//pattern/substi}</code>\uff1a\u66ff\u6362\u6240\u6709\u7684\u51fa\u73b0</li> </ul> <pre><code>#echo ${userinfo//scholar/redhat}\nredhat:x:500:500:redhat:/home/redhat:/bin/bash\n</code></pre> <ul> <li><code>${variable/#pattern/substi}</code>\uff1a\u66ff\u6362\u884c\u9996\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9</li> </ul> <pre><code>#echo ${userinfo/#scholar/redhat}\nredhat:x:500:500:scholar:/home/scholar:/bin/bash\n</code></pre> <ul> <li><code>${variable/%pattern/substi}</code>\uff1a\u66ff\u6362\u884c\u5c3e\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9</li> </ul> <pre><code>#echo ${userinfo/%bash/redhat}\nscholar:x:500:500:scholar:/home/scholar:/bin/redhat\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#patternglobbing","title":"pattern\u53ef\u4ee5\u4f7f\u7528globbing\u4e2d\u7684\u5143\u5b57\u7b26\uff1a<code>* \uff1f</code>","text":"<p>\u67e5\u627e\u5220\u9664\uff1a</p> <ul> <li><code>${variable/pattern}</code>\uff1a\u5220\u9664\u7b2c\u4e00\u6b21\u51fa\u73b0</li> </ul> <pre><code>#echo ${userinfo/scholar}\n:x:500:500:scholar:/home/scholar:/bin/bash\n</code></pre> <ul> <li><code>${variable//pattern}</code>\uff1a\u5220\u9664\u6240\u6709\u7684\u51fa\u73b0</li> </ul> <pre><code>#echo ${userinfo//scholar}\n:x:500:500::/home/:/bin/bash\n</code></pre> <ul> <li><code>${variable/#pattern}</code>\uff1a\u5220\u9664\u884c\u9996\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9</li> </ul> <pre><code>#echo ${userinfo/#scholar}\n:x:500:500:scholar:/home/scholar:/bin/bash\n</code></pre> <ul> <li><code>${variable/%pattern}</code>\uff1a\u5220\u9664\u884c\u5c3e\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9</li> </ul> <pre><code>#echo ${userinfo/%bash}\nscholar:x:500:500:scholar:/home/scholar:/bin/\n</code></pre> <p>\u5927\u5c0f\u5199\u8f6c\u6362\uff1a</p> <p>\u5c0f\u2013&gt;\u5927\uff1a<code>${variable^^}</code></p> <pre><code>#echo ${userinfo^^}\nSCHOLAR:X:500:500:SCHOLAR:/HOME/SCHOLAR:/BIN/BASH\n</code></pre> <p>\u5927\u2013&gt;\u5c0f\uff1a<code>${variable,,}</code></p> <pre><code>#name=\"SCHOLAR\"\n#echo ${name,,}\nscholar\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#_3","title":"\u53d8\u91cf\u8d4b\u503c\u64cd\u4f5c\uff1a","text":"<ul> <li><code>${variable:-string}</code>:variable\u4e3a\u7a7a\u6216\u672a\u8bbe\u5b9a\uff0c\u90a3\u4e48\u8fd4\u56destring\uff0c\u5426\u5219\uff0c\u8fd4\u56devariable\u53d8\u91cf\u7684\u503c\uff1b</li> <li><code>${variable:=string}</code>:variable\u4e3a\u7a7a\u6216\u672a\u8bbe\u5b9a\uff0c\u5219\u8fd4\u56destring\uff0c\u4e14\u5c06string\u8d4b\u503c\u7ed9\u53d8\u91cfvariable\uff0c\u5426\u5219\uff0c\u8fd4\u56devariable\u7684\u503c\uff1b</li> </ul> <p>\u4e3a\u811a\u672c\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u786e\u4fdd\u67d0\u53d8\u91cf\u6709\u53ef\u7528\u503c\u7684\u65b9\u5f0f</p> <p><code>variable=${variable:-default vaule}</code></p> <p>\u5199\u4e2a\u811a\u672c\uff0c\u914d\u7f6eetc\u76ee\u5f55\uff1b</p> <ul> <li>(1) \u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5b9a\u4e49\u53d8\u91cf\uff1b</li> <li>(2) \u5728\u811a\u672c\u4e2dsource\u914d\u7f6e\u6587\u4ef6\uff1b</li> </ul> <pre><code>#!/bin/bash\n[ -f /etc/sysconfig/network ] &amp;&amp; source /etc/network/network\n[-z \"$HOSTAME\" -o \"$HOSTNAME\" = '(none)' ] || HOSTNAME ='localhost'\n/bin/hostname $HOSTNAME\n/bin/hostname\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#mktemp","title":"mktemp\u547d\u4ee4\uff1a","text":"<p>mktemp [OPTIONS] filename.XXX</p> <pre><code>-d: \u521b\u5efa\u4e34\u65f6\u76ee\u5f55\n--tmpdir=/path/to/somewhere \uff1a\u6307\u5b9a\u4e34\u65f6\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\n\nmktemp /tmp/tmp.XXX                    #XXX\u751f\u6210\u76f8\u540c\u6570\u91cf\u968f\u673a\u5b57\u7b26\nmktemp --tmpdir=/var/tmp tmp.XXX       #\u6307\u5b9a\u76ee\u5f55\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\nmktemp --tmpdir=/var/tmp -d tmp.XXX    #\u6307\u5b9a\u76ee\u5f55\u521b\u5efa\u4e34\u65f6\u76ee\u5f55\n</code></pre>"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#install","title":"install\u547d\u4ee4:","text":"<p>install [OPTIONS] SOURCE DEST install [OPTIONS] SOURCE\u2026 DIR install [OPTIONS] -d DIR \u2026</p> <pre><code>\u589e\u5f3a\u578b\u7684\u590d\u5236\u547d\u4ee4\uff1a\n-o OWNER\n-g GROUP\n-m MODE\n-d : \u521b\u5efa\u76ee\u5f55\n\ninstall /etc/fstab /tmp                 #\u590d\u5236\u6587\u4ef6\u5230\u6307\u5b9a\u76ee\u5f55\ninstall --mode=644 /etc/fstab /tmp/     #\u590d\u5236\u65f6\u6307\u5b9a\u6743\u9650\ninstall --owner=scholar /etc/fstab /tmp #\u590d\u5236\u65f6\u6307\u5b9a\u5c5e\u4e3b\ninstall --group=scholar /etc/fstab /tmp #\u590d\u5236\u65f6\u6307\u5b9a\u5c5e\u7ec4\ninstall -d /tmp/install                 #\u521b\u5efa\u76ee\u5f55\n</code></pre>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/","title":"Explain\u8be6\u89e3\u4e0e\u7d22\u5f15\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#explain","title":"explain\u8be6\u89e3\u4e0e\u7d22\u5f15\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#info","title":"info","text":"<ul> <li>1 </li> <li>2 </li> <li>3 </li> <li>4 </li> <li>5 </li> <li>6 </li> <li>7 </li> <li>8 </li> <li>9 </li> <li>10 </li> <li>11 </li> <li>12 </li> </ul> select_type \u542b\u4e49 SIMPLE \u7b80\u5355\u7684select\u67e5\u8be2,\u67e5\u8be2\u4e2d\u4e0d\u5305\u542b\u5b50\u67e5\u8be2\u6216\u8005UNION PRIMARY \u67e5\u8be2\u4e2d\u82e5\u5305\u542b\u4efb\u4f55\u590d\u6742\u7684\u5b57\u67e5\u8be2,\u6700\u5916\u5c42\u67e5\u8be2\u6807\u8bb0\u4e3a\u8be5\u6807\u8bc6 SUBQUERY \u5728SELECT\u6216WHERE\u5217\u8868\u4e2d\u5305\u542b\u4e86\u5b50\u67e5\u8be2 DERIVED \u5728FROM\u5217\u8868\u4e2d\u5305\u542b\u7684\u5b50\u67e5\u8be2,\u88ab\u6807\u8bb0\u4e3aDERIVED(\u884d\u751f)MySQL\u4f1a\u9012\u5f52\u6267\u884c\u8fd9\u4e9b\u5b50\u67e5\u8be2,\u628a\u7ed3\u679c\u653e\u5728\u4e34\u65f6\u8868\u4e2d UNION \u82e5\u7b2c\u4e8c\u4e2aSELECT\u51fa\u73b0\u5728UNION\u4e4b\u540e,\u5219\u6807\u8bb0\u4e3aUNION;\u82e5UNION\u5305\u542b\u5728FROM\u5b57\u53e5\u7684\u5b50\u67e5\u8be2\u4e2d,\u5916\u5c42SELECT\u5c06\u88ab\u6807\u8bb0\u4e3a:DERIVED UNION RESULT \u4eceUNION\u8868\u83b7\u53d6\u7ed3\u679c\u7684SELECT"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#explain-type","title":"explain \u4e4btype","text":"type \u542b\u4e49 NULL MySQL\u4e0d\u8bbf\u95ee\u4efb\u4f55\u8868,\u7d22\u5f15,\u76f4\u63a5\u8fd4\u56de\u7ed3\u679c system \u8868\u53ea\u6709\u4e00\u884c\u8bb0\u5f55(\u7b49\u4e8e\u7cfb\u7edf\u8868),\u8fd9\u662fconst\u7c7b\u578b\u7684\u7279\u4f8b,\u4e00\u822c\u4e0d\u4f1a\u51fa\u73b0 const \u8868\u793a\u901a\u8fc7\u7d22\u5f15\u4e00\u6b21\u5c31\u627e\u5230\u4e86,const\u7528\u4e8e\u6bd4\u8f83primary key\u6216\u8005unique\u7d22\u5f15.\u56e0\u4e3a\u53ea\u5339\u914d\u4e00\u884c\u6570\u636e,\u6240\u4ee5\u5f88\u5feb.\u5982\u5c06\u4e3b\u952e\u7f6e\u4e8ewhere\u5217\u8868\u4e2d,MySQL\u5c31\u80fd\u5c06\u8be5\u67e5\u8be2\u8f6c\u6362\u4e3a\u4e00\u4e2a\u5e38\u91cf.const\u4e8e\u5c06\"\u4e3b\u952e\"\u6216\"\u552f\u4e00\"\u7d22\u5f15\u7684\u6240\u6709\u90e8\u5206\u4e0e\u5e38\u91cf\u503c\u8fdb\u884c\u6bd4\u8f83 eq_ref \u7c7b\u578bref,\u533a\u522b\u5728\u4e8e\u4f7f\u7528\u7684\u662f\u552f\u4e00\u7d22\u5f15,\u4f7f\u7528\u4e3b\u952e\u7684\u5e76\u8054\u67e5\u8be2,\u5173\u8054\u67e5\u8be2\u7684\u8bb0\u5f55\u53ea\u6709\u4e00\u6761.\u5e38\u89c1\u4e8e\u4e3b\u952e\u6216\u552f\u4e00\u7d22\u5f15\u63cf\u8ff0 ref \u975e\u552f\u4e00\u6027\u7d22\u5f15\u63cf\u8ff0,\u8fd4\u56de\u5339\u914d\u67d0\u4e2a\u5355\u72ec\u503c\u5f97\u6240\u6709\u884c.\u672c\u8d28\u4e0a\u4e5f\u662f\u4e00\u79cd\u7d22\u5f15\u8bbf\u95ee,\u8fd4\u56de\u6240\u6709\u5339\u914d\u67d0\u4e2a\u5355\u72ec\u503c\u7684\u6240\u6709\u884c(\u591a\u4e2a) range \u53ea\u68c0\u7d22\u7ed9\u5b9a\u8fd4\u56de\u7684\u884c,\u4f7f\u7528\u4e00\u4e2a\u7d22\u5f15\u6765\u9009\u62e9\u884c.where\u4e4b\u540e\u51fa\u73b0between,&lt;,&gt;,in \u7b49\u64cd\u4f5c index index\u4e0eALL\u7684\u533a\u522b\u4e3aindex\u7c7b\u578b\u53ea\u662f\u904d\u5386\u4e86\u7d22\u5f15\u6811,\u901a\u5e38\u6bd4ALL\u5feb,ALL\u662f\u904d\u5386\u6570\u636e\u6587\u4ef6 ALL \u5c06\u904d\u5386\u5168\u8868\u4ee5\u627e\u5230\u5339\u914d\u7684\u884c <p>\u7ed3\u679c\u503c\u4ece \u6700\u597d \u5230 \u6700\u574f \u4f9d\u6b21\u662f:</p> <pre><code>NULL &gt; system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL\n\nsystem &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL\n</code></pre> <p>\u4e00\u822c\u6765\u8bf4,\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u67e5\u8be2\u81f3\u5c11\u8fbe\u5230range\u7ea7\u522b, \u6700\u540e\u8fbe\u5230ref.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#explain-key","title":"explain \u4e4bkey","text":"<pre><code>possible_keys: \u663e\u793a\u53ef\u80fd\u5e94\u7528\u5728\u8fd9\u5f20\u8868\u7684\u7d22\u5f15, \u4e00\u4e2a\u6216\u591a\u4e2a\nkey: \u5b9e\u9645\u4f7f\u7528\u7684\u7d22\u5f15,\u5982\u679c\u4e3aNULL,\u5219\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15\nkey_len: \u8868\u793a\u7d22\u5f15\u4e2d\u4f7f\u7528\u7684\u5b57\u8282\u6570, \u8be5\u503c\u4e3a\u7d22\u5f15\u5b57\u6bb5\u6700\u5927\u53ef\u80fd\u957f\u5ea6,\u5e76\u975e\u5b9e\u9645\u4f7f\u7528\u957f\u5ea6,\u5728\u4e0d\u635f\u5931\u7cbe\u786e\u6027\u7684\u524d\u63d0\u4e0b,\u957f\u5ea6\u8d8a\u77ed\u8d8a\u597d.\n</code></pre>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#explain-rows","title":"explain \u4e4brows","text":"<p>\u626b\u63cf\u884c\u7684\u6570\u91cf</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#explain-extra","title":"explain \u4e4bextra","text":"<p>\u5176\u4ed6\u7684\u989d\u5916\u7684\u6267\u884c\u8ba1\u5212\u4fe1\u606f,\u5728\u8be5\u5217\u663e\u793a.</p> extra \u542b\u4e49 using filesort \u8bf4\u660emysql\u4f1a\u5bf9\u6570\u636e\u4f7f\u7528\u4e00\u4e2a\u5916\u90e8\u7684\u7d22\u5f15\u6392\u5e8f,\u800c\u4e0d\u662f\u6309\u7167\u8868\u5185\u7684\u7d22\u5f15\u987a\u5e8f\u8fdb\u884c\u8bfb\u53d6,\u79f0\u4e3a\"\u6587\u4ef6\u6392\u5e8f\",\u6548\u7387\u4f4e. using temporary \u4f7f\u7528\u4e86\u4e34\u65f6\u8868\u4fdd\u5b58\u4e2d\u95f4\u7ed3\u679c,MySQL\u5728\u5bf9\u67e5\u8be2\u7ed3\u679c\u6392\u5e8f\u65f6\u4f7f\u7528\u4e34\u65f6\u8868. \u5e38\u89c1\u4e8eorder by \u548c group by, \u6548\u7387\u4f4e. using index \u8868\u793a\u76f8\u5e94\u7684select\u64cd\u4f5c\u4f7f\u7528\u4e86\u8986\u76d6\u7d22\u5f15,\u907f\u514d\u8bbf\u95ee\u8868\u7684\u6570\u636e\u884c,\u6548\u7387\u4e0d\u9519. <p>6). \u5c3d\u91cf\u4f7f\u7528\u8986\u76d6\u7d22\u5f15,\u907f\u514dselect *</p> <p>\u5c3d\u91cf\u4f7f\u7528\u8986\u76d6\u7d22\u5f15(\u53ea\u8bbf\u95ee\u7d22\u5f15\u7684\u67e5\u8be2(\u7d22\u5f15\u5217 \u5b8c\u5168\u5305\u542b \u67e5\u8be2\u5217)),\u51cf\u5c11<code>select *</code>.</p> <p>\u5982\u679c\u67e5\u8be2\u7c7b,\u8d85\u51fa\u7d22\u5f15\u5217,\u4e5f\u4f1a\u964d\u4f4e\u6027\u80fd.</p> <pre><code>TIP:\n using index: \u4f7f\u7528\u8986\u76d6\u7d22\u5f15\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\n using where: \u5728\u67e5\u627e\u4f7f\u7528\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b, \u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e\n using index condition: \u67e5\u627e\u4f7f\u7528\u4e86\u7d22\u5f15, \u4f46\u662f\u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e\n using index; using where: \u67e5\u627e\u4f7f\u7528\u4e86\u7d22\u5f15, \u4f46\u662f\u9700\u8981\u7684\u6570\u636e\u90fd\u5728\u7d22\u5f15\u5217\u4e2d\u80fd\u627e\u5230, \u6240\u4ee5\u4e0d\u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e\n</code></pre> <p>12) \u5355\u5217\u7d22\u5f15\u548c\u590d\u5408\u7d22\u5f15</p> <p>\u5c3d\u91cf\u4f7f\u7528\u590d\u5408\u7d22\u5f15, \u800c\u5c11\u4f7f\u7528\u5355\u5217\u7d22\u5f15</p> <ul> <li>\u521b\u5efa\u590d\u5408\u7d22\u5f15</li> </ul> <pre><code>create index idx_name_sta_address on tb_seller(name, status, address);\n\u5c31\u76f8\u5f53\u4e8e\u521b\u5efa\u4e86\u4e09\u4e2a\u7d22\u5f15:\n\nname\nname + status\nname + status + address\n</code></pre> <ul> <li>\u521b\u5efa\u5355\u5217\u7d22\u5f15</li> </ul> <pre><code>create index idx_seller_name on tb_sell(name);\ncreate index idx_seller_status on tb_sell(status);\ncreate index idx_seller_address on tb_sell(address);\n</code></pre> <p>\u6570\u636e\u5e93\u4f1a\u9009\u62e9\u4e00\u4e2a\u6700\u4f18\u7684\u7d22\u5f15(\u8fa8\u8bc6\u5ea6\u6700\u9ad8\u7d22\u5f15)\u6765\u4f7f\u7528,\u5e76\u4e0d\u4f1a\u4f7f\u7528\u5168\u90e8\u7d22\u5f15.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_1","title":"\u67e5\u770b\u7d22\u5f15\u7d22\u5f15\u60c5\u51b5","text":"<pre><code>show status like 'Handler_read%';\nshow global status like 'Handler_read%';\n</code></pre> <pre><code>02:06:55 root@localhost[database1]&gt; show status like 'Handler_read%';\n\n+-----------------------+-------+\n| Variable_name         | Value |\n+-----------------------+-------+\n| Handler_read_first    | 0     |\n| Handler_read_key      | 0     |\n| Handler_read_last     | 0     |\n| Handler_read_next     | 0     |\n| Handler_read_prev     | 0     |\n| Handler_read_rnd      | 0     |\n| Handler_read_rnd_next | 34    |\n+-----------------------+-------+\n7 rows in set (0.01 sec)\n\n05:08:03 root@localhost[database1]&gt; show global status like 'Handler_read%';\n+-----------------------+--------------+\n| Variable_name         | Value        |\n+-----------------------+--------------+\n| Handler_read_first    | 622670       |\n| Handler_read_key      | 254215292    |\n| Handler_read_last     | 29           |\n| Handler_read_next     | 273266451    |\n| Handler_read_prev     | 97           |\n| Handler_read_rnd      | 10101645     |\n| Handler_read_rnd_next | 166307007667 |\n+-----------------------+--------------+\n7 rows in set (0.00 sec)\n\n05:08:11 root@localhost[database1]&gt;\n</code></pre> <pre><code>- Handler_read_first: \u7d22\u5f15\u4e2d\u7b2c\u4e00\u6761\u88ab\u8bfb\u7684\u6b21\u6570.\u5982\u679c\u9ad8,\u8868\u793a\u670d\u52a1\u5668\u6b63\u6267\u884c\u5927\u91cf\u5168\u7d22\u5f15\u626b\u63cf(\u8fd9\u4e2a\u503c\u8d8a\u4f4e\u8d8a\u597d).\n\n- Handler_read_key: \u5982\u679c\u7d22\u5f15\u6b63\u5728\u5de5\u4f5c,\u8fd9\u4e2a\u503c\u4ee3\u8868\u4e00\u4e2a\u884c\u88ab\u7d22\u5f15\u503c\u8bfb\u7684\u6b21\u6570,\u5982\u679c\u503c\u8d8a\u4f4e,\u8868\u793a\u7d22\u5f15\u5f97\u5230\u7684\u6027\u80fd\u6539\u5584\u4e0d\u9ad8,\u56e0\u4e3a\u7d22\u5f15\u4e0d\u7ecf\u5e38\u4f7f\u7528(\u8fd9\u4e2a\u503c\u8d8a\u9ad8\u8d8a\u597d).\n\n- Handler_read_rnd: \u6839\u636e\u56fa\u5b9a\u4f4d\u7f6e\u8bfb\u4e00\u884c\u7684\u8bf7\u6c42\u503c. \u5982\u679c\u4f60\u6b63\u6267\u884c\u5927\u91cf\u67e5\u8be2\u5e76\u9700\u8981\u5bf9\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f,\u8be5\u503c\u5e94\u8be5\u8f83\u9ad8. \u4f60\u53ef\u80fd\u4f7f\u7528\u4e86\u5927\u91cf\u9700\u8981MySQL\u626b\u63cf\u8fd9\u4e2a\u8868\u7684\u67e5\u8be2\u6216\u4f60\u7684\u8fde\u63a5\u6ca1\u6709\u6b63\u786e\u4f7f\u7528\u952e.\u8fd9\u4e2a\u503c\u8f83\u9ad8,\u610f\u5473\u7740\u8fd0\u884c\u6548\u7387\u4f4e,\u53ef\u4ee5\u5efa\u7acb\u7d22\u5f15\u6765\u8865\u6551.\n\n- Handler_read_rnd_next: \u5728\u6570\u636e\u6587\u4ef6\u4e2d\u8bfb\u4e0b\u4e00\u884c\u7684\u8bf7\u6c42\u6570.\u5982\u679c\u4f60\u6b63\u5728\u8fdb\u884c\u5927\u91cf\u7684\u8868\u626b\u63cf,\u8be5\u503c\u8f83\u9ad8.\u901a\u5e38\u8bf4\u660e\u4f60\u7684\u8868\u7684\u7d22\u5f15\u4e0d\u6b63\u786e\u6216\u5199\u5165\u7684\u67e5\u8be2\u6ca1\u6709\u5229\u7528\u7d22\u5f15.\n</code></pre>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#sql","title":"SQL\u4f18\u5316","text":"<ol> <li> <p>\u4f7f\u7528load\u547d\u4ee4\u5bfc\u5165\u6570\u636e\u7684\u65f6\u5019,\u9002\u5f53\u7684\u8bbe\u7f6e\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387.</p> <ul> <li> <p>\u5bf9\u4e8eInnoDB\u7c7b\u578b\u7684\u8868,\u6709\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387:</p> <ul> <li> <p>\u4e3b\u952e\u987a\u5e8f\u63d2\u5165</p> <ul> <li>\u56e0\u4e3aInnoDB\u7c7b\u578b\u7684\u8868\u793a\u6309\u7167\u4e3b\u952e\u7684\u987a\u5e8f\u4fdd\u5b58\u7684,\u6240\u4ee5\u5c06\u5bfc\u5165\u7684\u6570\u636e\u6309\u7167\u4e3b\u952e\u7684\u987a\u5e8f\u6392\u5217,\u53ef\u4ee5\u6709\u6548\u7684\u63d0\u9ad8\u5bfc\u5165\u6570\u636e\u7684\u6548\u7387. \u5982\u679cInnoDB\u8868\u6ca1\u6709\u4e3b\u952e,\u90a3\u4e48\u7cfb\u7edf\u4f1a\u81ea\u52a8\u9ed8\u8ba4\u521b\u5efa\u4e00\u4e2a\u5185\u90e8\u5217\u4f5c\u4e3a\u4e3b\u952e,\u6240\u4ee5\u5982\u679c\u53ef\u4ee5\u7ed9\u8868\u521b\u5efa\u4e00\u4e2a\u4e3b\u952e,\u5c06\u53ef\u4ee5\u5229\u7528\u8fd9\u70b9,\u6765\u63d0\u9ad8\u5bfc\u5165\u6570\u636e\u7684\u6548\u7387.</li> <li>\u63d2\u5165ID\u987a\u5e8f\u6392\u5217\u6570\u636e</li> <li>\u63d2\u5165ID\u65e0\u5e8f\u6392\u5217\u6570\u636e</li> </ul> </li> <li> <p>\u5173\u95ed\u552f\u4e00\u6027\u6821\u9a8c</p> <ol> <li>\u5728\u5bfc\u5165\u6570\u636e\u524d\u6267\u884c <code>SET UNIQUE_CHECKS = 0</code>, \u5173\u95ed\u552f\u4e00\u6027\u6821\u9a8c, \u5728\u5bfc\u5165\u7ed3\u675f\u540e\u6267\u884c <code>SET UNIQUE_CHECKS = 1</code>, \u6062\u590d\u552f\u4e00\u6027\u6821\u9a8c, \u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387.</li> </ol> </li> <li> <p>\u624b\u52a8\u63d0\u4ea4\u4e8b\u52a1</p> <ol> <li>\u5982\u679c\u5e94\u7528\u4f7f\u7528\u81ea\u52a8\u63d0\u4ea4\u7684\u65b9\u5f0f,\u5efa\u8bae\u5728\u5bfc\u5165\u524d\u6267\u884c <code>SET AUTOCOMMIT=0</code>, \u5173\u95ed\u81ea\u52a8\u63d0\u4ea4, \u5bfc\u5165\u7ed3\u675f\u540e\u518d\u6267\u884c <code>SET AUTOCOMMIT=1</code>, \u6253\u5f00\u81ea\u52a8\u63d0\u4ea4, \u4e5f\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387.</li> </ol> </li> </ul> </li> </ul> </li> <li> </li> <li> <p>\u5f53\u8fdb\u884c\u6570\u636e\u7684insert\u64cd\u4f5c\u7684\u65f6\u5019,\u53ef\u4ee5\u8003\u8651\u91c7\u7528\u4ee5\u4e0b\u51e0\u79cd\u4f18\u5316\u65b9\u6848</p> <ul> <li> <p>\u5982\u679c\u9700\u8981\u540c\u65f6\u5bf9\u4e00\u5f20\u8868\u63d2\u5165\u5f88\u591a\u884c\u6570\u636e\u65f6,\u5e94\u8be5\u5c3d\u91cf\u4f7f\u7528\u591a\u4e2a\u503c\u8868\u7684insert\u8bed\u53e5,\u8fd9\u79cd\u65b9\u5f0f\u5c06\u5927\u5927\u7684\u7f29\u51cf\u5ba2\u6237\u7aef\u4e0e\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u8fde\u63a5,\u5173\u95ed\u793a\u4f8b,\u539f\u59cb\u65b9\u5f0f\u4e3a:</p> <ul> <li> <p>\u4f18\u5316\u540e\u7684\u65b9\u6848\u524d:     insert into tb_test values(1,'Tom');     insert into tb_test values(2,'Cat');     insert into tb_test values(3,'Jerry');</p> </li> <li> <p>\u4f18\u5316\u540e\u7684\u65b9\u6848\u4e3a:     insert into tb_test values(1,'Tom'),(2,'Cat'),(3,'Jerry');</p> </li> </ul> </li> <li> <p>\u5728\u4e8b\u52a1\u4e2d\u8fdb\u884c\u6570\u636e\u63d2\u5165       start transaction;       insert into tb_test values(1,'Tom');       insert into tb_test values(2,'Cat');       insert into tb_test values(3,'Jerry');       commit;</p> </li> <li> <p>\u6570\u636e\u6709\u5e8f\u63d2\u5165       insert into tb_test values(1,'Tom');       insert into tb_test values(2,'Cat');       insert into tb_test values(3,'Jerry');       insert into tb_test values(4,'Tim');       insert into tb_test values(5,'Rose');</p> </li> </ul> </li> <li> </li> </ol> <p>\u4e24\u79cd\u6392\u5e8f\u65b9\u5f0f</p> <ol> <li>\u7b2c\u4e00\u79cd\u662f\u901a\u8fc7\u5bf9\u8fd4\u56de\u6570\u636e\u8fdb\u884c\u6392\u5e8f,\u4e5f\u5c31\u662f\u901a\u5e38\u8bf4\u7684 filesort \u6392\u5e8f, \u6240\u6709\u4e0d\u662f\u901a\u8fc7\u7d22\u5f15\u76f4\u63a5\u8fd4\u56de\u6392\u5e8f\u7ed3\u679c\u7684\u6392\u5e8f\u90fd\u53ebFilesort\u6392\u5e8f.</li> <li>\u7b2c\u4e8c\u79cd\u901a\u8fc7\u6709\u5e8f\u7d22\u5f15\u987a\u5e8f\u626b\u63cf\u76f4\u63a5\u8fd4\u56de\u6709\u5e8f\u6570\u636e,\u8fd9\u79cd\u60c5\u51b5\u5373\u4e3a<code>using index</code>, \u4e0d\u9700\u8981\u989d\u5916\u6392\u5e8f,\u64cd\u4f5c\u6548\u7387\u9ad8.</li> </ol> <p>\u4e86\u89e3\u4e86MySQL\u7684\u6392\u5e8f\u65b9\u5f0f,\u4f18\u5316\u76ee\u6807\u5c31\u6e05\u6670\u4e86: </p> <ul> <li>\u5c3d\u91cf\u51cf\u5c11\u989d\u5916\u7684\u6392\u5e8f,\u901a\u8fc7\u7d22\u5f15\u76f4\u63a5\u8fd4\u56de\u6709\u5e8f\u6570\u636e.</li> <li> <p><code>where</code>\u6761\u4ef6\u548c<code>order by</code> \u4f7f\u7528\u76f8\u540c\u7684\u7d22\u5f15,\u5e76\u4e14<code>Order by</code> \u7684\u987a\u5e8f\u548c<code>\u7d22\u5f15\u987a\u5e8f</code>\u76f8\u540c, \u5e76\u4e14<code>order by</code> \u7684\u5b57\u6bb5\u90fd\u662f\u5347\u5e8f,\u6216\u8005\u90fd\u662f\u964d\u5e8f. \u5426\u5219\u80af\u5b9a\u9700\u8981\u989d\u5916\u7684\u64cd\u4f5c, \u8fd9\u6837\u5c31\u4f1a\u51fa\u73b0FileSort.</p> </li> <li> </li> </ul> <p>\u901a\u8fc7\u521b\u5efa\u5408\u9002\u7684\u7d22\u5f15,\u80fd\u591f\u51cf\u5c11filesort\u7684\u51fa\u73b0,\u4f46\u662f\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b,\u6761\u4ef6\u9650\u5236\u4e0d\u80fd\u8ba9Filesort\u6d88\u5931,\u90a3\u5c31\u9700\u8981\u52a0\u5febFilesort\u7684\u6392\u5e8f\u64cd\u4f5c.\u5bf9\u4e8eFileSort, MySQL\u6709\u4e24\u79cd\u6392\u5e8f\u7b97\u6cd5:</p> <ul> <li>\u4e24\u6b21\u626b\u63cf\u7b97\u6cd5: MySQL4.1 \u4e4b\u524d, \u4f7f\u7528\u8be5\u65b9\u5f0f\u6392\u5e8f. \u9996\u5148\u6839\u636e\u6761\u4ef6\u53d6\u51fa\u6392\u5e8f\u5b57\u6bb5\u548c\u884c\u6307\u9488\u4fe1\u606f,\u7136\u540e\u5728\u6392\u5e8f\u533a sort buffer \u4e2d\u6392\u5e8f, \u5982\u679csort buffer \u4e0d\u591f,\u5219\u5728\u4e34\u65f6\u8868temporary table \u4e2d\u5b58\u50a8\u6392\u5e8f\u7ed3\u679c. \u5b8c\u6210\u6392\u5e8f\u540e, \u518d\u6839\u636e\u884c\u6307\u9488\u56de\u8868\u8bfb\u53d6\u8bb0\u5f55, \u8be5\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u91cf\u968f\u673aIO\u64cd\u4f5c.</li> <li>\u4e00\u6b21\u626b\u63cf\u7b97\u6cd5: \u4e00\u6b21\u6027\u53d6\u51fa\u6ee1\u8db3\u6761\u4ef6\u7684\u7d22\u5f15\u5b57\u6bb5,\u7136\u540e\u5728\u6392\u5e8f\u533asort buffer \u4e2d\u6392\u5e8f\u540e\u76f4\u63a5\u8f93\u51fa\u7ed3\u679c\u96c6. \u6392\u5e8f\u65f6\u5185\u5b58\u5f00\u9500\u8f83\u5927, \u4f46\u662f\u6392\u5e8f\u6548\u7387\u6bd4\u4e24\u6b21\u626b\u63cf\u7b97\u6cd5\u8981\u9ad8.</li> </ul> <p>MySQL\u901a\u8fc7\u6bd4\u8f83\u7cfb\u7edf\u53d8\u91cf <code>max_length_for_sort_data</code>\u7684\u5927\u5c0f\u548cQuery\u8bed\u53e5\u53d6\u51fa\u7684\u5b57\u6bb5\u603b\u5927\u5c0f,\u6765\u5224\u65ad\u662f\u5426\u90a3\u79cd\u6392\u5e8f\u7b97\u6cd5,\u5982\u679c<code>max_length_for_sort_data</code> \u66f4\u5927,\u90a3\u4e48\u4f7f\u7528\u7b2c\u4e8c\u79cd\u4f18\u5316\u4e4b\u540e\u7684\u7b97\u6cd5,\u5426\u5219\u4f7f\u7528\u7b2c\u4e00\u79cd.</p> <p>\u53ef\u4ee5\u9002\u5f53\u63d0\u9ad8<code>sort_buffer_size</code>\u548c<code>max_length_for_sort_date</code>\u7cfb\u7edf\u53d8\u91cf,\u6765\u589e\u5927\u6392\u5e8f\u533a\u7684\u5927\u5c0f,\u63d0\u9ad8\u6392\u5e8f\u7684\u6548\u7387.</p> <ol> <li> </li> </ol> <p>\u7531\u4e8egroup by \u5b9e\u9645\u4e0a\u4e5f\u540c\u6837\u4f1a\u8fdb\u884c\u6392\u5e8f\u64cd\u4f5c, \u800c\u4e14\u4e8eorder by \u76f8\u6bd4,group by \u53ea\u8981\u53ea\u662f\u591a\u4e86\u6392\u5e8f\u4e4b\u540e\u7684\u5206\u7ec4\u64cd\u4f5c. \u5f53\u7136,\u5982\u679c\u5728\u5206\u7ec4\u7684\u65f6\u5019\u8fd8\u4f7f\u7528\u4e86\u5176\u4ed6\u7684\u4e00\u4e9b\u805a\u5408\u51fd\u6570, \u90a3\u4e48\u8fd8\u9700\u8981\u4e00\u4e9b\u805a\u5408\u51fd\u6570\u7684\u8ba1\u7b97.\u6240\u4ee5,\u5728group by \u7684\u5b9e\u73b0\u8fc7\u7a0b\u4e2d,\u4e8eorder by\u4e00\u6837\u4e5f\u53ef\u4ee5\u5229\u7528\u5230\u7d22\u5f15. </p> <p>\u5982\u679c\u67e5\u8be2\u5305\u542bgroup by \u4f46\u662f\u7528\u6237\u60f3\u8981\u907f\u514d\u6392\u5e8f\u7ed3\u679c\u7684\u6d88\u8017,\u5219\u53ef\u4ee5\u6267\u884c<code>order by null</code> \u7981\u6b62\u6392\u5e8f. \u5982\u4e0b:</p> <p><code>explain select age, count(*) from emp group by age;</code></p> <p>\u4f18\u5316\u540e</p> <p><code>explain select age,count(*) from emp group by age order by null;</code></p> <ol> <li> </li> </ol> <p>MySQL4.1 \u7248\u672c\u4e4b\u540e,\u5f00\u59cb\u652f\u6301SQL\u7684\u5b50\u67e5\u8be2.\u8fd9\u4e2a\u6280\u672f\u53ef\u4ee5\u4f7f\u7528select\u8bed\u53e5\u6765\u521b\u5efa\u4e00\u4e2a\u5355\u5217\u7684\u67e5\u8be2,\u7136\u540e\u628a\u8fd9\u4e2a\u7ed3\u679c\u4f5c\u4e3a\u8fc7\u6ee4\u6761\u4ef6\u7528\u5728\u53e6\u4e00\u4e2a\u67e5\u8be2\u4e2d. \u4f7f\u7528\u5b50\u67e5\u8be2\u53ef\u4ee5\u4e00\u6b21\u6027\u7684\u5b8c\u6210\u5f88\u591a\u903b\u8f91\u4e0a\u9700\u8981\u591a\u4e2a\u6b65\u9aa4\u624d\u80fd\u5b8c\u6210\u7684SQL\u64cd\u4f5c, \u540c\u65f6\u4e5f\u53ef\u4ee5\u907f\u514d\u4e8b\u52a1\u6216\u8868\u9501\u6b7b, \u5e76\u4e14\u5199\u8d77\u6765\u4e5f\u5f88\u5bb9\u6613. \u4f46\u662f,\u6709\u4e9b\u60c5\u51b5\u4e0b,\u5b50\u67e5\u8be2\u662f\u53ef\u4ee5\u88ab\u8ddf\u9ad8\u6548\u7684\u8fde\u63a5(JOIN)\u4ee3\u66ff.</p> <ol> <li> </li> </ol> <p>\u5bf9\u4e8e\u5305\u542bOR\u67e5\u8be2\u5b50\u53e5,\u5982\u679c\u8981\u5229\u7528\u7d22\u5f15,\u5219OR\u4e4b\u95f4\u7684\u6bcf\u4e2a\u6761\u4ef6\u5217\u90fd\u5fc5\u987b\u7528\u5230\u7d22\u5f15, \u800c\u4e14\u4e0d\u80fd\u4f7f\u7528\u5230\u590d\u5408\u7d22\u5f15; \u5982\u679c\u6ca1\u6709\u7d22\u5f15,\u5219\u5e94\u8be5\u8003\u8651\u589e\u52a0\u7d22\u5f15.</p> <p>\u5efa\u8bae\u4f7f\u7528union\u66ff\u6362or.</p> <p>type\u663e\u793a\u7684\u662f\u8bbf\u95ee\u7c7b\u578b,\u662f\u8f83\u4e3a\u91cd\u8981\u7684\u4e00\u4e2a\u6307\u6807,\u7ed3\u679c\u503c\u4ece\u597d\u5230\u574f\u4f9d\u6b21\u662f:</p> <p><code>system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merger &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL</code></p> <p>UNION \u8bed\u53e5\u7684type\u503c\u4e3aref, OR\u8bed\u53e5\u7684type\u503c\u4e3arange, \u53ef\u4ee5\u770b\u5230\u8fd9\u662f\u4e00\u4e2a\u5f88\u660e\u663e\u7684\u5dee\u8ddd</p> <p>UNION \u8bed\u53e5\u7684ref\u503c\u4e3aconst, OR\u8bed\u53e5\u7684type\u503c\u4e3anull, const\u8868\u793a\u662f\u5e38\u91cf\u503c\u5f15\u7528,\u975e\u5e38\u5feb</p> <p>\u8fd9\u4e24\u9879\u7684\u5dee\u8ddd\u5c31\u8bf4\u660e\u4e86UNION\u8981\u4f18\u4e8eOR.</p> <ol> <li> </li> </ol> <p>\u4e00\u822c\u5206\u9875\u67e5\u8be2\u65f6,\u901a\u8fc7\u521b\u5efa\u8986\u76d6\u7d22\u5f15\u80fd\u591f\u6bd4\u8f83\u597d\u7684\u63d0\u9ad8\u6027\u80fd. \u4e00\u4e2a\u5e38\u89c1\u53c8\u975e\u5e38\u5934\u75bc\u7684\u95ee\u9898\u5c31\u662f limit 2000000, 10 , \u6b64\u65f6\u9700\u8981MySQL\u6392\u5e8f\u524d 2000010 \u8bb0\u5f55, \u4ec5\u4ec5\u8fd4\u56de2000000 - 2000010 \u7684\u8bb0\u5f55, \u5176\u4ed6\u8bb0\u5f55\u4e22\u5f03, \u67e5\u8be2\u6392\u5e8f\u7684\u4ee3\u4ef7\u975e\u5e38\u5927.</p> <ol> <li> <p>\u4f18\u5316\u601d\u8def\u4e00</p> <p>\u5728\u7d22\u5f15\u4e0a\u5b8c\u6210\u6392\u5e8f\u5206\u9875\u64cd\u4f5c, \u6700\u540e\u6839\u636e\u4e3b\u952e\u5173\u8054\u56de\u539f\u8868\u67e5\u8be2\u6240\u9700\u8981\u7684\u5176\u4ed6\u5217\u5185\u5bb9.</p> </li> <li> <p>\u4f18\u5316\u601d\u8def\u4e8c</p> <p>\u8be5\u65b9\u6848\u9002\u5e94\u4e8e\u4e3b\u952e\u81ea\u589e\u7684\u8868,\u53ef\u4ee5\u628aLimit\u67e5\u8be2\u8f6c\u6362\u6210\u67d0\u4e2a\u4f4d\u7f6e\u7684\u67e5\u8be2.</p> </li> <li></li> <li> <p>\u9002\u5e94SQL\u63d0\u793a</p> </li> </ol> <p>SQL\u63d0\u793a, \u662f\u4f18\u5316\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u91cd\u8981\u5b57\u6bb5, \u7b80\u5355\u6765\u8bf4, \u5c31\u662f\u5728SQL\u8bed\u53e5\u4e2d\u52a0\u5165\u4e00\u4e9b\u4eba\u4e3a\u7684\u63d0\u793a\u6765\u8fbe\u5230\u4f18\u5316\u64cd\u4f5c\u7684\u76ee\u7684.</p> <ol> <li> <p>USE INDEX</p> <p>\u5728\u67e5\u8be2\u8bed\u53e5\u4e2d\u8868\u540d\u7684\u540e\u9762,\u6dfb\u52a0 use index \u6765\u63d0\u4f9b\u5e0c\u671bMySQL\u53bb\u53c2\u8003\u7684\u7d22\u5f15\u5217\u8868,\u5c31\u53ef\u4ee5\u8ba9MySQL\u4e0d\u518d\u8003\u8651\u5176\u4ed6\u53ef\u7528\u7684\u7d22\u5f15.</p> <p><code>create index idx_serller_name on tb_sellwe(name);</code></p> </li> <li> <p>IGNORE INDEX</p> <p>\u5982\u679c\u7528\u6237\u53ea\u662f\u5355\u7eaf\u7684\u60f3\u8ba9MySQL\u5ffd\u7565\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u7d22\u5f15, \u5219\u53ef\u4ee5\u4f7f\u7528 ignore index \u4f5c\u4e3a hint.</p> <p><code>explain select * from tb_seller ignore index(idx_seller_name) where name = 'xxx';</code></p> </li> <li> <p>FORCE INDEX</p> <p>\u4e3a\u5f3a\u5236MySQL\u4f7f\u7528\u4e00\u4e2a\u7279\u5b9a\u7684\u7d22\u5f15, \u53ef\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528 force index \u4f5c\u4e3ahint.</p> <p><code>explain select * from tb_seller force index(idx_seller_address) wher address = 'xxx';</code></p> </li> </ol>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_2","title":"\u5927\u6279\u91cf\u63d2\u5165","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#insert","title":"\u4f18\u5316insert\u8bed\u53e5","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#order-by","title":"\u4f18\u5316order by\u8bed\u53e5","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#filesort","title":"Filesort\u7684\u4f18\u5316","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#group-by","title":"\u4f18\u5316group by\u8bed\u53e5","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_3","title":"\u4f18\u5316\u5d4c\u5957\u67e5\u8be2","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#or","title":"\u4f18\u5316OR\u6761\u4ef6","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_4","title":"\u4f18\u5316\u5206\u9875\u67e5\u8be2","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_5","title":"\u67e5\u8be2\u7f13\u5b58\u914d\u7f6e","text":"<pre><code>mysql&gt; show status like 'Qcache%';\n+-------------------------+------------+\n| Variable_name           | Value      |\n+-------------------------+------------+\n| Qcache_free_blocks      | 23822      | &lt;- \u53ef\u7528\u7684\u5185\u5b58\u7684\u5757\u7684\u4e2a\u6570\n| Qcache_free_memory      | 70259792   | &lt;- \u53ef\u7528\u7684\u5185\u5b58\u7684\u7a7a\u95f4,\u5bb9\u91cf\n| Qcache_hits             | 1594706026 | &lt;- \u67e5\u8be2\u7f13\u51b2\u7684\u547d\u4e2d\u6b21\u6570\n| Qcache_inserts          | 678651145  | &lt;- \u6dfb\u52a0\u5230\u67e5\u8be2\u7f13\u51b2\u7684\u6b21\u6570\n| Qcache_lowmem_prunes    | 237160055  | &lt;- \u5982\u679c\u5185\u5b58\u4e0d\u8db3,\u5c06\u6570\u636e\u79fb\u9664\u51fa\u5185\u5b58\u7a7a\u95f4\u7684\u6b21\u6570\n| Qcache_not_cached       | 1344572761 | &lt;- \u672a\u505a\u7f13\u5b58\u7684\u6b21\u6570\n| Qcache_queries_in_cache | 67682      | &lt;- \u67e5\u8be2\u7f13\u5b58\u4e2d\u6ce8\u518c\u7684\u67e5\u8be2\u6570\n| Qcache_total_blocks     | 181973     | &lt;- \u67e5\u8be2\u7f13\u5b58\u4e2d\u7684\u5757\u603b\u6570\n+-------------------------+------------+\n</code></pre> \u53c2\u6570 \u542b\u4e49 Qcache_free_blocks \u67e5\u8be2\u7f13\u5b58\u4e2d\u7684\u53ef\u4ee5\u5185\u5b58\u5757\u6570 Qcache_free_memory \u67e5\u8be2\u7f13\u5b58\u7684\u53ef\u7528\u5185\u5b58\u91cf Qcache_hits \u67e5\u8be2\u7f13\u5b58\u547d\u4e2d\u7387 Qcache_inserts \u6dfb\u52a0\u5230\u67e5\u8be2\u7f13\u5b58\u7684\u67e5\u8be2\u6570 Qcache_lowmem_prunes \u7531\u4e8e\u5185\u5b58\u4e0d\u8db3\u800c\u4ece\u67e5\u8be2\u7f13\u5b58\u4e2d\u5220\u9664\u7684\u67e5\u8be2\u6570 Qcache_not_cached \u975e\u7f13\u5b58\u67e5\u8be2\u7684\u6570\u91cf(\u7531\u4e8equery_cache_type\u8bbe\u7f6e\u800c\u65e0\u6cd5\u7f13\u5b58\u6216\u672a\u7f13\u5b58) Qcache_queries_in_cache \u67e5\u8be2\u7f13\u5b58\u4e2d\u6ce8\u518c\u7684\u67e5\u8be2\u6570 Qcache_total_blocks \u67e5\u8be2\u7f13\u5b58\u4e2d\u7684\u5757\u603b\u6570"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_6","title":"\u5f00\u542f\u67e5\u8be2\u7f13\u5b58","text":"<p>MySQL\u7684\u67e5\u8be2\u7f13\u5b58\u9ed8\u8ba4\u662f\u5173\u95ed\u7684, \u9700\u8981\u624b\u52a8\u914d\u7f6e\u53c2\u6570 <code>query_cache_type</code>,\u6765\u5f00\u542f\u67e5\u8be2\u7f13\u5b58. <code>query_cache_type</code>\u8be5\u53c2\u6570\u7684\u53ef\u53d6\u503c\u6709\u4e09\u4e2a</p> \u503c \u542b\u4e49 OFF \u6216 0 \u67e5\u8be2\u7f13\u5b58\u529f\u80fd\u5173\u95ed ON \u6216 1 \u67e5\u8be2\u7f13\u5b58\u529f\u80fd\u6253\u5f00, SELECT \u7684\u7ed3\u679c\u7b26\u5408\u7f13\u5b58\u6761\u4ef6\u5373\u4f1a\u7f13\u5b58,\u5426\u5219,\u4e0d\u4e88\u7f13\u5b58, \u663e\u793a\u6307\u5b9aSQL_NO_CACHE, \u4e0d\u4e88\u7f13\u5b58 DEMAND \u6216 2 \u67e5\u8be2\u7f13\u5b58\u529f\u80fd\u6309\u9700\u8fdb\u884c, \u663e\u793a\u6307\u5b9aSQL_CACHE\u7684SELECT\u8bed\u53e5\u624d\u4f1a\u7f13\u5b58; \u5176\u4ed6\u5747\u4e0d\u4e88\u7f13\u5b58"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_7","title":"\u67e5\u8be2\u7f13\u5b58\u5931\u6548\u7684\u60c5\u51b5","text":"<p>1) SQL\u8bed\u53e5\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5,\u60f3\u8981\u547d\u4e2d\u67e5\u8be2\u7f13\u5b58,\u67e5\u8be2\u7684SQL\u8bed\u53e5\u5fc5\u987b\u4e00\u81f4.</p> <p>2) \u5f53\u67e5\u8be2\u8bed\u53e5\u4e2d\u6709\u4e00\u4e9b\u4e0d\u786e\u5b9a\u7684\u65f6,\u5219\u4e0d\u4f1a\u7f13\u5b58. \u5982: now(), current_date(),curdate(),curtime(),rand(),uuid(),user(),databases().</p> <p>3) \u4e0d\u4f7f\u7528\u4efb\u4f55\u8868\u67e5\u8be2\u8bed\u53e5</p> <p>4) \u67e5\u8be2 mysql, information_schema,\u6216performance_schema \u6570\u636e\u5e93\u4e2d\u7684\u8868\u65f6,\u4e0d\u4f1a\u8d70\u67e5\u8be2\u7f13\u5b58.</p> <p>5) \u5728\u5b58\u50a8\u7684\u51fd\u6570, \u89e6\u53d1\u5668\u6216\u4e8b\u4ef6\u7684\u4e3b\u4f53\u5185\u6267\u884c\u7684\u67e5\u8be2.</p> <p>6) \u5982\u679c\u8868\u66f4\u6539,\u5219\u4f7f\u7528\u8be5\u8868\u7684\u6240\u6709\u9ad8\u901f\u7f13\u5b58\u67e5\u8be2\u90fd\u5c06\u53d8\u4e3a\u65e0\u6548\u5e76\u4ece\u9ad8\u901f\u7f13\u5b58\u4e2d\u5220\u9664. \u8fd9\u5305\u62ec\u4f7f\u7528<code>MERGE</code>\u6620\u5c04\u5230\u5df2\u66f4\u6539\u8868\u7684\u67e5\u8be2.\u4e00\u4e2a\u8868\u53ef\u4ee5\u88ab\u8bb8\u591a\u7c7b\u578b\u7684\u8bed\u53e5, \u5982\u88ab\u6539\u53d8 INSERT, UPDATE, DELETE, TRUNCATE TABLE, ALTER TABLE, DROP TABLE, \u6216 DROP DATABASE.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#mysql","title":"MySQL\u5185\u5b58\u7ba1\u7406\u53ca\u4f18\u5316","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_8","title":"\u5185\u5b58\u4f18\u5316\u539f\u5219","text":"<p>1) \u5c06\u5c3d\u91cf\u591a\u7684\u5185\u5b58\u5206\u914d\u7ed9MySQL\u505a\u7f13\u5b58, \u4f46\u8981\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u548c\u5176\u4ed6\u67e5\u8be2\u9884\u7559\u8db3\u591f\u5185\u5b58.</p> <p>2) MyISAM\u5b58\u50a8\u5f15\u64ce\u7684\u6570\u636e\u6587\u4ef6\u8bfb\u53d6\u4f9d\u8d56\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u81ea\u8eab\u7684<code>IO</code>\u7f13\u5b58,\u56e0\u6b64,\u5982\u679c\u6709MyISAM\u8868, \u5c31\u8981\u9884\u7559\u66f4\u591a\u7684\u5185\u5b58\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u505aIO\u7f13\u5b58.</p> <p>3) \u6392\u5e8f\u533a, \u8fde\u63a5\u533a\u7b49\u7f13\u5b58\u662f\u5206\u914d\u7ed9\u6bcf\u4e2a\u6570\u636e\u5e93\u5bf9\u8bdd(session)\u4e13\u4e1a\u7684,\u5176\u9ed8\u8ba4\u503c\u7684\u8bbe\u7f6e\u8981\u6839\u636e\u6700\u5927\u8fde\u63a5\u6570\u5408\u7406\u5206\u914d, \u5982\u679c\u8bbe\u7f6e\u592a\u5927, \u4e0d\u4f46\u6d6a\u8d39\u8d44\u6e90,\u800c\u4e14\u5728\u5e76\u53d1\u8fde\u63a5\u8f83\u9ad8\u65f6\u4f1a\u5bfc\u81f4\u7269\u7406\u5185\u5b58\u8017\u5c3d.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#myisam","title":"MyISAM \u5185\u5b58\u4f18\u5316","text":"<p>MyISAM\u5b58\u50a8\u5f15\u64ce\u4f7f\u7528 <code>key_buffer</code> \u7f13\u5b58\u7d22\u5f15\u5757, \u52a0\u901fMyISAM\u7d22\u5f15\u7684\u8bfb\u5199\u901f\u5ea6. \u5bf9\u4e8eMyISAM\u8868\u7684\u6570\u636e\u5757, mysql\u6ca1\u6709\u7279\u522b\u7684\u7f13\u5b58\u673a\u5236, \u5b8c\u5168\u4f9d\u8d56\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684IO\u7f13\u5b58.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#key_buffer_size","title":"key_buffer_size","text":"<p><code>key_buffer_size</code> \u51b3\u5b9aMyISAM\u7d22\u5f15\u5757\u7f13\u51b2\u533a\u7684\u5927\u5c0f, \u76f4\u63a5\u5f71\u54cd\u5230MyISAM\u8868\u7684\u8bfb\u53d6\u6548\u7387. \u53ef\u4ee5\u5728MySQL\u53c2\u6570\u6587\u4ef6\u4e2d\u8bbe\u7f6ekey_buffer_size\u7684\u503c, \u5bf9\u4e8e\u4e00\u822cMyISAM\u6570\u636e\u5e93, \u5efa\u8bae\u81f3\u5c11\u5c06 <code>1/4</code> \u53ef\u7528\u5185\u5b58\u5206\u914d\u7ed9key_buffer_size.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#read_buffer_size","title":"read_buffer_size","text":"<p>\u5982\u679c\u9700\u8981\u7ecf\u5e38\u987a\u5e8f\u626b\u63cfmyisam\u8868,\u53ef\u4ee5\u901a\u8fc7\u589e\u5927read_buffer_size\u7684\u503c\u6765\u6539\u5584\u6027\u80fd. \u4f46\u9700\u8981\u6ce8\u610f\u7684\u662fread_buffer_size\u662f\u6bcf\u4e2asession\u72ec\u5360\u7684,\u5982\u679c\u9ed8\u8ba4\u503c\u8bbe\u7f6e\u592a\u5927,\u5c31\u597d\u9020\u6210\u5185\u5b58\u6d6a\u8d39.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#read_rnd_buffer_size","title":"read_rnd_buffer_size","text":"<p>\u5bf9\u4e8e\u9700\u8981\u6392\u5e8f\u7684myisam\u8868\u7684\u67e5\u8be2, \u5982\u5e26\u6709order by \u5b50\u53e5\u7684sql, \u9002\u5f53\u589e\u52a0 read_rnd_buffer_size\u7684\u503c, \u53ef\u4ee5\u6539\u5584\u6b64\u7c7b\u7684sql\u6027\u80fd. \u4f46\u9700\u6ce8\u610f\u7684\u662f, read_rnd_buffer_size\u662f\u6bcf\u4e2asession\u72ec\u5360\u7684, \u5982\u679c\u9ed8\u8ba4\u503c\u8bbe\u7f6e\u592a\u5927,\u5c31\u597d\u9020\u6210\u5185\u5b58\u6d6a\u8d39.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#innodb","title":"InnoDB\u5185\u5b58\u4f18\u5316","text":"<p>innodb\u7528\u4e00\u5757\u5185\u5b58\u533a\u505aIO\u7f13\u5b58, \u8be5\u7f13\u5b58\u6c60\u4e0d\u4ec5\u7528\u6765\u7f13\u5b58innodb\u7684\u7d22\u5f15\u5757, \u800c\u4e14\u4e5f\u7528\u6765\u7f13\u5b58innodb\u7684\u6570\u636e\u5757.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#innodb_buffer_pool_size","title":"innodb_buffer_pool_size","text":"<p>\u8be5\u53d8\u91cf\u51b3\u5b9a\u4e86Innodb\u5b58\u50a8\u5f15\u64ce\u8868\u6570\u636e\u548c\u7d22\u5f15\u6570\u636e\u7684\u6700\u5927\u7f13\u5b58\u533a\u5927\u5c0f. \u5728\u4fdd\u8bc1\u64cd\u4f5c\u7cfb\u7edf\u53ca\u5176\u4ed6\u7a0b\u5e8f\u6709\u8db3\u591f\u5185\u5b58\u53ef\u7528\u7684\u60c5\u51b5\u4e0b,innodb_buffer_pool_size \u7684\u503c\u8d8a\u5927, \u7f13\u5b58\u547d\u4e2d\u7387\u8d8a\u9ad8, \u8bbf\u95eeInnoDB\u8868\u9700\u8981\u7684\u78c1\u76d8IO\u5c31\u8d8a\u5c11, \u6027\u80fd\u4e5f\u5c31\u8d8a\u9ad8.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#innodb_log_buffer_size","title":"innodb_log_buffer_size","text":"<p>\u51b3\u5b9a\u4e86InnoDB\u91cd\u505a\u65e5\u5fd7\u7f13\u5b58\u7684\u5927\u5c0f, \u5bf9\u4e8e\u53ef\u80fd\u4ea7\u751f\u5927\u91cf\u66f4\u65b0\u8bb0\u5f55\u7684\u5927\u4e8b\u52a1, \u589e\u52a0innodb_log_buffer_size\u7684\u5927\u5c0f, \u53ef\u7528\u907f\u514dinnodb\u5728\u4e8b\u52a1\u63d0\u4ea4\u524d\u5c31\u6267\u884c\u4e0d\u5fc5\u8981\u7684\u65e5\u5fd7\u5199\u5165\u78c1\u76d8.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#mysql_1","title":"MySQL\u5e76\u53d1\u53c2\u6570\u8c03\u6574","text":"<p>\u4ece\u5b9e\u73b0\u4e0a\u6765\u8bf4, MySQL Server \u662f\u591a\u7ebf\u7a0b\u7ed3\u679c, \u5305\u62ec\u540e\u53f0\u7ebf\u7a0b\u548c\u5ba2\u6237\u7aef\u7ebf\u7a0b. \u591a\u7ebf\u7a0b\u53ef\u7528\u6709\u6548\u5229\u7528\u670d\u52a1\u5668\u8d44\u6e90,\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u5e76\u53d1\u6027\u80fd.</p> <p>\u5728MySQL\u4e2d, \u63a7\u5236\u5e76\u53d1\u8fde\u63a5\u548c\u7ebf\u7a0b\u7684\u4e3b\u8981\u53c2\u6570\u5305\u62ec max_connections, back_log, thread_cache_size, table_open_cache.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#max_connections","title":"max_connections","text":"<p>\u91c7\u7528max_connections\u63a7\u5236\u5141\u8bb8\u8fde\u63a5\u5230MySQL\u6570\u636e\u5e93\u7684\u6700\u5927\u6570\u91cf, \u9ed8\u8ba4\u662f151. \u5f53\u5ba2\u6237\u7aef\u8fde\u63a5\u670d\u52a1\u7aef\u65f6,\u5f53\u540c\u65f6\u8fde\u63a5\u7684\u8bf7\u6c42\u8d85\u8fc7151\u65f6,\u5c31\u6ca1\u6709\u53ef\u7528\u7684\u8fde\u63a5\u6765\u5904\u7406\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42,\u540e\u9762\u8fdb\u6765\u7684\u8fde\u63a5\u90fd\u4f1a\u8fdb\u5165\u7b49\u5f85\u72b6\u6001.</p> <p><code>connections_errors_max_connections</code>\u4e3a\u5f53\u8fde\u63a5\u8fbe\u5230\u6700\u5927\u8bf7\u6c42\u503c\u65f6,\u8fde\u63a5\u62a5\u9519\u7684\u4fe1\u606f.</p> <p>\u5982\u679c\u72b6\u6001\u53d8\u91cf <code>connections_errors_max_connections</code>\u4e0d\u4e3a\u96f6,\u5e76\u4e14\u4e00\u76f4\u589e\u957f, \u5219\u8bf4\u660e\u4e0d\u65ad\u6709\u8fde\u63a5\u8bf7\u6c42\u56e0\u6570\u636e\u5e93\u8fde\u63a5\u5df2\u8fbe\u5230\u5141\u8bb8\u6700\u5927\u503c\u800c\u5931\u8d25, \u8fd9\u65f6\u53ef\u4ee5\u8003\u8651\u589e\u5927max_connections\u7684\u503c.</p> <p>MySQL\u6700\u5927\u53ef\u652f\u6301\u7684\u8fde\u63a5\u6570, \u53d6\u51b3\u4e8e\u5f88\u591a\u56e0\u7d20,\u5305\u62ec\u7ed9\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u7ebf\u7a0b\u5e93\u7684\u8d28\u91cf,\u5185\u5b58\u5927\u5c0f,\u6bcf\u4e2a\u8fde\u63a5\u7684\u8d1f\u8377,CPU\u7684\u5904\u7406\u901f\u5ea6,\u671f\u671b\u7684\u54cd\u5e94\u65f6\u95f4\u7b49.\u5728Linux\u5e73\u53f0\u4e0b,\u6027\u80fd\u597d\u7684\u670d\u52a1\u5668,\u652f\u6301500-1000\u4e2a\u8fde\u63a5\u4e0d\u662f\u96be\u4e8b,\u9700\u8981\u6839\u636e\u670d\u52a1\u5668\u6027\u80fd\u8fdb\u884c\u8bbe\u5b9a.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#back_log","title":"back_log","text":"<p>back_log\u53c2\u6570\u63a7\u5236MySQL\u76d1\u542cTCP\u7aef\u53e3\u65f6\u8bbe\u7f6e\u7684\u79ef\u538b\u8bf7\u6c42\u6808\u5927\u5c0f. \u5982\u679cMySQL\u7684\u8fde\u63a5\u6570\u8fbe\u5230max_connections\u65f6,\u65b0\u6765\u7684\u8bf7\u6c42\u5c06\u4f1a\u88ab\u5b58\u5728\u5806\u6808\u4e2d,\u4ee5\u7b49\u5f85\u67d0\u4e00\u8fde\u63a5\u91ca\u653e\u8d44\u6e90, \u8be5\u5806\u6808\u7684\u6570\u91cf\u65e2\u662fback_log. \u5982\u679c\u7b49\u5f85\u7684\u8fde\u63a5\u7684\u6570\u91cf\u8d85\u8fc7back_log, \u5c06\u4e0d\u88ab\u6388\u4e88\u8fde\u63a5\u8d44\u6e90,\u5c06\u4f1a\u62a5\u9519.</p> <p>5.5.5\u7248\u672c\u4e4b\u524d\u9ed8\u8ba4\u503c\u4e3a50, \u4e4b\u540e\u7684\u7248\u672c\u9ed8\u8ba4\u4e3a50+(max_connections / 5), \u4f46\u6700\u5927\u4e0d\u8d85\u8fc7900.</p> <p>\u5982\u679c\u9700\u8981\u6570\u636e\u5e93\u5728\u77ed\u7684\u65f6\u95f4\u5185\u5904\u7406\u5927\u91cf\u7684\u8fde\u63a5\u8bf7\u6c42, \u53ef\u4ee5\u8003\u8651\u9002\u5f53\u589e\u5927back_log\u7684\u503c.</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#table_open_cache","title":"table_open_cache","text":"<p>\u8be5\u53c2\u6570\u7528\u6765\u63a7\u5236\u6240\u6709SQL\u8bed\u53e5\u6267\u884c\u7ebf\u7a0b\u53ef\u6253\u5f00\u8868\u7f13\u5b58\u7684\u6570\u91cf, \u800c\u5728\u6267\u884cSQL\u8bed\u53e5\u65f6, \u6bcf\u4e00\u4e2aSQL\u6267\u884c\u7ebf\u7a0b\u81f3\u5c11\u8981\u6253\u5f001\u4e2a\u8868\u7f13\u5b58. \u8be5\u53c2\u6570\u7684\u503c\u5e94\u8be5\u6839\u636e\u8bbe\u7f6e\u7684\u6700\u5927\u8fde\u63a5\u6570max_connections\u4e00\u4e2a\u6bcf\u4e2a\u8fde\u63a5\u6267\u884c\u5173\u8054\u67e5\u8be2\u4e2d\u6d89\u53ca\u7684\u8868\u7684\u6700\u5927\u6570\u91cf\u6765\u8bbe\u5b9a:</p> <p><code>max_connections x N;</code></p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#hread_cache_size","title":"hread_cache_size","text":"<p>\u4e3a\u4e86\u52a0\u5feb\u6570\u636e\u5e93\u7684\u901f\u5ea6\uff0cMySQL\u4f1a\u7f13\u5b58\u4e00\u5b9a\u6570\u91cf\u7684\u5ba2\u6237\u670d\u52a1\u7ebf\u7a0b\u4ee5\u5907\u91cd\u7528\uff0c\u901a\u8fc7\u53c2\u6570 thread_cache_size \u53ef\u63a7\u5236 MySQL \u7f13\u5b58\u5ba2\u6237\u7aef\u670d\u52a1\u7ebf\u7a0b\u7684\u6570\u91cf\u3002</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#innodb_lock_wait_timeout","title":"innodb_lock_wait_timeout","text":"<p>\u8be5\u53c2\u6570\u662f\u7528\u6765\u8bbe\u7f6e InnoDB \u4e8b\u52a1\u7b49\u5f85\u884c\u9501\u7684\u65f6\u95f4\uff0c\u9ed8\u8ba4\u503c\u662f 50 ms\uff0c\u53ef\u4ee5\u6839\u636e\u8fdb\u884c\u52a8\u6001\u8bbe\u7f6e\u3002\u5bf9\u4e8e\u9700\u8981\u5feb\u901f\u53cd\u9988\u7684\u4e1a\u52a1\u7cfb\u7edf\u6765\u8bf4\uff0c\u53ef\u4ee5\u5c06\u884c\u9501\u7684\u7b49\u5f85\u65f6\u95f4\u8c03\u5c0f\uff0c\u4ee5\u907f\u514d\u4e8b\u52a1\u957f\u65f6\u95f4\u6302\u8d77\uff1b\u5bf9\u4e8e\u540e\u53f0\u8fd0\u884c\u7684\u6279\u91cf\u5904\u7406\u7a0b\u5e8f\u6765\u8bf4\uff0c\u53ef\u4ee5\u5c06\u884c\u9501\u7684\u7b49\u5f85\u65f6\u95f4\u8c03\u5927\uff0c\u4ee5\u907f\u514d\u53d1\u751f\u5927\u7684\u56de\u6eda\u64cd\u4f5c\u3002</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#2mysql","title":"2\u3001MySQL \u9501\u95ee\u9898","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#21","title":"2.1\u3001\u9501\u6982\u8ff0","text":"<p>\u9501 \u662f\u8ba1\u7b97\u673a\u534f\u8c03\u591a\u4e2a\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u5e76\u53d1\u8bbf\u95ee\u67d0\u4e00\u8d44\u6e90\u7684\u673a\u5236\uff08\u907f\u514d\u4e89\u62a2\uff09\u3002</p> <p>\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u9664\u4f20\u7edf\u7684\u8ba1\u7b97\u8d44\u6e90\uff08\u5982\uff1aCPU\u3001RAM\u3001I/O \u7b49\uff09\u7684\u4e89\u7528\u4ee5\u5916\uff0c\u6570\u636e\u4e5f\u662f\u4e00\u79cd\u4f9b\u8bb8\u591a\u7528\u6237\u5171\u4eab\u7684\u8d44\u6e90\u3002\u5982\u4f55\u4fdd\u8bc1\u6570\u636e\u5e76\u53d1\u8bbf\u95ee\u7684\u4e00\u81f4\u6027\u3001\u6709\u6548\u6027\u662f\u6240\u6709\u6570\u636e\u5e93\u5fc5\u987b\u89e3\u51b3\u7684\u4e00\u4e2a\u95ee\u9898\uff0c\u9501\u51b2\u7a81\u4e5f\u662f\u5f71\u54cd\u6570\u636e\u5e93\u5e76\u53d1\u8bbf\u95ee\u6027\u80fd\u7684\u4e00\u4e2a\u91cd\u8981\u56e0\u7d20\u3002</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#22","title":"2.2\u3001\u9501\u5206\u7c7b","text":"<p>\u4ece\u5bf9\u6570\u636e\u64cd\u4f5c\u7684\u7c92\u5ea6\u5206\uff1a</p> <ol> <li>\u8868\u9501\uff1a\u64cd\u4f5c\u65f6\uff0c\u4f1a\u9501\u5b9a\u6574\u4e2a\u8868</li> <li>\u884c\u9501\uff1a\u64cd\u4f5c\u65f6\uff0c\u4f1a\u9501\u5b9a\u5f53\u524d\u64cd\u4f5c\u884c</li> </ol> <p>\u4ece\u5bf9\u6570\u636e\u64cd\u4f5c\u7684\u7c7b\u578b\u5206\uff1a</p> <ol> <li>\u8bfb\u9501\uff08\u5171\u4eab\u9501\uff09\uff1a\u9488\u5bf9\u540c\u4e00\u4efd\u6570\u636e\uff0c\u591a\u4e2a\u8bfb\u64cd\u4f5c\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c\u800c\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd</li> <li>\u5199\u9501\uff08\u6392\u5b83\u9501\uff09\uff1a\u5f53\u524d\u64cd\u4f5c\u6ca1\u6709\u5b8c\u6210\u4e4b\u524d\uff0c\u5b83\u4f1a\u963b\u65ad\u5176\u4ed6\u5199\u9501\u548c\u8bfb\u9501</li> </ol>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#23mysql","title":"2.3\u3001MySQL\u9501","text":"<p>\u76f8\u5bf9\u4e8e\u5176\u4ed6\u6570\u636e\u5e93\u800c\u8a00\uff0cMySQL \u7684\u9501\u673a\u5236\u6bd4\u8f83\u7b80\u5355\uff0c\u5176\u6700\u663e\u8457\u7684\u7279\u70b9\u5c31\u662f\u4e0d\u540c\u7684\u5b58\u50a8\u5f15\u64ce\u652f\u6301\u4e0d\u540c\u7684\u9501\u673a\u5236\u3002\u4e0b\u8868\u4e2d\u7f57\u5217\u51fa\u4e86\u5404\u4e2a\u5b58\u50a8\u5f15\u64ce\u5bf9\u9501\u7684\u652f\u6301\u60c5\u51b5</p> \u5b58\u50a8\u5f15\u64ce \u8868\u7ea7\u9501 \u884c\u7ea7\u9501 \u9875\u9762\u9501 MyISAM \u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 InnoDB \u652f\u6301 \u652f\u6301 \u4e0d\u652f\u6301 MEMORY \u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 BDB \u652f\u6301 \u4e0d\u652f\u6301 \u652f\u6301 <p>MySQL \u8fd93\u4e2d\u9501\u7684\u7279\u6027\u53ef\u5927\u81f4\u5f52\u7eb3\u5982\u4e0b\uff1a</p> \u9501\u7c7b\u578b \u7279\u70b9 \u8868\u6781\u9501 \u504f\u5411 MyISAM \u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u9500\u5c0f\uff0c\u52a0\u9501\u5feb\uff1b\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u5927\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u9ad8\uff0c\u5e76\u53d1\u5ea6\u6700\u4f4e \u884c\u6781\u9501 \u504f\u5411 InnoDB \u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u9500\u5927\uff0c\u52a0\u9501\u6162\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u6700\u5c0f\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u4f4e\uff0c\u5e76\u53d1\u5ea6\u4e5f\u6700\u9ad8 \u9875\u9762\u9501 \u5f00\u9501\u548c\u52a0\u9501\u65f6\u95f4\u4ecb\u4e8e\u8868\u9501\u548c\u884c\u9501\u4e4b\u95f4\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u4ecb\u4e8e\u8868\u9501\u548c\u884c\u9501\u4e4b\u95f4\uff0c\u5e76\u53d1\u5ea6\u4e00\u822c <p>\u4ece\u4e0a\u8ff0\u6765\u770b\uff0c\u5f88\u96be\u7b3c\u7edf\u5730\u8bf4\u54ea\u79cd\u9501\u66f4\u597d\uff0c\u53ea\u80fd\u5c31\u5177\u4f53\u5e94\u7528\u7684\u7279\u70b9\u6765\u8bf4\u54ea\u79cd\u9501\u66f4\u5408\u9002\u3002 \u4ec5\u4ece\u9501\u7684\u89d2\u5ea6\u6765\u8bf4\uff1a\u8868\u7ea7\u9501\u66f4\u9002\u5408\u4ee5\u67e5\u8be2\u4e3a\u4e3b\uff0c\u53ea\u6709\u5c11\u91cf\u6309\u7d22\u5f15\u6761\u4ef6\u66f4\u65b0\u6570\u636e\u7684\u5e94\u7528\uff0c\u5982web\u5e94\u7528\uff1b\u884c\u7ea7\u9501 \u66f4\u9002\u5408\u4e8e\u6709\u5927\u91cf\u6309\u7d22\u5f15\u6761\u4ef6\u5e76\u53d1\u66f4\u65b0\u5c11\u91cf\u4e0d\u540c\u6570\u636e\uff0c\u540c\u65f6\u53c8\u6709\u5e76\u67e5\u8be2\u7684\u5e94\u7528\uff0c\u5982\u4e00\u4e9b\u5728\u7ebf\u4e8b\u52a1\u5904\u7406\uff08OLTP\uff09\u7cfb\u7edf\u3002</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#24myisam","title":"2.4\u3001MyISAM \u8868\u9501","text":"<p>MyISAM \u5b58\u50a8\u5f15\u64ce\u53ea\u652f\u6301\u8868\u9501\uff0c\u8fd9\u4e5f\u662f MySQL \u5f00\u59cb\u51e0\u4e2a\u7248\u672c\u4e2d\u552f\u4e00\u652f\u6301\u7684\u9501\u7c7b\u578b\u3002</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#241","title":"2.4.1\u3001\u5982\u4f55\u52a0\u8868\u9501","text":"<p>MyISAM \u5728\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff08SELECT\uff09\u524d\uff0c\u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u7684\u6240\u6709\u8868\u52a0\u8bfb\u9501\uff0c\u5728\u6267\u884c\u66f4\u65b0\u64cd\u4f5c\uff08UPDATE\u3001DELETE\u3001INSERT\u7b49\uff09\u524d\uff0c\u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u7684\u8868\u52a0\u5199\u9501\u3002</p> <p>\u8fd9\u4e2a\u8fc7\u7a0b\u5e76\u4e0d\u9700\u8981\u7528\u6237\u5e72\u9884\uff0c\u56e0\u6b64\uff0c\u7528\u6237\u4e00\u822c\u4e0d\u9700\u8981\u76f4\u63a5\u7528 <code>LOCJ TABLE</code>\u547d\u4ee4\u7ed9 MyISAM \u8868\u663e\u793a\u52a0\u9501\u3002</p> <p>\u663e\u793a\u52a0\u8868\u9501\u8bed\u6cd5\uff1a</p> <pre><code>\u52a0\u8bfb\u9501\uff1alock table table_name read;\n\u52a0\u5199\u9501\uff1alock table table_name write;\n</code></pre>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#244","title":"2.4.4\u3001\u7ed3\u8bba","text":"\u5f53\u524d\u9501\u6a21\u5f0f\\\u8bf7\u6c42\u9501\u6a21\u5f0f None \u8bfb\u9501 \u5199\u9501 \u8bfb\u9501 \u662f \u662f \u5426 \u5199\u9501 \u662f \u5426 \u5426 <p>\u7531\u4e0a\u8868\u53ef\u89c1\uff1a 1\uff09\u5bf9 MyISAM \u8868\u7684\u8bfb\u64cd\u4f5c\uff0c\u4e0d\u4f1a\u963b\u585e\u5176\u4ed6\u7528\u6237\u5bf9\u540c\u4e00\u8868\u7684\u8bfb\u8bf7\u6c42\uff0c\u4f46\u4f1a\u963b\u585e\u5bf9\u7edf\u4e00\u8868\u7684\u5199\u8bf7\u6c42\uff1b 2\uff09\u5bf9 MyISAM \u8868\u7684\u5199\u64cd\u4f5c\uff0c\u5219\u4f1a\u963b\u585e\u5176\u4ed6\u7528\u6237\u5bf9\u540c\u4e00\u8868\u7684\u8bfb\u548c\u5199\u64cd\u4f5c\uff1b</p> <p>\u7b80\u800c\u8a00\u4e4b\uff0c\u5c31\u662f\u8bfb\u9501\u4f1a\u963b\u585e\u5199\uff0c\u4f46\u662f\u4e0d\u4f1a\u963b\u585e\u8bfb\u3002\u800c\u5199\u9501\uff0c\u65e2\u4f1a\u963b\u585e\u8bfb\uff0c\u53c8\u4f1a\u963b\u585e\u5199\u3002</p> <p>\u6b64\u5916\uff0c MyISAM \u7684\u8bfb\u5199\u9501\u8c03\u5ea6\u662f \u5199 \u4f18\u5148\u3002\u8fd9\u4e5f\u662f MyISAM \u4e0d\u9002\u5408\u4f5c\u4e3a\u5199\u4e3a\u4e3b\u7684\u8868\u7684\u5b58\u50a8\u5f15\u64ce\u7684\u539f\u56e0\u3002\u56e0\u4e3a\u5199\u9501\u540e\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4e0d\u80fd\u505a\u4efb\u4f55\u64cd\u4f5c\uff0c\u5927\u91cf\u7684\u66f4\u65b0\u4f1a\u4f7f\u67e5\u8be2\u5f88\u96be\u5f97\u5230\u9501\uff0c\u4ece\u800c\u9020\u6210\u6c38\u8fdc\u963b\u585e\u3002</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#245","title":"2.4.5\u3001\u67e5\u770b\u9501\u7684\u4e89\u7528\u60c5\u51b5","text":"<pre><code>show open tables;\n</code></pre> <ol> <li>In_use\uff1a\u8868\u5f53\u524d\u88ab\u67e5\u8be2\u4f7f\u7528\u7684\u6b21\u6570\uff0c\u5982\u679c\u4e3a\u96f6\uff0c\u5219\u8868\u662f\u6253\u5f00\u7684\uff0c\u4f46\u662f\u5f53\u524d\u6ca1\u6709\u88ab\u4f7f\u7528\u3002</li> <li>Name_locked\uff1a\u8868\u540d\u79f0\u662f\u5426\u88ab\u9501\u5b9a\u3002\u540d\u79f0\u9501\u5b9a\u7528\u4e8e\u53d6\u6d88\u8868\u6216\u5bf9\u8868\u8fdb\u884c\u91cd\u547d\u540d\u7b49\u64cd\u4f5c\u3002</li> </ol> <pre><code>show status like 'Table_locks%';\n\nmysql&gt; show status like 'Table_lock%';\n+-----------------------+------------+\n| Variable_name         | Value      |\n+-----------------------+------------+\n| Table_locks_immediate | 2772892035 |\n| Table_locks_waited    | 64713      |\n+-----------------------+------------+\n2 rows in set (0.00 sec)\n</code></pre> <ol> <li>Table_locks_immediate\uff1a\u6307\u7684\u662f\u80fd\u591f\u7acb\u5373\u83b7\u5f97\u8868\u7ea7\u9501\u7684\u6b21\u6570\uff0c\u6bcf\u7acb\u5373\u83b7\u53d6\u9501\uff0c\u503c\u52a0 1\u3002</li> <li>Table_locks_waited\uff1a\u6307\u7684\u662f\u4e0d\u80fd\u7acb\u5373\u83b7\u53d6\u8868\u6781\u9501\u800c\u9700\u8981\u7b49\u5f85\u7684\u6b21\u6570\uff0c\u6bcf\u7b49\u5f85\u4e00\u6b21\uff0c\u8be5\u503c\u52a0 1\uff0c\u6b64\u503c\u8d8a\u9ad8\u8bf4\u660e\u5b58\u5728\u7740\u8f83\u4e3a\u4e25\u91cd\u7684\u8868\u6781\u9501\u4e89\u7528\u60c5\u51b5\u3002</li> </ol>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#25innodb","title":"2.5\u3001InnoDB \u884c\u9501","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#251","title":"2.5.1\u3001\u884c\u9501\u4ecb\u7ecd","text":"<p>\u884c\u9501\u7279\u70b9\uff1a\u504f\u5411 InnoDB \u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u9500\u5927\uff0c\u52a0\u9501\u6162\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u5c0f\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u4f4e\uff0c\u5e76\u53d1\u5ea6\u6700\u9ad8\u3002</p> <p>InnoDB \u4e0e MyISAM \u7684\u6700\u5927\u4e0d\u540c\u6709\u4e24\u70b9\uff1a\u4e00\u662f\u652f\u6301\u4e8b\u52a1\uff0c\u4e8c\u662f\u91c7\u7528\u4e86\u884c\u7ea7\u9501\u3002</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#252","title":"2.5.2\u3001\u80cc\u666f\u77e5\u8bc6","text":"<p>1\u3001\u4e8b\u52a1\u53ca\u5176ACID\u5c5e\u6027 \u4e8b\u52a1\u662f\u7531\u4e00\u7ec4 SQL \u8bed\u53e5\u7ec4\u6210\u7684\u903b\u8f91\u5904\u7406\u5355\u5143\u3002 \u4e8b\u52a1\u5177\u6709\u4ee5\u4e0b 4 \u4e2a\u7279\u6027\uff0c\u7b80\u79f0\u4e3a \u4e8b\u52a1ACID\u5c5e\u6027\u3002</p> ACID\u5c5e\u6027 \u542b\u4e49 \u539f\u5b50\u6027\uff08Atomicity\uff09 \u4e8b\u52a1\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\u5355\u5143\uff0c\u5176\u5bf9\u6570\u636e\u7684\u4fee\u6539\uff0c\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e48\u5168\u90e8\u5931\u8d25 \u4e00\u81f4\u6027\uff08Consistent\uff09 \u5728\u4e8b\u52a1\u5f00\u59cb\u548c\u5b8c\u6210\u65f6\uff0c\u6570\u636e\u90fd\u5fc5\u987b\u4fdd\u6301\u4e00\u81f4\u72b6\u6001 \u9694\u79bb\u6027\uff08Isolation\uff09 \u6570\u636e\u5e93\u7cfb\u7edf\u63d0\u4f9b\u4e00\u5b9a\u7684\u9694\u79bb\u673a\u5236\uff0c\u4fdd\u8bc1\u4e8b\u52a1\u5728\u4e0d\u53d7\u5916\u90e8\u5e76\u53d1\u64cd\u4f5c\u5f71\u54cd\u7684\u201c\u72ec\u7acb\u73af\u5883\u201d\u4e0b\u8fd0\u884c \u6301\u4e45\u6027\uff08Durable\uff09 \u4e8b\u52a1\u5b8c\u6210\u4e4b\u540e\uff0c\u5bf9\u4e8e\u6570\u636e\u7684\u4fee\u6539\u662f\u6c38\u4e45\u7684\u3002 <p>2\u3001\u5e76\u53d1\u4e8b\u52a1\u5904\u7406\u5e26\u6765\u7684\u95ee\u9898</p> \u95ee\u9898 \u542b\u4e49 \u4e22\u5931\u66f4\u65b0\uff08Lost Update\uff09 \u5f53\u4e24\u4e2a\u6216\u591a\u4e2a\u4e8b\u52a1\u9009\u62e9\u540c\u4e00\u884c\uff0c\u6700\u521d\u7684\u4e8b\u52a1\u4fee\u6539\u7684\u503c\uff0c\u4f1a\u88ab\u540e\u9762\u7684\u4e8b\u52a1\u4fee\u6539\u7684\u503c\u8986\u76d6\u3002 \u810f\u8bfb\uff08Dirty Reads\uff09 \u5f53\u4e00\u4e2a\u4e8b\u52a1\u6b63\u5728\u8bbf\u95ee\u6570\u636e\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u884c\u4e86\u4fee\u6539\uff0c\u800c\u8fd9\u79cd\u4fee\u6539\u8fd8\u6ca1\u6709\u63d0\u4ea4\u5230\u6570\u636e\u5e93\u4e2d\u3002\u8fd9\u65f6\uff0c\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u4e5f\u8bbf\u95ee\u4e86\u8fd9\u4e2a\u6570\u636e\uff0c\u7136\u540e\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6570\u636e\u3002 \u4e0d\u53ef\u91cd\u590d\u8bfb\uff08Non-Repeatable Reads\uff09 \u4e00\u4e2a\u4e8b\u52a1\u5728\u8bfb\u53d6\u67d0\u4e9b\u6570\u636e\u540e\u7684\u67d0\u4e2a\u65f6\u95f4\uff0c\u518d\u6b21\u8bfb\u53d6\u4ee5\u524d\u8bfb\u8fc7\u7684\u6570\u636e\uff0c\u5374\u53d1\u73b0\u548c\u4ee5\u524d\u8bfb\u51fa\u7684\u6570\u636e\u4e0d\u4e00\u81f4\u3002 \u5e7b\u8bfb\uff08Phantom Reads\uff09 \u4e00\u4e2a\u4e8b\u52a1\u6309\u7167\u76f8\u540c\u7684\u67e5\u8be2\u6761\u4ef6\u91cd\u65b0\u8bfb\u53d6\u4ee5\u524d\u67e5\u8be2\u8fc7\u7684\u6570\u636e\uff0c\u5374\u53d1\u73b0\u5176\u4ed6\u4e8b\u52a1\u63d2\u5165\u4e86\u6ee1\u8db3\u67e5\u8be2\u6761\u4ef6\u7684\u65b0\u6570\u636e\u3002 <p>3\u3001\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b \u4e3a\u4e86\u89e3\u51b3\u4e0a\u8ff0\u63d0\u5230\u7684\u4e8b\u52a1\u5e76\u53d1\u95ee\u9898\uff0c\u6570\u636e\u5e93\u63d0\u4f9b\u4e00\u5b9a\u7684\u4e8b\u52a1\u9694\u79bb\u673a\u5236\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u9694\u79bb\u8d8a\u4e25\u683c\uff0c\u5e76\u53d1\u526f\u4f5c\u7528\u8d8a\u5c0f\uff0c\u4f46\u4ed8\u51fa\u7684\u4ee3\u4ef7\u4e5f\u5c31\u8d8a\u5927\uff0c\u56e0\u4e3a\u4e8b\u52a1\u9694\u79bb\u5b9e\u8d28\u4e0a\u5c31\u662f\u4f7f\u7528\u4e8b\u52a1\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u201c\u4e32\u884c\u5316\u201d\u8fdb\u884c\uff0c\u8fd9\u663e\u7136\u4e0e\u201d\u5e76\u53d1\u201c\u662f\u77db\u76fe\u7684\u3002</p> <p>\u6570\u636e\u5e93\u7684\u9694\u79bb\u7ea7\u522b\u6709 4 \u4e2a\uff0c\u7531\u4f4e\u5230\u9ad8\u4f9d\u6b21\u4e3a <code>Read uncommitted</code>\u3001<code>Read committed</code>\u3001<code>Repeatable read</code>\u3001<code>Serializbale</code> \uff0c\u8fd9\u56db\u4e2a\u51e0\u676f\u53ef\u4ee5\u9010\u4e2a\u89e3\u51b3 \u810f\u5199\u3001\u810f\u8bfb\u3001\u4e0d\u53ef\u91cd\u590d\u8bfb\u3001\u5e7b\u8bfb\u8fd9\u51e0\u7c7b\u95ee\u9898\u3002</p> \u9694\u79bb\u7ea7\u522b \u4e22\u5931\u66f4\u65b0 \u810f\u8bfb \u4e0d\u53ef\u91cd\u590d\u8bfb \u5e7b\u8bfb Read uncommitted \u00d7 \u221a \u221a \u221a Read committed \u00d7 \u00d7 \u221a \u221a Repeatable read\uff08\u9ed8\u8ba4\uff09 \u00d7 \u00d7 \u00d7 \u221a Serializable \u00d7 \u00d7 \u00d7 \u00d7 <p>\u5907\u6ce8 \uff1a \u221a \u4ee3\u8868\u53ef\u80fd\u51fa\u73b0 \uff0c \u00d7 \u4ee3\u8868\u4e0d\u4f1a\u51fa\u73b0 \u3002</p> <p>MySQL \u7684\u6570\u636e\u5e93\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u4e3a Repeatable read\uff0c\u67e5\u770b\u65b9\u5f0f\u4e3a\uff1a</p> <pre><code>show variables like 'tx_isolation';\n</code></pre>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#253innodb","title":"2.5.3\u3001InnoDB \u7684\u884c\u9501\u6a21\u5f0f","text":"<p>InnoDB \u5b9e\u73b0\u4e86\u4ee5\u4e0b\u4e24\u79cd\u7c7b\u578b\u7684\u884c\u9501\u3002</p> <ul> <li>\u5171\u4eab\u9501\uff08S\uff09\uff1a\u53c8\u79f0\u4e3a \u8bfb\u9501\uff0c\u7b80\u79f0 S\u9501 \uff0c\u5171\u4eab\u9501\u5c31\u662f\u591a\u4e2a\u4e8b\u52a1\u5bf9\u4e8e\u540c\u4e00\u6570\u636e\u53ef\u4ee5\u5171\u4eab\u4e00\u628a\u9501\uff0c\u90fd\u80fd\u8bbf\u95ee\u5230\u6570\u636e\uff0c\u4f46\u662f\u53ea\u80fd\u8bfb\u4e0d\u80fd\u4fee\u6539\u3002</li> <li>\u6392\u4ed6\u9501\uff08X\uff09\uff1a\u53c8\u79f0\u4e3a \u5199\u9501\uff0c\u7b80\u79f0 X\u9501 \uff0c\u6392\u4ed6\u9501\u4e0d\u80fd\u4e0e\u5176\u4ed6\u9501\u5e76\u5b58\uff0c\u5982\u4e00\u4e2a\u4e8b\u52a1\u83b7\u53d6\u4e86\u4e00\u4e2a\u6570\u636e\u884c\u7684\u6392\u4ed6\u9501\uff0c\u5176\u4ed6\u4e8b\u52a1\u5c31\u4e0d\u80fd\u518d\u83b7\u53d6\u8be5\u884c\u7684\u5176\u4ed6\u9501\uff0c\u5305\u62ec\u5171\u4eab\u9501\u548c\u6392\u4ed6\u9501\uff0c\u4f46\u662f\u83b7\u53d6\u6392\u4ed6\u9501\u7684\u4e8b\u52a1\u662f\u53ef\u4ee5\u5bf9\u6570\u636e\u5c31 \u884c \u8bfb\u53d6\u548c\u4fee\u6539\u3002</li> </ul> <p>\u5bf9\u4e8e UPDATE\u3001DELETE\u3001INSERT \u8bed\u53e5\uff0cInnoDB \u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u6570\u636e\u96c6\u52a0 \u6392\u4ed6\u9501\uff08X\uff09\uff1b \u5bf9\u4e8e\u666e\u901a SELECT \u8bed\u53e5\uff0c InnoDB \u4e0d\u4f1a\u52a0\u4efb\u4f55\u9501\uff1b</p> <p>\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u8bed\u53e5\u663e\u793a\u7ed9\u8bb0\u5f55\u96c6\u52a0\u5171\u4eab\u9501\u6216\u6392\u4ed6\u9501\u3002</p> <pre><code>\u5171\u4eab\u9501\uff08S\uff09\uff1aselect * from table_name where ... lock in share mode\n\u6392\u4ed6\u9501\uff08X\uff09\uff1aselect * from table_name where ... for update\n</code></pre>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#256","title":"2.5.6\u3001\u65e0\u7d22\u5f15\u884c\u9501\u5347\u7ea7\u4e3a\u8868\u9501","text":"<p>\u5982\u679c\u4e0d\u901a\u8fc7\u7d22\u5f15\u6761\u4ef6\u68c0\u7d22\u6570\u636e\uff0c\u90a3\u4e48 InnoDB \u5c06\u5bf9\u8868\u4e2d\u7684\u6240\u6709\u8bb0\u5f55\u52a0\u9501\uff0c\u5b9e\u9645\u6548\u679c\u8ddf\u8868\u9501\u4e00\u6837\u3002</p> <p>\u67e5\u770b\u5f53\u524d\u8868\u7684\u7d22\u5f15\uff1a</p> <pre><code>show index from test_innodb_lock;\n</code></pre> <p>\u7531\u4e8e\u6267\u884c\u66f4\u65b0\u65f6\uff0c name \u5b57\u6bb5\u672c\u6765\u4e3a varchar \u7c7b\u578b\uff0c\u6211\u4eec\u662f\u4f5c\u4e3a\u6570\u636e\u7c7b\u578b\u4f7f\u7528\uff0c\u5b58\u5728\u7c7b\u578b\u8f6c\u6362\uff0c\u7d22\u5f15\u5931\u6548\uff0c\u6700\u7ec8 \u884c\u9501\u53d8\u4e3a\u8868\u9501\u3002</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#257","title":"2.5.7\u3001\u95f4\u9699\u9501\u5371\u5bb3","text":"<p>\u5f53\u6211\u4eec\u7528\u8303\u56f4\u6761\u4ef6\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u76f8\u7b49\u6761\u4ef6\u68c0\u7d22\u6570\u636e\uff0c\u5e76\u8bf7\u6c42\u5171\u4eab\u6216\u6392\u5b83\u9501\u65f6\uff0cInnoDB \u4f1a\u7ed9\u7b26\u5408\u6761\u4ef6\u7684\u5df2\u6709\u6570\u636e\u8fdb\u884c\u52a0\u9501\uff1b\u5bf9\u4e8e\u952e\u503c\u5728\u6761\u4ef6\u8303\u56f4\u5185\u4f46\u4e0d\u5b58\u5728\u8bb0\u5f55\uff0c\u53eb\u505a\u201c\u95f4\u9699\uff08GAP\uff09\u201d\uff0cInnoDB \u4e5f\u4f1a\u5bf9\u8fd9\u4e2a\u201c\u95f4\u9699\u201d\u52a0\u9501\uff0c\u8fd9\u79cd\u673a\u5236\u5c31\u662f\u6240\u8c13\u7684 \u95f4\u9699\u9501\uff08Next-key\u9501\uff09</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#258innodb","title":"2.5.8\u3001InnoDB\u884c\u9501\u4e89\u7528\u60c5\u51b5","text":"<pre><code>show status like 'innodb_row_lock%';\n</code></pre> <pre><code>Innodb_row_lock_current_waits: \u5f53\u524d\u6b63\u5728\u7b49\u5f85\u9501\u5b9a\u7684\u6570\u91cf\n\nInnodb_row_lock_time: \u4ece\u7cfb\u7edf\u542f\u52a8\u5230\u73b0\u5728\u9501\u5b9a\u603b\u65f6\u95f4\u957f\u5ea6\n\nInnodb_row_lock_time_avg:\u6bcf\u6b21\u7b49\u5f85\u6240\u82b1\u5e73\u5747\u65f6\u957f\n\nInnodb_row_lock_time_max:\u4ece\u7cfb\u7edf\u542f\u52a8\u5230\u73b0\u5728\u7b49\u5f85\u6700\u957f\u7684\u4e00\u6b21\u6240\u82b1\u7684\u65f6\u95f4\n\nInnodb_row_lock_waits: \u7cfb\u7edf\u542f\u52a8\u540e\u5230\u73b0\u5728\u603b\u5171\u7b49\u5f85\u7684\u6b21\u6570\n\n\n\u5f53\u7b49\u5f85\u7684\u6b21\u6570\u5f88\u9ad8\uff0c\u800c\u4e14\u6bcf\u6b21\u7b49\u5f85\u7684\u65f6\u957f\u4e5f\u4e0d\u5c0f\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5206\u6790\u7cfb\u7edf\u4e2d\u4e3a\u4ec0\u4e48\u4f1a\u6709\u5982\u6b64\u591a\u7684\u7b49\u5f85\uff0c\u7136\u540e\u6839\u636e\u5206\u6790\u7ed3\u679c\u7740\u624b\u5236\u5b9a\u4f18\u5316\u8ba1\u5212\u3002\n</code></pre>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#259","title":"2.5.9\u3001\u603b\u7ed3","text":"<p>InnoDB \u5b58\u50a8\u5f15\u64ce\u7531\u4e8e\u5b9e\u73b0\u4e86\u884c\u7ea7\u9501\u5b9a\uff0c\u867d\u7136\u5728\u9501\u5b9a\u673a\u5236\u7684\u5b9e\u73b0\u65b9\u9762\u5e26\u6765\u4e86\u6027\u80fd\u635f\u8017\u53ef\u80fd\u6bd4\u8868\u6781\u9501\u4f1a\u66f4\u9ad8\u4e00\u4e9b\uff0c\u4f46\u662f\u5728\u6574\u4f53\u5e76\u53d1\u5904\u7406\u80fd\u529b\u65b9\u9762\u8981\u8fdc\u8fdc\u4f18\u4e8eMyISAM\u7684\u8868\u9501\u7684\u3002\u5f53\u7cfb\u7edf\u5e76\u53d1\u91cf\u6bd4\u8f83\u9ad8\u7684\u65f6\u5019\uff0cInnoDB \u7684\u6574\u4f53\u6027\u80fd\u548c MyISAM \u76f8\u6bd4\u5c31\u4f1a\u6709\u6bd4\u8f83\u660e\u663e\u7684\u4f18\u52bf\u3002</p> <p>\u4f46\u662f\uff0cInnoDB \u7684\u884c\u7ea7\u9501\u4e5f\u6709\u8106\u5f31\u7684\u4e00\u9762\uff0c\u5f53\u6211\u4eec\u4f7f\u7528\u4e0d\u5f53\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u8ba9 InnoDB \u7684\u6574\u4f53\u6027\u80fd\u8868\u73b0\u4e0d\u4ec5\u4e0d\u80fd\u6bd4 MyISAM \u9ad8\uff0c\u751a\u81f3\u4f1a\u66f4\u5dee\u3002</p>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#2510","title":"2.5.10\u3001\u4f18\u5316\u5efa\u8bae","text":"<ol> <li>\u5c3d\u53ef\u80fd\u8ba9\u6240\u6709\u6570\u636e\u68c0\u7d22\u90fd\u80fd\u901a\u8fc7\u7d22\u5f15\u6765\u5b8c\u6210\uff0c\u907f\u514d\u65e0\u7d22\u5f15\u884c\u9501\u5347\u7ea7\u4e3a\u8868\u9501\u3002</li> <li>\u5408\u7406\u8bbe\u8ba1\u7d22\u5f15\uff0c\u5c3d\u91cf\u7f29\u5c0f\u9501\u7684\u8303\u56f4</li> <li>\u5c3d\u53ef\u80fd\u51cf\u5c11\u7d22\u5f15\u6761\u4ef6\uff0c\u53ca\u7d22\u5f15\u8303\u56f4\uff0c\u907f\u514d\u95f4\u9699\u9501</li> <li>\u5c3d\u91cf\u63a7\u5236\u4e8b\u52a1\u5927\u5c0f\uff0c\u51cf\u5c11\u9501\u5b9a\u8d44\u6e90\u91cf\u548c\u65f6\u95f4\u957f\u5ea6</li> <li>\u5c3d\u53ef\u80fd\u4f7f\u7528\u4f4e\u7ea7\u522b\u4e8b\u52a1\u9694\u79bb\uff08\u4f46\u662f\u9700\u8981\u4e1a\u52a1\u5c42\u6ee1\u8db3\u9700\u6c42\uff09</li> </ol>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#3mysql","title":"3\u3001\u5e38\u7528MySQL\u6280\u5de7","text":""},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#1-sql","title":"1. SQL \u6267\u884c\u987a\u5e8f","text":"<p>\u7f16\u5199\u987a\u5e8f</p> <pre><code>SELECT DISTINCT\n &lt;select list&gt;\nFROM\n &lt;left_table&gt; &lt;join_type&gt;\nJOIN\n &lt;right_table&gt; ON &lt;join_condition&gt;\nWHERE\n &lt;where_condition&gt;\nGROUP BY\n &lt;group_by_list&gt;\nHAVING\n &lt;having_condition&gt;\nORDER BY\n &lt;order_by_condition&gt;\nLIMIT\n &lt;limit_params&gt;\n12345678910111213141516\n</code></pre> <p>\u6267\u884c\u987a\u5e8f</p> <pre><code>FROM    &lt;left_table&gt;\n\nON      &lt;join_condition&gt;\n\n&lt;join_type&gt;     JOIN    &lt;right_table&gt;\n\nWHERE       &lt;where_condition&gt;\n\nGROUP BY    &lt;group_by_list&gt;\n\nHAVING      &lt;having_condition&gt;\n\nSELECT DISTINCT     &lt;select list&gt;\n\nORDER BY    &lt;order_by_condition&gt;\n\nLIMIT       &lt;limit_params&gt;\n</code></pre>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#2","title":"2. \u6b63\u5219\u8868\u8fbe\u5f0f\u4f7f\u7528","text":"<p>\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Regular Expression\uff09\u662f\u6307\u4e00\u4e2a\u7528\u6765\u63cf\u8ff0\u6216\u8005\u5339\u914d\u4e00\u7cfb\u5217\u7b26\u5408\u67d0\u4e2a\u53e5\u6cd5\u89c4\u5219\u7684\u5b57\u7b26\u4e32\u7684\u5355\u4e2a\u5b57\u7b26\u4e32\u3002</p> \u7b26\u53f7 \u542b\u4e49 ^ \u5728\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u8fdb\u884c\u5339\u914d $ \u5728\u5b57\u7b26\u4e32\u672b\u5c3e\u5904\u8fdb\u884c\u5339\u914d . \u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26, \u5305\u62ec\u6362\u884c\u7b26 [\u2026] \u5339\u914d\u51fa\u62ec\u53f7\u5185\u7684\u4efb\u610f\u5b57\u7b26 [^\u2026] \u5339\u914d\u4e0d\u51fa\u62ec\u53f7\u5185\u7684\u4efb\u610f\u5b57\u7b26 a* \u5339\u914d\u96f6\u4e2a\u6216\u8005\u591a\u4e2aa(\u5305\u62ec\u7a7a\u4e32) a+ \u5339\u914d\u4e00\u4e2a\u6216\u8005\u591a\u4e2aa(\u4e0d\u5305\u62ec\u7a7a\u4e32) a? \u5339\u914d\u96f6\u4e2a\u6216\u8005\u4e00\u4e2aa a1|a2 \u5339\u914da1\u6216a2 a(m) \u5339\u914dm\u4e2aa a(m,) \u81f3\u5c11\u5339\u914dm\u4e2aa a(m,n) \u5339\u914dm\u4e2aa \u5230 n\u4e2aa a(,n) \u5339\u914d0\u5230n\u4e2aa (\u2026) \u5c06\u6a21\u5f0f\u5143\u7d20\u7ec4\u6210\u5355\u4e00\u5143\u7d20 <pre><code>select * from emp where name regexp '^T';\nselect * from emp where name regexp '2$';\nselect * from emp where name regexp '[uvw]';\n12345\n</code></pre>"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#3-mysql","title":"3. MySQL \u5e38\u7528\u51fd\u6570","text":"<p>\u6570\u5b57\u51fd\u6570</p> \u51fd\u6570\u540d\u79f0 \u4f5c \u7528 ABS \u6c42\u7edd\u5bf9\u503c SQRT \u6c42\u4e8c\u6b21\u65b9\u6839 MOD \u6c42\u4f59\u6570 CEIL \u548c CEILING \u4e24\u4e2a\u51fd\u6570\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u8fd4\u56de\u4e0d\u5c0f\u4e8e\u53c2\u6570\u7684\u6700\u5c0f\u6574\u6570\uff0c\u5373\u5411\u4e0a\u53d6\u6574 FLOOR \u5411\u4e0b\u53d6\u6574\uff0c\u8fd4\u56de\u503c\u8f6c\u5316\u4e3a\u4e00\u4e2aBIGINT RAND \u751f\u6210\u4e00\u4e2a0~1\u4e4b\u95f4\u7684\u968f\u673a\u6570\uff0c\u4f20\u5165\u6574\u6570\u53c2\u6570\u662f\uff0c\u7528\u6765\u4ea7\u751f\u91cd\u590d\u5e8f\u5217 ROUND \u5bf9\u6240\u4f20\u53c2\u6570\u8fdb\u884c\u56db\u820d\u4e94\u5165 SIGN \u8fd4\u56de\u53c2\u6570\u7684\u7b26\u53f7 POW \u548c POWER \u4e24\u4e2a\u51fd\u6570\u7684\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u6240\u4f20\u53c2\u6570\u7684\u6b21\u65b9\u7684\u7ed3\u679c\u503c SIN \u6c42\u6b63\u5f26\u503c ASIN \u6c42\u53cd\u6b63\u5f26\u503c\uff0c\u4e0e\u51fd\u6570 SIN \u4e92\u4e3a\u53cd\u51fd\u6570 COS \u6c42\u4f59\u5f26\u503c ACOS \u6c42\u53cd\u4f59\u5f26\u503c\uff0c\u4e0e\u51fd\u6570 COS \u4e92\u4e3a\u53cd\u51fd\u6570 TAN \u6c42\u6b63\u5207\u503c ATAN \u6c42\u53cd\u6b63\u5207\u503c\uff0c\u4e0e\u51fd\u6570 TAN \u4e92\u4e3a\u53cd\u51fd\u6570 COT \u6c42\u4f59\u5207\u503c <p>\u5b57\u7b26\u4e32\u51fd\u6570</p> \u51fd\u6570\u540d\u79f0 \u4f5c \u7528 LENGTH \u8ba1\u7b97\u5b57\u7b26\u4e32\u957f\u5ea6\u51fd\u6570\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u5b57\u8282\u957f\u5ea6 CONCAT \u5408\u5e76\u5b57\u7b26\u4e32\u51fd\u6570\uff0c\u8fd4\u56de\u7ed3\u679c\u4e3a\u8fde\u63a5\u53c2\u6570\u4ea7\u751f\u7684\u5b57\u7b26\u4e32\uff0c\u53c2\u6570\u53ef\u4ee5\u4f7f\u4e00\u4e2a\u6216\u591a\u4e2a INSERT \u66ff\u6362\u5b57\u7b26\u4e32\u51fd\u6570 LOWER \u5c06\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5c0f\u5199 UPPER \u5c06\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5927\u5199 LEFT \u4ece\u5de6\u4fa7\u5b57\u622a\u53d6\u7b26\u4e32\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u5de6\u8fb9\u7684\u82e5\u5e72\u4e2a\u5b57\u7b26 RIGHT \u4ece\u53f3\u4fa7\u5b57\u622a\u53d6\u7b26\u4e32\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u53f3\u8fb9\u7684\u82e5\u5e72\u4e2a\u5b57\u7b26 TRIM \u5220\u9664\u5b57\u7b26\u4e32\u5de6\u53f3\u4e24\u4fa7\u7684\u7a7a\u683c REPLACE \u5b57\u7b26\u4e32\u66ff\u6362\u51fd\u6570\uff0c\u8fd4\u56de\u66ff\u6362\u540e\u7684\u65b0\u5b57\u7b26\u4e32 SUBSTRING \u622a\u53d6\u5b57\u7b26\u4e32\uff0c\u8fd4\u56de\u4ece\u6307\u5b9a\u4f4d\u7f6e\u5f00\u59cb\u7684\u6307\u5b9a\u957f\u5ea6\u7684\u5b57\u7b26\u6362 REVERSE \u5b57\u7b26\u4e32\u53cd\u8f6c\uff08\u9006\u5e8f\uff09\u51fd\u6570\uff0c\u8fd4\u56de\u4e0e\u539f\u59cb\u5b57\u7b26\u4e32\u987a\u5e8f\u76f8\u53cd\u7684\u5b57\u7b26\u4e32 <p>\u65e5\u671f\u51fd\u6570</p> \u51fd\u6570\u540d\u79f0 \u4f5c \u7528 CURDATE \u548c CURRENT_DATE \u4e24\u4e2a\u51fd\u6570\u4f5c\u7528\u76f8\u540c\uff0c\u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u7684\u65e5\u671f\u503c CURTIME \u548c CURRENT_TIME \u4e24\u4e2a\u51fd\u6570\u4f5c\u7528\u76f8\u540c\uff0c\u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u7684\u65f6\u95f4\u503c NOW \u548c SYSDATE \u4e24\u4e2a\u51fd\u6570\u4f5c\u7528\u76f8\u540c\uff0c\u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u7684\u65e5\u671f\u548c\u65f6\u95f4\u503c MONTH \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u4e2d\u7684\u6708\u4efd MONTHNAME \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u4e2d\u7684\u6708\u4efd\u82f1\u6587\u540d\u79f0 DAYNAME \u83b7\u53d6\u6307\u5b9a\u66f0\u671f\u5bf9\u5e94\u7684\u661f\u671f\u51e0\u7684\u82f1\u6587\u540d\u79f0 DAYOFWEEK \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u5bf9\u5e94\u7684\u4e00\u5468\u7684\u7d22\u5f15\u4f4d\u7f6e\u503c WEEK \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u662f\u4e00\u5e74\u4e2d\u7684\u7b2c\u51e0\u5468\uff0c\u8fd4\u56de\u503c\u7684\u8303\u56f4\u662f\u5426\u4e3a 0\u301c52 \u6216 1\u301c53 DAYOFYEAR \u83b7\u53d6\u6307\u5b9a\u66f0\u671f\u662f\u4e00\u5e74\u4e2d\u7684\u7b2c\u51e0\u5929\uff0c\u8fd4\u56de\u503c\u8303\u56f4\u662f1~366 DAYOFMONTH \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u662f\u4e00\u4e2a\u6708\u4e2d\u662f\u7b2c\u51e0\u5929\uff0c\u8fd4\u56de\u503c\u8303\u56f4\u662f1~31 YEAR \u83b7\u53d6\u5e74\u4efd\uff0c\u8fd4\u56de\u503c\u8303\u56f4\u662f 1970\u301c2069 TIME_TO_SEC \u5c06\u65f6\u95f4\u53c2\u6570\u8f6c\u6362\u4e3a\u79d2\u6570 SEC_TO_TIME \u5c06\u79d2\u6570\u8f6c\u6362\u4e3a\u65f6\u95f4\uff0c\u4e0eTIME_TO_SEC \u4e92\u4e3a\u53cd\u51fd\u6570 DATE_ADD \u548c ADDDATE \u4e24\u4e2a\u51fd\u6570\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u5411\u65e5\u671f\u6dfb\u52a0\u6307\u5b9a\u7684\u65f6\u95f4\u95f4\u9694 DATE_SUB \u548c SUBDATE \u4e24\u4e2a\u51fd\u6570\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u5411\u65e5\u671f\u51cf\u53bb\u6307\u5b9a\u7684\u65f6\u95f4\u95f4\u9694 ADDTIME \u65f6\u95f4\u52a0\u6cd5\u8fd0\u7b97\uff0c\u5728\u539f\u59cb\u65f6\u95f4\u4e0a\u6dfb\u52a0\u6307\u5b9a\u7684\u65f6\u95f4 SUBTIME \u65f6\u95f4\u51cf\u6cd5\u8fd0\u7b97\uff0c\u5728\u539f\u59cb\u65f6\u95f4\u4e0a\u51cf\u53bb\u6307\u5b9a\u7684\u65f6\u95f4 DATEDIFF \u83b7\u53d6\u4e24\u4e2a\u65e5\u671f\u4e4b\u95f4\u95f4\u9694\uff0c\u8fd4\u56de\u53c2\u6570 1 \u51cf\u53bb\u53c2\u6570 2 \u7684\u503c DATE_FORMAT \u683c\u5f0f\u5316\u6307\u5b9a\u7684\u65e5\u671f\uff0c\u6839\u636e\u53c2\u6570\u8fd4\u56de\u6307\u5b9a\u683c\u5f0f\u7684\u503c WEEKDAY \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u5728\u4e00\u5468\u5185\u7684\u5bf9\u5e94\u7684\u5de5\u4f5c\u65e5\u7d22\u5f15 <p>\u805a\u5408\u51fd\u6570</p> \u51fd\u6570\u540d\u79f0 \u4f5c\u7528 MAX \u67e5\u8be2\u6307\u5b9a\u5217\u7684\u6700\u5927\u503c MIN \u67e5\u8be2\u6307\u5b9a\u5217\u7684\u6700\u5c0f\u503c COUNT \u7edf\u8ba1\u67e5\u8be2\u7ed3\u679c\u7684\u884c\u6570 SUM \u6c42\u548c\uff0c\u8fd4\u56de\u6307\u5b9a\u5217\u7684\u603b\u548c AVG \u6c42\u5e73\u5747\u503c\uff0c\u8fd4\u56de\u6307\u5b9a\u5217\u6570\u636e\u7684\u5e73\u5747\u503c"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/","title":"LVM\u903b\u8f91\u5377\u57fa\u672c\u6982\u5ff5\u53caLVM\u7684\u5de5\u4f5c\u539f\u7406","text":""},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#_1","title":"\u4e00\u3001\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406","text":"<p>\u5176\u5b9e\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u6211\u4eec\u7684\u78c1\u76d8\u7ba1\u7406\u673a\u5236\u548cwindows\u4e0a\u7684\u5dee\u4e0d\u591a\uff0c\u7edd\u5927\u591a\u6570\u90fd\u662f\u4f7f\u7528MBR(Master Boot Recorder)\u90fd\u662f\u901a\u8fc7\u5148\u5bf9\u4e00\u4e2a\u786c\u76d8\u8fdb\u884c\u5206\u533a\uff0c\u7136\u540e\u518d\u5c06\u8be5\u5206\u533a\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\uff0c\u5728Linux\u7cfb\u7edf\u4e2d\u5982\u679c\u8981\u4f7f\u7528\u8be5\u5206\u533a\u5c31\u5c06\u5176\u6302\u8f7d\u4e0a\u53bb\u5373\u53ef\uff0cwindows\u7684\u8bdd\u5176\u5b9e\u5e95\u5c42\u4e5f\u5c31\u662f\u81ea\u52a8\u5c06\u6240\u6709\u7684\u5206\u533a\u6302\u8f7d\u597d\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u8be5\u5206\u533a\u8fdb\u884c\u4f7f\u7528\u4e86\u3002</p> <p>\u4f46\u662f\u8fd9\u79cd\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u7ecf\u5e38\u4f1a\u5e26\u6765\u5f88\u591a\u7684\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4\u5f53\u6211\u4eec\u4f7f\u7528\u7684\u4e00\u4e2a\u5206\u533a\uff0c\u5176\u7a7a\u95f4\u5927\u5c0f\u5df2\u7ecf\u4e0d\u518d\u591f\u7528\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\u901a\u8fc7\u62c9\u4f38\u5206\u533a\u6765\u8fdb\u884c\u5206\u533a\u6269\u5145\uff0c\u5f53\u7136\u76ee\u524d\u4e5f\u6709\u5176\u4ed6\u7b2c\u4e09\u65b9\u7684\u78c1\u76d8\u7ba1\u7406\u8f6f\u4ef6\u53ef\u4ee5\u8fdb\u884c\u78c1\u76d8\u7684\u5206\u533a\u7a7a\u95f4\u5212\u5206\uff0c\u4f46\u662f\u8fd9\u6837\u4f1a\u7ed9\u6211\u4eec\u7684\u6587\u4ef6\u7cfb\u7edf\u9020\u6210\u5f88\u5927\u7684\u4f24\u5bb3\uff0c\u6709\u65f6\u4f1a\u5bfc\u81f4\u6587\u4ef6\u7cfb\u7edf\u5d29\u6e83\u7b49\u95ee\u9898\u3002\u5bf9\u4e8e\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u5982\u679c\u8bf4\u6211\u4eec\u78b0\u5230\u5f53\u5206\u533a\u5927\u5c0f\u4e0d\u8db3\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ea\u80fd\u901a\u8fc7\u589e\u52a0\u65b0\u7684\u786c\u76d8\uff0c\u7136\u540e\u5728\u65b0\u7684\u786c\u76d8\u4e0a\u521b\u5efa\u5206\u533a\uff0c\u5bf9\u5206\u533a\u8fdb\u884c\u683c\u5f0f\u5316\u4ee5\u540e\uff0c\u7136\u540e\u5c06\u4e4b\u524d\u5206\u533a\u7684\u6240\u6709\u4e1c\u897f\u90fd\u62f7\u8d1d\u5230\u65b0\u7684\u5206\u533a\u91cc\u9762\u624d\u884c\u3002\u4f46\u662f\u65b0\u589e\u52a0\u7684\u786c\u76d8\u662f\u4f5c\u4e3a\u72ec\u7acb\u7684\u6587\u4ef6\u7cfb\u7edf\u5b58\u5728\u7684\uff0c\u539f\u6709\u7684\u6587\u4ef6\u7cfb\u7edf\u5e76\u6ca1\u6709\u5f97\u5230\u4efb\u4f55\u7684\u6269\u5145\uff0c\u4e0a\u5c42\u5e94\u7528\u53ea\u80fd\u8bbf\u95ee\u5230\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u3002 \u8fd9\u6837\u7684\u65b9\u5f0f\u5bf9\u4e2a\u4eba\u7684\u7535\u8111\u6765\u8bf4\u53ef\u80fd\u8fd8\u80fd\u63a5\u53d7\uff0c\u4f46\u662f\u5982\u679c\u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\u4e0b\u7684\u670d\u52a1\u5668\u6765\u8bf4\uff0c\u8fd9\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\u3002\u56e0\u4e3a\u5982\u679c\u8981\u628a\u4e00\u4e2a\u5206\u533a\u7684\u5185\u5bb9\u90fd\u62f7\u8d1d\u5230\u53e6\u4e00\u4e2a\u5206\u533a\u4e0a\u53bb\uff0c\u52bf\u5fc5\u8981\u9996\u5148\u5378\u8f7d\u6389\u4e4b\u524d\u7684\u90a3\u4e2a\u5206\u533a\uff0c\u7136\u540e\u5bf9\u6574\u4e2a\u5206\u533a\u8fdb\u884c\u62f7\u8d1d\uff0c\u5982\u679c\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7740\u4e00\u4e2a\u91cd\u8981\u7684\u670d\u52a1\uff0c\u6bd4\u5982\u8bf4WWW\u6216\u8005FTP\uff0c\u5176\u8981\u6c42\u662f 7*24 \u5c0f\u65f6\u8fd0\u884c\u6b63\u5e38\u7684\uff0c\u90a3\u4e48\u5378\u8f7d\u6389\u5206\u533a\u8fd9\u662f\u4e0d\u53ef\u60f3\u8c61\u7684\uff0c\u540c\u65f6\u5982\u679c\u8be5\u5206\u533a\u4fdd\u5b58\u7684\u5185\u5bb9\u975e\u5e38\u975e\u5e38\u7684\u591a\uff0c\u90a3\u4e48\u5728\u5bf9\u5206\u533a\u8fdb\u884c\u8f6c\u79fb\u65f6\u65f6\u95f4\u53ef\u80fd\u4f1a\u8017\u8d39\u5f88\u4e45\uff0c\u6240\u4ee5\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u4f1a\u53d7\u5230\u4f20\u7edf\u78c1\u76d8\u7ba1\u7406\u7684\u9650\u5236\uff0c\u56e0\u4e3a\u5176\u4e0d\u80fd\u591f\u8fdb\u884c\u52a8\u6001\u7684\u78c1\u76d8\u7ba1\u7406\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cLVM\u6280\u672f\u5c31\u8bde\u751f\u4e86\uff01\uff01\uff01</p>"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#lvm","title":"\u4e8c\u3001LVM\u7684\u78c1\u76d8\u7ba1\u7406","text":"<p>\u6b63\u662f\u56e0\u4e3a\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u4e0d\u80fd\u5bf9\u6211\u4eec\u7684\u78c1\u76d8\u7a7a\u95f4\u8fdb\u884c\u52a8\u6001\u7684\u7ba1\u7406\uff0c\u56e0\u6b64\u5c31\u8bde\u751f\u51fa\u4e86LVM\u8fd9\u4e2a\u6280\u672f\uff0c\u90a3\u4e48LVM\u5230\u5e95\u662f\u4ec0\u4e48\u5462\uff1f\u5b83\u53c8\u662f\u600e\u4e48\u5bf9\u78c1\u76d8\u8fdb\u884c\u7ba1\u7406\u7684\u5462\uff1f</p> <p>LVM(Logical volume Manager)\u662f\u903b\u8f91\u5377\u7ba1\u7406\u7684\u7b80\u79f0\u3002\u5b83\u662fLinux\u73af\u5883\u4e0b\u5bf9\u78c1\u76d8\u5206\u533a\u8fdb\u884c\u7ba1\u7406\u7684\u4e00\u79cd\u673a\u5236\u3002\u73b0\u5728\u4e0d\u4ec5\u4ec5\u662fLinux\u7cfb\u7edf\u4e0a\u53ef\u4ee5\u4f7f\u7528LVM\u8fd9\u79cd\u78c1\u76d8\u7ba1\u7406\u673a\u5236\uff0c\u5bf9\u4e8e\u5176\u5b83\u7684\u7c7bUNIX\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4ee5\u53cawindows\u64cd\u4f5c\u7cfb\u7edf\u90fd\u6709\u7c7b\u4f3c\u4e0eLVM\u8fd9\u79cd\u78c1\u76d8\u7ba1\u7406\u8f6f\u4ef6\u3002</p> <p>LVM\u7684\u5de5\u4f5c\u539f\u7406\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5b83\u5c31\u662f\u901a\u8fc7\u5c06\u5e95\u5c42\u7684\u7269\u7406\u786c\u76d8\u62bd\u8c61\u7684\u5c01\u88c5\u8d77\u6765\uff0c\u7136\u540e\u4ee5\u903b\u8f91\u5377\u7684\u65b9\u5f0f\u5448\u73b0\u7ed9\u4e0a\u5c42\u5e94\u7528\u3002\u5728\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u673a\u5236\u4e2d\uff0c\u6211\u4eec\u7684\u4e0a\u5c42\u5e94\u7528\u662f\u76f4\u63a5\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf\uff0c\u4ece\u800c\u5bf9\u5e95\u5c42\u7684\u7269\u7406\u786c\u76d8\u8fdb\u884c\u8bfb\u53d6\uff0c\u800c\u5728LVM\u4e2d\uff0c\u5176\u901a\u8fc7\u5bf9\u5e95\u5c42\u7684\u786c\u76d8\u8fdb\u884c\u5c01\u88c5\uff0c\u5f53\u6211\u4eec\u5bf9\u5e95\u5c42\u7684\u7269\u7406\u786c\u76d8\u8fdb\u884c\u64cd\u4f5c\u65f6\uff0c\u5176\u4e0d\u518d\u662f\u9488\u5bf9\u4e8e\u5206\u533a\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u662f\u901a\u8fc7\u4e00\u4e2a\u53eb\u505a\u903b\u8f91\u5377\u7684\u4e1c\u897f\u6765\u5bf9\u5176\u8fdb\u884c\u5e95\u5c42\u7684\u78c1\u76d8\u7ba1\u7406\u64cd\u4f5c\u3002\u6bd4\u5982\u8bf4\u6211\u589e\u52a0\u4e00\u4e2a\u7269\u7406\u786c\u76d8\uff0c\u8fd9\u4e2a\u65f6\u5019\u4e0a\u5c42\u7684\u670d\u52a1\u662f\u611f\u89c9\u4e0d\u5230\u7684\uff0c\u56e0\u4e3a\u5448\u73b0\u7ed9\u4e0a\u6b21\u670d\u52a1\u7684\u662f\u4ee5\u903b\u8f91\u5377\u7684\u65b9\u5f0f\u3002</p> <p>LVM\u6700\u5927\u7684\u7279\u70b9\u5c31\u662f\u53ef\u4ee5\u5bf9\u78c1\u76d8\u8fdb\u884c\u52a8\u6001\u7ba1\u7406\u3002\u56e0\u4e3a\u903b\u8f91\u5377\u7684\u5927\u5c0f\u662f\u53ef\u4ee5\u52a8\u6001\u8c03\u6574\u7684\uff0c\u800c\u4e14\u4e0d\u4f1a\u4e22\u5931\u73b0\u6709\u7684\u6570\u636e\u3002\u6211\u4eec\u5982\u679c\u65b0\u589e\u52a0\u4e86\u786c\u76d8\uff0c\u5176\u4e5f\u4e0d\u4f1a\u6539\u53d8\u73b0\u6709\u4e0a\u5c42\u7684\u903b\u8f91\u5377\u3002\u4f5c\u4e3a\u4e00\u4e2a\u52a8\u6001\u78c1\u76d8\u7ba1\u7406\u673a\u5236\uff0c\u903b\u8f91\u5377\u6280\u672f\u5927\u5927\u63d0\u9ad8\u4e86\u78c1\u76d8\u7ba1\u7406\u7684\u7075\u6d3b\u6027\uff01\uff01\uff01</p>"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#lvm_1","title":"\u4e09\u3001LVM\u7684\u539f\u7406","text":"<p>\u8981\u60f3\u7406\u89e3\u597dLVM\u7684\u539f\u7406\uff0c\u6211\u4eec\u5fc5\u987b\u9996\u5148\u8981\u638c\u63e14\u4e2a\u57fa\u672c\u7684\u903b\u8f91\u5377\u6982\u5ff5\u3002</p> <ul> <li>\u2460PE  (Physical Extend)  \u7269\u7406\u62d3\u5c55</li> <li>\u2461PV  (Physical Volume)  \u7269\u7406\u5377</li> <li>\u2462VG  (Volume Group)     \u5377\u7ec4</li> <li>\u2463LV  (Logical Volume)   \u903b\u8f91\u5377</li> </ul> <p>\u6211\u4eec\u77e5\u9053\u5728\u4f7f\u7528LVM\u5bf9\u78c1\u76d8\u8fdb\u884c\u52a8\u6001\u7ba1\u7406\u4ee5\u540e\uff0c\u6211\u4eec\u662f\u4ee5\u903b\u8f91\u5377\u7684\u65b9\u5f0f\u5448\u73b0\u7ed9\u4e0a\u5c42\u7684\u670d\u52a1\u7684\u3002\u6240\u4ee5\u6211\u4eec\u6240\u6709\u7684\u64cd\u4f5c\u76ee\u7684\uff0c\u5176\u5b9e\u5c31\u662f\u53bb\u521b\u5efa\u4e00\u4e2aLV(Logical Volume),\u903b\u8f91\u5377\u5c31\u662f\u7528\u6765\u53d6\u4ee3\u6211\u4eec\u4e4b\u524d\u7684\u5206\u533a\uff0c\u6211\u4eec\u901a\u8fc7\u5bf9\u903b\u8f91\u5377\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u7136\u540e\u8fdb\u884c\u6302\u8f7d\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002\u90a3\u4e48LVM\u7684\u5de5\u4f5c\u539f\u7406\u662f\u4ec0\u4e48\u5462\uff1f\u6240\u8c13\u65e0\u56fe\u65e0\u771f\u76f8\uff0c\u54b1\u4eec\u4e0b\u9762\u901a\u8fc7\u56fe\u6765\u5bf9\u903b\u8f91\u5377\u7684\u539f\u7406\u8fdb\u884c\u89e3\u91ca\uff01\uff01</p> <p></p>"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#1pvphysical-volume","title":"1.\u5c06\u6211\u4eec\u7684\u7269\u7406\u786c\u76d8\u683c\u5f0f\u5316\u6210PV(Physical Volume)","text":"<p>\u6211\u4eec\u770b\u5230\uff0c\u8fd9\u91cc\u6709\u4e24\u5757\u786c\u76d8\uff0c\u4e00\u5757\u662fsda\uff0c\u53e6\u4e00\u5757\u662fsdb\uff0c\u5728LVM\u78c1\u76d8\u7ba1\u7406\u91cc\uff0c\u6211\u9996\u5148\u8981\u5c06\u8fd9\u4e24\u5757\u786c\u76d8\u683c\u5f0f\u5316\u4e3a\u6211\u4eec\u7684PV(Physical Volume),\u4e5f\u5c31\u662f\u6211\u4eec\u7684\u7269\u7406\u5377\uff0c\u5176\u5b9e\u683c\u5f0f\u5316\u7269\u7406\u5377\u7684\u8fc7\u7a0b\u4e2dLVM\u662f\u5c06\u5e95\u5c42\u7684\u786c\u76d8\u5212\u5206\u4e3a\u4e86\u4e00\u4e2a\u4e00\u4e2a\u7684PE(Physical Extend),<code>\u6211\u4eec\u7684LVM\u78c1\u76d8\u7ba1\u7406\u4e2dPE\u7684\u9ed8\u8ba4\u5927\u5c0f\u662f4M\u5927\u5c0f</code>\uff0c\u5176\u5b9ePE\u5c31\u662f\u6211\u4eec\u903b\u8f91\u5377\u7ba1\u7406\u7684\u6700\u57fa\u672c\u5355\u4f4d\u3002\u6bd4\u5982\u8bf4\u6211\u6709\u4e00\u4e2a400M\u7684\u786c\u76d8\uff0c\u90a3\u4e48\u5728\u5c06\u5176\u683c\u5f0f\u5316\u6210PV\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u9645\u5c31\u662f\u5c06\u8fd9\u5757\u7269\u7406\u786c\u76d8\u5212\u5206\u6210\u4e86100\u4e2a\u7684PE\uff0c\u56e0\u4e3aPE\u9ed8\u8ba4\u7684\u5927\u5c0f\u5c31\u662f4M\u3002\u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u7684\u7b2c\u4e00\u6b65\u64cd\u4f5c\u3002</p>"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#2vgvolume-group","title":"2.\u521b\u5efa\u4e00\u4e2aVG(Volume Group)","text":"<p>\u5728\u5c06\u786c\u76d8\u683c\u5f0f\u5316\u6210PV\u4ee5\u540e\uff0c\u6211\u4eec\u7b2c\u4e8c\u6b65\u64cd\u4f5c\u5c31\u662f\u521b\u5efa\u4e00\u4e2a\u5377\u7ec4\uff0c\u4e5f\u5c31\u662fVG(Volume Group),\u5377\u7ec4\u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u62bd\u8c61\u5316\u6210\u4e00\u4e2a\u7a7a\u95f4\u6c60\uff0cVG\u7684\u4f5c\u7528\u5c31\u662f\u7528\u6765\u88c5PE\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u4e2a\u6216\u8005\u591a\u4e2aPV\u52a0\u5230VG\u5f53\u4e2d\uff0c\u56e0\u4e3a\u5728\u7b2c\u4e00\u6b65\u64cd\u4f5c\u65f6\u5c31\u5df2\u7ecf\u5c06\u8be5\u786c\u76d8\u5212\u5206\u6210\u4e86\u591a\u4e2aPE\uff0c\u6240\u4ee5\u5c06\u591a\u4e2aPV\u52a0\u5230VG\u91cc\u9762\u540e\uff0cVG\u91cc\u9762\u5c31\u5b58\u653e\u4e86\u8bb8\u8bb8\u591a\u591a\u6765\u81ea\u4e0d\u540cPV\u4e2d\u7684PE\uff0c\u6211\u4eec\u901a\u8fc7\u4e0a\u9762\u7684\u56fe\u7247\u5c31\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u683c\u5f0f\u5316\u4e86\u4e24\u5757\u786c\u76d8\uff0c\u6bcf\u4e2a\u786c\u76d8\u5206\u522b\u683c\u5f0f\u5316\u6210\u4e863\u4e2aPE\uff0c\u7136\u540e\u5c06\u4e24\u5757\u786c\u76d8\u7684PE\u90fd\u52a0\u5230\u4e86\u6211\u4eec\u7684VG\u5f53\u4e2d\uff0c\u90a3\u4e48\u6211\u4eec\u7684VG\u5f53\u4e2d\u5c31\u5305\u542b\u4e866\u4e2aPE\uff0c\u8fd96\u4e2aPE\u5c31\u662f\u4e24\u4e2a\u786c\u76d8\u7684PE\u4e4b\u548c\u3002\u901a\u5e38\u521b\u5efa\u4e00\u4e2a\u5377\u7ec4\u7684\u65f6\u5019\u6211\u4eec\u4f1a\u4e3a\u5176\u53d6\u4e00\u4e2a\u540d\u5b57\uff0c\u4e5f\u5c31\u662f\u8be5VG\u7684\u540d\u5b57\u3002</p>"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#3vglvlogical-volume","title":"3.\u57fa\u4e8eVG\u521b\u5efa\u6211\u4eec\u6700\u540e\u8981\u4f7f\u7528\u7684LV(Logical Volume)","text":"<p>\u3010\u6ce8\u610f\u3011PV\u4ee5\u53caVG\u521b\u5efa\u597d\u4ee5\u540e\u6211\u4eec\u662f\u4e0d\u80fd\u591f\u76f4\u63a5\u4f7f\u7528\u7684\uff0c\u56e0\u4e3aPV\u3001VG\u662f\u6211\u4eec\u903b\u8f91\u5377\u5e95\u5c42\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u5176\u5b9e\u6700\u540e\u4f7f\u7528\u7684\u662f\u5728VG\u57fa\u7840\u4e0a\u521b\u5efa\u7684LV(Logical Volume),\u6240\u4ee5\u7b2c\u4e09\u6b65\u64cd\u4f5c\u5c31\u662f\u57fa\u4e8eVG\u6765\u521b\u5efa\u6211\u4eec\u6700\u7ec8\u8981\u4f7f\u7528\u7684LV\u3002</p> <p>\u5f53\u6211\u4eec\u521b\u5efa\u597d\u6211\u4eec\u7684VG\u4ee5\u540e\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u521b\u5efaLV\u5176\u5b9e\u5c31\u662f\u4eceVG\u4e2d\u62ff\u51fa\u6211\u4eec\u6307\u5b9a\u6570\u91cf\u7684PE\uff0c\u8fd8\u662f\u62ff\u4e0a\u56fe\u6765\u8bf4\uff0c\u6211\u4eec\u770b\u5230\u6211\u4eec\u6b64\u65f6\u7684VG\u91cc\u9762\u5df2\u7ecf\u62e5\u6709\u4e866\u4e2aPE\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u521b\u5efa\u4e86\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u903b\u8f91\u5377\uff0c\u5b83\u7684\u5927\u5c0f\u662f4\u4e2aPE\u7684\u5927\u5c0f\uff0c\u4e5f\u5c31\u662f16M(<code>\u56e0\u4e3a\u4e00\u4e2aPE\u7684\u9ed8\u8ba4\u5927\u5c0f\u662f4M</code>)\uff0c\u800c\u8fd94\u4e2aPE\u6709\u4e09\u4e2a\u662f\u6765\u81ea\u4e8e\u7b2c\u4e00\u5757\u786c\u76d8\uff0c\u800c\u53e6\u5916\u4e00\u4e2aPE\u5219\u662f\u6765\u81ea\u7b2c\u4e8c\u5757\u786c\u76d8\u3002\u5f53\u6211\u4eec\u521b\u5efa\u7b2c\u4e8c\u4e2a\u903b\u8f91\u5377\u65f6\uff0c\u5b83\u7684\u5927\u5c0f\u5c31\u6700\u591a\u53ea\u6709\u4e24\u4e2aPE\u7684\u5927\u5c0f\u4e86\uff0c\u56e0\u4e3a\u5176\u4e2d\u76844\u4e2aPE\u5df2\u7ecf\u5206\u914d\u7ed9\u4e86\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u903b\u8f91\u5377\u3002</p> <p><code>\u6240\u4ee5\u521b\u5efa\u903b\u8f91\u5377\u5176\u5b9e\u5c31\u662f\u6211\u4eec\u4eceVG\u4e2d\u62ff\u51fa\u6211\u4eec\u6307\u5b9a\u6570\u91cf\u7684PE\uff0cVG\u4e2d\u7684PE\u53ef\u4ee5\u6765\u81ea\u4e0d\u540c\u7684PV\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u7684\u903b\u8f91\u5377\u7684\u5927\u5c0f\u53d6\u51b3\u4e8eVG\u5f53\u4e2dPE\u5b58\u5728\u7684\u6570\u91cf\uff0c\u5e76\u4e14\u6211\u4eec\u521b\u5efa\u7684\u903b\u8f91\u5377\u5176\u5927\u5c0f\u4e00\u5b9a\u662fPE\u7684\u6574\u6570\u500d(\u5373\u903b\u8f91\u5377\u7684\u5927\u5c0f\u4e00\u5b9a\u8981\u662f4M\u7684\u6574\u6570\u500d)\u3002</code></p>"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#4lv","title":"4.\u5c06\u6211\u4eec\u521b\u5efa\u597d\u7684LV\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\uff0c\u7136\u540e\u6302\u8f7d\u4f7f\u7528","text":"<p>\u5728\u521b\u5efa\u597dLV\u4ee5\u540e\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u80fd\u591f\u5bf9\u5176\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\u4e86\uff0c\u6211\u4eec\u6700\u7ec8\u4f7f\u7528\u7684\u5c31\u662f\u6211\u4eec\u521a\u521b\u5efa\u597d\u7684LV\uff0c\u5176\u5c31\u76f8\u5f53\u4e8e\u4f20\u7edf\u7684\u6587\u4ef6\u7ba1\u7406\u7684\u5206\u533a\uff0c\u6211\u4eec\u9996\u5148\u8981\u5bf9\u5176\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\u64cd\u4f5c\uff0c\u7136\u540e\u901a\u8fc7mount\u547d\u4ee4\u5bf9\u5176\u8fdb\u884c\u6302\u8f7d\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u80fd\u591f\u50cf\u4f7f\u7528\u5e73\u5e38\u7684\u5206\u533a\u4e00\u6837\u6765\u4f7f\u7528\u6211\u4eec\u7684\u903b\u8f91\u5377\u4e86\u3002</p> <p>\u6211\u4eec\u5728\u521b\u5efa\u597dLV\u4ee5\u540e\uff0c\u6211\u4eec\u4f1a\u5728 <code>/dev</code> \u76ee\u5f55\u4e0b\u770b\u5230\u6211\u4eec\u7684LV\u4fe1\u606f\uff0c\u4f8b\u5982 <code>/dev/vgname/lvname</code>\uff0c \u6211\u4eec\u6bcf\u521b\u5efa\u4e00\u4e2aVG\uff0c\u5176\u4f1a\u5728<code>/dev</code>\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u4ee5\u8be5VG\u540d\u5b57\u547d\u540d\u7684\u6587\u4ef6\u5939\uff0c\u5728\u8be5VG\u7684\u57fa\u7840\u4e0a\u521b\u5efa\u597dLV\u4ee5\u540e\uff0c\u6211\u4eec\u4f1a\u5728\u8fd9\u4e2aVG\u76ee\u5f55\u4e0b\u591a\u51fa\u4e00\u4e2a\u4ee5LV\u540d\u5b57\u547d\u540d\u7684\u903b\u8f91\u5377\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u6765\u5bf9\u6574\u4e2aLVM\u7684\u5de5\u4f5c\u539f\u7406\u8fdb\u884c\u4e00\u4e2a\u603b\u7ed3\uff1a</p> <ul> <li>(1)\u7269\u7406\u78c1\u76d8\u88ab\u683c\u5f0f\u5316\u4e3aPV\uff0c\u7a7a\u95f4\u88ab\u5212\u5206\u4e3a\u4e00\u4e2a\u4e2a\u7684PE</li> <li>(2)\u4e0d\u540c\u7684PV\u52a0\u5165\u5230\u540c\u4e00\u4e2aVG\u4e2d\uff0c\u4e0d\u540cPV\u7684PE\u5168\u90e8\u8fdb\u5165\u5230\u4e86VG\u7684PE\u6c60\u5185</li> <li>(3)LV\u57fa\u4e8ePE\u521b\u5efa\uff0c\u5927\u5c0f\u4e3aPE\u7684\u6574\u6570\u500d\uff0c\u7ec4\u6210LV\u7684PE\u53ef\u80fd\u6765\u81ea\u4e0d\u540c\u7684\u7269\u7406\u78c1\u76d8</li> <li>(4)LV\u73b0\u5728\u5c31\u76f4\u63a5\u53ef\u4ee5\u683c\u5f0f\u5316\u540e\u6302\u8f7d\u4f7f\u7528\u4e86</li> <li>(5)LV\u7684\u6269\u5145\u7f29\u51cf\u5b9e\u9645\u4e0a\u5c31\u662f\u589e\u52a0\u6216\u51cf\u5c11\u7ec4\u6210\u8be5LV\u7684PE\u6570\u91cf\uff0c\u5176\u8fc7\u7a0b\u4e0d\u4f1a\u4e22\u5931\u539f\u59cb\u6570\u636e</li> </ul> <p></p> <p>\u6211\u4eec\u770b\u5230\uff0c\u6211\u4eec\u8fd9\u91cc\u5982\u679c\u8981\u5bf9LV\u8fdb\u884c\u6269\u5145\uff0c\u76f4\u63a5\u52a0\u8fdb\u6765\u4e00\u5757sdc\u786c\u76d8\uff0c\u7136\u540e\u5c06\u5176\u683c\u5f0f\u5316\u6210PE\uff0c\u7136\u540e\u5c06\u8be5PV\u52a0\u5165\u5230\u4e86VG\u5f53\u4e2d\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0LV\u4e2dPE\u7684\u6570\u91cf\u6765\u52a8\u6001\u7684\u5bf9LV\u8fdb\u884c\u6269\u5145\u4e86\uff0c\u53ea\u8981\u6211\u4eec\u7684LV\u7684\u5927\u5c0f\u4e0d\u8981\u8d85\u8fc7\u6211\u4eecVG\u7a7a\u4f59\u7a7a\u95f4\u7684\u5927\u5c0f\u5c31\u884c\u4e86\uff01\uff01</p>"},{"location":"Linux-Performance/","title":"Linux Performance","text":""},{"location":"Linux-Performance/#linux-performance","title":"Linux Performance","text":"<ul> <li>\u539f\u6587</li> </ul>"},{"location":"Linux-Performance/#linux_observability_tools","title":"linux_observability_tools","text":""},{"location":"Linux-Performance/#linux_benchmarking_tools","title":"linux_benchmarking_tools","text":""},{"location":"Linux-Performance/#linux_tuning_tools","title":"linux_tuning_tools","text":""},{"location":"Linux-Performance/#linux_static_tools","title":"linux_static_tools","text":""},{"location":"Linux-Performance/#linux_observability_sar","title":"linux_observability_sar","text":""},{"location":"Linux-Performance/#perf-tools_2016","title":"perf-tools_2016","text":""},{"location":"Linux-Performance/#bcc_tracing_tools","title":"bcc_tracing_tools","text":""},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/","title":"Linux shell \u903b\u8f91\u8fd0\u7b97\u7b26\u3001\u903b\u8f91\u8868\u8fbe\u5f0f\u8be6\u89e3","text":"<ul> <li>Google \u5f00\u6e90\u9879\u76ee\u98ce\u683c\u6307\u5357</li> <li>https://zh-google-styleguide.readthedocs.io/en/latest/google-shell-styleguide/contents/</li> </ul>"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#shell","title":"shell\u7684\u903b\u8f91\u8fd0\u7b97\u7b26 \u6d89\u53ca\u6709\u4ee5\u4e0b\u51e0\u79cd\u7c7b\u578b\uff0c\u56e0\u6b64\u53ea\u8981\u9002\u5f53\u9009\u62e9\uff0c\u53ef\u4ee5\u89e3\u51b3\u6211\u4eec\u5f88\u591a\u590d\u6742\u7684\u5224\u65ad\uff0c\u8fbe\u5230\u4e8b\u534a\u529f\u500d\u6548\u679c\u3002","text":""},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#_1","title":"\u4e00\u3001\u903b\u8f91\u8fd0\u7b97\u7b26","text":""},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#1","title":"1\u3001\u903b\u8f91\u5377\u6807\u8868\u793a\u610f\u601d","text":"<ol> <li>\u5173\u4e8e\u6863\u6848\u4e0e\u76ee\u5f55\u7684\u4fa6\u6d4b\u903b\u8f91\u5377\u6807</li> </ol> <pre><code>    -f \u5e38\u7528\uff01\u4fa6\u6d4b\u300e\u6863\u6848\u300f\u662f\u5426\u5b58\u5728 eg: if [ -f filename ]\n\n    -d \u5e38\u7528\uff01\u4fa6\u6d4b\u300e\u76ee\u5f55\u300f\u662f\u5426\u5b58\u5728\n\n    -b \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e block \u6863\u6848\u300f\n\n    -c \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e character \u6863\u6848\u300f\n\n    -S \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e socket \u6807\u7b7e\u6863\u6848\u300f\n\n    -L \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e symbolic link \u7684\u6863\u6848\u300f\n\n    -e \u4fa6\u6d4b\u300e\u67d0\u4e2a\u4e1c\u897f\u300f\u662f\u5426\u5b58\u5728\uff01\n</code></pre> <ol> <li>\u5173\u4e8e\u7a0b\u5e8f\u7684\u903b\u8f91\u5377\u6807</li> </ol> <pre><code>    -G \u4fa6\u6d4b\u662f\u5426\u7531 GID \u6240\u6267\u884c\u7684\u7a0b\u5e8f\u6240\u62e5\u6709\n\n    -O \u4fa6\u6d4b\u662f\u5426\u7531 UID \u6240\u6267\u884c\u7684\u7a0b\u5e8f\u6240\u62e5\u6709\n\n    -p \u4fa6\u6d4b\u662f\u5426\u4e3a\u7a0b\u5e8f\u95f4\u4f20\u9001\u4fe1\u606f\u7684 name pipe \u6216\u662f FIFO \uff08\u8001\u5b9e\u8bf4\uff0c\u8fd9\u4e2a\u4e0d\u592a\u61c2\uff01\uff09\n</code></pre> <ol> <li>\u5173\u4e8e\u6863\u6848\u7684\u5c5e\u6027\u4fa6\u6d4b</li> </ol> <pre><code>    -r \u4fa6\u6d4b\u662f\u5426\u4e3a\u53ef\u8bfb\u7684\u5c5e\u6027\n\n    -w \u4fa6\u6d4b\u662f\u5426\u4e3a\u53ef\u4ee5\u5199\u5165\u7684\u5c5e\u6027\n\n    -x \u4fa6\u6d4b\u662f\u5426\u4e3a\u53ef\u6267\u884c\u7684\u5c5e\u6027\n\n    -s \u4fa6\u6d4b\u662f\u5426\u4e3a\u300e\u975e\u7a7a\u767d\u6863\u6848\u300f\n\n    -u \u4fa6\u6d4b\u662f\u5426\u5177\u6709\u300e SUID \u300f\u7684\u5c5e\u6027\n\n    -g \u4fa6\u6d4b\u662f\u5426\u5177\u6709\u300e SGID \u300f\u7684\u5c5e\u6027\n\n    -k \u4fa6\u6d4b\u662f\u5426\u5177\u6709\u300e sticky bit \u300f\u7684\u5c5e\u6027\n</code></pre> <ol> <li>\u4e24\u4e2a\u6863\u6848\u4e4b\u95f4\u7684\u5224\u65ad\u4e0e\u6bd4\u8f83 \uff1b\u4f8b\u5982[ test file1 -nt file2 ]</li> </ol> <pre><code>    -nt \u7b2c\u4e00\u4e2a\u6863\u6848\u6bd4\u7b2c\u4e8c\u4e2a\u6863\u6848\u65b0\n\n    -ot \u7b2c\u4e00\u4e2a\u6863\u6848\u6bd4\u7b2c\u4e8c\u4e2a\u6863\u6848\u65e7\n\n    -ef \u7b2c\u4e00\u4e2a\u6863\u6848\u4e0e\u7b2c\u4e8c\u4e2a\u6863\u6848\u4e3a\u540c\u4e00\u4e2a\u6863\u6848\uff08 link \u4e4b\u7c7b\u7684\u6863\u6848\uff09\n</code></pre> <ol> <li>\u903b\u8f91\u7684\u300e\u548c(and)\u300f\u300e\u6216(or)\u300f</li> </ol> <pre><code>    &amp;&amp; \u903b\u8f91\u7684 AND \u7684\u610f\u601d\n\n    || \u903b\u8f91\u7684 OR \u7684\u610f\u601d\n</code></pre>"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#2","title":"2\u3001\u8fd0\u7b97\u7b26\u53f7 \u4ee3\u8868\u610f\u4e49","text":"<pre><code>=   \u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6216\u5b57\u7b26\u4e32\u6bd4\u8f83 \u5982\u679c\u5728[] \u4e2d\uff0c\u53ea\u80fd\u662f\u5b57\u7b26\u4e32\n\n!=  \u4e0d\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6216\u5b57\u7b26\u4e32\u6bd4\u8f83 \u5982\u679c\u5728[] \u4e2d\uff0c\u53ea\u80fd\u662f\u5b57\u7b26\u4e32\n\n&lt;   \u5c0f\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 \u5728[] \u4e2d\uff0c\u4e0d\u80fd\u4f7f\u7528 \u8868\u793a\u5b57\u7b26\u4e32\n\n&gt;   \u5927\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 \u5728[] \u4e2d\uff0c\u4e0d\u80fd\u4f7f\u7528 \u8868\u793a\u5b57\u7b26\u4e32\n\n-eq \u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83\n\n-ne \u4e0d\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83\n\n-lt \u5c0f\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83\n\n-gt \u5927\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83\n\n-le \u5c0f\u4e8e\u6216\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83\n\n-ge \u5927\u4e8e\u6216\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83\n\n-a  \u53cc\u65b9\u90fd\u6210\u7acb\uff08and\uff09 \u903b\u8f91\u8868\u8fbe\u5f0f \u2013a \u903b\u8f91\u8868\u8fbe\u5f0f\n\n-o  \u5355\u65b9\u6210\u7acb\uff08or\uff09 \u903b\u8f91\u8868\u8fbe\u5f0f \u2013o \u903b\u8f91\u8868\u8fbe\u5f0f\n\n-z  \u7a7a\u5b57\u7b26\u4e32\n\n-n  \u975e\u7a7a\u5b57\u7b26\u4e32\n</code></pre>"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#_2","title":"\u4e8c\u3001\u903b\u8f91\u8868\u8fbe\u5f0f","text":""},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#1-test","title":"1. test \u547d\u4ee4","text":"<ul> <li>\u4f7f\u7528\u65b9\u6cd5\uff1atest EXPRESSION</li> </ul> <pre><code>  [root@localhost ~]# test 1 = 1 &amp;&amp; echo 'ok'\n  ok\n\n  [root@localhost ~]# test -d /etc/ &amp;&amp; echo 'ok'\n  ok\n\n  [root@localhost ~]# test 1 -eq 1 &amp;&amp; echo 'ok'\n  ok\n\n  [root@localhost ~]# if test 1 = 1 ; then echo 'ok'; fi\n  ok\n</code></pre>"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#_3","title":"\u6ce8\u610f\uff1a\u6240\u6709\u5b57\u7b26 \u4e0e\u903b\u8f91\u8fd0\u7b97\u7b26\u76f4\u63a5\u7528\u201c\u7a7a\u683c\u201d\u5206\u5f00\uff0c\u4e0d\u80fd\u8fde\u5230\u4e00\u8d77\u3002","text":""},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#2_1","title":"2. \u7cbe\u7b80\u8868\u8fbe\u5f0f","text":"<ul> <li>[] \u8868\u8fbe\u5f0f</li> </ul> <pre><code>  [root@localhost ~]# [ 1 -eq 1 ] &amp;&amp; echo 'ok'\n  ok\n\n  [root@localhost ~]# [ 2 &lt; 1 ] &amp;&amp; echo 'ok'\n  -bash: 2: No such file or directory\n\n  [root@localhost ~]# [ 2 &lt; 1 ] &amp;&amp; echo 'ok'\n\n  [root@localhost ~]# [ 2 -gt 1 -a 3 -lt 4 ] &amp;&amp; echo 'ok'\n  ok\n\n  [root@localhost ~]# [ 2 -gt 1 &amp;&amp; 3 -lt 4 ] &amp;&amp; echo 'ok'\n  -bash: [: missing `]'\n</code></pre>"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#acill-aand-oor","title":"\u6ce8\u610f\uff1a\u5728<code>[]</code>\u8868\u8fbe\u5f0f\u4e2d\uff0c\u5e38\u89c1\u7684<code>&gt;,&lt;</code>\u9700\u8981\u52a0\u8f6c\u4e49\u5b57\u7b26\uff0c\u8868\u793a\u5b57\u7b26\u4e32\u5927\u5c0f\u6bd4\u8f83\uff0c\u4ee5acill\u7801 \u4f4d\u7f6e\u4f5c\u4e3a\u6bd4\u8f83\u3002 \u4e0d\u76f4\u63a5\u652f\u6301<code>&lt;&gt;</code>\u8fd0\u7b97\u7b26\uff0c\u8fd8\u6709\u903b\u8f91\u8fd0\u7b97\u7b26<code>||</code> <code>&amp;&amp;</code> \u5b83\u9700\u8981\u7528<code>-a[and]</code> <code>\u2013o[or]</code>\u8868\u793a","text":"<ul> <li>[[]] \u8868\u8fbe\u5f0f</li> </ul> <pre><code>  [root@localhost ~]# [ 1 -eq 1 ] &amp;&amp; echo 'ok'\n  ok\n\n  [root@localhost ~]$ [[ 2 &lt; 3 ]] &amp;&amp; echo 'ok'\n  ok\n\n  [root@localhost ~]$ [[ 2 &lt; 3 &amp;&amp; 4 &gt; 5 ]] &amp;&amp; echo 'ok'\n  ok\n</code></pre>"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#_4","title":"\u6ce8\u610f\uff1a<code>[[]]</code> \u8fd0\u7b97\u7b26\u53ea\u662f<code>[]</code>\u8fd0\u7b97\u7b26\u7684\u6269\u5145\u3002\u80fd\u591f\u652f\u6301<code>&lt;,&gt;</code>\u7b26\u53f7\u8fd0\u7b97\u4e0d\u9700\u8981\u8f6c\u4e49\u7b26\uff0c\u5b83\u8fd8\u662f\u4ee5\u5b57\u7b26\u4e32\u6bd4\u8f83\u5927\u5c0f\u3002\u91cc\u9762\u652f\u6301\u903b\u8f91\u8fd0\u7b97\u7b26\uff1a<code>||</code> <code>&amp;&amp;</code>","text":""},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#3","title":"3. \u6027\u80fd\u6bd4\u8f83","text":""},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#bashtestif-thenabs","title":"bash\u7684\u6761\u4ef6\u8868\u8fbe\u5f0f\u4e2d\u6709\u4e09\u4e2a\u51e0\u4e4e\u7b49\u6548\u7684\u7b26\u53f7\u548c\u547d\u4ee4\uff1a<code>test</code>\uff0c<code>[]</code>\u548c<code>[[]]</code>\u3002\u901a\u5e38\uff0c\u5927\u5bb6\u4e60\u60ef\u7528<code>if [];then</code>\u8fd9\u6837\u7684\u5f62\u5f0f\u3002\u800c<code>[[]]</code>\u7684\u51fa\u73b0\uff0c\u6839\u636eABS\u6240\u8bf4\uff0c\u662f\u4e3a\u4e86\u517c\u5bb9<code>&gt;&lt;</code>\u4e4b\u7c7b\u7684\u8fd0\u7b97\u7b26\u3002\u4ee5\u4e0b\u662f\u6bd4\u8f83\u5b83\u4eec\u6027\u80fd\uff0c\u53d1\u73b0<code>[[]]</code>\u662f\u6700\u5feb\u7684\u3002","text":"<pre><code>  $ time (for m in {1..100000}; do test -d .;done;)\n  real 0m0.658s\n  user 0m0.558s\n  sys 0m0.100s\n\n  $ time (for m in {1..100000}; do [ -d . ];done;)\n  real 0m0.609s\n  user 0m0.524s\n  sys 0m0.085s\n\n  $ time (for m in {1..100000}; do [[ -d . ]];done;)\n  real 0m0.311s\n  user 0m0.275s\n  sys 0m0.036s\n</code></pre>"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#bashsh","title":"\u4e0d\u8003\u8651\u5bf9\u4f4e\u7248\u672cbash\u548c\u5bf9sh\u7684\u517c\u5bb9\u7684\u60c5\u51b5\u4e0b\uff0c\u7528<code>[[]]</code>\u662f\u517c\u5bb9\u6027\u5f3a\uff0c\u800c\u4e14\u6027\u80fd\u6bd4\u8f83\u5feb\uff0c\u5728\u505a\u6761\u4ef6\u8fd0\u7b97\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u8fd0\u7b97\u7b26","text":""},{"location":"MB-MiB%E7%9A%84%E5%8C%BA%E5%88%AB/","title":"MB_MiB\u7684\u533a\u522b","text":"<ul> <li>\u539f\u6587</li> </ul> <p>\u8bf4\u5b9e\u8bdd\u8fd9\u51e0\u4e2a\u5355\u4f4d\u5f88\u591a\u4eba\u4f1a\u5f04\u6df7\uff0c\u5148\u653e\u4e0a\u76f4\u89c2\u7684\u5bf9\u5e94\u8868\uff1a</p> <p>1KB = 1,000 Byte 1MB = 1,000 KB 1GB = 1,000,000 KB 1TB = 1,000,000,000 KB</p> <p>1KiB = 1,024Byte 1MiB = 1,024KiB 1GiB = 1,024MiB = 1,048,576 KiB 1TiB = 1,024GiB = 1,073,741,824 KiB</p> <p>\u5176\u4e2d\uff0cKiB\u662fkilo binary byte\u7684\u7f29\u5199\uff0c\u6307\u7684\u662f\u5343\u4f4d\u4e8c\u8fdb\u5236\u5b57\u8282</p> <p>\u800cKB\u662fkilobyte\u7684\u7f29\u5199\uff0c\u6307\u7684\u662f\u5343\u5b57\u8282</p> <p>\u4e8c\u8005\u7684\u533a\u522b\u5c31\u5728\u4e8e\u5f53\u4e2d\u7684\u4e8c\u8fdb\u5236\u3002\u6211\u60f3\u8bf4\u9053\u8fd9\u91cc\u5927\u90e8\u5206\u4eba\u5e94\u8be5\u90fd\u660e\u767d\u4e3a\u5565KiB\u662f\u6309\u71671024\u6362\u7b97\u7684\u4e86\u3002\u8fd8\u8bb0\u5f97\u90a3\u4e2a\u7b11\u8bdd\u4e48\uff0cA\u95ee\u7a0b\u5e8f\u5458B\u501f\u94b1\uff1a</p> <p>A\uff1aB\uff0c\u501f\u6211\u70b9\u94b1\u5427\uff01</p> <p>B\uff1a\u591a\u5c11\uff1f A\uff1a1000\u884c\u4e0d\uff1f</p> <p>B\uff1a\u51d1\u4e2a\u6574\uff0c\u7ed9\u4f601024\u5427\uff01</p> <p>\u518d\u8bf4\u6df1\u5165\u4e00\u70b9\uff0c\u8fd9\u5176\u4e2d\u5176\u5b9e\u7275\u626f\u4e86\u4e24\u79cd\u6807\u51c6\uff1a</p> <p>\u56fd\u9645\u5355\u4f4d\u5236 SI \u5236\u5b9a\u7684\u5341\u8fdb\u5236\u6807\u51c6\u548c \u56fd\u9645\u7535\u5de5\u59d4\u5458\u4f1a \u5236\u5b9a\u7684\u4e8c\u8fdb\u5236\u6807\u51c6\uff0c\u4e5f\u5c31\u662f\u901a\u5e38\u6240\u8bf4\u7684SI\u548cIEC\u6807\u51c6\u3002</p> <p>============================================================= \u770b\u4e86\u533f\u540d\u7528\u6237\u7684\u56de\u590d\uff0c\u51b3\u5b9a\u6765\u8865\u5145\u4e00\u4e9b\u4e1c\u897f\u3002//\u8bdd\u8bf4\u8fd9\u79cd\u95ee\u9898\u4e3a\u5565\u8981\u533f\u540d\u5440\u6454\uff01</p> <p>\u9996\u51481KB=1000B\u7edd\u5bf9\u4e0d\u662f\u786c\u76d8\u5382\u5546\u53d1\u660e\u7684\uff0c\u4ed6\u4eec\u53ea\u662f\u5229\u7528\u8005\uff0c\u55ef\u55ef\u3002</p> <p>\u7136\u540e\uff0c\u5173\u4e8e\u5927B\u548c\u5c0fb\uff0c\u533f\u540d\u7528\u6237\u89e3\u91ca\u7684\u975e\u5e38\u597d\u3002\u987a\u4fbf\u4e00\u8bf4\u4e3a\u5565\u7f51\u7edc\u4f20\u8f93\u8981\u4f7f\u7528\u5c0fb\uff0c\u56e0\u4e3a\u5728\u7f51\u7edc\u4f20\u8f93\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f20\u8f93\u7684\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u4e2a\u4e8c\u8fdb\u5236\u6570\uff0c\u4f3c\u4e4e\u53ef\u4ee5\u4fd7\u79f0\u4e3a\u6bd4\u7279\u6d41\u3002\u90a3\u4e48\uff0c\u5728\u4f20\u8f93\u4e8c\u8fdb\u5236\u6570\u7684\u65f6\u5019\uff0c\u6211\u4eec\u663e\u7136\u662f\u4e0d\u7ba1\u4f60\u8fd9\u662f\u4ec0\u4e48\u5b57\uff0c\u7528\u7684\u4ec0\u4e48\u7f16\u7801\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8861\u91cf\u4f20\u8f93\u901f\u5ea6\u7684\u6700\u76f4\u63a5\u7684\u91cf\u5c31\u662f\u6bcf\u79d2\u949f\u4f20\u8f93\u4e86\u591a\u5c11\u4e86\u4e8c\u8fdb\u5236\u4f4d\uff0c\u6240\u4ee5\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\uff0c\u6211\u4eec\u666e\u904d\u4f7f\u7528\u5c0fb\u4f5c\u4e3a\u5355\u4f4d\u3002</p> <p>\u7136\u540e\u5bf9\u4e8eta\u63d0\u51fa\u7684Windows\u7684Size\u7684\u95ee\u9898\uff0c\u8fd9\u4e2a\u5f88\u597d\u89e3\u91ca\u3002 \u9996\u5148\uff0c\u7b2c\u4e00\u4e2aSize\u663e\u7136\u662f\u7ecf\u8fc7\u820e\u5165\u7684\u3002\u8bf7\u4e0d\u8981\u7528115\u53bb\u505a\u4e58\u6cd5\uff0c\u76f4\u63a5\u7528118774\u53bb\u96641024\u5c31\u80fd\u5f97\u5230\u7ed3\u679c\uff1a115.990234375\u3002\u5173\u4e8e\u820d\u5165\u7a76\u7adf\u662f\u4ec0\u4e48\u89c4\u5219\uff0c\u6211\u8fd8\u5728\u5bfb\u627e\u76f8\u5173\u7684\u6587\u6863\uff0c\u5c31\u76ee\u524d\u6765\u770b\u4f3c\u4e4e\u662f\u76f4\u63a5\u820d\u53bb\u5c0f\u6570\u90e8\u5206\u3002</p> <p>\u7136\u540e\uff0c\u7b2c\u4e8c\u4e2aSize on Disk\u5c31\u66f4\u597d\u89e3\u91ca\u4e86\u3002\u5982\u679c\u4f60\u7528118784\u96641024\u4f1a\u53d1\u73b0\u8bf6\uff0c\u6b63\u597d\u6574\u9664\uff01\u7ed3\u679c\u5c31\u662f116\uff01\u8fd9\u662f\u4e3a\u5565\u5462\uff1f\u663e\u7136\u8fd9\u8ddf\u6587\u4ef6\u5728\u78c1\u76d8\u4e0a\u5b58\u50a8\u7684\u6700\u5c0f\u5355\u4f4d\u6709\u5173\u3002\u5728NTFS\u5206\u533a\u4e0a\uff0c\u6587\u4ef6\u5b58\u50a8\u7684\u6700\u5c0f\u533a\u5757\u662f\u7c07\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u9ed8\u8ba4\u7684\u7c07\u5927\u5c0f\u4e3a4K\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0d\u8bba\u4f60\u7684\u6587\u4ef6\u6709\u591a\u5c0f\uff0c\u5c31\u7b97\u4f60\u7684\u6587\u4ef6\u53ea\u67091b\uff0c\u5bf9\u4e0d\u8d77\uff0c\u6211\u8fd8\u662f\u8981\u5360\u7528\u4e00\u4e2a4K\u5927\u5c0f\u7684\u7c07\u3002\u4ed4\u7ec6\u4e00\u7b97\u4f60\u662f\u4e0d\u662f\u53d1\u73b0116/4\u521a\u597d\u6574\u9664\uff0c\u7b49\u4e8e29\u5462\uff1f\u8bf4\u660e\u4f60\u7684\u7cfb\u7edf\u5f88\u53ef\u80fd\u4e5f\u662f4K\u4e3a\u4e00\u4e2a\u7c07\uff0c\u7136\u540e\u8be5\u6587\u4ef6\u5360\u7528\u4e86\u4f6029\u4e2a\u7c07\u3002</p> <p>\u53c2\u8003[\u77e5\u8b58] KB KiB MB MiB GB GiB TB TiB \u55ae\u4f4d\u50bb\u50bb\u5206\u4e0d\u6e05\u695a?</p> <p>\u5343\u5b57\u8282Kibibyte</p> <p>KB, MB, GB\u4e2d\u7684K, M, G\u4ee3\u8868\u5b57\u8282\u7684\u6570\u91cf\uff0c\u81ea\u5df1\u4e5f\u5e38\u6df7\u6dc6\uff0c\u603b\u7ed3\u5982\u4e0b\uff1a</p> <ol> <li>K\u5355\u72ec\u51fa\u73b0\u65f6\uff0c\u4ee3\u88681000 \u6216 1024</li> <li>K\u4e0eKi\u4e00\u8d77\u51fa\u73b0\u65f6\uff0cK\u4ee3\u88681000\uff0cKi\u4ee3\u88681024</li> <li>K\u4e0ek\u4e00\u8d77\u51fa\u73b0\u65f6\uff0cK\u4ee3\u88681024\uff0ck\u4ee3\u88681000</li> </ol> <p>K\u548cKi\u4e3a\u4f8b\uff1a</p> <pre><code>1K=10^3\n1M=10^3K=10^6\n1G=10^3M=10^9\n\nKi=2^10\nMi=2^10Ki=2^20\nGi=2^10Mi=2^30\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","title":"1000\u884c MySQL \u5b66\u4e60\u7b14\u8bb0\uff0c\u4e0d\u6015\u4f60\u4e0d\u4f1a\uff0c\u5c31\u6015\u4f60\u4e0d\u5b66\uff01","text":""},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#1000-mysql","title":"1000\u884c MySQL \u5b66\u4e60\u7b14\u8bb0\uff0c\u4e0d\u6015\u4f60\u4e0d\u4f1a\uff0c\u5c31\u6015\u4f60\u4e0d\u5b66\uff01","text":"<ul> <li>\u539f\u6587</li> </ul>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_1","title":"\u8fde\u63a5\u4e0e\u65ad\u5f00\u670d\u52a1\u5668","text":"<pre><code>mysql -h \u5730\u5740 -P \u7aef\u53e3 -u \u7528\u6237\u540d -p \u5bc6\u7801\n\nSHOW PROCESSLIST -- \u663e\u793a\u54ea\u4e9b\u7ebf\u7a0b\u6b63\u5728\u8fd0\u884c\nSHOW VARIABLES -- \u663e\u793a\u7cfb\u7edf\u53d8\u91cf\u4fe1\u606f\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_2","title":"\u6570\u636e\u5e93\u64cd\u4f5c","text":"<pre><code>-- \u67e5\u770b\u5f53\u524d\u6570\u636e\u5e93\n    SELECT DATABASE();\n-- \u663e\u793a\u5f53\u524d\u65f6\u95f4\u3001\u7528\u6237\u540d\u3001\u6570\u636e\u5e93\u7248\u672c\n    SELECT now(), user(), version();\n-- \u521b\u5efa\u5e93\n    CREATE DATABASE[ IF NOT EXISTS] \u6570\u636e\u5e93\u540d \u6570\u636e\u5e93\u9009\u9879\n    \u6570\u636e\u5e93\u9009\u9879\uff1a\n        CHARACTER SET charset_name\n        COLLATE collation_name\n-- \u67e5\u770b\u5df2\u6709\u5e93\n    SHOW DATABASES[ LIKE  PATTERN ]\n-- \u67e5\u770b\u5f53\u524d\u5e93\u4fe1\u606f\n    SHOW CREATE DATABASE \u6570\u636e\u5e93\u540d\n-- \u4fee\u6539\u5e93\u7684\u9009\u9879\u4fe1\u606f\n    ALTER DATABASE \u5e93\u540d \u9009\u9879\u4fe1\u606f\n-- \u5220\u9664\u5e93\n    DROP DATABASE[ IF EXISTS] \u6570\u636e\u5e93\u540d\n        \u540c\u65f6\u5220\u9664\u8be5\u6570\u636e\u5e93\u76f8\u5173\u7684\u76ee\u5f55\u53ca\u5176\u76ee\u5f55\u5185\u5bb9\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_3","title":"\u8868\u7684\u64cd\u4f5c","text":"<pre><code>-- \u521b\u5efa\u8868\n    CREATE [TEMPORARY] TABLE[ IF NOT EXISTS] [\u5e93\u540d.]\u8868\u540d ( \u8868\u7684\u7ed3\u6784\u5b9a\u4e49 )[ \u8868\u9009\u9879]\n        \u6bcf\u4e2a\u5b57\u6bb5\u5fc5\u987b\u6709\u6570\u636e\u7c7b\u578b\n        \u6700\u540e\u4e00\u4e2a\u5b57\u6bb5\u540e\u4e0d\u80fd\u6709\u9017\u53f7\n        TEMPORARY \u4e34\u65f6\u8868\uff0c\u4f1a\u8bdd\u7ed3\u675f\u65f6\u8868\u81ea\u52a8\u6d88\u5931\n        \u5bf9\u4e8e\u5b57\u6bb5\u7684\u5b9a\u4e49\uff1a\n            \u5b57\u6bb5\u540d \u6570\u636e\u7c7b\u578b [NOT NULL | NULL] [DEFAULT default_value] [AUTO_INCREMENT] [UNIQUE [KEY] | [PRIMARY] KEY] [COMMENT  string ]\n-- \u8868\u9009\u9879\n    -- \u5b57\u7b26\u96c6\n        CHARSET = charset_name\n        \u5982\u679c\u8868\u6ca1\u6709\u8bbe\u5b9a\uff0c\u5219\u4f7f\u7528\u6570\u636e\u5e93\u5b57\u7b26\u96c6\n    -- \u5b58\u50a8\u5f15\u64ce\n        ENGINE = engine_name\n        \u8868\u5728\u7ba1\u7406\u6570\u636e\u65f6\u91c7\u7528\u7684\u4e0d\u540c\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7ed3\u6784\u4e0d\u540c\u4f1a\u5bfc\u81f4\u5904\u7406\u65b9\u5f0f\u3001\u63d0\u4f9b\u7684\u7279\u6027\u64cd\u4f5c\u7b49\u4e0d\u540c\n        \u5e38\u89c1\u7684\u5f15\u64ce\uff1aInnoDB MyISAM Memory/Heap BDB Merge Example CSV MaxDB Archive\n        \u4e0d\u540c\u7684\u5f15\u64ce\u5728\u4fdd\u5b58\u8868\u7684\u7ed3\u6784\u548c\u6570\u636e\u65f6\u91c7\u7528\u4e0d\u540c\u7684\u65b9\u5f0f\n        MyISAM\u8868\u6587\u4ef6\u542b\u4e49\uff1a.frm\u8868\u5b9a\u4e49\uff0c.MYD\u8868\u6570\u636e\uff0c.MYI\u8868\u7d22\u5f15\n        InnoDB\u8868\u6587\u4ef6\u542b\u4e49\uff1a.frm\u8868\u5b9a\u4e49\uff0c\u8868\u7a7a\u95f4\u6570\u636e\u548c\u65e5\u5fd7\u6587\u4ef6\n        SHOW ENGINES -- \u663e\u793a\u5b58\u50a8\u5f15\u64ce\u7684\u72b6\u6001\u4fe1\u606f\n        SHOW ENGINE \u5f15\u64ce\u540d {LOGS|STATUS} -- \u663e\u793a\u5b58\u50a8\u5f15\u64ce\u7684\u65e5\u5fd7\u6216\u72b6\u6001\u4fe1\u606f\n    -- \u81ea\u589e\u8d77\u59cb\u6570\n        AUTO_INCREMENT = \u884c\u6570\n    -- \u6570\u636e\u6587\u4ef6\u76ee\u5f55\n        DATA DIRECTORY =  \u76ee\u5f55 \n    -- \u7d22\u5f15\u6587\u4ef6\u76ee\u5f55\n        INDEX DIRECTORY =  \u76ee\u5f55 \n    -- \u8868\u6ce8\u91ca\n        COMMENT =  string \n    -- \u5206\u533a\u9009\u9879\n        PARTITION BY ... (\u8be6\u7ec6\u89c1\u624b\u518c)\n-- \u67e5\u770b\u6240\u6709\u8868\n    SHOW TABLES[ LIKE  pattern ]\n    SHOW TABLES FROM \u8868\u540d\n-- \u67e5\u770b\u8868\u673a\u6784\n    SHOW CREATE TABLE \u8868\u540d \uff08\u4fe1\u606f\u66f4\u8be6\u7ec6\uff09\n    DESC \u8868\u540d / DESCRIBE \u8868\u540d / EXPLAIN \u8868\u540d / SHOW COLUMNS FROM \u8868\u540d [LIKE  PATTERN ]\n    SHOW TABLE STATUS [FROM db_name] [LIKE  pattern ]\n-- \u4fee\u6539\u8868\n    -- \u4fee\u6539\u8868\u672c\u8eab\u7684\u9009\u9879\n        ALTER TABLE \u8868\u540d \u8868\u7684\u9009\u9879\n        eg: ALTER TABLE \u8868\u540d ENGINE=MYISAM;\n    -- \u5bf9\u8868\u8fdb\u884c\u91cd\u547d\u540d\n        RENAME TABLE \u539f\u8868\u540d TO \u65b0\u8868\u540d\n        RENAME TABLE \u539f\u8868\u540d TO \u5e93\u540d.\u8868\u540d \uff08\u53ef\u5c06\u8868\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u6570\u636e\u5e93\uff09\n        -- RENAME\u53ef\u4ee5\u4ea4\u6362\u4e24\u4e2a\u8868\u540d\n    -- \u4fee\u6539\u8868\u7684\u5b57\u6bb5\u673a\u6784\uff0813.1.2. ALTER TABLE\u8bed\u6cd5\uff09\n        ALTER TABLE \u8868\u540d \u64cd\u4f5c\u540d\n        -- \u64cd\u4f5c\u540d\n            ADD[ COLUMN] \u5b57\u6bb5\u5b9a\u4e49       -- \u589e\u52a0\u5b57\u6bb5\n                AFTER \u5b57\u6bb5\u540d          -- \u8868\u793a\u589e\u52a0\u5728\u8be5\u5b57\u6bb5\u540d\u540e\u9762\n                FIRST               -- \u8868\u793a\u589e\u52a0\u5728\u7b2c\u4e00\u4e2a\n            ADD PRIMARY KEY(\u5b57\u6bb5\u540d)   -- \u521b\u5efa\u4e3b\u952e\n            ADD UNIQUE [\u7d22\u5f15\u540d] (\u5b57\u6bb5\u540d)-- \u521b\u5efa\u552f\u4e00\u7d22\u5f15\n            ADD INDEX [\u7d22\u5f15\u540d] (\u5b57\u6bb5\u540d) -- \u521b\u5efa\u666e\u901a\u7d22\u5f15\n            DROP[ COLUMN] \u5b57\u6bb5\u540d      -- \u5220\u9664\u5b57\u6bb5\n            MODIFY[ COLUMN] \u5b57\u6bb5\u540d \u5b57\u6bb5\u5c5e\u6027     -- \u652f\u6301\u5bf9\u5b57\u6bb5\u5c5e\u6027\u8fdb\u884c\u4fee\u6539\uff0c\u4e0d\u80fd\u4fee\u6539\u5b57\u6bb5\u540d(\u6240\u6709\u539f\u6709\u5c5e\u6027\u4e5f\u9700\u5199\u4e0a)\n            CHANGE[ COLUMN] \u539f\u5b57\u6bb5\u540d \u65b0\u5b57\u6bb5\u540d \u5b57\u6bb5\u5c5e\u6027      -- \u652f\u6301\u5bf9\u5b57\u6bb5\u540d\u4fee\u6539\n            DROP PRIMARY KEY    -- \u5220\u9664\u4e3b\u952e(\u5220\u9664\u4e3b\u952e\u524d\u9700\u5220\u9664\u5176AUTO_INCREMENT\u5c5e\u6027)\n            DROP INDEX \u7d22\u5f15\u540d -- \u5220\u9664\u7d22\u5f15\n            DROP FOREIGN KEY \u5916\u952e    -- \u5220\u9664\u5916\u952e\n-- \u5220\u9664\u8868\n    DROP TABLE[ IF EXISTS] \u8868\u540d ...\n-- \u6e05\u7a7a\u8868\u6570\u636e\n    TRUNCATE [TABLE] \u8868\u540d\n-- \u590d\u5236\u8868\u7ed3\u6784\n    CREATE TABLE \u8868\u540d LIKE \u8981\u590d\u5236\u7684\u8868\u540d\n-- \u590d\u5236\u8868\u7ed3\u6784\u548c\u6570\u636e\n    CREATE TABLE \u8868\u540d [AS] SELECT * FROM \u8981\u590d\u5236\u7684\u8868\u540d\n-- \u68c0\u67e5\u8868\u662f\u5426\u6709\u9519\u8bef\n    CHECK TABLE tbl_name [, tbl_name] ... [option] ...\n-- \u4f18\u5316\u8868\n    OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...\n-- \u4fee\u590d\u8868\n    REPAIR [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... [QUICK] [EXTENDED] [USE_FRM]\n-- \u5206\u6790\u8868\n    ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_4","title":"\u6570\u636e\u64cd\u4f5c","text":"<pre><code>-- \u589e\n    INSERT [INTO] \u8868\u540d [(\u5b57\u6bb5\u5217\u8868)] VALUES (\u503c\u5217\u8868)[, (\u503c\u5217\u8868), ...]\n        -- \u5982\u679c\u8981\u63d2\u5165\u7684\u503c\u5217\u8868\u5305\u542b\u6240\u6709\u5b57\u6bb5\u5e76\u4e14\u987a\u5e8f\u4e00\u81f4\uff0c\u5219\u53ef\u4ee5\u7701\u7565\u5b57\u6bb5\u5217\u8868\u3002\n        -- \u53ef\u540c\u65f6\u63d2\u5165\u591a\u6761\u6570\u636e\u8bb0\u5f55\uff01\n        REPLACE \u4e0e INSERT \u5b8c\u5168\u4e00\u6837\uff0c\u53ef\u4e92\u6362\u3002\n    INSERT [INTO] \u8868\u540d SET \u5b57\u6bb5\u540d=\u503c[, \u5b57\u6bb5\u540d=\u503c, ...]\n-- \u67e5\n    SELECT \u5b57\u6bb5\u5217\u8868 FROM \u8868\u540d[ \u5176\u4ed6\u5b50\u53e5]\n        -- \u53ef\u6765\u81ea\u591a\u4e2a\u8868\u7684\u591a\u4e2a\u5b57\u6bb5\n        -- \u5176\u4ed6\u5b50\u53e5\u53ef\u4ee5\u4e0d\u4f7f\u7528\n        -- \u5b57\u6bb5\u5217\u8868\u53ef\u4ee5\u7528*\u4ee3\u66ff\uff0c\u8868\u793a\u6240\u6709\u5b57\u6bb5\n-- \u5220\n    DELETE FROM \u8868\u540d[ \u5220\u9664\u6761\u4ef6\u5b50\u53e5]\n        \u6ca1\u6709\u6761\u4ef6\u5b50\u53e5\uff0c\u5219\u4f1a\u5220\u9664\u5168\u90e8\n-- \u6539\n    UPDATE \u8868\u540d SET \u5b57\u6bb5\u540d=\u65b0\u503c[, \u5b57\u6bb5\u540d=\u65b0\u503c] [\u66f4\u65b0\u6761\u4ef6]\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_5","title":"\u5b57\u7b26\u96c6\u7f16\u7801","text":"<pre><code>-- MySQL\u3001\u6570\u636e\u5e93\u3001\u8868\u3001\u5b57\u6bb5\u5747\u53ef\u8bbe\u7f6e\u7f16\u7801\n-- \u6570\u636e\u7f16\u7801\u4e0e\u5ba2\u6237\u7aef\u7f16\u7801\u4e0d\u9700\u4e00\u81f4\nSHOW VARIABLES LIKE  character_set_%    -- \u67e5\u770b\u6240\u6709\u5b57\u7b26\u96c6\u7f16\u7801\u9879\n    character_set_client        \u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u9001\u6570\u636e\u65f6\u4f7f\u7528\u7684\u7f16\u7801\n    character_set_results       \u670d\u52a1\u5668\u7aef\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u6240\u4f7f\u7528\u7684\u7f16\u7801\n    character_set_connection    \u8fde\u63a5\u5c42\u7f16\u7801\nSET \u53d8\u91cf\u540d = \u53d8\u91cf\u503c\n    SET character_set_client = gbk;\n    SET character_set_results = gbk;\n    SET character_set_connection = gbk;\nSET NAMES GBK;  -- \u76f8\u5f53\u4e8e\u5b8c\u6210\u4ee5\u4e0a\u4e09\u4e2a\u8bbe\u7f6e\n-- \u6821\u5bf9\u96c6\n    \u6821\u5bf9\u96c6\u7528\u4ee5\u6392\u5e8f\n    SHOW CHARACTER SET [LIKE  pattern ]/SHOW CHARSET [LIKE  pattern ]   \u67e5\u770b\u6240\u6709\u5b57\u7b26\u96c6\n    SHOW COLLATION [LIKE  pattern ]     \u67e5\u770b\u6240\u6709\u6821\u5bf9\u96c6\n    CHARSET \u5b57\u7b26\u96c6\u7f16\u7801     \u8bbe\u7f6e\u5b57\u7b26\u96c6\u7f16\u7801\n    COLLATE \u6821\u5bf9\u96c6\u7f16\u7801     \u8bbe\u7f6e\u6821\u5bf9\u96c6\u7f16\u7801\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_6","title":"\u6570\u636e\u7c7b\u578b\uff08\u5217\u7c7b\u578b\uff09","text":"<ul> <li>\u6570\u503c\u7c7b\u578b</li> </ul> <pre><code>-- a. \u6574\u578b ----------\n    \u7c7b\u578b         \u5b57\u8282     \u8303\u56f4\uff08\u6709\u7b26\u53f7\u4f4d\uff09\n    tinyint     1\u5b57\u8282    -128 ~ 127      \u65e0\u7b26\u53f7\u4f4d\uff1a0 ~ 255\n    smallint    2\u5b57\u8282    -32768 ~ 32767\n    mediumint   3\u5b57\u8282    -8388608 ~ 8388607\n    int         4\u5b57\u8282\n    bigint      8\u5b57\u8282\n    int(M)  M\u8868\u793a\u603b\u4f4d\u6570\n    - \u9ed8\u8ba4\u5b58\u5728\u7b26\u53f7\u4f4d\uff0cunsigned \u5c5e\u6027\u4fee\u6539\n    - \u663e\u793a\u5bbd\u5ea6\uff0c\u5982\u679c\u67d0\u4e2a\u6570\u4e0d\u591f\u5b9a\u4e49\u5b57\u6bb5\u65f6\u8bbe\u7f6e\u7684\u4f4d\u6570\uff0c\u5219\u524d\u9762\u4ee50\u8865\u586b\uff0czerofill \u5c5e\u6027\u4fee\u6539\n        \u4f8b\uff1aint(5)   \u63d2\u5165\u4e00\u4e2a\u6570 123 \uff0c\u8865\u586b\u540e\u4e3a 00123 \n    - \u5728\u6ee1\u8db3\u8981\u6c42\u7684\u60c5\u51b5\u4e0b\uff0c\u8d8a\u5c0f\u8d8a\u597d\u3002\n    - 1\u8868\u793abool\u503c\u771f\uff0c0\u8868\u793abool\u503c\u5047\u3002MySQL\u6ca1\u6709\u5e03\u5c14\u7c7b\u578b\uff0c\u901a\u8fc7\u6574\u578b0\u548c1\u8868\u793a\u3002\u5e38\u7528tinyint(1)\u8868\u793a\u5e03\u5c14\u578b\u3002\n\n-- b. \u6d6e\u70b9\u578b ----------\n    \u7c7b\u578b             \u5b57\u8282     \u8303\u56f4\n    float(\u5355\u7cbe\u5ea6)     4\u5b57\u8282\n    double(\u53cc\u7cbe\u5ea6)    8\u5b57\u8282\n    \u6d6e\u70b9\u578b\u65e2\u652f\u6301\u7b26\u53f7\u4f4d unsigned \u5c5e\u6027\uff0c\u4e5f\u652f\u6301\u663e\u793a\u5bbd\u5ea6 zerofill \u5c5e\u6027\u3002\n        \u4e0d\u540c\u4e8e\u6574\u578b\uff0c\u524d\u540e\u5747\u4f1a\u8865\u586b0.\n    \u5b9a\u4e49\u6d6e\u70b9\u578b\u65f6\uff0c\u9700\u6307\u5b9a\u603b\u4f4d\u6570\u548c\u5c0f\u6570\u4f4d\u6570\u3002\n        float(M, D)     double(M, D)\n        M\u8868\u793a\u603b\u4f4d\u6570\uff0cD\u8868\u793a\u5c0f\u6570\u4f4d\u6570\u3002\n        M\u548cD\u7684\u5927\u5c0f\u4f1a\u51b3\u5b9a\u6d6e\u70b9\u6570\u7684\u8303\u56f4\u3002\u4e0d\u540c\u4e8e\u6574\u578b\u7684\u56fa\u5b9a\u8303\u56f4\u3002\n        M\u65e2\u8868\u793a\u603b\u4f4d\u6570\uff08\u4e0d\u5305\u62ec\u5c0f\u6570\u70b9\u548c\u6b63\u8d1f\u53f7\uff09\uff0c\u4e5f\u8868\u793a\u663e\u793a\u5bbd\u5ea6\uff08\u6240\u6709\u663e\u793a\u7b26\u53f7\u5747\u5305\u62ec\uff09\u3002\n        \u652f\u6301\u79d1\u5b66\u8ba1\u6570\u6cd5\u8868\u793a\u3002\n        \u6d6e\u70b9\u6570\u8868\u793a\u8fd1\u4f3c\u503c\u3002\n\n-- c. \u5b9a\u70b9\u6570 ----------\n    decimal -- \u53ef\u53d8\u957f\u5ea6\n    decimal(M, D)   M\u4e5f\u8868\u793a\u603b\u4f4d\u6570\uff0cD\u8868\u793a\u5c0f\u6570\u4f4d\u6570\u3002\n    \u4fdd\u5b58\u4e00\u4e2a\u7cbe\u786e\u7684\u6570\u503c\uff0c\u4e0d\u4f1a\u53d1\u751f\u6570\u636e\u7684\u6539\u53d8\uff0c\u4e0d\u540c\u4e8e\u6d6e\u70b9\u6570\u7684\u56db\u820d\u4e94\u5165\u3002\n    \u5c06\u6d6e\u70b9\u6570\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u6765\u4fdd\u5b58\uff0c\u6bcf9\u4f4d\u6570\u5b57\u4fdd\u5b58\u4e3a4\u4e2a\u5b57\u8282\u3002\n</code></pre> <ul> <li>\u5b57\u7b26\u4e32\u7c7b\u578b</li> </ul> <pre><code>-- a. char, varchar ----------\n    char    \u5b9a\u957f\u5b57\u7b26\u4e32\uff0c\u901f\u5ea6\u5feb\uff0c\u4f46\u6d6a\u8d39\u7a7a\u95f4\n    varchar \u53d8\u957f\u5b57\u7b26\u4e32\uff0c\u901f\u5ea6\u6162\uff0c\u4f46\u8282\u7701\u7a7a\u95f4\n    M\u8868\u793a\u80fd\u5b58\u50a8\u7684\u6700\u5927\u957f\u5ea6\uff0c\u6b64\u957f\u5ea6\u662f\u5b57\u7b26\u6570\uff0c\u975e\u5b57\u8282\u6570\u3002\n    \u4e0d\u540c\u7684\u7f16\u7801\uff0c\u6240\u5360\u7528\u7684\u7a7a\u95f4\u4e0d\u540c\u3002\n    char,\u6700\u591a255\u4e2a\u5b57\u7b26\uff0c\u4e0e\u7f16\u7801\u65e0\u5173\u3002\n    varchar,\u6700\u591a65535\u5b57\u7b26\uff0c\u4e0e\u7f16\u7801\u6709\u5173\u3002\n    \u4e00\u6761\u6709\u6548\u8bb0\u5f55\u6700\u5927\u4e0d\u80fd\u8d85\u8fc765535\u4e2a\u5b57\u8282\u3002\n        utf8 \u6700\u5927\u4e3a21844\u4e2a\u5b57\u7b26\uff0cgbk \u6700\u5927\u4e3a32766\u4e2a\u5b57\u7b26\uff0clatin1 \u6700\u5927\u4e3a65532\u4e2a\u5b57\u7b26\n    varchar \u662f\u53d8\u957f\u7684\uff0c\u9700\u8981\u5229\u7528\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58 varchar \u7684\u957f\u5ea6\uff0c\u5982\u679c\u6570\u636e\u5c0f\u4e8e255\u4e2a\u5b57\u8282\uff0c\u5219\u91c7\u7528\u4e00\u4e2a\u5b57\u8282\u6765\u4fdd\u5b58\u957f\u5ea6\uff0c\u53cd\u4e4b\u9700\u8981\u4e24\u4e2a\u5b57\u8282\u6765\u4fdd\u5b58\u3002\n    varchar \u7684\u6700\u5927\u6709\u6548\u957f\u5ea6\u7531\u6700\u5927\u884c\u5927\u5c0f\u548c\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u786e\u5b9a\u3002\n    \u6700\u5927\u6709\u6548\u957f\u5ea6\u662f65532\u5b57\u8282\uff0c\u56e0\u4e3a\u5728varchar\u5b58\u5b57\u7b26\u4e32\u65f6\uff0c\u7b2c\u4e00\u4e2a\u5b57\u8282\u662f\u7a7a\u7684\uff0c\u4e0d\u5b58\u5728\u4efb\u4f55\u6570\u636e\uff0c\u7136\u540e\u8fd8\u9700\u4e24\u4e2a\u5b57\u8282\u6765\u5b58\u653e\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u6240\u4ee5\u6709\u6548\u957f\u5ea6\u662f64432-1-2=65532\u5b57\u8282\u3002\n    \u4f8b\uff1a\u82e5\u4e00\u4e2a\u8868\u5b9a\u4e49\u4e3a CREATE TABLE tb(c1 int, c2 char(30), c3 varchar(N)) charset=utf8; \u95eeN\u7684\u6700\u5927\u503c\u662f\u591a\u5c11\uff1f \u7b54\uff1a(65535-1-2-4-30*3)/3\n\n-- b. blob, text ----------\n    blob \u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff08\u5b57\u8282\u5b57\u7b26\u4e32\uff09\n        tinyblob, blob, mediumblob, longblob\n    text \u975e\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff08\u5b57\u7b26\u5b57\u7b26\u4e32\uff09\n        tinytext, text, mediumtext, longtext\n    text \u5728\u5b9a\u4e49\u65f6\uff0c\u4e0d\u9700\u8981\u5b9a\u4e49\u957f\u5ea6\uff0c\u4e5f\u4e0d\u4f1a\u8ba1\u7b97\u603b\u957f\u5ea6\u3002\n    text \u7c7b\u578b\u5728\u5b9a\u4e49\u65f6\uff0c\u4e0d\u53ef\u7ed9default\u503c\n\n-- c. binary, varbinary ----------\n    \u7c7b\u4f3c\u4e8echar\u548cvarchar\uff0c\u7528\u4e8e\u4fdd\u5b58\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff0c\u4e5f\u5c31\u662f\u4fdd\u5b58\u5b57\u8282\u5b57\u7b26\u4e32\u800c\u975e\u5b57\u7b26\u5b57\u7b26\u4e32\u3002\n    char, varchar, text \u5bf9\u5e94 binary, varbinary, blob.\n</code></pre> <ul> <li>\u65e5\u671f\u65f6\u95f4\u7c7b\u578b</li> </ul> <pre><code>    \u4e00\u822c\u7528\u6574\u578b\u4fdd\u5b58\u65f6\u95f4\u6233\uff0c\u56e0\u4e3aPHP\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5c06\u65f6\u95f4\u6233\u8fdb\u884c\u683c\u5f0f\u5316\u3002\n    datetime    8\u5b57\u8282    \u65e5\u671f\u53ca\u65f6\u95f4     1000-01-01 00:00:00 \u5230 9999-12-31 23:59:59\n    date        3\u5b57\u8282    \u65e5\u671f         1000-01-01 \u5230 9999-12-31\n    timestamp   4\u5b57\u8282    \u65f6\u95f4\u6233        19700101000000 \u5230 2038-01-19 03:14:07\n    time        3\u5b57\u8282    \u65f6\u95f4         -838:59:59 \u5230 838:59:59\n    year        1\u5b57\u8282    \u5e74\u4efd         1901 - 2155\ndatetime    YYYY-MM-DD hh:mm:ss\ntimestamp   YY-MM-DD hh:mm:ss\n            YYYYMMDDhhmmss\n            YYMMDDhhmmss\n            YYYYMMDDhhmmss\n            YYMMDDhhmmss\ndate        YYYY-MM-DD\n            YY-MM-DD\n            YYYYMMDD\n            YYMMDD\n            YYYYMMDD\n            YYMMDD\ntime        hh:mm:ss\n            hhmmss\n            hhmmss\nyear        YYYY\n            YY\n            YYYY\n            YY\n</code></pre> <ul> <li>\u679a\u4e3e\u548c\u96c6\u5408</li> </ul> <pre><code>-- \u679a\u4e3e(enum) ----------\nenum(val1, val2, val3...)\n    \u5728\u5df2\u77e5\u7684\u503c\u4e2d\u8fdb\u884c\u5355\u9009\u3002\u6700\u5927\u6570\u91cf\u4e3a65535.\n    \u679a\u4e3e\u503c\u5728\u4fdd\u5b58\u65f6\uff0c\u4ee52\u4e2a\u5b57\u8282\u7684\u6574\u578b(smallint)\u4fdd\u5b58\u3002\u6bcf\u4e2a\u679a\u4e3e\u503c\uff0c\u6309\u4fdd\u5b58\u7684\u4f4d\u7f6e\u987a\u5e8f\uff0c\u4ece1\u5f00\u59cb\u9010\u4e00\u9012\u589e\u3002\n    \u8868\u73b0\u4e3a\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u5b58\u50a8\u5374\u662f\u6574\u578b\u3002\n    NULL\u503c\u7684\u7d22\u5f15\u662fNULL\u3002\n    \u7a7a\u5b57\u7b26\u4e32\u9519\u8bef\u503c\u7684\u7d22\u5f15\u503c\u662f0\u3002\n\n\n-- \u96c6\u5408\uff08set\uff09 ----------\nset(val1, val2, val3...)\n    create table tab ( gender set( \u7537 ,  \u5973 ,  \u65e0 ) );\n    insert into tab values ( \u7537, \u5973 );\n    \u6700\u591a\u53ef\u4ee5\u670964\u4e2a\u4e0d\u540c\u7684\u6210\u5458\u3002\u4ee5bigint\u5b58\u50a8\uff0c\u51718\u4e2a\u5b57\u8282\u3002\u91c7\u53d6\u4f4d\u8fd0\u7b97\u7684\u5f62\u5f0f\u3002\n    \u5f53\u521b\u5efa\u8868\u65f6\uff0cSET\u6210\u5458\u503c\u7684\u5c3e\u90e8\u7a7a\u683c\u5c06\u81ea\u52a8\u88ab\u5220\u9664\u3002\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_7","title":"\u9009\u62e9\u7c7b\u578b","text":"<pre><code>-- PHP\u89d2\u5ea6\n1. \u529f\u80fd\u6ee1\u8db3\n2. \u5b58\u50a8\u7a7a\u95f4\u5c3d\u91cf\u5c0f\uff0c\u5904\u7406\u6548\u7387\u66f4\u9ad8\n3. \u8003\u8651\u517c\u5bb9\u95ee\u9898\n\n-- IP\u5b58\u50a8 ----------\n1. \u53ea\u9700\u5b58\u50a8\uff0c\u53ef\u7528\u5b57\u7b26\u4e32\n2. \u5982\u679c\u9700\u8ba1\u7b97\uff0c\u67e5\u627e\u7b49\uff0c\u53ef\u5b58\u50a8\u4e3a4\u4e2a\u5b57\u8282\u7684\u65e0\u7b26\u53f7int\uff0c\u5373unsigned\n    1) PHP\u51fd\u6570\u8f6c\u6362\n        ip2long\u53ef\u8f6c\u6362\u4e3a\u6574\u578b\uff0c\u4f46\u4f1a\u51fa\u73b0\u643a\u5e26\u7b26\u53f7\u95ee\u9898\u3002\u9700\u683c\u5f0f\u5316\u4e3a\u65e0\u7b26\u53f7\u7684\u6574\u578b\u3002\n        \u5229\u7528sprintf\u51fd\u6570\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\n        sprintf(\"%u\", ip2long( 192.168.3.134 ));\n        \u7136\u540e\u7528long2ip\u5c06\u6574\u578b\u8f6c\u56deIP\u5b57\u7b26\u4e32\n    2) MySQL\u51fd\u6570\u8f6c\u6362(\u65e0\u7b26\u53f7\u6574\u578b\uff0cUNSIGNED)\n        INET_ATON( 127.0.0.1 ) \u5c06IP\u8f6c\u4e3a\u6574\u578b\n        INET_NTOA(2130706433) \u5c06\u6574\u578b\u8f6c\u4e3aIP\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_8","title":"\u5217\u5c5e\u6027\uff08\u5217\u7ea6\u675f\uff09","text":"<pre><code>1. PRIMARY \u4e3b\u952e\n    - \u80fd\u552f\u4e00\u6807\u8bc6\u8bb0\u5f55\u7684\u5b57\u6bb5\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e3b\u952e\u3002\n    - \u4e00\u4e2a\u8868\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u952e\u3002\n    - \u4e3b\u952e\u5177\u6709\u552f\u4e00\u6027\u3002\n    - \u58f0\u660e\u5b57\u6bb5\u65f6\uff0c\u7528 primary key \u6807\u8bc6\u3002\n        \u4e5f\u53ef\u4ee5\u5728\u5b57\u6bb5\u5217\u8868\u4e4b\u540e\u58f0\u660e\n            \u4f8b\uff1acreate table tab ( id int, stu varchar(10), primary key (id));\n    - \u4e3b\u952e\u5b57\u6bb5\u7684\u503c\u4e0d\u80fd\u4e3anull\u3002\n    - \u4e3b\u952e\u53ef\u4ee5\u7531\u591a\u4e2a\u5b57\u6bb5\u5171\u540c\u7ec4\u6210\u3002\u6b64\u65f6\u9700\u8981\u5728\u5b57\u6bb5\u5217\u8868\u540e\u58f0\u660e\u7684\u65b9\u6cd5\u3002\n        \u4f8b\uff1acreate table tab ( id int, stu varchar(10), age int, primary key (stu, age));\n2. UNIQUE \u552f\u4e00\u7d22\u5f15\uff08\u552f\u4e00\u7ea6\u675f\uff09\n    \u4f7f\u5f97\u67d0\u5b57\u6bb5\u7684\u503c\u4e5f\u4e0d\u80fd\u91cd\u590d\u3002\n3. NULL \u7ea6\u675f\n    null\u4e0d\u662f\u6570\u636e\u7c7b\u578b\uff0c\u662f\u5217\u7684\u4e00\u4e2a\u5c5e\u6027\u3002\n    \u8868\u793a\u5f53\u524d\u5217\u662f\u5426\u53ef\u4ee5\u4e3anull\uff0c\u8868\u793a\u4ec0\u4e48\u90fd\u6ca1\u6709\u3002\n    null, \u5141\u8bb8\u4e3a\u7a7a\u3002\u9ed8\u8ba4\u3002\n    not null, \u4e0d\u5141\u8bb8\u4e3a\u7a7a\u3002\n    insert into tab values (null,  val );\n        -- \u6b64\u65f6\u8868\u793a\u5c06\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u7684\u503c\u8bbe\u4e3anull, \u53d6\u51b3\u4e8e\u8be5\u5b57\u6bb5\u662f\u5426\u5141\u8bb8\u4e3anull\n4. DEFAULT \u9ed8\u8ba4\u503c\u5c5e\u6027\n    \u5f53\u524d\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002\n    insert into tab values (default,  val );    -- \u6b64\u65f6\u8868\u793a\u5f3a\u5236\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002\n    create table tab ( add_time timestamp default current_timestamp );\n        -- \u8868\u793a\u5c06\u5f53\u524d\u65f6\u95f4\u7684\u65f6\u95f4\u6233\u8bbe\u4e3a\u9ed8\u8ba4\u503c\u3002\n        current_date, current_time\n5. AUTO_INCREMENT \u81ea\u52a8\u589e\u957f\u7ea6\u675f\n    \u81ea\u52a8\u589e\u957f\u5fc5\u987b\u4e3a\u7d22\u5f15\uff08\u4e3b\u952e\u6216unique\uff09\n    \u53ea\u80fd\u5b58\u5728\u4e00\u4e2a\u5b57\u6bb5\u4e3a\u81ea\u52a8\u589e\u957f\u3002\n    \u9ed8\u8ba4\u4e3a1\u5f00\u59cb\u81ea\u52a8\u589e\u957f\u3002\u53ef\u4ee5\u901a\u8fc7\u8868\u5c5e\u6027 auto_increment = x\u8fdb\u884c\u8bbe\u7f6e\uff0c\u6216 alter table tbl auto_increment = x;\n6. COMMENT \u6ce8\u91ca\n    \u4f8b\uff1acreate table tab ( id int ) comment  \u6ce8\u91ca\u5185\u5bb9 ;\n7. FOREIGN KEY \u5916\u952e\u7ea6\u675f\n    \u7528\u4e8e\u9650\u5236\u4e3b\u8868\u4e0e\u4ece\u8868\u6570\u636e\u5b8c\u6574\u6027\u3002\n    alter table t1 add constraint `t1_t2_fk` foreign key (t1_id) references t2(id);\n        -- \u5c06\u8868t1\u7684t1_id\u5916\u952e\u5173\u8054\u5230\u8868t2\u7684id\u5b57\u6bb5\u3002\n        -- \u6bcf\u4e2a\u5916\u952e\u90fd\u6709\u4e00\u4e2a\u540d\u5b57\uff0c\u53ef\u4ee5\u901a\u8fc7 constraint \u6307\u5b9a\n    \u5b58\u5728\u5916\u952e\u7684\u8868\uff0c\u79f0\u4e4b\u4e3a\u4ece\u8868\uff08\u5b50\u8868\uff09\uff0c\u5916\u952e\u6307\u5411\u7684\u8868\uff0c\u79f0\u4e4b\u4e3a\u4e3b\u8868\uff08\u7236\u8868\uff09\u3002\n    \u4f5c\u7528\uff1a\u4fdd\u6301\u6570\u636e\u4e00\u81f4\u6027\uff0c\u5b8c\u6574\u6027\uff0c\u4e3b\u8981\u76ee\u7684\u662f\u63a7\u5236\u5b58\u50a8\u5728\u5916\u952e\u8868\uff08\u4ece\u8868\uff09\u4e2d\u7684\u6570\u636e\u3002\n    MySQL\u4e2d\uff0c\u53ef\u4ee5\u5bf9InnoDB\u5f15\u64ce\u4f7f\u7528\u5916\u952e\u7ea6\u675f\uff1a\n    \u8bed\u6cd5\uff1a\n    foreign key (\u5916\u952e\u5b57\u6bb5\uff09 references \u4e3b\u8868\u540d (\u5173\u8054\u5b57\u6bb5) [\u4e3b\u8868\u8bb0\u5f55\u5220\u9664\u65f6\u7684\u52a8\u4f5c] [\u4e3b\u8868\u8bb0\u5f55\u66f4\u65b0\u65f6\u7684\u52a8\u4f5c]\n    \u6b64\u65f6\u9700\u8981\u68c0\u6d4b\u4e00\u4e2a\u4ece\u8868\u7684\u5916\u952e\u9700\u8981\u7ea6\u675f\u4e3a\u4e3b\u8868\u7684\u5df2\u5b58\u5728\u7684\u503c\u3002\u5916\u952e\u5728\u6ca1\u6709\u5173\u8054\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3anull.\u524d\u63d0\u662f\u8be5\u5916\u952e\u5217\uff0c\u6ca1\u6709not null\u3002\n    \u53ef\u4ee5\u4e0d\u6307\u5b9a\u4e3b\u8868\u8bb0\u5f55\u66f4\u6539\u6216\u66f4\u65b0\u65f6\u7684\u52a8\u4f5c\uff0c\u90a3\u4e48\u6b64\u65f6\u4e3b\u8868\u7684\u64cd\u4f5c\u88ab\u62d2\u7edd\u3002\n    \u5982\u679c\u6307\u5b9a\u4e86 on update \u6216 on delete\uff1a\u5728\u5220\u9664\u6216\u66f4\u65b0\u65f6\uff0c\u6709\u5982\u4e0b\u51e0\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u9009\u62e9\uff1a\n    1. cascade\uff0c\u7ea7\u8054\u64cd\u4f5c\u3002\u4e3b\u8868\u6570\u636e\u88ab\u66f4\u65b0\uff08\u4e3b\u952e\u503c\u66f4\u65b0\uff09\uff0c\u4ece\u8868\u4e5f\u88ab\u66f4\u65b0\uff08\u5916\u952e\u503c\u66f4\u65b0\uff09\u3002\u4e3b\u8868\u8bb0\u5f55\u88ab\u5220\u9664\uff0c\u4ece\u8868\u76f8\u5173\u8bb0\u5f55\u4e5f\u88ab\u5220\u9664\u3002\n    2. set null\uff0c\u8bbe\u7f6e\u4e3anull\u3002\u4e3b\u8868\u6570\u636e\u88ab\u66f4\u65b0\uff08\u4e3b\u952e\u503c\u66f4\u65b0\uff09\uff0c\u4ece\u8868\u7684\u5916\u952e\u88ab\u8bbe\u7f6e\u4e3anull\u3002\u4e3b\u8868\u8bb0\u5f55\u88ab\u5220\u9664\uff0c\u4ece\u8868\u76f8\u5173\u8bb0\u5f55\u5916\u952e\u88ab\u8bbe\u7f6e\u6210null\u3002\u4f46\u6ce8\u610f\uff0c\u8981\u6c42\u8be5\u5916\u952e\u5217\uff0c\u6ca1\u6709not null\u5c5e\u6027\u7ea6\u675f\u3002\n    3. restrict\uff0c\u62d2\u7edd\u7236\u8868\u5220\u9664\u548c\u66f4\u65b0\u3002\n    \u6ce8\u610f\uff0c\u5916\u952e\u53ea\u88abInnoDB\u5b58\u50a8\u5f15\u64ce\u6240\u652f\u6301\u3002\u5176\u4ed6\u5f15\u64ce\u662f\u4e0d\u652f\u6301\u7684\u3002\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_9","title":"\u5efa\u8868\u89c4\u8303","text":"<pre><code>   -- Normal Format, NF\n        - \u6bcf\u4e2a\u8868\u4fdd\u5b58\u4e00\u4e2a\u5b9e\u4f53\u4fe1\u606f\n        - \u6bcf\u4e2a\u5177\u6709\u4e00\u4e2aID\u5b57\u6bb5\u4f5c\u4e3a\u4e3b\u952e\n        - ID\u4e3b\u952e + \u539f\u5b50\u8868\n    -- 1NF, \u7b2c\u4e00\u8303\u5f0f\n        \u5b57\u6bb5\u4e0d\u80fd\u518d\u5206\uff0c\u5c31\u6ee1\u8db3\u7b2c\u4e00\u8303\u5f0f\u3002\n    -- 2NF, \u7b2c\u4e8c\u8303\u5f0f\n        \u6ee1\u8db3\u7b2c\u4e00\u8303\u5f0f\u7684\u524d\u63d0\u4e0b\uff0c\u4e0d\u80fd\u51fa\u73b0\u90e8\u5206\u4f9d\u8d56\u3002\n        \u6d88\u9664\u7b26\u5408\u4e3b\u952e\u5c31\u53ef\u4ee5\u907f\u514d\u90e8\u5206\u4f9d\u8d56\u3002\u589e\u52a0\u5355\u5217\u5173\u952e\u5b57\u3002\n    -- 3NF, \u7b2c\u4e09\u8303\u5f0f\n        \u6ee1\u8db3\u7b2c\u4e8c\u8303\u5f0f\u7684\u524d\u63d0\u4e0b\uff0c\u4e0d\u80fd\u51fa\u73b0\u4f20\u9012\u4f9d\u8d56\u3002\n        \u67d0\u4e2a\u5b57\u6bb5\u4f9d\u8d56\u4e8e\u4e3b\u952e\uff0c\u800c\u6709\u5176\u4ed6\u5b57\u6bb5\u4f9d\u8d56\u4e8e\u8be5\u5b57\u6bb5\u3002\u8fd9\u5c31\u662f\u4f20\u9012\u4f9d\u8d56\u3002\n        \u5c06\u4e00\u4e2a\u5b9e\u4f53\u4fe1\u606f\u7684\u6570\u636e\u653e\u5728\u4e00\u4e2a\u8868\u5185\u5b9e\u73b0\u3002\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#select","title":"SELECT","text":"<pre><code>SELECT [ALL|DISTINCT] select_expr FROM -&gt; WHERE -&gt; GROUP BY [\u5408\u8ba1\u51fd\u6570] -&gt; HAVING -&gt; ORDER BY -&gt; LIMIT\na. select_expr\n    -- \u53ef\u4ee5\u7528 * \u8868\u793a\u6240\u6709\u5b57\u6bb5\u3002\n        select * from tb;\n    -- \u53ef\u4ee5\u4f7f\u7528\u8868\u8fbe\u5f0f\uff08\u8ba1\u7b97\u516c\u5f0f\u3001\u51fd\u6570\u8c03\u7528\u3001\u5b57\u6bb5\u4e5f\u662f\u4e2a\u8868\u8fbe\u5f0f\uff09\n        select stu, 29+25, now() from tb;\n    -- \u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u5217\u4f7f\u7528\u522b\u540d\u3002\u9002\u7528\u4e8e\u7b80\u5316\u5217\u6807\u8bc6\uff0c\u907f\u514d\u591a\u4e2a\u5217\u6807\u8bc6\u7b26\u91cd\u590d\u3002\n        - \u4f7f\u7528 as \u5173\u952e\u5b57\uff0c\u4e5f\u53ef\u7701\u7565 as.\n        select stu+10 as add10 from tb;\nb. FROM \u5b50\u53e5\n    \u7528\u4e8e\u6807\u8bc6\u67e5\u8be2\u6765\u6e90\u3002\n    -- \u53ef\u4ee5\u4e3a\u8868\u8d77\u522b\u540d\u3002\u4f7f\u7528as\u5173\u952e\u5b57\u3002\n        SELECT * FROM tb1 AS tt, tb2 AS bb;\n    -- from\u5b50\u53e5\u540e\uff0c\u53ef\u4ee5\u540c\u65f6\u51fa\u73b0\u591a\u4e2a\u8868\u3002\n        -- \u591a\u4e2a\u8868\u4f1a\u6a2a\u5411\u53e0\u52a0\u5230\u4e00\u8d77\uff0c\u800c\u6570\u636e\u4f1a\u5f62\u6210\u4e00\u4e2a\u7b1b\u5361\u5c14\u79ef\u3002\n        SELECT * FROM tb1, tb2;\n    -- \u5411\u4f18\u5316\u7b26\u63d0\u793a\u5982\u4f55\u9009\u62e9\u7d22\u5f15\n        USE INDEX\u3001IGNORE INDEX\u3001FORCE INDEX\n        SELECT * FROM table1 USE INDEX (key1,key2) WHERE key1=1 AND key2=2 AND key3=3;\n        SELECT * FROM table1 IGNORE INDEX (key3) WHERE key1=1 AND key2=2 AND key3=3;\nc. WHERE \u5b50\u53e5\n    -- \u4ecefrom\u83b7\u5f97\u7684\u6570\u636e\u6e90\u4e2d\u8fdb\u884c\u7b5b\u9009\u3002\n    -- \u6574\u578b1\u8868\u793a\u771f\uff0c0\u8868\u793a\u5047\u3002\n    -- \u8868\u8fbe\u5f0f\u7531\u8fd0\u7b97\u7b26\u548c\u8fd0\u7b97\u6570\u7ec4\u6210\u3002\n        -- \u8fd0\u7b97\u6570\uff1a\u53d8\u91cf\uff08\u5b57\u6bb5\uff09\u3001\u503c\u3001\u51fd\u6570\u8fd4\u56de\u503c\n        -- \u8fd0\u7b97\u7b26\uff1a\n            =, &lt;=&gt;, &lt;&gt;, !=, &lt;=, &lt;, &gt;=, &gt;, !, &amp;&amp;, ||,\n            in (not) null, (not) like, (not) in, (not) between and, is (not), and, or, not, xor\n            is/is not \u52a0\u4e0ature/false/unknown\uff0c\u68c0\u9a8c\u67d0\u4e2a\u503c\u7684\u771f\u5047\n            &lt;=&gt;\u4e0e&lt;&gt;\u529f\u80fd\u76f8\u540c\uff0c&lt;=&gt;\u53ef\u7528\u4e8enull\u6bd4\u8f83\nd. GROUP BY \u5b50\u53e5, \u5206\u7ec4\u5b50\u53e5\n    GROUP BY \u5b57\u6bb5/\u522b\u540d [\u6392\u5e8f\u65b9\u5f0f]\n    \u5206\u7ec4\u540e\u4f1a\u8fdb\u884c\u6392\u5e8f\u3002\u5347\u5e8f\uff1aASC\uff0c\u964d\u5e8f\uff1aDESC\n    \u4ee5\u4e0b[\u5408\u8ba1\u51fd\u6570]\u9700\u914d\u5408 GROUP BY \u4f7f\u7528\uff1a\n    count \u8fd4\u56de\u4e0d\u540c\u7684\u975eNULL\u503c\u6570\u76ee  count(*)\u3001count(\u5b57\u6bb5)\n    sum \u6c42\u548c\n    max \u6c42\u6700\u5927\u503c\n    min \u6c42\u6700\u5c0f\u503c\n    avg \u6c42\u5e73\u5747\u503c\n    group_concat \u8fd4\u56de\u5e26\u6709\u6765\u81ea\u4e00\u4e2a\u7ec4\u7684\u8fde\u63a5\u7684\u975eNULL\u503c\u7684\u5b57\u7b26\u4e32\u7ed3\u679c\u3002\u7ec4\u5185\u5b57\u7b26\u4e32\u8fde\u63a5\u3002\ne. HAVING \u5b50\u53e5\uff0c\u6761\u4ef6\u5b50\u53e5\n    \u4e0e where \u529f\u80fd\u3001\u7528\u6cd5\u76f8\u540c\uff0c\u6267\u884c\u65f6\u673a\u4e0d\u540c\u3002\n    where \u5728\u5f00\u59cb\u65f6\u6267\u884c\u68c0\u6d4b\u6570\u636e\uff0c\u5bf9\u539f\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\u3002\n    having \u5bf9\u7b5b\u9009\u51fa\u7684\u7ed3\u679c\u518d\u6b21\u8fdb\u884c\u8fc7\u6ee4\u3002\n    having \u5b57\u6bb5\u5fc5\u987b\u662f\u67e5\u8be2\u51fa\u6765\u7684\uff0cwhere \u5b57\u6bb5\u5fc5\u987b\u662f\u6570\u636e\u8868\u5b58\u5728\u7684\u3002\n    where \u4e0d\u53ef\u4ee5\u4f7f\u7528\u5b57\u6bb5\u7684\u522b\u540d\uff0chaving \u53ef\u4ee5\u3002\u56e0\u4e3a\u6267\u884cWHERE\u4ee3\u7801\u65f6\uff0c\u53ef\u80fd\u5c1a\u672a\u786e\u5b9a\u5217\u503c\u3002\n    where \u4e0d\u53ef\u4ee5\u4f7f\u7528\u5408\u8ba1\u51fd\u6570\u3002\u4e00\u822c\u9700\u7528\u5408\u8ba1\u51fd\u6570\u624d\u4f1a\u7528 having\n    SQL\u6807\u51c6\u8981\u6c42HAVING\u5fc5\u987b\u5f15\u7528GROUP BY\u5b50\u53e5\u4e2d\u7684\u5217\u6216\u7528\u4e8e\u5408\u8ba1\u51fd\u6570\u4e2d\u7684\u5217\u3002\nf. ORDER BY \u5b50\u53e5\uff0c\u6392\u5e8f\u5b50\u53e5\n    order by \u6392\u5e8f\u5b57\u6bb5/\u522b\u540d \u6392\u5e8f\u65b9\u5f0f [,\u6392\u5e8f\u5b57\u6bb5/\u522b\u540d \u6392\u5e8f\u65b9\u5f0f]...\n    \u5347\u5e8f\uff1aASC\uff0c\u964d\u5e8f\uff1aDESC\n    \u652f\u6301\u591a\u4e2a\u5b57\u6bb5\u7684\u6392\u5e8f\u3002\ng. LIMIT \u5b50\u53e5\uff0c\u9650\u5236\u7ed3\u679c\u6570\u91cf\u5b50\u53e5\n    \u4ec5\u5bf9\u5904\u7406\u597d\u7684\u7ed3\u679c\u8fdb\u884c\u6570\u91cf\u9650\u5236\u3002\u5c06\u5904\u7406\u597d\u7684\u7ed3\u679c\u7684\u770b\u4f5c\u662f\u4e00\u4e2a\u96c6\u5408\uff0c\u6309\u7167\u8bb0\u5f55\u51fa\u73b0\u7684\u987a\u5e8f\uff0c\u7d22\u5f15\u4ece0\u5f00\u59cb\u3002\n    limit \u8d77\u59cb\u4f4d\u7f6e, \u83b7\u53d6\u6761\u6570\n    \u7701\u7565\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u8868\u793a\u4ece\u7d22\u5f150\u5f00\u59cb\u3002limit \u83b7\u53d6\u6761\u6570\nh. DISTINCT, ALL \u9009\u9879\n    distinct \u53bb\u9664\u91cd\u590d\u8bb0\u5f55\n    \u9ed8\u8ba4\u4e3a all, \u5168\u90e8\u8bb0\u5f55\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#union","title":"UNION","text":"<pre><code>   \u5c06\u591a\u4e2aselect\u67e5\u8be2\u7684\u7ed3\u679c\u7ec4\u5408\u6210\u4e00\u4e2a\u7ed3\u679c\u96c6\u5408\u3002\n    SELECT ... UNION [ALL|DISTINCT] SELECT ...\n    \u9ed8\u8ba4 DISTINCT \u65b9\u5f0f\uff0c\u5373\u6240\u6709\u8fd4\u56de\u7684\u884c\u90fd\u662f\u552f\u4e00\u7684\n    \u5efa\u8bae\uff0c\u5bf9\u6bcf\u4e2aSELECT\u67e5\u8be2\u52a0\u4e0a\u5c0f\u62ec\u53f7\u5305\u88f9\u3002\n    ORDER BY \u6392\u5e8f\u65f6\uff0c\u9700\u52a0\u4e0a LIMIT \u8fdb\u884c\u7ed3\u5408\u3002\n    \u9700\u8981\u5404select\u67e5\u8be2\u7684\u5b57\u6bb5\u6570\u91cf\u4e00\u6837\u3002\n    \u6bcf\u4e2aselect\u67e5\u8be2\u7684\u5b57\u6bb5\u5217\u8868(\u6570\u91cf\u3001\u7c7b\u578b)\u5e94\u4e00\u81f4\uff0c\u56e0\u4e3a\u7ed3\u679c\u4e2d\u7684\u5b57\u6bb5\u540d\u4ee5\u7b2c\u4e00\u6761select\u8bed\u53e5\u4e3a\u51c6\u3002\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_10","title":"\u5b50\u67e5\u8be2","text":"<pre><code>   - \u5b50\u67e5\u8be2\u9700\u7528\u62ec\u53f7\u5305\u88f9\u3002\n-- from\u578b\n    from\u540e\u8981\u6c42\u662f\u4e00\u4e2a\u8868\uff0c\u5fc5\u987b\u7ed9\u5b50\u67e5\u8be2\u7ed3\u679c\u53d6\u4e2a\u522b\u540d\u3002\n    - \u7b80\u5316\u6bcf\u4e2a\u67e5\u8be2\u5185\u7684\u6761\u4ef6\u3002\n    - from\u578b\u9700\u5c06\u7ed3\u679c\u751f\u6210\u4e00\u4e2a\u4e34\u65f6\u8868\u683c\uff0c\u53ef\u7528\u4ee5\u539f\u8868\u7684\u9501\u5b9a\u7684\u91ca\u653e\u3002\n    - \u5b50\u67e5\u8be2\u8fd4\u56de\u4e00\u4e2a\u8868\uff0c\u8868\u578b\u5b50\u67e5\u8be2\u3002\n    select * from (select * from tb where id&gt;0) as subfrom where id&gt;1;\n-- where\u578b\n    - \u5b50\u67e5\u8be2\u8fd4\u56de\u4e00\u4e2a\u503c\uff0c\u6807\u91cf\u5b50\u67e5\u8be2\u3002\n    - \u4e0d\u9700\u8981\u7ed9\u5b50\u67e5\u8be2\u53d6\u522b\u540d\u3002\n    - where\u5b50\u67e5\u8be2\u5185\u7684\u8868\uff0c\u4e0d\u80fd\u76f4\u63a5\u7528\u4ee5\u66f4\u65b0\u3002\n    select * from tb where money = (select max(money) from tb);\n    -- \u5217\u5b50\u67e5\u8be2\n        \u5982\u679c\u5b50\u67e5\u8be2\u7ed3\u679c\u8fd4\u56de\u7684\u662f\u4e00\u5217\u3002\n        \u4f7f\u7528 in \u6216 not in \u5b8c\u6210\u67e5\u8be2\n        exists \u548c not exists \u6761\u4ef6\n            \u5982\u679c\u5b50\u67e5\u8be2\u8fd4\u56de\u6570\u636e\uff0c\u5219\u8fd4\u56de1\u62160\u3002\u5e38\u7528\u4e8e\u5224\u65ad\u6761\u4ef6\u3002\n            select column1 from t1 where exists (select * from t2);\n    -- \u884c\u5b50\u67e5\u8be2\n        \u67e5\u8be2\u6761\u4ef6\u662f\u4e00\u4e2a\u884c\u3002\n        select * from t1 where (id, gender) in (select id, gender from t2);\n        \u884c\u6784\u9020\u7b26\uff1a(col1, col2, ...) \u6216 ROW(col1, col2, ...)\n        \u884c\u6784\u9020\u7b26\u901a\u5e38\u7528\u4e8e\u4e0e\u5bf9\u80fd\u8fd4\u56de\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u5217\u7684\u5b50\u67e5\u8be2\u8fdb\u884c\u6bd4\u8f83\u3002\n    -- \u7279\u6b8a\u8fd0\u7b97\u7b26\n    != all()    \u76f8\u5f53\u4e8e not in\n    = some()    \u76f8\u5f53\u4e8e in\u3002any \u662f some \u7684\u522b\u540d\n    != some()   \u4e0d\u7b49\u540c\u4e8e not in\uff0c\u4e0d\u7b49\u4e8e\u5176\u4e2d\u67d0\u4e00\u4e2a\u3002\n    all, some \u53ef\u4ee5\u914d\u5408\u5176\u4ed6\u8fd0\u7b97\u7b26\u4e00\u8d77\u4f7f\u7528\u3002\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#join","title":"\u8fde\u63a5\u67e5\u8be2(join)","text":"<pre><code>   \u5c06\u591a\u4e2a\u8868\u7684\u5b57\u6bb5\u8fdb\u884c\u8fde\u63a5\uff0c\u53ef\u4ee5\u6307\u5b9a\u8fde\u63a5\u6761\u4ef6\u3002\n-- \u5185\u8fde\u63a5(inner join)\n    - \u9ed8\u8ba4\u5c31\u662f\u5185\u8fde\u63a5\uff0c\u53ef\u7701\u7565inner\u3002\n    - \u53ea\u6709\u6570\u636e\u5b58\u5728\u65f6\u624d\u80fd\u53d1\u9001\u8fde\u63a5\u3002\u5373\u8fde\u63a5\u7ed3\u679c\u4e0d\u80fd\u51fa\u73b0\u7a7a\u884c\u3002\n    on \u8868\u793a\u8fde\u63a5\u6761\u4ef6\u3002\u5176\u6761\u4ef6\u8868\u8fbe\u5f0f\u4e0ewhere\u7c7b\u4f3c\u3002\u4e5f\u53ef\u4ee5\u7701\u7565\u6761\u4ef6\uff08\u8868\u793a\u6761\u4ef6\u6c38\u8fdc\u4e3a\u771f\uff09\n    \u4e5f\u53ef\u7528where\u8868\u793a\u8fde\u63a5\u6761\u4ef6\u3002\n    \u8fd8\u6709 using, \u4f46\u9700\u5b57\u6bb5\u540d\u76f8\u540c\u3002 using(\u5b57\u6bb5\u540d)\n    -- \u4ea4\u53c9\u8fde\u63a5 cross join\n        \u5373\uff0c\u6ca1\u6709\u6761\u4ef6\u7684\u5185\u8fde\u63a5\u3002\n        select * from tb1 cross join tb2;\n-- \u5916\u8fde\u63a5(outer join)\n    - \u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u4e5f\u4f1a\u51fa\u73b0\u5728\u8fde\u63a5\u7ed3\u679c\u4e2d\u3002\n    -- \u5de6\u5916\u8fde\u63a5 left join\n        \u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u5de6\u8868\u8bb0\u5f55\u4f1a\u51fa\u73b0\uff0c\u800c\u53f3\u8868\u4e3anull\u586b\u5145\n    -- \u53f3\u5916\u8fde\u63a5 right join\n        \u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u53f3\u8868\u8bb0\u5f55\u4f1a\u51fa\u73b0\uff0c\u800c\u5de6\u8868\u4e3anull\u586b\u5145\n-- \u81ea\u7136\u8fde\u63a5(natural join)\n    \u81ea\u52a8\u5224\u65ad\u8fde\u63a5\u6761\u4ef6\u5b8c\u6210\u8fde\u63a5\u3002\n    \u76f8\u5f53\u4e8e\u7701\u7565\u4e86using\uff0c\u4f1a\u81ea\u52a8\u67e5\u627e\u76f8\u540c\u5b57\u6bb5\u540d\u3002\n    natural join\n    natural left join\n    natural right join\n\nselect info.id, info.name, info.stu_num, extra_info.hobby, extra_info.sex from info, extra_info where info.stu_num = extra_info.stu_id;\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_11","title":"\u5bfc\u51fa","text":"<pre><code>select * into outfile \u6587\u4ef6\u5730\u5740 [\u63a7\u5236\u683c\u5f0f] from \u8868\u540d;   -- \u5bfc\u51fa\u8868\u6570\u636e\n\nload data [local] infile \u6587\u4ef6\u5730\u5740 [replace|ignore] into table \u8868\u540d [\u63a7\u5236\u683c\u5f0f]; -- \u5bfc\u5165\u6570\u636e\n    \u751f\u6210\u7684\u6570\u636e\u9ed8\u8ba4\u7684\u5206\u9694\u7b26\u662f\u5236\u8868\u7b26\n    local\u672a\u6307\u5b9a\uff0c\u5219\u6570\u636e\u6587\u4ef6\u5fc5\u987b\u5728\u670d\u52a1\u5668\u4e0a\n    replace \u548c ignore \u5173\u952e\u8bcd\u63a7\u5236\u5bf9\u73b0\u6709\u7684\u552f\u4e00\u952e\u8bb0\u5f55\u7684\u91cd\u590d\u7684\u5904\u7406\n-- \u63a7\u5236\u683c\u5f0f\nfields  \u63a7\u5236\u5b57\u6bb5\u683c\u5f0f\n\u9ed8\u8ba4\uff1afields terminated by       enclosed by    escaped by   \n    terminated by  string   -- \u7ec8\u6b62\n    enclosed by  char       -- \u5305\u88f9\n    escaped by  char        -- \u8f6c\u4e49\n    -- \u793a\u4f8b\uff1a\n        SELECT a,b,a+b INTO OUTFILE  /tmp/result.text \n        FIELDS TERMINATED BY  ,  OPTIONALLY ENCLOSED BY  \" \n        LINES TERMINATED BY  \n\n        FROM test_table;\nlines   \u63a7\u5236\u884c\u683c\u5f0f\n\u9ed8\u8ba4\uff1alines terminated by  \n\n    terminated by  string   -- \u7ec8\u6b62\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#insert","title":"INSERT","text":"<pre><code>select\u8bed\u53e5\u83b7\u5f97\u7684\u6570\u636e\u53ef\u4ee5\u7528insert\u63d2\u5165\u3002\n\u53ef\u4ee5\u7701\u7565\u5bf9\u5217\u7684\u6307\u5b9a\uff0c\u8981\u6c42 values () \u62ec\u53f7\u5185\uff0c\u63d0\u4f9b\u7ed9\u4e86\u6309\u7167\u5217\u987a\u5e8f\u51fa\u73b0\u7684\u6240\u6709\u5b57\u6bb5\u7684\u503c\u3002\n    \u6216\u8005\u4f7f\u7528set\u8bed\u6cd5\u3002\n    INSERT INTO tbl_name SET field=value,...\uff1b\n\u53ef\u4ee5\u4e00\u6b21\u6027\u4f7f\u7528\u591a\u4e2a\u503c\uff0c\u91c7\u7528(), (), ();\u7684\u5f62\u5f0f\u3002\n    INSERT INTO tbl_name VALUES (), (), ();\n\u53ef\u4ee5\u5728\u5217\u503c\u6307\u5b9a\u65f6\uff0c\u4f7f\u7528\u8868\u8fbe\u5f0f\u3002\n    INSERT INTO tbl_name VALUES (field_value, 10+10, now());\n\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u7279\u6b8a\u503c DEFAULT\uff0c\u8868\u793a\u8be5\u5217\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002\n    INSERT INTO tbl_name VALUES (field_value, DEFAULT);\n\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u4f5c\u4e3a\u9700\u8981\u63d2\u5165\u7684\u503c\u3002\n    INSERT INTO tbl_name SELECT ...;\n\u53ef\u4ee5\u6307\u5b9a\u5728\u63d2\u5165\u7684\u503c\u51fa\u73b0\u4e3b\u952e\uff08\u6216\u552f\u4e00\u7d22\u5f15\uff09\u51b2\u7a81\u65f6\uff0c\u66f4\u65b0\u5176\u4ed6\u975e\u4e3b\u952e\u5217\u7684\u4fe1\u606f\u3002\n    INSERT INTO tbl_name VALUES/SET/SELECT ON DUPLICATE KEY UPDATE \u5b57\u6bb5=\u503c, \u2026;\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#delete","title":"DELETE","text":"<pre><code>DELETE FROM tbl_name [WHERE where_definition] [ORDER BY ...] [LIMIT row_count]\n\u6309\u7167\u6761\u4ef6\u5220\u9664\u3002where\n\u6307\u5b9a\u5220\u9664\u7684\u6700\u591a\u8bb0\u5f55\u6570\u3002limit\n\u53ef\u4ee5\u901a\u8fc7\u6392\u5e8f\u6761\u4ef6\u5220\u9664\u3002order by + limit\n\u652f\u6301\u591a\u8868\u5220\u9664\uff0c\u4f7f\u7528\u7c7b\u4f3c\u8fde\u63a5\u8bed\u6cd5\u3002\ndelete from \u9700\u8981\u5220\u9664\u6570\u636e\u591a\u88681\uff0c\u88682 using \u8868\u8fde\u63a5\u64cd\u4f5c \u6761\u4ef6\u3002\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#truncate","title":"TRUNCATE","text":"<pre><code>TRUNCATE [TABLE] tbl_name\n\u6e05\u7a7a\u6570\u636e\n\u5220\u9664\u91cd\u5efa\u8868\n\u533a\u522b\uff1a\n1\uff0ctruncate \u662f\u5220\u9664\u8868\u518d\u521b\u5efa\uff0cdelete \u662f\u9010\u6761\u5220\u9664\n2\uff0ctruncate \u91cd\u7f6eauto_increment\u7684\u503c\u3002\u800cdelete\u4e0d\u4f1a\n3\uff0ctruncate \u4e0d\u77e5\u9053\u5220\u9664\u4e86\u51e0\u6761\uff0c\u800cdelete\u77e5\u9053\u3002\n4\uff0c\u5f53\u88ab\u7528\u4e8e\u5e26\u5206\u533a\u7684\u8868\u65f6\uff0ctruncate \u4f1a\u4fdd\u7559\u5206\u533a\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_12","title":"\u5907\u4efd\u4e0e\u8fd8\u539f","text":"<pre><code>\u5907\u4efd\uff0c\u5c06\u6570\u636e\u7684\u7ed3\u6784\u4e0e\u8868\u5185\u6570\u636e\u4fdd\u5b58\u8d77\u6765\u3002\n\u5229\u7528 mysqldump \u6307\u4ee4\u5b8c\u6210\u3002\n-- \u5bfc\u51fa\nmysqldump [options] db_name [tables]\nmysqldump [options] ---database DB1 [DB2 DB3...]\nmysqldump [options] --all--database\n1. \u5bfc\u51fa\u4e00\u5f20\u8868\n    mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d \u8868\u540d &gt; \u6587\u4ef6\u540d(D:/a.sql)\n2. \u5bfc\u51fa\u591a\u5f20\u8868\n    mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d \u88681 \u88682 \u88683 &gt; \u6587\u4ef6\u540d(D:/a.sql)\n3. \u5bfc\u51fa\u6240\u6709\u8868\n    mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d &gt; \u6587\u4ef6\u540d(D:/a.sql)\n4. \u5bfc\u51fa\u4e00\u4e2a\u5e93\n    mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 --lock-all-tables --database \u5e93\u540d &gt; \u6587\u4ef6\u540d(D:/a.sql)\n\u53ef\u4ee5-w\u643a\u5e26WHERE\u6761\u4ef6\n-- \u5bfc\u5165\n1. \u5728\u767b\u5f55mysql\u7684\u60c5\u51b5\u4e0b\uff1a\n    source  \u5907\u4efd\u6587\u4ef6\n2. \u5728\u4e0d\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\n    mysql -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d &lt; \u5907\u4efd\u6587\u4ef6\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_13","title":"\u89c6\u56fe","text":"<pre><code>\u4ec0\u4e48\u662f\u89c6\u56fe\uff1a\n    \u89c6\u56fe\u662f\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u5176\u5185\u5bb9\u7531\u67e5\u8be2\u5b9a\u4e49\u3002\u540c\u771f\u5b9e\u7684\u8868\u4e00\u6837\uff0c\u89c6\u56fe\u5305\u542b\u4e00\u7cfb\u5217\u5e26\u6709\u540d\u79f0\u7684\u5217\u548c\u884c\u6570\u636e\u3002\u4f46\u662f\uff0c\u89c6\u56fe\u5e76\u4e0d\u5728\u6570\u636e\u5e93\u4e2d\u4ee5\u5b58\u50a8\u7684\u6570\u636e\u503c\u96c6\u5f62\u5f0f\u5b58\u5728\u3002\u884c\u548c\u5217\u6570\u636e\u6765\u81ea\u7531\u5b9a\u4e49\u89c6\u56fe\u7684\u67e5\u8be2\u6240\u5f15\u7528\u7684\u8868\uff0c\u5e76\u4e14\u5728\u5f15\u7528\u89c6\u56fe\u65f6\u52a8\u6001\u751f\u6210\u3002\n    \u89c6\u56fe\u5177\u6709\u8868\u7ed3\u6784\u6587\u4ef6\uff0c\u4f46\u4e0d\u5b58\u5728\u6570\u636e\u6587\u4ef6\u3002\n    \u5bf9\u5176\u4e2d\u6240\u5f15\u7528\u7684\u57fa\u7840\u8868\u6765\u8bf4\uff0c\u89c6\u56fe\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e\u7b5b\u9009\u3002\u5b9a\u4e49\u89c6\u56fe\u7684\u7b5b\u9009\u53ef\u4ee5\u6765\u81ea\u5f53\u524d\u6216\u5176\u5b83\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u8868\uff0c\u6216\u8005\u5176\u5b83\u89c6\u56fe\u3002\u901a\u8fc7\u89c6\u56fe\u8fdb\u884c\u67e5\u8be2\u6ca1\u6709\u4efb\u4f55\u9650\u5236\uff0c\u901a\u8fc7\u5b83\u4eec\u8fdb\u884c\u6570\u636e\u4fee\u6539\u65f6\u7684\u9650\u5236\u4e5f\u5f88\u5c11\u3002\n    \u89c6\u56fe\u662f\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u7684\u67e5\u8be2\u7684sql\u8bed\u53e5\uff0c\u5b83\u4e3b\u8981\u51fa\u4e8e\u4e24\u79cd\u539f\u56e0\uff1a\u5b89\u5168\u539f\u56e0\uff0c\u89c6\u56fe\u53ef\u4ee5\u9690\u85cf\u4e00\u4e9b\u6570\u636e\uff0c\u5982\uff1a\u793e\u4f1a\u4fdd\u9669\u57fa\u91d1\u8868\uff0c\u53ef\u4ee5\u7528\u89c6\u56fe\u53ea\u663e\u793a\u59d3\u540d\uff0c\u5730\u5740\uff0c\u800c\u4e0d\u663e\u793a\u793e\u4f1a\u4fdd\u9669\u53f7\u548c\u5de5\u8d44\u6570\u7b49\uff0c\u53e6\u4e00\u539f\u56e0\u662f\u53ef\u4f7f\u590d\u6742\u7684\u67e5\u8be2\u6613\u4e8e\u7406\u89e3\u548c\u4f7f\u7528\u3002\n-- \u521b\u5efa\u89c6\u56fe\nCREATE [OR REPLACE] [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}] VIEW view_name [(column_list)] AS select_statement\n    - \u89c6\u56fe\u540d\u5fc5\u987b\u552f\u4e00\uff0c\u540c\u65f6\u4e0d\u80fd\u4e0e\u8868\u91cd\u540d\u3002\n    - \u89c6\u56fe\u53ef\u4ee5\u4f7f\u7528select\u8bed\u53e5\u67e5\u8be2\u5230\u7684\u5217\u540d\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u6307\u5b9a\u76f8\u5e94\u7684\u5217\u540d\u3002\n    - \u53ef\u4ee5\u6307\u5b9a\u89c6\u56fe\u6267\u884c\u7684\u7b97\u6cd5\uff0c\u901a\u8fc7ALGORITHM\u6307\u5b9a\u3002\n    - column_list\u5982\u679c\u5b58\u5728\uff0c\u5219\u6570\u76ee\u5fc5\u987b\u7b49\u4e8eSELECT\u8bed\u53e5\u68c0\u7d22\u7684\u5217\u6570\n-- \u67e5\u770b\u7ed3\u6784\n    SHOW CREATE VIEW view_name\n-- \u5220\u9664\u89c6\u56fe\n    - \u5220\u9664\u89c6\u56fe\u540e\uff0c\u6570\u636e\u4f9d\u7136\u5b58\u5728\u3002\n    - \u53ef\u540c\u65f6\u5220\u9664\u591a\u4e2a\u89c6\u56fe\u3002\n    DROP VIEW [IF EXISTS] view_name ...\n-- \u4fee\u6539\u89c6\u56fe\u7ed3\u6784\n    - \u4e00\u822c\u4e0d\u4fee\u6539\u89c6\u56fe\uff0c\u56e0\u4e3a\u4e0d\u662f\u6240\u6709\u7684\u66f4\u65b0\u89c6\u56fe\u90fd\u4f1a\u6620\u5c04\u5230\u8868\u4e0a\u3002\n    ALTER VIEW view_name [(column_list)] AS select_statement\n-- \u89c6\u56fe\u4f5c\u7528\n    1. \u7b80\u5316\u4e1a\u52a1\u903b\u8f91\n    2. \u5bf9\u5ba2\u6237\u7aef\u9690\u85cf\u771f\u5b9e\u7684\u8868\u7ed3\u6784\n-- \u89c6\u56fe\u7b97\u6cd5(ALGORITHM)\n    MERGE       \u5408\u5e76\n        \u5c06\u89c6\u56fe\u7684\u67e5\u8be2\u8bed\u53e5\uff0c\u4e0e\u5916\u90e8\u67e5\u8be2\u9700\u8981\u5148\u5408\u5e76\u518d\u6267\u884c\uff01\n    TEMPTABLE   \u4e34\u65f6\u8868\n        \u5c06\u89c6\u56fe\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u5f62\u6210\u4e34\u65f6\u8868\uff0c\u518d\u505a\u5916\u5c42\u67e5\u8be2\uff01\n    UNDEFINED   \u672a\u5b9a\u4e49(\u9ed8\u8ba4)\uff0c\u6307\u7684\u662fMySQL\u81ea\u4e3b\u53bb\u9009\u62e9\u76f8\u5e94\u7684\u7b97\u6cd5\u3002\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#transaction","title":"\u4e8b\u52a1(transaction)","text":"<pre><code>\u4e8b\u52a1\u662f\u6307\u903b\u8f91\u4e0a\u7684\u4e00\u7ec4\u64cd\u4f5c\uff0c\u7ec4\u6210\u8fd9\u7ec4\u64cd\u4f5c\u7684\u5404\u4e2a\u5355\u5143\uff0c\u8981\u4e0d\u5168\u6210\u529f\u8981\u4e0d\u5168\u5931\u8d25\u3002\n    - \u652f\u6301\u8fde\u7eedSQL\u7684\u96c6\u4f53\u6210\u529f\u6216\u96c6\u4f53\u64a4\u9500\u3002\n    - \u4e8b\u52a1\u662f\u6570\u636e\u5e93\u5728\u6570\u636e\u665a\u81ea\u4e60\u65b9\u9762\u7684\u4e00\u4e2a\u529f\u80fd\u3002\n    - \u9700\u8981\u5229\u7528 InnoDB \u6216 BDB \u5b58\u50a8\u5f15\u64ce\uff0c\u5bf9\u81ea\u52a8\u63d0\u4ea4\u7684\u7279\u6027\u652f\u6301\u5b8c\u6210\u3002\n    - InnoDB\u88ab\u79f0\u4e3a\u4e8b\u52a1\u5b89\u5168\u578b\u5f15\u64ce\u3002\n-- \u4e8b\u52a1\u5f00\u542f\n    START TRANSACTION; \u6216\u8005 BEGIN;\n    \u5f00\u542f\u4e8b\u52a1\u540e\uff0c\u6240\u6709\u88ab\u6267\u884c\u7684SQL\u8bed\u53e5\u5747\u88ab\u8ba4\u4f5c\u5f53\u524d\u4e8b\u52a1\u5185\u7684SQL\u8bed\u53e5\u3002\n-- \u4e8b\u52a1\u63d0\u4ea4\n    COMMIT;\n-- \u4e8b\u52a1\u56de\u6eda\n    ROLLBACK;\n    \u5982\u679c\u90e8\u5206\u64cd\u4f5c\u53d1\u751f\u95ee\u9898\uff0c\u6620\u5c04\u5230\u4e8b\u52a1\u5f00\u542f\u524d\u3002\n-- \u4e8b\u52a1\u7684\u7279\u6027\n    1. \u539f\u5b50\u6027\uff08Atomicity\uff09\n        \u4e8b\u52a1\u662f\u4e00\u4e2a\u4e0d\u53ef\u5206\u5272\u7684\u5de5\u4f5c\u5355\u4f4d\uff0c\u4e8b\u52a1\u4e2d\u7684\u64cd\u4f5c\u8981\u4e48\u90fd\u53d1\u751f\uff0c\u8981\u4e48\u90fd\u4e0d\u53d1\u751f\u3002\n    2. \u4e00\u81f4\u6027\uff08Consistency\uff09\n        \u4e8b\u52a1\u524d\u540e\u6570\u636e\u7684\u5b8c\u6574\u6027\u5fc5\u987b\u4fdd\u6301\u4e00\u81f4\u3002\n        - \u4e8b\u52a1\u5f00\u59cb\u548c\u7ed3\u675f\u65f6\uff0c\u5916\u90e8\u6570\u636e\u4e00\u81f4\n        - \u5728\u6574\u4e2a\u4e8b\u52a1\u8fc7\u7a0b\u4e2d\uff0c\u64cd\u4f5c\u662f\u8fde\u7eed\u7684\n    3. \u9694\u79bb\u6027\uff08Isolation\uff09\n        \u591a\u4e2a\u7528\u6237\u5e76\u53d1\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\uff0c\u4e00\u4e2a\u7528\u6237\u7684\u4e8b\u52a1\u4e0d\u80fd\u88ab\u5176\u5b83\u7528\u6237\u7684\u4e8b\u7269\u6240\u5e72\u6270\uff0c\u591a\u4e2a\u5e76\u53d1\u4e8b\u52a1\u4e4b\u95f4\u7684\u6570\u636e\u8981\u76f8\u4e92\u9694\u79bb\u3002\n    4. \u6301\u4e45\u6027\uff08Durability\uff09\n        \u4e00\u4e2a\u4e8b\u52a1\u4e00\u65e6\u88ab\u63d0\u4ea4\uff0c\u5b83\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u6539\u53d8\u5c31\u662f\u6c38\u4e45\u6027\u7684\u3002\n-- \u4e8b\u52a1\u7684\u5b9e\u73b0\n    1. \u8981\u6c42\u662f\u4e8b\u52a1\u652f\u6301\u7684\u8868\u7c7b\u578b\n    2. \u6267\u884c\u4e00\u7ec4\u76f8\u5173\u7684\u64cd\u4f5c\u524d\u5f00\u542f\u4e8b\u52a1\n    3. \u6574\u7ec4\u64cd\u4f5c\u5b8c\u6210\u540e\uff0c\u90fd\u6210\u529f\uff0c\u5219\u63d0\u4ea4\uff1b\u5982\u679c\u5b58\u5728\u5931\u8d25\uff0c\u9009\u62e9\u56de\u6eda\uff0c\u5219\u4f1a\u56de\u5230\u4e8b\u52a1\u5f00\u59cb\u7684\u5907\u4efd\u70b9\u3002\n-- \u4e8b\u52a1\u7684\u539f\u7406\n    \u5229\u7528InnoDB\u7684\u81ea\u52a8\u63d0\u4ea4(autocommit)\u7279\u6027\u5b8c\u6210\u3002\n    \u666e\u901a\u7684MySQL\u6267\u884c\u8bed\u53e5\u540e\uff0c\u5f53\u524d\u7684\u6570\u636e\u63d0\u4ea4\u64cd\u4f5c\u5747\u53ef\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u53ef\u89c1\u3002\n    \u800c\u4e8b\u52a1\u662f\u6682\u65f6\u5173\u95ed\u201c\u81ea\u52a8\u63d0\u4ea4\u201d\u673a\u5236\uff0c\u9700\u8981commit\u63d0\u4ea4\u6301\u4e45\u5316\u6570\u636e\u64cd\u4f5c\u3002\n-- \u6ce8\u610f\n    1. \u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff08DDL\uff09\u8bed\u53e5\u4e0d\u80fd\u88ab\u56de\u6eda\uff0c\u6bd4\u5982\u521b\u5efa\u6216\u53d6\u6d88\u6570\u636e\u5e93\u7684\u8bed\u53e5\uff0c\u548c\u521b\u5efa\u3001\u53d6\u6d88\u6216\u66f4\u6539\u8868\u6216\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f\u7684\u8bed\u53e5\u3002\n    2. \u4e8b\u52a1\u4e0d\u80fd\u88ab\u5d4c\u5957\n-- \u4fdd\u5b58\u70b9\n    SAVEPOINT \u4fdd\u5b58\u70b9\u540d\u79f0 -- \u8bbe\u7f6e\u4e00\u4e2a\u4e8b\u52a1\u4fdd\u5b58\u70b9\n    ROLLBACK TO SAVEPOINT \u4fdd\u5b58\u70b9\u540d\u79f0 -- \u56de\u6eda\u5230\u4fdd\u5b58\u70b9\n    RELEASE SAVEPOINT \u4fdd\u5b58\u70b9\u540d\u79f0 -- \u5220\u9664\u4fdd\u5b58\u70b9\n-- InnoDB\u81ea\u52a8\u63d0\u4ea4\u7279\u6027\u8bbe\u7f6e\n    SET autocommit = 0|1;   0\u8868\u793a\u5173\u95ed\u81ea\u52a8\u63d0\u4ea4\uff0c1\u8868\u793a\u5f00\u542f\u81ea\u52a8\u63d0\u4ea4\u3002\n    - \u5982\u679c\u5173\u95ed\u4e86\uff0c\u90a3\u666e\u901a\u64cd\u4f5c\u7684\u7ed3\u679c\u5bf9\u5176\u4ed6\u5ba2\u6237\u7aef\u4e5f\u4e0d\u53ef\u89c1\uff0c\u9700\u8981commit\u63d0\u4ea4\u540e\u624d\u80fd\u6301\u4e45\u5316\u6570\u636e\u64cd\u4f5c\u3002\n    - \u4e5f\u53ef\u4ee5\u5173\u95ed\u81ea\u52a8\u63d0\u4ea4\u6765\u5f00\u542f\u4e8b\u52a1\u3002\u4f46\u4e0eSTART TRANSACTION\u4e0d\u540c\u7684\u662f\uff0c\n        SET autocommit\u662f\u6c38\u4e45\u6539\u53d8\u670d\u52a1\u5668\u7684\u8bbe\u7f6e\uff0c\u76f4\u5230\u4e0b\u6b21\u518d\u6b21\u4fee\u6539\u8be5\u8bbe\u7f6e\u3002(\u9488\u5bf9\u5f53\u524d\u8fde\u63a5)\n        \u800cSTART TRANSACTION\u8bb0\u5f55\u5f00\u542f\u524d\u7684\u72b6\u6001\uff0c\u800c\u4e00\u65e6\u4e8b\u52a1\u63d0\u4ea4\u6216\u56de\u6eda\u540e\u5c31\u9700\u8981\u518d\u6b21\u5f00\u542f\u4e8b\u52a1\u3002(\u9488\u5bf9\u5f53\u524d\u4e8b\u52a1)\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_14","title":"\u9501\u8868","text":"<pre><code>\u8868\u9501\u5b9a\u53ea\u7528\u4e8e\u9632\u6b62\u5176\u5b83\u5ba2\u6237\u7aef\u8fdb\u884c\u4e0d\u6b63\u5f53\u5730\u8bfb\u53d6\u548c\u5199\u5165\nMyISAM \u652f\u6301\u8868\u9501\uff0cInnoDB \u652f\u6301\u884c\u9501\n-- \u9501\u5b9a\n    LOCK TABLES tbl_name [AS alias]\n-- \u89e3\u9501\n    UNLOCK TABLES\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_15","title":"\u89e6\u53d1\u5668","text":"<pre><code>   \u89e6\u53d1\u7a0b\u5e8f\u662f\u4e0e\u8868\u6709\u5173\u7684\u547d\u540d\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u5f53\u8be5\u8868\u51fa\u73b0\u7279\u5b9a\u4e8b\u4ef6\u65f6\uff0c\u5c06\u6fc0\u6d3b\u8be5\u5bf9\u8c61\n    \u76d1\u542c\uff1a\u8bb0\u5f55\u7684\u589e\u52a0\u3001\u4fee\u6539\u3001\u5220\u9664\u3002\n-- \u521b\u5efa\u89e6\u53d1\u5668\nCREATE TRIGGER trigger_name trigger_time trigger_event ON tbl_name FOR EACH ROW trigger_stmt\n    \u53c2\u6570\uff1a\n    trigger_time\u662f\u89e6\u53d1\u7a0b\u5e8f\u7684\u52a8\u4f5c\u65f6\u95f4\u3002\u5b83\u53ef\u4ee5\u662f before \u6216 after\uff0c\u4ee5\u6307\u660e\u89e6\u53d1\u7a0b\u5e8f\u662f\u5728\u6fc0\u6d3b\u5b83\u7684\u8bed\u53e5\u4e4b\u524d\u6216\u4e4b\u540e\u89e6\u53d1\u3002\n    trigger_event\u6307\u660e\u4e86\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f\u7684\u8bed\u53e5\u7684\u7c7b\u578b\n        INSERT\uff1a\u5c06\u65b0\u884c\u63d2\u5165\u8868\u65f6\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f\n        UPDATE\uff1a\u66f4\u6539\u67d0\u4e00\u884c\u65f6\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f\n        DELETE\uff1a\u4ece\u8868\u4e2d\u5220\u9664\u67d0\u4e00\u884c\u65f6\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f\n    tbl_name\uff1a\u76d1\u542c\u7684\u8868\uff0c\u5fc5\u987b\u662f\u6c38\u4e45\u6027\u7684\u8868\uff0c\u4e0d\u80fd\u5c06\u89e6\u53d1\u7a0b\u5e8f\u4e0eTEMPORARY\u8868\u6216\u89c6\u56fe\u5173\u8054\u8d77\u6765\u3002\n    trigger_stmt\uff1a\u5f53\u89e6\u53d1\u7a0b\u5e8f\u6fc0\u6d3b\u65f6\u6267\u884c\u7684\u8bed\u53e5\u3002\u6267\u884c\u591a\u4e2a\u8bed\u53e5\uff0c\u53ef\u4f7f\u7528BEGIN...END\u590d\u5408\u8bed\u53e5\u7ed3\u6784\n-- \u5220\u9664\nDROP TRIGGER [schema_name.]trigger_name\n\u53ef\u4ee5\u4f7f\u7528old\u548cnew\u4ee3\u66ff\u65e7\u7684\u548c\u65b0\u7684\u6570\u636e\n    \u66f4\u65b0\u64cd\u4f5c\uff0c\u66f4\u65b0\u524d\u662fold\uff0c\u66f4\u65b0\u540e\u662fnew.\n    \u5220\u9664\u64cd\u4f5c\uff0c\u53ea\u6709old.\n    \u589e\u52a0\u64cd\u4f5c\uff0c\u53ea\u6709new.\n-- \u6ce8\u610f\n    1. \u5bf9\u4e8e\u5177\u6709\u76f8\u540c\u89e6\u53d1\u7a0b\u5e8f\u52a8\u4f5c\u65f6\u95f4\u548c\u4e8b\u4ef6\u7684\u7ed9\u5b9a\u8868\uff0c\u4e0d\u80fd\u6709\u4e24\u4e2a\u89e6\u53d1\u7a0b\u5e8f\u3002\n</code></pre> <pre><code>-- \u5b57\u7b26\u8fde\u63a5\u51fd\u6570\nconcat(str1,str2,...])\nconcat_ws(separator,str1,str2,...)\n\n-- \u5206\u652f\u8bed\u53e5\nif \u6761\u4ef6 then\n    \u6267\u884c\u8bed\u53e5\nelseif \u6761\u4ef6 then\n    \u6267\u884c\u8bed\u53e5\nelse\n    \u6267\u884c\u8bed\u53e5\nend if;\n\n-- \u4fee\u6539\u6700\u5916\u5c42\u8bed\u53e5\u7ed3\u675f\u7b26\ndelimiter \u81ea\u5b9a\u4e49\u7ed3\u675f\u7b26\u53f7\n    SQL\u8bed\u53e5\n\u81ea\u5b9a\u4e49\u7ed3\u675f\u7b26\u53f7\ndelimiter ;     -- \u4fee\u6539\u56de\u539f\u6765\u7684\u5206\u53f7\n\n-- \u8bed\u53e5\u5757\u5305\u88f9\nbegin\n    \u8bed\u53e5\u5757\nend\n\n-- \u7279\u6b8a\u7684\u6267\u884c\n1. \u53ea\u8981\u6dfb\u52a0\u8bb0\u5f55\uff0c\u5c31\u4f1a\u89e6\u53d1\u7a0b\u5e8f\u3002\n2. Insert into on duplicate key update \u8bed\u6cd5\u4f1a\u89e6\u53d1\uff1a\n    \u5982\u679c\u6ca1\u6709\u91cd\u590d\u8bb0\u5f55\uff0c\u4f1a\u89e6\u53d1 before insert, after insert;\n    \u5982\u679c\u6709\u91cd\u590d\u8bb0\u5f55\u5e76\u66f4\u65b0\uff0c\u4f1a\u89e6\u53d1 before insert, before update, after update;\n    \u5982\u679c\u6709\u91cd\u590d\u8bb0\u5f55\u4f46\u662f\u6ca1\u6709\u53d1\u751f\u66f4\u65b0\uff0c\u5219\u89e6\u53d1 before insert, before update\n3. Replace \u8bed\u6cd5 \u5982\u679c\u6709\u8bb0\u5f55\uff0c\u5219\u6267\u884c before insert, before delete, after delete, after insert\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#sql","title":"SQL\u7f16\u7a0b","text":"<pre><code>--// \u5c40\u90e8\u53d8\u91cf ----------\n-- \u53d8\u91cf\u58f0\u660e\n    declare var_name[,...] type [default value]\n    \u8fd9\u4e2a\u8bed\u53e5\u88ab\u7528\u6765\u58f0\u660e\u5c40\u90e8\u53d8\u91cf\u3002\u8981\u7ed9\u53d8\u91cf\u63d0\u4f9b\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u8bf7\u5305\u542b\u4e00\u4e2adefault\u5b50\u53e5\u3002\u503c\u53ef\u4ee5\u88ab\u6307\u5b9a\u4e3a\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u4e0d\u9700\u8981\u4e3a\u4e00\u4e2a\u5e38\u6570\u3002\u5982\u679c\u6ca1\u6709default\u5b50\u53e5\uff0c\u521d\u59cb\u503c\u4e3anull\u3002\n-- \u8d4b\u503c\n    \u4f7f\u7528 set \u548c select into \u8bed\u53e5\u4e3a\u53d8\u91cf\u8d4b\u503c\u3002\n    - \u6ce8\u610f\uff1a\u5728\u51fd\u6570\u5185\u662f\u53ef\u4ee5\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\uff08\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u53d8\u91cf\uff09\n\n\n--// \u5168\u5c40\u53d8\u91cf ----------\n-- \u5b9a\u4e49\u3001\u8d4b\u503c\nset \u8bed\u53e5\u53ef\u4ee5\u5b9a\u4e49\u5e76\u4e3a\u53d8\u91cf\u8d4b\u503c\u3002\nset @var = value;\n\u4e5f\u53ef\u4ee5\u4f7f\u7528select into\u8bed\u53e5\u4e3a\u53d8\u91cf\u521d\u59cb\u5316\u5e76\u8d4b\u503c\u3002\u8fd9\u6837\u8981\u6c42select\u8bed\u53e5\u53ea\u80fd\u8fd4\u56de\u4e00\u884c\uff0c\u4f46\u662f\u53ef\u4ee5\u662f\u591a\u4e2a\u5b57\u6bb5\uff0c\u5c31\u610f\u5473\u7740\u540c\u65f6\u4e3a\u591a\u4e2a\u53d8\u91cf\u8fdb\u884c\u8d4b\u503c\uff0c\u53d8\u91cf\u7684\u6570\u91cf\u9700\u8981\u4e0e\u67e5\u8be2\u7684\u5217\u6570\u4e00\u81f4\u3002\n\u8fd8\u53ef\u4ee5\u628a\u8d4b\u503c\u8bed\u53e5\u770b\u4f5c\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u901a\u8fc7select\u6267\u884c\u5b8c\u6210\u3002\u6b64\u65f6\u4e3a\u4e86\u907f\u514d=\u88ab\u5f53\u4f5c\u5173\u7cfb\u8fd0\u7b97\u7b26\u770b\u5f85\uff0c\u4f7f\u7528:=\u4ee3\u66ff\u3002\uff08set\u8bed\u53e5\u53ef\u4ee5\u4f7f\u7528= \u548c :=\uff09\u3002\nselect @var:=20;\nselect @v1:=id, @v2=name from t1 limit 1;\nselect * from tbl_name where @var:=30;\nselect into \u53ef\u4ee5\u5c06\u8868\u4e2d\u67e5\u8be2\u83b7\u5f97\u7684\u6570\u636e\u8d4b\u7ed9\u53d8\u91cf\u3002\n    -| select max(height) into @max_height from tb;\n-- \u81ea\u5b9a\u4e49\u53d8\u91cf\u540d\n\u4e3a\u4e86\u907f\u514dselect\u8bed\u53e5\u4e2d\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u53d8\u91cf\u4e0e\u7cfb\u7edf\u6807\u8bc6\u7b26\uff08\u901a\u5e38\u662f\u5b57\u6bb5\u540d\uff09\u51b2\u7a81\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u53d8\u91cf\u5728\u53d8\u91cf\u540d\u524d\u4f7f\u7528@\u4f5c\u4e3a\u5f00\u59cb\u7b26\u53f7\u3002\n@var=10;\n    - \u53d8\u91cf\u88ab\u5b9a\u4e49\u540e\uff0c\u5728\u6574\u4e2a\u4f1a\u8bdd\u5468\u671f\u90fd\u6709\u6548\uff08\u767b\u5f55\u5230\u9000\u51fa\uff09\n\n\n\n--// \u63a7\u5236\u7ed3\u6784 ----------\n-- if\u8bed\u53e5\nif search_condition then\n    statement_list   \n[elseif search_condition then\n    statement_list]\n...\n[else\n    statement_list]\nend if;\n-- case\u8bed\u53e5\nCASE value WHEN [compare-value] THEN result\n[WHEN [compare-value] THEN result ...]\n[ELSE result]\nEND\n-- while\u5faa\u73af\n[begin_label:] while search_condition do\n    statement_list\nend while [end_label];\n- \u5982\u679c\u9700\u8981\u5728\u5faa\u73af\u5185\u63d0\u524d\u7ec8\u6b62 while\u5faa\u73af\uff0c\u5219\u9700\u8981\u4f7f\u7528\u6807\u7b7e\uff1b\u6807\u7b7e\u9700\u8981\u6210\u5bf9\u51fa\u73b0\u3002\n    -- \u9000\u51fa\u5faa\u73af\n        \u9000\u51fa\u6574\u4e2a\u5faa\u73af leave\n        \u9000\u51fa\u5f53\u524d\u5faa\u73af iterate\n        \u901a\u8fc7\u9000\u51fa\u7684\u6807\u7b7e\u51b3\u5b9a\u9000\u51fa\u54ea\u4e2a\u5faa\u73af\n\n\n\n--// \u5185\u7f6e\u51fd\u6570 ----------\n-- \u6570\u503c\u51fd\u6570\nabs(x)          -- \u7edd\u5bf9\u503c abs(-10.9) = 10\nformat(x, d)    -- \u683c\u5f0f\u5316\u5343\u5206\u4f4d\u6570\u503c format(1234567.456, 2) = 1,234,567.46\nceil(x)         -- \u5411\u4e0a\u53d6\u6574 ceil(10.1) = 11\nfloor(x)        -- \u5411\u4e0b\u53d6\u6574 floor (10.1) = 10\nround(x)        -- \u56db\u820d\u4e94\u5165\u53bb\u6574\nmod(m, n)       -- m%n m mod n \u6c42\u4f59 10%3=1\npi()            -- \u83b7\u5f97\u5706\u5468\u7387\npow(m, n)       -- m^n\nsqrt(x)         -- \u7b97\u672f\u5e73\u65b9\u6839\nrand()          -- \u968f\u673a\u6570\ntruncate(x, d)  -- \u622a\u53d6d\u4f4d\u5c0f\u6570\n-- \u65f6\u95f4\u65e5\u671f\u51fd\u6570\nnow(), current_timestamp();     -- \u5f53\u524d\u65e5\u671f\u65f6\u95f4\ncurrent_date();                 -- \u5f53\u524d\u65e5\u671f\ncurrent_time();                 -- \u5f53\u524d\u65f6\u95f4\ndate( yyyy-mm-dd hh:ii:ss );    -- \u83b7\u53d6\u65e5\u671f\u90e8\u5206\ntime( yyyy-mm-dd hh:ii:ss );    -- \u83b7\u53d6\u65f6\u95f4\u90e8\u5206\ndate_format( yyyy-mm-dd hh:ii:ss ,  %d %y %a %d %m %b %j ); -- \u683c\u5f0f\u5316\u65f6\u95f4\nunix_timestamp();               -- \u83b7\u5f97unix\u65f6\u95f4\u6233\nfrom_unixtime();                -- \u4ece\u65f6\u95f4\u6233\u83b7\u5f97\u65f6\u95f4\n-- \u5b57\u7b26\u4e32\u51fd\u6570\nlength(string)          -- string\u957f\u5ea6\uff0c\u5b57\u8282\nchar_length(string)     -- string\u7684\u5b57\u7b26\u4e2a\u6570\nsubstring(str, position [,length])      -- \u4ecestr\u7684position\u5f00\u59cb,\u53d6length\u4e2a\u5b57\u7b26\nreplace(str ,search_str ,replace_str)   -- \u5728str\u4e2d\u7528replace_str\u66ff\u6362search_str\ninstr(string ,substring)    -- \u8fd4\u56desubstring\u9996\u6b21\u5728string\u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e\nconcat(string [,...])   -- \u8fde\u63a5\u5b57\u4e32\ncharset(str)            -- \u8fd4\u56de\u5b57\u4e32\u5b57\u7b26\u96c6\nlcase(string)           -- \u8f6c\u6362\u6210\u5c0f\u5199\nleft(string, length)    -- \u4ecestring2\u4e2d\u7684\u5de6\u8fb9\u8d77\u53d6length\u4e2a\u5b57\u7b26\nload_file(file_name)    -- \u4ece\u6587\u4ef6\u8bfb\u53d6\u5185\u5bb9\nlocate(substring, string [,start_position]) -- \u540cinstr,\u4f46\u53ef\u6307\u5b9a\u5f00\u59cb\u4f4d\u7f6e\nlpad(string, length, pad)   -- \u91cd\u590d\u7528pad\u52a0\u5728string\u5f00\u5934,\u76f4\u5230\u5b57\u4e32\u957f\u5ea6\u4e3alength\nltrim(string)           -- \u53bb\u9664\u524d\u7aef\u7a7a\u683c\nrepeat(string, count)   -- \u91cd\u590dcount\u6b21\nrpad(string, length, pad)   --\u5728str\u540e\u7528pad\u8865\u5145,\u76f4\u5230\u957f\u5ea6\u4e3alength\nrtrim(string)           -- \u53bb\u9664\u540e\u7aef\u7a7a\u683c\nstrcmp(string1 ,string2)    -- \u9010\u5b57\u7b26\u6bd4\u8f83\u4e24\u5b57\u4e32\u5927\u5c0f\n-- \u6d41\u7a0b\u51fd\u6570\ncase when [condition] then result [when [condition] then result ...] [else result] end   \u591a\u5206\u652f\nif(expr1,expr2,expr3)  \u53cc\u5206\u652f\u3002\n-- \u805a\u5408\u51fd\u6570\ncount()\nsum();\nmax();\nmin();\navg();\ngroup_concat()\n-- \u5176\u4ed6\u5e38\u7528\u51fd\u6570\nmd5();\ndefault();\n\n--// \u5b58\u50a8\u51fd\u6570\uff0c\u81ea\u5b9a\u4e49\u51fd\u6570 ----------\n-- \u65b0\u5efa\n    CREATE FUNCTION function_name (\u53c2\u6570\u5217\u8868) RETURNS \u8fd4\u56de\u503c\u7c7b\u578b\n        \u51fd\u6570\u4f53\n    - \u51fd\u6570\u540d\uff0c\u5e94\u8be5\u5408\u6cd5\u7684\u6807\u8bc6\u7b26\uff0c\u5e76\u4e14\u4e0d\u5e94\u8be5\u4e0e\u5df2\u6709\u7684\u5173\u952e\u5b57\u51b2\u7a81\u3002\n    - \u4e00\u4e2a\u51fd\u6570\u5e94\u8be5\u5c5e\u4e8e\u67d0\u4e2a\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528db_name.funciton_name\u7684\u5f62\u5f0f\u6267\u884c\u5f53\u524d\u51fd\u6570\u6240\u5c5e\u6570\u636e\u5e93\uff0c\u5426\u5219\u4e3a\u5f53\u524d\u6570\u636e\u5e93\u3002\n    - \u53c2\u6570\u90e8\u5206\uff0c\u7531\"\u53c2\u6570\u540d\"\u548c\"\u53c2\u6570\u7c7b\u578b\"\u7ec4\u6210\u3002\u591a\u4e2a\u53c2\u6570\u7528\u9017\u53f7\u9694\u5f00\u3002\n    - \u51fd\u6570\u4f53\u7531\u591a\u6761\u53ef\u7528\u7684mysql\u8bed\u53e5\uff0c\u6d41\u7a0b\u63a7\u5236\uff0c\u53d8\u91cf\u58f0\u660e\u7b49\u8bed\u53e5\u6784\u6210\u3002\n    - \u591a\u6761\u8bed\u53e5\u5e94\u8be5\u4f7f\u7528 begin...end \u8bed\u53e5\u5757\u5305\u542b\u3002\n    - \u4e00\u5b9a\u8981\u6709 return \u8fd4\u56de\u503c\u8bed\u53e5\u3002\n-- \u5220\u9664\n    DROP FUNCTION [IF EXISTS] function_name;\n-- \u67e5\u770b\n    SHOW FUNCTION STATUS LIKE  partten \n    SHOW CREATE FUNCTION function_name;\n-- \u4fee\u6539\n    ALTER FUNCTION function_name \u51fd\u6570\u9009\u9879\n\n--// \u5b58\u50a8\u8fc7\u7a0b\uff0c\u81ea\u5b9a\u4e49\u529f\u80fd ----------\n-- \u5b9a\u4e49\n\u5b58\u50a8\u5b58\u50a8\u8fc7\u7a0b \u662f\u4e00\u6bb5\u4ee3\u7801\uff08\u8fc7\u7a0b\uff09\uff0c\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u7684sql\u7ec4\u6210\u3002\n\u4e00\u4e2a\u5b58\u50a8\u8fc7\u7a0b\u901a\u5e38\u7528\u4e8e\u5b8c\u6210\u4e00\u6bb5\u4e1a\u52a1\u903b\u8f91\uff0c\u4f8b\u5982\u62a5\u540d\uff0c\u4ea4\u73ed\u8d39\uff0c\u8ba2\u5355\u5165\u5e93\u7b49\u3002\n\u800c\u4e00\u4e2a\u51fd\u6570\u901a\u5e38\u4e13\u6ce8\u4e0e\u67d0\u4e2a\u529f\u80fd\uff0c\u89c6\u4e3a\u5176\u4ed6\u7a0b\u5e8f\u670d\u52a1\u7684\uff0c\u9700\u8981\u5728\u5176\u4ed6\u8bed\u53e5\u4e2d\u8c03\u7528\u51fd\u6570\u624d\u53ef\u4ee5\uff0c\u800c\u5b58\u50a8\u8fc7\u7a0b\u4e0d\u80fd\u88ab\u5176\u4ed6\u8c03\u7528\uff0c\u662f\u81ea\u5df1\u6267\u884c \u901a\u8fc7call\u6267\u884c\u3002\n-- \u521b\u5efa\nCREATE PROCEDURE sp_name (\u53c2\u6570\u5217\u8868)\n    \u8fc7\u7a0b\u4f53\n\u53c2\u6570\u5217\u8868\uff1a\u4e0d\u540c\u4e8e\u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\uff0c\u9700\u8981\u6307\u660e\u53c2\u6570\u7c7b\u578b\nIN\uff0c\u8868\u793a\u8f93\u5165\u578b\nOUT\uff0c\u8868\u793a\u8f93\u51fa\u578b\nINOUT\uff0c\u8868\u793a\u6df7\u5408\u578b\n\u6ce8\u610f\uff0c\u6ca1\u6709\u8fd4\u56de\u503c\u3002\n\n\n/* \u5b58\u50a8\u8fc7\u7a0b */ ------------------\n\u5b58\u50a8\u8fc7\u7a0b\u662f\u4e00\u6bb5\u53ef\u6267\u884c\u6027\u4ee3\u7801\u7684\u96c6\u5408\u3002\u76f8\u6bd4\u51fd\u6570\uff0c\u66f4\u504f\u5411\u4e8e\u4e1a\u52a1\u903b\u8f91\u3002\n\u8c03\u7528\uff1aCALL \u8fc7\u7a0b\u540d\n-- \u6ce8\u610f\n- \u6ca1\u6709\u8fd4\u56de\u503c\u3002\n- \u53ea\u80fd\u5355\u72ec\u8c03\u7528\uff0c\u4e0d\u53ef\u5939\u6742\u5728\u5176\u4ed6\u8bed\u53e5\u4e2d\n-- \u53c2\u6570\nIN|OUT|INOUT \u53c2\u6570\u540d \u6570\u636e\u7c7b\u578b\nIN      \u8f93\u5165\uff1a\u5728\u8c03\u7528\u8fc7\u7a0b\u4e2d\uff0c\u5c06\u6570\u636e\u8f93\u5165\u5230\u8fc7\u7a0b\u4f53\u5185\u90e8\u7684\u53c2\u6570\nOUT     \u8f93\u51fa\uff1a\u5728\u8c03\u7528\u8fc7\u7a0b\u4e2d\uff0c\u5c06\u8fc7\u7a0b\u4f53\u5904\u7406\u5b8c\u7684\u7ed3\u679c\u8fd4\u56de\u5230\u5ba2\u6237\u7aef\nINOUT   \u8f93\u5165\u8f93\u51fa\uff1a\u65e2\u53ef\u8f93\u5165\uff0c\u4e5f\u53ef\u8f93\u51fa\n-- \u8bed\u6cd5\nCREATE PROCEDURE \u8fc7\u7a0b\u540d (\u53c2\u6570\u5217\u8868)\nBEGIN\n    \u8fc7\u7a0b\u4f53\nEND\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_16","title":"\u7528\u6237\u548c\u6743\u9650\u7ba1\u7406","text":"<pre><code>-- root\u5bc6\u7801\u91cd\u7f6e\n1. \u505c\u6b62MySQL\u670d\u52a1\n2.  [Linux] /usr/local/mysql/bin/safe_mysqld --skip-grant-tables &amp;\n    [Windows] mysqld --skip-grant-tables\n3. use mysql;\n4. UPDATE `user` SET PASSWORD=PASSWORD(\"\u5bc6\u7801\") WHERE `user` = \"root\";\n5. FLUSH PRIVILEGES;\n\u7528\u6237\u4fe1\u606f\u8868\uff1amysql.user\n-- \u5237\u65b0\u6743\u9650\nFLUSH PRIVILEGES;\n-- \u589e\u52a0\u7528\u6237\nCREATE USER \u7528\u6237\u540d IDENTIFIED BY [PASSWORD] \u5bc6\u7801(\u5b57\u7b26\u4e32)\n    - \u5fc5\u987b\u62e5\u6709mysql\u6570\u636e\u5e93\u7684\u5168\u5c40CREATE USER\u6743\u9650\uff0c\u6216\u62e5\u6709INSERT\u6743\u9650\u3002\n    - \u53ea\u80fd\u521b\u5efa\u7528\u6237\uff0c\u4e0d\u80fd\u8d4b\u4e88\u6743\u9650\u3002\n    - \u7528\u6237\u540d\uff0c\u6ce8\u610f\u5f15\u53f7\uff1a\u5982  user_name @ 192.168.1.1 \n    - \u5bc6\u7801\u4e5f\u9700\u5f15\u53f7\uff0c\u7eaf\u6570\u5b57\u5bc6\u7801\u4e5f\u8981\u52a0\u5f15\u53f7\n    - \u8981\u5728\u7eaf\u6587\u672c\u4e2d\u6307\u5b9a\u5bc6\u7801\uff0c\u9700\u5ffd\u7565PASSWORD\u5173\u952e\u8bcd\u3002\u8981\u628a\u5bc6\u7801\u6307\u5b9a\u4e3a\u7531PASSWORD()\u51fd\u6570\u8fd4\u56de\u7684\u6df7\u7f16\u503c\uff0c\u9700\u5305\u542b\u5173\u952e\u5b57PASSWORD\n-- \u91cd\u547d\u540d\u7528\u6237\nRENAME USER old_user TO new_user\n-- \u8bbe\u7f6e\u5bc6\u7801\nSET PASSWORD = PASSWORD( \u5bc6\u7801 )  -- \u4e3a\u5f53\u524d\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801\nSET PASSWORD FOR \u7528\u6237\u540d = PASSWORD( \u5bc6\u7801 ) -- \u4e3a\u6307\u5b9a\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801\n-- \u5220\u9664\u7528\u6237\nDROP USER \u7528\u6237\u540d\n-- \u5206\u914d\u6743\u9650/\u6dfb\u52a0\u7528\u6237\nGRANT \u6743\u9650\u5217\u8868 ON \u8868\u540d TO \u7528\u6237\u540d [IDENTIFIED BY [PASSWORD]  password ]\n    - all privileges \u8868\u793a\u6240\u6709\u6743\u9650\n    - *.* \u8868\u793a\u6240\u6709\u5e93\u7684\u6240\u6709\u8868\n    - \u5e93\u540d.\u8868\u540d \u8868\u793a\u67d0\u5e93\u4e0b\u9762\u7684\u67d0\u8868\n    GRANT ALL PRIVILEGES ON `pms`.* TO  pms @ %  IDENTIFIED BY  pms0817 ;\n-- \u67e5\u770b\u6743\u9650\nSHOW GRANTS FOR \u7528\u6237\u540d\n    -- \u67e5\u770b\u5f53\u524d\u7528\u6237\u6743\u9650\n    SHOW GRANTS; \u6216 SHOW GRANTS FOR CURRENT_USER; \u6216 SHOW GRANTS FOR CURRENT_USER();\n-- \u64a4\u6d88\u6743\u9650\nREVOKE \u6743\u9650\u5217\u8868 ON \u8868\u540d FROM \u7528\u6237\u540d\nREVOKE ALL PRIVILEGES, GRANT OPTION FROM \u7528\u6237\u540d   -- \u64a4\u9500\u6240\u6709\u6743\u9650\n-- \u6743\u9650\u5c42\u7ea7\n-- \u8981\u4f7f\u7528GRANT\u6216REVOKE\uff0c\u60a8\u5fc5\u987b\u62e5\u6709GRANT OPTION\u6743\u9650\uff0c\u5e76\u4e14\u60a8\u5fc5\u987b\u7528\u4e8e\u60a8\u6b63\u5728\u6388\u4e88\u6216\u64a4\u9500\u7684\u6743\u9650\u3002\n\u5168\u5c40\u5c42\u7ea7\uff1a\u5168\u5c40\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u670d\u52a1\u5668\u4e2d\u7684\u6240\u6709\u6570\u636e\u5e93\uff0cmysql.user\n    GRANT ALL ON *.*\u548c REVOKE ALL ON *.*\u53ea\u6388\u4e88\u548c\u64a4\u9500\u5168\u5c40\u6743\u9650\u3002\n\u6570\u636e\u5e93\u5c42\u7ea7\uff1a\u6570\u636e\u5e93\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u76ee\u6807\uff0cmysql.db, mysql.host\n    GRANT ALL ON db_name.*\u548cREVOKE ALL ON db_name.*\u53ea\u6388\u4e88\u548c\u64a4\u9500\u6570\u636e\u5e93\u6743\u9650\u3002\n\u8868\u5c42\u7ea7\uff1a\u8868\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u8868\u4e2d\u7684\u6240\u6709\u5217\uff0cmysql.talbes_priv\n    GRANT ALL ON db_name.tbl_name\u548cREVOKE ALL ON db_name.tbl_name\u53ea\u6388\u4e88\u548c\u64a4\u9500\u8868\u6743\u9650\u3002\n\u5217\u5c42\u7ea7\uff1a\u5217\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u8868\u4e2d\u7684\u5355\u4e00\u5217\uff0cmysql.columns_priv\n    \u5f53\u4f7f\u7528REVOKE\u65f6\uff0c\u60a8\u5fc5\u987b\u6307\u5b9a\u4e0e\u88ab\u6388\u6743\u5217\u76f8\u540c\u7684\u5217\u3002\n-- \u6743\u9650\u5217\u8868\nALL [PRIVILEGES]    -- \u8bbe\u7f6e\u9664GRANT OPTION\u4e4b\u5916\u7684\u6240\u6709\u7b80\u5355\u6743\u9650\nALTER   -- \u5141\u8bb8\u4f7f\u7528ALTER TABLE\nALTER ROUTINE   -- \u66f4\u6539\u6216\u53d6\u6d88\u5df2\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f\nCREATE  -- \u5141\u8bb8\u4f7f\u7528CREATE TABLE\nCREATE ROUTINE  -- \u521b\u5efa\u5df2\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f\nCREATE TEMPORARY TABLES     -- \u5141\u8bb8\u4f7f\u7528CREATE TEMPORARY TABLE\nCREATE USER     -- \u5141\u8bb8\u4f7f\u7528CREATE USER, DROP USER, RENAME USER\u548cREVOKE ALL PRIVILEGES\u3002\nCREATE VIEW     -- \u5141\u8bb8\u4f7f\u7528CREATE VIEW\nDELETE  -- \u5141\u8bb8\u4f7f\u7528DELETE\nDROP    -- \u5141\u8bb8\u4f7f\u7528DROP TABLE\nEXECUTE     -- \u5141\u8bb8\u7528\u6237\u8fd0\u884c\u5df2\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f\nFILE    -- \u5141\u8bb8\u4f7f\u7528SELECT...INTO OUTFILE\u548cLOAD DATA INFILE\nINDEX   -- \u5141\u8bb8\u4f7f\u7528CREATE INDEX\u548cDROP INDEX\nINSERT  -- \u5141\u8bb8\u4f7f\u7528INSERT\nLOCK TABLES     -- \u5141\u8bb8\u5bf9\u60a8\u62e5\u6709SELECT\u6743\u9650\u7684\u8868\u4f7f\u7528LOCK TABLES\nPROCESS     -- \u5141\u8bb8\u4f7f\u7528SHOW FULL PROCESSLIST\nREFERENCES  -- \u672a\u88ab\u5b9e\u65bd\nRELOAD  -- \u5141\u8bb8\u4f7f\u7528FLUSH\nREPLICATION CLIENT  -- \u5141\u8bb8\u7528\u6237\u8be2\u95ee\u4ece\u5c5e\u670d\u52a1\u5668\u6216\u4e3b\u670d\u52a1\u5668\u7684\u5730\u5740\nREPLICATION SLAVE   -- \u7528\u4e8e\u590d\u5236\u578b\u4ece\u5c5e\u670d\u52a1\u5668\uff08\u4ece\u4e3b\u670d\u52a1\u5668\u4e2d\u8bfb\u53d6\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e8b\u4ef6\uff09\nSELECT  -- \u5141\u8bb8\u4f7f\u7528SELECT\nSHOW DATABASES  -- \u663e\u793a\u6240\u6709\u6570\u636e\u5e93\nSHOW VIEW   -- \u5141\u8bb8\u4f7f\u7528SHOW CREATE VIEW\nSHUTDOWN    -- \u5141\u8bb8\u4f7f\u7528mysqladmin shutdown\nSUPER   -- \u5141\u8bb8\u4f7f\u7528CHANGE MASTER, KILL, PURGE MASTER LOGS\u548cSET GLOBAL\u8bed\u53e5\uff0cmysqladmin debug\u547d\u4ee4\uff1b\u5141\u8bb8\u60a8\u8fde\u63a5\uff08\u4e00\u6b21\uff09\uff0c\u5373\u4f7f\u5df2\u8fbe\u5230max_connections\u3002\nUPDATE  -- \u5141\u8bb8\u4f7f\u7528UPDATE\nUSAGE   -- \u201c\u65e0\u6743\u9650\u201d\u7684\u540c\u4e49\u8bcd\nGRANT OPTION    -- \u5141\u8bb8\u6388\u4e88\u6743\u9650\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_17","title":"\u8868\u7ef4\u62a4","text":"<pre><code>-- \u5206\u6790\u548c\u5b58\u50a8\u8868\u7684\u5173\u952e\u5b57\u5206\u5e03\nANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE \u8868\u540d ...\n-- \u68c0\u67e5\u4e00\u4e2a\u6216\u591a\u4e2a\u8868\u662f\u5426\u6709\u9519\u8bef\nCHECK TABLE tbl_name [, tbl_name] ... [option] ...\noption = {QUICK | FAST | MEDIUM | EXTENDED | CHANGED}\n-- \u6574\u7406\u6570\u636e\u6587\u4ef6\u7684\u788e\u7247\nOPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...\n</code></pre>"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_18","title":"\u6742\u9879","text":"<pre><code>1. \u53ef\u7528\u53cd\u5f15\u53f7\uff08`\uff09\u4e3a\u6807\u8bc6\u7b26\uff08\u5e93\u540d\u3001\u8868\u540d\u3001\u5b57\u6bb5\u540d\u3001\u7d22\u5f15\u3001\u522b\u540d\uff09\u5305\u88f9\uff0c\u4ee5\u907f\u514d\u4e0e\u5173\u952e\u5b57\u91cd\u540d\uff01\u4e2d\u6587\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u6807\u8bc6\u7b26\uff01\n2. \u6bcf\u4e2a\u5e93\u76ee\u5f55\u5b58\u5728\u4e00\u4e2a\u4fdd\u5b58\u5f53\u524d\u6570\u636e\u5e93\u7684\u9009\u9879\u6587\u4ef6db.opt\u3002\n3. \u6ce8\u91ca\uff1a\n    \u5355\u884c\u6ce8\u91ca # \u6ce8\u91ca\u5185\u5bb9\n    \u591a\u884c\u6ce8\u91ca /* \u6ce8\u91ca\u5185\u5bb9 */\n    \u5355\u884c\u6ce8\u91ca -- \u6ce8\u91ca\u5185\u5bb9     (\u6807\u51c6SQL\u6ce8\u91ca\u98ce\u683c\uff0c\u8981\u6c42\u53cc\u7834\u6298\u53f7\u540e\u52a0\u4e00\u7a7a\u683c\u7b26\uff08\u7a7a\u683c\u3001TAB\u3001\u6362\u884c\u7b49\uff09)\n4. \u6a21\u5f0f\u901a\u914d\u7b26\uff1a\n    _   \u4efb\u610f\u5355\u4e2a\u5b57\u7b26\n    %   \u4efb\u610f\u591a\u4e2a\u5b57\u7b26\uff0c\u751a\u81f3\u5305\u62ec\u96f6\u5b57\u7b26\n    \u5355\u5f15\u53f7\u9700\u8981\u8fdb\u884c\u8f6c\u4e49  \n5. CMD\u547d\u4ee4\u884c\u5185\u7684\u8bed\u53e5\u7ed3\u675f\u7b26\u53ef\u4ee5\u4e3a \";\", \"G\", \"g\"\uff0c\u4ec5\u5f71\u54cd\u663e\u793a\u7ed3\u679c\u3002\u5176\u4ed6\u5730\u65b9\u8fd8\u662f\u7528\u5206\u53f7\u7ed3\u675f\u3002delimiter \u53ef\u4fee\u6539\u5f53\u524d\u5bf9\u8bdd\u7684\u8bed\u53e5\u7ed3\u675f\u7b26\u3002\n6. SQL\u5bf9\u5927\u5c0f\u5199\u4e0d\u654f\u611f\n7. \u6e05\u9664\u5df2\u6709\u8bed\u53e5\uff1ac\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/","title":"Python Re \u6a21\u5757\u8d85\u5168\u89e3\u8bfb","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#re","title":"re\u6a21\u5757\u4e0b\u7684\u51fd\u6570","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#compilepattern","title":"compile(pattern)\uff1a\u521b\u5efa\u6a21\u5f0f\u5bf9\u8c61","text":"<pre><code>import re\npat=re.compile('A')\nm=pat.search('CBA')                    #\u7b49\u4ef7\u4e8e re.search('A','CBA')\nprint m\n&lt;_sre.SRE_Match object at 0x9d690c8&gt;   #\u5339\u914d\u5230\u4e86\uff0c\u8fd4\u56deMatchObject\uff08True\uff09\n\nm=pat.search('CBD')\nprint m\nNone                                   #\u6ca1\u6709\u5339\u914d\u5230\uff0c\u8fd4\u56deNone\uff08False\uff09\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#searchpatternstring","title":"search(pattern,string)\uff1a\u5728\u5b57\u7b26\u4e32\u4e2d\u5bfb\u627e\u6a21\u5f0f","text":"<pre><code>m = re.search('asd','ASDasd')\nprint m\n&lt;_sre.SRE_Match object at 0xb72cd6e8&gt;  #\u5339\u914d\u5230\u4e86\uff0c\u8fd4\u56deMatchObject\uff08True\uff09\nm = re.search('asd','ASDASD')\nprint m\nNone                                   #\u6ca1\u6709\u5339\u914d\u5230\uff0c\u8fd4\u56deNone\uff08False\uff09\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#matchpatternstring","title":"match(pattern,string)\uff1a\u5728\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u5339\u914d\u6a21\u5f0f","text":"<pre><code>m = re.search('asd','ASDasd')\nprint m\n&lt;_sre.SRE_Match object at 0xb72cd6e8&gt;  #\u5339\u914d\u5230\u4e86\uff0c\u8fd4\u56deMatchObject\uff08True\uff09\nm = re.search('asd','ASDASD')\nprint m\nNone                                   #\u6ca1\u6709\u5339\u914d\u5230\uff0c\u8fd4\u56deNone\uff08False\uff09\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_1","title":"\u7b49\u4ef7\u4e8e","text":"<pre><code>pat=re.compile('a')\nprint pat.match('Aasd')\nNone\nprintpat.match('aASD')\n&lt;_sre.SRE_Match object at 0xb72cd6e8&gt;\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#if","title":"\u4e0a\u9762\u7684\u51fd\u6570\u8fd4\u56de\u90fd\u53ef\u4ee5\u5728if\u6761\u4ef6\u8bed\u53e5\u4e2d\u8fdb\u884c\u5224\u65ad\uff1a","text":"<pre><code>if pat.search('asd'):\n...     print 'OK'\n...\nOK        #\u627e\u5230\u8fd4\u56de\nif re.search('a','ASD'):\n...     print \"OK\"\n...       #\u6ca1\u6709\u627e\u5230\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#splitpatternstring","title":"split(pattern,string)\uff1a\u6839\u636e\u6a21\u5f0f\u5206\u5272\u5b57\u7b26\u4e32,\u8fd4\u56de\u5217\u8868","text":"<pre><code>re.split(',','a,s,d,asd')\n['a', 's', 'd', 'asd']          #\u8fd4\u56de\u5217\u8868\n\npat = re.compile(',')\npat.split('a,s,d,asd')\n['a', 's', 'd', 'asd']          #\u8fd4\u56de\u5217\u8868\n\nre.split('[, ]+','a ,  s  ,d     ,,,,,asd')   #\u6b63\u5219\u5339\u914d\uff1a[, ]+\uff0c\u540e\u9762\u8bf4\u660e\n['a', 's', 'd', 'asd']\n\nre.split('[, ]+','a ,  s  ,d     ,,,,,asd',maxsplit=2) # maxsplit \u6700\u591a\u5206\u5272\u6b21\u6570\n['a', 's', 'd     ,,,,,asd']\n\npat = re.compile('[, ]+')                     #\u6b63\u5219\u5339\u914d\uff1a[, ]+\uff0c\u540e\u9762\u8bf4\u660e\npat.split('a ,  s  ,d     ,,,,,asd',maxsplit=2)        # maxsplit \u6700\u591a\u5206\u5272\u6b21\u6570\n['a', 's', 'd     ,,,,,asd']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#findallpatternstring","title":"findall(pattern,string)\uff1a\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\u5339\u914d\u9879","text":"<pre><code>re.findall('a','ASDaDFGAa')\n['a', 'a']                           #\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\n\npat = re.compile('a')\npat.findall('ASDaDFGAa')\n['a', 'a']                           #\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\n\npat = re.compile('[A-Z]+')       #\u6b63\u5219\u5339\u914d\uff1a'[A-Z]+' \u540e\u9762\u6709\u8bf4\u660e\npat.findall('ASDcDFGAa')\n['ASD', 'DFGA']                      #\u627e\u5230\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\n\npat = re.compile('[A-Z]')\npat.findall('ASDcDFGAa')         #\u6b63\u5219\u5339\u914d\uff1a'[A-Z]+' \u540e\u9762\u6709\u8bf4\u660e\n['A', 'S', 'D', 'D', 'F', 'G', 'A']  #\u627e\u5230\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32\n\npat = re.compile('[A-Za-z]')     #\u6b63\u5219\u5339\u914d\uff1a'[A-Za-z]+' \u5339\u914d\u6240\u6709\u5355\u8bcd\uff0c\u540e\u9762\u6709\u8bf4\u660e\npat.findall('ASDcDFGAa')\n['A', 'S', 'D', 'c', 'D', 'F', 'G', 'A', 'a']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#subpatreplstring-repl-pat","title":"sub(pat,repl,string) \uff1a\u7528repl\u66ff\u6362 pat\u5339\u914d\u9879","text":"<p>(\u7559\u7684\u662f\u4e2d\u95f4\u7684\uff0c\u56e0\u4e3a\u4e2d\u95f4\u5728\u4e2d\u5fc3)</p> <pre><code>re.sub('a','A','abcasd')   #\u627e\u5230a\u7528A\u66ff\u6362\uff0c\u540e\u9762\u89c1\u548cgroup\u7684\u914d\u5408\u4f7f\u7528\n'AbcAsd'\n\npat = re.compile('a')\npat.sub('A','abcasd')\n'AbcAsd'\n\npat=re.compile(r'www\\.(.*)\\..{3}') #\u6b63\u5219\u8868\u8fbe\u5f0f\n  #\u5728Python\u7684string\u524d\u9762\u52a0\u4e0a\u2018r\u2019\uff0c \u662f\u4e3a\u4e86\u544a\u8bc9\u7f16\u8bd1\u5668\u8fd9\u4e2astring\u662f\u4e2araw string\uff0c\u4e0d\u8981\u8f6c\u8bd1\u53cd\u659c\u6760 '\\' \u3002\n  #\u4f8b\u5982\uff0c\\n \u5728raw string\u4e2d\uff0c\u662f\u4e24\u4e2a\u5b57\u7b26\uff0c\\\u548cn\uff0c \u800c\u4e0d\u4f1a\u8f6c\u8bd1\u4e3a\u6362\u884c\u7b26\u3002\n  #\u7531\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u548c \\ \u4f1a\u6709\u51b2\u7a81\uff0c\u56e0\u6b64\uff0c\u5f53\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f7f\u7528\u4e86\u6b63\u5219\u8868\u8fbe\u5f0f\u540e\uff0c\u6700\u597d\u5728\u524d\u9762\u52a0\u4e0a'r'\u3002\n\n  #\u4e0e\u5927\u591a\u6570\u7f16\u7a0b\u8bed\u8a00\u76f8\u540c\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u91cc\u4f7f\u7528\"\\\"\u4f5c\u4e3a\u8f6c\u4e49\u5b57\u7b26\uff0c\u8fd9\u5c31\u53ef\u80fd\u9020\u6210\u53cd\u659c\u6760\u56f0\u6270\u3002\n  #\u5047\u5982\u4f60\u9700\u8981\u5339\u914d\u6587\u672c\u4e2d\u7684\u5b57\u7b26\"\\\"\uff0c\u90a3\u4e48\u4f7f\u7528\u7f16\u7a0b\u8bed\u8a00\u8868\u793a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u91cc\u5c06\u9700\u89814\u4e2a\u53cd\u659c\u6760\"\\\\\\\\\"\uff1a\n  #\u524d\u4e24\u4e2a\u548c\u540e\u4e24\u4e2a\u5206\u522b\u7528\u4e8e\u5728\u7f16\u7a0b\u8bed\u8a00\u91cc\u8f6c\u4e49\u6210\u53cd\u659c\u6760\uff0c\u8f6c\u6362\u6210\u4e24\u4e2a\u53cd\u659c\u6760\u540e\u518d\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u91cc\u8f6c\u4e49\u6210\u4e00\u4e2a\u53cd\u659c\u6760\u3002\n  #Python\u91cc\u7684\u539f\u751f\u5b57\u7b26\u4e32\u5f88\u597d\u5730\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u53ef\u4ee5\u4f7f\u7528r\"\\\\\"\u8868\u793a\u3002\n  #\u540c\u6837\uff0c\u5339\u914d\u4e00\u4e2a\u6570\u5b57\u7684\"\\\\d\"\u53ef\u4ee5\u5199\u6210r\"\\d\"\u3002\n  #\u6709\u4e86\u539f\u751f\u5b57\u7b26\u4e32\uff0c\u4f60\u518d\u4e5f\u4e0d\u7528\u62c5\u5fc3\u662f\u4e0d\u662f\u6f0f\u5199\u4e86\u53cd\u659c\u6760\uff0c\u5199\u51fa\u6765\u7684\u8868\u8fbe\u5f0f\u4e5f\u66f4\u76f4\u89c2\u3002\n\n  #\u4e0d\u662f\u8bf4 \u52a0\u4e86r \\\u5c31\u6ca1\u6709\u8f6c\u8bd1\u529f\u80fd\uff0c\u597d\u4e71\uff0c\u5c31\u76f4\u63a5\u8bb0\u4f4f1\u53e5\u8bdd\uff1a\n  #\u5f53\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f7f\u7528\u4e86\u6b63\u5219\u8868\u8fbe\u5f0f\u540e\uff0c\u6700\u597d\u5728\u524d\u9762\u52a0\u4e0a'r'\uff0c\u8fd9\u6837\u4f60\u518d\u4e5f\u4e0d\u7528\u62c5\u5fc3\u662f\u4e0d\u662f\u6f0f\u5199\u4e86\u53cd\u659c\u6760\uff0c\u5199\u51fa\u6765\u7684\u8868\u8fbe\u5f0f\u4e5f\u66f4\u76f4\u89c2\n\npat.match('www.dxy.com').group(1)\n'dxy'\n\nre.sub(r'www\\.(.*)\\..{3}',r'\\1','hello,www.dxy.com')\n\npat.sub(r'\\1','hello,www.dxy.com')\n'hello,dxy'\n# r'1' \u662f\u7b2c\u4e00\u7ec4\u7684\u610f\u601d\n#\u901a\u8fc7\u6b63\u5219\u5339\u914d\u627e\u5230\u7b26\u5408\u89c4\u5219\u7684\"www.dxy.com\" \uff0c\u53d6\u5f97 \u7ec41\u5b57\u7b26\u4e32 \u53bb\u66ff\u6362 \u6574\u4e2a\u5339\u914d\u3002\n\n\npat=re.compile(r'(\\w+) (\\w+)')     #\u6b63\u5219\u8868\u8fbe\u5f0f\ns='hello world ! hello hz !'\n\npat.findall('hello world ! hello hz !')\n[('hello', 'world'), ('hello', 'hz')]\npat.sub(r'\\2 \\1',s)                #\u901a\u8fc7\u6b63\u5219\u5f97\u5230\u7ec41(hello)\uff0c\u7ec42(world)\uff0c\u518d\u901a\u8fc7sub\u53bb\u66ff\u6362\u3002\u5373\u7ec41\u66ff\u6362\u7ec42\uff0c\u7ec42\u66ff\u6362\u7ec41\uff0c\u8c03\u6362\u4f4d\u7f6e\u3002  \n'world hello!hz hello!'\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#escapestring","title":"escape(string) \uff1a\u5bf9\u5b57\u7b26\u4e32\u91cc\u9762\u7684\u7279\u6b8a\u5b57\u7b26\u4e32\u8fdb\u884c\u8f6c\u4e49","text":"<pre><code>re.escape('www.dxy.cn')\n'www\\\\.dxy\\\\.cn'                   #\u8f6c\u4e49\n</code></pre> <p>\u4e0a\u9762\u7684\u51fd\u6570\u4e2d\uff0c\u53ea\u6709match\u3001search\u6709group\u65b9\u6cd5\uff0c\u5176\u4ed6\u7684\u51fd\u6570\u6ca1\u6709\u3002</p>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_2","title":"\u51fd\u6570\u7684\u65b9\u6cd5","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#group","title":"group\uff1a\u83b7\u53d6\u5b50\u6a21\u5f0f(\u7ec4)\u7684\u5339\u914d\u9879","text":"<pre><code>pat = re.compile(r'www\\.(.*)\\.(.*)')       #\u7528()\u8868\u793a1\u4e2a\u7ec4\uff0c2\u4e2a\u7ec4\nm = pat.match('www.dxy.com')\nm.group()                                  #\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u793a\u5339\u914d\u6574\u4e2a\u5b57\u7b26\u4e32  \n'www.dxy.com'\n\nm.group(1)                                 #\u8fd4\u56de\u7ed9\u5b9a\u7ec41\u5339\u914d\u7684\u5b50\u5b57\u7b26\u4e32\n'dxy'\n\nm.group(2)\n'com'\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#start","title":"start\uff1a\u7ed9\u5b9a\u7ec4\u5339\u914d\u9879\u7684\u5f00\u59cb\u4f4d\u7f6e","text":"<pre><code>m.start(2)                                 #\u7ec42\u5f00\u59cb\u7684\u7d22\u5f15\n8\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#end","title":"end\uff1a\u7ed9\u5b9a\u7ec4\u5339\u914d\u9879\u7684\u7ed3\u675f\u4f4d\u7f6e","text":"<pre><code>m.end(2)                                   #\u7ec42\u7ed3\u675f\u7684\u7d22\u5f15\n11\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#span","title":"span\uff1a \u7ed9\u5b9a\u7ec4\u5339\u914d\u9879\u7684\u5f00\u59cb\u7ed3\u675f\u4f4d\u7f6e","text":"<pre><code>m.span(2)                                  #\u7ec42\u5f00\u59cb\u3001\u7ed3\u675f\u7684\u7d22\u5f15\n(8, 11)\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_3","title":"\u6b63\u5219\u8868\u8fbe\u5f0f","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_4","title":"\u5143\u5b57\u7b26","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#1","title":"\u201c.\u201d \uff1a\u901a\u914d\u7b26,\u9664\u6362\u884c\u7b26\u5916\u7684\u4efb\u610f\u76841\u4e2a\u5b57\u7b26","text":"<pre><code>pat=re.compile('.')\npat.match('abc')\n&lt;_sre.SRE_Match object at 0xb72b6170&gt;\npat.match('abc').group()\n'a'                                #\u5339\u914d\u5230\u4e86\u9996\u4e2a\u5b57\u7b26\npat.search('abc').group()\n'a'\npat.match('\\n').group()        #\u6362\u884c\u7b26\u5339\u914d\u51fa\u9519\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nAttributeError: 'NoneType' object has no attribute 'group'\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_5","title":"\u201c\\\u201d : \u8f6c\u4e49\u7b26","text":"<pre><code>pat=re.compile('\\.')\npat.search('abc.efg').group()  #\u5339\u914d\u5230.\n'.'\npat.findall('abc.efg')         #\u4e0d\u7528group,\u8fd4\u56de\u5217\u8868\n['.']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_6","title":"\u201c[\u2026]\u201d : \u5b57\u7b26\u96c6\u5408\uff0c\u5339\u914d\u91cc\u9762\u7684\u4efb\u610f\u4e00\u4e2a\u5143\u7d20","text":"<pre><code>&gt;&gt;&gt; pat=re.compile('[abc]')\n&gt;&gt;&gt; pat.match('axbycz').group()\n'a'\n&gt;&gt;&gt; pat.search('axbycz').group()\n'a'\n&gt;&gt;&gt; pat.findall('axbycz')\n['a', 'b', 'c']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#d","title":"\u201c\\d\u201d : \u6570\u5b57","text":"<pre><code>&gt;&gt;&gt; pat=re.compile('\\d')          \n&gt;&gt;&gt; pat.search('ax1by2cz3').group()   #\u5339\u914d\u5230\u7b2c\u4e00\u4e2a\u6570\u5b57:1\uff0c\u8fd4\u56de\n'1'\n\n&gt;&gt;&gt; pat.match('ax1by2cz3').group()    #\u5339\u914d\u4e0d\u5230\uff08\u9996\u4e2a\u4e0d\u662f\uff09\u8fd4\u56deNone\uff0c\u62a5\u9519\uff0cmatch\u5339\u914d\u5b57\u7b26\u4e32\u5934\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nAttributeError: 'NoneType' object has no attribute 'group'\n\n&gt;&gt;&gt; pat.findall('ax1by2cz3')          #\u5339\u914d\u6240\u6709\u7684\u6570\u5b57\uff0c\u5217\u8868\u8fd4\u56de\n['1', '2', '3']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#d_1","title":"\u201c\\D\u201d : \u975e\u6570\u5b57","text":"<pre><code>&gt;&gt;&gt; pat=re.compile('\\D')\n&gt;&gt;&gt; pat.match('ax1by2cz3').group()\n'a'\n&gt;&gt;&gt; pat.search('ax1by2cz3').group()\n'a'\n&gt;&gt;&gt; pat.findall('ax1by2cz3')\n['a', 'x', 'b', 'y', 'c', 'z']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#s-trn","title":"\u201c\\s\u201d \uff1a\u7a7a\u767d\u5b57\u7b26 \u3001 \\t\u3001\\r\u3001\\n\u3001\u7a7a\u683c","text":"<pre><code>&gt;&gt;&gt; pat=re.compile('\\s')\n&gt;&gt;&gt; pat.findall('\\rax1 \\nby2 \\tcz3')\n['\\r', ' ', '\\n', ' ', '\\t']\n&gt;&gt;&gt; pat.search('\\rax1 \\nby2 \\tcz3').group()\n'\\r'\n&gt;&gt;&gt; pat.match('\\rax1 \\nby2 \\tcz3').group()\n'\\r'\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#s","title":"\u201cS\u201d :\u975e\u7a7a\u767d\u5b57\u7b26","text":"<pre><code>&gt;&gt;&gt; pat=re.compile('\\S')\n&gt;&gt;&gt; pat.search('\\rax1 \\nby2 \\tcz3').group()\n'a'\n&gt;&gt;&gt; pat.findall('\\rax1 \\nby2 \\tcz3')\n['a', 'x', '1', 'b', 'y', '2', 'c', 'z', '3']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#w-a-za-z0-9","title":"\u201c\\w\u201d \uff1a\u5355\u4e2a\u7684 \u6570\u5b57\u548c\u5b57\u6bcd\uff0c[A-Za-z0-9]","text":"<pre><code>&gt;&gt;&gt; pat=re.compile('\\w')\n&gt;&gt;&gt; pat.search('1a2b3c').group()\n'1'\n&gt;&gt;&gt; pat.findall('1a2b3c')\n['1', 'a', '2', 'b', '3', 'c']\n&gt;&gt;&gt; pat.match('1a2b3c').group()\n'1'\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#w","title":"\u201c\\W\u201d:\u975e\u5355\u8bcd\u5b57\u7b26,\u9664\u6570\u5b57\u548c\u5b57\u6bcd\u5916","text":"<pre><code>&gt;&gt;&gt; pat=re.compile('\\W')\n&gt;&gt;&gt; pat.findall('1a2\u6211b3c') #python\u662f\u7528\u4e09\u5b57\u8282\u8868\u793a\u4e00\u4e2a\u6c49\u5b57\n['\\xe6', '\\x88', '\\x91']\n&gt;&gt;&gt; pat.search('1a2\u6211b3c').group()\n'\\xe6'\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_7","title":"\u6570\u91cf\u8bcd","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#0","title":"\u201c*\u201d \uff1a0\u6b21\u6216\u591a\u6b21","text":"<p>\uff08 \u4e580\u4f1a\u53d8\u62100\uff09</p> <pre><code>&gt;&gt;&gt; pat = re.compile('[abc]*')\n&gt;&gt;&gt; pat.match('abcabcdefabc').group()\n'abcabc'                              #2\u6b21\n&gt;&gt;&gt; pat.search('abcabcdefabc').group()\n'abcabc'                              #2\u6b21\n&gt;&gt;&gt; pat.findall('abcabcdefabc')\n['abcabc', '', '', '', 'abc', '']     #2\u6b21\u548c1\u6b21,\u56e0\u4e3a\u67090\u6b21\uff0c\u6240\u4ee5\u5339\u914d\u4e86''\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#1_1","title":"\u201c+\u201d \uff1a1\u6b21\u6216\u591a\u6b21","text":"<p>\uff08 \u52a00\u4e0d\u4f1a\u53d8\u62100\uff09</p> <pre><code>&gt;&gt;&gt; pat = re.compile('[abc]+')\n&gt;&gt;&gt; pat.match('abcdefabcabc').group()\n'abc'\n&gt;&gt;&gt; pat.search('abcdefabcabc').group()\n'abc'\n&gt;&gt;&gt; pat.findall('abcdefabcabc')\n['abc', 'abcabc']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#01matchsearch-none-0","title":"\u201c?\u201d \uff1a0\u6b21\u62161\u6b21\uff0cmatch,search \u4e0d\u4f1a\u51fa\u73b0none\uff0c\u4f1a\u51fa\u73b0\u2019 \u2018 \uff08\u56e0\u4e3a0\u6b21\u4e5f\u662f\u7b26\u5408\u7684\uff09","text":"<p>0\u6b21\u62161\u6b21\u4e0d\u662f\u6307<code>[xxx]</code>\u8fd9\u4e2a\u96c6\u5408\uff0c\u800c\u662f\u5176\u4e2d\u7684\u4efb\u4f55\u7684\u4e00\u4e2a\u5b57\u7b26</p> <pre><code>&gt;&gt;&gt; pat = re.compile('[abc]?')\n&gt;&gt;&gt; pat.match('defabc').group()     #0\u6b21\n''\n&gt;&gt;&gt; pat.match('abcdefabc').group()\n'a'\n&gt;&gt;&gt; pat.search('defabc').group()    #0\u6b21\n''\n&gt;&gt;&gt; pat.findall('defabc')           #0\u6b21\u548c1\u6b21\n['', '', '', 'a', 'b', 'c', '']     #\u540e\u9762\u603b\u518d\u52a0\u4e2a''\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_8","title":"\u201c\u6570\u91cf\u8bcd?\u201d \uff1a\u975e\u8d2a\u5a6a\u6a21\u5f0f\uff1a\u53ea\u5339\u914d\u6700\u5c11\u7684\uff08\u5c3d\u53ef\u80fd\u5c11\uff09\uff1b\u9ed8\u8ba4\u8d2a\u5a6a\u6a21\u5f0f\uff1a\u5339\u914d\u6700\u591a\u7684\uff08\u5c3d\u53ef\u80fd\u591a\uff09","text":"<pre><code>&gt;&gt;&gt; pat = re.compile('[abc]+')         #\u8d2a\u5a6a\u6a21\u5f0f\n&gt;&gt;&gt; pat.match('abcdefabcabc').group()  #\u5339\u914d\u5c3d\u53ef\u80fd\u591a\u7684\uff1aabc\n'abc'\n&gt;&gt;&gt; pat.match('bbabcdefabcabc').group()\n'bbabc'\n&gt;&gt;&gt; pat.search('dbbabcdefabcabc').group()\n'bbabc'\n&gt;&gt;&gt; pat.findall('abcdefabcabc')\n['abc', 'abcabc']\n\n&gt;&gt;&gt; pat = re.compile('[abc]+?')        #\u975e\u8d2a\u5a6a\u6a21\u5f0f\uff1a+?\n&gt;&gt;&gt; pat.match('abcdefabcabc').group()  #\u5339\u914d\u5c3d\u53ef\u80fd\u5c11\u7684\uff1aa\u3001b\u3001c\n'a'\n&gt;&gt;&gt; pat.search('dbbabcdefabcabc').group()\n'b'\n&gt;&gt;&gt; pat.findall('abcdefabcabc')\n['a', 'b', 'c', 'a', 'b', 'c', 'a', 'b', 'c']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#m-m","title":"\u201c{m}\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u51fa\u73b0m\u6b21","text":"<pre><code>&gt;&gt;&gt; pat = re.compile('[op]{2}')     #o\u6216p\u51fa\u73b02\u6b21\n&gt;&gt;&gt; pat.search('abcooapp').group()  #\u5339\u914d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u5b57\u7b26\u4e32,o\u6bd4p\u5148\u51fa\u73b0\n'oo'\n&gt;&gt;&gt; pat.findall('abcooapp')         #\u5339\u914d\u51fa\u73b0\u7684\u6240\u6709\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\n['oo', 'pp']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#mn-mn","title":"\u201c{m,n}\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u51fa\u73b0m\u5230n\u6b21","text":"<pre><code>&gt;&gt;&gt; pat = re.compile('[op]{2,4}')     #o\u6216\u5219p\u51fa\u73b02\u52304\u6b21\n&gt;&gt;&gt; pat.match('pppabcooapp').group()  #\u5339\u914d\u5f00\u5934\n'ppp'\n&gt;&gt;&gt; pat.search('pppabcooapp').group() #\u5339\u914d\u7b2c\u4e00\u6b21\u51fa\u73b0\n'ppp'\n&gt;&gt;&gt; pat.findall('pppabcooapp')        #\u5339\u914d\u6240\u6709\n['ppp', 'oo', 'pp']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#group_1","title":".group() #\u5339\u914d\u7b2c\u4e00\u6b21\u51fa\u73b0","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_9","title":"\u8fb9\u754c","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_10","title":"\u201c^\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u5f00\u5934\u6216\u884c\u5934","text":"<pre><code>&gt;&gt;&gt; pat = re.compile('^[abc]')     #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\n&gt;&gt;&gt; pat.search('defabc').group()    \n&gt;&gt;&gt; pat.match('defabc').group()    #\u5747\u627e\u4e0d\u5230\n&gt;&gt;&gt; pat.findall('defabc')\n[]\n\n&gt;&gt;&gt; pat.search('adefabc').group()\n'a'\n&gt;&gt;&gt; pat.match('adefabc').group()   #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\n'a'\n&gt;&gt;&gt; pat.findall('adefabc')\n['a']\n\n&gt;&gt;&gt; pat = re.compile('^[abc]+')    #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u7684\u4e00\u6b21\u6216\u5219\u591a\u6b21\uff0c\u8d2a\u5a6a\uff1a\u5339\u914d\u591a\u4e2a\n&gt;&gt;&gt; pat.findall('cbadefab')\n['cba']\n&gt;&gt;&gt; pat = re.compile(r'^[abc]+?')  #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u7684\u4e00\u6b21\u6216\u5219\u591a\u6b21\uff0c\u975e\u8d2a\u5a6a\uff1a\u5339\u914d\u4e00\u4e2a\n&gt;&gt;&gt; pat.findall('cbadefab')\n['c']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_11","title":"\u201c$\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u7ed3\u5c3e\u6216\u5219\u884c\u5c3e","text":"<pre><code>&gt;&gt;&gt; pat = re.compile('[abc]$')\n&gt;&gt;&gt; pat.match('adefAbc').group()   #match\u5339\u914d\u7684\u662f\u5b57\u7b26\u4e32\u5f00\u5934\uff0c\u6240\u4ee5\u67e5\u627e$\u7684\u65f6\uff0c\u603b\u662f\u8fd4\u56deNone\n&gt;&gt;&gt; pat.search('adefAbc').group()  #\u7ed3\u5c3e\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\n'c'\n&gt;&gt;&gt; pat.findall('adefAbc')        \n['c']\n&gt;&gt;&gt; pat = re.compile('[abc]+$')\n&gt;&gt;&gt; pat.search('adefAbc').group()  #\u7ed3\u5c3e\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u7684\u4e00\u6b21\u6216\u5219\u591a\u6b21\uff0c\u8d2a\u5a6a\uff1a\u5339\u914d\u591a\u4e2a\n'bc'\n&gt;&gt;&gt; pat.findall('adefAbc')\n['bc']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#a","title":"\u201c\\A\u201d\uff1a\u5339\u914d\u5b57\u7b26\u4e32\u5f00\u5934","text":"<pre><code>&gt;&gt;&gt; pat = re.compile('\\A[abc]+')\n&gt;&gt;&gt; pat.findall('cbadefab')\n['cba']\n&gt;&gt;&gt; pat.search('cbadefab').group()\n'cba'\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#z","title":"\u201c\\Z\u201d\uff1a\u5339\u914d\u5b57\u7b26\u4e32\u7ed3\u5c3e","text":"<pre><code>&gt;&gt;&gt; pat = re.compile('[abc]+\\Z')\n&gt;&gt;&gt; pat.search('cbadefab').group()\n'ab'\n&gt;&gt;&gt; pat.findall('cbadefab')\n['ab']\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_12","title":"\u5206\u7ec4","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#1_2","title":"(\u2026)\uff1a\u5206\u7ec4\u5339\u914d,\u4ece\u5de6\u5230\u53f3,\u6bcf\u9047\u5230\u4e00\u4e2a ( \u7f16\u53f7+1\uff0c\u5206\u7ec4\u540e\u9762\u53ef\u52a0\u6570\u91cf\u8bcd","text":"<pre><code>&gt;&gt;&gt; pat=re.compile(r'(a)\\w(c)')  #\\w:\u5355\u4e2a\u7684\u6570\u5b57\u6216\u5b57\u6bcd [A-Za-z0-9]\n&gt;&gt;&gt; pat.match('abcdef').group()\n'abc'\n&gt;&gt;&gt; pat=re.compile('(a)b(c)')    #\u52062\u7ec4\uff0c\u533f\u540d\u5206\u7ec4\n\n&gt;&gt;&gt; pat.match('abcdef').group()  #\u9ed8\u8ba4\u8fd4\u56de\u5339\u914d\u7684\u5b57\u7b26\u4e32\n'abc'\n&gt;&gt;&gt; pat.match('abcdef').group(1) #\u53d6\u5206\u7ec41\uff0c\u9002\u7528\u4e8esearch\n'a'\n&gt;&gt;&gt; pat.match('abcdef').group(2) #\u53d6\u5206\u7ec42\uff0c\u9002\u7528\u4e8esearch\n'c'\n&gt;&gt;&gt; pat.match('abcdef').groups() #\u53d6\u6240\u6709\u5206\u7ec4\uff0c\u5143\u7ec4\u5f62\u5f0f\u8fd4\u56de\n('a', 'c')\n</code></pre>"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_13","title":"\uff1a\u5f15\u7528\u7f16\u53f7\u4e3a\u7684\u5206\u7ec4\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 <pre><code>&gt;&gt;&gt; pat=re.compile(r'www\\.(.*)\\..{3}')\n&gt;&gt;&gt; pat.match('www.dxy.com').group(1)\n'dxy'\n</code></pre>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#p","title":"\u201c(?P\u2026)\u201d \uff1a\u5728\u6a21\u5f0f\u91cc\u9762\u7528()\u6765\u8868\u793a\u5206\u7ec4\uff08\u547d\u540d\u5206\u7ec4\uff09,\u9002\u7528\u4e8e\u63d0\u53d6\u76ee\u6807\u5b57\u7b26\u4e32\u4e2d\u7684\u67d0\u4e00\u4e9b\u90e8\u4f4d\u3002 <pre><code>&gt;&gt;&gt; pat=re.compile(r'(?P&lt;K&gt;a)\\w(c)')    #\u52062\u7ec4\uff1a\u547d\u540d\u5206\u7ec4+\u533f\u540d\u5206\u7ec4\n&gt;&gt;&gt; pat.search('abcdef').groups()       #\u53d6\u6240\u6709\u5206\u7ec4\uff0c\u5143\u7ec4\u5f62\u5f0f\u8fd4\u56de\n('a', 'c')\n&gt;&gt;&gt; pat.search('abcdef').group(1)       #\u53d6\u5206\u7ec41\uff0c\u9002\u7528\u4e8ematch\n'a'\n&gt;&gt;&gt; pat.search('abcdef').group(2)       #\u53d6\u5206\u7ec42\uff0c\u9002\u7528\u4e8ematch\n'c'\n&gt;&gt;&gt; pat.search('abcdef').group()        #\u9ed8\u8ba4\u8fd4\u56de\u5339\u914d\u7684\u5b57\u7b26\u4e32\n'abc'\n&gt;&gt;&gt; pat.search('abcdef').groupdict()    #\u547d\u540d\u5206\u7ec4\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u5b57\u5178\u3010\u4e13\u6709\u3011\uff0c\u533f\u540d\u5206\u7ec4\u4e5f\u6ca1\u6709\n{'K': 'a'}\n</code></pre>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#pname","title":"\u201c(?P=name)\u201d\uff1a\u5f15\u7528\u522b\u540d\u4e3a\u7684\u5206\u7ec4\u5339\u914d\u5230\u7684\u4e32 <pre><code>&gt;&gt;&gt; pat=re.compile(r'(?P&lt;K&gt;a)\\w(c)(?P=K)')    #(?P=K)\u5f15\u7528\u5206\u7ec41\u7684\u503c\uff0c\u5c31\u662fa\n&gt;&gt;&gt; pat.search('abcdef').group()              #\u5339\u914d\u4e0d\u5230\uff0c\u56e0\u4e3a\u5b8c\u6574'a\\wca',\u6a21\u5f0f\u7684\u7b2c4\u4f4d\u662fa\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nAttributeError: 'NoneType' object has no attribute 'group'\n\n&gt;&gt;&gt; pat.search('abcadef').group()             #\u5339\u914d\u5230\uff0c\u6a21\u5f0f\u7684\u7b2c4\u4f4d\u548c\u7ec41\u4e00\u6837,\u503c\u662fc\n'abca'\n&gt;&gt;&gt; pat.search('abcadef').groups()\n('a', 'c')\n&gt;&gt;&gt; pat.search('abcadef').group(1)\n'a'\n&gt;&gt;&gt; pat.search('abcadef').group(2)\n'c\n</code></pre>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_14","title":"\u201c\u201d \uff1a\u5f15\u7528\u5206\u7ec4\u7f16\u53f7\u5339\u914d\uff1a <pre><code>&gt;&gt;&gt; pat=re.compile(r'(?P&lt;K&gt;a)\\w(c)(?P=K)\\2')  #\\2\u5f15\u7528\u5206\u7ec42\u7684\u503c\uff0c\u5c31\u662fc\n&gt;&gt;&gt; pat.findall('Aabcadef')                   #\u5339\u914d\u4e0d\u5230\uff0c\u56e0\u4e3a\u5b8c\u6574'a\\wcac',\u6a21\u5f0f\u7684\u7b2c5\u4f4d\u662fc\n[]\n&gt;&gt;&gt; pat.findall('Aabcacdef')                  #\u5339\u914d\u5230\uff0c\u6a21\u5f0f\u7684\u7b2c5\u4f4d\u548c\u7ec42\u4e00\u6837,\u503c\u662fc\n[('a', 'c')]\n&gt;&gt;&gt; pat.search('Aabcacdef').groups()\n('a', 'c')\n&gt;&gt;&gt; pat.search('Aabcacdef').group()\n'abcac'\n&gt;&gt;&gt; pat.search('Aabcacdef').group(1)\n'a'\n&gt;&gt;&gt; pat.search('Aabcacdef').group(2)\n'c'\n</code></pre>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_15","title":"\u7279\u6b8a\u6784\u9020 <ul> <li><code>(?:\u2026) (\u2026)</code>\u4e0d\u5206\u7ec4\u7248\u672c,\u7528\u4e8e\u4f7f\u7528 <code>|</code> \u6216\u8005\u540e\u63a5\u6570\u91cf\u8bcd</li> <li><code>(?iLmsux)</code> iLmsux\u7684\u6bcf\u4e2a\u5b57\u7b26\u4ee3\u8868\u4e00\u4e2a\u5339\u914d\u6a21\u5f0f,\u53ea\u80fd\u7528\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5f00\u5934,\u53ef\u9009\u591a\u4e2a</li> <li><code>(?#\u2026)</code> #\u53f7\u540e\u7684\u5185\u5bb9\u5c06\u4f5c\u4e3a\u6ce8\u91ca</li> <li><code>(?=\u2026)</code> \u4e4b\u540e\u7684\u5b57\u7b26\u4e32\u5185\u5bb9\u9700\u8981\u5339\u914d\u8868\u8fbe\u5f0f\u624d\u80fd\u6210\u529f\u5339\u914d</li> <li><code>(?!\u2026)</code> \u4e4b\u540e\u7684\u5b57\u7b26\u4e32\u4e0d\u5339\u914d\u8868\u8fbe\u5f0f\u624d\u80fd\u6210\u529f</li> <li><code>(?(?(?(id/name) yes |no)</code> \u5982\u679c\u7f16\u53f7\u4e3aid/\u540d\u5b57\u4e3aname\u7684\u7ec4\u5339\u914d\u5230\u5b57\u7b26\u4e32,\u5219\u9700\u8981\u5339\u914dyes,\u5426\u5219\u5339\u914dno,no\u53ef\u4ee5\u7701\u7565</li> </ul>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_16","title":"\u201c(?:\u2026)\u201d \uff1a()\u91cc\u9762\u6709?:\u8868\u793a\u8be5()\u4e0d\u662f\u5206\u7ec4 <pre><code>&gt;&gt;&gt; pat=re.compile(r'a(?:bc)')\n&gt;&gt;&gt; pat.findall('abc')\n['abc']\n&gt;&gt;&gt; pat.match('abc').groups()      #\u663e\u793a\u4e0d\u51fa\u5206\u7ec4\n</code></pre>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_17","title":"\u201c(?=\u2026)\u201d\uff1a\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u540e\u8fdb\u884c\u5339\u914d\uff0c\u603b\u662f\u5bf9\u540e\u9762\u8fdb\u884c\u5339\u914d <pre><code>&gt;&gt;&gt; pat=re.compile(r'\\w(?=\\d)')    #\u5339\u914d\u8868\u8fbe\u5f0f\\d\uff0c\u8fd4\u56de\u6570\u5b57\u7684\u524d\u4e00\u4f4d\uff0c\\w\uff1a\u5355\u8bcd\u5b57\u7b26[A-Za-z0-9]\n&gt;&gt;&gt; pat.findall('abc1 def1 xyz1')\n['c', 'f', 'z']\n&gt;&gt;&gt; pat.findall('zhoujy20130628hangzhou')  #\u5339\u914d\u6570\u5b57\u7684\u524d\u4e00\u4f4d\uff0c\u5217\u8868\u8fd4\u56de\n['y', '2', '0', '1', '3', '0', '6', '2']\n&gt;&gt;&gt; pat=re.compile(r'\\w+(?=\\d)')\n&gt;&gt;&gt; pat.findall('abc1,def1,xyz1')          #\u5339\u914d\u6700\u672b\u6570\u5b57\u7684\u524d\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u8fd4\u56de\n['abc', 'def', 'xyz']\n&gt;&gt;&gt; pat.findall('abc21,def31,xyz41')\n['abc2', 'def3', 'xyz4']\n&gt;&gt;&gt; pat.findall('zhoujy20130628hangzhou')\n['zhoujy2013062']\n&gt;&gt;&gt; pat=re.compile(r'[A-Za-z]+(?=\\d)')       #[A-Za-z],\u5339\u914d\u5b57\u6bcd,\u53ef\u4ee5\u7528\u5176\u4ed6\u7684\u6b63\u5219\u65b9\u6cd5\n&gt;&gt;&gt; pat.findall('zhoujy20130628hangzhou123') #\u5339\u914d\u540e\u9762\u5e26\u6709\u6570\u5b57\u7684\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u8fd4\u56de\n['zhoujy', 'hangzhou']\n&gt;&gt;&gt; pat.findall('abc21,def31,xyz41')\n['abc', 'def', 'xyz']\n</code></pre>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_18","title":"\u201c(?!\u2026)\u201d \u4e0d\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u540e\u8fdb\u884c\u5339\u914d <pre><code>&gt;&gt;&gt; pat=re.compile(r'[A-Za-z]+(?!\\d)')       #[A-Za-z],\u5339\u914d\u5b57\u6bcd,\u53ef\u4ee5\u7528\u5176\u4ed6\u7684\u6b63\u5219\u65b9\u6cd5\n&gt;&gt;&gt; pat.findall('zhoujy20130628hangzhou123,12,binjiang310')  #\u5339\u914d\u540e\u9762\u4e0d\u662f\u6570\u5b57\u7684\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u8fd4\u56de\n['zhouj', 'hangzho', 'binjian']\n&gt;&gt;&gt; pat.findall('abc21,def31,xyz41')\n['ab', 'de', 'xy']\n</code></pre>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_19","title":"\u201c(?&lt;=\u2026)\u201d\uff1a\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u524d\u8fdb\u884c\u5339\u914d,\u603b\u662f\u5bf9\u524d\u9762\u8fdb\u884c\u5339\u914d <pre><code>&gt;&gt;&gt; pat=re.compile(r'(?&lt;=\\d)[A-Za-z]+')      #\u5339\u914d\u524d\u9762\u662f\u6570\u5b57\u7684\u5b57\u6bcd\n&gt;&gt;&gt; pat.findall('abc21,def31,xyz41')\n[]\n&gt;&gt;&gt; pat.findall('1abc21,2def31,3xyz41')\n['abc', 'def', 'xyz']\n&gt;&gt;&gt; pat.findall('zhoujy20130628hangzhou123,12,binjiang310')\n['hangzhou']\n</code></pre>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_20","title":"\u201c(?&lt;!\u2026)\u201d\uff1a\u4e0d\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u524d\u8fdb\u884c\u5339\u914d,\u603b\u662f\u5bf9\u524d\u9762\u8fdb\u884c\u5339\u914d <pre><code>&gt;&gt;&gt; pat=re.compile(r'(?&lt;!\\d)[A-Za-z]+')      #\u5339\u914d\u524d\u9762\u4e0d\u662f\u6570\u5b57\u7684\u5b57\u6bcd\n&gt;&gt;&gt; pat.findall('abc21,def31,xyz41')\n['abc', 'def', 'xyz']\n&gt;&gt;&gt; pat.findall('zhoujy20130628hangzhou123,12,binjiang310')\n['zhoujy', 'angzhou', 'binjiang']\n</code></pre>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#idname-yes-no","title":"\u201c(?(id/name) yes |no)\u201d: \u7ec4\u662f\u5426\u5339\u914d\uff0c\u5339\u914d\u8fd4\u56de <pre><code>&gt;&gt;&gt; pat=re.compile(r'a(\\d)?bc(?(1)\\d)')   #no\u7701\u7565\u4e86\uff0c\u5b8c\u6574\u7684\u662fa\\dbc\\d ==&gt; a2bc3,\u603b\u51715\u4f4d\uff0c\u7b2c2\u4f4d\u662f\u53ef\u6709\u53ef\u65e0\u7684\u6570\u5b57\uff0c\u7b2c5\u4e3a\u662f\u6570\u5b57\n&gt;&gt;&gt; pat.findall('abc9')                   #\u8fd4\u56de\u7ec41\uff0c\u4f46\u7b2c2\u4f4d\uff08\u7ec41\uff09\u6ca1\u6709\uff0c\u5373\u8fd4\u56de\u4e86''\n['']\n&gt;&gt;&gt; pat.findall('a8bc9')                  #\u5b8c\u6574\u7684\u6a21\u5f0f\uff0c\u8fd4\u56de\u7ec41\n['8']\n&gt;&gt;&gt; pat.match('a8bc9').group()\n'a8bc9'\n&gt;&gt;&gt; pat.match('a8bc9').group(1)\n'8'\n&gt;&gt;&gt; pat.findall('a8bc')                   #\u7b2c5\u4f4d\u4e0d\u5b58\u5728\uff0c\u5219\u6ca1\u6709\u5339\u914d\u5230\n[]\n</code></pre>","text":""},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#ilmsuxi","title":"\u201c(?iLmsux)\u201d:\u8fd9\u91cc\u5c31\u4ecb\u7ecd\u4e0bi\u53c2\u6570\uff1a\u5927\u5c0f\u5199\u533a\u5206\u5339\u914d <pre><code>&gt;&gt;&gt; pat=re.compile(r'abc')\n&gt;&gt;&gt; pat.findall('abc')\n['abc']\n&gt;&gt;&gt; pat.findall('ABC')\n[]\n&gt;&gt;&gt; pat=re.compile(r'(?i)abc')            #(?i) \u4e0d\u533a\u5206\u5927\u5c0f\u5199\n&gt;&gt;&gt; pat.findall('ABC')\n['ABC']\n&gt;&gt;&gt; pat.findall('abc')\n['abc']\n&gt;&gt;&gt; pat.findall('aBc')\n['aBc']\n&gt;&gt;&gt; pat.findall('aBC')\n['aBC']\n&gt;&gt;&gt; pat=re.compile(r'abc',re.I)           #re.I \u4f5c\u4e3a\u53c2\u6570\u4f7f\u7528\uff0c\u63a8\u8350\n&gt;&gt;&gt; pat.findall('aBC')\n['aBC']\n&gt;&gt;&gt; pat.findall('abc')\n['abc']\n&gt;&gt;&gt; pat.findall('ABC')\n['ABC']\n</code></pre>","text":""},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/","title":"Python\u5b57\u7b26\u4e32\u62fc\u63a5\u603b\u7ed3","text":"<ul> <li>\u539f\u6587</li> </ul>"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#1","title":"\u65b9\u6cd51\uff1a\u52a0\u53f7\u8fde\u63a5","text":"<p>\u5f88\u591a\u8bed\u8a00\u90fd\u652f\u6301\u4f7f\u7528\u52a0\u53f7\u8fde\u63a5\u5b57\u7b26\u4e32\uff0cPython\u4e5f\u4e0d\u4f8b\u5916\uff0c\u53ea\u9700\u8981\u7b80\u5355\u7684\u5c062\u4e2a\u6216\u591a\u4e2a\u5b57\u7b26\u4e32\u76f8\u52a0\u5c31\u53ef\u4ee5\u5b8c\u6210\u62fc\u63a5\u3002</p> <pre><code>a = 'Python'\nb = '\u79c1\u623f\u83dc'\nr = a + b  # \u8f93\u51fa'Python\u79c1\u623f\u83dc'\n</code></pre>"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#2","title":"\u65b9\u6cd52\uff1a\u4f7f\u7528<code>%</code>\u64cd\u4f5c\u7b26","text":"<p>\u5728Python 2.6\u4ee5\u524d\uff0c<code>%</code>\u64cd\u4f5c\u7b26\u662f\u552f\u4e00\u4e00\u79cd\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5\uff0c\u5b83\u4e5f\u53ef\u4ee5\u7528\u4e8e\u8fde\u63a5\u5b57\u7b26\u4e32\u3002</p> <pre><code>a = 'Python'\nb = '\u79c1\u623f\u83dc'\nr = '%s%s' % (a, b)  # \u8f93\u51fa'Python\u79c1\u623f\u83dc'\n</code></pre>"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#3format","title":"\u65b9\u6cd53\uff1a\u4f7f\u7528<code>format</code>\u65b9\u6cd5","text":"<p>format\u65b9\u6cd5\u662fPython 2.6\u4e2d\u51fa\u73b0\u7684\u4e00\u79cd\u4ee3\u66ff<code>%</code>\u64cd\u4f5c\u7b26\u7684\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u65b9\u6cd5\uff0c\u540c\u6837\u53ef\u4ee5\u7528\u6765\u8fde\u63a5\u5b57\u7b26\u4e32\u3002</p> <pre><code>a = 'Python'\nb = '\u79c1\u623f\u83dc'\nr = '{}{}'.format(a, b)\n</code></pre>"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#4f-string","title":"\u65b9\u6cd54\uff1a\u4f7f\u7528<code>f-string</code>","text":"<p>Python 3.6\u4e2d\u5f15\u5165\u4e86Formatted String Literals\uff08\u5b57\u9762\u91cf\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff09\uff0c\u7b80\u79f0f-string\uff0c<code>f-string</code>\u662f<code>%</code>\u64cd\u4f5c\u7b26\u548c<code>format</code>\u65b9\u6cd5\u7684\u8fdb\u5316\u7248\uff0c\u4f7f\u7528<code>f-string</code>\u8fde\u63a5\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5\u548c\u4f7f\u7528<code>%</code>\u64cd\u4f5c\u7b26\u3001<code>format</code>\u65b9\u6cd5\u7c7b\u4f3c\u3002</p> <pre><code>a = 'Python'\nb = '\u79c1\u623f\u83dc'\nr = f'{a}{b}'\n</code></pre>"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#5strjoin","title":"\u65b9\u6cd55\uff1a\u4f7f\u7528<code>str.join()</code>\u65b9\u6cd5","text":"<p>\u5b57\u7b26\u4e32\u6709\u4e00\u4e2a\u5185\u7f6e\u65b9\u6cd5<code>join</code>\uff0c\u5176\u53c2\u6570\u662f\u4e00\u4e2a\u5e8f\u5217\u7c7b\u578b\uff0c\u4f8b\u5982\u6570\u7ec4\u6216\u8005\u5143\u7ec4\u7b49\u3002</p> <pre><code>a = 'Python' \nb = '\u79c1\u623f\u83dc'\nr = ''.join([a, b])\n</code></pre>"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#_1","title":"\u603b\u7ed3","text":"<p>\u8fde\u63a5\u5c11\u91cf\u5b57\u7b26\u4e32\u65f6 \u4f7f\u7528\u52a0\u53f7\u8fde\u63a5\u7b26\u5728\u6027\u80fd\u548c\u53ef\u8bfb\u6027\u4e0a\u90fd\u662f\u660e\u667a\u7684\uff0c\u5982\u679c\u5bf9\u53ef\u8bfb\u6027\u6709\u66f4\u9ad8\u7684\u8981\u6c42\uff0c\u5e76\u4e14\u4f7f\u7528\u7684Python 3.6\u4ee5\u4e0a\u7248\u672c\uff0c<code>f-string</code>\u4e5f\u662f\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u9009\u62e9\uff0c\u4f8b\u5982\u4e0b\u9762\u8fd9\u79cd\u60c5\u51b5\uff0c<code>f-string</code>\u7684\u53ef\u8bfb\u6027\u663e\u7136\u6bd4\u52a0\u53f7\u8fde\u63a5\u597d\u5f97\u591a\u3002</p> <pre><code>a = f'\u59d3\u540d\uff1a{name} \u5e74\u9f84\uff1a{age} \u6027\u522b\uff1a{gender}'\nb = '\u59d3\u540d\uff1a' + name + '\u5e74\u9f84\uff1a' + age + '\u6027\u522b\uff1a' + gender\n</code></pre> <p>\u8fde\u63a5\u5927\u91cf\u5b57\u7b26\u4e32\u65f6 <code>join</code>\u548c<code>f-string</code>\u90fd\u662f\u6027\u80fd\u6700\u597d\u7684\u9009\u62e9\uff0c\u9009\u62e9\u65f6\u4f9d\u7136\u53d6\u51b3\u4e8e\u4f60\u4f7f\u7528\u7684Python\u7248\u672c\u4ee5\u53ca\u5bf9\u53ef\u8bfb\u6027\u7684\u8981\u6c42\uff0c<code>f-string</code>\u5728\u8fde\u63a5\u5927\u91cf\u5b57\u7b26\u4e32\u65f6\u53ef\u8bfb\u6027\u5e76\u4e0d\u4e00\u5b9a\u597d\u3002\u5207\u8bb0\u4e0d\u8981\u4f7f\u7528\u52a0\u53f7\u8fde\u63a5\uff0c\u5c24\u5176\u662f\u5728for\u5faa\u73af\u4e2d\u3002</p>"},{"location":"Regular-Expression/","title":"\u6b63\u898f\u8868\u73fe\uff08Regular Expression\uff09\u3068\u306f\uff1f","text":"<ul> <li>\u5143URL</li> </ul>"},{"location":"Regular-Expression/#regular-expression","title":"\u6b63\u898f\u8868\u73fe\uff08Regular Expression\uff09\u3068\u306f\uff1f","text":"<ul> <li>\u6587\u5b57\u5217\u3092\u30d1\u30bf\u30fc\u30f3\u5316\u3057\u3001\u7279\u6b8a\u306a\u6587\u5b57\uff08\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u3001\u30e1\u30bf\u6587\u5b57\uff09\u3067\u8868\u73fe\u3057\u305f\u3082\u306e</li> </ul> <p>\u4f8b\u3048\u3070\u3001\u90f5\u4fbf\u756a\u53f7\u3092\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u3063\u3066\u8868\u3059\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u73fe\u3067\u304d\u308b\u3002</p> <pre><code>\u90f5\u4fbf\u756a\u53f7\u306e\u6b63\u898f\u8868\u73fe\n\\d{3}-?\\d{4}\n# 3\u6841\u306e\u6570\u5b57 + \u30cf\u30a4\u30d5\u30f3\u6709\u308aor\u7121\u3057 + 4\u6841\u306e\u6570\u5b57\n</code></pre> <p>\u3053\u306e<code>\u300c\\d\u300d\u300c{}\u300d\u300c?\u300d</code>\u306e\u3088\u3046\u306a\u6587\u5b57\u306e\u3053\u3068\u3092 \u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff08\u30e1\u30bf\u6587\u5b57\uff09 \u3068\u3044\u3046\u3002</p>"},{"location":"Regular-Expression/#_1","title":"\u6b63\u898f\u8868\u73fe\u306e\u7531\u6765","text":"<ul> <li>1940\u5e74\u4ee3\u306b\u3055\u307e\u3056\u307e\u306a\u795e\u7d4c\u751f\u7406\u5b66\u8005\u305f\u3061\u304c\u3001\u795e\u7d4c\u56de\u8def\u3092\u6570\u5b66\u7684\u306b\u8aac\u660e\u3059\u308b\u305f\u3081\u306b\u958b\u767a\u3057\u305f\u3002</li> <li>1956\u5e74\u3001\u6570\u5b66\u8005 Stephen Kleene\uff08\u30b9\u30c6\u30a3\u30fc\u30d6\u30f3\u30fb\u30af\u30ea\u30fc\u30cd\uff09 \u304c\u3001\u305d\u306e\u8003\u3048\u65b9\u306b\u57fa\u3065\u304d\u8ad6\u6587\u3092\u8457\u8ff0\u3057\u3001\u521d\u3081\u3066\u6b63\u898f\u8868\u73fe\u306e\u6982\u5ff5\u304c\u7d39\u4ecb\u3055\u308c\u305f\u3002</li> <li>\u3053\u3053\u3067\u300c\u6b63\u5247\u96c6\u5408\u306e\u4ee3\u6570\u300d\u3092\u8aac\u660e\u3059\u308b\u305f\u3081\u306b\u300c\u6b63\u5247\u8868\u73fe\u30fb\u6b63\u898f\u8868\u73fe(regular expression)\u300d\u304c\u4f7f\u7528\u3055\u308c\u305f\u3002 \u4f55\u304c\u8a00\u3044\u305f\u304b\u3063\u305f\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u5143\u3005\u306f\u795e\u7d4c\u56de\u8def\u306e\u7814\u7a76\u3067\u958b\u767a\u3055\u308c\u305f\u6570\u5b66\u7684\u306a\u6982\u5ff5\u3060\u3063\u305f\u3068\u3044\u3046\u3053\u3068\u3002</li> </ul> <p>\u6b63\u898f\u8868\u73fe\u3068\u3044\u3046\u82e5\u5e72\u5206\u304b\u308a\u306b\u304f\u3044\u30cd\u30fc\u30df\u30f3\u30b0\u306f\u3053\u306e\u305b\u3044</p> <p>\u53c2\u8003\uff1a\u6b63\u898f\u8868\u73fe\u306e\u7531\u6765</p>"},{"location":"Regular-Expression/#_2","title":"\u4f55\u306e\u5f79\u306b\u7acb\u3064\uff1f","text":"<ul> <li>\u6587\u5b57\u5217\u691c\u7d22\u306b\u5f79\u7acb\u3064</li> <li>grep\u691c\u7d22\u3001\u30a8\u30c7\u30a3\u30bf\u3084Excel\u306e\u691c\u7d22\u6a5f\u80fd</li> <li>\u2192 \u8abf\u67fb\u3001\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u304c\u6357\u308b</li> <li>\u6587\u5b57\u5217\u7f6e\u63db\u306b\u5f79\u7acb\u3064</li> <li>sed\u3001\u30a8\u30c7\u30a3\u30bf\u3084Excel\u306e\u7f6e\u63db\u6a5f\u80fd</li> <li>\u2192 \u6587\u5b57\u5217\u306e\u4e00\u62ec\u4fee\u6b63\u3001\u4e00\u62ec\u633f\u5165\u3001\u4e00\u62ec\u524a\u9664\u304c\u697d\u306b\u306a\u308b</li> <li>\u5165\u529b\u3055\u308c\u305f\u6587\u5b57\u5217\u304c\u3001\u898f\u5b9a\u3055\u308c\u305f\u30d1\u30bf\u30fc\u30f3\u901a\u308a\u306b\u5165\u529b\u3055\u308c\u3066\u3044\u308b\u304b\u306e\u78ba\u8a8d\uff08\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\uff09\u306b\u5f79\u7acb\u3064</li> <li>\u90f5\u4fbf\u756a\u53f7\u3001\u96fb\u8a71\u756a\u53f7\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306a\u3069\u306e\u5165\u529b\u5f62\u5f0f\u306e\u30c1\u30a7\u30c3\u30af\u306a\u3069</li> </ul>"},{"location":"Regular-Expression/#_3","title":"\u6b63\u898f\u8868\u73fe\u3068\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306e\u9055\u3044","text":"<p>\u6700\u521d\u306e\u9803\u306b\u6b63\u898f\u8868\u73fe\u3068\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u52d8\u9055\u3044\u3057\u3066\u3044\u305f\u306e\u3067\u78ba\u8a8d\u3002</p> <p>\u305d\u3082\u305d\u3082\u3001\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08Wild Card\uff09\u3068\u306f\u4f55\u304b\uff1f</p> <ul> <li>\u30c8\u30e9\u30f3\u30d7\u7528\u8a9e\u3067\uff0c\u3069\u306e\u30ab\u30fc\u30c9\u306e\u4ee3\u7528\u306b\u3082\u3067\u304d\u308b\u30ab\u30fc\u30c9\u306e\u3053\u3068\uff08\u30dd\u30fc\u30ab\u30fc\u306b\u304a\u3051\u308b\u30b8\u30e7\u30fc\u30ab\u30fc\u306a\u3069\uff09</li> <li>\u8ee2\u3058\u3066IT\u306b\u304a\u3051\u308b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3068\u306f\u3001 \u4efb\u610f\u306e\u6587\u5b57\u5217 \u306b\u30de\u30c3\u30c1\u3059\u308b\u7279\u6b8a\u6587\u5b57</li> <li>OS\u3084\u8a00\u8a9e\u306b\u3088\u3063\u3066\u89e3\u91c8\u304c\u7570\u306a\u308b</li> </ul>"},{"location":"Regular-Expression/#_4","title":"\u30d5\u30a1\u30a4\u30eb\u691c\u7d22\u306b\u304a\u3051\u308b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9","text":"<ul> <li>windows\u3084Unix/Linux\u306e\u30b7\u30a7\u30eb\u3067\u306e\u30d5\u30a1\u30a4\u30eb\u691c\u7d22\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u304c\u4f7f\u3048\u308b</li> </ul> \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 \u5185\u5bb9 ? \u4efb\u610f\u306e1\u6587\u5b57\u306b\u30de\u30c3\u30c1 * 0\u6587\u5b57\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1 <p><code>music.mp?</code> \u2192 \u300cmusic.mp3\u300d\u300cmusic.mp4\u300d\u306a\u3069\u306b\u30de\u30c3\u30c1</p> <p><code>*.txt</code> \u2192 \u62e1\u5f35\u5b50\u304c.txt\u3067\u3042\u308b\u3082\u306e\u5168\u3066\u306b\u30de\u30c3\u30c1</p>"},{"location":"Regular-Expression/#sql","title":"SQL\u306b\u304a\u3051\u308b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9","text":"<ul> <li>SQL\u306eWHERE\u53e5\u306b\u304a\u3051\u308bLIKE\u6f14\u7b97\u5b50\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u304c\u4f7f\u3048\u308b</li> </ul> \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 \u5185\u5bb9 % 0\u6587\u5b57\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1 _ \u4efb\u610f\u306e\uff11\u6587\u5b57\u306b\u30de\u30c3\u30c1"},{"location":"Regular-Expression/#_5","title":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u3068\u306f\uff1f","text":"<ul> <li>\u305d\u306e\u6587\u5b57\u81ea\u8eab\u3068\u306f\u7570\u306a\u308b\u3001\u7279\u5225\u306a\u610f\u5473\u3084\u5f79\u5272\u3092\u6301\u3064\u6587\u5b57\u306e\u3053\u3068</li> </ul> <p>\u3056\u3063\u304f\u308a\u5206\u985e\u3059\u308b\u3068\u3001</p> <ul> <li>\u6587\u5b57\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a<code>.\uff08\u30c9\u30c3\u30c8\uff09, \\w, \\W, \\s, \\S, \\d, \\D</code>\u306a\u3069</li> <li>\u7e70\u308a\u8fd4\u3057\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a<code>+, *, ?, {n}, {n,m}, {n,}</code></li> <li>\u4f4d\u7f6e\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a<code>^, $, \\b, \\B</code></li> <li>\u6587\u5b57\u96c6\u5408\u3084\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a<code>[], [^], |, (), (?:)</code></li> <li>\u305d\u306e\u4ed6\uff08\u5f8c\u65b9\u53c2\u7167\u306a\u3069\uff09\uff1a<code>\\1, \\2, \\3, ...</code></li> </ul> <p>\u203b\u6b63\u898f\u8868\u73fe\u306e\u5b9f\u88c5\u306b\u3088\u3063\u3066\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u304c\u7570\u306a\u308b\u306e\u3067\u6ce8\u610f</p>"},{"location":"Regular-Expression/#_6","title":"\u6587\u5b57\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf","text":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 \u5099\u8003 .\uff08\u30c9\u30c3\u30c8\uff09 \u4efb\u610f\u306e\uff11\u6587\u5b57\u306b\u30de\u30c3\u30c1 \u6539\u884c\u306b\u306f\u30de\u30c3\u30c1\u3057\u306a\u3044 \\w \u5358\u8a9e\u3092\u69cb\u6210\u3059\u308b\u6587\u5b57\u306b\u30de\u30c3\u30c1 w\u306fword\u306e\u982d\u6587\u5b57 \\W \u5358\u8a9e\u3092\u69cb\u6210\u3059\u308b\u6587\u5b57 \u4ee5\u5916\u306e\u6587\u5b57 \u306b\u30de\u30c3\u30c1 \\d \u6570\u5b57\uff080~9\uff09\u306b\u30de\u30c3\u30c1 d\u306fdigit\u306e\u982d\u6587\u5b57 \\D \u6570\u5b57 \u4ee5\u5916\u306e\u6587\u5b57 \u306b\u30de\u30c3\u30c1 \\s \u7a7a\u767d\u6587\u5b57\uff08\u534a\u89d2\u30b9\u30da\u30fc\u30b9\u3001\u30bf\u30d6\u6587\u5b57\u4ed6\uff09\u306b\u30de\u30c3\u30c1 s\u306fspace\u306e\u982d\u6587\u5b57 \\S \u7a7a\u767d\u6587\u5b57 \u4ee5\u5916\u306e\u6587\u5b57 \u306b\u30de\u30c3\u30c1"},{"location":"Regular-Expression/#_7","title":"\u5236\u5fa1\u6587\u5b57\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf","text":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 \\t \u30bf\u30d6\u6587\u5b57 \\v \u5782\u76f4\u30bf\u30d6 \\n \u6539\u884c\u6587\u5b57 \\r \u6539\u884c\u6587\u5b57\uff08\u30ad\u30e3\u30ec\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\uff09 \\f \u7528\u7d19\u9001\u308a\u6587\u5b57 \\a \u8b66\u544a\u6587\u5b57 \\e \u30a8\u30b9\u30b1\u30fc\u30d7\u6587\u5b57"},{"location":"Regular-Expression/#_8","title":"\u7e70\u308a\u8fd4\u3057\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff08\u91cf\u6307\u5b9a\u5b50\uff09","text":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 \u5099\u8003 {n} n\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {n,m} n\u56de\u4ee5\u4e0am\u56de\u4ee5\u4e0b\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {n,} n\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 * 0\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {0,}\u3068\u540c\u7fa9 + 1\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {1,}\u3068\u540c\u7fa9 ? 0\u56de\u307e\u305f\u306f1\u56de\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {0,1}\u3068\u540c\u7fa9"},{"location":"Regular-Expression/#_9","title":"\u4f4d\u7f6e\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff08\u30a2\u30f3\u30ab\u30fc\uff09","text":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 $ \u884c\u672b ^ \u884c\u982d \\b \u5358\u8a9e\u5883\u754c \\B \u5358\u8a9e\u5883\u754c\u4ee5\u5916"},{"location":"Regular-Expression/#_10","title":"\u6587\u5b57\u96c6\u5408\u3084\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf","text":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 [abc] a\u304bb\u304bc\u306e\u3069\u308c\u304b1\u6587\u5b57\u306b\u30de\u30c3\u30c1 [a-z] a\u304b\u3089z\u306e\u3069\u308c\u304b1\u6587\u5b57\u306b\u30de\u30c3\u30c1 [^abc] abc\u4ee5\u5916\u306e\u3069\u308c\u304b1\u6587\u5b57\u306b\u30de\u30c3\u30c1 <code>abc|def</code> abc\u307e\u305f\u306fdef\u306e\u30d1\u30bf\u30fc\u30f3\u306b\u30de\u30c3\u30c1 (abc) \u30b0\u30eb\u30fc\u30d7\u5316\u3068\u30ad\u30e3\u30d7\u30c1\u30e3\u3092\u884c\u3046 (?:abc) \u30b0\u30eb\u30fc\u30d7\u5316\u3092\u884c\u3046"},{"location":"Regular-Expression/#a-z","title":"[a-z]\u306b\u3064\u3044\u3066","text":"<ul> <li>[a-z]\u306ea-z\u306e\u7bc4\u56f2\u306f\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u7bc4\u56f2</li> <li>Unicode\u306e\u6587\u5b57\u30b3\u30fc\u30c9\u756a\u53f7\u3092\u4f7f\u7528\u3057\u3066[\\u0061-\\u007A]\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u3082\u3067\u304d\u308b</li> </ul>"},{"location":"Regular-Expression/#_11","title":"\u305d\u306e\u4ed6\u306e\u6b63\u898f\u8868\u73fe\u306e\u6a5f\u80fd","text":"<p>\u4ee5\u4e0b\u306e\u6a5f\u80fd\u306f\u3001\u51e6\u7406\u7cfb\u306b\u3088\u3063\u3066\u306f\u4f7f\u7528\u3067\u304d\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f\u3059\u308b\u3053\u3068\u3002</p>"},{"location":"Regular-Expression/#_12","title":"\u30b0\u30eb\u30fc\u30d7\u5316","text":"<ul> <li>(abc)\u306e\u3088\u3046\u306b\u62ec\u5f27\u5185\u306e\u6587\u5b57\u5217\u3092\u3072\u3068\u307e\u3068\u3081\u306b\u6271\u3046\u3053\u3068</li> </ul> <p>\u4f8b1) hogehoge....\u3068\u300choge\u300d\u3092\u7e70\u308a\u8fd4\u3059\u6587\u5b57\u5217\u3092\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044\u5834\u5408\u3001\u4ee5\u4e0b\u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b\u3002</p> <pre><code>\u30b0\u30eb\u30fc\u30d7\u5316\u306e\u4f8b1\n(hoge)+  \n</code></pre> <p>\u4f8b2) https://www.yahoo.co.jp/ \u3068 https://www.google.co.jp/ \u306e\u4e21\u65b9\u306b\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044\u5834\u5408\u3001\u4ee5\u4e0b\u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b</p> <pre><code>\u30b0\u30eb\u30fc\u30d7\u5316\u306e\u4f8b2\nhttps://www\\.(google|yahoo)\\.co\\.jp/\n</code></pre> <p>\u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b\u3002</p>"},{"location":"Regular-Expression/#_13","title":"\u30ad\u30e3\u30d7\u30c1\u30e3","text":"<ul> <li>(abc)\u62ec\u5f27\u5185\u306e\u6587\u5b57\u5217\u3092\u8a18\u61b6\u3057\u3001\u53c2\u7167\u51fa\u6765\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068</li> <li>\\1 ,\\2 ,\\3...\u3067\u524d\u65b9\u3067\u8a18\u61b6\u3057\u305f\u6587\u5b57\u5217\u3092\u30de\u30c3\u30c1\u3055\u305b\u308b\u3053\u3068\u304c\u51fa\u6765\u308b</li> <li>$1 ,$2 ,$3...\u3067\u8a18\u61b6\u3057\u305f\u6587\u5b57\u5217\u3092\u5909\u6570\u3068\u3057\u3066\u53c2\u7167\u3067\u304d\u308b\uff08\u7f6e\u63db\u306b\u3082\u4f7f\u3048\u308b\uff09</li> </ul> <p>\u203b\u4f7f\u7528\u51fa\u6765\u308b\u304b\u3069\u3046\u304b\u304c\u8a00\u8a9e\u306b\u3088\u3063\u3066\u7570\u306a\u308b\u306e\u3067\u6ce8\u610f</p> <p>\u4f8b1) hoge_hoge \u306e\u3088\u3046\u306b\u3001\u524d\u5f8c\u304c\u540c\u3058\u3082\u306e\u3092\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044</p> <pre><code>\u30ad\u30e3\u30d7\u30c1\u30e3\u306e\u306e\u4f8b1\n# \u691c\u7d22\u6587\u5b57\u5217\n(.+)_\\1\n</code></pre> <p>\u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b\u3002\u3053\u306e\u3088\u3046\u306b\u524d\u65b9\u3067\u30de\u30c3\u30c1\u3057\u305f\u3082\u306e\u3092\u53c2\u7167\u3059\u308b\u3053\u3068\u3092 \u5f8c\u65b9\u53c2\u7167 \u3068\u3044\u3046\u3002</p> <p>\u4f8b2) https://www.google.co.jp/ \u306ea\u30bf\u30b0\u5185\u306e\u5024\u3092href\u5c5e\u6027\u306b\u8a2d\u5b9a\u3057\u305f\u3044\u5834\u5408\u3001</p> <pre><code>\u30ad\u30e3\u30d7\u30c1\u30e3\u306e\u4f8b2\n# \u691c\u7d22\u6587\u5b57\u5217\n&lt;a&gt;(.+?)&lt;/a&gt;\n\n# \u7f6e\u63db\u6587\u5b57\u5217\n&lt;a href=\"$1\"&gt;$1&lt;/a&gt;\n</code></pre> <p>\u3067\u7f6e\u63db\u3067\u304d\u308b\u3002</p> <p>\u4f8b3) hoge@fuga.com\u304b\u3089\u306e\u30ed\u30fc\u30ab\u30eb\u90e8\u3001\u30c9\u30e1\u30a4\u30f3\u90e8\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u5168\u4f53\u3092\u53d6\u308a\u51fa\u3057\u305f\u3044\u5834\u5408\u3001</p> <pre><code>\u30ad\u30e3\u30d7\u30c1\u30e3\u306e\u4f8b3\n# \u691c\u7d22\u6587\u5b57\u5217\n((.+)@(.+))\n\n# \u7f6e\u63db\u6587\u5b57\u5217\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9=$1\\n\u30ed\u30fc\u30ab\u30eb\u90e8=$2\\n\u30c9\u30e1\u30a4\u30f3\u90e8=$3\n</code></pre> <p>\u3067\u7f6e\u63db\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u7d50\u679c\u306b\u306a\u308b\u3002</p> <pre><code>\u4f8b3\u306e\u7d50\u679c\n\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9=hoge@fuga.com\n\u30ed\u30fc\u30ab\u30eb\u90e8=hoge\n\u30c9\u30e1\u30a4\u30f3\u90e8=fuga.com\n</code></pre> <p>\u30ad\u30e3\u30d7\u30c1\u30e3\u3059\u308b\u9806\u756a\u306f\u300c(\u300d\u304c\u73fe\u308c\u305f\u9806\u306b\u306a\u3063\u3066\u3044\u308b\u3002</p>"},{"location":"Regular-Expression/#_14","title":"\u30ad\u30e3\u30d7\u30c1\u30e3\u3057\u306a\u3044\u62ec\u5f27","text":"<ul> <li> <p>(?:)\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u30b0\u30eb\u30fc\u30d7\u5316\u306e\u307f\u3092\u884c\u3044\u30ad\u30e3\u30d7\u30c1\u30e3\u3092\u884c\u308f\u306a\u3044</p> </li> <li> <p>\u30b0\u30eb\u30fc\u30d7\u5316\u306e\u307f\u304c\u76ee\u7684\u3067\u3042\u308b\u3053\u3068\u3092\u660e\u793a\u3057\u305f\u3044\u5834\u5408\u3053\u306e\u3088\u3046\u306b\u66f8\u304f</p> </li> <li>\u82e5\u5e72\u8aad\u307f\u306b\u304f\u304f\u306a\u308b\uff08\u53ef\u8aad\u6027\u304c\u4e0b\u304c\u308b\uff09\u306e\u3067\u3001\u3069\u3061\u3089\u3067\u66f8\u3044\u305f\u65b9\u304c\u3044\u3044\u304b\u306f\u72b6\u6cc1\u306b\u3088\u308b</li> </ul> <pre><code>\u30ad\u30e3\u30d7\u30c1\u30e3\u3057\u306a\u3044\u62ec\u5f27\u306e\u4f8b\nhttps://www\\.(?:google|yahoo)\\.co\\.jp/ \n</code></pre>"},{"location":"Regular-Expression/#_15","title":"\u5148\u8aad\u307f\u3068\u5f8c\u8aad\u307f","text":"\u5148\u8aad\u307f\u30fb\u5f8c\u8aad\u307f \u6b63\u898f\u8868\u73fe \u610f\u5473 \u80af\u5b9a\u5148\u8aad\u307f(positive look forward) (?=abc) \u524d\u65b9\u3092\u898b\u3066abc\u304c\u3042\u308b\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u5426\u5b9a\u5148\u8aad\u307f(negative look forward) (?!abc) \u524d\u65b9\u3092\u898b\u3066abc\u304c\u306a\u3044\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u80af\u5b9a\u5f8c\u8aad\u307f(positive look behind) (?&lt;=abc) \u5f8c\u65b9\u3092\u898b\u3066abc\u304c\u3042\u308b\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u5426\u5b9a\u5f8c\u8aad\u307f(negative look behind) (?&lt;!abc) \u5f8c\u65b9\u3092\u898b\u3066abc\u304c\u306a\u3044\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 <p>\u203bJavaScript\u7cfb\u3067\u306f\u5f8c\u8aad\u307f\u306f\u5b9f\u88c5\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u6ce8\u610f</p> <pre><code>\u4f8b\ncustomer.fullname\ncustomer.firstName\ncustomer.lastName\nemployee.firstName\nemployee.lastName\nofficer.firstName\nofficer.lastName\n</code></pre> <ul> <li>customer(?=.firstName)</li> <li>\u2192\u5f8c\u308d\u306bfirstName\u304c\u7d9a\u304fcustomer\u306b\u30de\u30c3\u30c1</li> <li>customer(?!.firstName)</li> <li>\u2192\u5f8c\u308d\u306bfullName\u304c\u6765\u306a\u3044customer\u306b\u30de\u30c3\u30c1</li> <li>(?&lt;=customer.)firstName</li> <li>\u2192customer\u306e\u5f8c\u308d\u306efirstName\u306b\u30de\u30c3\u30c1</li> <li>(?&lt;!customer.)firstName</li> <li>\u2192customer\u4ee5\u5916\u306e\u5f8c\u308d\u306efirstName\u306b\u30de\u30c3\u30c1</li> </ul>"},{"location":"Regular-Expression/#_16","title":"\uff5e\u3092\u542b\u3080\u30fb\u542b\u307e\u306a\u3044","text":"<ul> <li>\u5148\u8aad\u307f\u30fb\u5f8c\u8aad\u307f\u3092\u5fdc\u7528\u3059\u308b\u3068\u3001\uff5e\u3092\u542b\u3080\u30fb\u542b\u307e\u306a\u3044\u884c\u306f\u4ee5\u4e0b\u306e\u6b63\u898f\u8868\u73fe\u306e\u3088\u3046\u306b\u8868\u305b\u308b</li> </ul> <pre><code>abc\u3092\u542b\u3080\u884c\u30fb\u542b\u307e\u306a\u3044\u884c\n# abc\u3092\u542b\u3080\u884c\n^(?=.*abc).*\n\n# def\u3092\u542b\u307e\u306a\u3044\u884c\n^(?!.*def).*\n</code></pre> <p>\u4f8b)</p> <p>\u30b9\u30da\u30fc\u30b9\u3092\u542b\u3080\u884c\u3092\u524a\u9664\u3057\u305f\u3044</p> <pre><code>\u30b9\u30da\u30fc\u30b9\u3092\u542b\u3080\u884c\u306e\u524a\u9664\n# \u691c\u7d22\u6587\u5b57\u5217\n^(?=.* ).*\\n\n\n# \u7f6e\u63db\u6587\u5b57\u5217\u306f\u7a7a\u6587\u5b57\n</code></pre>"},{"location":"Regular-Expression/#_17","title":"\u4fee\u98fe\u5b50","text":"<ul> <li>\u591a\u304f\u306e\u51e6\u7406\u7cfb\u306b\u306f\u30de\u30c3\u30c1\u30f3\u30b0\u306e\u51e6\u7406\u65b9\u6cd5\u3092\u5909\u66f4\u3059\u308b\u6307\u5b9a\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b</li> <li>\u672b\u5c3e\u306b\u4ed8\u3051\u308b\u4fee\u98fe\u5b50\u3092\u30d5\u30e9\u30b0\uff08flag\uff09\u3068\u547c\u3076</li> </ul> <pre><code>JavaScript\n// \u4fee\u98fe\u5b50i\u306f\u5927\u6587\u5b57\u3068\u5c0f\u6587\u5b57\u3092\u533a\u5225\u3057\u306a\u3044\uff08ignoreCase\uff09\n// \u4fee\u98fe\u5b50g\u306f\u5168\u3066\u306e\u30de\u30c3\u30c1\u30f3\u30b0\u7b87\u6240\u3092\u691c\u7d22\u3059\u308b\uff08global\uff09\nvar regex = /hoge/ig;\n</code></pre>"},{"location":"Regular-Expression/#_18","title":"\u6b63\u898f\u8868\u73fe\u306b\u304a\u3051\u308b\u6ce8\u610f\u70b9","text":""},{"location":"Regular-Expression/#_19","title":"\u6700\u9577\u30de\u30c3\u30c1\u3068\u6700\u77ed\u30de\u30c3\u30c1","text":"<p>\u601d\u3063\u305f\u3088\u308a\u3082\u9577\u3044\u7bc4\u56f2\u306b\u30de\u30c3\u30c1\u3057\u3066\u3057\u307e\u3046\u30fb\u30fb\u30fb\u3068\u3044\u3046\u6642\u306b\u78ba\u8a8d</p> <ul> <li>\u7e70\u308a\u8fd4\u3057\u6587\u5b57\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30de\u30c3\u30c1\u3057\u3046\u308b\u6700\u5927\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1\u3059\u308b</li> <li>\u7e70\u308a\u8fd4\u3057\u306e\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u306e\u5f8c\u308d\u306b \u300c?\u300d \u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u3057\u3046\u308b\u6700\u5c0f\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1\u3059\u308b</li> </ul> <p>\u4f8b\u3048\u3070\u3001\u300choge@hoge.com\u300d\u304b\u3089hoge\u3092\u5225\u3005\u306b2\u3064\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044\u3068\u3059\u308b\u3002</p> <p>\u6b63\u898f\u8868\u73fe\uff1a<code>h.*e</code></p> <p>\u3068\u3059\u308b\u3068\u3001\u300choge@hoge\u300d\u306b\u30de\u30c3\u30c1\u3057\u3066\u3057\u307e\u3046\u306e\u3067NG\u3001</p> <p>\u6b63\u898f\u8868\u73fe\uff1a<code>h.*?e</code></p> <p>\u306e\u3088\u3046\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002</p>"},{"location":"Regular-Expression/#_20","title":"\u57fa\u672c\u6b63\u898f\u8868\u73fe\u3068\u62e1\u5f35\u6b63\u898f\u8868\u73fe","text":"<p>\u3042\u308c\uff1f\u6b63\u898f\u8868\u73fe\u306f\u5408\u3063\u3066\u308b\u306e\u306b\u30de\u30c3\u30c1\u3057\u306a\u3044\u30fb\u30fb\u30fb\u3068\u3044\u3046\u5834\u5408\u306f\u305d\u3082\u305d\u3082\u6a5f\u80fd\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044\u53ef\u80fd\u6027\u304c\u3042\u308b</p> <ul> <li>POSIX\u6b63\u898f\u8868\u73fe\u306b\u306f2\u7a2e\u985e\u3042\u308a\u3001\u5229\u7528\u3067\u304d\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u3084\u6a5f\u80fd\u304c\u7570\u306a\u308b</li> </ul> \u7a2e\u985e \u7279\u5fb4 \u5bfe\u5fdc \u57fa\u672c\u6b63\u898f\u8868\u73fe(basic regular expression:BRE) grep, sed \u306a\u3069 \u300c<code>|</code>\u300d\u300c+\u300d\u300c?\u300d\u306f\u4f7f\u7528\u4e0d\u53ef\u300c()\u300d\u300c{}\u300d\u306f\u30a8\u30b9\u30b1\u30fc\u30d7\u304c\u5fc5\u8981 \u62e1\u5f35\u6b63\u898f\u8868\u73fe(extended regular expression:ERE) egrep\uff08grep -E\uff09, sed -E \u306a\u3069 \u300c+\u300d\u300c?\u300d\u306f\u4f7f\u7528\u3067\u304d\u308b\u300c()\u300d\u300c{}\u300d\u306f\u30a8\u30b9\u30b1\u30fc\u30d7\u4e0d\u8981 <ul> <li>\u3055\u3089\u306b\u3053\u308c\u306b\u6a5f\u80fd\u3092\u52a0\u3048\u305f\u6b63\u898f\u8868\u73fe\u304c\u3042\u308a\u3001\u8ffd\u52a0\u6a5f\u80fd\u304c\u4f7f\u3048\u308b\u304b\u3069\u3046\u304b\u306f\u5b9f\u88c5\u6bce\u306b\u78ba\u8a8d\u3059\u308b\u3057\u304b\u306a\u3044\u3002</li> </ul> <p>\u53c2\u8003\uff1a3\u3064\u306e\u6b63\u898f\u8868\u73fe\u3092\u77e5\u3089\u306a\u3044\u3068\u30cf\u30de\u308b\u30e8</p>"},{"location":"Regular-Expression/#_21","title":"\u30a8\u30b9\u30b1\u30fc\u30d7\u306e\u5fc5\u8981\u6027","text":"<p>\u30b3\u30fc\u30c9\u5185\u3067\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306b\u306f\u3001\u30a8\u30b9\u30b1\u30fc\u30d7\u304c\uff12\u91cd\u306b\u5fc5\u8981\u306a\u5834\u5408\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f</p> <pre><code>java\n// \u6587\u5b57\u5217\u30ea\u30c6\u30e9\u30eb\nString regex = \"hoge\\\\.com\";\n\n// \u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5\u306e\u6b63\u898f\u8868\u73fe\u306f\\\\\\\\\u3068\u66f8\u304f\u3002\u3053\u308c\u3067\u300c\\\u300d\u306e\u307f\u306b\u30de\u30c3\u30c1\nString backslashRegex = \"\\\\\\\\\";\n</code></pre>"},{"location":"Regular-Expression/#_22","title":"\u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb","text":"<ul> <li>\u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb\u306b\u306f\u305d\u306e\u307e\u307e\u6b63\u898f\u8868\u73fe\u3092\u66f8\u3051\u308b\uff08\u6b63\u898f\u8868\u73fe\u306e\u307f\u306e\u30a8\u30b9\u30b1\u30fc\u30d7\u3067\u826f\u3044\uff09\u3002</li> <li>JavaScript\u3084Ruby\u306a\u3069\u306f\u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u304c\u3001Java\u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044</li> </ul> <pre><code>JavaScript\n// \u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb\nvar regex = /hoge\\.com/;\n</code></pre>"},{"location":"Regular-Expression/#_23","title":"\u6b63\u898f\u8868\u73fe\u306e\u30c1\u30a7\u30c3\u30af\u306b\u5f79\u7acb\u3064\u30b5\u30a4\u30c8","text":"<ul> <li>Regexper\uff1a\u6b63\u898f\u8868\u73fe\u3092\u53ef\u8996\u5316\u3057\u3066\u78ba\u8a8d\u3067\u304d\u308b</li> <li>regex-testdrive\uff1aJava\u306e\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af</li> <li>okumocchi\uff1aPHP\u53ca\u3073JavaScript\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af</li> <li>Regexr\uff1aJavaScript\u306e\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af</li> <li>Rubular\uff1aRuby\u306e\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af\u3001\u30ad\u30e3\u30d7\u30c1\u30e3\u5185\u5bb9\u304c\u308f\u304b\u308b</li> </ul>"},{"location":"Regular-Expression/#_24","title":"\u88dc\u8db3\u30fb\u53c2\u8003","text":""},{"location":"Regular-Expression/#_25","title":"\u300c\\\u300d\uff08\u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5\uff09\u3068\u300c\u00a5\u300d\uff08\u5186\u30de\u30fc\u30af\u306b\u3064\u3044\u3066\uff09","text":"<ul> <li>Unicode\u304c\u5e83\u307e\u308b\u4ee5\u524d\u3001\u548c\u6587\u30d5\u30a9\u30f3\u30c8\u3067\u306f\u300c/\u300d\u306e\u6587\u5b57\u30b3\u30fc\u30c9\uff080x5c\uff09\u306b\u300c\u00a5\u300d\u306e\u8868\u8a18\u3092\u5272\u308a\u5f53\u3066\u3066\u3044\u305f\u305f\u3081\u3001\u300c\\\u300d\u3092\u5165\u529b\u3059\u308b\u3068\u300c\u00a5\u300d\u304c\u8868\u793a\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002</li> <li>\u305d\u306e\u540d\u6b8b\u3067\u300c\\\u300d\u6587\u5b57\u30b3\u30fc\u30c9\uff080x5c\uff09\u3092\u5165\u529b\u3057\u305f\u5834\u5408\u3001\u300c\u00a5\u300d\u304c\u8868\u793a\u3055\u308c\u308b\u5834\u5408\u304c\u3042\u308b\u3002</li> <li>Unicode\u3067\u306f\u300c\\\u300d\u306e\u6587\u5b57\u30b3\u30fc\u30c9\uff08U+005c\uff09\u3068\u306f\u5225\u306b\u3001\u300c\u00a5\u300d\u306b\u6587\u5b57\u30b3\u30fc\u30c9\uff08U+00A5\uff09\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u308b\u3002</li> </ul>"},{"location":"Regular-Expression/#_26","title":"\u6539\u884c\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066","text":"<p>\u6b63\u898f\u8868\u73fe\u3068\u306f\u95a2\u4fc2\u306a\u3044\u3051\u3069\u30ad\u30e3\u30ec\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\u3063\u3066\u306a\u3093\u305e\uff1f\u3068\u601d\u3063\u305f\u306e\u3067\u8abf\u3079\u3066\u307f\u305f</p> <ul> <li>\u300cCR\u300d\u300cLF\u300d\u300cCRLF\u300d\u306e3\u7a2e\u985e\u3042\u308b</li> <li>\u6614\u306eMac\u3067\u306fCR,\u73fe\u5728\u306eMac\u3084Linux\u306a\u3069\u306eUnix\u7cfb\u3067\u306fLF,windows\u3067\u306fCRLF\u3092\u63a1\u7528\u3057\u3066\u3044\u308b</li> </ul> <p>\u30bf\u30a4\u30d7\u30e9\u30a4\u30bf\u30fc\u306b\u306f\u30ad\u30e3\u30ea\u30c3\u30b8\u3068\u3044\u3046\u30ed\u30fc\u30eb\u306b\u7d19\u3092\u631f\u3080\u5f79\u76ee\u3092\u6301\u3064\u90e8\u54c1\u304c\u3042\u308a\u3001\u305d\u306e\u4f4d\u7f6e\u3092\u8abf\u7bc0\u3059\u308b\u300c\u30ad\u30e3\u30ea\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\u30ec\u30d0\u30fc\u300d\u3068\u30011\u884c\u5206\u30ed\u30fc\u30eb\u3092\u56de\u3057\u7d19\u3092\u9001\u308b\u3053\u3068\uff08\u30e9\u30a4\u30f3\u30d5\u30a3\u30fc\u30c9\uff09\u304c\u51fa\u6765\u308b\u30ec\u30d0\u30fc\u3092\u9806\u306b\u64cd\u4f5c\u3059\u308b\u3053\u3068\u3067\u6539\u884c\u3092\u884c\u3063\u3066\u3044\u305f\u3002</p>"},{"location":"Regular-Expression/#carriage-returncr","title":"\u30ad\u30e3\u30ea\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\uff08carriage return:CR\u3001\u5fa9\u5e30\uff09","text":"<ul> <li>\u30ab\u30fc\u30bd\u30eb\u3092\u884c\u306e\u5148\u982d\u306b\u623b\u3059\u6307\u793a\uff08\u5de6\u306b\u79fb\u52d5\uff09</li> </ul>"},{"location":"Regular-Expression/#line-feedlf-newline-end-of-line","title":"\u30e9\u30a4\u30f3\u30d5\u30a3\u30fc\u30c9\uff08line feed:LF, newline, end-of-line\u3001\u72ed\u7fa9\u306e\u6539\u884c\uff09","text":"<ul> <li>\u30ab\u30fc\u30bd\u30eb\u3092\u4e00\u3064\u4e0b\u306e\u884c\u306b\u79fb\u3059\u6307\u793a\uff08\u4e0b\u306b\u79fb\u52d5\uff09</li> <li>\u4ee5\u524d\u306f\u30ab\u30fc\u30bd\u30eb\u3092\u4e0b\u306b\u79fb\u3059\u3060\u3051\u3067\u884c\u982d\u306b\u306f\u623b\u3089\u306a\u304b\u3063\u305f\uff08\u73fe\u5728\u306f\u884c\u982d\u306b\u623b\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\uff09</li> </ul>"},{"location":"Regular-Expression/#grep","title":"grep","text":"<ul> <li>grep\u3068\u306fed\u3068\u3044\u3046\u30e9\u30a4\u30f3\u30a8\u30c7\u30a3\u30bf\u306e\u30b3\u30de\u30f3\u30c9 g/re/p\u306e\u30b3\u30de\u30f3\u30c9\u304b\u3089\u304d\u3066\u3044\u308b</li> <li>global Regular Expression print\u306e\u7565</li> </ul>"},{"location":"Regular-Expression/#validation","title":"\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\uff08validation\uff09\u3068\u306f\uff1f","text":"<ul> <li>validate\uff1a\u691c\u8a3c\u3059\u308b\u30fb\uff08\u59a5\u5f53\u6027\u3092\uff09\u78ba\u8a8d\u3059\u308b\u3001\u6709\u52b9\u6027\u3092\u78ba\u304b\u3081\u308b</li> <li>IT\u5206\u91ce\u3067\u306f\u300c\u898f\u5b9a\u3055\u308c\u305f\u6587\u6cd5\u30fb\u4ed5\u69d8\u901a\u308a\u306b\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u3092\u691c\u8a3c\u3059\u308b\u3053\u3068\u300d</li> <li>\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3001\u96fb\u8a71\u756a\u53f7\u3001\u90f5\u4fbf\u756a\u53f7\u306a\u3069\u6587\u6cd5\u306e\u30c1\u30a7\u30c3\u30af\u306e\u610f\u5473\u3067\u4f7f\u308f\u308c\u308b</li> </ul>"},{"location":"about/","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"about/#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"about/#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"ansbile/","title":"ansible","text":""},{"location":"ansbile/#_1","title":"\u30aa\u30d7\u30b7\u30e7\u30f3","text":"<ul> <li><code>-k, --ask-pass</code><ul> <li>SSH \u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5c0b\u306d\u308b(\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u51fa\u308b)</li> </ul> </li> <li><code>-K, --ask-sudo-pass</code><ul> <li>sudo \u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5c0b\u306d\u308b(\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u51fa\u308b)</li> </ul> </li> <li><code>-C, --check</code><ul> <li>\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306a\u3069\u306e\u5909\u66f4\u306f\u884c\u308f\u306a\u3044\u304c\u3001\u6761\u4ef6\u306e\u78ba\u8a8d\u306a\u3069\u306f\u5b9f\u884c\u3059\u308b</li> </ul> </li> <li><code>-c CONNECTION, --connection=CONNECTION</code><ul> <li>local, ssh, paramiko \u304b\u3089\u9078\u629e\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306f paramiko\u3002\u53e4\u3044 OpenSSH \u3067 ssh \u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f ANSIBLE_SSH_ARGS=\"\" \u3068\u74b0\u5883\u5909\u6570\u3092\u7a7a\u3067\u4e0a\u66f8\u304d\u3059 \u308b\u5fc5\u8981\u304c\u3042\u308b</li> </ul> </li> <li><code>-D, --diff</code><ul> <li>file \u3084 template \u306e\u5dee\u5206(diff)\u3092\u8868\u793a\u3059\u308b\u3002--check \u3068\u4e00\u7dd2\u306b\u4f7f\u3046\u3068\u4fbf\u5229</li> </ul> </li> <li><code>-e EXTRA_VARS, --extra-vars=EXTRA_VARS</code><ul> <li>\u8ffd\u52a0\u306e\u5909\u6570\u3092 key=value \u3067\u6307\u5b9a\u3059\u308b\u3002playbook \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u5909\u6570\u306e\u4e0a\u66f8\u304d\u306f\u3055\u308c\u306a\u3044</li> </ul> </li> <li><code>-f FORKS, --forks=FORKS</code><ul> <li>\u4e26\u5217\u5b9f\u884c\u3059\u308b\u6570(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f5)</li> </ul> </li> <li><code>-h, --help</code><ul> <li>\u3053\u306e\u30d8\u30eb\u30d7\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b</li> </ul> </li> <li><code>-i INVENTORY, --inventory-file=INVENTORY</code><ul> <li>\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f /etc/ansible/hosts)</li> </ul> </li> <li><code>-l SUBNET, --limit=SUBNET</code><ul> <li>\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u3092\u6307\u5b9a\u306e\u3082\u306e\u3060\u3051\u306b\u5236\u9650\u3059\u308b</li> </ul> </li> <li><code>--list-hosts</code><ul> <li>\u305d\u308c\u305e\u308c\u306e playbook \u306e\u5bfe\u8c61\u30db\u30b9\u30c8\u4e00\u89a7\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b\u3002playbook \u306e\u5b9f\u884c\u306f\u3055\u308c\u306a\u3044</li> </ul> </li> <li><code>--list-tasks</code><ul> <li>\u5404 playbook \u306e\u30bf\u30b9\u30af\u4e00\u89a7\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b</li> </ul> </li> <li><code>-M MODULE_PATH, --module-path=MODULE_PATH</code><ul> <li>\u30e2\u30b8\u30e5\u30fc\u30eb\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f /usr/share/ansible)</li> </ul> </li> <li><code>--private-key=PRIVATE_KEY_FILE</code><ul> <li>SSH \u306e\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b</li> </ul> </li> <li><code>--start-at-task=START_AT</code><ul> <li>\u6307\u5b9a\u306e task \u304b\u3089\u958b\u59cb\u3059\u308b</li> </ul> </li> <li><code>--step</code><ul> <li>\u3072\u3068\u3064\u306e task \u3054\u3068\u306b \"Perform task: \u30bf\u30b9\u30af\u540d (y/n/c):\" \u3068\u78ba\u8a8d\u3055\u308c\u308b\u3002y: (yes) \u5b9f\u884c\u3059\u308b\u3001n: (no) \u5b9f\u884c\u3057\u306a\u3044\u3001c: (continue) \u4ee5\u964d\u3092\u78ba\u8a8d\u306a \u3057\u3067\u5b9f\u884c\u3059\u308b</li> </ul> </li> <li><code>-s, --sudo</code><ul> <li>\u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u3067\u306e task \u3092 sudo \u3067\u5b9f\u884c\u3059\u308b</li> </ul> </li> <li><code>-U SUDO_USER, --sudo-user=SUDO_USER</code><ul> <li>sudo \u3067\u306e\u5b9f\u884c\u30e6\u30fc\u30b6\u30fc\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f root)</li> </ul> </li> <li><code>--syntax-check</code><ul> <li>playbook \u306e\u6587\u6cd5\u30c1\u30a7\u30c3\u30af\u3060\u3051\u3092\u884c\u3046</li> </ul> </li> <li><code>-t TAGS, --tags=TAGS</code><ul> <li>\u6307\u5b9a\u306e tag \u304c\u4ed8\u3051\u3089\u308c\u305f task \u306e\u307f\u3092\u5b9f\u884c\u3059\u308b</li> </ul> </li> <li><code>-T TIMEOUT, --timeout=TIMEOUT</code><ul> <li>SSH \u306e\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f10\u79d2)</li> </ul> </li> <li><code>-u REMOTE_USER, --user=REMOTE_USER</code><ul> <li>SSH \u3067\u63a5\u7d9a\u3059\u308b\u30e6\u30fc\u30b6\u30fc\u540d\u3092\u6307\u5b9a\u3059\u308b</li> </ul> </li> <li><code>-v, --verbose</code><ul> <li>\u5197\u9577\u30e2\u30fc\u30c9 (-vvv \u3067\u3088\u308a\u5197\u9577\u306a\u51fa\u529b\u306b\u306a\u308b)</li> </ul> </li> <li><code>--version</code><ul> <li>\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b</li> </ul> </li> </ul>"},{"location":"ansbile_async/","title":"ansbile_async","text":""},{"location":"ansbile_async/#ansible","title":"Ansible\u5e38\u7528\u529f\u80fd\u8bf4\u660e [\u5f02\u6b65\u3001\u5e76\u53d1\u3001\u59d4\u6258\u7b49]","text":"<ul> <li>\u539f\u6587</li> </ul>"},{"location":"ansbile_async/#ansible_1","title":"Ansible\u7684\u540c\u6b65\u6a21\u5f0f\u4e0e\u5f02\u6b65\u6a21\u5f0f","text":""},{"location":"ansbile_async/#_1","title":"\u540c\u6b65\u6a21\u5f0f\uff1a","text":"<p>\u5982\u679c\u8282\u70b9\u6570\u592a\u591a\uff0cansible\u65e0\u6cd5\u4e00\u6b21\u5728\u6240\u6709\u8fdc\u7a0b\u8282\u70b9\u4e0a\u6267\u884c\u4efb\u52a1\uff0c\u90a3\u4e48\u5c06\u5148\u5728\u4e00\u90e8\u5206\u8282\u70b9\u4e0a\u6267\u884c\u4e00\u4e2a\u4efb\u52a1(\u6bcf\u4e00\u6279\u8282\u70b9\u7684\u6570\u91cf\u53d6\u51b3\u4e8efork\u8fdb\u7a0b\u6570\u91cf\uff0c\u9ed8\u8ba4\u4e3a5\u4e2a\uff0c\u53ef\u8bbe\u7f6e)\uff0c\u76f4\u5230\u8fd9\u4e00\u6279\u6240\u6709\u8282\u70b9\u4e0a\u8be5\u4efb\u52a1\u5b8c\u5168\u6267\u884c\u5b8c\u6bd5\u624d\u4f1a\u63a5\u5165\u4e0b\u4e00\u4e2a\u6279\u8282\u70b9\uff0c\u76f4\u5230\u6240\u6709\u8282\u70b9\u5c06\u8be5\u4efb\u52a1\u90fd\u6267\u884c\u5b8c\u6bd5\uff0c\u7136\u540e\u91cd\u65b0\u56de\u5230\u7b2c\u4e00\u6279\u8282\u70b9\u5f00\u59cb\u6267\u884c\u7b2c\u4e8c\u4e2a\u4efb\u52a1\u3002\u4f9d\u6b21\u7c7b\u63a8\uff0c\u76f4\u5230\u6240\u6709\u8282\u70b9\u6267\u884c\u5b8c\u6240\u6709\u4efb\u52a1\uff0cansible\u7aef\u624d\u4f1a\u91ca\u653eshell\u3002\u8fd9\u662f\u9ed8\u8ba4\u540c\u6b65\u6a21\u5f0f\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u672a\u6267\u884c\u5b8c\u6bd5\u65f6\uff0cansible\u662f\u5360\u7528\u5f53\u524dshell\u7684\uff0c\u4efb\u52a1\u6267\u884c\u5b8c\u540e\uff0c\u91ca\u653eshell\u4e86\u624d\u53ef\u4ee5\u8f93\u5165\u5176\u4ed6\u547d\u4ee4\u505a\u5176\u4ed6\u52a8\u4f5c\u3002</p>"},{"location":"ansbile_async/#_2","title":"\u5f02\u6b65\u6a21\u5f0f\uff1a","text":"<p>\u5047\u5982fork\u63a7\u5236\u7684\u5e76\u53d1\u8fdb\u7a0b\u6570\u4e3a5\uff0c\u8fdc\u7a0b\u63a7\u5236\u8282\u70b9\u4e3a24\u4e2a\uff0c\u5219ansible\u4e00\u5f00\u59cb\u4f1a\u5c065\u4e2a\u8282\u70b9\u7684\u4efb\u52a1\u6254\u5728\u540e\u53f0\uff0c\u5e76\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53bb\u68c0\u67e5\u8fd9\u4e9b\u8282\u70b9\u7684\u4efb\u52a1\u5b8c\u6210\u60c5\u51b5\uff0c\u5f53\u67d0\u8282\u70b9\u5b8c\u6210\u4e0d\u4f1a\u7acb\u5373\u8fd4\u56de\uff0c\u800c\u662f\u7ee7\u7eed\u7b49\u5f85\u76f4\u52305\u4e2a\u8fdb\u7a0b\u90fd\u7a7a\u95f2\u4e86\uff0c\u624d\u4f1a\u5c06\u8fd95\u4e2a\u8282\u70b9\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9ansible\u7aef\uff0cansible\u4f1a\u7ee7\u7eed\u5c06\u4e0b\u4e00\u62795\u4e2a\u8282\u70b9\u7684\u4efb\u52a1\u6254\u5728\u540e\u53f0\u5e76\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u8fdb\u884c\u68c0\u67e5\uff0c\u4f9d\u6b21\u7c7b\u63a8\uff0c\u76f4\u5230\u5b8c\u6210\u6240\u6709\u4efb\u52a1\u3002</p> <p>\u5728\u5f02\u6b65\u6a21\u5f0f\u4e0b\uff0c\u5982\u679c\u8bbe\u7f6e\u7684\u68c0\u67e5\u65f6\u95f4\u95f4\u9694\u4e3a0\uff0c\u5728\u5c06\u6bcf\u4e00\u6279\u8282\u70b9\u7684\u4efb\u52a1\u4e22\u5230\u540e\u53f0\u540e\u90fd\u4f1a\u7acb\u5373\u8fd4\u56deansible\uff0c\u5e76\u7acb\u5373\u5c06\u4e0b\u4e00\u6279\u8282\u70b9\u7684\u4efb\u52a1\u4e22\u5230\u540e\u53f0\uff0c\u76f4\u5230\u6240\u6709\u4efb\u52a1\u90fd\u4e22\u5230\u540e\u53f0\u5b8c\u540e\uff0c\u624d\u8fd4\u56deansible\u7aef\uff0cansible\u624d\u4f1a\u7acb\u5373\u91ca\u653e\u5360\u7528\u7684shell\u3002\u5373\u6b64\u65f6ansible\u662f\u4e0d\u4f1a\u7ba1\u5404\u4e2a\u8282\u70b9\u4efb\u52a1\u6267\u884c\u60c5\u51b5\u7684\uff0c\u4e0d\u7ba1\u6267\u884c\u6210\u529f\u6216\u5931\u8d25\u3002\u56e0\u6b64\u5728\u8f6e\u8bad\u68c0\u67e5\u65f6\u95f4\u5185\uff0cansible\u4ecd\u7136\u6b63\u5728\u8fd0\u884c(\u5c3d\u7ba1\u67d0\u6279\u4efb\u52a1\u5df2\u7ecf\u88ab\u653e\u5230\u540e\u53f0\u6267\u884c\u4e86)\uff0c\u5f53\u524dshell\u8fdb\u7a0b\u4ecd\u88ab\u5360\u7528\u5904\u4e8e\u7761\u7720\u72b6\u6001\uff0c\u53ea\u6709\u6307\u5b9a\u7684\u68c0\u67e5\u65f6\u95f4\u95f4\u9694\u4e3a0\uff0c\u624d\u4f1a\u5c3d\u5feb\u5c06\u6240\u6709\u4efb\u52a1\u653e\u5230\u540e\u53f0\u5e76\u91ca\u653eshell\u3002</p>"},{"location":"ansbile_async/#ansible-asyncpoll","title":"\u4e00\u3001Ansible\u7684\u5f02\u6b65\u548c\u8f6e\u8be2  [async\u3001poll]","text":"<p>Ansible\u6709\u65f6\u5019\u8981\u6267\u884c\u7b49\u5f85\u65f6\u95f4\u5f88\u957f\u7684\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u53ef\u80fd\u8981\u6301\u7eed\u5f88\u957f\u65f6\u95f4\uff0c\u8bbe\u7f6e\u8d85\u8fc7ssh\u7684timeout\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u53ef\u4ee5\u9009\u62e9\u5728step\u4e2d\u6307\u5b9aasync\u548cpoll\u6765\u5b9e\u73b0\u5f02\u6b65\u64cd\u4f5c\u3002\u5176\u4e2d\uff1a</p> <ul> <li>async\uff1a\u8868\u793a\u8fd9\u4e2astep\u7684\u6700\u957f\u7b49\u5f85\u65f6\u957f,  \u5982\u679c\u8bbe\u7f6e\u4e3a0, \u8868\u793a\u4e00\u76f4\u7b49\u5f85\u4e0b\u53bb\u76f4\u5230\u52a8\u4f5c\u5b8c\u6210\uff1b</li> <li>poll\uff1a\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f\u3002</li> </ul> <pre><code>ansible\u9ed8\u8ba4\u7684\u6e05\u5355\u6587\u4ef6\u662f/etc/ansible/hosts\uff0c\u4e5f\u5c31\u662fansible\u548cansible-ploybook\u6267\u884c\u65f6\u9ed8\u8ba4\u8bfb\u7684\u6e05\u5355\u6587\u4ef6\u3002\u8fd9\u4e2a\u53ef\u4ee5\u81ea\u884c\u5b9a\u4e49\u3002\n[root@hostname ~]# cat /etc/ansible/ansible.cfg|grep inventory\n#inventory      = /etc/ansible/hosts\n\n[root@hostname ~]# cat /etc/ansible/hosts|tail -2             \n[test_server]                   #\u7ec4\u540d\u6700\u597d\u4e0d\u8981\u4f7f\u7528\"-\"\uff0c\u53ef\u4ee5\u4f7f\u7528\"_\"\n172.16.60.241\n\n1\uff09\u5148\u6765\u770b\u4e0b\u9762\u521d\u59cb\u914d\u7f6e\n[root@hostname ~]# cat /etc/ansible/test.yml\n- hosts : test_server\n  tasks :\n    - name : ansible-test\n      shell : sleep 10\n      #async\u8868\u793a\u4e0a\u8ff0shell\u547d\u4ee4\u7684\u7b49\u5f85\u65f6\u95f4,\u8bbe\u7f6e\u4e3a0\u65f6\u4f1a\u4e00\u76f4\u7b49\u5f85\u547d\u4ee4\u7ed3\u675f\n      async : 5\n      #poll\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f,\u8bbe\u7f6e\u4e3a0\u8868\u793a \u4e0d\u7528\u7b49\u5f85\u7ed3\u679c,\u7ee7\u7eed\u505a\u4e0b\u9762\u7684\u64cd\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u9762\u7684step\u4e2d\u6765\u9a8c\u8bc1\u8fd9\u4e2a\u547d\u4ee4\u662f\u5426\u6210\u529f\u6267\u884c.\n      poll : 2\n\n\u6267\u884c\u4e0b\u770b\u770b\u662f\u5426\u6210\u529f\uff1a\n[root@hostname ~]# ansible-playbook /etc/ansible/test.yml\n\nPLAY [test_server] *******************************************************************************************************************************\n\nTASK [Gathering Facts] ***************************************************************************************************************************\nok: [172.16.60.241]\n\nTASK [ansible-test] ******************************************************************************************************************************\nfatal: [172.16.60.241]: FAILED! =&gt; {\"changed\": false, \"msg\": \"async task did not complete within the requested time - 5s\"}\n\nPLAY RECAP ***************************************************************************************************************************************\n172.16.60.241              : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0 \n\n\u5982\u4e0a\uff0c\u8fd9\u4e2astep\u5931\u8d25, \u56e0\u4e3aansible\u7684\u4efb\u52a1(\u5c31\u662f\u4e0a\u9762\u914d\u7f6e\u4e2d\u7684shell\u52a8\u4f5c)\u64cd\u4f5c\u65f6\u95f4(10s)\u8d85\u8fc7\u4e86\u6700\u5927\u7b49\u5f85\u65f6\u957f(5s)\n\n2\uff09\u5982\u679c\u5c06\u4e0a\u9762\u7684async\u5f02\u6b65\u7b49\u5f85\u65f6\u95f4\u8bbe\u7f6e\u4e3a\u5927\u4e8e10s\uff0c\u6bd4\u598212s\uff0c\u5219\u6267\u884c\u5c31\u6210\u529f\u4e86\uff01\n[root@hostname ~]# cat /etc/ansible/test.yml\n- hosts : test_server\n  tasks :\n    - name : ansible-test\n      shell : sleep 10\n      #async\u8868\u793a\u4e0a\u8ff0shell\u547d\u4ee4\u7684\u7b49\u5f85\u65f6\u95f4,\u8bbe\u7f6e\u4e3a0\u65f6\u4f1a\u4e00\u76f4\u7b49\u5f85\u547d\u4ee4\u7ed3\u675f\n      async : 12\n      #poll\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f,\u8bbe\u7f6e\u4e3a0\u8868\u793a \u4e0d\u7528\u7b49\u5f85\u7ed3\u679c,\u7ee7\u7eed\u505a\u4e0b\u9762\u7684\u64cd\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u9762\u7684step\u4e2d\u6765\u9a8c\u8bc1\u8fd9\u4e2a\u547d\u4ee4\u662f\u5426\u6210\u529f\u6267\u884c.\n      poll : 2\n\n[root@hostname ~]# ansible-playbook /etc/ansible/test.yml             \n\nPLAY [test_server] *******************************************************************************************************************************\n\nTASK [Gathering Facts] ***************************************************************************************************************************\nok: [172.16.60.241]\n\nTASK [ansible-test] ******************************************************************************************************************************\nchanged: [172.16.60.241]\n\nPLAY RECAP ***************************************************************************************************************************************\n172.16.60.241              : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0\n\n\u8fd9\u65f6\u5019\u5c31\u4e0d\u6015\u4efb\u52a1\u8d85\u65f6\u4e86\u3002\u53ef\u4ee5\u6267\u884c\u4e00\u4e2a12s\u7684\u4efb\u52a1\uff08\u5927\u4e8e\u4e0a\u9762shell\u6267\u884c\u7684\u65f6\u95f4\uff09\u3002\u53e6\u5916\uff0c\u5982\u679cpoll\u4e3a0\uff0c\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e0d\u5173\u5fc3\u7ed3\u679c\u7684\u4efb\u52a1\u3002\n\n3\uff09\u6216\u8005\u5c06\u4e0a\u9762\u7684poll\u6570\u503c\u8bbe\u7f6e\u4e3a0\uff0c\u5373\u4e0d\u7528\u7b49\u5f85ansible\u4efb\u52a1\u6267\u884c\u7684\u7ed3\u679c\uff0c\u7acb\u5373\u6267\u884c\u4e0b\u4e00\u4e2astep\u3002\n\u5373\u53ea\u9700\u8981\u5c06\u4efb\u52a1\u547d\u4ee4\u63a8\u9001\u5230ansible\u5ba2\u6237\u673a\u4e0a\uff0c\u4e0d\u9700\u8981\u7b49\u5f85\u4efb\u52a1\u6267\u884c\u5b8c\u6210\u5c31\u7acb\u5373\u6267\u884c\u4e0b\u4e00\u4e2astep\u3002\n\n[root@hostname ~]# cat /etc/ansible/test.yml\n- hosts : test_server\n  tasks :\n    - name : ansible-test\n      shell : sleep 10\n      #async\u8868\u793a\u4e0a\u8ff0shell\u547d\u4ee4\u7684\u7b49\u5f85\u65f6\u95f4,\u8bbe\u7f6e\u4e3a0\u65f6\u4f1a\u4e00\u76f4\u7b49\u5f85\u547d\u4ee4\u7ed3\u675f\n      async : 5\n      #poll\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f,\u8bbe\u7f6e\u4e3a0\u8868\u793a \u4e0d\u7528\u7b49\u5f85\u7ed3\u679c,\u7ee7\u7eed\u505a\u4e0b\u9762\u7684\u64cd\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u9762\u7684step\u4e2d\u6765\u9a8c\u8bc1\u8fd9\u4e2a\u547d\u4ee4\u662f\u5426\u6210\u529f\u6267\u884c.\n      poll : 0\n\n[root@hostname ~]# ansible-playbook /etc/ansible/test.yml\n\nPLAY [test_server] *******************************************************************************************************************************\n\nTASK [Gathering Facts] ***************************************************************************************************************************\nok: [172.16.60.241]\n\nTASK [ansible-test] ******************************************************************************************************************************\nchanged: [172.16.60.241]\n\nPLAY RECAP ***************************************************************************************************************************************\n172.16.60.241              : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0  \n\n4\uff09\u5982\u679c\u8fd8\u60f3\u8981\u66f4\u65b9\u4fbf\u5730\u770b\u8f6e\u8be2\u7ed3\u679c\uff0cansible\u8fd8\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u6a21\u5757async_status\u3002\n[root@hostname ~]# cat /etc/ansible/test.yml             \n- hosts : test_server\n  tasks :\n    - name : ansible-test\n      shell : sleep 3\n      async : 8\n      poll : 2\n      register: kevin_result\n\n    - name: 'check ansible-test task polling results '\n      async_status: jid={{ kevin_result.ansible_job_id }}\n      register: job_result\n      until: job_result.finished\n      retries: 10\n\n[root@hostname ~]# ansible-playbook /etc/ansible/test.yml\n\nPLAY [test_server] *******************************************************************************************************************************\n\nTASK [Gathering Facts] ***************************************************************************************************************************\nok: [172.16.60.241]\n\nTASK [ansible-test] ******************************************************************************************************************************\nchanged: [172.16.60.241]\n\nTASK [check ansible-test task polling results] ***************************************************************************************************\nchanged: [172.16.60.241]\n\nPLAY RECAP ***************************************************************************************************************************************\n172.16.60.241              : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   \n\n\u7b2c\u4e00\u4e2ajob\u6267\u884c\u5f02\u6b65\u4efb\u52a1sleep\uff0c\u5e76\u4e14\u6ce8\u518c\u4e86\u4e00\u4e2a\u540d\u5b57\u53ebkevin-result\u7684register\u53d8\u91cf\uff0c\u7528\u4e8e\u63d0\u4f9b\u7ed9\u7b2c\u4e8c\u4e2ajob\u4f5c\u4e3a\u8f6e\u8be2\u5bf9\u8c61\uff0c\u5e76\u4e14\u5b83\u81ea\u5df1poll\u8bbe\u4e3a2 (\u5373\u81ea\u5df1\u8f6e\u8be22\u6b21)\u3002\nregister\u7528\u4e8e\u5728ansible\u7684playbook\u4e2dtask\u4e4b\u95f4\u7684\u76f8\u4e92\u4f20\u9012\u53d8\u91cf\uff0c\nregister \u8fd9\u4e2a\u529f\u80fd\u975e\u5e38\u6709\u7528\u3002\u5f53\u6211\u4eec\u9700\u8981\u5224\u65ad\u5bf9\u6267\u884c\u4e86\u67d0\u4e2a\u64cd\u4f5c\u6216\u8005\u67d0\u4e2a\u547d\u4ee4\u540e\uff0c\u5982\u4f55\u505a\u76f8\u5e94\u7684\u54cd\u5e94\u5904\u7406\uff08\u6267\u884c\u5176\u4ed6 ansible \u8bed\u53e5\uff09\uff0c\u5219\u4e00\u822c\u4f1a\u7528\u5230register \u3002\nuntil\u8868\u793a\u5faa\u73af\u3002\n\n\u7b2c\u4e8c\u4e2ajob\u4f7f\u7528async_status\u6a21\u5757\uff0c\u8fdb\u884c\u8f6e\u8be2\u5e76\u8fd4\u56de\u8f6e\u8be2\u7ed3\u679c\u3002\u51c6\u5907\u68c0\u67e510\u6b21\u3002\n</code></pre> <ul> <li><code>async</code>\u53c2\u6570\u503c\uff1a\u4ee3\u8868\u4e86\u8fd9\u4e2a\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u7684\u4e0a\u9650\u503c\u3002\u5373\u4efb\u52a1\u6267\u884c\u6240\u7528\u65f6\u95f4\u5982\u679c\u8d85\u51fa\u8fd9\u4e2a\u65f6\u95f4\uff0c\u5219\u8ba4\u4e3a\u4efb\u52a1\u5931\u8d25\u3002\u6b64\u53c2\u6570\u82e5\u672a\u8bbe\u7f6e\uff0c\u5219\u4e3a\u540c\u6b65\u6267\u884c\u3002</li> <li><code>poll</code>\u53c2\u6570\u503c\uff1a\u4ee3\u8868\u4e86\u4efb\u52a1\u5f02\u6b65\u6267\u884c\u65f6\u8f6e\u8be2\u7684\u65f6\u95f4\u95f4\u9694\u3002</li> </ul>"},{"location":"ansbile_async/#ansible-serialmax_fail_percentage","title":"\u4e8c\u3001Ansible\u7684\u5e76\u53d1\u9650\u5236  [serial\u3001max_fail_percentage]","text":"<p>\u5f53ansible\u6e05\u5355\u6587\u4ef6\u91cc\u8bbe\u7f6e\u7684\u7ec4\u91cc\u6709\u5f88\u591a\u673a\u5668\uff0c\u53ef\u4ee5\u9650\u5236\u4e00\u4e0bansible\u4efb\u52a1\u7684\u5e76\u53d1\u3002ansible\u7684\u5e76\u53d1\u529f\u80fd\u53ef\u4ee5\u5728ansible.cfg\u91cc\u4fee\u6539\u914d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u5728playbook\u4e2d\u9650\u5236\u670d\u52a1\u7aef\u7684\u5e76\u53d1\u6570\u91cf\uff0c\u8fd9\u662fansible\u7ecf\u5e38\u7528\u5230\u7684\u4e00\u4e2a\u5173\u952e\u529f\u80fd\u3002ansible\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ea\u4f1a\u521b\u5efa5\u4e2a\u8fdb\u7a0b\uff0c\u6240\u4ee5\u4e00\u6b21\u4efb\u52a1\u53ea\u80fd\u540c\u65f6\u63a7\u52365\u53f0\u673a\u5668\u6267\u884c\u3002\u5982\u679c\u6709\u5927\u91cf\u7684\u673a\u5668\u9700\u8981\u63a7\u5236\uff0c\u6216\u8005\u5e0c\u671b\u51cf\u5c11\u8fdb\u7a0b\u6570\uff0c\u90a3\u5c31\u53ef\u4ee5\u91c7\u53d6\u5f02\u6b65\u6267\u884c\uff08async\uff09\uff0cansible\u7684\u6a21\u5757\u53ef\u4ee5\u628atask\u653e\u8fdb\u540e\u53f0\uff0c\u7136\u540e\u8f6e\u8be2\u5b83\uff08poll\uff09\u3002</p> <p>\u4f7f\u7528async\u548cpoll\u8fd9\u4e24\u4e2a\u5173\u952e\u5b57\u4fbf\u53ef\u4ee5\u5e76\u884c\u8fd0\u884c\u4e00\u4e2a\u4efb\u52a1\uff0c\u5373\u5728\u6240\u6709\u673a\u5668\u4e0a\u4e00\u6b21\u6027\u8fd0\u884c\u3002async\u8fd9\u4e2a\u5173\u952e\u5b57\u4f1a\u89e6\u53d1ansible\u5e76\u884c\u8fd0\u4f5c\u4efb\u52a1\uff0casync\u7684\u503c\u662fansible\u7b49\u5f85\u8fd0\u884c\u8fd9\u4e2a\u4efb\u52a1\u7684\u6700\u5927\u8d85\u65f6\u503c(\u5982\u679c\u6267\u884c\u8d85\u65f6\u4efb\u52a1\u4f1a\u5f3a\u5236\u4e2d\u65ad\u5bfc\u81f4\u5931\u8d25)\uff0c\u800cpoll\u5c31\u662fansible\u68c0\u67e5\u8fd9\u4e2a\u4efb\u52a1\u662f\u5426\u5b8c\u6210\u7684\u9891\u7387\u65f6\u95f4\u3002</p> <pre><code>1) serial\u53c2\u6570\u8bbe\u7f6e\u5e76\u53d1\u6570\n=====================================================================\n\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c ansible\u4f1a\u540c\u65f6\u5728\u6240\u6709\u670d\u52a1\u5668\u4e0a\u6267\u884c\u7528\u6237\u5b9a\u4e49\u7684\u64cd\u4f5c\uff0c \u4f46\u662f\u7528\u6237\u53ef\u4ee5\u901a\u8fc7serial\u53c2\u6570\u6765\u5b9a\u4e49\u540c\u65f6\u53ef\u4ee5\u5728\u591a\u5c11\u592a\u673a\u5668\u4e0a\u6267\u884c\u64cd\u4f5c\u3002\n\n[root@hostname ~]# cat /etc/ansible/test.yml\n- hosts : test_server\n  serial: 3\n\n  tasks :\n    - name: Install telnet\n      yum: name=telnet state=installed\n\n\u5373test_server\u7ec4\u5185\u76843\u53f0\u673a\u5668\u5b8c\u5168\u6267\u884c\u5b8c\u6210play\u540e\uff0c \u5176\u4ed6\u673a\u5668\u624d\u80fd\u5f00\u59cb\u6267\u884c\u3002\n\n\u63a5\u7740\u770b\u4e0b\u9762\u7684\u914d\u7f6e\n[root@hostname ~]# cat /etc/ansible/test.yml\n- hosts : all\n  serial: 7\n\n  tasks :\n    - name: Install telnet\n      yum: name=telnet state=installed\n\n    - name : Run Serverstart.sh\n      command : /bin/bash /opt/scripts/Serverstart.sh\n      async : 300\n      poll : 10\n      register: kevin_result\n\n\u5982\u4e0a\u914d\u7f6e\uff0c\u53d1\u73b0\u5f53ansible\u914d\u7f6e\u63a7\u5236\u8d85\u8fc75\u53f0\u673a\u5668\u65f6\uff0c\u4e0a\u9762ansible\u4e2d\uff1a\na\uff09yum\u6a21\u5757\u4f1a\u5148\u57285\u53f0\u673a\u5668\u4e0a\u8dd1\uff0c\u5b8c\u6210\u540e\u518d\u7ee7\u7eed\u5269\u4f592\u53f0\u7684\u673a\u5668\uff1b\nb\uff09command\u6a21\u5757\u7684\u4efb\u52a1\u4f1a\u4e00\u6b21\u6027\u5728\u6240\u6709\u673a\u5668\u4e0a\u90fd\u6267\u884c\u4e86\uff0c\u7136\u540e\u76d1\u542c\u5b83\u7684\u56de\u8c03\u7ed3\u679c\uff1b\n\n\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u4e0b\u9762\u4e24\u79cd\u60c5\u51b5\na\uff09\u60c5\u51b5\u4e00\uff1a \u8bbe\u7f6epoll=0\n\u5982\u679c\u4e0a\u9762command\u6a21\u5757\u662f\u63a7\u5236\u673a\u5668\u5f00\u542f\u4e00\u4e2a\u8fdb\u7a0b\u653e\u5230\u540e\u53f0,\u90a3\u5c31\u4e0d\u9700\u8981\u68c0\u67e5\u8fd9\u4e2a\u4efb\u52a1\u662f\u5426\u5b8c\u6210\u4e86\uff0c\u53ea\u9700\u8981\u7ee7\u7eed\u5176\u4ed6\u7684\u52a8\u4f5c, \n\u6700\u540e\u518d\u4f7f\u7528wait_for\u8fd9\u4e2a\u6a21\u5757\u53bb\u68c0\u67e5\u4e4b\u524d\u7684\u8fdb\u7a0b\u662f\u5426\u6309\u9884\u671f\u4e2d\u5f00\u542f\u4e86\u4fbf\u53ef\u3002\n\u8fd9\u65f6\u53ea\u9700\u8981\u628apoll\u8fd9\u4e2a\u503c\u8bbe\u7f6e\u4e3a0, \u4fbf\u53ef\u4ee5\u6309\u4e0a\u9762\u7684\u8981\u6c42\u914d\u7f6eansible\u4e0d\u7b49\u5f85job\u7684\u5b8c\u6210\u3002\nb\uff09\u60c5\u51b5\u4e8c\uff1a \u8bbe\u7f6easync=0\n\u5982\u679c\u6709\u4e00\u79cd\u9700\u6c42\u662f\u6709\u4e00\u4e2atask\u5b83\u662f\u9700\u8981\u8fd0\u884c\u5f88\u957f\u7684\u65f6\u95f4,\u90a3\u5c31\u9700\u8981\u8bbe\u7f6e\u4e00\u76f4\u7b49\u5f85\u8fd9\u4e2ajob\u5b8c\u6210\u3002\n\u8fd9\u4e2a\u65f6\u5019\u53ea\u9700\u8981\u628aasync\u7684\u503c\u8bbe\u62100\u4fbf\u53ef\u3002\n\n\u7b80\u5355\u603b\u7ed3\u4e0b\uff0c\u9002\u5408\u4f7f\u7528\u5230ansible\u7684polling\u7279\u6027\u7684\u573a\u666f\n- \u6709\u4e00\u4e2atask\u9700\u8981\u8fd0\u884c\u5f88\u957f\u7684\u65f6\u95f4,\u8fd9\u4e2atask\u5f88\u53ef\u80fd\u4f1a\u8fbe\u5230timeout\uff1b\n- \u6709\u4e00\u4e2a\u4efb\u52a1\u9700\u8981\u5728\u5927\u91cf\u7684\u673a\u5668\u4e0a\u9762\u8fd0\u884c\uff1b\n- \u6709\u4e00\u4e2a\u4efb\u52a1\u662f\u4e0d\u9700\u8981\u7b49\u5f85\u5b83\u5b8c\u6210\u7684\uff1b\n\n\u4e0d\u9002\u5408\u4f7f\u7528polling\u7279\u6027\u7684\u573a\u666f\n- task\u4efb\u52a1\u662f\u9700\u8981\u8fd0\u884c\u5b8c\u540e\u624d\u80fd\u7ee7\u7eed\u53e6\u5916\u7684\u4efb\u52a1\u7684\uff1b\n- task\u4efb\u52a1\u80fd\u5f88\u5feb\u7684\u5b8c\u6210\uff1b\n\n2) max_fail_percentage\uff1a\u6700\u5927\u5931\u8d25\u767e\u5206\u6bd4\n=====================================================================\n\u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u53ea\u8981ansible\u7684group\u4e2d\u8fd8\u6709server\u6ca1\u6709\u5931\u8d25, ansible\u5c31\u662f\u7ee7\u7eed\u6267\u884ctasks\u3002\u5b9e\u9645\u4e0a, \u7528\u6237\u53ef\u4ee5\u901a\u8fc7max_fail_percentage\uff08\u6700\u5927\u5931\u8d25\u767e\u5206\u6bd4\uff09\u6765\u9650\u5236ansible\u7684\u5e76\u53d1\u6267\u884c\u3002\n\u53ea\u8981\u8d85\u8fc7max_fail_percentage\u7684server\u5931\u8d25, ansible\u5c31\u53ef\u4ee5\u4e2d\u6b62tasks\u7684\u6267\u884c\u3002serial\u53c2\u6570\u5728ansible-1.8\u4ee5\u540e\u5c31\u5f00\u59cb\u652f\u6301\u767e\u5206\u6bd4\u529f\u80fd\u4e86\uff01\uff01\n\n\u8bd5\u60f3\u4e00\u4e0b\u5982\u679cgroup\u7ec4\u91cc\u6709200\u53f0\u673a\u5668\uff0c\u90a3\u4e48\u5982\u679c\u4f7f\u7528serial\u6765\u9650\u5236\u5e76\u53d1\u6570\u91cf\uff0c\u6bd4\u5982\u8bbe\u7f6eserial=10\uff0c\u610f\u601d\u5c31\u662f\u4e00\u6b21\u53ea\u6267\u884c10\u53f0\uff0c\u4e00\u76f4\u5230200\u53f0\u5b8c\u6210\u3002\n\u53ea\u8981\u7ec4\u5185\u8fd8\u6709server\u6ca1\u6709\u5931\u8d25, ansible\u5c31\u662f\u7ee7\u7eed\u6267\u884ctasks\u3002\u8fd9\u6837\u5c31\u663e\u5f97\u6548\u7387\u5f88\u4f4e\u4e86\uff0c\u5f88\u4e0d\u65b9\u4fbf\uff01\u8fd9\u65f6\u5c31\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u63a7\u5236\u6d41\u7684max_fail_percentage\u529f\u80fd\u4e86\uff01\uff01\n\n[root@hostname ~]# cat /etc/ansible/test.yml\n- hosts : all\n  max_fail_percentage: 30\n  serial: 10\n\n  tasks :\n    - name: Install telnet\n      yum: name=telnet state=installed\n\n    - name : Run Serverstart.sh\n      command : /bin/bash /opt/scripts/Serverstart.sh\n      async : 300\n      poll : 10\n      register: kevin_result\n\n\u5982\u4e0a\u914d\u7f6e\uff0c\u537310\u53f0\u673a\u5668\u91cc\u670930%\u7684\u673a\u5668\u6267\u884cyum\u6a21\u5757\u7684task\u4efb\u52a1\u5931\u8d25\uff0c\u90a3\u4e48\u5c31\u7ec8\u6b62\u8fd9\u4e2a10\u53f0\u673a\u5668\u7684task\u4efb\u52a1\u7684\u6267\u884c\uff0c\u63a5\u7740\u6267\u884c\u4e0b\u4e00\u7ec410\u53f0\u673a\u5668\u7684task\u4efb\u52a1\uff0c\u8fd9\u6837\u6548\u679c\u5c31\u5f88\u68d2\u4e86\u3002\n\n\u6e29\u99a8\u63d0\u793a\uff1a\n\u5b9e\u9645\u5931\u8d25\u673a\u5668\u5fc5\u987b\u5927\u4e8e\u8fd9\u4e2a\u767e\u5206\u6bd4\u65f6, tasks\u4efb\u52a1\u624d\u4f1a\u88ab\u4e2d\u6b62\uff1b\u5982\u679c\u7b49\u4e8e\u8fd9\u4e2a\u767e\u5206\u6bd4\u65f6\uff0ctask\u4efb\u52a1\u662f\u4e0d\u4f1a\u88ab\u7ec8\u6b62\u7684\uff01\n</code></pre> <p>\u8e29\u5751\u7ecf\u9a8c\uff1aAnsible\u5e76\u53d1\u5931\u8d25\uff08fork=100. \u4f46\u662f\u771f\u6b63\u6267\u884cplaybook\u65f6\u5e76\u6ca1\u6709\u5b9e\u73b0\u5e76\u53d1\uff09</p> <pre><code>[root@hostname ~]# cd /usr/lib/python2.7/site-packages/ansible/\n[root@hostname ansible]# find . -name ssh.py\n./plugins/connection/ssh.py\n\n[root@hostname ansible]# vim plugins/connection/ssh.py\n.........\n.........\n   if C.HOST_KEY_CHECKING and not_in_host_file:\n        # lock around the initial SSH connectivity so the user prompt about whether to add\n        # the host to known hosts is not intermingled with multiprocess output.\n        fcntl.lockf(self.runner.process_lockfile, fcntl.LOCK_EX)\n        fcntl.lockf(self.runner.output_lockfile, fcntl.LOCK_EX)\n\n   # create process\n  (p, stdin) = self._run(ssh_cmd, in_data)\n.........\n.........\n\n\u901a\u8fc7\u4ee5\u4e0a\u6587\u4ef6\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff1a\n\u5982\u679cansible\u914d\u7f6e\"HOST_KEY_CHECKING=True\", \u5e76\u4e14ansible\u5ba2\u6237\u673a\u4fe1\u606f\u6ca1\u6709\u5728ansible\u670d\u52a1\u7aef\u7684~/.ssh/known_hosts\u91cc\u9762, \u4e00\u4e2a\u8fdb\u7a0b\u5c31\u4f1a\u9501\u6b7b~/.ssh/known_hosts\u6587\u4ef6\u3002\n\u8fd9\u6837ansible\u5c31\u4e0d\u80fd\u5b9e\u73b0\u5e76\u53d1\uff01\n\n\u89e3\u51b3\u65b9\u6848:\n\u5728ansible\u670d\u52a1\u7aef\u7684/etc/ansible/ansible.cfg\u6587\u4ef6\u91cc\u914d\u7f6e\"host_key_checking = False\"    [\u5176\u5b9eansible.cfg\u6587\u4ef6\u91cc\u8be5\u9879\u9ed8\u8ba4\u914d\u7f6e\u7684\u5c31\u662fFalse]\n</code></pre>"},{"location":"ansbile_async/#ansible-delegate_todelegate_factsrun_once","title":"\u4e09\u3001Ansible\u7684\u4efb\u52a1\u59d4\u6258  [delegate_to\u3001delegate_facts\u3001run_once]","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cansible\u7684\u6240\u6709\u4efb\u52a1\u90fd\u662f\u5728\u6307\u5b9a\u7684\u673a\u5668\u4e0a\u8fd0\u884c\u7684\u3002\u5f53\u5728\u4e00\u4e2a\u72ec\u7acb\u7684\u7fa4\u96c6\u73af\u5883\u4e2d\u914d\u7f6e\u65f6\uff0c\u53ea\u662f\u60f3\u64cd\u4f5c\u5176\u4e2d\u7684\u67d0\u4e00\u53f0\u4e3b\u673a\uff0c\u6216\u8005\u5728\u7279\u5b9a\u7684\u4e3b\u673a\u4e0a\u8fd0\u884ctask\u4efb\u52a1\uff0c\u6b64\u65f6\u5c31\u9700\u8981\u7528\u5230ansible\u7684\u4efb\u52a1\u59d4\u6258\u529f\u80fd\u3002\u4f7f\u7528delegate_to\u5173\u952e\u5b57\u53ef\u4ee5\u914d\u7f6etask\u4efb\u52a1\u5728\u6307\u5b9a\u7684\u673a\u5668\u4e0a\u6267\u884c\uff0c\u5c31\u662f\u8bf4\u5176\u4ed6\u7684task\u4efb\u52a1\u8fd8\u662f\u5728hosts\u5173\u952e\u5b57\u914d\u7f6e\u7684\u673a\u5668\u4e0a\u8fd0\u884c\uff0c\u5230\u4e86\u8fd9\u4e2a\u5173\u952e\u5b57\u6240\u5728\u7684\u4efb\u52a1\u65f6\uff0c\u5c31\u4f7f\u7528\u59d4\u6258\u7684\u673a\u5668\u8fd0\u884c\u3002</p> <pre><code>1\uff09\u59d4\u6258\n=====================================================================\n\u901a\u8fc7\"delegate_to\", ansible\u53ef\u4ee5\u628a\u67d0\u4e00\u4e2atask\u4efb\u52a1\u653e\u5728\u59d4\u6258\u7684\u673a\u5668\u4e0a\u6267\u884c\u3002\u5373\u5728\u6307\u5b9a\u7684\u7ec4\u5185\u7684\u67d0\u4e00\u53f0\u6216\u591a\u53f0\u673a\u5668\u4e0a\u6267\u884ctask\u4efb\u52a1\u3002\n\n[root@hostname ~]# cat /etc/ansible/test.yml\n- hosts : test_server\n  serial: 10\n\n  tasks :\n    - name: test-haha\n      shell: echo \"test\" &gt; /root/test.list\n      delegate_to: 172.16.60.245\n\n\u5219\u4e0a\u9762\u7684shell\u6a21\u5757\u7684task\u4efb\u52a1\u53ea\u4f1a\u5728172.16.60.245\u8fd9\u53f0\u8282\u70b9\u4e0a\u6267\u884c\uff0ctest_server\u7ec4\u5185\u5176\u4ed6\u7684\u673a\u5668\u4e0d\u4f1a\u6267\u884cshell\u4efb\u52a1\u3002\n\n---------------------\n\u5982\u679c \"delegate_to: 127.0.0.1\" \u5219\u53ef\u4ee5\u7528local_action\u6765\u4ee3\u66ff\u3002\u5373\u4e0b\u9762\u4e24\u4e2a\u914d\u7f6e\u6548\u679c\u662f\u4e00\u6837\u7684\uff01\uff01\n[root@hostname ~]# cat /etc/ansible/test.yml \n- hosts : test_server\n  serial: 10\n\n  tasks :\n    - name: test-haha\n      shell: echo \"test\" &gt; /root/test.list\n      delegate_to: 127.0.0.1\n\n[root@hostname ~]# cat /etc/ansible/test.yml\n- hosts : test_server\n  serial: 10\n\n  tasks :\n    - name: test-haha\n      local_action: shell echo \"test\" &gt; /root/test.list\n\n-------------------\n\u5982\u679c\u8bbe\u7f6e\u4e86\u591a\u4e2adelegate_to\uff0c\u5219\u6267\u884c\u65f6\u53ea\u4f1a\u5339\u914d\u6700\u4e0b\u9762\u90a3\u4e2a\u3002\n\u4f8b\u5982\u4e0b\u9762\u914d\u7f6e\u4e2d\uff0c\u53ea\u4f1a\u6267\u884c\"delegate_to: 172.16.60.245\", \u4e0a\u9762\u90a3\u4e2a\"delegate_to: 172.16.60.241\"\u5c31\u4f1a\u88ab\u5ffd\u7565\u4e86\u3002\n[root@hostname ansible]# cat /etc/ansible/test.yml\n- hosts : all\n  serial: 10\n\n  tasks :\n    - name: test-haha\n      shell: echo \"test\" &gt; /root/test.list\n      delegate_to: 172.16.60.241\n      delegate_to: 172.16.60.245\n\n-------------------\ndelegate_to\u9ed8\u8ba4\u540e\u9762\u53ea\u80fd\u8ddf\u4e00\u4e2a\u4e3b\u673aip\uff0c\u4e0d\u80fd\u8ddf\u591a\u4e2a\u4e3b\u673aip\u3002\u5373\u9ed8\u8ba4\u59d4\u6258\u5230\u5355\u4e2a\u4e3b\u673a\u3002\n\u5982\u679c\u6709\u591a\u4e2aip\u9700\u8981\u59d4\u6258\uff0c\u5219\u53ef\u4ee5\u5c06\u8fd9\u4e9bip\u91cd\u65b0\u653e\u4e00\u4e2agroup\uff0c\u7136\u540edelegate_to\u59d4\u6258\u7ed9group\u7ec4\u3002\ndelegate_to\u59d4\u6258\u5230\u7ec4\u7684\u65b9\u5f0f\uff1a\u901a\u8fc7items\u53d8\u91cf\u65b9\u5f0f\uff01\uff01\uff01\n\n[root@hostname ansible]# cat /etc/ansible/hosts |tail -8\n[test_server]\n172.16.60.241\n172.16.60.245\n172.16.60.246\n127.0.0.1\n\n[kevin_server]\n172.16.60.246\n127.0.0.1\n\n[root@hostname ansible]# cat /etc/ansible/test.yml \n- hosts: all\n  tasks:\n    - name: test-haha\n      shell: echo \"test\" &gt; /root/test.list\n      delegate_to: \"{{item}}\"\n      with_items: \"{{groups['kevin_server']}}\"\n\n\u5373\u5c06shell\u8fd9\u4e2atask\u4efb\u52a1\u59d4\u6258\u7ed9kevin_server\u7ec4\u5185\u7684\u673a\u5668\u6267\u884c\u3002\n\n\n2\uff09\u59d4\u6258\u8005\u7684facts\n=====================================================================\n\u9ed8\u8ba4\u60c5\u51b5\u4e0b, ansible\u59d4\u6258\u4efb\u52a1\u7684facts\u662finventory_hostname\u4e2d\u4e3b\u673a\u7684facts, \u800c\u4e0d\u662f\u88ab\u59d4\u6258\u673a\u5668\u7684facts\u3002\n\na) delegate_facts\n\u5728ansible 2.0 \u4e2d, \u901a\u8fc7\u8bbe\u7f6e\"delegate_facts: True\"\u53ef\u4ee5\u8ba9task\u4efb\u52a1\u53bb\u6536\u96c6\u88ab\u59d4\u6258\u673a\u5668\u7684facts\u3002\n[root@hostname ~]# cat /etc/ansible/test.yml\n- hosts: test_server\n  tasks:\n    - name: test-haha\n      shell: echo \"test\" &gt; /root/test.list\n      delegate_to: \"{{item}}\"\n      delegate_facts: True\n      with_items: \"{{groups['kevin_server']}}\"\n\n\u5982\u4e0a\u914d\u7f6e\uff0c\u8868\u793a\u4f1a\u6536\u96c6kevin_server\u7684facts\u5e76\u5206\u914d\u7ed9\u8fd9\u4e9b\u673a\u5668, \u800c\u4e0d\u4f1a\u53bb\u6536\u96c6test_server\u7684facts\n\nb\uff09RUN ONCE\n\u901a\u8fc7\u8bbe\u7f6e\"run_once: true\"\u6765\u6307\u5b9a\u8be5task\u53ea\u80fd\u5728\u59d4\u6258\u7684\u67d0\u4e00\u53f0\u673a\u5668\u6216\u59d4\u6258\u7684\u7ec4\u5185\u673a\u5668\u4e0a\u6267\u884c\u4e00\u6b21\uff01\uff01\u53ef\u4ee5\u548cdelegate_to \u7ed3\u5408\u4f7f\u7528\u3002\n\u5982\u679c\u6ca1\u6709delegate_to, \u90a3\u4e48\u8fd9\u4e2atask\u9ed8\u8ba4\u5c31\u4f1a\u5728\u7b2c\u4e00\u53f0\u673a\u5668\u4e0a\u6267\u884c\uff01\uff01\uff01\n[root@hostname ~]# cat /etc/ansible/test.yml\n- hosts: test_server\n  tasks:\n    - name: test-haha\n      shell: echo \"test\" &gt; /root/test.list\n      delegate_to: \"{{item}}\"\n      run_once: true\n      delegate_facts: True\n      with_items: \"{{groups['kevin_server']}}\"\n</code></pre>"},{"location":"awk/","title":"\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK","text":""},{"location":"awk/#awk","title":"\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK","text":"<ul> <li>\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK</li> <li>\u539f\u6587GITHUB</li> <li>mylxsw\u7684 GITHUB</li> <li>\u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212</li> </ul> <p><code>\u6a21\u5f0f</code>\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a<code>\u6761\u4ef6</code></p> <pre><code>awk [option] 'pattern[action]' file...\nawk [option] '\u6a21\u5f0f {\u52a8\u4f5c}' \u6587\u4ef6\n</code></pre> <ul> <li>BEGIN\u6a21\u5f0f\u662f\u5904\u7406\u6587\u672c\u4e4b\u524d\u9700\u8981\u6267\u884c\u7684\u64cd\u4f5c</li> <li>END\u6a21\u5f0f\u662f\u5904\u7406\u5b8c\u6240\u6709\u884c\u4e4b\u540e\u6267\u884c\u7684\u64cd\u4f5c</li> </ul>"},{"location":"awk/#awk_1","title":"awk\u53c2\u6570","text":"\u53c2\u6570 \u89e3\u91ca -F \u6307\u5b9a\u5206\u5272\u5b57\u6bb5 -v \u5b9a\u4e49\u6216\u4fee\u6539awk\u5185\u90e8\u7684\u53d8\u91cf -f \u4ece\u811a\u672c\u6587\u4ef6\u4e2d\u8bfb\u53d6awk\u547d\u4ee4 <p>\u5bf9\u4e8eawk\u800c\u8a00,\u53d8\u91cf\u5206\u4e3a</p> <ul> <li>\u5185\u7f6e\u53d8\u91cf</li> <li>\u81ea\u5b9a\u4e49\u53d8\u91cf</li> </ul> \u5185\u7f6e\u53d8\u91cf \u89e3\u91ca FS FS: field separator, \u8f93\u5165\u5b57\u6bb5\u5206\u9694\u7b26,\u9ed8\u8ba4\u4e3a\u7a7a\u767d\u5b57\u7b26 OFS OFS:OFS is an output equivalent of awk FS variable,\u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26,\u9ed8\u8ba4\u4e3a\u7a7a\u767d\u5b57\u7b26 RS RS: record separator, \u8f93\u5165\u8bb0\u5f55\u5206\u9694\u7b26(\u8f93\u5165\u6362\u884c\u7b26),\u6307\u5b9a\u8f93\u5165\u65f6\u7684\u6362\u884c\u7b26 ORS ORS:ORS is an Output equivalent of RS\u8f93\u51fa\u8bb0\u5f55\u5206\u9694\u7b26(\u8f93\u51fa\u6362\u884c\u7b26),\u8f93\u51fa\u65f6\u7528\u6307\u5b9a\u7b26\u53f7\u4ee3\u66ff\u6362\u884c\u7b26 NF NF: number of Field, \u5f53\u524d\u884c\u7684\u5b57\u6bb5\u7684\u4e2a\u6570(\u5373\u5f53\u524d\u884c\u88ab\u5206\u5272\u4e86\u51e0\u5217),\u5b57\u6bb5\u6570\u91cf NR NR: number of records(\u884c\u53f7), \u5f53\u524d\u5904\u7406\u7684\u6587\u672c\u884c\u7684\u884c\u53f7. FNR FNR: Number of Records relative to the current input file\u5404\u6587\u4ef6\u5206\u522b\u8ba1\u6570\u7684\u884c\u53f7 FILENAME FILENAME: \u5f53\u524d\u6587\u4ef6\u540d ARGC ARGC: \u547d\u4ee4\u884c\u53c2\u6570\u7684\u4e2a\u6570 ARGV ARGV:\u6570\u7ec4,\u4fdd\u5b58\u7684\u662f\u547d\u4ee4\u884c\u6240\u7ed9\u5b9a\u7684\u5404\u53c2\u6570"},{"location":"awk/#_1","title":"\u5185\u7f6e\u53d8\u91cf","text":""},{"location":"awk/#nrnffnr","title":"NR,NF,FNR","text":"<ul> <li>awk\u7684\u5185\u7f6e\u53d8\u91cfNR,NF\u662f\u4e0d\u8981\u6dfb\u52a0$\u7b26\u53f7\u7684</li> <li>\u800c<code>$0 $1 $2...</code>\u662f\u9700\u8981\u6dfb\u52a0$\u7b26\u53f7\u7684</li> </ul>"},{"location":"awk/#_2","title":"\u6a21\u5f0f","text":"\u5173\u7cfb\u8fd0\u7b97\u7b26 \u89e3\u91ca \u793a\u4f8b &lt; \u5c0f\u4e8e x&lt;y &lt;= \u5c0f\u4e8e\u7b49\u4e8e x&lt;=y == \u7b49\u4e8e x==y != \u4e0d\u7b49\u4e8e x!=y &gt;= \u5927\u4e8e\u7b49\u4e8e x&gt;=y &gt; \u5927\u4e8e x&gt;y ~ \u5339\u914d\u6b63\u5219 x~/\u6b63\u5219/ !~ \u4e0d\u5339\u914d\u6b63\u5219 x!~/\u6b63\u5219/ <pre><code>$ awk -F \":\" 'BEGIN{print \"===\"} NR==3,NR==5 {printf \"%s %s\\n\", NR,$1} END{print \"@@@\"}' xxx_list\n===\n3 1-1\n4 1-8\n5 1000th\n@@@\n$ \n\n\n$ awk -v FS=\".\" 'BEGIN{print \"###\"} {print NR,NF,$1,$2,$3 }' xxx_list | head\n###\n1 5 xxx:mysql db xxx\n2 5 ttt:maria db ttt\n\n\n\n$ awk -v FS=\".\" 'BEGIN{print \"###\"} {print ARGV[1], NR,NF,$1,$2,$3 }' xxx_list | head\n###\nxxx_list 1 5 xxx:mysql db xxx\nxxx_list 2 5 ttt:maria db ttt\n\n</code></pre>"},{"location":"awk/#_3","title":"\u81ea\u5b9a\u4e49\u53d8\u91cf","text":"<ul> <li>\u65b9\u6cd5\u4e00: <code>-v varName=value</code></li> <li>\u65b9\u6cd5\u4e8c: \u5728\u7a0b\u5e8f\u4e2d\u76f4\u63a5\u5b9a\u4e49</li> </ul>"},{"location":"awk/#awk_2","title":"awk\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f","text":""},{"location":"awk/#_4","title":"\u6b63\u5219\u8868\u8fbe\u5f0f","text":"<pre><code>awk '/\u6b63\u5219\u8868\u8fbe\u5f0f/ {\u52a8\u4f5c}' file\n</code></pre>"},{"location":"awk/#_5","title":"\u884c\u8bbf\u95ee\u6a21\u5f0f","text":"<pre><code>awk '/\u6b63\u52191/,/\u6b63\u52192/ {\u52a8\u4f5c}' file\n</code></pre> <pre><code>$ awk -F \":\" '/^5may/ {print $1,$NF}' osn_mysql40_acc_list\n5may mysql31.db.sakura.ne.jp\n\nwww2323# cat /home/.logs/users/xxx/access_log.20230502 | awk '$1 ~ \"xxx.sa|xxx.org|xxx.xxx.ne.jp\" {print $3}' | uniq -n\n\n</code></pre>"},{"location":"awk/#awk_3","title":"awk\u547d\u4ee4\u6267\u884c\u6d41\u7a0b","text":"<p>\u89e3\u8bfb\u9700\u6c42: \u4ece\u6587\u4ef6\u4e2d\u5bfb\u627e\u60f3\u8981\u7684\u4fe1\u606f,\u6309\u7167\u4ee5\u4e0b\u987a\u5e8f\u6267\u884c</p> <pre><code>awk 'BEGIN {commands} pattern{commands} END{commands}' file...\n</code></pre> <ol> <li>\u4f18\u5148\u6267\u884c<code>BEGIN{}</code>\u6a21\u5f0f\u4e2d\u7684\u8bed\u53e5</li> <li>\u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7b2c\u4e00\u884c,\u7136\u540e\u6267\u884c<code>pattern{commads}</code>,\u8fdb\u884c\u6b63\u5219\u5339\u914d<code>/^n/</code>\u5bfb\u627en\u5f00\u5934\u7684\u884c,\u627e\u5230\u4e4b\u540e\u6267\u884c<code>{print}</code>\u8fdb\u884c\u6253\u5370</li> <li>\u5f53awk\u8bfb\u53d6\u6587\u4ef6\u6570\u636e\u6d41\u7684\u7ed3\u5c3e\u65f6, \u4f1a\u6267\u884c<code>END{commads}</code></li> </ol>"},{"location":"awk/#_6","title":"\u6982\u8ff0","text":"<p>AWK\u662f\u4e00\u95e8\u89e3\u91ca\u578b\u7684\u7f16\u7a0b\u8bed\u8a00\u3002\u5728\u6587\u672c\u5904\u7406\u9886\u57df\u5b83\u662f\u975e\u5e38\u5f3a\u5927\u7684\uff0c\u5b83\u7684\u540d\u5b57\u6765\u6e90\u4e8e\u5b83\u7684\u4e09\u4f4d\u4f5c\u8005\u7684\u59d3\u6c0f\uff1aAlfred Aho\uff0c Peter Weinberger \u548c Brian Kernighan\u3002</p> <p>GNU/Linux\u53d1\u5e03\u7684AWK\u76ee\u524d\u7531\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a\uff08FSF\uff09\u8fdb\u884c\u5f00\u53d1\u548c\u7ef4\u62a4\uff0c\u901a\u5e38\u4e5f\u79f0\u5b83\u4e3a GNU AWK\u3002</p>"},{"location":"awk/#awk_4","title":"AWK\u7684\u7c7b\u578b","text":"<p>\u4e0b\u9762\u662f\u51e0\u4e2aAWK\u7684\u53d8\u4f53\uff1a</p> <ul> <li>AWK - \u539f\u5148\u6765\u6e90\u4e8e AT &amp; T \u5b9e\u9a8c\u5ba4\u7684\u7684AWK</li> <li>NAWK - AT &amp; T \u5b9e\u9a8c\u5ba4\u7684AWK\u7684\u5347\u7ea7\u7248</li> <li>GAWK - \u8fd9\u5c31\u662fGNU AWK\u3002\u6240\u6709\u7684GNU/Linux\u53d1\u5e03\u7248\u90fd\u81ea\u5e26GAWK\uff0c\u5b83\u4e0eAWK\u548cNAWK\u5b8c\u5168\u517c\u5bb9</li> </ul>"},{"location":"awk/#awk_5","title":"AWK\u7684\u5178\u578b\u7528\u9014","text":"<p>\u4f7f\u7528AWK\u53ef\u4ee5\u505a\u5f88\u591a\u4efb\u52a1\uff0c\u4e0b\u9762\u662f\u5176\u4e2d\u4e00\u4e9b</p> <ul> <li>\u6587\u672c\u5904\u7406</li> <li>\u8f93\u51fa\u683c\u5f0f\u5316\u7684\u6587\u672c\u62a5\u8868</li> <li>\u6267\u884c\u7b97\u6570\u8fd0\u7b97</li> <li>\u6267\u884c\u5b57\u7b26\u4e32\u64cd\u4f5c\u7b49\u7b49</li> </ul>"},{"location":"awk/#_7","title":"\u5de5\u4f5c\u6d41","text":"<p>\u8981\u6210\u4e3aAWK\u7f16\u7a0b\u4e13\u5bb6\uff0c\u4f60\u9700\u8981\u5148\u77e5\u9053\u5b83\u7684\u5185\u90e8\u5b9e\u73b0\u673a\u5236\uff0cAWK\u9075\u5faa\u4e86\u975e\u5e38\u7b80\u5355\u7684\u5de5\u4f5c\u6d41 - \u8bfb\u53d6\uff0c\u6267\u884c\u548c\u91cd\u590d\uff0c\u4e0b\u56fe\u63cf\u8ff0\u4e86AWK\u7684\u5de5\u4f5c\u6d41\u3002</p> <p></p> <p>Read</p> <p>AWK\u4ece\u8f93\u5165\u6d41\uff08\u6587\u4ef6\uff0c\u7ba1\u9053\u6216\u8005\u6807\u51c6\u8f93\u5165\uff09\u4e2d\u8bfb\u53d6\u4e00\u884c\uff0c\u7136\u540e\u5b58\u50a8\u5230\u5185\u5b58\u4e2d\u3002</p> <p>Execute</p> <p>\u6240\u6709\u7684AWK\u547d\u4ee4\u90fd\u4f9d\u6b21\u5728\u8f93\u5165\u4e0a\u6267\u884c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cAWK\u4f1a\u5bf9\u6bcf\u4e00\u884c\u6267\u884c\u547d\u4ee4\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u6a21\u5f0f\u9650\u5236\u8fd9\u79cd\u884c\u4e3a\u3002</p> <p>Repeat</p> <p>\u5904\u7406\u8fc7\u7a0b\u4e0d\u65ad\u91cd\u590d\uff0c\u76f4\u5230\u5230\u8fbe\u6587\u4ef6\u7ed3\u5c3e\u3002</p>"},{"location":"awk/#_8","title":"\u7a0b\u5e8f\u7ed3\u6784","text":"<p>\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u5148\u5b66\u4e60\u4e00\u4e0bAWK\u7684\u7a0b\u5e8f\u7ed3\u6784\u3002</p>"},{"location":"awk/#begin","title":"BEGIN \u8bed\u53e5\u5757","text":"<p>BEGIN\u8bed\u53e5\u5757\u7684\u8bed\u6cd5</p> <pre><code>BEGIN {awk-commands}\n</code></pre> <p>BEGIN\u8bed\u53e5\u5757\u5728\u7a0b\u5e8f\u5f00\u59cb\u7684\u4f7f\u7528\u6267\u884c\uff0c\u5b83\u53ea\u6267\u884c\u4e00\u6b21\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u521d\u59cb\u5316\u53d8\u91cf\u3002BEGIN\u662fAWK\u7684\u5173\u952e\u5b57\uff0c\u56e0\u6b64\u5b83\u5fc5\u987b\u4e3a\u5927\u5199\uff0c\u6ce8\u610f\uff0c\u8fd9\u4e2a\u8bed\u53e5\u5757\u662f\u53ef\u9009\u7684\u3002</p>"},{"location":"awk/#body","title":"BODY \u8bed\u53e5\u5757","text":"<p>BODY\u8bed\u53e5\u5757\u7684\u8bed\u6cd5</p> <pre><code>/pattern/ {awk-commands}\n</code></pre> <p>BODY\u8bed\u53e5\u5757\u4e2d\u7684\u547d\u4ee4\u4f1a\u5bf9\u8f93\u5165\u7684\u6bcf\u4e00\u884c\u6267\u884c\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u6a21\u5f0f\u6765\u63a7\u5236\u8fd9\u79cd\u884c\u4e3a\u3002\u6ce8\u610f\uff0cBODY\u8bed\u53e5\u5757\u6ca1\u6709\u5173\u952e\u5b57\u3002</p>"},{"location":"awk/#end","title":"END \u8bed\u53e5\u5757","text":"<p>END\u8bed\u53e5\u5757\u7684\u8bed\u6cd5</p> <pre><code>END {awk-commands}\n</code></pre> <p>END\u8bed\u53e5\u5757\u5728\u7a0b\u5e8f\u7684\u6700\u540e\u6267\u884c\uff0cEND\u662fAWK\u7684\u5173\u952e\u5b57\uff0c\u56e0\u6b64\u5fc5\u987b\u4e3a\u5927\u5199\uff0c\u5b83\u4e5f\u662f\u53ef\u9009\u7684\u3002</p> <p>\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5e8f\u53f7\uff0c\u5b66\u751f\u59d3\u540d\uff0c\u79d1\u76ee\u540d\u79f0\u548c\u5f97\u5206\u7684\u6587\u4ef6 marks.txt\u3002</p> <pre><code>1)  Amit    Physics  80\n2)  Rahul   Maths    90\n3)  Shyam   Biology  87\n4)  Kedar   English  85\n5)  Hari    History  89\n</code></pre> <p>\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\u6211\u4eec\u5c06\u4f1a\u663e\u793a\u6587\u4ef6\u5185\u5bb9\uff0c\u5e76\u4e14\u6dfb\u52a0\u6bcf\u4e00\u5217\u7684\u6807\u9898</p> <pre><code>$ awk 'BEGIN{printf \"Sr No\\tName\\tSub\\tMarks\\n\"} {print}' marks.txt\n</code></pre> <p>\u4e0a\u8ff0\u4ee3\u7801\u6267\u884c\u540e\uff0c\u8f93\u51fa\u4ee5\u4e0b\u5185\u5bb9</p> <pre><code>Sr No     Name     Sub          Marks\n 1)       Amit     Physics      80\n 2)       Rahul    Maths        90\n 3)       Shyam    Biology      87\n 4)       Kedar    English      85\n 5)       Hari     History      89\n</code></pre> <p>\u5728\u7a0b\u5e8f\u7684\u5f00\u59cb\uff0cAWK\u5728BEGIN\u8bed\u53e5\u4e2d\u6253\u5370\u51fa\u6807\u9898\u3002\u7136\u540e\u518dBODY\u8bed\u53e5\u4e2d\uff0c\u5b83\u4f1a\u8bfb\u53d6\u6587\u4ef6\u7684\u6bcf\u4e00\u884c\u7136\u540e\u6267\u884cAWK\u7684print\u547d\u4ee4\u5c06\u6bcf\u4e00\u884c\u7684\u5185\u5bb9\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u4f1a\u4e00\u76f4\u91cd\u590d\u76f4\u5230\u6587\u4ef6\u7684\u7ed3\u5c3e\u3002</p>"},{"location":"awk/#_9","title":"\u57fa\u7840\u8bed\u6cd5","text":"<p>AWK\u7684\u4f7f\u7528\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884cAWK\u7684\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u4ece\u5305\u542bAWK\u547d\u4ee4\u7684\u6587\u672c\u6587\u4ef6\u4e2d\u6267\u884c\u3002</p>"},{"location":"awk/#awk_6","title":"AWK\u547d\u4ee4\u884c","text":"<p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5355\u5f15\u53f7\u5728\u547d\u4ee4\u884c\u4e2d\u6307\u5b9aAWK\u547d\u4ee4</p> <pre><code>awk [options] file ...\n</code></pre> <p>\u6bd4\u5982\u6211\u4eec\u6709\u4e00\u4e2a\u5305\u542b\u4e0b\u9762\u5185\u5bb9\u7684\u6587\u672c\u6587\u4ef6 marks.txt:</p> <pre><code>1) Amit     Physics    80\n2) Rahul    Maths      90\n3) Shyam    Biology    87\n4) Kedar    English    85\n5) Hari     History    89\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u663e\u793a\u8be5\u6587\u4ef6\u7684\u5b8c\u6574\u5185\u5bb9</p> <pre><code>$ awk '{print}' marks.txt\n</code></pre>"},{"location":"awk/#awk_7","title":"AWK\u7a0b\u5e8f\u6587\u4ef6","text":"<p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u811a\u672c\u6587\u4ef6\u63d0\u4f9bAWK\u547d\u4ee4</p> <pre><code>awk [options] -f file ....\n</code></pre> <p>\u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u4e0b\u9762\u5185\u5bb9\u7684\u6587\u672c\u6587\u4ef6 command.awk</p> <pre><code>{print}\n</code></pre> <p>\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9AWK\u6267\u884c\u8be5\u6587\u4ef6\u4e2d\u7684\u547d\u4ee4\uff0c\u8fd9\u91cc\u6211\u4eec\u5b9e\u73b0\u4e86\u548c\u4e0a\u4f8b\u540c\u6837\u7684\u7ed3\u679c</p> <pre><code>$ awk -f command.awk marks.txt\n</code></pre>"},{"location":"awk/#awk_8","title":"AWK\u6807\u51c6\u9009\u9879","text":"<p>AWK\u652f\u6301\u4e0b\u5217\u547d\u4ee4\u884c\u6807\u51c6\u9009\u9879</p>"},{"location":"awk/#-v","title":"<code>-v</code> \u53d8\u91cf\u8d4b\u503c\u9009\u9879","text":"<p>\u8be5\u9009\u9879\u5c06\u4e00\u4e2a\u503c\u8d4b\u4e88\u4e00\u4e2a\u53d8\u91cf\uff0c\u5b83\u4f1a\u5728\u7a0b\u5e8f\u5f00\u59cb\u4e4b\u524d\u8fdb\u884c\u8d4b\u503c\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u63cf\u8ff0\u4e86\u8be5\u9009\u9879\u7684\u4f7f\u7528</p> <pre><code>$ awk -v name=Jerry 'BEGIN{printf \"Name = %s\\n\", name}'\nName = Jerry\n</code></pre>"},{"location":"awk/#-dump-variablesfile","title":"<code>--dump-variables[=file]</code> \u9009\u9879","text":"<p>\u8be5\u9009\u9879\u4f1a\u8f93\u51fa\u6392\u597d\u5e8f\u7684\u5168\u5c40\u53d8\u91cf\u5217\u8868\u548c\u5b83\u4eec\u6700\u7ec8\u7684\u503c\u5230\u6587\u4ef6\u4e2d\uff0c\u9ed8\u8ba4\u7684\u6587\u4ef6\u662f awkvars.out\u3002</p> <pre><code>$ awk --dump-variables ''\n$ cat awkvars.out \nARGC: 1\nARGIND: 0\nARGV: array, 1 elements\nBINMODE: 0\nCONVFMT: \"%.6g\"\nERRNO: \"\"\nFIELDWIDTHS: \"\"\nFILENAME: \"\"\nFNR: 0\nFPAT: \"[^[:space:]]+\"\nFS: \" \"\nIGNORECASE: 0\nLINT: 0\nNF: 0\nNR: 0\nOFMT: \"%.6g\"\nOFS: \" \"\nORS: \"\\n\"\nRLENGTH: 0\nRS: \"\\n\"\nRSTART: 0\nRT: \"\"\nSUBSEP: \"\\034\"\nTEXTDOMAIN: \"messages\"\n</code></pre>"},{"location":"awk/#-help","title":"<code>--help</code> \u9009\u9879","text":"<p>\u6253\u5370\u5e2e\u52a9\u4fe1\u606f\u3002</p> <pre><code>$ awk --help\nUsage: awk [POSIX or GNU style options] -f progfile [--] file ...\nUsage: awk [POSIX or GNU style options] [--] 'program' file ...\nPOSIX options : GNU long options: (standard)\n   -f progfile                --file=progfile\n   -F fs                      --field-separator=fs\n   -v var=val                 --assign=var=val\nShort options : GNU long options: (extensions)\n   -b                         --characters-as-bytes\n   -c                         --traditional\n   -C                         --copyright\n   -d[file]                   --dump-variables[=file]\n   -e 'program-text'          --source='program-text'\n   -E file                    --exec=file\n   -g                         --gen-pot\n   -h                         --help\n   -L [fatal]                 --lint[=fatal]\n   -n                         --non-decimal-data\n   -N                         --use-lc-numeric\n   -O                         --optimize\n   -p[file]                   --profile[=file]\n   -P                         --posix\n   -r                         --re-interval\n   -S                         --sandbox\n   -t                         --lint-old\n   -V                         --version\n</code></pre>"},{"location":"awk/#-lintfatal","title":"<code>--lint[=fatal]</code> \u9009\u9879","text":"<p>\u8be5\u9009\u9879\u5141\u8bb8\u68c0\u67e5\u7a0b\u5e8f\u7684\u4e0d\u517c\u5bb9\u6027\u6216\u8005\u6a21\u68f1\u4e24\u53ef\u7684\u4ee3\u7801\uff0c\u5f53\u63d0\u4f9b\u53c2\u6570 fatal\u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u5bf9\u5f85Warning\u6d88\u606f\u4f5c\u4e3aError\u3002</p> <pre><code>$ awk --lint '' /bin/ls\nawk: cmd. line:1: warning: empty program text on command line\nawk: cmd. line:1: warning: source file does not end in newline\nawk: warning: no program text at all!\n</code></pre>"},{"location":"awk/#-posix","title":"<code>--posix</code> \u9009\u9879","text":"<p>\u8be5\u9009\u9879\u5f00\u542f\u4e25\u683c\u7684POSIX\u517c\u5bb9\u3002</p>"},{"location":"awk/#-profilefile","title":"<code>--profile[=file]</code>\u9009\u9879","text":"<p>\u8be5\u9009\u9879\u4f1a\u8f93\u51fa\u4e00\u4efd\u683c\u5f0f\u5316\u4e4b\u540e\u7684\u7a0b\u5e8f\u5230\u6587\u4ef6\u4e2d\uff0c\u9ed8\u8ba4\u6587\u4ef6\u662f awkprof.out\u3002</p> <pre><code>$ awk --profile 'BEGIN{printf\"---|Header|--\\n\"} {print} \nEND{printf\"---|Footer|---\\n\"}' marks.txt &gt; /dev/null \n$ cat awkprof.out\n    # gawk \u914d\u7f6e, \u521b\u5efa Wed Oct 26 15:05:49 2016\n\n    # BEGIN \u5757\n\n    BEGIN {\n        printf \"---|Header|--\\n\"\n    }\n\n    # \u89c4\u5219\n\n    {\n        print $0\n    }\n\n    # END \u5757\n\n    END {\n        printf \"---|Footer|---\\n\"\n    }\n</code></pre>"},{"location":"awk/#-traditional","title":"<code>--traditional</code> \u9009\u9879","text":"<p>\u8be5\u9009\u9879\u4f1a\u7981\u6b62\u6240\u6709\u7684gawk\u89c4\u8303\u7684\u6269\u5c55\u3002</p>"},{"location":"awk/#-version","title":"<code>--version</code> \u9009\u9879","text":"<p>\u8f93\u51fa\u7248\u672c\u53f7</p> <pre><code>$ awk --version\nGNU Awk 3.1.7\n\u7248\u6743\u6240\u6709 \u00a9 1989, 1991-2009 \u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a(FSF)\u3002\n\n\u8be5\u7a0b\u5e8f\u4e3a\u81ea\u7531\u8f6f\u4ef6\uff0c\u4f60\u53ef\u4ee5\u5728\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u53d1\u5e03\u7684 GNU \u901a\u7528\u516c\u5171\u8bb8\u53ef\u8bc1(GPL)\u7b2c\n3\u7248\u6216\u4ee5\u540e\u7248\u672c\u4e0b\u4fee\u6539\u6216\u91cd\u65b0\u53d1\u5e03\u3002\n\n\u8be5\u7a0b\u5e8f\u4e4b\u6240\u4ee5\u88ab\u53d1\u5e03\u662f\u56e0\u4e3a\u5e0c\u671b\u4ed6\u80fd\u5bf9\u4f60\u6709\u6240\u7528\u5904\uff0c\u4f46\u6211\u4eec\u4e0d\u4f5c\u4efb\u4f55\u62c5\u4fdd\u3002\u8fd9\u5305\u542b\n\u4f46\u4e0d\u9650\u4e8e\u4efb\u4f55\u5546\u4e1a\u9002\u552e\u6027\u4ee5\u53ca\u9488\u5bf9\u7279\u5b9a\u76ee\u7684\u7684\u9002\u7528\u6027\u7684\u62c5\u4fdd\u3002\u8be6\u60c5\u53c2\u89c1 GNU \u901a\u7528\u516c\n\u5171\u8bb8\u53ef\u8bc1(GPL)\u3002\n\n\u4f60\u5e94\u8be5\u6536\u5230\u7a0b\u5e8f\u9644\u5e26\u7684\u4e00\u4efd GNU \u901a\u7528\u516c\u5171\u8bb8\u53ef\u8bc1(GPL)\u3002\u5982\u679c\u6ca1\u6709\u6536\u5230\uff0c\u8bf7\u53c2\u770b http://www.gnu.org/licenses/ \u3002\nYou have new mail in /var/spool/mail/root\n</code></pre>"},{"location":"awk/#_10","title":"\u57fa\u672c\u4f7f\u7528\u793a\u4f8b","text":"<p>\u672c\u90e8\u5206\u4f1a\u8bb2\u8ff0\u4e00\u4e9b\u6709\u7528\u7684AWK\u547d\u4ee4\u548c\u5b83\u4eec\u7684\u4f7f\u7528\u793a\u4f8b\uff0c\u6240\u6709\u7684\u4f8b\u5b50\u90fd\u662f\u4ee5\u4e0b\u9762\u7684\u6587\u672c\u6587\u4ef6 marks.txt \u4e3a\u57fa\u7840\u7684</p> <pre><code>1) Amit Physics     80\n2) Rahul    Maths       90\n3) Shyam    Biology     87\n4) Kedar    English     85\n5) Hari History     89\n</code></pre>"},{"location":"awk/#_11","title":"\u6253\u5370\u67d0\u5217\u6216\u8005\u5b57\u6bb5","text":"<p>AWK\u53ef\u4ee5\u53ea\u6253\u5370\u8f93\u5165\u5b57\u6bb5\u4e2d\u7684\u67d0\u4e9b\u5217\u3002</p> <pre><code>$ awk '{print $3 \"\\t\" $4}' marks.txt\nPhysics 80\nMaths   90\nBiology 87\nEnglish 85\nHistory 89\n</code></pre> <p>\u5728\u6587\u4ef6marks.txt\u4e2d\uff0c\u7b2c\u4e09\u5217\u5305\u542b\u4e86\u79d1\u76ee\u540d\uff0c\u7b2c\u56db\u5217\u5219\u662f\u5f97\u5206\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u53ea\u6253\u5370\u51fa\u4e86\u8fd9\u4e24\u5217\uff0c$3 \u548c $4 \u4ee3\u8868\u4e86\u8f93\u5165\u8bb0\u5f55\u4e2d\u7684\u7b2c\u4e09\u548c\u7b2c\u56db\u4e2a\u5b57\u6bb5\u3002</p>"},{"location":"awk/#_12","title":"\u6253\u5370\u6240\u6709\u7684\u884c","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cAWK\u4f1a\u6253\u5370\u51fa\u6240\u6709\u5339\u914d\u6a21\u5f0f\u7684\u884c</p> <pre><code>$ awk '/a/ {print $0}' marks.txt\n2)  Rahul   Maths    90\n3)  Shyam   Biology  87\n4)  Kedar   English  85\n5)  Hari    History  89\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u4f1a\u5224\u65ad\u6bcf\u4e00\u884c\u4e2d\u662f\u5426\u5305\u542b<code>a</code>\uff0c\u5982\u679c\u5305\u542b\u5219\u6253\u5370\u8be5\u884c\uff0c\u5982\u679cBODY\u90e8\u5206\u7f3a\u5931\u5219\u9ed8\u8ba4\u4f1a\u6267\u884c\u6253\u5370\uff0c\u56e0\u6b64\uff0c\u4e0a\u8ff0\u547d\u4ee4\u548c\u4e0b\u9762\u8fd9\u4e2a\u662f\u7b49\u4ef7\u7684</p> <pre><code>$ awk '/a/' marks.txt\n</code></pre>"},{"location":"awk/#_13","title":"\u6253\u5370\u5339\u914d\u6a21\u5f0f\u7684\u5217","text":"<p>\u5f53\u6a21\u5f0f\u5339\u914d\u6210\u529f\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bAWK\u4f1a\u6253\u5370\u8be5\u884c\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u8ba9\u5b83\u53ea\u6253\u5370\u6307\u5b9a\u7684\u5b57\u6bb5\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u53ea\u4f1a\u6253\u5370\u51fa\u5339\u914d\u6a21\u5f0f\u7684\u7b2c\u4e09\u548c\u7b2c\u56db\u4e2a\u5b57\u6bb5\u3002</p> <pre><code>$ awk '/a/ {print $3 \"\\t\" $4}' marks.txt\nMaths   90\nBiology 87\nEnglish 85\nHistory 89\n</code></pre>"},{"location":"awk/#_14","title":"\u4efb\u610f\u987a\u5e8f\u6253\u5370\u5217","text":"<pre><code>$ awk '/a/ {print $4 \"\\t\" $3}' marks.txt\n90  Maths\n87  Biology\n85  English\n89  History\n</code></pre>"},{"location":"awk/#_15","title":"\u7edf\u8ba1\u5339\u914d\u6a21\u5f0f\u7684\u884c\u6570","text":"<pre><code>$ awk '/a/{++cnt} END {print \"Count = \", cnt}' marks.txt\nCount =  4\n</code></pre>"},{"location":"awk/#18","title":"\u6253\u5370\u8d85\u8fc718\u4e2a\u5b57\u7b26\u7684\u884c","text":"<pre><code>$ awk 'length($0) &gt; 18' marks.txt\n3) Shyam   Biology   87\n4) Kedar   English   85\n</code></pre>"},{"location":"awk/#_16","title":"\u5185\u5efa\u53d8\u91cf","text":"<p>AWK\u63d0\u4f9b\u4e86\u5f88\u591a\u5185\u7f6e\u7684\u53d8\u91cf\uff0c\u5b83\u4eec\u5728\u5f00\u53d1AWK\u811a\u672c\u7684\u8fc7\u7a0b\u4e2d\u8d77\u7740\u975e\u5e38\u91cd\u8981\u7684\u89d2\u8272\u3002</p>"},{"location":"awk/#awk_9","title":"\u6807\u51c6AWK\u53d8\u91cf","text":""},{"location":"awk/#argc","title":"ARGC \u547d\u4ee4\u884c\u53c2\u6570\u4e2a\u6570","text":"<p>\u547d\u4ee4\u884c\u4e2d\u63d0\u4f9b\u7684\u53c2\u6570\u4e2a\u6570</p> <pre><code>$ awk 'BEGIN {print \"Arguments =\", ARGC}' One Two Three Four\nArguments = 5\n</code></pre>"},{"location":"awk/#argv","title":"ARGV \u547d\u4ee4\u884c\u53c2\u6570\u6570\u7ec4","text":"<p>\u5b58\u50a8\u547d\u4ee4\u884c\u53c2\u6570\u7684\u6570\u7ec4\uff0c\u7d22\u5f15\u8303\u56f4\u4ece0 - ARGC - 1\u3002</p> <pre><code>$ awk 'BEGIN { \n   for (i = 0; i &lt; ARGC - 1; ++i) { \n      printf \"ARGV[%d] = %s\\n\", i, ARGV[i] \n   } \n}' one two three four\nARGV[0] = awk\nARGV[1] = one\nARGV[2] = two\nARGV[3] = three\n</code></pre>"},{"location":"awk/#convfmt","title":"CONVFMT \u6570\u5b57\u7684\u7ea6\u5b9a\u683c\u5f0f","text":"<p>\u4ee3\u8868\u4e86\u6570\u5b57\u7684\u7ea6\u5b9a\u683c\u5f0f\uff0c\u9ed8\u8ba4\u503c\u662f%.6g</p> <pre><code>$ awk 'BEGIN { print \"Conversion Format =\", CONVFMT }'\nConversion Format = %.6g\n</code></pre>"},{"location":"awk/#environ","title":"ENVIRON \u73af\u5883\u53d8\u91cf","text":"<p>\u73af\u5883\u53d8\u91cf\u7684\u5173\u8054\u6570\u7ec4</p> <pre><code>$ awk 'BEGIN { print ENVIRON[\"USER\"] }'\nmylxsw\n</code></pre>"},{"location":"awk/#filename","title":"FILENAME \u5f53\u524d\u6587\u4ef6\u540d","text":"<pre><code>$ awk 'END {print FILENAME}' marks.txt\nmarks.txt\n</code></pre>"},{"location":"awk/#fs","title":"FS \u8f93\u5165\u5b57\u6bb5\u7684\u5206\u9694\u7b26","text":"<p>\u4ee3\u8868\u4e86\u8f93\u5165\u5b57\u6bb5\u7684\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u683c\uff0c\u53ef\u4ee5\u901a\u8fc7<code>-F</code>\u9009\u9879\u5728\u547d\u4ee4\u884c\u9009\u9879\u4e2d\u4fee\u6539\u5b83\u3002</p> <pre><code>$ awk 'BEGIN {print \"FS = \" FS}' | cat -vte\nFS =  $\n$ awk -F , 'BEGIN {print \"FS = \" FS}' | cat -vte\nFS = ,$\n</code></pre>"},{"location":"awk/#nf","title":"NF \u5b57\u6bb5\u6570\u76ee","text":"<p>\u4ee3\u8868\u4e86\u5f53\u524d\u884c\u4e2d\u7684\u5b57\u6bb5\u6570\u76ee\uff0c\u4f8b\u5982\u4e0b\u9762\u4f8b\u5b50\u6253\u5370\u51fa\u4e86\u5305\u542b\u5927\u4e8e\u4e24\u4e2a\u5b57\u6bb5\u7684\u884c</p> <pre><code>$ echo -e \"One Two\\nOne Two Three\\nOne Two Three Four\" | awk 'NF &gt; 2'\nOne Two Three\nOne Two Three Four\n</code></pre>"},{"location":"awk/#nr","title":"NR \u884c\u53f7","text":"<pre><code>$ echo -e \"One Two\\nOne Two Three\\nOne Two Three Four\" | awk 'NR &lt; 3'\nOne Two\nOne Two Three\n</code></pre>"},{"location":"awk/#fnr","title":"FNR \u884c\u53f7\uff08\u76f8\u5bf9\u5f53\u524d\u6587\u4ef6\uff09","text":"<p>\u4e0eNR\u76f8\u4f3c\uff0c\u4e0d\u8fc7\u5728\u5904\u7406\u591a\u6587\u4ef6\u65f6\u66f4\u6709\u7528\uff0c\u83b7\u53d6\u7684\u884c\u53f7\u76f8\u5bf9\u4e8e\u5f53\u524d\u6587\u4ef6\u3002</p>"},{"location":"awk/#ofmt","title":"OFMT \u8f93\u51fa\u683c\u5f0f\u6570\u5b57","text":"<p>\u9ed8\u8ba4\u503c\u4e3a%.6g</p> <pre><code>$ awk 'BEGIN {print \"OFMT = \" OFMT}'\nOFMT = %.6g\n</code></pre>"},{"location":"awk/#ofs","title":"OFS \u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26","text":"<p>\u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u683c</p> <pre><code>$ awk 'BEGIN {print \"OFS = \" OFS}' | cat -vte\nOFS =  $\n</code></pre>"},{"location":"awk/#ors","title":"ORS \u8f93\u51fa\u884c\u5206\u9694\u7b26","text":"<p>\u9ed8\u8ba4\u503c\u4e3a\u6362\u884c\u7b26</p> <pre><code>$ awk 'BEGIN {print \"ORS = \" ORS}' | cat -vte\nORS = $\n$\n</code></pre>"},{"location":"awk/#rlength","title":"RLENGTH","text":"<p>\u4ee3\u8868\u4e86 match \u51fd\u6570\u5339\u914d\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u3002</p> <pre><code>$ awk 'BEGIN { if (match(\"One Two Three\", \"re\")) { print RLENGTH } }'\n2\n</code></pre>"},{"location":"awk/#rs","title":"RS \u8f93\u5165\u8bb0\u5f55\u5206\u9694\u7b26","text":"<pre><code>$ awk 'BEGIN {print \"RS = \" RS}' | cat -vte\nRS = $\n$\n</code></pre>"},{"location":"awk/#rstart","title":"RSTART","text":"<p>match\u51fd\u6570\u5339\u914d\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u4f4d\u7f6e</p> <pre><code>$ awk 'BEGIN { if (match(\"One Two Three\", \"Thre\")) { print RSTART } }\n9\n</code></pre>"},{"location":"awk/#subsep","title":"SUBSEP \u6570\u7ec4\u5b50\u811a\u672c\u7684\u5206\u9694\u7b26","text":"<p>\u6570\u7ec4\u5b50\u811a\u672c\u7684\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\\034</p> <pre><code>$ awk 'BEGIN { print \"SUBSEP = \" SUBSEP }' | cat -vte\nSUBSEP = ^\\$\n</code></pre>"},{"location":"awk/#0","title":"$ 0 \u4ee3\u8868\u4e86\u5f53\u524d\u884c","text":"<p>\u4ee3\u8868\u4e86\u5f53\u524d\u884c</p> <pre><code>$ awk '{print $0}' marks.txt\n1) Amit     Physics   80\n2) Rahul    Maths     90\n3) Shyam    Biology   87\n4) Kedar    English   85\n5) Hari     History   89\n</code></pre>"},{"location":"awk/#n","title":"$n","text":"<p>\u5f53\u524d\u884c\u4e2d\u7684\u7b2cn\u4e2a\u5b57\u6bb5</p> <pre><code>$ awk '{print $3 \"\\t\" $4}' marks.txt\nPhysics   80\nMaths     90\nBiology   87\nEnglish   85\nHistory   89\n</code></pre>"},{"location":"awk/#gnu-awk","title":"GNU AWK\u7684\u53d8\u91cf","text":""},{"location":"awk/#argind","title":"ARGIND","text":"<p>\u5f53\u524d\u88ab\u5904\u7406\u7684ARGV\u7684\u7d22\u5f15</p> <pre><code>$ awk '{ \n   print \"ARGIND   = \", ARGIND; print \"Filename = \", ARGV[ARGIND] \n}' junk1 junk2 junk3\nARGIND   =  1\nFilename =  junk1\nARGIND   =  2\nFilename =  junk2\nARGIND   =  3\nFilename =  junk3\n</code></pre>"},{"location":"awk/#binmode","title":"BINMODE","text":"<p>\u5728\u975ePOSIX\u7cfb\u7edf\u4e0a\u6307\u5b9a\u5bf9\u6240\u6709\u7684\u6587\u4ef6I/O\u91c7\u7528\u4e8c\u8fdb\u5236\u6a21\u5f0f\u3002</p>"},{"location":"awk/#errorno","title":"ERRORNO","text":"<p>\u4e00\u4e2a\u4ee3\u8868\u4e86getline\u8df3\u8f6c\u5931\u8d25\u6216\u8005\u662fclose\u8c03\u7528\u5931\u8d25\u7684\u9519\u8bef\u7684\u5b57\u7b26\u4e32\u3002</p> <pre><code>$ awk 'BEGIN { ret = getline &lt; \"junk.txt\"; if (ret == -1) print \"Error:\", ERRNO }'\nError: No such file or directory\n</code></pre>"},{"location":"awk/#fieldwidths","title":"FIELDWIDTHS","text":"<p>\u8bbe\u7f6e\u4e86\u7a7a\u683c\u5206\u9694\u7684\u5b57\u6bb5\u5bbd\u5ea6\u53d8\u91cf\u5217\u8868\u7684\u8bdd\uff0cGAWK\u4f1a\u5c06\u8f93\u5165\u89e3\u6790\u4e3a\u56fa\u5b9a\u5bbd\u5ea6\u7684\u5b57\u6bb5\uff0c\u800c\u4e0d\u662f\u4f7f\u7528FS\u8fdb\u884c\u5206\u9694\u3002</p>"},{"location":"awk/#ignorecase","title":"IGNORECASE","text":"<p>\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u53d8\u91cf\u7684\u8bdd\uff0cAWK\u4f1a\u5ffd\u7565\u5927\u5c0f\u5199\u3002</p> <pre><code>$ awk 'BEGIN{IGNORECASE = 1} /amit/' marks.txt\n1) Amit  Physics   80\n</code></pre>"},{"location":"awk/#lint","title":"LINT","text":"<p>\u63d0\u4f9b\u4e86\u5bf9--lint\u9009\u9879\u7684\u52a8\u6001\u63a7\u5236\u3002</p> <pre><code>$ awk 'BEGIN {LINT = 1; a}'\nawk: cmd. line:1: warning: reference to uninitialized variable `a'\nawk: cmd. line:1: warning: statement has no effect\n</code></pre>"},{"location":"awk/#procinfo","title":"PROCINFO","text":"<p>\u5305\u542b\u8fdb\u7a0b\u4fe1\u606f\u7684\u5173\u8054\u6570\u7ec4\uff0c\u4f8b\u5982UID\uff0c\u8fdb\u7a0bID\u7b49</p> <pre><code>$ awk 'BEGIN { print PROCINFO[\"pid\"] }'\n4316\n</code></pre>"},{"location":"awk/#textdomain","title":"TEXTDOMAIN","text":"<p>\u4ee3\u8868\u4e86AWK\u7684\u6587\u672c\u57df\uff0c\u7528\u4e8e\u67e5\u627e\u5b57\u7b26\u4e32\u7684\u672c\u5730\u5316\u7ffb\u8bd1\u3002</p> <pre><code>$ awk 'BEGIN { print TEXTDOMAIN }'\nmessages\n</code></pre>"},{"location":"awk/#_17","title":"\u64cd\u4f5c\u7b26","text":"<p>\u4e0e\u5176\u5b83\u7f16\u7a0b\u8bed\u8a00\u4e00\u6837\uff0cAWK\u4e5f\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u64cd\u4f5c\u7b26\u3002</p>"},{"location":"awk/#_18","title":"\u7b97\u6570\u64cd\u4f5c\u7b26","text":"<p>\u7b97\u6570\u64cd\u4f5c\u7b26\u4e0d\u591a\u8bf4\uff0c\u76f4\u63a5\u770b\u4f8b\u5b50\uff0c\u65e0\u975e\u5c31\u662f+-*/%</p> <pre><code>$ awk 'BEGIN { a = 50; b = 20; print \"(a + b) = \", (a + b) }'\n(a + b) =  70\n\n$ awk 'BEGIN { a = 50; b = 20; print \"(a - b) = \", (a - b) }'\n(a - b) =  30\n\n$ awk 'BEGIN { a = 50; b = 20; print \"(a * b) = \", (a * b) }'\n(a * b) =  1000\n\n$ awk 'BEGIN { a = 50; b = 20; print \"(a / b) = \", (a / b) }'\n(a / b) =  2.5\n\n$ awk 'BEGIN { a = 50; b = 20; print \"(a % b) = \", (a % b) }'\n(a % b) =  10\n</code></pre>"},{"location":"awk/#_19","title":"\u589e\u51cf\u8fd0\u7b97\u7b26","text":"<p>\u81ea\u589e\u81ea\u51cf\u4e0eC\u8bed\u8a00\u4e00\u81f4\u3002</p> <pre><code>$ awk 'BEGIN { a = 10; b = ++a; printf \"a = %d, b = %d\\n\", a, b }'\na = 11, b = 11\n\n$ awk 'BEGIN { a = 10; b = --a; printf \"a = %d, b = %d\\n\", a, b }'\na = 9, b = 9\n\n$ awk 'BEGIN { a = 10; b = a++; printf \"a = %d, b = %d\\n\", a, b }'\na = 11, b = 10\n\n$ awk 'BEGIN { a = 10; b = a--; printf \"a = %d, b = %d\\n\", a, b }'\na = 9, b = 10\n</code></pre>"},{"location":"awk/#_20","title":"\u8d4b\u503c\u64cd\u4f5c\u7b26","text":"<pre><code>$ awk 'BEGIN { name = \"Jerry\"; print \"My name is\", name }'\nMy name is Jerry\n$ awk 'BEGIN { cnt = 10; cnt += 10; print \"Counter =\", cnt }'\nCounter = 20\n$ awk 'BEGIN { cnt = 100; cnt -= 10; print \"Counter =\", cnt }'\nCounter = 90\n$ awk 'BEGIN { cnt = 10; cnt *= 10; print \"Counter =\", cnt }'\nCounter = 100\n$ awk 'BEGIN { cnt = 100; cnt /= 5; print \"Counter =\", cnt }'\nCounter = 20\n$ awk 'BEGIN { cnt = 100; cnt %= 8; print \"Counter =\", cnt }'\nCounter = 4\n$ awk 'BEGIN { cnt = 2; cnt ^= 4; print \"Counter =\", cnt }'\nCounter = 16\n$ awk 'BEGIN { cnt = 2; cnt **= 4; print \"Counter =\", cnt }'\nCounter = 16\n</code></pre>"},{"location":"awk/#_21","title":"\u5173\u7cfb\u64cd\u4f5c\u7b26","text":"<pre><code>$ awk 'BEGIN { a = 10; b = 10; if (a == b) print \"a == b\" }'\na == b\n$ awk 'BEGIN { a = 10; b = 20; if (a != b) print \"a != b\" }'\na != b\n$ awk 'BEGIN { a = 10; b = 20; if (a &lt; b) print \"a  &lt; b\" }'\na  &lt; b\n$ awk 'BEGIN { a = 10; b = 10; if (a &lt;= b) print \"a &lt;= b\" }'\na &lt;= b\n$ awk 'BEGIN { a = 10; b = 20; if (b &gt; a ) print \"b &gt; a\" }'\nb &gt; a\n</code></pre>"},{"location":"awk/#_22","title":"\u903b\u8f91\u64cd\u4f5c\u7b26","text":"<pre><code>$ awk 'BEGIN {\n   num = 5; if (num &gt;= 0 &amp;&amp; num &lt;= 7) printf \"%d is in octal format\\n\", num\n}'\n5 is in octal format\n$ awk 'BEGIN {\n   ch = \"\\n\"; if (ch == \" \" || ch == \"\\t\" || ch == \"\\n\")\n   print \"Current character is whitespace.\"\n}'\nCurrent character is whitespace.\n$ awk 'BEGIN { name = \"\"; if (! length(name)) print \"name is empty string.\" }'\nname is empty string.\n</code></pre>"},{"location":"awk/#_23","title":"\u4e09\u5143\u64cd\u4f5c\u7b26","text":"<pre><code>$ awk 'BEGIN { a = 10; b = 20; (a &gt; b) ? max = a : max = b; print \"Max =\", max}'\nMax = 20\n</code></pre>"},{"location":"awk/#_24","title":"\u4e00\u5143\u64cd\u4f5c\u7b26","text":"<pre><code>$ awk 'BEGIN { a = -10; a = +a; print \"a =\", a }'\na = -10\n$ awk 'BEGIN { a = -10; a = -a; print \"a =\", a }'\na = 10\n</code></pre>"},{"location":"awk/#_25","title":"\u6307\u6570\u64cd\u4f5c\u7b26","text":"<pre><code>$ awk 'BEGIN { a = 10; a = a ^ 2; print \"a =\", a }'\na = 100\n\n$ awk 'BEGIN { a = 10; a ^= 2; print \"a =\", a }'\na = 100\n</code></pre>"},{"location":"awk/#_26","title":"\u5b57\u7b26\u4e32\u8fde\u63a5\u64cd\u4f5c\u7b26","text":"<pre><code>$ awk 'BEGIN { str1 = \"Hello, \"; str2 = \"World\"; str3 = str1 str2; print str3 }'\nHello, World\n</code></pre>"},{"location":"awk/#_27","title":"\u6570\u7ec4\u6210\u5458\u64cd\u4f5c\u7b26","text":"<pre><code>$ awk 'BEGIN { \n   arr[0] = 1; arr[1] = 2; arr[2] = 3; for (i in arr) printf \"arr[%d] = %d\\n\", i, arr[i]\n}'\narr[2] = 3\narr[0] = 1\narr[1] = 2\n</code></pre>"},{"location":"awk/#_28","title":"\u6b63\u5219\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26","text":"<p>\u6b63\u5219\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26\u4f7f\u7528 ~ \u548c !~ \u5206\u522b\u4ee3\u8868\u5339\u914d\u548c\u4e0d\u5339\u914d\u3002</p> <pre><code>$ awk '$0 ~ 9' marks.txt\n2) Rahul   Maths    90\n5) Hari    History  89\n\n$ awk '$0 !~ 9' marks.txt\n1) Amit     Physics   80\n3) Shyam    Biology   87\n4) Kedar    English   85\n\n# \u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u9700\u8981\u5728\u8868\u8fbe\u5f0f\u524d\u540e\u6dfb\u52a0\u53cd\u659c\u7ebf\uff0c\u4e0ejs\u7c7b\u4f3c\u5427\n$ tail -n 40 /var/log/nginx/access.log | awk '$0 ~ /ip\\[127\\.0\\.0\\.1\\]/'\n</code></pre> <p>\u66f4\u591a\u5173\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u8bf7\u770b\u540e\u9762\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u90e8\u5206</p>"},{"location":"awk/#_29","title":"\u6b63\u5219\u8868\u8fbe\u5f0f","text":"<p>AWK\u5728\u5904\u7406\u6b63\u5219\u8868\u8fbe\u5f0f\u65b9\u9762\u662f\u975e\u5e38\u5f3a\u5927\u7684\uff0c\u4f7f\u7528\u7b80\u5355\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5904\u7406\u975e\u5e38\u590d\u6742\u7684\u95ee\u9898\u3002</p> <pre><code>$ echo -e \"cat\\nbat\\nfun\\nfin\\nfan\" | awk '/f.n/'\nfun\nfin\nfan\n\n$ echo -e \"This\\nThat\\nThere\\nTheir\\nthese\" | awk '/^The/'\nThere\nTheir\n\n$ echo -e \"knife\\nknow\\nfun\\nfin\\nfan\\nnine\" | awk '/n$/'\nfun\nfin\nfan\n\n$ echo -e \"Call\\nTall\\nBall\" | awk '/[CT]all/'\nCall\nTall\n\n$ echo -e \"Call\\nTall\\nBall\" | awk '/[^CT]all/'\nBall\n\n$ echo -e \"Call\\nTall\\nBall\\nSmall\\nShall\" | awk '/Call|Ball/'\nCall\nBall\n\n$ echo -e \"Colour\\nColor\" | awk '/Colou?r/'\nColour\nColor\n\n$ echo -e \"ca\\ncat\\ncatt\" | awk '/cat*/'\nca\ncat\ncatt\n\n$ echo -e \"111\\n22\\n123\\n234\\n456\\n222\"  | awk '/2+/'\n22\n123\n234\n222\n\n$ echo -e \"Apple Juice\\nApple Pie\\nApple Tart\\nApple Cake\" | awk '/Apple (Juice|Cake)/'\nApple Juice\nApple Cake\n</code></pre>"},{"location":"awk/#_30","title":"\u6570\u7ec4","text":"<p>AWK\u652f\u6301\u5173\u8054\u6570\u7ec4\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u4f7f\u7528\u6570\u5b57\u7d22\u5f15\u7684\u6570\u7ec4\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5b57\u7b26\u4e32\u4f5c\u4e3a\u7d22\u5f15\uff0c\u800c\u4e14\u6570\u5b57\u7d22\u5f15\u4e5f\u4e0d\u8981\u6c42\u662f\u8fde\u7eed\u7684\u3002\u6570\u7ec4\u4e0d\u9700\u8981\u58f0\u660e\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>array_name[index] = value\n</code></pre> <p>\u521b\u5efa\u6570\u7ec4\u7684\u65b9\u5f0f\u975e\u5e38\u7b80\u5355\uff0c\u76f4\u63a5\u4e3a\u53d8\u91cf\u8d4b\u503c\u5373\u53ef</p> <pre><code>$ awk 'BEGIN {\n   fruits[\"mango\"] = \"yellow\";\n   fruits[\"orange\"] = \"orange\"\n   print fruits[\"orange\"] \"\\n\" fruits[\"mango\"]\n}'\norange\nyellow\n</code></pre> <p>\u5220\u9664\u6570\u7ec4\u5143\u7d20\u4f7f\u7528<code>delete</code>\u8bed\u53e5</p> <pre><code>$ awk 'BEGIN {\n   fruits[\"mango\"] = \"yellow\";\n   fruits[\"orange\"] = \"orange\";\n   delete fruits[\"orange\"];\n   print fruits[\"orange\"]\n}'\n</code></pre> <p>\u5728AWK\u4e2d\uff0c\u53ea\u652f\u6301\u4e00\u7ef4\u6570\u7ec4\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u4e00\u7ef4\u6570\u7ec4\u6a21\u62df\u591a\u7ef4\uff0c\u4f8b\u5982\u6211\u4eec\u6709\u4e00\u4e2a3x3\u7684\u4e09\u7ef4\u6570\u7ec4</p> <pre><code>100   200   300\n400   500   600\n700   800   900\n</code></pre> <p>\u53ef\u4ee5\u8fd9\u6837\u64cd\u4f5c</p> <pre><code>$ awk 'BEGIN {\n   array[\"0,0\"] = 100;\n   array[\"0,1\"] = 200;\n   array[\"0,2\"] = 300;\n   array[\"1,0\"] = 400;\n   array[\"1,1\"] = 500;\n   array[\"1,2\"] = 600;\n\n   # print array elements\n   print \"array[0,0] = \" array[\"0,0\"];\n   print \"array[0,1] = \" array[\"0,1\"];\n   print \"array[0,2] = \" array[\"0,2\"];\n   print \"array[1,0] = \" array[\"1,0\"];\n   print \"array[1,1] = \" array[\"1,1\"];\n   print \"array[1,2] = \" array[\"1,2\"];\n}'\narray[0,0] = 100\narray[0,1] = 200\narray[0,2] = 300\narray[1,0] = 400\narray[1,1] = 500\narray[1,2] = 600\n</code></pre>"},{"location":"awk/#_31","title":"\u6d41\u7a0b\u63a7\u5236","text":"<p>\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5\u4e0e\u5927\u591a\u6570\u8bed\u8a00\u4e00\u6837\uff0c\u57fa\u672c\u683c\u5f0f\u5982\u4e0b</p> <pre><code>if (condition)\n   action\n\nif (condition) {\n   action-1\n   action-1\n   .\n   .\n   action-n\n}\n\nif (condition)\n   action-1\nelse if (condition2)\n   action-2\nelse\n   action-3\n</code></pre> <p>\u4f8b\u5982\uff1a</p> <pre><code>$ awk 'BEGIN {\n   num = 11; if (num % 2 == 0) printf \"%d is even number.\\n\", num; \n      else printf \"%d is odd number.\\n\", num \n}'\n\n$ awk 'BEGIN {\n   a = 30;\n\n   if (a==10)\n   print \"a = 10\";\n   else if (a == 20)\n   print \"a = 20\";\n   else if (a == 30)\n   print \"a = 30\";\n}'\n</code></pre>"},{"location":"awk/#_32","title":"\u5faa\u73af","text":"<p>\u5faa\u73af\u64cd\u4f5c\u4e0e\u5176\u4ed6C\u7cfb\u8bed\u8a00\u4e00\u6837\uff0c\u4e3b\u8981\u5305\u62ec <code>for</code>\uff0c<code>while</code>\uff0c<code>do...while</code>\uff0c<code>break</code>\uff0c<code>continue</code> \u8bed\u53e5\uff0c\u5f53\u7136\uff0c\u8fd8\u6709\u4e00\u4e2a <code>exit</code>\u8bed\u53e5\u7528\u4e8e\u9000\u51fa\u811a\u672c\u6267\u884c\u3002</p> <pre><code>for (initialisation; condition; increment/decrement)\n   action\n\nwhile (condition)\n   action\n\ndo\n   action\nwhile (condition)\n</code></pre> <p>\u4f8b\u5b50\uff1a</p> <pre><code>$ awk 'BEGIN { for (i = 1; i &lt;= 5; ++i) print i }'\n\n$ awk 'BEGIN {i = 1; while (i &lt; 6) { print i; ++i } }'\n\n$ awk 'BEGIN {i = 1; do { print i; ++i } while (i &lt; 6) }'\n\n$ awk 'BEGIN {\n   sum = 0; for (i = 0; i &lt; 20; ++i) { \n      sum += i; if (sum &gt; 50) break; else print \"Sum =\", sum \n   } \n}'\n\n$ awk 'BEGIN {\n   for (i = 1; i &lt;= 20; ++i) {\n      if (i % 2 == 0) print i ; else continue\n   } \n}'\n\n$ awk 'BEGIN {\n   sum = 0; for (i = 0; i &lt; 20; ++i) {\n      sum += i; if (sum &gt; 50) exit(10); else print \"Sum =\", sum \n   } \n}'\n</code></pre> <p><code>exit</code>\u7528\u4e8e\u9000\u51fa\u811a\u672c\uff0c\u53c2\u6570\u4e3a\u9000\u51fa\u7684\u72b6\u6001\u7801\uff0c\u53ef\u4ee5\u901a\u8fc7shell\u4e2d\u7684<code>$?</code>\u83b7\u53d6</p>"},{"location":"awk/#_33","title":"\u51fd\u6570","text":""},{"location":"awk/#_34","title":"\u5185\u5efa\u51fd\u6570","text":"<p>AWK\u63d0\u4f9b\u4e86\u5f88\u591a\u65b9\u4fbf\u7684\u5185\u5efa\u51fd\u6570\u4f9b\u7f16\u7a0b\u4eba\u5458\u4f7f\u7528\u3002\u7531\u4e8e\u51fd\u6570\u6bd4\u8f83\u591a\uff0c\u4e2a\u4eba\u89c9\u5f97\u5355\u7eaf\u770b\u6bcf\u4e2a\u51fd\u6570\u7684\u4f7f\u7528\u4e5f\u6ca1\u6709\u4ec0\u4e48\u5b9e\u9645\u610f\u4e49\uff0c\u6bd4\u8f83\u5bb9\u6613\u9057\u5fd8\uff0c\u56e0\u6b64\uff0c\u8fd9\u91cc\u53ea\u7b80\u5355\u7684\u5217\u51fa\u5e38\u7528\u7684\u4e00\u4e9b\u51fd\u6570\uff0c\u53ea\u9700\u8981\u5bf9\u5176\u6709\u4e2a\u5370\u8c61\u5373\u53ef\uff0c\u4f7f\u7528\u7684\u65f6\u5019\u518d\u53bb \u67e5\u624b\u518c \u6548\u679c\u4f1a\u66f4\u597d\u4e00\u4e9b\u5427\u3002</p>"},{"location":"awk/#_35","title":"\u6570\u5b66\u51fd\u6570","text":"<ul> <li><code>atan2(y, x)</code> </li> <li><code>cos(expr)</code> </li> <li><code>exp(expr)</code> </li> <li><code>int(expr)</code> </li> <li><code>log(expr)</code> </li> <li><code>rand</code> </li> <li><code>sin(expr)</code> </li> <li><code>sqrt(expr)</code> </li> <li><code>srand([expr])</code> </li> </ul>"},{"location":"awk/#_36","title":"\u5b57\u7b26\u4e32\u51fd\u6570","text":"<ul> <li><code>asort(arr [, d [, how] ])</code> </li> <li><code>asorti(arr [, d [, how] ])</code> </li> <li><code>gsub(regex, sub, string)</code> </li> <li><code>index(str, sub)</code> </li> <li><code>length(str)</code> </li> <li><code>match(str, regex)</code> </li> <li><code>split(str, arr, regex)</code> </li> <li><code>sprintf(format, expr-list)</code> </li> <li><code>strtonum(str)</code> </li> <li><code>sub(regex, sub, string)</code> </li> <li><code>substr(str, start, l)</code> </li> <li><code>tolower(str)</code> </li> <li><code>toupper(str)</code></li> </ul>"},{"location":"awk/#_37","title":"\u65f6\u95f4\u51fd\u6570","text":"<ul> <li><code>systime</code> </li> <li><code>mktime(datespec)</code> </li> <li><code>strftime([format [, timestamp[, utc-flag]]])</code> </li> </ul>"},{"location":"awk/#_38","title":"\u5b57\u8282\u64cd\u4f5c\u51fd\u6570","text":"<ul> <li><code>and</code> </li> <li><code>compl</code> </li> <li><code>lshift</code> </li> <li><code>rshift</code> </li> <li><code>or</code> </li> <li><code>xor</code> </li> </ul>"},{"location":"awk/#_39","title":"\u5176\u5b83","text":"<ul> <li> <p><code>close(expr)</code> \u5173\u95ed\u7ba1\u9053\u6587\u4ef6</p> <p>\u8bf7\u770b\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801</p> <pre><code>$ awk 'BEGIN {\n   cmd = \"tr [a-z] [A-Z]\"\n   print \"hello, world !!!\" |&amp; cmd\n\n   close(cmd, \"to\")\n   cmd |&amp; getline out\n   print out;\n\n   close(cmd);\n}'\nHELLO, WORLD !!!\n</code></pre> <p>\u662f\u4e0d\u662f\u611f\u89c9\u5f88\u96be\u61c2\uff1f\u8ba9\u6211\u6765\u89e3\u91ca\u4e00\u4e0b</p> <ul> <li>\u7b2c\u4e00\u4e2a\u8bed\u53e5<code>cmd = \"tr [a-z] [A-Z]\"</code>\u662f\u6211\u4eec\u5728AWK\u4e2d\u8981\u7528\u6765\u5efa\u7acb\u53cc\u5411\u8fde\u63a5\u7684\u547d\u4ee4\u3002</li> <li>\u7b2c\u4e8c\u4e2a\u8bed\u53e5<code>print</code>\u63d0\u4f9b\u4e86<code>tr</code>\u547d\u4ee4\u7684\u8f93\u5165\uff0c\u4f7f\u7528 &amp;| \u8868\u540d\u5efa\u7acb\u53cc\u5411\u8fde\u63a5\u3002</li> <li>\u7b2c\u4e09\u4e2a\u8bed\u53e5<code>close(cmd, \"to\")</code>\u7528\u4e8e\u6267\u884c\u5b8c\u6210\u540e\u5173\u95edto\u8fdb\u7a0b</li> <li>\u7b2c\u56db\u4e2a\u8bed\u53e5<code>cmd |&amp; getline out</code>\u4f7f\u7528<code>getline</code>\u51fd\u6570\u5b58\u50a8\u8f93\u51fa\u5230out\u53d8\u91cf</li> <li>\u63a5\u4e0b\u6765\u6253\u5370\u53d8\u91cfout\u7684\u5185\u5bb9\uff0c\u7136\u540e\u5173\u95edcmd</li> </ul> </li> <li> <p><code>delete</code>  \u7528\u4e8e\u5220\u9664\u6570\u7ec4\u5143\u7d20</p> </li> <li><code>exit</code>  \u9000\u51fa\u811a\u672c\u6267\u884c\uff0c\u5e76\u8fd4\u56de\u72b6\u6001\u7801\u53c2\u6570</li> <li><code>fflush</code> </li> <li> <p><code>getline</code> \u8be5\u547d\u4ee4\u8ba9awk\u8bfb\u53d6\u4e0b\u4e00\u884c\u5185\u5bb9</p> <p>\u8be5\u547d\u4ee4\u8ba9awk\u8bfb\u53d6\u4e0b\u4e00\u884c\u5185\u5bb9\uff0c\u6bd4\u5982</p> <pre><code>$ awk '{getline; print $0}' marks.txt\n2) Rahul   Maths     90\n4) Kedar   English   85\n5) Hari    History   89\n</code></pre> <p>\u4f7f\u7528<code>getline var &lt; file</code>\u53ef\u4ee5\u4ecefile\u4e2d\u8bfb\u53d6\u8f93\u5165\uff0c\u5b58\u50a8\u5230\u53d8\u91cfvar\u4e2d</p> <pre><code>{\n     if (NF == 2 &amp;&amp; $1 == \"@include\") {\n          while ((getline line &lt; $2) &gt; 0)\n               print line\n          # \u8fd9\u91cc\u7684close\u786e\u4fdd\u5982\u679c\u6587\u4ef6\u4e2d\u4e24\u4e2a@include\uff0c\u53ef\u4ee5\u8ba9\u5176\u8bfb\u53d6\u4e24\u6b21\n          close($2)\n     } else\n          print\n}\n</code></pre> <p>\u547d\u4ee4\u7684\u8f93\u51fa\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7ba1\u9053\u8f93\u5165\u5230<code>getline</code>\uff0c\u4f7f\u7528<code>command | getline</code>\u8fd9\u79cd\u65b9\u5f0f\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b57\u7b26\u4e32\u547d\u4ee4\u4f1a\u4f5c\u4e3ashell\u547d\u4ee4\u6267\u884c\uff0c\u5176\u6807\u51c6\u8f93\u51fa\u4f1a\u901a\u8fc7\u7ba1\u9053\u4f20\u9012\u4e2aawk\u4f5c\u4e3a\u5176\u8f93\u5165\uff0c\u8fd9\u79cd\u5f62\u5f0f\u7684getline\u4f1a\u4ece\u7ba1\u9053\u4e2d\u4e00\u6b21\u8bfb\u53d6\u4e00\u6761\u8bb0\u5f55\u3002\u4f8b\u5982\u4e0b\u9762\u7684\u547d\u4ee4\u4f1a\u4ece\u8f93\u5165\u4e2d\u9010\u884c\u8bfb\u53d6\uff0c\u5982\u679c\u9047\u5230<code>@execute</code>\uff0c\u5219\u5c06\u8be5\u884c\u4f5c\u4e3a\u547d\u4ee4\u6267\u884c\uff0c\u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u4f5c\u4e3a\u6700\u7ec8\u7684\u8f93\u51fa\u5185\u5bb9</p> <pre><code>{\n     if ($1 == \"@execute\") {\n          tmp = substr($0, 10)        # Remove \"@execute\"\n          while ((tmp | getline) &gt; 0)\n               # \u8fd9\u91cc\u5b9e\u9645\u4e0a\u8bbe\u7f6e\u4e86$0\u4e3a\u8fd9\u4e00\u884c\u7684\u5185\u5bb9\n               print\n          close(tmp)\n     } else\n          print\n}\n</code></pre> <p>\u5982\u679c\u6587\u4ef6\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9</p> <pre><code>foo\nbar\nbaz\n@execute who\nbletch\n</code></pre> <p>\u5219\u4f1a\u8f93\u51fa</p> <pre><code>foo\nbar\nbaz\narnold     ttyv0   Jul 13 14:22\nmiriam     ttyp0   Jul 13 14:23     (murphy:0)\nbill       ttyp1   Jul 13 14:23     (murphy:0)\nbletch\n</code></pre> <p>\u4f7f\u7528<code>command | getline var</code>\u53ef\u4ee5\u5b9e\u73b0\u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u5199\u5165\u5230\u53d8\u91cfvar\u3002</p> <pre><code>BEGIN {\n     \"date\" | getline current_time\n     close(\"date\")\n     print \"Report printed on \" current_time\n}\n</code></pre> <p><code>getline</code>\u4f7f\u7528\u7ba1\u9053\u8bfb\u53d6\u8f93\u5165\u662f\u4e00\u79cd\u5355\u5411\u7684\u64cd\u4f5c\uff0c\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4f60\u53ef\u80fd\u5e0c\u671b\u53d1\u9001\u6570\u636e\u5230\u53e6\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u7136\u540e\u4ece\u8fd9\u4e2a\u8fdb\u7a0b\u4e2d\u8bfb\u53d6\u5904\u7406\u540e\u7684\u7ed3\u679c\uff0c  \u8fd9\u5c31\u7528\u5230\u4e86\u534f\u540c\u8fdb\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>|&amp;</code>\u6253\u5f00\u4e00\u4e2a\u53cc\u5411\u7ba1\u9053\u3002</p> <pre><code>print \"some query\" |&amp; \"db_server\"\n\"db_server\" |&amp; getline\n</code></pre> <p>\u540c\u6837\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>command |&amp; getline var</code>\u5c06\u534f\u540c\u8fdb\u7a0b\u7684\u8f93\u51fa\u5199\u5165\u5230\u53d8\u91cfvar\u3002</p> </li> <li> <p><code>next</code> </p> </li> <li><code>nextfile</code> </li> <li> <p><code>return</code> </p> <p>\u7528\u4e8e\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u8fd4\u56de\u503c\u3002 \u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2afunctions.awk\u6587\u4ef6\uff0c\u5305\u542b\u4e0b\u9762\u7684awk\u547d\u4ee4</p> <pre><code>function addition(num1, num2) {\n   result = num1 + num2\n   return result\n}\nBEGIN {\n   res = addition(10, 20)\n   print \"10 + 20 = \" res\n}\n</code></pre> <p>\u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\uff0c\u8f93\u51fa</p> <pre><code>10 + 20 = 30\n</code></pre> </li> <li> <p><code>system</code> </p> <p>\u8be5\u51fd\u6570\u7528\u4e8e\u6267\u884c\u6307\u5b9a\u7684\u547d\u4ee4\u5e76\u4e14\u8fd4\u56de\u5b83\u7684\u9000\u51fa\u72b6\u6001\uff0c\u8fd4\u56de\u72b6\u6001\u78010\u8868\u793a\u547d\u4ee4\u6210\u529f\u6267\u884c\u3002</p> <pre><code>$ awk 'BEGIN { ret = system(\"date\"); print \"Return value = \" ret }'\n2016\u5e74 10\u6708 27\u65e5 \u661f\u671f\u56db 22:08:36 CST\nReturn value = 0\n</code></pre> </li> </ul>"},{"location":"awk/#_40","title":"\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570","text":"<p>\u51fd\u6570\u662f\u7a0b\u5e8f\u57fa\u672c\u7684\u7ec4\u6210\u90e8\u5206\uff0cAWK\u5141\u8bb8\u6211\u4eec\u81ea\u5df1\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u3002\u4e00\u4e2a\u5927\u578b\u7684\u7a0b\u5e8f\u53ef\u4ee5\u88ab\u5212\u5206\u4e3a\u591a\u4e2a\u51fd\u6570\uff0c\u6bcf\u4e2a\u51fd\u6570\u4e4b\u95f4\u53ef\u4ee5\u72ec\u7acb\u7684\u5f00\u53d1\u548c\u6d4b\u8bd5\uff0c\u63d0\u4f9b\u53ef\u91cd\u7528\u7684\u4ee3\u7801\u3002</p> <p>\u4e0b\u9762\u662f\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u57fa\u672c\u8bed\u6cd5</p> <pre><code>function function_name(argument1, argument2, ...) { \n   function body\n}\n</code></pre> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3afunctions.awk\u7684\u6587\u4ef6\uff0c\u5305\u542b\u4e0b\u9762\u7684\u4ee3\u7801</p> <pre><code># Returns minimum number\nfunction find_min(num1, num2){\n   if (num1 &lt; num2)\n   return num1\n   return num2\n}\n# Returns maximum number\nfunction find_max(num1, num2){\n   if (num1 &gt; num2)\n   return num1\n   return num2\n}\n# Main function\nfunction main(num1, num2){\n   # Find minimum number\n   result = find_min(10, 20)\n   print \"Minimum =\", result\n\n   # Find maximum number\n   result = find_max(10, 20)\n   print \"Maximum =\", result\n}\n# Script execution starts here\nBEGIN {\n   main(10, 20)\n}\n</code></pre> <p>\u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\uff0c\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u8f93\u51fa</p> <pre><code>Minimum = 10\nMaximum = 20\n</code></pre>"},{"location":"awk/#_41","title":"\u8f93\u51fa\u91cd\u5b9a\u5411","text":""},{"location":"awk/#_42","title":"\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u6240\u6709\u7684\u7a0b\u5e8f\u90fd\u662f\u76f4\u63a5\u663e\u793a\u6570\u636e\u5230\u4e86\u6807\u51c6\u8f93\u51fa\u6d41\uff0c\u5176\u5b9e\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u3002\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\u8ddf\u5728<code>print</code>\u548c<code>printf</code>\u51fd\u6570\u7684\u540e\u9762\uff0c\u4e0eshell\u4e2d\u7684\u7528\u6cd5\u57fa\u672c\u4e00\u81f4\u3002</p> <pre><code>print DATA &gt; output-file\nprint DATA &gt;&gt; output-file\n</code></pre> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u4e24\u6761\u547d\u4ee4\u8f93\u51fa\u662f\u4e00\u81f4\u7684</p> <pre><code>$ echo \"Hello, World !!!\" &gt; /tmp/message.txt\n$ awk 'BEGIN { print \"Hello, World !!!\" &gt; \"/tmp/message.txt\" }'\n</code></pre> <p>\u4e0eshell\u4e2d\u4e00\u6837\uff0c<code>&gt;</code>\u7528\u4e8e\u5c06\u8f93\u51fa\u5199\u5165\u5230\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\uff0c\u5982\u679c\u6587\u4ef6\u4e2d\u6709\u5185\u5bb9\u5219\u8986\u76d6\uff0c\u800c<code>&gt;&gt;</code>\u5219\u4e3a\u8ffd\u52a0\u6a21\u5f0f\u5199\u5165\u3002</p> <pre><code>$ awk 'BEGIN { print \"Hello, World !!!\" &gt;&gt; \"/tmp/message.txt\" }'\n$ cat /tmp/message.txt\n</code></pre>"},{"location":"awk/#_43","title":"\u7ba1\u9053","text":"<p>\u9664\u4e86\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u4e4b\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u5176\u5b83\u7a0b\u5e8f\uff0c\u4e0eshell\u4e2d\u4e00\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7ba1\u9053\u64cd\u4f5c\u7b26<code>|</code>\u3002</p> <pre><code>$ awk 'BEGIN { print \"hello, world !!!\" | \"tr [a-z] [A-Z]\" }'\nHELLO, WORLD !!!\n</code></pre> <p>AWK\u4e2d\u53ef\u4ee5\u4f7f\u7528<code>|&amp;</code>\u8fdb\u884c\u53cc\u5411\u8fde\u63a5\uff0c\u90a3\u4e48\u4ec0\u4e48\u662f\u53cc\u5411\u8fde\u63a5\u5462\uff1f\u4e00\u79cd\u5e38\u89c1\u7684\u573a\u666f\u662f\u6211\u4eec\u53d1\u9001\u6570\u636e\u5230\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u5904\u7406\uff0c\u7136\u540e\u8bfb\u53d6\u5904\u7406\u7ed3\u679c\uff0c\u8fd9\u79cd\u573a\u666f\u4e0b\u5c31\u9700\u8981\u6253\u5f00\u4e00\u4e2a\u5230\u53e6\u5916\u4e00\u4e2a\u8fdb\u7a0b\u7684\u53cc\u5411\u7ba1\u9053\u4e86\u3002\u7b2c\u4e8c\u4e2a\u8fdb\u7a0b\u4f1a\u4e0egawk\u7a0b\u5e8f\u5e76\u884c\u6267\u884c\uff0c\u8fd9\u91cc\u79f0\u5176\u4e3a \u534f\u4f5c\u8fdb\u7a0b\u3002\u4e0e\u5355\u5411\u8fde\u63a5\u4f7f\u7528<code>|</code>\u64cd\u4f5c\u7b26\u4e0d\u540c\u7684\u662f\uff0c\u53cc\u5411\u8fde\u63a5\u4f7f\u7528<code>|&amp;</code>\u64cd\u4f5c\u7b26\u3002</p> <pre><code>do {\n    print data |&amp; \"subprogram\"\n    \"subprogram\" |&amp; getline results\n} while (data left to process)\nclose(\"subprogram\")\n</code></pre> <p>\u7b2c\u4e00\u6b21I/O\u64cd\u4f5c\u4f7f\u7528\u4e86<code>|&amp;</code>\u64cd\u4f5c\u7b26\uff0cgawk\u4f1a\u521b\u5efa\u4e00\u4e2a\u5230\u8fd0\u884c\u5176\u5b83\u7a0b\u5e8f\u7684\u5b50\u8fdb\u7a0b\u7684\u53cc\u5411\u7ba1\u9053\uff0c<code>print</code>\u7684\u8f93\u51fa\u88ab\u5199\u5165\u5230\u4e86<code>subprogram</code>\u7684\u6807\u51c6\u8f93\u5165\uff0c\u800c\u8fd9\u4e2a<code>subprogram</code>\u7684\u6807\u51c6\u8f93\u51fa\u5728gawk\u4e2d\u4f7f\u7528<code>getline</code>\u51fd\u6570\u8fdb\u884c\u8bfb\u53d6\u3002</p> <p>\u6ce8\u610f\uff1a\u76ee\u524d\u534f\u540c\u8fdb\u7a0b\u7684\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u5c06\u4f1a\u548cgawk\u7684\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u6df7\u6742\u5728\u4e00\u8d77\uff0c\u65e0\u6cd5\u5355\u72ec\u83b7\u53d6\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002\u53e6\u5916\uff0cI/O\u7f13\u51b2\u53ef\u80fd\u5b58\u5728\u95ee\u9898\uff0cgawk\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u7684\u5237\u65b0\u6240\u6709\u8f93\u51fa\u5230\u4e0b\u6e38\u7684\u534f\u540c\u8fdb\u7a0b\u7684\u7ba1\u9053\u3002\u4f46\u662f\uff0c\u5982\u679c\u534f\u540c\u8fdb\u7a0b\u6ca1\u6709\u5237\u65b0\u5176\u6807\u51c6\u8f93\u51fa\u7684\u8bdd\uff0cgawk\u5c06\u53ef\u80fd\u4f1a\u5728\u4f7f\u7528<code>getline</code>\u51fd\u6570\u4ece\u534f\u540c\u8fdb\u7a0b\u8bfb\u53d6\u8f93\u51fa\u7684\u65f6\u5019\u6302\u8d77\uff0c\u8fd9\u5c31\u53ef\u80fd\u5f15\u8d77\u6b7b\u9501\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>close</code>\u51fd\u6570\u5173\u95ed\u53cc\u5411\u7ba1\u9053\u7684to\u6216\u8005from\u4e00\u7aef\uff0c\u8fd9\u4e24\u4e2a\u5b57\u7b26\u4e32\u503c\u544a\u8bc9gawk\u53d1\u9001\u6570\u636e\u5230\u534f\u540c\u8fdb\u7a0b\u5b8c\u6210\u65f6\u6216\u8005\u4ece\u534f\u540c\u8fdb\u7a0b\u8bfb\u53d6\u5b8c\u6bd5\u65f6\u5173\u95ed\u7ba1\u9053\u3002\u5728\u4f7f\u7528\u7cfb\u7edf\u547d\u4ee4<code>sort</code>\u7684\u65f6\u5019\u662f\u8fd9\u6837\u505a\u662f\u975e\u5e38\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a\u5b83\u5fc5\u987b\u7b49\u6240\u6709\u8f93\u51fa\u90fd\u8bfb\u53d6\u5b8c\u6bd5\u65f6\u624d\u80fd\u8fdb\u884c\u6392\u5e8f\u3002</p> <pre><code>BEGIN {\n    command = \"LC_ALL=C sort\"\n    n = split(\"abcdefghijklmnopqrstuvwxyz\", a, \"\")\n\n    for (i = n; i &gt; 0; i--)\n        print a[i] |&amp; command\n    close(command, \"to\")\n\n    while ((command |&amp; getline line) &gt; 0)\n        print \"got\", line\n    close(command)\n}\n</code></pre> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\u4f7f\u7528<code>tr</code>\u547d\u4ee4\u8f6c\u6362\u5c0f\u5199\u4e3a\u5927\u5199\u3002\u6211\u4eec\u7684command.awk\u6587\u4ef6\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9</p> <pre><code>BEGIN {\n   cmd = \"tr [a-z] [A-Z]\"\n   print \"hello, world !!!\" |&amp; cmd\n   close(cmd, \"to\")\n\n   cmd |&amp; getline out\n   print out;\n   close(cmd);\n}\n</code></pre> <p>\u8f93\u51fa </p> <pre><code>HELLO, WORLD !!!\n</code></pre> <p>\u4e0a\u4f8b\u770b\u8d77\u6765\u6709\u4e9b\u590d\u6742\uff0c\u6211\u4eec\u9010\u884c\u5206\u6790\u4e00\u4e0b</p> <ul> <li>\u9996\u5148\uff0c\u7b2c\u4e00\u884c cmd = \"tr [a-z] [A-Z]\" \u662f\u5728AWK\u4e2d\u8981\u5efa\u7acb\u53cc\u5411\u8fde\u63a5\u7684\u547d\u4ee4</li> <li>\u7b2c\u4e8c\u884c\u7684print\u547d\u4ee4\u7528\u4e8e\u4e3atr\u547d\u4ee4\u63d0\u4f9b\u8f93\u5165\uff0c\u800c <code>|&amp;</code> \u7528\u4e8e\u6307\u51fa\u8981\u5efa\u7acb\u53cc\u5411\u8fde\u63a5</li> <li>\u7b2c\u4e09\u884c\u7528\u4e8e\u5728\u4e0a\u9762\u7684\u8bed\u53e5close(cmd, \"to\"),\u5728\u6267\u884c\u5b8c\u6210\u540e\u5173\u95ed\u5176to\u8fdb\u7a0b</li> <li>\u7b2c\u56db\u884c cmd |&amp; getline out\u4f7f\u7528getline\u51fd\u6570\u5b58\u50a8\u8f93\u51fa\u5230\u53d8\u91cfout\u4e2d</li> <li>\u6700\u540e\u4e00\u884c\u4f7f\u7528close\u51fd\u6570\u5173\u95ed\u547d\u4ee4</li> </ul>"},{"location":"awk/#_44","title":"\u7f8e\u5316\u8f93\u51fa","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u4f7f\u7528\u8fc7<code>print</code>\u548c<code>printf</code>\u51fd\u6570\u663e\u793a\u6570\u636e\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u4f46\u662f<code>printf</code>\u51fd\u6570\u5b9e\u9645\u4e0a\u8981\u6bd4\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684\u60c5\u51b5\u66f4\u52a0\u5f3a\u5927\u5f97\u591a\u3002\u8be5\u51fd\u6570\u662f\u4eceC\u8bed\u8a00\u4e2d\u501f\u9274\u6765\u7684\uff0c\u5728\u5904\u7406\u683c\u5f0f\u5316\u7684\u8f93\u51fa\u65f6\u975e\u5e38\u6709\u7528\u3002</p> <pre><code>$ awk 'BEGIN { printf \"Hello\\nWorld\\n\" }'\nHello\nWorld\n\n$ awk 'BEGIN { printf \"ASCII value 65 = character %c\\n\", 65 }'\nASCII value 65 = character A\n</code></pre> <p>\u683c\u5f0f\u5316\u8f93\u51fa\u6807\u8bc6\u6709 <code>%c</code>\uff0c <code>%d</code>\uff0c<code>%s</code> \u7b49\uff0c\u57fa\u672c\u4e0eC\u8bed\u8a00\u4e00\u81f4\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8d58\u8ff0\u4e86\u3002</p>"},{"location":"awk/#shell","title":"\u6267\u884cshell\u547d\u4ee4","text":"<p>\u5728AWK\u4e2d\u6267\u884cshell\u547d\u4ee4\u6709\u4e24\u79cd\u65b9\u5f0f</p> <ul> <li>\u4f7f\u7528<code>system</code>\u51fd\u6570</li> <li>\u4f7f\u7528\u7ba1\u9053</li> </ul>"},{"location":"awk/#system","title":"\u4f7f\u7528system\u51fd\u6570","text":"<p>system\u51fd\u6570\u7528\u4e8e\u6267\u884c\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u5e76\u4e14\u8fd4\u56de\u547d\u4ee4\u7684\u9000\u51fa\u7801\u5230awk\u3002</p> <pre><code>END {\n     system(\"date | mail -s 'awk run done' root\")\n}\n</code></pre>"},{"location":"awk/#_45","title":"\u4f7f\u7528\u7ba1\u9053","text":"<p>\u5982\u679c\u8981\u6267\u884c\u7684\u547d\u4ee4\u5f88\u591a\uff0c\u53ef\u4ee5\u5c06\u8f93\u51fa\u7684\u547d\u4ee4\u76f4\u63a5\u7528\u7ba1\u9053\u4f20\u9012\u7ed9\"/bin/sh\"\u6267\u884c</p> <pre><code>while (more stuff to do)\n    print command | \"/bin/sh\"\nclose(\"/bin/sh\")\n</code></pre>"},{"location":"awk/#_46","title":"\u53c2\u8003","text":"<ul> <li>AWK Tutorial</li> <li>The GNU Awk User's Guide</li> </ul> <p>\u672c\u6587\u5c06\u4f1a\u6301\u7eed\u4fee\u6b63\u548c\u66f4\u65b0\uff0c\u6700\u65b0\u5185\u5bb9\u8bf7\u53c2\u8003\u6211\u7684 GITHUB \u4e0a\u7684 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6b22\u8fce Star\u3002</p>"},{"location":"centos-network-device-naming/","title":"centos-network-device-naming","text":"<p>\u8f6c\u81ea: https://www.cnblogs.com/zyd112/p/8143464.html</p>"},{"location":"centos-network-device-naming/#centos7","title":"centos7\u4e2d\u7684\u7f51\u5361\u4e00\u81f4\u6027\u547d\u540d\u89c4\u5219\u3001\u7f51\u5361\u91cd\u547d\u540d\u65b9\u6cd5","text":"<p>\u4e00\u81f4\u6027\u7f51\u7edc\u8bbe\u5907\u547d\u540d(Consistent Network Device Naming)</p> <p>\u80cc\u666f\u4ecb\u7ecd\uff1a</p> <p>\u5728centos5\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4e60\u60ef\u4e86eth0\u8fd9\u6837\u7684\u7f51\u7edc\u8bbe\u5907\u547d\u540d\uff0c\u5728centos6\u53d1\u73b0\u7f51\u7edc\u8bbe\u5907\u53d8\u6210\u4e86em1\u8fd9\u6837\u7684\u547d\u540d\u3002 \u90a3\u65f6\u6211\u4eec\u5728\u5b89\u88c5\u7684\u65f6\u5019\uff0c\u7ed9\u542f\u52a8\u53c2\u6570\u52a0\u4e0a biosdevname=0\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528eth0\u8fd9\u6837\u7684\u547d\u540d\u3002 \u5347\u7ea7\u5230centos7\u540e\uff0c\u53d1\u73b0\u539f\u6709\u7684\u53c2\u6570biosdevname=0\u4e0d\u8d77\u4f5c\u7528\u4e86\uff0c\u7f51\u7edc\u8bbe\u5907\u53d8\u6210\u4e86eno1\u8fd9\u6837\u7684\u540d\u79f0\u3002 centos7\u8fd9\u79cd\u53d8\u5316\u7684\u539f\u56e0\u662f\u7531\u4e8esystemd\u548cudev\u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u7f51\u7edc\u8bbe\u5907\u547d\u540d\u65b9\u5f0f\uff1a\u4e00\u81f4\u7f51\u7edc\u8bbe\u5907\u547d\u540d\uff08CONSISTENT NETWORK DEVICE NAMING\uff09\u3002</p>"},{"location":"centos-network-device-naming/#_1","title":"\u4e00\u3001\u4e3a\u4ec0\u4e48\u9700\u8981\u8fd9\u4e2a","text":"<p>\u670d\u52a1\u5668\u901a\u5e38\u6709\u591a\u5757\u7f51\u5361\uff0c\u6709\u677f\u8f7d\u96c6\u6210\u7684\uff0c\u540c\u65f6\u4e5f\u6709\u63d2\u5728PCIe\u63d2\u69fd\u7684\u3002 Linux\u7cfb\u7edf\u7684\u547d\u540d\u539f\u6765\u662feth0,eth1\u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u4f46\u662f\u8fd9\u4e2a\u7f16\u53f7\u5f80\u5f80\u4e0d\u4e00\u5b9a\u51c6\u786e\u5bf9\u5e94\u7f51\u5361\u63a5\u53e3\u7684\u7269\u7406\u987a\u5e8f\u3002 \u4e3a\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898,dell\u5f00\u53d1\u4e86biosdevname\u65b9\u6848(systemd v197\u7248\u672c\u4e2d\u5c06dell\u7684\u65b9\u6848\u4f5c\u4e86\u8fdb\u4e00\u6b65\u7684\u4e00\u822c\u5316\u62d3\u5c55)\u3002  </p> <p>\u76ee\u524d\u7684Centos\u65e2\u652f\u6301dell\u7684biosdevname\uff0c\u4e5f\u652f\u6301systemd\u7684\u65b9\u6848\u3002</p>"},{"location":"centos-network-device-naming/#centos7_1","title":"\u4e8c\u3001Centos7\u4e2d\u7684\u547d\u540d\u7b56\u7565","text":"<pre><code>Scheme 1: \u5982\u679c\u4eceBIOS\u4e2d\u80fd\u591f\u53d6\u5230\u53ef\u7528\u7684\uff0c\u677f\u8f7d\u7f51\u5361\u7684\u7d22\u5f15\u53f7\uff0c\u5219\u4f7f\u7528\u8fd9\u4e2a\u7d22\u5f15\u53f7\u547d\u540d\uff0c\u4f8b\u5982: eno1\uff0c\u5982\u4e0d\u80fd\u5219\u5c1d\u8bd5Scheme 2\nScheme 2: \u5982\u679c\u4eceBIOS\u4e2d\u80fd\u591f\u53d6\u5230\u53ef\u4ee5\u7528\u7684\uff0c\u7f51\u5361\u6240\u5728\u7684PCI-E\u70ed\u63d2\u62d4\u63d2\u69fd\u7684\u7d22\u5f15\u53f7\uff0c\u5219\u4f7f\u7528\u8fd9\u4e2a\u7d22\u5f15\u53f7\u547d\u540d\uff0c\u4f8b\u5982: ens1\uff0c\u5982\u4e0d\u80fd\u5219\u5c1d\u8bd5Scheme 3\nScheme 3: \u5982\u679c\u80fd\u62ff\u5230\u8bbe\u5907\u6240\u8fde\u63a5\u7684\u7269\u7406\u4f4d\u7f6e\u4fe1\u606f\uff0c\u5219\u4f7f\u7528\u8fd9\u4e2a\u4fe1\u606f\u547d\u540d\uff0c\u4f8b\u5982:enp2s0\uff0c\u5982\u4e0d\u80fd\u5219\u5c1d\u8bd5Scheme 5\nScheme 4: \u4f7f\u7528\u7f51\u5361\u7684MAC\u5730\u5740\u6765\u547d\u540d\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e00\u822c\u4e0d\u4f7f\u7528\u3002\nScheme 5\uff1a\u4f20\u7edf\u7684kernel\u547d\u540d\u65b9\u6cd5\uff0c\u4f8b\u5982: eth0\uff0c\u8fd9\u79cd\u547d\u540d\u65b9\u6cd5\u7684\u7ed3\u679c\u4e0d\u53ef\u9884\u77e5\u7684\uff0c\u5373\u53ef\u80fd\u7b2c\u4e8c\u5757\u7f51\u5361\u5bf9\u5e94eth0\uff0c\u7b2c\u4e00\u5757\u7f51\u5361\u5bf9\u5e94eth1\u3002\n</code></pre>"},{"location":"centos-network-device-naming/#biosdevnamenetifnames","title":"\u4e09\u3001biosdevname\u548cnet.ifnames\u4e24\u79cd\u547d\u540d\u89c4\u8303","text":"<p>net.ifnames\u547d\u540d\u89c4\u8303\u4e3a:\u8bbe\u5907\u7c7b\u578b+\u8bbe\u5907\u4f4d\u7f6e+\u6570\u5b57</p> <p></p> <p>\u8bbe\u5907\u7c7b\u578b\uff1a   - en \u8868\u793aEthernet   - wl \u8868\u793aWLAN   - ww \u8868\u793a\u65e0\u7ebf\u5e7f\u57df\u7f51WWAN</p> <p>\u5b9e\u9645\u7684\u4f8b\u5b50:   - eno1 \u677f\u8f7d\u7f51\u5361   - enp0s2  pci\u7f51\u5361   - ens33   pci\u7f51\u5361   - wlp3s0  PCI\u65e0\u7ebf\u7f51\u5361   - wwp0s29f7u2i2   4G modem   - wlp0s2f1u4u1   \u8fde\u63a5\u5728USB Hub\u4e0a\u7684\u65e0\u7ebf\u7f51\u5361   - enx78e7d1ea46da pci\u7f51\u5361</p> <p>biosdevname\u7684\u547d\u540d\u89c4\u8303\u4e3a:</p> <p></p> <p>\u5b9e\u9645\u7684\u4f8b\u5b50:   - em1 \u677f\u8f7d\u7f51\u5361   - p3p4 pci\u7f51\u5361   - p3p4_1 \u865a\u62df\u7f51\u5361</p>"},{"location":"centos-network-device-naming/#systemd","title":"\u56db\u3001systemd\u4e2d\u7684\u5b9e\u9645\u6267\u884c\u987a\u5e8f","text":"<p>\u6309\u7167\u5982\u4e0b\u987a\u5e8f\u6267\u884cudev\u7684rule</p> <ol> <li><code>/usr/lib/udev/rules.d/60-net.rules</code></li> <li><code>/usr/lib/udev/rules.d/71-biosdevname.rules</code></li> <li><code>/lib/udev/rules.d/75-net-description.rules</code></li> <li> <p><code>/usr/lib/udev/rules.d/80-net-name-slot.rules</code></p> </li> <li> <p>60-net.rules  \u4f7f\u7528/lib/udev/rename_device\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u53bb\u67e5\u8be2/etc/sysconfig/network-scripts/\u4e0b\u6240\u6709\u4ee5ifcfg-\u5f00\u5934\u7684\u6587\u4ef6 \u5982\u679c\u5728ifcfg-xx\u4e2d\u5339\u914d\u5230HWADDR=xx:xx:xx:xx:xx:xx\u53c2\u6570\u7684\u7f51\u5361\u63a5\u53e3 \u5219\u9009\u53d6DEVICE=yyyy\u4e2d\u8bbe\u7f6e\u7684\u540d\u5b57\u4f5c\u4e3a\u7f51\u5361\u540d\u79f0\u3002  </p> </li> <li> <p>71-biosdevname.rules \u5982\u679c\u7cfb\u7edf\u4e2d\u5b89\u88c5\u4e86biosdevname\uff0c\u4e14\u5185\u6838\u53c2\u6570\u672a\u6307\u5b9abiosdevname=0\uff0c\u4e14\u4e0a\u4e00\u6b65\u6ca1\u6709\u91cd\u547d\u540d\u7f51\u5361\uff0c\u5219\u6309\u7167biosdevname\u7684\u547d\u540d\u89c4\u8303\uff0c\u4eceBIOS\u4e2d\u53d6\u76f8\u5173\u4fe1\u606f\u6765\u547d\u540d\u7f51\u5361\u3002 \u4e3b\u8981\u662f\u53d6SMBIOS\u4e2d\u7684type 9 (System Slot) \u548c type 41 (Onboard Devices Extended Information) \u4e0d\u8fc7\u8981\u6c42SMBIOS\u7684\u7248\u672c\u8981\u9ad8\u4e8e2.6\uff0c\u4e14\u7cfb\u7edf\u4e2d\u8981\u5b89\u88c5biosdevname\u7a0b\u5e8f\u3002  </p> </li> <li> <p>75-net-description.rules udev\u901a\u8fc7\u68c0\u67e5\u7f51\u5361\u4fe1\u606f\uff0c\u586b\u5199\u5982\u4e0b\u8fd9\u4e9budev\u7684\u5c5e\u6027\u503c  </p> </li> <li> <p>ID_NET_NAME_ONBOARD</p> </li> <li>ID_NET_NAME_SLOT</li> <li>ID_NET_NAME_PATH</li> <li> <p>ID_NET_NAME_MAC</p> </li> <li> <p>80-net-name-slot.rules \u5982\u679c\u572860-net.rules \uff0c71-biosdevname.rules\u8fd9\u4e24\u6761\u89c4\u5219\u4e2d\u6ca1\u6709\u91cd\u547d\u540d\u7f51\u5361\uff0c\u4e14\u5185\u6838\u672a\u6307\u5b9anet.ifnames=0\u53c2\u6570 \u5219udev\u4f9d\u6b21\u5c1d\u8bd5\u4f7f\u7528\u4ee5\u4e0b\u5c5e\u6027\u503c\u6765\u547d\u540d\u7f51\u5361\uff0c\u5982\u679c\u8fd9\u4e9b\u5c5e\u6027\u503c\u90fd\u6ca1\u6709\uff0c\u5219\u7f51\u5361\u4e0d\u4f1a\u88ab\u91cd\u547d\u540d\u3002  </p> </li> <li> <p>ID_NET_NAME_ONBOARD</p> </li> <li>ID_NET_NAME_SLOT</li> <li>ID_NET_NAME_PATH</li> </ol> <p>\u4e0a\u8fb9\u768471-biosdevname.rules \u662f\u5b9e\u9645\u6267\u884cbiosdevname\u7684policy 75-net-description.rules\u548c80-net-name-slot.rules\u5b9e\u9645\u6267\u884cScheme 1,2,3  </p> <p>\u6839\u636e\u4e0a\u8ff0\u7684\u8fc7\u7a0b\uff0c\u53ef\u89c1\u7f51\u5361\u547d\u540d\u53d7 biosdevname\u548cnet.ifnames\u8fd9\u4e24\u4e2a\u5185\u6838\u53c2\u6570\u5f71\u54cd\u3002</p>"},{"location":"centos-network-device-naming/#biosdevnamenetifnames_1","title":"\u4e94\u3001biosdevname/net.ifnames\u5e94\u7528","text":"<p>\u8fd9\u4e24\u4e2a\u53c2\u6570\u90fd\u53ef\u4ee5\u5728grub\u914d\u7f6e\u4e2d\u63d0\u4f9b\uff0cbiosdevname=0\u662f\u7cfb\u7edf\u9ed8\u8ba4\u503c\uff08dell\u670d\u52a1\u5668\u9ed8\u8ba4\u662f1\uff09\uff0cnet.ifnames=1\u662f\u7cfb\u7edf\u9ed8\u8ba4\u503c\u3002</p> <pre><code>#vi /boot/grub/grub.conf\nkernel /boot/vmlinuz biosdevname=1\ninitrd /boot/initrd.img\n</code></pre> <p>\u7b2c\u4e8c\u8282\u6240\u8bf4\u7684Scheme\u7684\u7b56\u7565\u987a\u5e8f\u662f\u7cfb\u7edf\u9ed8\u8ba4\u7684\u3002 \u5982\u7cfb\u7edfBIOS\u7b26\u5408\u8981\u6c42\uff0c\u4e14\u7cfb\u7edf\u4e2d\u5b89\u88c5\u4e86biosdevname\uff0c\u4e14biosdevname=1\u542f\u7528\uff0c\u5219biosdevname\u4f18\u5148\uff1b \u5982\u679cBIOS\u4e0d\u7b26\u5408biosdevname\u8981\u6c42\u6216biosdevname=0\uff0c\u5219\u4ecd\u7136\u662fsystemd\u7684\u89c4\u5219\u4f18\u5148\u3002 \u5982\u679c\u7528\u6237\u81ea\u5df1\u5b9a\u4e49\u4e86udev rule\u6765\u4fee\u6539\u5185\u6838\u8bbe\u5907\u540d\u5b57\uff0c\u5219\u7528\u6237\u89c4\u5219\u4f18\u5148\u3002  </p> <p>\u5185\u6838\u53c2\u6570\u7ec4\u5408\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u5176\u7ed3\u679c\u5982\u4e0b\uff1a \u9ed8\u8ba4\u5185\u6838\u53c2\u6570(biosdevname=0\uff0cnet.ifnames=1):  \u7f51\u5361\u540d \"enp5s2\" biosdevname=1\uff0cnet.ifnames=0\uff1a\u7f51\u5361\u540d \"em1\" biosdevname=0\uff0cnet.ifnames=0\uff1a\u7f51\u5361\u540d \"eth0\" (\u6700\u4f20\u7edf\u7684\u65b9\u5f0f,eth0 eth1 \u50bb\u50bb\u5206\u4e0d\u6e05)  </p>"},{"location":"centos-network-device-naming/#centos7ethx","title":"\u516d\u3001centos7\u7f51\u5361\u91cd\u547d\u540d\u4e3aethx\u683c\u5f0f","text":"<p>\u5982\u679c\u4f60\u5e0c\u671b\u7ee7\u7eed\u4f7f\u7528 eth0 \u8fd9\u6837\u7684\u4f20\u7edf\u540d\u79f0\uff0c\u90a3\u4e48\u5728\u5b89\u88c5\u542f\u52a8\uff08pxe\uff09\u65f6\u52a0\u4e0a\u53c2\u6570\uff1a net.ifnames=0 biosdevname=0</p> <p>cobbler profile \u4fee\u6539\u65b9\u6cd5\uff1a</p> <p><code>cobbler profile edit --name=Centos-7.3-x86_64 --kopts='net.ifnames=0 biosdevname=0'</code></p> <p>\u5982\u679c\u4f60\u5df2\u7ecf\u5b89\u88c5\u5b8c\u4e86\uff0c\u5e0c\u671b\u6539\u6210eth0\u8fd9\u6837\u7684\u540d\u79f0\uff0c\u90a3\u4e48\u6267\u884c\u5982\u4e0b\u64cd\u4f5c\u9700\u8981\uff1a</p> <p>1.\u4fee\u6539grub2\u542f\u52a8\u53c2\u6570\uff0c\u5728GRUB_CMDLINE_LINUX\u7684\u4e2d\u52a0\u4e0a\"net.ifnames=0 biosdevname=0\"\u7684\u53c2\u6570</p> <pre><code>vi /etc/sysconfig/grub\nGRUB_CMDLINE_LINUX=\u201drd.lvm.lv=vg0/swap vconsole.keymap=us crashkernel=auto vconsole.font=latarcyrheb-sun16 net.ifnames=0 biosdevname=0 rd.lvm.lv=vg0/usr rhgb quiet\u201d\n</code></pre> <p>2.\u91cd\u65b0\u52a0\u8f7d\u5230\u542f\u52a8\u4e2d</p> <p><code>grub2-mkconfig -o /boot/grub2/grub.cfg</code></p> <p>3.\u91cd\u65b0\u5bf9\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u547d\u540d\uff08\u7f51\u5361\u6587\u4ef6\u5168\u90e8\u91cd\u547d\u540d\uff0c\u987a\u4fbf\u4fee\u6539\u914d\u7f6e\u6587\u4ef6NAME\u3001DEVICE\u7684\u540d\u79f0\uff09</p> <p><code>mv /etc/sysconfig/network-scripts/ifcfg-enp0s3 /etc/sysconfig/network-scripts/ifcfg-eth0</code></p> <p>4.reboot\u91cd\u542f\u751f\u6548</p> <p>\u53c2\u8003\u6587\u6863\uff1a - https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Networking_Guide/ch-Consistent_Network_Device_Naming.html - https://bugzilla.redhat.com/show_bug.cgi?id=965718</p> <p>\u6709\u4ec0\u4e48\u95ee\u9898\u5c3d\u7ba1\u8bf4\uff0c\u53cd\u6b63\u6211\u4e5f\u4e0d\u4f1a\u5e2e\u4f60\u7684</p> <p>\u8f6c\u81ea: https://blog.csdn.net/maomao5945/article/details/79354204</p> <p>\u4ececentos7\u5f00\u59cb\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u7f51\u5361\u547d\u540d\u6709\u5df2\u7ecf\u4e0d\u662f\u6211\u4eec\u719f\u6089\u7684ethX\u65b9\u5f0f\u4e86\uff0c\u7ec6\u5fc3\u7684\u540c\u5b66\u4f1a\u7559\u610f\u5230\u4e00\u4e9b\u6bd4\u5982ens enp\u7b49\u5f00\u5934\u7684\u7f51\u5361\u540d\u79f0\uff0c\u7b80\u5355\u4e86\u89e3\uff0c\u53ef\u4ee5\u89e3\u91ca\u4e3acentos7\u5f00\u59cb\uff0c\u7f51\u5361\u547d\u540d\u4f1a\u6839\u636e\u7f51\u5361\u7684\u786c\u4ef6\u4fe1\u606f\uff0c\u63d2\u69fd\u4f4d\u7f6e\u7b49\u6709\u5173\uff1b</p> <p>\u800c\u7f51\u4e0a\u4e5f\u6709\u4e3a\u90a3\u4e9b\u4f9d\u7136\u60f3\u4f7f\u7528ethX\u65b9\u5f0f\u547d\u540d\u7684\u63d0\u4f9b\u4e86\u7b56\u7565\u3002\u6bd4\u5982\u5728\u5185\u6838\u542f\u52a8\u53c2\u6570\u91cc\u589e\u52a0biosdevname=0 net.ifnames=0\uff1b</p> <p>\u4f46\u662f\u8fd9\u91cc\u5ffd\u7565\u4e86 \u4e00\u4e2a\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u4e3a\u4ec0\u4e48centos7\u4e0d\u518d\u4f7f\u7528\u4ee5\u524d\u7684ethX\u65b9\u5f0f\uff1f\u6839\u672c\u662f\u56e0\u4e3a\u4e4b\u524dethX\u65b9\u5f0f\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u6bcf\u6b21\u542f\u52a8\u53ef\u80fd\u90fd\u4e0d\u540c\uff08\u5982\u679c\u6ca1\u6709\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u5361\u540d\u79f0\u7684\u524d\u63d0\u4e0b\uff09\uff1b</p> <p>\u6240\u4ee5\u5927\u5bb6\u63d0\u4f9b\u7684\u8fd9\u79cd\u529e\u6cd5\u5176\u5b9e\u662f\u4e0d\u597d\u7684\uff1b</p> <p>\u89e3\u91ca\u5b8c\u4e0a\u9762\u5185\u5bb9\u4e4b\u540e\uff0c\u54b1\u4eec\u6765\u770b\u4e0b\u5230\u5e95\u7f51\u5361\u540d\u79f0\u662f\u5982\u4f55\u547d\u540d\u7684\u3002</p> <p>\u6838\u5fc3\u6d41\u7a0b\uff1a\u660e\u786e\u4e00\u70b9\u662f\uff0clinux\u5185\u6838\u542f\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u9ed8\u8ba4\u7ed9\u7f51\u5361\u4ee5ethX\u65b9\u5f0f\u968f\u673a\u547d\u540d\uff0c\u7136\u540e\u518d\u901a\u8fc7systemd\u53bbrename\u6210\u5176\u4ed6\u540d\u79f0\u3002\u5173\u952e\u5b57\uff0crename!</p>"},{"location":"centos-network-device-naming/#rename","title":"\u4e00\u3001\u5982\u4f55rename\uff1f","text":""},{"location":"centos-network-device-naming/#rename_1","title":"\u9ed8\u8ba4rename\u6d41\u7a0b\uff1a","text":"<ul> <li> <p>step1 \u4f9d\u636e/usr/lib/udev/rules.d/60-net.rules\uff0c \u67e5\u770b\u662f\u5426\u6709ifcfg-xx\u914d\u7f6e\u6587\u4ef6\uff08\u8def\u5f84\u5728/etc/sysconfig/network-scripts/),\u662f\u5426\u6709\u5b9a\u4e49\u4e86\u6307\u5b9aMAC\u5730\u5740\u7684\u914d\u7f6e\u6587\u4ef6\uff08ifcfg-xx \uff0cxx\u5fc5\u987b\u548c\u914d\u7f6e\u6587\u4ef6\u7684\u5185\u5bb9DEVICE\u4e00\u81f4\uff09\uff0c\u5982\u679c\u6709\uff0c\u5219\u547d\u540d\u6539\u7f51\u5361\uff1b</p> </li> <li> <p>step2 \u4f9d\u636e/usr/lib/udev/rules.d/71-biosdevname.rules\uff0c\u5982\u679cbiosdevname\u4f7f\u80fd\u4e86\uff08\u5b89\u88c5\u4e86biosdevname\u8fd9\u4e2a\u5305\uff0c\u4e14\u5185\u6838\u542f\u52a8\u53c2\u6570\u663e\u5f0f\u8bbe\u7f6e\u4e3a1\uff09\uff0c\u4e14\u7f51\u5361\u6ca1\u6709\u5728step1\u4e2d\u5b9a\u4e49\uff0c\u5219\u6309\u7167biosdevname\u547d\u540d\u89c4\u5219rename\u7f51\u5361\uff1b\uff08\u6ce8\u610f\uff0c\u5982\u679c\u6ca1\u6709\u5b89\u88c5biosdevname\u8fd9\u4e2a\u5305\uff0c\u5c31\u6ca1\u6709\u8fd9\u4e2a\u6587\u4ef6\uff09</p> </li> <li>step3, \u4f9d\u636e/lib/udev/rules.d/75-net-description.rules\uff0c\u5c06udev\u5de5\u5177\u4f1a\u6839\u636edevice\u5c5e\u6027\u5c06\u586b\u5199\u7f51\u5361\u7684\u5c5e\u6027\u547d\u540d\uff0c\u53ef\u80fd\u4e00\u4e2a\u7f51\u5361\u4f1a\u6709\u591a\u4e2a\u7ef4\u5ea6\u7684\u540d\u79f0\u54e6\uff1b</li> <li>step4\uff0cudev \u6839\u636estep3\u4e2d\u7684\u8d4b\u503c\uff0c\u6309\u7167\u6307\u5b9a\u7684scheme\u89c4\u5219\uff0c\u53bb\u7ed9\u5728step1 step2\u4e2d\u6ca1\u6709\u547d\u540d\u7684\u7f51\u5361\u547d\u540d\uff1b \u00a0 \u00a0 \u5f3a\u8c03\uff1a\u8fd9\u4e2astep\u987a\u5e8f\u662f\u5728\u6211\u4eec\u6ca1\u6709\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684rules\u7684\u524d\u63d0\u4e0b\uff0c\u5982\u679c\u7528\u6237\u81ea\u5b9a\u4e49\u4e86\u81ea\u5df1\u7684rules\uff0c\u5219\u7528\u6237\u81ea\u5b9a\u4e49\u4e3a\u4f18\u5148\u7ea7\u6700\u9ad8\uff1b</li> </ul>"},{"location":"centos-network-device-naming/#scheme","title":"\u4e8c\u3001scheme\u6b21\u5e8f","text":""},{"location":"centos-network-device-naming/#step4scheme","title":"\u4e0a\u9762step4\u4e2d\u63d0\u5230\uff0c\u6309\u7167\u6307\u5b9a\u7684scheme\u89c4\u5219\uff0c\u8fd9\u4e2a\u89c4\u5219\u662f\u4ec0\u4e48\u5462\uff1f","text":"<ul> <li>\u9996\u5148\u8bf4step3\u4e2d\uff0c\u63d0\u5230\u6309\u7167\u7f51\u5361\u7684\u4e0d\u540c\u5c5e\u6027\u547d\u540d\uff0c\u7cfb\u7edf\u8bc6\u522b\u7f51\u5361\u6709\u597d\u51e0\u79cd\u7ef4\u5ea6\uff1a\u00a0\u00a0</li> <li>\u6bd4\u5982\u00a0BIOS provided index numbers for on-board devices (example:\u00a0eno1),</li> <li>\u6bd4\u5982\uff1aBIOS provided PCI Express hotplug slot index numbers (example:\u00a0ens1)\u00a0</li> <li>\u6bd4\u5982\uff1aphysical location of the connector of the hardware (example:\u00a0enp2s0),\u00a0</li> <li>\u6bd4\u5982\uff1amac\u5730\u5740</li> <li>\u540c\u4e00\u4e2a\u7f51\u5361\u901a\u5e38\u540c\u65f6\u5177\u6709\u591a\u4e2a\u7ef4\u5ea6\u7684\u540d\u79f0\uff0csystemd\u5728\u9009\u53d6\u7684\u65f6\u5019\uff0c\u6309\u7167\u6709\u5148\u540e\u6b21\u5e8f\uff0c\u4f7f\u7528\u5148\u547d\u4e2d\u7684\uff1b</li> <li>\u987a\u5e8f\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\uff08eno1-ens1-enp1\uff09</li> </ul> <ul> <li>eth2\u8fd9\u4e2a\u7f51\u5361\uff0cscheme\u540d\u79f0\u67093\u4e2a\uff0c\u5982\u679csystemd\u81ea\u9009\uff0c\u4f1a\u4f7f\u7528\u54ea\u4e2a\uff1fens5f0.(\u90a3\u8fd9\u4e2a\u4e3a\u4ec0\u4e48\u662f/sys/class/net/eth2 \u800c\u4e0d\u662f/sys/class/net/ens5f0 \uff0c\u90a3\u662f\u56e0\u4e3a\u81ea\u5b9a\u4e49\u7684\u7f18\u6545\uff1b)</li> </ul>"},{"location":"centos-network-device-naming/#_2","title":"\u4e09\u3001\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u5361\u540d\u79f0","text":"<ul> <li> <p>1\u3001\u5728\u7528\u6237\u6ca1\u6709\u81ea\u5b9a\u4e49rules\u6587\u4ef6\u524d\u63d0\u4e0b\uff0cstep1\u4e2d\u7684\u7f51\u5361\u547d\u540d\u65b9\u5f0f\u4e5f\u53ef\u8ba4\u4e3a\u662f \u4e00\u79cd\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u7f51\u5361\u547d\u540d\uff0c\u5373\u5728/etc/sysconfig/network-scripts/ifcfg-xx \u6587\u4ef6\uff0cxx\u5c31\u662f\u8fd9\u4e2a\u7f51\u5361\u540d\u79f0\uff0c\u6587\u4ef6\u5185\u5bb9\u4e2d\u4f53\u73b0MAC_ADDRESS\u3001NAME\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5219\u4f1a\u6309\u7167\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u540d\u79f0\u6765\u547d\u540d\u7f51\u5361\uff1b</p> </li> <li> <p>2\u3001\u5982\u679c\u7528\u6237\u81ea\u5b9a\u4e49\u4e86rules\u6587\u4ef6\uff0c\u653e\u5728/etc/udev/rules.d/\u76ee\u5f55\u4e0b\uff0c\u5219\u8fd9\u4e2a\u4f18\u5148\u7ea7\u662f\u6700\u9ad8\u7684\uff1b\u6bd41\u4e2difcfg-xx\u65b9\u5f0f\u4f18\u5148\u7ea7\u66f4\u9ad8\uff0c\u4f46\u662f\u5982\u679c\u4e24\u8005\u4e0d\u4e00\u81f4\uff0c\u5219\u5728\u91cd\u542fnetwork\u670d\u52a1\u65f6\uff0c\u4f1a\u4f9d\u636eifcfg-xx\uff0c\u6240\u4ee5\u7528\u6237\u4e0d\u5e94\u8be5\u540c\u65f6\u91c7\u7528\u91cc\u4e24\u79cd\u65b9\u5f0f\u7ed9\u540c\u4e00\u4e2a\u7f51\u5361\u547d\u4e0d\u540c\u7684\u540d\u79f0\uff1b</p> </li> </ul>"},{"location":"centos-network-device-naming/#biosdevnanenetifnames","title":"\u56db\u3001\u5185\u6838\u542f\u52a8\u53c2\u6570biosdevnane\u3001net.ifnames","text":"<p>\u9ed8\u8ba4\u5c31\u662f\u5185\u6838\u542f\u52a8\u53c2\u6570\u6ca1\u6709biosdevname \u4e5f\u6ca1\u6709net.ifnames \u53c2\u6570\uff08\u5176\u5b9e\u9ed8\u8ba4\u662fnet.ifnames=1,biosdevname=0\uff09\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5c31\u6309\u7167\u4e00 \u4e2d\u8fdb\u884c\u7f51\u5361\u547d\u540d\uff1beno-ens-enp\u7684\u65b9\u5f0f\u9010\u4e2a\u5339\u914d\u3002\u4f46\u662f\u5982\u679c\u4f7f\u80fd\u4e86biosdevname.\u5219\u4f1a\u4f7f\u7528biosdevname\u7684\u547d\u540d step1\u6ca1\u6709\u547d\u540d\u7684\u7f51\u5361\uff1b</p>"},{"location":"centos-network-device-naming/#bios","title":"bios\u547d\u540d\u89c4\u5219\uff1a","text":"<ul> <li>\u8981\u4e48\u662fem\u5f00\u5934\uff0c\u8981\u4e48\u662fp\u5f00\u5934\uff1b</li> <li>\u600e\u4e48\u6837\u4f7f\u80fdbiosdevname\u5462\uff1f2\u4e2a\u6761\u4ef6\uff0c\u5b89\u88c5biosdevname\u5305\uff0c\u4e14\u5728\u5185\u6838\u542f\u52a8\u53c2\u6570\u4e2d\u660e\u786e biosdevname=1. \u5426\u5219\u4f7f\u80fd\u4e0d\u4e86\uff1b</li> <li>\u4f46\u662f\u4e0d\u7ba1\u600e\u4e48\u6837\uff0c\u5982\u679c\u7528\u6237\u81ea\u5b9a\u4e49\u4e86udev rules\uff0c\u5219\u7528\u6237\u81ea\u5b9a\u4e49\u7684rules\u4f18\u5148\uff01</li> <li>\u8fd9\u662f\u603b\u8ff0\uff0c\u4f46\u51e1\u7528\u6237\u81ea\u5b9a\u4e49rules\uff0c\u4f18\u5148\u7ea7\u6700\u9ad8\uff1b</li> </ul>"},{"location":"centos-network-device-naming/#netifname","title":"\u5185\u6838\u542f\u52a8\u53c2\u6570net.ifname,","text":"<p>\u5982\u679c\u5728\u542f\u52a8\u53c2\u6570\u4e2d\u589e\u52a0net.ifname=0\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5728/lib/udev/rule.d/80-net-name-slot.rules\u4f53\u73b0\u4f7f\u7528\u4ef7\u503c\uff0c\u5219\u544a\u8bc9\u7cfb\u7edf\u4e0d\u7528scheme\u7684\u65b9\u5f0f\u6765\u547d\u540d\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u4f1a\u6062\u590dethx\u8fd9\u79cd\u4e0d\u786e\u5b9a\u6027\u7684\u547d\u540d\u65b9\u5f0f\uff1b</p>"},{"location":"centos-network-device-naming/#ethx","title":"\u4e94\u3001 \u4e0d\u8981\u7528ethX\u53bb\u547d\u540d","text":"<p>\u5185\u6838\u5728boot \u8fc7\u7a0b\u662f\u9ed8\u8ba4\u4f7f\u7528ethX\u65b9\u5f0f\u6765\u547d\u540d\u7684\uff0c\u6bcf\u6b21\u542f\u52a8\u7684\u65f6\u5019\u90fd\u4e0d\u786e\u5b9a\uff0c\u542f\u52a8\u4f1a\u540e\u518d\u901a\u8fc7udev\u7b49\u65b9\u5f0f\u53bbrename,</p> <p>\u53c2\u8003\u6587\u6863\uff1a https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/sec-troubleshooting_network_device_naming \u00a0 \u00a0</p>"},{"location":"centos7-set-kernel/","title":"centos7-set-kernel","text":"<p>CentOS 7\u3067\u30ab\u30fc\u30cd\u30eb\u3092\u30d3\u30eb\u30c9\u3059\u308b\u6a5f\u4f1a\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ab\u30fc\u30cd\u30eb\u3092\u5909\u66f4\u3059\u308b\u65b9\u6cd5\u3092\u30e1\u30e2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u3067grub.cfg\u3092\u7de8\u96c6\u3059\u308b\u3082\u306e\u3060\u3068\u3059\u3063\u304b\u308a\u601d\u3044\u8fbc\u3093\u3067\u305f\u306e\u3067\u3057\u3070\u3089\u304fgrub.cfg\u3092\u3058\u30fc\u30fc\u3063\u3068\u773a\u3081\u3066\u305f\u306e\u3067\u3059\u304c\u3001\u8abf\u3079\u3066\u307f\u305f\u3068\u3053\u308d\u6e96\u5099\u3055\u308c\u3066\u3044\u308bgrub2-set-default\u30b3\u30de\u30f3\u30c9\u3067\u5909\u66f4\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"centos7-set-kernel/#_1","title":"\u73fe\u5728\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3092\u8abf\u3079\u308b","text":"<pre><code>[root@backup ~]# grub2-editenv list\nsaved_entry=CentOS Linux (3.10.0-693.2.2.el7.x86_64) 7 (Core)\n[root@backup ~]#\n</code></pre>"},{"location":"centos7-set-kernel/#_2","title":"\u30ab\u30fc\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3092\u8868\u793a\u3059\u308b","text":"<pre><code>[root@backup ~]# awk -F\\' '$1==\"menuentry \" {print i++ \" : \" $2}' /etc/grub2.cfg\n0 : CentOS Linux (3.10.0-693.2.2.el7.x86_64) 7 (Core)\n1 : CentOS Linux, with Linux 3.10.0-229.20.1.el7.x86_64\n2 : CentOS Linux, with Linux 3.10.0-123.el7.x86_64\n3 : CentOS Linux, with Linux 0-rescue-1857a64194e64a80a83a91324b8169d5\n[root@backup ~]#\n</code></pre>"},{"location":"centos7-set-kernel/#_3","title":"\u5229\u7528\u3057\u305f\u3044\u30ab\u30fc\u30cd\u30eb\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u306b\u8a2d\u5b9a\u3059\u308b","text":"<p>\u4f8b\u3048\u3070 <code>1 : CentOS Linux, with Linux 3.10.0-229.20.1.el7.x86_64</code> \u306b\u5909\u66f4\u3059\u308b\u5834\u5408\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3067\u3059\u3002</p> <pre><code>[root@backup ~]# grub2-set-default 1\n[root@backup ~]# grub2-editenv list\nsaved_entry=1\n</code></pre>"},{"location":"centos7-set-kernel/#_4","title":"\u518d\u8d77\u52d5\u3057\u3066\u78ba\u8a8d\u3059\u308b","text":""},{"location":"iptables/","title":"iptables","text":""},{"location":"iptables/#iptables","title":"iptables\u8be6\u89e3","text":"<ul> <li>\u539f\u6587</li> </ul>"},{"location":"iptables/#iptables_1","title":"iptables\u6982\u5ff5","text":""},{"location":"linux-lvm/","title":"Linux\u73af\u5883\u4e0b LVM \u903b\u8f91\u5377\u7684\u5efa\u7acb\u3001\u6269\u5bb9\u548c\u51cf\u5bb9\u64cd\u4f5c","text":""},{"location":"linux-lvm/#_1","title":"\u524d\u8a00","text":""},{"location":"linux-lvm/#lvmlogical-volume-managerlinux","title":"LVM\u662f\u903b\u8f91\u76d8\u5377\u7ba1\u7406\uff08Logical Volume Manager\uff09\u7684\u7b80\u79f0\uff0c\u5b83\u662fLinux\u73af\u5883\u4e0b\u5bf9\u78c1\u76d8\u5206\u533a\u8fdb\u884c\u7ba1\u7406\u7684\u4e00\u79cd\u673a\u5236\uff0c","text":"<p>LVM\u662f\u5efa\u7acb\u5728\u786c\u76d8\u548c\u5206\u533a\u4e4b\u4e0a\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c\u6765\u63d0\u9ad8\u78c1\u76d8\u5206LVM\u533a\u7ba1\u7406\u7684\u7075\u6d3b\u6027\u3002 \u524d\u9762\u8c08\u5230\uff0cLVM\u662f\u5728\u78c1\u76d8\u5206\u533a\u548c\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u6dfb\u52a0\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c \u6765\u4e3a\u6587\u4ef6\u7cfb\u7edf\u5c4f\u853d\u4e0b\u5c42\u78c1\u76d8\u5206\u533a\u5e03\u5c40\uff0c\u63d0\u4f9b\u4e00\u4e2a\u62bd\u8c61\u7684\u76d8\u5377\uff0c\u5728\u76d8\u5377\u4e0a\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\u3002 \u7269\u7406\u5377\uff08physical volume\uff09\u7269\u7406\u5377\u5c31\u662f\u6307\u786c\u76d8\u5206\u533a\u6216\u4ece\u903b\u8f91\u4e0a\u4e0e\u78c1\u76d8\u5206\u533a\u5177\u6709\u540c\u6837 \u529f\u80fd\u7684\u8bbe\u5907\uff08\u5982RAID\uff09\uff0c\u662fLVM\u7684\u57fa\u672c\u5b58\u50a8\u903b\u8f91\u5757\uff0c\u4f46\u548c\u57fa\u672c\u7684\u7269\u7406\u5b58\u50a8\u4ecb\u8d28 \uff08\u5982\u5206\u533a\u3001\u78c1\u76d8\u7b49\uff09\u6bd4\u8f83\uff0c\u5374\u5305\u542b\u6709\u4e0eLVM\u76f8\u5173\u7684\u7ba1\u7406\u53c2\u6570\u3002 </p>"},{"location":"linux-lvm/#lvm","title":"LVM\u662f\u5728\u78c1\u76d8\u5206\u533a\u548c\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u6dfb\u52a0\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c","text":"<p>\u6765\u4e3a\u6587\u4ef6\u7cfb\u7edf\u5c4f\u853d\u4e0b\u5c42\u78c1\u76d8\u5206\u533a\u5e03\u5c40\uff0c\u63d0\u4f9b\u4e00\u4e2a\u62bd\u8c61\u7684\u76d8\u5377\uff0c\u5728\u76d8\u5377\u4e0a\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\u3002\u9996\u5148\u6211\u4eec\u8ba8\u8bba\u4ee5\u4e0b\u51e0\u4e2aLVM\u672f\u8bed\uff1a</p> <ul> <li>\u7269\u7406\u5b58\u50a8\u4ecb\u8d28\uff08Thephysicalmedia\uff09</li> <li> <p>\u8fd9\u91cc\u6307\u7cfb\u7edf\u7684\u5b58\u50a8\u8bbe\u5907\uff1a\u786c\u76d8\uff0c\u662f\u5b58\u50a8\u7cfb\u7edf\u6700\u4f4e\u5c42\u7684\u5b58\u50a8\u5355\u5143\u3002</p> </li> <li> <p>\u7269\u7406\u5377\uff08physicalvolume\uff09</p> </li> <li> <p>\u7269\u7406\u5377\u5c31\u662f\u6307\u786c\u76d8\u5206\u533a\u6216\u4ece\u903b\u8f91\u4e0a\u4e0e\u78c1\u76d8\u5206\u533a\u5177\u6709\u540c\u6837\u529f\u80fd\u7684\u8bbe\u5907\uff08\u5982RAID\uff09\uff0c\u662fLVM\u7684\u57fa\u672c\u5b58\u50a8\u903b\u8f91\u5757\uff0c\u4f46\u548c\u57fa\u672c\u7684\u7269\u7406\u5b58\u50a8\u4ecb\u8d28\uff08\u5982\u5206\u533a\u3001\u78c1\u76d8\u7b49\uff09\u6bd4\u8f83\uff0c\u5374\u5305\u542b\u6709\u4e0eLVM\u76f8\u5173\u7684\u7ba1\u7406\u53c2\u6570\u3002</p> </li> <li> <p>\u5377\u7ec4\uff08VolumeGroup\uff09</p> </li> <li> <p>LVM\u5377\u7ec4\u7c7b\u4f3c\u4e8e\u975eLVM\u7cfb\u7edf\u4e2d\u7684\u7269\u7406\u786c\u76d8\uff0c\u5176\u7531\u7269\u7406\u5377\u7ec4\u6210\u3002\u53ef\u4ee5\u5728\u5377\u7ec4\u4e0a\u521b\u5efa\u4e00\u4e2a\u6216\u591a\u4e2a\u201cLVM\u5206\u533a\u201d\uff08\u903b\u8f91\u5377\uff09\uff0cLVM\u5377\u7ec4\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u7269\u7406\u5377\u7ec4\u6210\u3002</p> </li> <li> <p>\u903b\u8f91\u5377\uff08logicalvolume\uff09</p> </li> <li> <p>LVM\u7684\u903b\u8f91\u5377\u7c7b\u4f3c\u4e8e\u975eLVM\u7cfb\u7edf\u4e2d\u7684\u786c\u76d8\u5206\u533a\uff0c\u5728\u903b\u8f91\u5377\u4e4b\u4e0a\u53ef\u4ee5\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\uff08\u6bd4\u5982/home\u6216\u8005/usr\u7b49\uff09\u3002</p> </li> <li> <p>PE\uff08physicalextent\uff09</p> </li> <li> <p>\u6bcf\u4e00\u4e2a\u7269\u7406\u5377\u88ab\u5212\u5206\u4e3a\u79f0\u4e3aPE(PhysicalExtents\uff09\u7684\u57fa\u672c\u5355\u5143\uff0c\u5177\u6709\u552f\u4e00\u7f16\u53f7\u7684PE\u662f\u53ef\u4ee5\u88abLVM\u5bfb\u5740\u7684\u6700\u5c0f\u5355\u5143\u3002PE\u7684\u5927\u5c0f\u662f\u53ef\u914d\u7f6e\u7684\uff0c\u9ed8\u8ba4\u4e3a4MB\u3002</p> </li> <li> <p>LE\uff08logicalextent\uff09</p> </li> <li>\u903b\u8f91\u5377\u4e5f\u88ab\u5212\u5206\u4e3a\u88ab\u79f0\u4e3aLE(LogicalExtents\uff09\u7684\u53ef\u88ab\u5bfb\u5740\u7684\u57fa\u672c\u5355\u4f4d\u3002\u5728\u540c\u4e00\u4e2a\u5377\u7ec4\u4e2d\uff0cLE\u7684\u5927\u5c0f\u548cPE\u662f\u76f8\u540c\u7684\uff0c\u5e76\u4e14\u4e00\u4e00\u5bf9\u5e94\u3002</li> </ul>"},{"location":"linux-lvm/#_2","title":"\u5b9e\u9a8c\u90e8\u5206","text":""},{"location":"linux-lvm/#-","title":"---------\u5efa\u7acb\u903b\u8f91\u5377---------","text":"<ol> <li>\u65b0\u5efa2\u4e2a\u5206\u533a,sda5  5G,sd6 10G,\u5b8c\u6210\u4e4b\u540e\u5982\u4e0b</li> </ol> <pre><code>[root@yangcan /]# fdisk -l\nDisk /dev/sda: 42.9 GB, 42949672960 bytes\n255 heads, 63 sectors/track, 5221 cylinders\nUnits = cylinders of 16065 * 512 = 8225280 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk identifier: 0x000ed173\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sda1   *           1          39      307200   83  Linux\nPartition 1 does not end on cylinder boundary.\n/dev/sda2              39        2167    17091584   83  Linux\n/dev/sda3            2167        2611     3571712   82  Linux swap / Solaris\n/dev/sda4            2611        5221    20966162+   5  Extended\n/dev/sda5            2611        3264     5246528+  83  Linux\n/dev/sda6            3265        4570    10490413+  83  Linux\n</code></pre> <ol> <li>\u628asda6\u521d\u59cb\u5316\u7269\u7406\u5377</li> </ol> <pre><code>[root@yangcan /]# pvcreate /dev/sda6\n  Device vg6 not found (or ignored by filtering).\n  Writing physical volume data to disk \"/dev/sda6\"\n  Physical volume \"/dev/sda6\" successfully created\n</code></pre> <ol> <li>\u521b\u5efa\u5377\u7ec4vg6,PE\u4e3a16M</li> </ol> <pre><code>[root@yangcan /]# vgcreate -s 16M vg6 /dev/sda6\n  Volume group \"vg6\" successfully created\n\n[root@yangcan /]# vgdisplay\n  --- Volume group ---\n  VG Name               vg6\n  System ID\n  Format                lvm2\n  Metadata Areas        1\n  Metadata Sequence No  1\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                0\n  Open LV               0\n  Max PV                0\n  Cur PV                1\n  Act PV                1\n  VG Size               10.00 GiB\n  PE Size               16.00 MiB\n  Total PE              640\n  Alloc PE / Size       0 / 0\n  Free  PE / Size       640 / 10.00 GiB\n  VG UUID               35tmMm-Hyec-i4f1-xkd7-pMRS-RgRl-sqFa7l\n</code></pre> <ol> <li>\u521b\u5efa\u903b\u8f91\u5377ftpdata,\u5927\u5c0f\u4e3a6G</li> </ol> <pre><code>[root@yangcan /]# lvcreate -L 6G -n ftpdata vg6\n  Logical volume \"ftpdata\" created\n\n[root@yangcan /]# lvdisplay\n  --- Logical volume ---\n  LV Name                /dev/vg6/ftpdata\n  VG Name                vg6\n  LV UUID                LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM\n  LV Write Access        read/write\n  LV Status              available\n  # open                 0\n  LV Size                6.00 GiB\n  Current LE             384\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n</code></pre> <ol> <li>\u683c\u5f0f\u5316ext4,\u5e76\u6302\u8f7d,\u5e76cp\u4e00\u4e9b\u6570\u636e\u8fdb\u53bb</li> </ol> <pre><code>[root@yangcan /]# mke2fs -T ext4 /dev/vg6/ftpdata\n[root@yangcan /]# mount /dev/vg6/ftpdata /ftpdata/\n[root@yangcan /]# cd /ftpdata/\n[root@yangcan ftpdata]# cp /etc/*.conf ./\n[root@yangcan ftpdata]# cp /usr/share/dict/linux.words ./\n</code></pre>"},{"location":"linux-lvm/#-_1","title":"--------\u6269\u5bb9--------","text":"<ol> <li>\u65b0\u589e\u4e00\u4e2a\u78c1\u76d8\u5230\u5377\u7ec4vg6,\u5c31\u7528\u5230\u4e4b\u524d\u5269\u4e0b\u7684sda5\u4e86</li> </ol> <pre><code>[root@yangcan ftpdata]# vgextend vg6 /dev/sda5\n  Volume group \"vg6\" successfully extended\n\n[root@yangcan ftpdata]# vgdisplay\n  --- Volume group ---\n  VG Name               vg6\n  System ID\n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  3\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                1\n  Open LV               1\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               15.00 GiB\n  PE Size               16.00 MiB\n  Total PE              960\n  Alloc PE / Size       384 / 6.00 GiB\n  Free  PE / Size       576 / 9.00 GiB\n  VG UUID               35tmMm-Hyec-i4f1-xkd7-pMRS-RgRl-sqFa7l\n</code></pre> <ol> <li>\u6269\u5bb9ftpdata,\u5f53\u6211\u4eec\u6587\u4ef6\u4e0d\u6bb5\u589e\u52a0\u7684\u65f6\u5019,\u6269\u5bb9\u5c31\u5f88\u6709\u5fc5\u8981\u4e86</li> </ol> <pre><code>[root@yangcan ftpdata]# lvextend -L +4G /dev/vg6/ftpdata\n\n\u6216\u8005\u4f7f\u7528,\u5c31\u662f\u60f3\u8ba9\u4f60\u660e\u767d-L \u548c -L +\u7684\u533a\u522b,-L \u540e\u9762\u76f4\u63a5\u52a0\u5bb9\u91cf,\u662f\u6307\u76f4\u63a5\u52a0\u5230\u5bb9\u91cf,\u800c-L +\u5bb9\u91cf,\u662f\u6307\u5728\u539f\u6709\u5bb9\u91cf\u4e0a\u52a0\u591a\u5c11\u5bb9\u91cf!\n\n[root@yangcan ftpdata]# lvextend -L 10G /dev/vg6/ftpdata\n  Extending logical volume ftpdata to 10.00 GiB\n  Logical volume ftpdata successfully resized\n\n[root@yangcan ftpdata]# lvdisplay\n  --- Logical volume ---\n  LV Name                /dev/vg6/ftpdata\n  VG Name                vg6\n  LV UUID                LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM\n  LV Write Access        read/write\n  LV Status              available\n  # open                 1\n  LV Size                10.00 GiB\n  Current LE             640\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n\n[root@yangcan ftpdata]# df -h|grep ftpdata\n/dev/mapper/vg6-ftpdata\n                      6.0G  145M  5.5G   3% /ftpdata\n\n\u6b64\u65f6\u67e5\u770bftpdata\u6587\u4ef6\u7cfb\u7edf\u5bb9\u91cf\u7684\u65f6\u5019,\u8fd8\u662f\u4e4b\u524d\u7684\u5927\u5c0f,\u6240\u4ee5\u9700\u8981resize2fs\n\n[root@yangcan ftpdata]# resize2fs /dev/vg6/ftpdata\nresize2fs 1.41.12 (17-May-2010)\nFilesystem at /dev/vg6/ftpdata is mounted on /ftpdata; on-line resizing required\nold desc_blocks = 1, new_desc_blocks = 1\nPerforming an on-line resize of /dev/vg6/ftpdata to 2621440 (4k) blocks.\nThe filesystem on /dev/vg6/ftpdata is now 2621440 blocks long.\n\n[root@yangcan ftpdata]# df -h|grep ftpdata\n/dev/mapper/vg6-ftpdata\n                      9.9G  147M  9.3G   2% /ftpdata\n\n[root@yangcan ftpdata]# lvdisplay\n  --- Logical volume ---\n  LV Name                /dev/vg6/ftpdata\n  VG Name                vg6\n  LV UUID                LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM\n  LV Write Access        read/write\n  LV Status              available\n  # open                 1\n  LV Size                10.00 GiB\n  Current LE             640\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n\n\u73b0\u5728\u5c31\u6587\u4ef6\u7cfb\u7edf\u548c\u903b\u8f91\u5377\u7a7a\u95f4\u4e00\u81f4\u4e86\n</code></pre>"},{"location":"linux-lvm/#-_2","title":"-----------\u7f29\u5bb9----------","text":"<p>\u6269\u5bb9\u5b9e\u9a8c\u505a\u5b8c\u4e86,\u63a5\u4e0b\u6765\u505a\u7f29\u5bb9,\u7f29\u5bb9\u6bd4\u6269\u5bb9\u590d\u6742,\u5e73\u65f6\u5de5\u4f5c\u4e5f\u4e0d\u80fd\u8f7b\u6613\u7684\u6307\u5b9a\u7f29\u5bb9\u7684\u5927\u5c0f.</p> <pre><code>[root@yangcan ftpdata]# cd ..\n[root@yangcan /]# umount /ftpdata/\n[root@yangcan /]# e2fsck -f /dev/vg6/ftpdata\ne2fsck 1.41.12 (17-May-2010)\nPass 1: Checking inodes, blocks, and sizes\nPass 2: Checking directory structure\nPass 3: Checking directory connectivity\nPass 4: Checking reference counts\nPass 5: Checking group summary information\n/dev/vg6/ftpdata: 41/655360 files (0.0% non-contiguous), 78604/2621440 blocks\n</code></pre> <p>\u6ce8\u610f:\u6211\u4eec\u5927\u6982\u8981\u7f29\u52306G\u5de6\u53f3,\u90a3\u6211\u4eec\u5c31\u4e0d\u80fd\u76f4\u63a5resize2fs \u52306G,\u8fd9\u6837\u80af\u5b9a\u662f\u9519\u8bef\u7684,\u56e0\u4e3aPE\u662f\u53ef\u4ee5\u88abLVM\u5bfb\u5740\u7684\u6700\u5c0f\u5355\u5143,\u672c\u6b21\u5b9e\u9a8cPE\u5927\u5c0f\u4e3a16M.\u6211\u4eec\u53bb\u505a\u7f29\u5bb9\u7684\u65f6\u5019,\u4e0d\u53ef\u80fd\u662f0.6\u4e2aPE.\u6240\u6709\u5c24\u5176\u6ce8\u610f,\u7f51\u4e0a\u5f88\u591a\u8d44\u6599\u5c31\u662f\u76f4\u63a5\u6307\u5b9a\u5927\u5c0f,\u800c\u6ca1\u6709\u505a\u6d4b\u8bd5\u73af\u8282!!!\u4f1a\u9020\u6210\u6570\u636e\u7684\u4e22\u5931,\u6240\u4ee5\u6307\u5b9a\u5927\u5c0f\u65f6,\u5148\u7528lvreduce -t \u6d4b\u8bd5\u4e00\u4e0b.\u7528bc\u7b97\u51fa6G\u7684\u4f4d\u7f6e,\u5230\u5e95\u90a3\u4e2a\u503c\u5408\u9002</p> <pre><code>[root@yangcan /]# bc\nbc 1.06.95\nCopyright 1991-1994, 1997, 1998, 2000, 2004, 2006 Free Software Foundation, Inc.\nThis is free software with ABSOLUTELY NO WARRANTY.\nFor details type `warranty'.\n--6000\u521a\u597d\u6574\u966416\n6000%16\n0\n--6001\u966416\u4e3a1\n6001%16\n1\n5999%16\n15\n--\u521a\u597d6000M,\u53d6\u4f59\u4e3a0,\u6211\u4eec\u6bd4\u8f83\u4e00\u4e0b6001\u548c6000\u7684\u533a\u522b\n\n[root@yangcan /]# lvreduce -L 6001M /dev/vg6/ftpdata -t\n  Test mode: Metadata will NOT be updated and volumes will not be (de)activated.\n  Rounding up size to full physical extent 5.88 GiB\n  WARNING: Reducing active logical volume to 5.88 GiB\n  THIS MAY DESTROY YOUR DATA (filesystem etc.)\nDo you really want to reduce ftpdata? [y/n]: n\n  Logical volume ftpdata NOT reduced\n\u663e\u793a\u4e86\u8b66\u544a\u4fe1\u606f!\n\n[root@yangcan /]# lvreduce -L 6000M /dev/vg6/ftpdata -t\n  Test mode: Metadata will NOT be updated and volumes will not be (de)activated.\n  WARNING: Reducing active logical volume to 5.86 GiB\n  THIS MAY DESTROY YOUR DATA (filesystem etc.)\nDo you really want to reduce ftpdata? [y/n]:\n\n\u63d0\u793a\u4e3a6000M\u662f,\u6ca1\u95ee\u9898\n\u5f53-t \u6d4b\u8bd5\u65f6,\u6ca1\u95ee\u9898\u4e86,\u90a3\u6211\u4eec\u5c31resize2fs\u4e86\n\n[root@yangcan /]# resize2fs /dev/vg6/ftpdata 6000M\nresize2fs 1.41.12 (17-May-2010)\nResizing the filesystem on /dev/vg6/ftpdata to 1536000 (4k) blocks.\nThe filesystem on /dev/vg6/ftpdata is now 1536000 blocks long.\n\u6302\u8f7d,\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u7684\u5927\u5c0f,\u4e3a\u6700\u65b0\u76846000M,\u6570\u636e\u4e5f\u6ca1\u6709\u4e22\u5931!!\n\n[root@yangcan /]# mount -a\n[root@yangcan /]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/sda2              17G  2.1G   14G  14% /\ntmpfs                 504M  264K  504M   1% /dev/shm\n/dev/sda1             291M   31M  246M  11% /boot\n/dev/sr0              2.9G  2.9G     0 100% /media/cdrom\n/dev/mapper/vg6-ftpdata  5.8G  145M  5.4G   3% /ftpdata\n\n\u6211\u4eec\u7528lvdisplay\u67e5\u770b\u4e00\u4e0b\u903b\u8f91\u5377\u7684\u5927\u5c0f\u8fd8\u662f\u4e3a10G\n\n[root@yangcan /]# lvdisplay\n  --- Logical volume ---\n  LV Name                /dev/vg6/ftpdata\n  VG Name                vg6\n  LV UUID                LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM\n  LV Write Access        read/write\n  LV Status              available\n  # open                 1\n  LV Size                10.00 GiB\n  Current LE             640\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n\n\u6240\u4ee5\u6211\u4eec\u7528lvreduce\u8fdb\u884c\u8c03\u6574!\n\n[root@yangcan /]# lvreduce -L 6000M /dev/vg6/ftpdata\n  WARNING: Reducing active and open logical volume to 5.86 GiB\n  THIS MAY DESTROY YOUR DATA (filesystem etc.)\nDo you really want to reduce ftpdata? [y/n]: n\n  Logical volume ftpdata NOT reduced\n\n--\u63d0\u793a\u903b\u8f91\u5377\u6b63\u5728\u6253\u5f00,\u6240\u6709\u6211\u4eec\u9700\u8981\u505c\u6b62\u903b\u8f91\u5377,\u518d\u53bb\u8c03\u6574\u5927\u5c0f\n\n[root@yangcan /]# lvchange -an /dev/vg6/ftpdata\n[root@yangcan /]# lvscan\n  inactive          '/dev/vg6/ftpdata' [10.00 GiB] inherit\n\n[root@yangcan /]# lvreduce -L 6000M /dev/vg6/ftpdata\n  Reducing logical volume ftpdata to 5.86 GiB\n  Logical volume ftpdata successfully resized\n\n[root@yangcan /]# mount -a\nmount: special device /dev/vg6/ftpdata does not exist\n\n--\u5f53\u6211\u4eec\u53bb\u6302\u8f7d\u7684\u65f6\u5019,\u63d0\u793a\u6ca1\u6709\u8fd9\u4e2a\u8bbe\u5907.\u6240\u4ee5\u9700\u8981\u542f\u7528\n\n[root@yangcan /]# lvchange -ay /dev/vg6/ftpdata\n[root@yangcan /]# lvscan\n  ACTIVE            '/dev/vg6/ftpdata' [5.86 GiB] inherit\n\n\u91cd\u65b0\u6302\u8f7d,\u91cc\u9762\u7684\u6587\u4ef6\u8fd8\u5728!\n\n[root@yangcan /]# mount -a\n[root@yangcan /]# cd /ftpdata/\n[root@yangcan ftpdata]# ll\ntotal 4996\n-rw-r--r--. 1 root root     148 Jul 30 19:37 asound.conf\n-rw-r--r--. 1 root root   21214 Jul 30 19:37 dnsmasq.conf\n-rw-r--r--. 1 root root     559 Jul 30 19:37 dracut.conf\n-rw-r--r--. 1 root root      20 Jul 30 19:37 fprintd.conf\n-rw-r--r--. 1 root root       0 Jul 30 19:37 gai.conf\n-rw-------. 1 root root     781 Jul 30 19:37 grub.conf\n-rw-r--r--. 1 root root       9 Jul 30 19:37 host.conf\n-rw-r--r--. 1 root root    5309 Jul 30 19:37 kdump.conf\n</code></pre> <p>ps: \u4f60\u4e5f\u53ef\u4ee5\u4e0d\u505a-t\u6d4b\u8bd5,\u76f4\u63a5\u6307\u5b9a\u5927\u5c0f\u53bb\u7f29\u5bb9,\u770b\u6570\u636e\u662f\u5426\u8fd8\u5728?</p>"},{"location":"linux-lvm/#-_3","title":"--------\u79fb\u9664\u7269\u7406\u5377--------","text":"<ul> <li>\u79fb\u9664\u4e4b\u524d,\u7269\u7406\u5377\u91cc\u9762\u5fc5\u987b\u6ca1\u6709\u6570\u636e,\u7528\u4e0b\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u5404\u7269\u7406\u5377\u7684\u7a7a\u95f4\u5927\u5c0f.\u8ba1\u5212\u662f\u5426\u6709\u8db3\u591f\u7684\u7a7a\u95f4\u53ef\u4ee5\u88ab\u7528\u6765\u79fb\u52a8\u6570\u636e!</li> <li> <p><code>[root@yangcan Desktop]# pvscan</code></p> </li> <li> <p>\u642c\u79fb\u8981\u79fb\u9664\u7269\u7406\u5377\u7684\u6570\u636e\u5230\u5176\u4ed6\u7a7a\u95f2\u4e14\u6ee1\u8db3\u5927\u5c0f\u7684\u7269\u7406\u5377</p> </li> <li> <p><code>[root@yangcan Desktop]# pvmove /dev/sda6 /dev/sda7</code> \u5b8c\u6210\u4e4b\u540e</p> </li> <li> <p>\u4ece\u5377\u7ec4\u79fb\u9664\u7269\u7406\u5377</p> </li> <li><code>[root@yangcan Desktop]#vgchange -an vg5</code></li> <li><code>[root@yangcan Desktop]# vgreduce vg5 /dev/sda6</code></li> </ul>"},{"location":"macOS%E8%BD%AF%E4%BB%B6%E7%BC%96%E8%AF%91%E6%97%B6%E6%89%BE%E4%B8%8D%E5%88%B0%E5%A4%B4%E6%96%87%E4%BB%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-%E6%9B%B4%E6%96%B010-15/","title":"macOS\u8f6f\u4ef6\u7f16\u8bd1\u65f6\u627e\u4e0d\u5230\u5934\u6587\u4ef6\u89e3\u51b3\u65b9\u6cd5[\u66f4\u65b010.15]","text":"<ul> <li>\u5143URL</li> </ul>"},{"location":"megacli/","title":"Megacli\u306e\u57fa\u672c\u64cd\u4f5c","text":"<p>StorCLI_RefMan_revf PDF</p>"},{"location":"megacli/#smart","title":"Smart\u8868","text":"\u9805\u76eeID \u9805\u76ee\u540d \u8a73\u7d30\u306a\u8aac\u660e 01 Raw Read Error Rate \u3053\u306e\u9805\u76ee\u306f\u30cf\u30fc\u30c9\u30c7\u30a3\u30b9\u30af\u304b\u3089\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u3080\u6642\u306b\u767a\u751f\u3057\u305f\u30a8\u30e9\u30fc\u306e\u5272\u5408\u3092\u8868\u3059\u3002\u6570\u5024\u304c\u95be\u5024\u3088\u308a\u4f4e\u3044\u5834\u5408\u3001\u30cf\u30fc\u30c9\u30c7\u30a3\u30b9\u30af\u5185\u306e\u78c1\u6c17\u30c7\u30a3\u30b9\u30af\u307e\u305f\u306f\u78c1\u6c17\u30d8\u30c3\u30c9\u306b\u7570\u5e38\u304c\u3042\u308b\u3002 05 Reallocated Sectors Count \u4ee3\u66ff\u51e6\u7f6e\uff08\u30c7\u30fc\u30bf\u3092\u7279\u5225\u306b\u4e88\u7d04\u3057\u305f\u4e88\u5099\u30a8\u30ea\u30a2\u306b\u79fb\u52d5\u3059\u308b\uff09\u3092\u65bd\u3055\u308c\u305f\u4e0d\u826f\u30bb\u30af\u30bf\u306e\u6570\u3002 C5(197) Current Pending Sector Count \u73fe\u5728\u7570\u5e38\u304c\u3042\u308a\u3001\u4ee3\u66ff\u51e6\u7406\u3092\u5f85\u3064\u30bb\u30af\u30bf\u306e\u7dcf\u6570\u3002\u3082\u3057\u5f8c\u3067\u8aad\u307f\u8fbc\u307f\u306b\u6210\u529f\u3057\u305f\u30bb\u30af\u30bf\u304c\u3042\u308c\u3070\u3001\u3053\u306e\u5024\u306f\u6e1b\u5c11\u3059\u308b\u3002 C6(198) Off-Line Scan Uncorrectable Sector Count \u30aa\u30d5\u30e9\u30a4\u30f3\u30b9\u30ad\u30e3\u30f3\u6642\u306b\u767a\u898b\u3055\u308c\u305f\u3001\u56de\u5fa9\u4e0d\u53ef\u80fd\u306a\u30bb\u30af\u30bf\u306e\u7dcf\u6570\u3002\u3053\u306e\u5024\u304c\u5897\u52a0\u3059\u308b\u5834\u5408\u306f\u3001\u78c1\u6c17\u30c7\u30a3\u30b9\u30af\u306e\u8868\u9762\u306b\u660e\u78ba\u306a\u554f\u984c\u304c\u3042\u308b\u3002 <pre><code>Media Error\u4ee3\u8868\u6247\u533a\u6709\u95ee\u9898\uff0c\u574f\u9053\u7b49\uff1b\nOther Error\u4ee3\u8868\u78c1\u76d8\u53ef\u80fd\u6709\u677e\u52a8\u3002\n\nMedia Error Count: 0\nOther Error Count: 0\n</code></pre>"},{"location":"megacli/#megaraidhdd","title":"MegaRAID\u304c\u8a8d\u8b58\u3057\u3066\u3044\u308bHDD\u3092\u5168\u8868\u793a\u3059\u308b\u65b9\u6cd5","text":"<pre><code>$ sudo MegaCli64 -PDList -aALL\n$ sudo MegaCli64 -CfgDsply -aALL   \u2190 RAID\u30ab\u30fc\u30c9\u3082\u8868\u793a\u3059\u308b\u3002\n</code></pre>"},{"location":"megacli/#hdd","title":"HDD\u3092\u30ea\u30d3\u30eb\u30c9\u3059\u308b\u624b\u9806","text":"<pre><code>1.\n#\u5bfe\u8c61\u30c7\u30a3\u30b9\u30af\u306e\u30aa\u30d5\u30e9\u30a4\u30f3\n/opt/MegaRAID/MegaCli/MegaCli64 -PDOffline -PhysDrv[252:0] -a0\nAdapter: 0: EnclId-252 SlotId-0 state changed to OffLine.\nExit Code: 0x00\n\n2.\n#status\u78ba\u8a8d\n/opt/MegaRAID/MegaCli/MegaCli64 -PDList -a0 | less\nFirmware state: Offline  \u2190\u3000offline\u306b\u306a\u3063\u3066\u308b\u3002\n\n3.\n#\u5bfe\u8c61\u306e\u30c7\u30a3\u30b9\u30af\u306bmissing mark\u3064\u3051\u308b\n/opt/MegaRAID/MegaCli/MegaCli64 -PDMarkMissing -PhysDrv[252:0] -a0\nEnclId-252 SlotId-0 is marked Missing.\nExit Code: 0x00\n\n4.\n#missing mark\u306e\u3064\u3044\u305fdisk\u306e\u78ba\u8a8d\n/opt/MegaRAID/MegaCli/MegaCli64 -PDGetMissing -aALL\n    Adapter 0 - Missing Physical drives\n    No.   Array   Row   Size Expected\n    0     0       0     1907200 MB\n\n5.\n#\u524a\u9664\u524d\u306e\u6e96\u5099\n/opt/MegaRAID/MegaCli/MegaCli64 -PDPrpRmv -PhysDrv[252:0] -a0\nPrepare for removal Success\nExit Code: 0x00\n\n6.\n#Missing mark\u306e\u72b6\u614b\u5909\u66f4\n/opt/MegaRAID/MegaCli/MegaCli64 -PDReplaceMissing -PhysDrv[252:0] -Array1 -row0 -a0\n\n7.\n#Rebuild\u30b9\u30bf\u30fc\u30c8\n/opt/MegaRAID/MegaCli/MegaCli64 -PDRbld -Start -PhysDrv[252:0] -a0\n\n8.\n#\u72b6\u614b\u78ba\u8a8d\n/opt/MegaRAID/MegaCli/MegaCli64 -PDList -a0 | less\nFirmware state: Rebuild   \u2190 rebuild\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u306b\u306a\u3063\u305f\n\n9.\n#Rebuild\u306e\u72b6\u6cc1\u78ba\u8a8d\n/opt/MegaRAID/MegaCli/MegaCli64 -PDRbld -showprog -physdrv[252:0] -a0\nRebuild Progress on Device at Enclosure 252, Slot 0 Completed 4% in 11 Minutes.\nExit Code: 0x00\n</code></pre>"},{"location":"megacli/#raid","title":"RAID\u304c\u5197\u9577\u306b\u306a\u3063\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5","text":"<pre><code>$ sudo MegaCli64 -LDInfo -Lall -aALL\n$ sudo MegaCli64 -LDInfo -Lall -aALL | grep -i state\n</code></pre> <p>\u2460\u25c6 State: Optimal \u3092\u78ba\u8a8d </p> <pre><code>for i in $(sudo /usr/local/sbin/MegaCli -PDList -aALL -NoLog | grep 'Device Id' | awk '{ print $NF }') ; do echo \"===== Device Id $i =====\" ; sudo /usr/sbin/smartctl -a -d\nsat+megaraid,$i /dev/sda | egrep '\n^(Ser|  [15]|19[78]|#)' ; echo ; done\n</code></pre>"},{"location":"megacli/#display-virtual-drive-information","title":"Display Virtual Drive Information","text":"<pre><code>root@www101v:~# MegaCli64 -LDInfo -Lall -aALL \n\n\nAdapter 0 -- Virtual Drive Information:\nVirtual Disk: 0 (Target Id: 0)\nName:\nRAID Level: Primary-1, Secondary-0, RAID Level Qualifier-0\nSize:931.0 GB\nState: Degraded    &lt;-- \u3053\u3053\nStripe Size: 64 KB\nNumber Of Drives:2\nSpan Depth:1\nDefault Cache Policy: WriteBack, ReadAheadNone, Cached, Write Cache OK if Bad BBU\nCurrent Cache Policy: WriteBack, ReadAheadNone, Cached, Write Cache OK if Bad BBU\nAccess Policy: Read/Write\nDisk Cache Policy: Enabled\nEncryption Type: None\nBad Blocks Exist: No\n\nExit Code: 0x00\n</code></pre>"},{"location":"megacli/#display-drive-information","title":"Display Drive Information","text":"<pre><code>\nroot@www101v:~# MegaCli64 -PDList -aALL\n\nAdapter #0\n\nEnclosure Device ID: 252\nSlot Number: 0\nDevice Id: 2\nSequence Number: 2\nMedia Error Count: 0\nOther Error Count: 0\nPredictive Failure Count: 0\nLast Predictive Failure Event Seq Number: 0\nPD Type: SATA\nRaw Size: 931.512 GB [0x74706db0 Sectors]\nNon Coerced Size: 931.012 GB [0x74606db0 Sectors]\nCoerced Size: 931.0 GB [0x74600000 Sectors]\nFirmware state: Online, Spun Up\nSAS Address(0): 0x4433221103000000\nConnected Port Number: 0(path0) \nInquiry Data:      WD-WMATV5217983WDC WD1002FBYS-50A6B0                   03.00C09\nFDE Capable: Not Capable\nFDE Enable: Disable\nSecured: Unsecured\nLocked: Unlocked\nForeign State: None \nDevice Speed: 3.0Gb/s \nLink Speed: 3.0Gb/s \nMedia Type: Hard Disk Device\nDrive:  Not Certified\n\n</code></pre>"},{"location":"megacli/#rebuild","title":"Rebuild \u9032\u6357\u78ba\u8a8d","text":"<ul> <li>\u9759\u7684</li> </ul> <pre><code>root@www101v:~# MegaCli64 -PDRbld -ShowProg -PhysDrv[252:1] -aALL\n\nRebuild Progress on Device at Enclosure 252, Slot 1 Completed 16% in 24 Minutes.\n\nExit Code: 0x00\n</code></pre> <ul> <li>Real Time</li> </ul> <pre><code>root@www101v:~# MegaCli64 -PDRbld -ProgDsply -PhysDrv[252:1] -aALL\n      Rebuild progress of physical drives...\n\n  Enclosure:Slot               Percent Complete                       Time Elps\n       252 :01     ########***************17 %*********************** 00:26:56 \n\n    Press &lt;ESC&gt; key to quit...\n</code></pre>"},{"location":"megacli/#_1","title":"\u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u65b9\u6cd5","text":"<p>RAID\u30ab\u30fc\u30c9\u306e\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u8a2d\u5b9a </p> <pre><code>\uff1cWrite \u30b9\u30eb\u30fc\uff1e\nMegaCli -LDSetProp WT -Lall -Aall\n\uff1cWrite \u30d0\u30c3\u30af\uff1e\nMegaCli -LDSetProp WB -Lall -Aall\n</code></pre> <p>RAID\u30ab\u30fc\u30c9\u306e\u8aad\u307f\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u8a2d\u5b9a </p> <pre><code>\uff1cNo read ahead\uff1e\nMegaCli -LDSetProp NORA -Lall -Aall\n\uff1cRead ahead\uff1e\nMegaCli -LDSetProp RA -Lall -Aall\n\uff1cAdaptive read ahead\uff1e\nMegaCli -LDSetProp ADRA -Lall -Aall\n</code></pre> <p>RAID\u30ab\u30fc\u30c9\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30dd\u30ea\u30b7\u30fc\u306e\u8a2d\u5b9a </p> <pre><code>\uff1cChached\uff1e\nMegaCli -LDSetProp -Cached -Lall -aALL\n\uff1cDirect\uff1e\nMegaCli -LDSetProp -Direct -Lall -aALL\n</code></pre> <p>BBU\u30e6\u30cb\u30c3\u30c8\u304c\u4e0d\u826f\u306e\u5834\u5408\u306b\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u4f7f\u3046\u304b\u3069\u3046\u304b </p> <pre><code>\uff1cCachedBadBBU\uff1a\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u6709\u52b9\uff1e\nMegaCli  -LDSetProp -CachedBadBBU -Lall -Aall\n\uff1cNoCachedBadBBU\uff1a\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u7121\u52b9\uff1e\nMegaCli  -LDSetProp -NoCachedBadBBU -Lall -Aall\n</code></pre> <p>\u30c9\u30e9\u30a4\u30d6\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u6709\u52b9\u306b\u3059\u308b\u304b\u3069\u3046\u304b </p> <pre><code>\uff1cEnables drive cache\uff1a\u6709\u52b9\uff1e\nMegaCli -LDSetProp -EnDskCache -Lall -Aall\n\uff1cDisables drive cache\uff1a\u7121\u52b9\uff1e\nMegaCli -LDSetProp -DisDskCache -Lall -Aall\n</code></pre> <p>\u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u78ba\u8a8d\u65b9\u6cd5</p> <ul> <li>RAID\u30ab\u30fc\u30c9\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u78ba\u8a8d </li> </ul> <pre><code># MegaCli -LDGetProp -Cache -Lall -aALL\n\nAdapter 0-VD 0(target id: 0): Cache Policy:WriteThrough, ReadAheadNone, Direct, No Write Cache if bad BBU\n\nExit Code: 0x00\n</code></pre> <ul> <li>\u30c9\u30e9\u30a4\u30d6\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u78ba\u8a8d </li> </ul> <pre><code># MegaCli -LDGetProp -DskCache -Lall -aALL\n\nAdapter 0-VD 0(target id: 0): Disk Write Cache : Disabled\n\nExit Code: 0x00\n</code></pre>"},{"location":"megacli/#fwtermlog-grep-rebuild","title":"Fwtermlog\u3092\u8868\u793a\u3059\u308b\u65b9\u6cd5 | grep Rebuild","text":"<pre><code>[iadmin@xxxx ~]$ sudo MegaCli64 -Fwtermlog -Dsply -aall | grep Rebuild\nT5:     disableAutoRebuild=0, disableBatteryWarning=0, eccBucketSize=ff\n02/01/15  6:05:01: EVT#02934-02/01/15  6:05:01: 106=Rebuild automatically started on PD 01(e0x20/s1)\n02/01/15  6:05:03: prDiskCheckOkToRun: PR cannot run on this pd=0 since this array=1 has a PD in REBUILD state Rebuilding\n02/01/15  7:43:01: EVT#02936-02/01/15  7:43:01: 103=Rebuild progress on PD 01(e0x20/s1) is 0.99%(5880s)\n02/01/15  9:21:28: EVT#02937-02/01/15  9:21:28: 103=Rebuild progress on PD 01(e0x20/s1) is 1.99%(11787s)\n02/01/15 10:59:38: EVT#02938-02/01/15 10:59:38: 103=Rebuild progress on PD 01(e0x20/s1) is 2.99%(17677s)\n02/01/15 12:37:13: EVT#02939-02/01/15 12:37:13: 103=Rebuild progress on PD 01(e0x20/s1) is 3.99%(23532s)\n02/01/15 14:15:49: EVT#02940-02/01/15 14:15:49: 103=Rebuild progress on PD 01(e0x20/s1) is 4.99%(29448s)\n02/01/15 15:54:18: EVT#02941-02/01/15 15:54:18: 103=Rebuild progress on PD 01(e0x20/s1) is 5.99%(35357s)\n02/01/15 17:31:16: EVT#02942-02/01/15 17:31:16: 103=Rebuild progress on PD 01(e0x20/s1) is 6.99%(41175s)\n02/01/15 19:07:32: EVT#02943-02/01/15 19:07:32: 103=Rebuild progress on PD 01(e0x20/s1) is 7.99%(46951s)\n02/01/15 20:44:02: EVT#02944-02/01/15 20:44:02: 103=Rebuild progress on PD 01(e0x20/s1) is 8.99%(52741s)\n02/01/15 22:20:47: EVT#02945-02/01/15 22:20:47: 103=Rebuild progress on PD 01(e0x20/s1) is 9.99%(58546s)\n02/01/15 23:57:46: EVT#02946-02/01/15 23:57:46: 103=Rebuild progress on PD 01(e0x20/s1) is 10.99%(64365s)\n02/02/15  1:35:11: EVT#02947-02/02/15  1:35:11: 103=Rebuild progress on PD 01(e0x20/s1) is 11.99%(4674s)\n02/02/15  3:12:39: EVT#02948-02/02/15  3:12:39: 103=Rebuild progress on PD 01(e0x20/s1) is 12.99%(10522s)\n02/02/15  4:49:15: EVT#02949-02/02/15  4:49:15: 103=Rebuild progress on PD 01(e0x20/s1) is 13.99%(16318s)\n02/02/15  6:26:01: EVT#02950-02/02/15  6:26:01: 103=Rebuild progress on PD 01(e0x20/s1) is 14.99%(22124s)\n02/02/15  8:02:22: EVT#02951-02/02/15  8:02:22: 103=Rebuild progress on PD 01(e0x20/s1) is 15.99%(27905s)\n02/02/15  9:39:34: EVT#02952-02/02/15  9:39:34: 103=Rebuild progress on PD 01(e0x20/s1) is 16.99%(33737s)\n02/02/15 11:16:58: EVT#02953-02/02/15 11:16:58: 103=Rebuild progress on PD 01(e0x20/s1) is 17.99%(39581s)\n02/02/15 12:54:33: EVT#02954-02/02/15 12:54:33: 103=Rebuild progress on PD 01(e0x20/s1) is 18.98%(45436s)\n02/02/15 14:24:59: EVT#02955-02/02/15 14:24:59: 103=Rebuild progress on PD 01(e0x20/s1) is 19.98%(50862s)\n02/02/15 16:02:28: EVT#02956-02/02/15 16:02:28: 103=Rebuild progress on PD 01(e0x20/s1) is 20.98%(56711s)\n02/02/15 17:39:07: EVT#02957-02/02/15 17:39:07: 103=Rebuild progress on PD 01(e0x20/s1) is 21.98%(62510s)\n</code></pre>"},{"location":"megacli/#slot-numberfirmware-stateinquiry-dataraw-sizedevice-id","title":"\"^Slot Number|^Firmware state|^Inquiry Data|^Raw Size|^Device Id\" \u3092\u8868\u793a\u3059\u308b","text":"<pre><code>root@ubuntu14:/home/lyvivian# megacli -PDList -aALL | egrep \"^Slot Number|^Firmware state|^Inquiry Data|^Raw Size|^Device Id\"\nSlot Number: 0                                                                                                                                                                                                                               \nDevice Id: 6                                                                                                                                                                                                                                 \nRaw Size: 465.761 GB [0x3a386030 Sectors]                                                                                                                                                                                                    \nFirmware state: Online, Spun Up                                                                                                                                                                                                              \nInquiry Data: S313J9FF103173      ST500LM012 HN-M500MBB                   2BA30010                                                                                                                                                           \nSlot Number: 1                                                                                                                                                                                                                               \nDevice Id: 5                                                                                                                                                                                                                                 \nRaw Size: 29.843 GB [0x3bb0000 Sectors]                                                                                                                                                                                                      \nFirmware state: Online, Spun Up                                                                                                                                                                                                              \nInquiry Data: 00257465041E        TS32GSSD25S-M                           V090216                                                                                                                                                            \nSlot Number: 2                                                                                                                                                                                                                               \nDevice Id: 4                                                                                                                                                                                                                                 \nRaw Size: 298.090 GB [0x2542eab0 Sectors]                                                                                                                                                                                                    \nFirmware state: Online, Spun Up                                                                                                                                                                                                              \nInquiry Data:      WD-WXE508HD9898WDC WD3200BEVT-75ZCT1                   11.01A11                                                                                                                                                           \nSlot Number: 3                                                                                                                                                                                                                               \nDevice Id: 11                                                                                                                                                                                                                                \nRaw Size: 59.625 GB [0x7740ab0 Sectors]                                                                                                                                                                                                      \nFirmware state: Online, Spun Up                                                                                                                                                                                                              \nInquiry Data: 0000000011210310A638M4-CT064M4SSD2                          000F                                                                                                                                                               \nSlot Number: 4                                                                                                                                                                                                                               \nDevice Id: 7                                                                                                                                                                                                                                 \nRaw Size: 1.819 TB [0xe8e088b0 Sectors]                                                                                                                                                                                                      \nFirmware state: Online, Spun Up                                                                                                                                                                                                              \nInquiry Data:      WD-WCC1T0228569WDC WD20EZRX-00DC0B0                    80.00A80                                                                                                                                                           \nSlot Number: 5                                                                                                                                                                                                                               \nDevice Id: 9                                                                                                                                                                                                                                 \nRaw Size: 1.819 TB [0xe8e088b0 Sectors]                                                                                                                                                                                                      \nFirmware state: Online, Spun Up                                                                                                                                                                                                              \nInquiry Data:      WD-WMC301755889WDC WD20EZRX-00DC0B0                    80.00A80                                                                                                                                                           \nSlot Number: 6                                                                                                                                                                                                                               \nDevice Id: 8                                                                                                                                                                                                                                 \nRaw Size: 1.819 TB [0xe8e088b0 Sectors]                                                                                                                                                                                                      \nFirmware state: Online, Spun Up                                                                                                                                                                                                              \nInquiry Data:      WD-WMC301755597WDC WD20EZRX-00DC0B0                    80.00A80                                                                                                                                                           \nSlot Number: 7                                                                                                                                                                                                                               \nDevice Id: 10                                                                                                                                                                                                                                \nRaw Size: 1.819 TB [0xe8e088b0 Sectors]                                                                                                                                                                                                      \nFirmware state: Online, Spun Up                                                                                                                                                                                                              \nInquiry Data:      WD-WMC301744569WDC WD20EZRX-00DC0B0                    80.00A80                                                                                                                                                           \nroot@ubuntu14:/home/lyvivian# \n</code></pre>"},{"location":"megacli/#usage","title":"Usage","text":"<pre><code># cd /opt/MegaRAID/storcli\n# ./storcli64 \n</code></pre> <ul> <li>information about every controller</li> <li> <p><code>./storcli64 show</code></p> </li> <li> <p>informations to selected controller and its configuration</p> </li> <li> <p><code>./storcli64 /c0 show</code></p> </li> <li> <p>informations to the available hard drives and their current state (Serial Number, temperature )</p> </li> <li> <p><code>./storcli64 /c0 /eall /sall show [all]</code></p> </li> <li> <p>informations to the available virtual drives and their current state.</p> </li> <li> <p><code>./storcli64 /c0 /vall show [all]</code></p> </li> <li> <p>show the progress of ongoing rebuilds</p> </li> <li> <p><code>./storcli64 /c0 /eall /sall show rebuild</code></p> </li> <li> <p>create a RAID 1</p> </li> <li> <p><code>./storcli64 /c0 add vd type=raid1 size=10gb names=tmp1 drives=0:2-3</code></p> </li> <li> <p>create a RAID 5</p> </li> <li> <p><code>./storcli64 /c0 add vd type=raid5 size=10gb names=tmp1 drives=0:2-6</code></p> </li> <li> <p>create a RAID 6</p> </li> <li> <p><code>./storecli64 /c0 add vd type=raid6 size=10gb names=tmp1 drives=0:2-7</code></p> </li> <li> <p>create a RAID 10</p> </li> <li><code>./storecli64 /c0 add vd type=raid10 size=2gb,3gb,4gb names=tmp1,tmp2,tmp3 drives=0:2-3,5,7 pdperarray=2</code></li> </ul>"},{"location":"megacli/#manual","title":"Manual","text":"<p>There is a manual with all the usable parameters provided by avagotech (the succsessor of the producer LSI) to be found here.</p>"},{"location":"megacli/#controller-overview-in-detail","title":"controller overview in detail","text":"<p>information regarding every controller</p> <ul> <li><code>./storecli64 show</code></li> </ul> <p>```   # ./storcli64 show</p> <p>... SNIPP ...</p> <p>System Overview :   ===============</p> <p>Ctl Model                                  Ports PDs DGs DNOpt VDs VNOpt BBU sPR DS  EHS ASOs Hlth </p> <pre><code>0 Intel(R)IntegratedRAIDModuleRMS25CB080     8   2   1     0   1     0 Opt On  1&amp;2 Y      3 Opt\n</code></pre> <p>```</p>"},{"location":"megacli/#configuration-overview","title":"configuration overview","text":"<p>information regarding the selected controller and its configuration</p> <ul> <li><code>./storecli64 /c0 show</code></li> </ul> <p>```   # ./storcli64 /c0 show   Generating detailed summary of the adapter, it may take a while to complete.</p> <p>... SNIPP ...</p> <p>Product Name = Intel(R) Integrated RAID Module RMS25CB080   Serial Number = QSIP23600494   SAS Address =  5001e6756eda0000   PCI Address = 00:05:00:00   System Time = 01/25/2016 14:34:15   Mfg. Date = 09/07/12   Controller Time = 01/25/2016 13:34:14   FW Package Build = 23.12.0-0013   BIOS Version = 5.42.00_4.12.05.00_0x05270000   FW Version = 3.240.25-2382   Driver Name = megaraid_sas   Driver Version = 06.805.06.01-rc1   Vendor Id = 0x1000   Device Id = 0x5B   SubVendor Id = 0x8086   SubDevice Id = 0x3513   Host Interface = PCI-E   Device Interface = SAS-6G   Bus Number = 5   Device Number = 0   Function Number = 0   Drive Groups = 1</p> <p>TOPOLOGY :   ========</p> <p>DG Arr Row EID:Slot DID Type  State BT       Size PDC  PI SED DS3  FSpace </p> <p>0 -   -   -        -   RAID1 Optl  N  930.390 GB dflt N  N   none N        0 0   -   -        -   RAID1 Optl  N  930.390 GB dflt N  N   none N        0 0   0   252:0    8   DRIVE Onln  N  930.390 GB dflt N  N   none -        0 0   1   252:1    9   DRIVE Onln  N  930.390 GB dflt N  N   none -      </p> <p>... SNIPP ...</p> <p>Virtual Drives = 1</p> <p>VD LIST :   =======</p> <p>DG/VD TYPE  State Access Consist Cache Cac sCC       Size Name </p> <p>0/0   RAID1 Optl  RW     No      RWBC  -   ON  930.390 GB      </p> <p>... SNIPP ...</p> <p>Physical Drives = 2</p> <p>PD LIST :   =======</p> <p>EID:Slt DID State DG       Size Intf Med SED PI SeSz Model                  Sp </p> <p>252:0     8 Onln   0 930.390 GB SATA HDD N   N  512B WDC WD1000CHTZ-04JCPV1 U   252:1     9 Onln   0 930.390 GB SATA HDD N   N  512B WDC WD1000CHTZ-04JCPV1 U  </p> <p>... SNIPP ...</p> <p>Cachevault_Info :   ===============</p> <p>Model  State   Temp Mode MfgDate    Next Learn           </p> <p>CVPM02 Optimal 23C  -    2012/12/19 2016/02/22  13:07:20 </p> <p>```</p>"},{"location":"megacli/#information-regarding-the-disks","title":"Information regarding the disks","text":"<p>Information regarding the available disks and their current state (serial number,temperature etc.)</p> <pre><code># ./storecli64 /c0 /eall /sall show all\nController = 0\nStatus = Success\nDescription = Show Drive Information Succeeded.\n\n\nDrive /c0/e252/s0 :\n=================\n-------------------------------------------------------------------------------\nEID:Slt DID State DG       Size Intf Med SED PI SeSz Model                  Sp \n-------------------------------------------------------------------------------\n252:0     8 Onln   0 930.390 GB SATA HDD N   N  512B WDC WD1000CHTZ-04JCPV1 U  \n-------------------------------------------------------------------------------\n\n... SNIPP ...\n\nDrive /c0/e252/s0 - Detailed Information :\n========================================\n\nDrive /c0/e252/s0 State :\n=======================\nShield Counter = 0\nMedia Error Count = 0\nOther Error Count = 0\nBBM Error Count = 0\nDrive Temperature =  29C (84.20 F)\nPredictive Failure Count = 0\nS.M.A.R.T alert flagged by drive = No\n\n\nDrive /c0/e252/s0 Device attributes :\n===================================\nSN =      WD-WXS1E64JNL0D\nManufacturer Id = ATA     \nModel Number = WDC WD1000CHTZ-04JCPV1\nNAND Vendor = NA\nWWN = 50014ee65a68f4c4\nFirmware Revision = 04.06A01\nRaw size = 931.512 GB [0x74706db0 Sectors]\nCoerced size = 930.390 GB [0x744c8000 Sectors]\nNon Coerced size = 931.012 GB [0x74606db0 Sectors]\nDevice Speed = 6.0Gb/s\nLink Speed = 6.0Gb/s\nNCQ setting = N/A\nWrite cache = N/A\nLogical Sector Size = 512B\nPhysical Sector Size = 4 KB\nConnector Name = Port 0 - 3 x1\n\n\nDrive /c0/e252/s0 Policies/Settings :\n===================================\nDrive position = DriveGroup:0, Span:0, Row:0\nEnclosure position = 0\nConnected Port Number = 0(path0) \nSequence Number = 2\nCommissioned Spare = No\nEmergency Spare = No\nLast Predictive Failure Event Sequence Number = 0\nSuccessful diagnostics completion on = N/A\nSED Capable = No\nSED Enabled = No\nSecured = No\nLocked = No\nNeeds EKM Attention = No\nPI Eligible = No\nCertified = No\nWide Port Capable = No\n\nPort Information :\n================\n\n-----------------------------------------\nPort Status Linkspeed SAS address        \n-----------------------------------------\n   0 Active 6.0Gb/s   0x4433221100000000 \n-----------------------------------------\n\n\nInquiry Data = \n7a 42 ff 3f 37 c8 10 00 00 00 00 00 3f 00 00 00 \n00 00 00 00 20 20 20 20 57 20 2d 44 58 57 31 53 \n36 45 4a 34 4c 4e 44 30 00 00 00 00 00 00 34 30 \n30 2e 41 36 31 30 44 57 20 43 44 57 30 31 30 30 \n48 43 5a 54 30 2d 4a 34 50 43 31 56 20 20 20 20 \n20 20 20 20 20 20 20 20 20 20 20 20 20 20 10 80 \n00 40 00 2f 01 40 00 00 00 00 07 00 ff 3f 10 00 \n3f 00 10 fc fb 00 00 01 ff ff ff 0f 00 00 07 00 \n\n\n\nDrive /c0/e252/s1 :\n=================\n\n-------------------------------------------------------------------------------\nEID:Slt DID State DG       Size Intf Med SED PI SeSz Model                  Sp \n-------------------------------------------------------------------------------\n252:1     9 Onln   0 930.390 GB SATA HDD N   N  512B WDC WD1000CHTZ-04JCPV1 U  \n-------------------------------------------------------------------------------\n\n... SNIPP ...\n\nDrive /c0/e252/s1 - Detailed Information :\n========================================\n\nDrive /c0/e252/s1 State :\n=======================\nShield Counter = 0\nMedia Error Count = 0\nOther Error Count = 0\nBBM Error Count = 0\nDrive Temperature =  28C (82.40 F)\nPredictive Failure Count = 0\nS.M.A.R.T alert flagged by drive = No\n\n\nDrive /c0/e252/s1 Device attributes :\n===================================\nSN =      WD-WXT1E64TZEFP\nManufacturer Id = ATA     \nModel Number = WDC WD1000CHTZ-04JCPV1\nNAND Vendor = NA\nWWN = 50014ee6afbe6dc0\nFirmware Revision = 04.06A01\nRaw size = 931.512 GB [0x74706db0 Sectors]\nCoerced size = 930.390 GB [0x744c8000 Sectors]\nNon Coerced size = 931.012 GB [0x74606db0 Sectors]\nDevice Speed = 6.0Gb/s\nLink Speed = 6.0Gb/s\nNCQ setting = N/A\nWrite cache = N/A\nLogical Sector Size = 512B\nPhysical Sector Size = 4 KB\nConnector Name = Port 0 - 3 x1\n\n\nDrive /c0/e252/s1 Policies/Settings :\n===================================\nDrive position = DriveGroup:0, Span:0, Row:1\nEnclosure position = 0\nConnected Port Number = 1(path0) \nSequence Number = 2\nCommissioned Spare = No\nEmergency Spare = No\nLast Predictive Failure Event Sequence Number = 0\nSuccessful diagnostics completion on = N/A\nSED Capable = No\nSED Enabled = No\nSecured = No\nLocked = No\nNeeds EKM Attention = No\nPI Eligible = No\nCertified = No\nWide Port Capable = No\n\nPort Information :\n================\n\n-----------------------------------------\nPort Status Linkspeed SAS address        \n-----------------------------------------\n   0 Active 6.0Gb/s   0x4433221101000000 \n-----------------------------------------\n</code></pre> <p> DescriptionMegaCLI CommandStorCLI CommandReal StorCLI Example System Commands Show the software version. \u00a0MegaCLI -vstorcli -v storcli -v \u00a0Show help information.\u00a0MegaCLI -help|-h|?\u00a0storcli -help|-h|?storcli -h \u00a0Show the number of controllers connected\u00a0MegaCLI -adpCount\u00a0storcli show ctrlcountstorcli show ctrlcount Controller Commands Show the status of properties related\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 to the controllers.MegaCli -AdpGetProp\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;PropertyName&gt;-aN|-a0,1,2|-aALL\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 The following properties can be used with this\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 command:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 abortcconerror\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 alarmdsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autodetectbackplanedsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autoenhancedimportdsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autosnapshotspace\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 batwarndsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bgirate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bootwithpinnedcache\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 cachebypass\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ccrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 clusterenable\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 coercionmode\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 copybackdsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 defaultldpspolicy\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 defaultsnapshotspace\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 defaultviewspace\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 disableldpsinterval\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 disableldpstime\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 disableocr\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 dsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketcount\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketleakrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketsize\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableeghsp\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableesmarter\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableeug|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enablejbod\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enblspindownunconfigdrvs\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 loadbalancemode\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 maintainpdfailhistoryenbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ncqdsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 patrolreadrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 perfmode\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 predfailpollinterval\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rebuildrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 reconrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rstrhotspareoninsert\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 smartcpybkenbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spindowntime\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupdelay\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupdrivecount\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupencdelay /cx show &lt;propertyName&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 The following properties can be used with this\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 command:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 activityforlocate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 alarm\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 backplane\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 batterywarning\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bgirate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bootwithpinnedcache\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 cachebypass\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 cacheflushint\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 cc\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ccrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 clusterenable\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 coercion\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 copyback\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 directpdmapping\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ds\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketleakrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketsize\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableeghsp\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableesmarter\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableeug\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 exposeencldevice\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 jbod\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 loadbalancemode\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 maintainpdfailhistory\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 migraterate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ncq\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 perfmode\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 pr\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 prcorrectunconfiguredareas\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 prrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rebuildrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rehostinfo\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 restorehotspare\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 safeid\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 smartpollinterval\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupdelay\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupdrivecount\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 stoponerror\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 time\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 usefdeonlyencrypt  storcli /c0 show activityforlocate \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /c0 show alarm storcli /c0 show backplane storcli /c0 show batterywarning storcli /c0 show bgirate storcli /c0 show bootwithpinnedcache storcli /c0 show cachebypass storcli /c0 show cacheflushint storcli /c0 show cc storcli /c0 show ccrate storcli /c0 show clusterenable storcli /c0 show coercion storcli /c0 show copyback \u00a0Show the status of properties related to the controllers (continued). spinupencdrvcnt\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ssdsmartcpybkenbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 usediskactivityforlocate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 usefdeonlyencryptNone  Set properties on the selected\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 controllers. Megacli -AdpSetProp\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 &lt;propertyname&gt;-an|-a0,1,2|-aall\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 The following properties can be set using this\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 command:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 abortcconerror\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 alarmdsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autodetectbackplanedsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autoenhancedimportdsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autosnapshotspace\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 batwarndsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bgirate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bootwithpinnedcache\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 cachebypass\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ccrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 clusterenable\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 coercionmode\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 copybackdsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 defaultldpspolicy\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 defaultsnapshotspace\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 defaultviewspace\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 disableldpsinterval\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 disableldpstime\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 disableocr\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 dsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketcount\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketleakrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketsize\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableeghsp\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableesmarter\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableeug|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enablejbod\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enblspindownunconfigdrvs\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 loadbalancemode\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 maintainpdfailhistoryenbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ncqdsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 patrolreadrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 perfmode\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 predfailpollinterval\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rebuildrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 reconrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rstrhotspareoninsert\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 smartcpybkenbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spindowntime\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupdelay\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupdrivecount\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupencdelay /cx set &lt;property1&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 The following properties can be set using this command:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 abortcconerror=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 activityforlocate=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 alarm=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autorebuild=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 backplane=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 batterywarning=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bgirate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bootwithpinnedcache=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 cachebypass=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 flush|flushcache\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 cacheflushinterval=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ccrate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 coercion=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 clusterenable=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 copyback=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 type=&lt;smartssd|smarthdd|all&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 dimmerswitch=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 directpdmapping=&lt;enable|disable&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketleakrate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketsize=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableeghsp=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableesmarter=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableeug=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 exposeencldevice=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 foreignautoimport=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 jbod=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 loadbalancemode=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 maintainpdfailhistory=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 migraterate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ncq=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 perfmode=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 prcorrectunconfiguredareas=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 prrate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rebuildrate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 restorehotspare=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 smartpollinterval=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupdelay=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupdrivecount=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 stoponerror=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 usefdeonlyencrypt=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 time=yyyymmdd hh:mm:ss|systemtime\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 usefdeonlyencrypt=&lt;on|off&gt;  /c0 set abortcconerror=on \u00a0Set properties on the selected\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 controllers. autocarve=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autodetect=&lt;on|off &gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 disk=&lt;p:-p&gt;|all\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autorebuild=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 carvesize=&lt;1024..32768&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 dpmstat=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ondegrade=&lt;cacheoff|follow&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rebuild=&lt;enable|disable|&gt;&lt;1..5&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rebuildmode=&lt;adaptive|lowlatency&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rebuildrate=&lt;1..5&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 selftest=&lt;enable|disable&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinup=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 stagger=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 verify=advanced|basic|&lt;1..5&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 verify=basic [pref=ddd:hh]where\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 hh={00..23} and\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ddd={mon|tue|wed|thu|fri|sat|sun}\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 verify=enable|disable|&lt;1..5&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 verifymode=&lt;adaptive|lowlatency&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 verifyrate=&lt;1..5&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupencdrvcnt\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 sdsmartcpybkenbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 usediskactivityforlocate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 usefdeonlyencrypt abortcconerror=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 activityforlocate=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 alarm=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autorebuild=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 backplane=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 batterywarning=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bgirate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bootwithpinnedcache=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 cachebypass=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 flush|flushcache\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 cacheflushinterval=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ccrate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 coercion=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 clusterenable=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 copyback=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 type=&lt;smartssd|smarthdd|all&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 directpdmapping=&lt;enable|disable&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketleakrate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eccbucketsize=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableeghsp=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableesmarter=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 enableeug=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 exposeencldevice=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 foreignautoimport=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 jbod=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 loadbalancemode=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 maintainpdfailhistory=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 migraterate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ncq=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 perfmode=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 prcorrectunconfiguredareas=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 prrate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rebuildrate=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 restorehotspare=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 smartpollinterval=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupdelay=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spinupdrivecount=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 stoponerror=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 usefdeonlyencrypt=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 time=yyyymmdd hh:mm:ss|systemtime\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 usefdeonlyencrypt=&lt;on|off&gt; Show the number of controllers\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 connected. MegaCLI -adpCount storcli show ctrlcountstorcli show ctrlcount Show all information about the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 adapter, such as cluster state, BIOS,\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 alarm, firmware, version, and so on.MegaCli -AdpAllInfo\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx show allstorcli /c0 show all  Show the freespace available in the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 controller.MegaCLI -CfgFreeSpaceinfo\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx show freespacestorcli /c0 show freespace\u00a0\u00a0Download the controller firmwareMegaCli -AdpFwFlash -f filename\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-NoSigChk] [-NoVerChk]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx download file=&lt;filepath&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [fwtype=&lt;val&gt;] [nosigchk] [noverchk]storcli /c0 download file=mr2208.rom  \u00a0Show the preserved cache status.MegaCLI-GetPreservedCacheList\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx show preservedcachestorcli /c0 show preservedcache\u00a0\u00a0Set the controller timeMegaCLI \u2013AdpSetTime yyyymmdd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 hh:mm:ss -aN|-a0,1,2|-aALLstorcli /c(x|all) set time=&lt;yyyymmdd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 hh:mm:ss | systemtime&gt;storcli /c0 set time=systemtime  \u00a0Show the controller time.\u00a0MegaCLI \u2013AdpGetTime -aN\u00a0storcli /cx show timestorcli /c0 show time  \u00a0RAID Configuration commands Create a RAID configuration of RAID\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 type 0, 1, 5, and 6.MegaCli \u2013CfgLDAdd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -R0|-R1|-R5|-R6[E0:S0,E1:S1,...]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [WT | WB] [NORA | RA | ADRA]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [Direct | Cached]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [CachedBadBBU|NoCachedBadBBU]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-szXXXXXXXX [-szYYYYYYYY [... ]]]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-strpszM] [\u2013Hsp[E5:S5,...]]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [\u2013afterLdX] -aNstorcli /cx add vd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 type=raid[0|1|5|6]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [Size=&lt;VD1_Sz&gt;,&lt;VD2_Sz&gt;,..|*all]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [name=&lt;VDNAME1&gt;,..]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 drives=e:s|e:s-x|e:s-x,y;e:s-x,y,z\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [PDperArray=x]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [SED] [pdcache=on|off|*default][pi]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [DimmerSwitch(ds)=default|automatic\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 (auto)|*none|maximum(max)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |MaximumWithoutCaching(maxnocache)]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [wt|*wb] [nora|*ra] [*direct|cached]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [CachedBadBBU|*NoCachedBadBBU]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [Stripe=&lt;8|16|32|64|128|256|512|102\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 4] [AfterVd=X]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [Spares=[e:]s|[e:]s-x|[e:]s-x,y]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [force]\u00a0storcli /c0 add vd type=road1 drives=252:0,252:1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 (hint:\u00a0 use storcli /c0 show to view available enclosure/slot e:s drives) \u00a0Create a CacheCade virtual driveMegaCLI -CfgCacheCadeAdd [-rX]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Physdrv[E0:S0,...] {-Name\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 LdNamestring} [WT|WB|ForcedWB]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-assign -LX|L0,2,5..|LALL]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-Aallstorcli /cx add VD cachecade|cc\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Type=[0,1,10]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 drives=[e:]s|[e:]s-x|[e:]s-x,y\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [ &lt; WT| WB&gt; ] [assignvds=0,1,2]\u00a0storcli /c0 add vd type=road1 drives=252:2,252:3Create a RAID configuration of RAID\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 type 10, 50, and 60.MegaCli \u2013CfgSpanAdd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -R10|-R50|R60\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u2013Array0[E0:S0,E1:S1,...]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u2013Array1[E0:S0,E1:S1,...] [...]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [WT | WB] [NORA | RA | ADRA]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [Direct | Cached]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [CachedBadBBU|NoCachedBadBBU]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-szXXXXXXXX [-szYYYYYYYY [... ]]]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-strpszM] [\u2013afterLdX] -aNstorcli /cx add vd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 type=raid[10|50|60]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [Size=&lt;VD1_Sz&gt;,&lt;VD2_Sz&gt;,..|*all]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [name=&lt;VDNAME1&gt;,..]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 drives=e:s|e:s-x|e:s-x,y;e:s-x,y,z\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [PDperArray=x]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [SED] [pdcache=on|off|*default][pi]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [DimmerSwitch(ds)=default|automatic\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 (auto)|*none|maximum(max)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |MaximumWithoutCaching(maxnocache)]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [wt|*wb] [nora|*ra] [*direct|cached]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [CachedBadBBU|*NoCachedBadBBU]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [Stripe=&lt;8|16|32|64|128|256|512|102\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 4] [AfterVd=X]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [Spares=[e:]s|[e:]s-x|[e:]s-x,y]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [force] \u00a0Delete a virtual driveMegaCli -CfgClr [-Force]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx/vx delete or storcli /cx/vall (to delete all virtual drives) storcli /c0/v0 delete (warning:\u00a0 there is no warning given; using /c0/vall will delete all logical drives and data with no warning)  Show the topology information of\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 the drive groupMegaCLI -CfgDsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-Aall\u00a0storcli /cx/dall show [all]storcli /cx0/d0 show Show information for a CacheCade\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 virtual driveMegaCLI -CfgCacheCadeDsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-Aall\u00a0storcli /cx/dall show CacheCade(cc)\u00a0storcli /cx0/d0 show cc Delete a virtual drive hosting the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 operating systemMegaCLI -CfgLdDel\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -LX|-L0,2,5...|-LALL [-Force]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx/vx[all] delete -forcestorcli /c0/v0 del -force  \u00a0Delete a CacheCade virtual driveMegaCLI -CfgCacheCadeDel\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -LX|-L0,2,5...|-LALL\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-Aallstorcli /cx/vx[all] delete\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 CacheCade(cc)storcli /c0/vx del cc  Show, delete, and import the foreign\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 configuration commands.MegaCli \u2013CfgForeign \u2013Scan |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {-Preview | \u2013Dsply| -Import |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Clear[FID]} -aN|-a0,1,2|-aALL\"storcli /cx/f(x|all) show [all]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [securityKey=xxx]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/f(x|all) del|delete\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [securityKey=xxx]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/f(x|all) import\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [preview] [securityKey=xxx]\"storcli /c0/fall show  \u00a0Patrol Read Commands \u00a0Show the patrol read status and\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 patrol read parameters, if any in\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 progress. MegaCli -AdpPR -info\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0/cx show patrolRead/c0 show patrolread  \u00a0Set the patrol read options on a\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 single adapter, multiple adapters, or\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 all adapters (x = single controller). MegaCli -AdpPR\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u2013Dsbl|EnblAuto|EnblMan|Start|Stop|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Info|Suspend|Resume|Stop|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 SSDPatrolReadEnbl |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 SSDPatrolReadDsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |{SetDelay Val}|{-SetStartTime\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 yyyymmdd hh}|{maxConcurrentPD Val}\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0/cx set patrolread {=on\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mode=&lt;auto|manual&gt;}|{off}\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 /cx set patrolread [starttime=&lt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 yyyy/mm/dd hh&gt;]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [maxconcurrentpd=&lt;value&gt;]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [includessds=&lt;on|off&gt;]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [uncfgareas=on|off]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 /cx set patrolread delay=&lt;value&gt; /c0 set patrolread mode=manual  \u00a0Disable patrol read. MegaCli -AdpPR -Dsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx set patrolread=off storcli /c0 set patrolread=off\u00a0\u00a0Enable automatic patrol read.MegaCli -AdpPR -EnblAuto\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx set patrolread=on\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mode=auto\u00a0storcli /cx set patrolread=off\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mode=auto\u00a0Enable manual patrol read.MegaCli -AdpPR -EnblMan\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx set patrolread=on\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mode=manual\u00a0storcli /c0 set patrolread=on\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mode=manual\u00a0\u00a0Start patrol read.MegaCli -AdpPR -Start\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx start patrolRead\u00a0storcli /c0 start patrolRead\u00a0\u00a0Suspend a running patrol readMegaCli -AdpPR -Suspend\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx suspend patrolread\u00a0storcli /c0 suspend patrolread\u00a0\u00a0Resume a suspended patrol readMegaCli -AdpPR -Resume\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx resume patrolread\u00a0storcli /c0 resume patrolread\u00a0\u00a0Stop a running patrol readMegaCli -AdpPR -Stop\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx stop patrolRead\u00a0storcli /c0 stop patrolRead\u00a0\u00a0Include SSD drives in patrol readMegaCli -AdpPR -SSDPatrolReadEnbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx set patrolRead\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 includessds=on | onlymixed\u00a0storcli /c0 set patrolRead\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 includessds=on  \u00a0Exclude SSD drives in patrol read\u00a0MegaCli -AdpPR -SSDPatrolReadDsbl\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL storcli /cx set patrolRead\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 includessds=off\u00a0storcli /c0 set patrolRead\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 includessds=off\u00a0Delay a patrol readMegaCli -AdpPR -SetDelay Val\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx set patrolread\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 delay=&lt;value&gt; \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 note: &lt;value&gt; unit of time is in hours storcli /c0 set patrolread\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 delay=1  \u00a0Schedule a patrol readMegaCli -AdpPR -SetStartTime\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 yyyymmdd hh -aN|-a0,1,2|-aALLstorcli /cx set patrolread=on\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 starttime=YYYY/MM/DD HH Set the value for maximum\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 concurrent physical drives for the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 patrol read.MegaCli -AdpPR -maxConcurrentPD Val\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx set patrolread\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 maxconcurrentpd=xxstorcli /c0 set patrolread\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 maxconcurrentpd=255  Consistency Check Commands \u00a0Schedule a consistency checkMegaCLI -AdpCcSched -Dsbl|-Info|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {-ModeConc | -ModeSeq [-ExcludeLD\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -LN|-L0,1,2] [-SetStartTime yyyymmdd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 hh ] [-SetDelay val ] }\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 consistencycheck|cc=[off|seq|conc]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [delay=value] starttime=yyyy/mm/dd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 hh [excludevd=x-y,z]storcli /c0 set cc=off  Show consistency check status and consistency parameters, in progress,\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 if any.\u00a0MegaCLI -AdpCcSched -Info\u00a0storcli /cx show cc/ConsistencyCheck\u00a0storcli /c0 show cc OPROM BIOS Commands \u00a0Schedule a consistency checkMegaCli -AdpBIOS -Dsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx show bios\u00a0storcli /c0 show bios Show consistency check status and\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 consistency parameters, if any in\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 progress.MegaCli -AdpBootDrive -{-Set {-Lx |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -physdrv[E0:S0]}} -aN|-a0,1,2|-aALL\u00a0storcli /cx/ex/sx set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 bootdrive=on|off\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/vx set bootdrive=on|off storcli /c0/v0 set bootdrive=on  Sets the BIOS properties for the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 controller.MegaCli -AdpBIOS -Enbl | -Dsbl |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Dsply | SOE | BE\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 EnblAutoSelectBootLd |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 DsblAutoSelectBootLd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx set bios=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 stoponerror|soe=&lt;on|off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autobootselect(abs)=&lt;on|off&gt;\u00a0storcli /c0 set bios=on  Battery (BBU) Commands \u00a0Show battery-related information\u00a0MegaCli -AdpBbuCmd -aN|-a0,1,2|-aALLstorcli /cx/bbu show\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/bbu show allstorcli /c0/bbu show  \u00a0Show the battery learn propertiesMegaCli -AdpBbuCmd -GetBbuProperties\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx/bbu show properties\u00a0storcli /c0/bbu show propertiesShow the battery information,\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 firmware status, and the gas gauge\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 status.MegaCli -AdpBbuCmd -GetBbuStatus\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx/bbu show statusstorcli /c0/bbu show status  \u00a0Show battery capacity informationMegaCli -AdpBbuCmd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -GetBbuCapacityInfo\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx/bbu show allstorcli /c0/bbu show all\u00a0\u00a0Show battery design informationMegaCli -AdpBbuCmd -GetBbuDesignInfo\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/bbu show all\u00a0storcli /c0/bbu show all \u00a0Set battery propertiesMegaCli -AdpBbuCmd -SetBbuProperties\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -f &lt;fileName&gt; -aN|-a0,1,2|-aALLstorcli /cx/bbu set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 learnDelayInterval=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/bbu set bbuMode=&lt;value&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx bbu set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autolearnmode=&lt;value&gt;,\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 where x= 0 \u2013 Enabled, 1 \u2013 Disabled, 2 \u2013 Warn though\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 event.storcli /c0/bbu set bbumode=5 \u00a0Start battery learn cycleMegaCli -AdpBbuCmd -BbuLearn\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx/bbu start learn\u00a0storcli /co/bbu start learnSet the battery to low power storage\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mode.MegaCli -AdpBbuCmd -BbuMfgSleep\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/bbu set powermode=sleep\u00a0 Seal the gas gauge EEPROM write\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 accessMegaCli -AdpBbuCmd -BbuMfgSeal\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/bbu set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 writeaccess=sealed\u00a0 \u00a0Security Commands \u00a0Set the key ID for the controller.MegaCli -CreateSecurityKey\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -SecurityKey sssssssssss |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-Passphrase sssssssssss] |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-KeyID kkkkkkkkkkk] -aNstorcli /cx set SecurityKey=XXXXXX\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [passphrase=yyyyy] [keyId=zzzz]\u00a0 Change the security key for the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 controller.MegaCli -ChangeSecurityKey\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -OldSecurityKey sssssssssss |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -SecurityKey sssssssssss|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-Passphrase sssssssssss] |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-KeyID kkkkkkkkkkk] -aNstorcli /cx set SecurityKey=XXXXXX\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 OldSecurityKey=yyyyy\u00a0 Compare and verify the security key\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 for the controllerCompare and verify the security key\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 for the controllerCompare and verify the security key\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 for the controller\u00a0 \u00a0Delete the security keyMegaCLI -DestroySecurityKey |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-Force] -aN\u00a0storcli /cx delete SecurityKey \u00a0Set the security key for the controllerMegaCli -SetKeyID -KeyID kkkkkkkkkkk\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aNstorcli /cx set SecurityKey\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 KeyId=xxxx\u00a0 Virtual Drive Commands Show the virtual drive information\u00a0MegaCli \u2013LDInfo \u2013Lx|-L0,1,2|-Lall\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/v(x|all) show\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) show all Set virtual drive properties\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 MegaCli \u2013LDSetProp WT | WB|NORA |RA\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | ADRA|-Cached|Direct|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 CachedBadBBU|NoCachedBadBBU} |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -RW|RO|Blocked |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {-Name nameString} |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -EnDskCache|DisDskCache \u2013Lx|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -L0,1,2|-Lall -aN|-a0,1,2|-aALLstorcli /cx/v(x|all) set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 wrcache=WT|WB|AWB\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rdcache=RA|NoRA\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 iopolicy=Cached|Direct\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 accesspolicy=RW|RO|Blocked|RmvBlkd\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 pdcache=On|Off|Default\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 name=&lt;NameString&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \" Set power-saving (dimmer switch)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 properties.MegaCli -LDSetPowerPolicy -Default|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Automatic| -None| -Maximum|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -MaximumWithoutCaching\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALLstorcli /cx/v(x|all) set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ds=Default|Auto|None|Max|MaxNoCache Show virtual drive expansion\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 informationMegaCli -getLdExpansionInfo\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL\u00a0storcli /cx/v(x|all) show expansion Expand the virtual drive within the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 existing array; also use if you replace\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 the drives with larger drives, beyond\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 the size of the existing array.MegaCli -LdExpansion -pN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -dontExpandArray -Lx|-L0,1,2|-Lall\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/v(x|all) expand\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Size=&lt;value&gt; [expandarray] \u00a0Secure the virtual drive.MegaCLI --LDMakeSecure\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2,...|-Lall \u2013An\u00a0storcli /cx/vx set security=on Show specific properties of virtual\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 drives.MegaCli \u2013LDGetProp -Cache | -Access\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | -Name | -DskCache\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALLstorcli /cx/vx show Start virtual drive initializationMegaCli \u2013LDInit \u2013Start [Fast|Full]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALLstorcli /cx/v(x|all) start\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 init[Full] Stop a running virtual drive\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 initialization.MegaCli \u2013LDInit -Abort\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL\u00a0storcli /cx/v(x|all) stop init \u00a0Show the initialization progressMegaCli \u2013LDInit \u2013ShowProg\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL\u00a0storcli /cx/v(x|all) show init Start a consistency check on an\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 uninitialized virtual driveMegaCli \u2013LDCC \u2013Start\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u2013Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL\u00a0storcli /cx/v(x|all) start cc[Force] Start, stop, suspend, resume, and\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 show the progress of a consistency\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 check operationMegaCli -LDCC -Start|-Abort|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Suspend|-Resume|-ShowProg|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -ProgDsply -Lx|-L0,1,2|-LALL\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/v(x|all) start cc\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) stop cc\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) pause cc\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) resume cc\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) show cc Enable/disable automatic\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 background initialization. Show, stop,\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 pause, resume, and show the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 progress of the background\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 initialization.MegaCLI -LDBI -Enbl|-Dsbl|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -getSetting|-Abort|-Suspend|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Resume|-ShowProg|-ProgDsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2|-LALL -aN|-a0,1,2|-Aallstorcli /cx/v(x|all) set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 autobgi=On|Off\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) show autobgi\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) stop bgi\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) pause bgi\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) resume bgi\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) show bgi Start and show progress for a migrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 operation.MegaCli \u2013LDRecon {\u2013Start \u2013Rx [Add\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | Rmv PhysDrv[E0:S0,E1:S1,...] ] }\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | \u2013ShowProg|-ProgDsply \u2013Lx \u2013aNstorcli /cx/vx start migrate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 type=raidx [option=add|remove\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 drives=[e:]s|[e:]s-x|[e:]s-x,y]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [Force]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/v(x|all) show migrate \u00a0Delete preserved cacheMegaCLI -DiscardPreservedCache\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2|-Lall -force\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/v(x|all) delete\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 preservedcache[force] \u00a0Assign the CacheCade virtual driveMegaCLI -Cachecade -assign|-remove\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2|-LALL -aN|-a0,1,2|-aALLstorcli /cx/vx|all set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ssdCaching=on|off\u00a0Physical Drive Commands \u00a0Show drive informationMegaCli -pdInfo -\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 PhysDrv[E0:S0,E1:S1,...]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/ex/sx show\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx show all Start, stop, suspend, or resume an\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ongoing rebuild operation.MegaCLI PDRbld -Start|-Stop\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |-Suspend|-Resume|-ShowProg\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |-ProgDsply -PhysDrv\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [E0:S0,E1:S1,...]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/ex/sx start rebuild\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx stop rebuild\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx pause rebuild\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx resume rebuild\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx show rebuild Start, stop, pause, resume, or show\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 the progress of a copyback operation MegaCLI PDCpyBk -Start|-Stop\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |-Suspend|-Resume|-ShowProg\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |-ProgDsply -PhysDrv\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [E0:S0,E1:S1,...]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/ex/sx start copyback\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 target=exx:sxx\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx stop copyback\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx pause copyback\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx resume copyback\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx show copyback Mark a drive as missingMegaCli -PdMarkMissing\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -physdrv[E0:S0,E1:S1,...]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx/ex/sx set missing \u00a0Show missing drive informationMegaCli -PdGetMissing\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL storcli /cx/ex/sx show all\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 NOTE This information is shown as part of the show all\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 command. Replace the configured drive that is\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 identified as missing, and then start\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 an automatic rebuild.MegaCli -PdReplaceMissing\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -physdrv[E0:S0] -arrayA, -rowB\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN\u00a0storcli /cx/ex/sx insert array=x row=y Set the drive state to onlineMegaCli \u2013PDOnline -\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 PhysDrv[E0:S0,E1:S1....]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2\u00a0storcli /cx/ex/sx set online Set the drive state to offlineMegaCli \u2013PDOffline\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -PhysDrv[E0:S0,E1:S1....]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx/ex/sx set offline Set the drive state to JBODMegaCli \u2013PDMakeGood\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -PhysDrv[E0:S0,E1:S1....]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/ex/sx set good [force]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 or\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx set jbod  \u00a0Add and delete hotspare drivesMegaCli \u2013PDHSP {\u2013Set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [{-Dedicated -ArrayN |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Array0,1...}] [-EnclAffinity]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-nonRevertible] } |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Rmv -PhysDrv[E0:S0,E1:S1,...]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/ex/sx add hotsparedrive\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [dgs=&lt;N|0,1,2..&gt;] enclaffinity\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 nonrevertible\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx delete hotsparedriveStart, stop, pause, resume or show\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 the progress of an initialization\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 process.MegaCli \u2013PDClear -Start |-Stop|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -ShowProg |-ProgDsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 - PhysDrv[E0:S0,E1:S1....]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/ex/sx start initialization\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx stop initialization\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx pause initialization\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx resume initialization\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx show initialization Start a drive locate and activate (blink) the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 drive\u2019s LED or stop a drive locate (LED blinking) and\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 deactivate the drive\u2019s LEDMegaCli \u2013PDLocate {[-start] |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -stop} -physdrv[E0:S0,E1:S1,...]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/ex/sx start locate\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx stop locate Spin down an unconfigured drive\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 and prepare it for removal or spin up\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 spun-down drive and mark the drive\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 state as unconfigured good.MegaCli \u2013PDPrpRmv [-Undo]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u2013 PhysDrv[E0:S0,E1:S1....]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/ex/sx spindown\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx spinup Show physical drive information of all\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 connected drives.MegaCli \u2013PDList\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1..|-aAllstorcli /cx/eall/sall show [all]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 NOTE This command does not show drives whose enclosure device ID is not available. \u00a0Flash the physical drive firmwareMegaCLI PdFwDownload[offline]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [ForceActivate] {[-SataBridge]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -PhysDrv[0:1]}|{-EncdevId[devId1\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ]} -f &lt;filename&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-Aallstorcli /cx[/ex]/sx download\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 src=&lt;filepath&gt; [satabridge]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex download src=&lt;filepath&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [forceActivate] Erase the drive's security\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 configuration and securely erase data on a drive.MegaCli -PDInstantSecureErase\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -PhysDrv[E0:S0,E1:S1,...] |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-Force] -aN|-a0,1,2|-aALL\u00a0storcli /cx/ex/sx secureerase [force] Show the security key for secured physical drivesMegaCli -GetKeyID\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-PhysDrv[E0:S0]] -aNstorcli /cx/ex/sx show securitykey\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 keyid Start, stop, and show the progress of\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 a secure erase operationMegaCli -SecureErase Start[\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Simple|\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [Normal [ |ErasePattern\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ErasePatternA|ErasePattern\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ErasePatternA ErasePattern\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ErasePatternB]]|[Thorough [\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 |ErasePattern\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ErasePatternA|ErasePattern\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ErasePatternA ErasePattern\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ErasePatternB]]]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | Stop| ShowProg| ProgDsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [-PhysDrv [E0:S0,E1:S1,...] |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Lx|-L0,1,2|-LALL]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx[/ex]/sx start erase\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [simple| normal| thorough]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [erasepatternA=&lt;val&gt;]\\n[erasepatternB=&lt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 val&gt;]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Examples:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx start erase simple\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx start erase normal\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 erasepatterna=10101010\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx start erase thorough\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 erasepatterna=10101010\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 erasepatternb=10101111\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex/sx stop erase Enable/disable the direct physical\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 drive mapping mode.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Show the current state of the direct physical drive mapping.MegaCLI DirectPdMapping\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -Enbl|-Dsbl|-Dsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-Aallstorcli /cx set directpdmapping=&lt;on |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 off&gt;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx show directpdmapping Enclosure Commands Show enclosure information\u00a0MegaCli \u2013EncInfo\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/ex show\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/ex show all Show enclosure statusMegaCli \u2013EncStatus\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0/cx/ex show status Download enclosure firmware. /cx/ex download src=filepath\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [offline] [forceActivate \u00a0PHY Commands \u00a0Show PHY informationMegaCli \u2013PHYInfo -phyM\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx/px(x|all) show\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/px(x|all) show all \u00a0Set PHY link speedMegaCLI PhySetLinkSpeed -phyM\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -speed -aN|-a0,1,2|-aALLstorcli /cx/px(x|all) set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 linkspeed=1.5|3|6|12|auto \u00a0Show the PHY error counters.\u00a0Megacli PhyErrorCounters -Anstorcli /cx/px(x|all) show\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 storcli /cx/px(x|all) show all \u00a0Alarm Commands \u00a0Show alarm propertiesMegaCli -AdpGetProp AlarmDsply\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx(x|all) show alarm \u00a0Set alarm propertiesMegaCli -AdpSetProp AlarmEnbl |\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 AlarmDsbl | AlarmSilence\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx(x|all) set\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 alarm=&lt;on|off|silence&gt; \u00a0Event Log Properties Commands Show event logs.MegaCli -AdpEventLog\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -GetEventLogInfo\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0/cx show eventloginfo Show the specified type of event\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 logs.MegaCli -AdpEventLog -GetEvents\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {-info -warning -critical\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -fatal} {-f &lt;fileName&gt;}\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx show events\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [type=[latest=x|ccincon\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 vd=|[sincereboot|sinceshutdown|included\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eleted|latest|ccincon]]]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [filter=[info|warning|critical|fatal]]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 file=xyz.txt Show the specified event logsMegaCli -AdpEventLog\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -GetSinceShutdown {-info\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -warning -critical -fatal}\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {-f &lt;fileName&gt;}\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALLstorcli /cx show events\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [type=[latest=x|ccincon\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 vd=|[sincereboot|sinceshutdown|included\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 eleted|latest|ccincon]]]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [filter=[info|warning|critical|fatal]]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 file=xyz.txt \u00a0Delete the event logs.MegaCli -AdpEventLog -Clear\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -aN|-a0,1,2|-aALL\u00a0storcli /cx delete events Premium Feature Key Commands \u00a0Show the Safe ID of the controller\u00a0MegaCli -ELF -GetSafeId -a0\u00a0storcli /cx(x|all) show safeid Show the Advanced Software\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Options that are enabled on the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 controller, including the ones in trial mode.MegaCli -ELF \u2013ControllerFeatures\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -a0MegaCli -ELF \u2013ControllerFeatures\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -a0 Apply the Activation Key in preview mode.MegaCli -ELF -Applykey key \u2013val\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -preview -a0storcli /cx(x|all) set aso key=&lt;key\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 value&gt; preview \u00a0Apply the Activation KeyMegaCli -ELF -Applykey key \u2013val\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -a0storcli /cx(x|all) set aso key=&lt;key\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 value&gt; \u00a0Deactivate the trial keyMegaCli -ELF\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u2013DeactivateTrialKey -a0storcli /cx(x|all) set aso\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 deactivatetrialkey Show the re-host information and, if re-hosting is necessary, show the controller and key vault serial\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 numbers.\u00a0MegaCli -ELF -ReHostInfo -a0\u00a0storcli /cx(x|all) show rehostinfo Indicate to the controller that the\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 re-host is complete\u00a0MegaCli -ELF -ReHostComplete -a0storcli /cx(x|all) set aso\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 rehostcomplete <p></p>"},{"location":"megaraid/","title":"MegaRAID Policy","text":"<p>lsi_cackecade_pro_2.0_test PDF</p>"},{"location":"megaraid/#raidwrite-policyread-policycache-policy","title":"\u505aRAID\u65f6Write Policy,Read Policy,Cache Policy\u5982\u4f55\u914d\u7f6e","text":""},{"location":"megaraid/#read-aheadscsi","title":"Read-ahead\uff08\u9884\u8bfb\uff09\u542f\u7528\u903b\u8f91\u9a71\u52a8\u5668\u7684SCSI\u9884\u8bfb\u529f\u80fd\u3002 \u53ef\u5c06\u6b64\u53c2\u6570\u8bbe\u4e3a","text":"<ol> <li>No-Read-Ahead\uff08\u975e\u9884\u8bfb\uff09</li> <li>Read-ahead\uff08\u9884\u8bfb\uff09</li> <li>Adaptive\uff08\u81ea\u9002\u5e94\uff09\u3002 \u9ed8\u8ba4\u8bbe\u7f6e\u4e3aAdaptive\uff08\u81ea\u9002\u5e94\uff09\u3002</li> </ol>"},{"location":"megaraid/#no-read-ahead","title":"No-Read-Ahead\uff08\u975e\u9884\u8bfb\uff09","text":"<ul> <li>\u6307\u5b9a\u63a7\u5236\u5668\u5728\u5f53\u524d\u903b\u8f91\u9a71\u52a8\u5668\u4e2d\u4e0d\u4f7f\u7528\u9884\u8bfb\u65b9\u5f0f\u3002</li> </ul>"},{"location":"megaraid/#read-ahead","title":"Read-ahead\uff08\u9884\u8bfb\uff09","text":"<ul> <li>\u6307\u5b9a\u63a7\u5236\u5668\u5728\u5f53\u524d\u903b\u8f91\u9a71\u52a8\u5668\u4e2d\u4f7f\u7528\u9884\u8bfb\u65b9\u5f0f\u3002</li> </ul>"},{"location":"megaraid/#adaptive","title":"Adaptive\uff08\u81ea\u9002\u5e94\uff09","text":"<ul> <li>\u6307\u5b9a\u5982\u679c\u6700\u8fd1\u4e24\u6b21\u7684\u78c1\u76d8\u8bbf\u95ee\u51fa\u73b0\u5728\u8fde\u7eed\u7684\u6247\u533a\u5185\uff0c\u5219\u63a7\u5236\u5668\u5f00\u59cb\u91c7\u7528Read-ahead\uff08\u9884\u8bfb\uff09\u3002 </li> <li>\u5982\u679c\u6240\u6709\u7684\u8bfb\u53d6\u8bf7\u6c42\u90fd\u662f\u968f\u673a\u7684\uff0c\u5219\u8be5\u7b97\u6cd5\u56de\u590d\u5230No-Read-Ahead\uff08\u975e\u9884\u8bfb\uff09\uff0c\u4f46\u4ecd\u8981\u5224\u65ad\u6240\u6709\u7684\u8bfb\u53d6\u8bf7\u6c42\u662f\u5426\u6709\u6309\u987a\u5e8f\u64cd\u4f5c\u7684\u53ef\u80fd\u3002</li> </ul>"},{"location":"megaraid/#cache-policy-read-ahead","title":"Cache Policy\uff08\u9ad8\u901f\u7f13\u5b58\u7b56\u7565\uff09 \u9002\u5408\u5728\u7279\u5b9a\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\u8bfb\u53d6\u3002 \u5b83\u5e76\u4e0d\u5f71\u54cdRead ahead\uff08\u9884\u8bfb\uff09\u9ad8\u901f\u7f13\u5b58\u3002","text":"<ul> <li>Cached I/O\uff08\u9ad8\u901f\u7f13\u5b58I/O\uff09\u6307\u5b9a\u6240\u6709\u8bfb\u53d6\u6570\u636e\u5728\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u4e2d\u7f13\u5b58\u3002</li> <li>Direct I/O\uff08\u76f4\u63a5I/O\uff09\u6307\u5b9a\u8bfb\u53d6\u6570\u636e\u4e0d\u5728\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u4e2d\u7f13\u5b58\u3002 \u6b64\u4e3a\u9ed8\u8ba4\u8bbe\u7f6e\u3002 <ul> <li>\u5b83\u4e0d\u4f1a\u4ee3\u66ff\u9ad8\u901f\u7f13\u5b58\u7b56\u7565\u8bbe\u7f6e\u3002\u6570\u636e\u88ab\u540c\u65f6\u4f20\u9001\u5230\u9ad8\u901f\u7f13\u5b58\u548c\u4e3b\u673a\u3002 </li> <li>\u5982\u679c\u518d\u6b21\u8bfb\u53d6\u540c\u4e00\u6570\u636e\u5757\uff0c\u5219\u4ece\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u8bfb\u53d6</li> </ul> </li> </ul>"},{"location":"megaraid/#write-policy","title":"Write Policy\uff08\u5199\u5165\u7b56\u7565\uff09 \u5c06\u9ad8\u901f\u7f13\u5b58\u65b9\u6cd5\u8bbe\u7f6e\u4e3a\u56de\u5199\u6216\u901a\u8fc7\u5199\u3002","text":"<ul> <li>\u5728Write-back\uff08\u56de\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u4e2d\uff0c\u5f53\u63a7\u5236\u5668\u9ad8\u901f\u7f13\u5b58\u5df2\u63a5\u6536\u5230\u67d0\u4e2a\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u6570\u636e\u65f6\uff0c\u8be5\u63a7\u5236\u5668\u5c06\u6570\u636e\u4f20\u8f93\u5b8c\u6210\u4fe1\u53f7\u53d1\u9001\u7ed9\u4e3b\u673a\u3002</li> <li>\u5728Write-through\uff08\u901a\u8fc7\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u4e2d\uff0c\u5f53\u78c1\u76d8\u5b50\u7cfb\u7edf\u5df2\u63a5\u6536\u5230\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u6570\u636e\u65f6\uff0c\u8be5\u63a7\u5236\u5668\u5c06\u6570\u636e\u4f20\u8f93\u5b8c\u6210\u4fe1\u53f7\u53d1\u9001\u7ed9\u4e3b\u673a\u3002</li> <li>Write-through\uff08\u901a\u8fc7\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u4e0eWrite-back\uff08\u56de\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u76f8\u6bd4\u5177\u6709\u6570\u636e\u5b89\u5168\u7684\u4f18\u52bf\uff0c\u4f46Write-back\uff08\u56de\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u6bd4\u8d77Write-through\uff08\u901a\u8fc7\u5199\uff09\u53c8\u6709\u6027\u80fd\u4e0a\u7684\u4f18\u52bf\u3002</li> </ul>"},{"location":"megaraid/#raid","title":"\u67e5\u770bRAID\u5361\u7535\u6c60\u60c5\u51b5","text":"<pre><code>MegaCli64 -AdpBbuCmd -GetBbuStatus -aAll\n</code></pre> <p>\u5982\u679c\u8fd4\u56de\u5982\u4e0b\u9519\u8bef\u90a3\u4e48\u53ef\u80fd\u662fRAID\u5361BUU\u7535\u6c60\u6709\u95ee\u9898\u6216\u8005\u6ca1\u6709\u7535\u6c60\u4fdd\u62a4\u529f\u80fd\uff1a</p> <pre><code>Adapter 0: Get BBU Status Failed.\n\nFW error description:\n\n  The required hardware component is not present. \n\nExit Code: 0x22\n</code></pre>"},{"location":"megaraid/#raid_1","title":"\u67e5\u770b\u5f53\u524dRAID\u5361\u7f13\u5b58\u7b56\u7565","text":"<pre><code># MegaCli64 -LDinfo -Lall -aAll\nDefault Cache Policy: WriteThrough, ReadAheadNone, Direct, No Write Cache if Bad BBU\n\nCurrent Cache Policy: WriteThrough, ReadAheadNone, Direct, No Write Cache if Bad BBU\n</code></pre> <p>\u7b2c\u4e00\u90e8\u5206\uff1a</p> <p>WriteBack:\u5199\u7f13\u5b58\u7b56\u7565</p> <p>WriteThrough:\u76f4\u63a5\u5199\u5165\u78c1\u76d8\uff0c\u4e0d\u9002\u7528RAID\u5361\u7f13\u5b58\u3002</p> <p>\u7b2c\u4e8c\u90e8\u5206\uff1a</p> <p>ReadAheadNone:\u4e0d\u5f00\u542f\u9884\u8bfb</p> <p>ReadAhead:\u5f00\u542f\u9884\u8bfb\uff0c\u5728\u8bfb\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u9884\u5148\u628a\u540e\u9762\u987a\u5e8f\u7684\u6570\u636e\u8f7d\u5165raid\u5361\u7f13\u5b58\uff0c\u5728\u987a\u5e8f\u8bfb\u7684\u73af\u5883\u4e2d\u80fd\u63d0\u4f9b\u5f88\u597d\u7684\u6027\u80fd\uff0c\u4f46\u662f\u5728\u968f\u673a\u8bfb\u7684\u73af\u5883\u4e2d\u53cd\u800c\u964d\u4f4e\u8bfb\u7684\u6027\u80fd\uff08\u9002\u5408\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e0d\u9002\u5408\u6570\u636e\u5e93\u7cfb\u7edf\uff09</p> <p>ReadAdaptive:\u81ea\u9002\u5e94\u9884\u8bfb\uff0c\u5728\u7f13\u5b58\u548cI/O\u7a7a\u95f2\u65f6\u9009\u62e9\u9884\u8bfb\uff0c\u9ed8\u8ba4\u7b56\u7565\u3002</p> <p>\u7b2c\u4e09\u90e8\u5206\uff1a</p> <p>Direct:\u8bfb\u64cd\u4f5c\u4e0d\u7f13\u5b58\u5230RAID\u5361\u7f13\u5b58\u3002</p> <p>Cached:\u8bfb\u64cd\u4f5c\u7f13\u5b58\u5230RAID\u5361\u7f13\u5b58\u3002</p> <p>\u7b2c\u56db\u90e8\u5206\uff1a\u5982\u679cBBU(\u7535\u6c60)\u51fa\u73b0\u95ee\u9898\u662f\u5426\u542f\u7528Write Cache</p> <p>No Write Cache if Bad BBU:\u5982\u679cBBU\u51fa\u73b0\u95ee\u9898\u4e0d\u4f7f\u7528Write Cache\uff0c\u4eceWriteBack\u81ea\u52a8\u5207\u6362\u5230WriteThrough\uff0c\u9ed8\u8ba4\u914d\u7f6e\u3002</p> <p>Write Cache OK if Bad BBU: \u5982\u679cBBU\u51fa\u73b0\u95ee\u9898\u4ecd\u542f\u7528Write Cache,\u8fd9\u79cd\u914d\u7f6e\u662f\u975e\u5e38\u4e0d\u5b89\u5168\u7684\uff0c\u9664\u975e\u662f\u6709UPS\u6216\u8005\u53cc\u7535\u6e90\u7684\u60c5\u51b5\u4e0b\u3002</p>"},{"location":"megaraid/#raid_2","title":"RAID\u5361\u7b56\u7565\u66f4\u6539","text":"<p>\u4fee\u6539WriteBack\uff1a</p> <p><code>MegaCli64 -LDSetProp -WB -Lall -aAll</code></p> <p>\u4fee\u6539WriteThrough:</p> <p><code>MegaCli64 -LDSetProp -WT -Lall -aAll</code></p> <p>\u4fee\u6539No Write Cache if Bad BBU:</p> <p><code>MegaCli64 -LDSetProp -NoCachedBadBBU -Lall -aAll</code></p> <p>\u4fee\u6539Write Cache OK if Bad BBU:</p> <p><code>MegaCli64 -LDSetProp -CachedBadBBU -Lall -aAll</code></p>"},{"location":"megaraid/#_1","title":"\u5176\u5b83\u76f8\u5173\u547d\u4ee4","text":"\u5176\u5b83\u76f8\u5173\u547d\u4ee4  <pre>\n\n\u67e5\u770b\u673a\u5668\u578b\u53f7    # dmidecode | grep \"Product\" \n\n\u67e5\u770b\u5382\u5546    # dmidecode| grep \"Manufacturer\" \n\n\u67e5\u770b\u5e8f\u5217\u53f7    # dmidecode | grep \"Serial Number\" \n\n\u67e5\u770bCPU\u4fe1\u606f    # dmidecode | grep \"CPU\" \n\n\u67e5\u770bCPU\u4e2a\u6570    # dmidecode | grep \"Socket Designation: CPU\" |wc \u2013l \n\n\u67e5\u770b\u51fa\u5382\u65e5\u671f    # dmidecode | grep \"Date\" \n\n\u67e5\u770b\u5145\u7535\u72b6\u6001    # MegaCli64 -AdpBbuCmd-GetBbuStatus -aALL |grep \"Charger Status\" \n\n\u663e\u793aBBU\u72b6\u6001\u4fe1\u606f    # MegaCli64 -AdpBbuCmd-GetBbuStatus \u2013aALL \n\n\u663e\u793aBBU\u5bb9\u91cf\u4fe1\u606f    # MegaCli64 -AdpBbuCmd-GetBbuCapacityInfo \u2013aALL \n\n\u663e\u793aBBU\u8bbe\u8ba1\u53c2\u6570    # MegaCli64 -AdpBbuCmd-GetBbuDesignInfo \u2013aALL \n\n\u663e\u793a\u5f53\u524dBBU\u5c5e\u6027    # MegaCli64 -AdpBbuCmd-GetBbuProperties \u2013aALL \n\n\u67e5\u770b\u5145\u7535\u8fdb\u5ea6\u767e\u5206\u6bd4    # MegaCli64 -AdpBbuCmd-GetBbuStatus -aALL |grep \"Relative State of Charge\" \n\n\u67e5\u8be2Raid\u9635\u5217\u6570    # MegaCli64 -cfgdsply -aALL|grep \"Number of DISK GROUPS:\" \n\n\u663e\u793aRaid\u5361\u578b\u53f7\uff0cRaid\u8bbe\u7f6e\uff0cDisk\u76f8\u5173\u4fe1\u606f      # MegaCli64-cfgdsply \u2013aALL \n\n\u663e\u793a\u6240\u6709\u7269\u7406\u4fe1\u606f    # MegaCli64 -PDList-aALL \n\n\u663e\u793a\u6240\u6709\u903b\u8f91\u78c1\u76d8\u7ec4\u4fe1\u606f    # MegaCli64 -LDInfo -LALL\u2013aAll \n\n\u67e5\u770b\u7269\u7406\u78c1\u76d8\u91cd\u5efa\u8fdb\u5ea6(\u91cd\u8981)    # MegaCli64 -PDRbld-ShowProg -PhysDrv [1:5] -a0 \n\n\u67e5\u770b\u9002\u914d\u5668\u4e2a\u6570    #MegaCli64 \u2013adpCount \n\n\u67e5\u770b\u9002\u914d\u5668\u65f6\u95f4    #MegaCli64 -AdpGetTime\u2013aALL \n\n\u663e\u793a\u6240\u6709\u9002\u914d\u5668\u4fe1\u606f    #MegaCli64 -AdpAllInfo\u2013aAll \n\n\u67e5\u770bCache \u7b56\u7565\u8bbe\u7f6e    # MegaCli64 -cfgdsply -aALL|grep Polic\n\nradi\u5361\u7535\u6c60\u5145\u653e\u7535:http://www.tuicool.com/articles/a2AzAb\n</pre>"},{"location":"mysql-ha/","title":"mysql+keepalived\u642d\u5efa\u6559\u7a0b","text":"<ul> <li>Mysql\u96c6\u7fa4\u4e4bmysql\u53cc\u4e3b\u53cc\u6d3b+keepalived\u5b9e\u73b0\u9ad8\u53ef\u7528mysql+keepalived\u642d\u5efa\u6559\u7a0b</li> </ul>"},{"location":"mysql-ha/#_1","title":"\u4e00\u3001\u4ecb\u7ecd","text":"<p>MySQL\u53cc\u4e3b\u53cc\u6d3b\u662f\u6307\u4e24\u53f0mysql\u670d\u52a1\u5668mysql-1\u3001mysql-2\u90fd\u4e3amaster\u4e3b\u8282\u70b9\u670d\u52a1\u5668\uff0c\u540c\u65f6\u53c8\u662f\u5bf9\u65b9\u7684slave\u4ece\u8282\u70b9\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u90fd\u53ef\u4f5c\u4e3a\u4e3b\u6570\u636e\u5e93\u4f7f\u7528\uff0c\u5e76\u5c06\u5bf9\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u6570\u636e\u540c\u6b65\u81f3\u53e6\u5916\u4e00\u53f0mysql\u670d\u52a1\u4e2d\u3002</p> <p>\u5f53\u5e94\u7528\u670d\u52a1\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86mysql-1\u8fde\u63a5\u4fe1\u606f\uff0c\u5728\u6253\u5305\u53d1\u5e03\u540e\uff0c\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f\u5df2\u7ecf\u56fa\u5b9a\uff0c\u5f53\u6570\u636e\u5e93mysql-1\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u9700\u8981\u4eba\u5de5\u5e72\u9884\u5148\u5c06\u5e94\u7528\u670d\u52a1\u505c\u6b62--&gt;\u5c06\u5e94\u7528\u670d\u52a1\u7684mysql\u8fde\u63a5\u4fe1\u606f\u6539\u4e3amysql-2 --&gt;\u5728\u542f\u52a8\u5e94\u7528\u670d\u52a1\u5668\uff0c\u6bd4\u8f83\u7e41\u7410\uff0c\u5f53\u5e94\u7528\u670d\u52a1\u5668\u8f83\u591a\u65f6\uff0c\u4e00\u4e2a\u4e00\u4e2a\u5173\u95ed\uff0c\u4fee\u6539\uff0c\u518d\u91cd\u542f\uff0c\u5c06\u803d\u8bef\u66f4\u591a\u65f6\u95f4\uff0c\u5e94\u7528\u670d\u52a1\u5668\u4fee\u590d\u6545\u969c\u65f6\u95f4\u5ef6\u957f\uff0c\u4e25\u91cd\u65f6\u4f1a\u9020\u6210\u707e\u96be\u6027\u7684\u540e\u679c\u3002</p> <p>\u6545\u800c\u5f15\u5165\u4e86keepalived\uff0ckeepalived\u901a\u8fc7VIP\u865a\u62dfIP\u7684\u6f02\u79fb\u5b9e\u73b0\u9ad8\u53ef\u7528\uff0c\u5728\u76f8\u540c\u96c6\u7fa4\u5185\u53d1\u9001\u7ec4\u64ad\u5305\uff0cmaster\u4e3b\u901a\u8fc7VRRP\u534f\u8bae\u53d1\u9001\u7ec4\u64ad\u5305\uff0c\u544a\u8bc9\u4ece\u4e3b\u7684\u72b6\u6001\u3002</p> <p>\u5f53\u6211\u4eec\u901a\u8fc7keepalived\u865a\u62df\u51fa\u4e00\u4e2aip\u670d\u52a1 mysql-3\uff0c\u5e94\u7528\u670d\u52a1\u53ea\u9700\u8981\u5c06mysql\u914d\u7f6e\u4fe1\u606f\u66f4\u6539\u4e3amysql-3\u7684\u914d\u7f6e\u4fe1\u606f\uff0cmysql-3\u5b9e\u9645\u4ee3\u7406\u7684\u5b9e\u4f53\u670d\u52a1\u5668\u4e3amysql-1\u6216mysql-2\u3002</p> <p>\u4f8b\u5982\uff1a\u5f53mysql-3\u5b9e\u9645\u4ee3\u7406mysql-1\u65f6\uff0cmysql-1\u670d\u52a1\u51fa\u73b0\u6545\u969c\u540e\uff0ckeepalived\u901a\u8fc7\u81ea\u8eab\u673a\u5236\uff0c\u81ea\u52a8\u5c06mysql-2\u4f5c\u4e3a\u5b9e\u9645\u4ee3\u7406\u4e3b\u670d\u52a1\u5668\uff0c\u4e0d\u9700\u8981\u4eba\u5de5\u5e72\u9884\u53bb\u4fee\u6539mysql\u914d\u7f6e\u4fe1\u606f\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u9ad8\u53ef\u7528\u3002</p>"},{"location":"mysql-ha/#_2","title":"\u4e8c\u3001\u51c6\u5907\u5de5\u4f5c","text":"<ol> <li> <p>\u4e24\u53f0centos7 linux\u670d\u52a1\u5668</p> <ul> <li>mysql-1\uff1a192.168.222.128</li> <li>mysql-2\uff1a192.168.222.129</li> </ul> </li> <li> <p>mysql\u5b89\u88c5\u5305</p> <ul> <li>\u7248\u672c\uff1amysql-5.7.36-el7-x86_64.tar.gz</li> <li>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://cdn.mysql.com/archives/mysql-5.7/mysql-test-5.7.36-el7-x86_64.tar.gz</li> </ul> </li> <li> <p>keepalived\u5b89\u88c5\u5305</p> <ul> <li>\u7248\u672c\uff1akeepalived-2.2.7.tar.gz</li> <li>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://www.keepalived.org/software/keepalived-2.2.7.tar.gz</li> </ul> </li> </ol>"},{"location":"mysql-ha/#mysql","title":"\u4e09\u3001\u5b89\u88c5mysql","text":"<ol> <li> <p>\u5728128\u3001129\u4e24\u53f0\u670d\u52a1\u5668\u6839\u636e\u300alinux\u5b89\u88c5mysql\u670d\u52a1-\u4e24\u79cd\u5b89\u88c5\u65b9\u5f0f\u6559\u7a0b\u300b\u5b89\u88c5\u597dmysql\u5e94\u7528\u3002</p> </li> <li> <p>\u4fee\u6539128\u670d\u52a1\u5668/etc/my.cnf\u914d\u7f6e\u6587\u4ef6\uff0c\u6ca1\u6709\u7684\u8bdd\u53ef\u81ea\u884c\u521b\u5efa\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a</p> </li> </ol> <pre><code>[client]\n# \u5ba2\u6237\u7aef\u8fde\u63a5\u7aef\u53e3\nport=3306\n# \u5ba2\u6237\u7aef\u8fde\u63a5sock\nsocket=/opt/mysql5.7/log/mysql.socka\n# \u5ba2\u6237\u7aef\u7f16\u7801\ndefault-character-set=utf8\n[mysqld]\n# mysql\u670d\u52a1\u7aef\u53e3\nport=3306\n#\u5b89\u88c5\u76ee\u5f55\nbasedir=/opt/mysql5.7\n#\u6570\u636e\u5b58\u653e\u76ee\u5f55\ndatadir=/opt/mysql5.7/data\n#sock\u6587\u4ef6\u5730\u5740\nsocket=/opt/mysql5.7/log/mysql.sock\n#\u9519\u8bef\u65e5\u5fd7\u5b58\u653e\u5730\u5740\nlog-error=/opt/mysql5.7/log/mysql.log\n#pid\u6587\u4ef6\u5730\u5740\npid-file=/opt/mysql5.7/log/mysql.pid\n#\u4e0b\u9762\u5185\u5bb9\u4e3amysq\u4e3b\u5907\u65f6\u914d\u7f6e\uff0c\u5355mysql\u90e8\u7f72\u62a4\u7406\u4e0b\u9762\u914d\u7f6e\n#server-id \u591a\u53f0\u670d\u52a1\u5668\u65f6\uff0c\u6b64\u8868\u793a\u9700\u8981\u552f\u4e00\nserver-id=1\n#\u4e3b\u4ece\u540c\u6b65bin-log\u65e5\u5fd7\u6587\u4ef6\u540d\nlog-bin=mysql-bin\n#\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_do_db\u914d\u7f6e\nbinlog_do_db=test_db\n#\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u4e0d\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_ignore_db\u914d\u7f6e\n#binlog_ignore_db=mysql\n#binlog_ignore_db=information_schema\n#binlog_ignore_db=sys\n#binlog_ignore_db=performance_schema\n#\u4e3b\u4ece\u540c\u6b65\u65b9\u5f0f\nbinlog_format=row\n#\u670d\u52a1\u7aef\u7f16\u7801\ncharacter-set-server=utf8\n!includedir /etc/my.cnf.d\n</code></pre> <ol> <li>\u4fee\u6539129\u670d\u52a1\u5668/etc/my.cnf\u914d\u7f6e\u6587\u4ef6\uff0c\u53ea\u6709server-id\u4e0d\u540c\uff0c\u4e3a2\u914d\u7f6e\u5982\u4e0b</li> </ol> <pre><code>[client]\n#\u5ba2\u6237\u7aef\u8fde\u63a5\u7aef\u53e3\nport=3306\n#\u5ba2\u6237\u7aef\u8fde\u63a5sock\nsocket=/opt/mysql5.7/log/mysql.socka\n#\u5ba2\u6237\u7aef\u7f16\u7801\ndefault-character-set=utf8\n\n[mysqld]\n#mysql\u670d\u52a1\u7aef\u53e3\nport=3306\n#\u5b89\u88c5\u76ee\u5f55\nbasedir=/opt/mysql5.7\n#\u6570\u636e\u5b58\u653e\u76ee\u5f55\ndatadir=/opt/mysql5.7/data\n#sock\u6587\u4ef6\u5730\u5740\nsocket=/opt/mysql5.7/log/mysql.sock\n#\u9519\u8bef\u65e5\u5fd7\u5b58\u653e\u5730\u5740\nlog-error=/opt/mysql5.7/log/mysql.log\n#pid\u6587\u4ef6\u5730\u5740\npid-file=/opt/mysql5.7/log/mysql.pid\n\n#\u4e0b\u9762\u5185\u5bb9\u4e3amysq\u4e3b\u5907\u65f6\u914d\u7f6e\uff0c\u5355mysql\u90e8\u7f72\u62a4\u7406\u4e0b\u9762\u914d\u7f6e\n#server-id \u591a\u53f0\u670d\u52a1\u5668\u65f6\uff0c\u6b64\u8868\u793a\u9700\u8981\u552f\u4e00\nserver-id=2\n#\u4e3b\u4ece\u540c\u6b65bin-log\u65e5\u5fd7\u6587\u4ef6\u540d\nlog-bin=mysql-bin\n#\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_do_db\u914d\u7f6e\nbinlog_do_db=test_db\n#\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u4e0d\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_ignore_db\u914d\u7f6e\n#binlog_ignore_db=mysql\n#binlog_ignore_db=information_schema\n#binlog_ignore_db=sys\n#binlog_ignore_db=performance_schema\n#\u4e3b\u4ece\u540c\u6b65\u65b9\u5f0f\nbinlog_format=row\n#\u670d\u52a1\u7aef\u7f16\u7801\ncharacter-set-server=utf8\n\n!includedir /etc/my.cnf.d\n</code></pre> <ol> <li>\u91cd\u542fmysql\u670d\u52a1</li> </ol> <pre><code>[root@128 mysql5.7]# systemctl stop mysqld\n[root@128 mysql5.7]# systemctl start mysqld\n</code></pre>"},{"location":"mysql-ha/#mysql_1","title":"\u56db\u3001mysql\u6570\u636e\u5e93\u53cc\u4e3b\u53cc\u4ece\u914d\u7f6e","text":"<p>1.\u8fde\u63a5128\u670d\u52a1\u5668mysql\uff0c\u5e76\u521b\u5efa\u4e3b\u4ece\u540c\u6b65\u8d26\u6237slavebak\uff0c\u5e76\u67e5\u770bmaster\u72b6\u6001\uff0c\u8bb0\u5f55\u4e0bfile\u3001psition\u503c\uff0c\u914d\u7f6e129mysql\u4ece\u5e93\u65f6\u4f7f\u7528</p> <pre><code>[root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot\nmysql: [Warning] Using a password on the command line interface can be insecure.\n......\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; grant replication slave on *.* to slavebak@'%' identified by 'slavebak';\nmysql&gt; flush privileges;\nmysql&gt; show master status;\n+------------------+----------+--------------+------------------+-------------------+\n| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |\n+------------------+----------+--------------+------------------+-------------------+\n| mysql-bin.000002 |     1287 | test_db      |                  |                   |\n+------------------+----------+--------------+------------------+-------------------+\n1 row in set (0.01 sec)\nmysql&gt;\n</code></pre> <p>2.\u8fde\u63a5129\u670d\u52a1\u5668\uff0c\u4f7f\u7528slavebak\u7528\u6237\u8fdc\u7a0b\u767b\u5f55128mysql\uff0c\u6d4b\u8bd5\u8fde\u63a5\u662f\u5426\u6b63\u5e38\u3002</p> <pre><code>[root@129 ~]# /opt/mysql5.7/bin/mysql -h192.168.222.128 -uslavebak -pslavebak\nmysql: [Warning] Using a password on the command line interface can be insecure.\n......\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; exit;\n[root@129 ~]# \n</code></pre> <p>3.\u5728129\u670d\u52a1\u5668\u7528root\u8fde\u63a5\u672c\u670d\u52a1\u5668mysql\uff0c\u5e76\u914d\u7f6e128\u7684\u4e3b\u5e93\u4fe1\u606f</p> <pre><code>[root@129 ~]# /opt/mysql5.7/bin/mysql -uroot -proot\nmysql: [Warning] Using a password on the command line interface can be insecure.\n......\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; change master to \n    -&gt; master_host='192.168.222.128',            #128\u670d\u52a1\u5668mysql ip\n    -&gt; master_port=3306,                         #128\u670d\u52a1\u5668mysql\u7aef\u53e3\n    -&gt; master_user='slavebak',                   #128\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237\n    -&gt; master_password='slavebak',               #128\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237\u5bc6\u7801\n    -&gt; master_log_file='mysql-bin.000002',       #\u524d\u9762\u8bb0\u5f55\u7684128\u670d\u52a1mysql file\u503c\n    -&gt; master_log_pos=1287;                      #\u524d\u9762\u8bb0\u5f55\u7684128\u670d\u52a1mysql psition\u503c\nQuery OK, 0 rows affected, 2 warnings (0.02 sec)\n\nmysql&gt; start slave;            #\u542f\u52a8\u4ece\u5e93\u914d\u7f6e\n</code></pre> <p>4.\u67e5\u770b129\u4ece\u5e93\u914d\u7f6e\u662f\u5426\u6210\u529fSlave_IO_Running\u3001Slave_SQL_Running\u90fd\u4e3ayes\u5219\u6210\u529f</p> <pre><code>mysql&gt; show slave status;\nmysql&gt; show slave status \\G;\n*************************** 1. row ***************************\n            ......\n            Slave_IO_Running:  Yes                    #\u6b64\u503c\u4e3ayes\u914d\u7f6e\u6210\u529f\n            Slave_SQL_Running: Yes                    #\u6b64\u503c\u4e3ayes\u914d\u7f6ei\u6210\u529f\n            ......\n1 row in set (0.01 sec)\n</code></pre> <p>5.\u5728129\u670d\u52a1\u5668mysql\u521b\u5efa\u4e3b\u4ece\u540c\u6b65\u8d26\u6237slavebak\uff0c\u67e5\u770bmaster\u72b6\u6001\uff0c\u8bb0\u5f55\u4e0bfile\u3001psition\u503c</p> <pre><code>mysql&gt; grant replication slave on *.* to slavebak@'%' identified by 'slavebak';\nmysql&gt; flush privileges;\nmysql&gt; show master status;\n+------------------+----------+--------------+------------------+-------------------+\n| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |\n+------------------+----------+--------------+------------------+-------------------+\n| mysql-bin.000002 |     848  | test_db      |                  |                   |\n+------------------+----------+--------------+------------------+-------------------+\n1 row in set (0.01 sec)\n</code></pre> <p>6.\u8fde\u63a5128\u670d\u52a1\u5668\u5e76\u4f7f\u7528root\u7528\u6237\u8fde\u63a5\u672c\u670d\u52a1\u5668mysql\uff0c\u914d\u7f6e129\u7684\u4e3b\u5e93\u4fe1\u606f</p> <pre><code>[root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot\nmysql: [Warning] Using a password on the command line interface can be insecure.\n......\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; change master to \n    -&gt; master_host='192.168.222.129',            #129\u670d\u52a1\u5668mysql ip\n    -&gt; master_port=3306,                         #129\u670d\u52a1\u5668mysql\u7aef\u53e3\n    -&gt; master_user='slavebak',                   #129\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237\n    -&gt; master_password='slavebak',               #129\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237\u5bc6\u7801\n    -&gt; master_log_file='mysql-bin.000002',       #\u524d\u9762\u8bb0\u5f55\u7684129\u670d\u52a1mysql file\u503c\n    -&gt; master_log_pos=848;                       #\u524d\u9762\u8bb0\u5f55\u7684129\u670d\u52a1mysql psition\u503c\nQuery OK, 0 rows affected, 2 warnings (0.02 sec)\n\nmysql&gt; start slave;            #\u542f\u52a8\u4ece\u5e93\u914d\u7f6e\n</code></pre> <p>7.\u67e5\u770b128\u4ece\u5e93\u914d\u7f6e\u662f\u5426\u6210\u529fSlave_IO_Running\u3001Slave_SQL_Running\u90fd\u4e3ayes\u5219\u6210\u529f</p> <pre><code>mysql&gt; show slave status;\nmysql&gt; show slave status \\G;\n*************************** 1. row ***************************\n            ......\n            Slave_IO_Running:  Yes                    #\u6b64\u503c\u4e3ayes\u914d\u7f6e\u6210\u529f\n            Slave_SQL_Running: Yes                    #\u6b64\u503c\u4e3ayes\u914d\u7f6ei\u6210\u529f\n            ......\n1 row in set (0.01 sec)\n    \u81f3\u6b64\uff0c128\u670d\u52a1\u5668\uff0c129\u670d\u52a1\u5668\u53cc\u4e3b\u53cc\u4ece\u914d\u7f6e\u5b8c\u6210\n</code></pre>"},{"location":"mysql-ha/#mysql_2","title":"\u4e94\u3001MySQL\u53cc\u4e3b\u53cc\u4ece\u6d4b\u8bd5","text":"<ol> <li>\u8fde\u63a5128\u670d\u52a1\u5668\uff0c\u4f7f\u7528root\u7528\u6237\u8fde\u63a5\u672c\u673amysql\uff0c\u5e76\u521b\u5efatest_db\u6570\u636e\u5e93\uff0ct_test\u8868\uff0c\u5e76\u63d2\u5165\u4e00\u6761\u6570\u636eid=1,name='zhangsan'</li> </ol> <pre><code>[root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot\nmysql: [Warning] Using a password on the command line interface can be insecure.\n......\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; create database test_db;\nQuery OK, 1 row affected (0.00 sec)\n\nmysql&gt; use test_db;\nmysql&gt; create table t_test(id int primary key, name varchar(30));\nQuery OK, 0 row affected (0.01 sec)\nmysql&gt; insert into t_test values (1, 'zhangsan');\nQuery OK, 1 row affected (0.01 sec)\nmysql&gt; select * from t_test;\n+----+----------+\n| id | name     |\n+----+----------+\n|  1 | zhangsan |\n+----+----------+\n1 rows in set (0.00 sec)\n</code></pre> <ol> <li>\u8fde\u63a5129\u670d\u52a1\u5668\uff0c\u4f7f\u7528root\u7528\u6237\u8fde\u63a5mysql\uff0c\u67e5\u770btest_db\u6570\u636e\u5e93\u3001t_test\u8868\u4ee5\u53ca\u6570\u636e\u662f\u5426\u540c\u6b65\uff0c\u5e76\u63d2\u5165id=2\uff0cname=\u2018lisi\u2019 </li> </ol> <pre><code>[root@129 ~]# /opt/mysql5.7/bin/mysql -uroot -proot\nmysql: [Warning] Using a password on the command line interface can be insecure.\n......\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| performance_schema |\n| sys                |\n| test_db            |        #test_db\u6570\u636e\u5e93\u5df2\u540c\u6b65\u8fc7\u6765\n+--------------------+\n5 rows in set (0.01 sec)\n\nmysql&gt; use test_db;\nmysql&gt; show tables;\n+-------------------+\n| Tables_in_test_db |\n+-------------------+\n| t_test            |        #t_test\u8868\u5df2\u540c\u6b65\u8fc7\u6765\n+-------------------+\n1 row in set (0.01 sec)\n\nmysql&gt; select * from t_test;\n+----+----------+\n| id | name     |\n+----+----------+\n|  1 | zhangsan |            #\u6570\u636e\u5df2\u540c\u6b65\u8fc7\u6765\n+----+----------+\n1 rows in set (0.00 sec)\n\nmysql&gt; insert into t_test values (2, 'lisi');\nQuery OK, 1 row affected (0.01 sec)\n</code></pre> <ol> <li>\u5728128\u670d\u52a1\u5668\u67e5\u770bid=2\uff0cname=\"lisi\" \u662f\u5426\u540c\u6b65</li> </ol> <pre><code>[root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot\nmysql: [Warning] Using a password on the command line interface can be insecure.\n......\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt; select * from t_test;\n+----+----------+\n| id | name     |\n+----+----------+\n|  1 | zhangsan |\n|  2 | lisi     |            #lisi\u6570\u636e\u5df2\u540c\u6b65\n+----+----------+\n1 rows in set (0.00 sec)\n    \u81f3\u6b64\uff0c\u6570\u636e\u5e93\u53cc\u4e3b\u53cc\u4ece\u6d4b\u8bd5\u5b8c\u6210\u3002\n</code></pre>"},{"location":"mysql-ha/#keepalived","title":"\u516d\u3001keepalived\u5b89\u88c5","text":"<p>128\u3001129\u4e24\u53f0\u670d\u52a1\u5668\u5b89\u88c5\u6b65\u9aa4\u76f8\u540c\uff0c\u914d\u7f6e\u6587\u4ef6\u4e0d\u540c\uff0c\u4e0b\u9762\u6709\u4ecb\u7ecd\u3002</p> <ol> <li>\u5b89\u88c5\u76f8\u5173\u4f9d\u8d56\u5305\uff0c\u5e76\u4e0b\u8f7dkeepalived\u5b89\u88c5\u5305\uff0c\u89e3\u538b\uff0c\u914d\u7f6e\uff0c\u7f16\u8bd1</li> </ol> <pre><code>[root@128 ~]# cd /opt\n[root@128 opt]# yum -y install gcc openssl-devel popt-devel psmisc\n[root@128 opt]# wget https://www.keepalived.org/software/keepalived-2.2.7.tar.gz\n[root@128 opt]# tar -zxvf keepalived-2.2.7.tar.gz\n[root@128 opt]# cd keepalived-2.2.7\n[root@128 keepalived-2.2.7]# ./configure --prefix=/opt/keepalived-2.2.7\n[root@128 keepalived-2.2.7]# make &amp;&amp; make install\n</code></pre> <ol> <li>\u5c06\u6587\u4ef6\u590d\u5236\u5230\u5bf9\u5e94\u76ee\u5f55\u4e0b</li> </ol> <pre><code>[root@128 keepalived-2.2.7]# mkdir /etc/keepalived\n[root@128 keepalived-2.2.7]# cp keepalived/etc/keepalived/keepalived.conf.sample /etc/keepalived/keepalived.conf\n[root@128 keepalived-2.2.7]# cp keepalived/etc/init.d/keepalived /etc/init.d/\n[root@128 keepalived-2.2.7]# cp keepalived/etc/sysconfig/keepalived /etc/sysconfig/\n[root@128 keepalived-2.2.7]# cp bin/keepalived /usr/sbin/\n</code></pre> <ol> <li>\u65b0\u5efa/etc/keepalived/shutdown.sh\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a\uff1a</li> </ol> <pre><code>#!/bin/bash\n#\u8be5\u811a\u672c\u662f\u5728mysql\u670d\u52a1\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u5c06keepalived\u5e94\u7528\u505c\u6b62\uff0c\u4ece\u800c\u4f7f\u865a\u62dfvip\u4e3b\u673a\u81ea\u52a8\u8fde\u63a5\u5230\u53e6\u4e00\u53f0mysql\u4e0a\nkillall keepalived\n</code></pre> <ol> <li> <p>\u4f7f\u7528ifconfig\u547d\u4ee4\u67e5\u770b\u4e0b\u7f51\u5361\u540d\u79f0\uff0c\u672c\u673a\u7f51\u5361\u540d\u79f0\u4e3aens33</p> </li> <li> <p>\u4fee\u6539128\u670d\u52a1\u5668/etc/keepalived/keepalived.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> </li> </ol> <pre><code>! Configuration File for keepalived\n\nglobal_defs {\n   notification_email {\n     acassen@firewall.loc\n     failover@firewall.loc\n     sysadmin@firewall.loc\n   }\n   notification_email_from Alexandre.Cassen@firewall.loc\n   smtp_server 192.168.200.1\n   smtp_connect_timeout 30\n   router_id LVS_MASTER\n   vrrp_skip_check_adv_addr\n   vrrp_strict\n   vrrp_garp_interval 0\n   vrrp_gna_interval 0\n}\n\nvrrp_instance VI_1 {\n    state MASTER\n    #interface\u4e3a\u521a\u624d\u67e5\u5230\u7684\u672c\u673a\u7f51\u5361\u540d\u79f0\n    interface ens33\n    #\u540c\u4e00\u7f51\u6bb5\u4e2d\u540c\u4e00\u7ec4virtual_router_id\u503c\u76f8\u540c\u3002\u4e0d\u540c\u7ec4virtual_router_id\u503c\u552f\u4e00\u3002\n    #\u5982server-1\u3001server-2\u4e3a\u4e00\u7ec4\uff0cvirtual_router_id=51\n    #server-3\u3001server-4\u4e3a\u4e00\u7ec4\uff0c\u5219virtual_router_id\u4e0d\u80fd\u4e3a51\n    virtual_router_id 51\n    #\u5b57\u6570\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0cmaster\u5fc5\u987b\u5927\u4e8ebackup\n    priority 100\n    advert_int 1\n    authentication {\n        auth_type PASS\n        auth_pass 1111\n    }\n    virtual_ipaddress {\n       #\u8be5ip\u4e3a\u865a\u62df\u51fa\u6765\u7684vip\u5730\u5740\n       192.168.222.130\n    }\n}\n\n#\u914d\u7f6evirtual_server  ip\u4e3a\u4e0a\u9762\u914d\u7f6e\u7684\u865a\u62dfvip\u5730\u5740  \u7aef\u53e3\u4e3amysql\u7684\u7aef\u53e3\nvirtual_server 192.168.222.130 3306 {\n    delay_loop 6\n    lb_algo rr\n    lb_kind NAT\n    persistence_timeout 50\n    protocol TCP\n    #real_server \u8be5\u914d\u7f6e\u4e3a\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740 \u4ee5\u53ca\u5b9e\u9645\u7269\u7406\u673amysql\u7aef\u53e3\n    real_server 192.168.222.128 3306 {\n        #\u5f53\u8be5ip \u7aef\u53e3\u8fde\u63a5\u5f02\u5e38\u65f6\uff0c\u6267\u884c\u8be5\u811a\u672c\n        notify_down /etc/keepalived/shutdow.sh\n        TCP_CHECK {\n            #\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740\n            connect_ip 192.168.222.128\n            #\u5b9e\u9645\u7269\u7406\u673aport\u7aef\u53e3\n            connect_port 3306\n            connect_timeout 3\n            nb_get_retry 3\n            delay_before_retry 3\n        }\n    }\n}\n</code></pre> <ol> <li>\u4fee\u6539129\u670d\u52a1\u5668/etc/keepalived/keepalived.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0e128\u7684\u914d\u7f6e\u4e0d\u540c\u5730\u65b9\u4e3areal_server\u3001connect_ip \u4e24\u4e2a\u914d\u7f6e\uff0c\u9700\u8981\u914d\u7f6e\u5bf9\u5e94\u7684\u5b9e\u9645\u4e3b\u673aip\uff0c\u8be6\u7ec6\u5185\u5bb9\u5982\u4e0b\uff1a</li> </ol> <pre><code>! Configuration File for keepalived\n\nglobal_defs {\n   notification_email {\n     acassen@firewall.loc\n     failover@firewall.loc\n     sysadmin@firewall.loc\n   }\n   notification_email_from Alexandre.Cassen@firewall.loc\n   smtp_server 192.168.200.1\n   smtp_connect_timeout 30\n   router_id LVS_MASTER\n   vrrp_skip_check_adv_addr\n   vrrp_strict\n   vrrp_garp_interval 0\n   vrrp_gna_interval 0\n}\n\nvrrp_instance VI_1 {\n    state BACKUP\n    #interface\u4e3a\u521a\u624d\u67e5\u5230\u7684\u672c\u673a\u7f51\u5361\u540d\u79f0\n    interface ens33\n    #\u540c\u4e00\u7f51\u6bb5\u4e2d\u540c\u4e00\u7ec4virtual_router_id\u503c\u76f8\u540c\u3002\u4e0d\u540c\u7ec4virtual_router_id\u503c\u552f\u4e00\u3002\n    #\u5982server-1\u3001server-2\u4e3a\u4e00\u7ec4\uff0cvirtual_router_id=51\n    #server-3\u3001server-4\u4e3a\u4e00\u7ec4\uff0c\u5219virtual_router_id\u4e0d\u80fd\u4e3a51\n    virtual_router_id 51\n    #\u5b57\u6570\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0cmaster\u5fc5\u987b\u5927\u4e8ebackup\n    priority 90\n    advert_int 1\n    authentication {\n        auth_type PASS\n        auth_pass 1111\n    }\n    virtual_ipaddress {\n       #\u8be5ip\u4e3a\u865a\u62df\u51fa\u6765\u7684vip\u5730\u5740\n       192.168.222.130\n    }\n}\n\n#\u914d\u7f6evirtual_server  ip\u4e3a\u4e0a\u9762\u914d\u7f6e\u7684\u865a\u62dfvip\u5730\u5740  \u7aef\u53e3\u4e3amysql\u7684\u7aef\u53e3\nvirtual_server 192.168.222.130 3306 {\n    delay_loop 6\n    lb_algo rr\n    lb_kind NAT\n    persistence_timeout 50\n    protocol TCP\n    #real_server \u8be5\u914d\u7f6e\u4e3a\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740 \u4ee5\u53ca\u5b9e\u9645\u7269\u7406\u673amysql\u7aef\u53e3\n    real_server 192.168.222.129 3306 {\n        #\u5f53\u8be5ip \u7aef\u53e3\u8fde\u63a5\u5f02\u5e38\u65f6\uff0c\u6267\u884c\u8be5\u811a\u672c\n        notify_down /etc/keepalived/shutdow.sh\n        TCP_CHECK {\n            #\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740\n            connect_ip 192.168.222.129\n            #\u5b9e\u9645\u7269\u7406\u673aport\u7aef\u53e3\n            connect_port 3306\n            connect_timeout 3\n            nb_get_retry 3\n            delay_before_retry 3\n        }\n    }\n}\n</code></pre> <p>\u8be6\u7ec6\u914d\u7f6e\u53c2\u8003\u300aKeepalived \u5b89\u88c5\u548c\u914d\u7f6e\u8be6\u89e3\u300b</p> <ol> <li>\u5c06128\u3001129\u670d\u52a1\u5668keepalived\u52a0\u5165\u5f00\u673a\u81ea\u542f\uff0c\u5e76\u542f\u52a8\u670d\u52a1</li> </ol> <pre><code>[root@128 keepalived-2.2.7]# systemctl enable keepalived\n[root@128 keepalived-2.2.7]# systemctl start keepalived\n</code></pre> <ol> <li> <p>\u542f\u52a8\u540ekeepalived\u72b6\u6001\u4e3a\uff1aactive(running)\u5219\u6b63\u5e38</p> </li> <li> <p>\u542f\u52a8\u540e\u76f8\u5f53\u4e8e\u865a\u62df\u51fa\u4e00\u4e2avip 192.168.222.130\uff0c\u53ef\u4f7f\u7528\u8fdc\u7a0b\u8fde\u63a5\u5de5\u5177\uff0c\u8fde\u63a5\u8be5\u670d\u52a1\u5668\uff0c\u8fde\u63a5\u8fdb\u53bb\u540e\u4f7f\u7528ifconfig\u67e5\u770b\u8be5\u865a\u62dfvip\u5b9e\u9645\u4e0a\u4f7f\u7528\u7684\u5b9e\u4f53\u670d\u52a1\u5668\u662f129\u670d\u52a1\u5668\u3002</p> </li> <li> <p>\u5c06129\u670d\u52a1\u5668\u7684keepalived\u5e94\u7528\u505c\u6b62\uff0c\u518d\u6b21\u67e5\u770b130\u670d\u52a1ifconfig\uff0c\u53ef\u4ee5\u770b\u5230\uff0c130\u670d\u52a1\u5668\u81ea\u52a8\u5c06\u5b9e\u4f53\u673aip\u6f02\u79fb\u5230\u4e86128\u670d\u52a1\u5668\u4e0a</p> </li> </ol> <p>\u81f3\u6b64\uff0ckeepalived\u90e8\u7f72\u5b8c\u6210\u3002</p>"},{"location":"mysql-mgr/","title":"MYSQL MGR","text":""},{"location":"mysql-mgr/#_1","title":"\u53c2\u8003","text":"<ul> <li>https://www.modb.pro/db/337457</li> <li>https://www.modb.pro/db/377620</li> <li>https://www.modb.pro/db/25554</li> <li>https://www.cndba.cn/dave/article/108030</li> <li>https://blog.51cto.com/imysql/3199719</li> <li>https://dev.mysql.com/doc/refman/8.0/ja/group-replication-adding-instances.html</li> </ul>"},{"location":"mysql-mgr/#mgr","title":"MGR\u7684\u4f7f\u7528\u7ea6\u675f","text":"<ol> <li>\u4ec5\u652f\u6301InnoDB\u8868,\u5e76\u4e14\u6bcf\u5f20\u8868\u4e00\u5b9a\u8981\u6709\u4e00\u4e2a\u4e3b\u952e,\u7528\u4e8e\u505awrite set \u7684\u51b2\u7a81\u68c0\u6d4b<ul> <li>mgr\u6a21\u5f0f\u4e0b\u6240\u6709\u8868\u90fd\u9700\u8981\u8bbe\u7f6e\u4e3b\u952e\uff0c\u4e0d\u7136\u4f1a\u62a5\u9519</li> <li><code>ERROR 3098 (HY000): The table does not comply with the requirements by an external plugin.</code></li> </ul> </li> <li>\u5fc5\u987b\u6253\u5f00GTID\u7279\u6027,\u4e8c\u8fdb\u5236\u65e5\u5fd7\u683c\u5f0f\u5fc5\u987b\u8bbe\u7f6e\u4e3aROW,\u7528\u4e8e\u9009\u4e3b\u4e0ewrite set; <ul> <li>\u4e3b\u4ece\u72b6\u6001\u4fe1\u606f\u5b58\u4e8e\u8868\u4e2d,(--master-info-repository=TABLE, --relay-log-info-repository=TABLE), --log-slave-updates\u6253\u5f00.</li> </ul> </li> <li>MGR\u4e0d\u652f\u6301\u5927\u4e8b\u52a1,\u4e8b\u52a1\u5927\u5c0f\u6700\u597d\u4e0d\u8d85\u8fc7143MB, \u5f53\u4e8b\u52a1\u8fc7\u5927,\u65e0\u6cd5\u57285\u79d2\u7684\u65f6\u95f4\u5185\u901a\u8fc7\u7f51\u7edc\u5728\u7ec4\u6210\u5458\u4e4b\u95f4\u590d\u5236\u6d88\u606f,\u5219\u53ef\u80fd\u4f1a\u6000\u7591\u6210\u5458\u5931\u8d25\u4e86,\u7136\u540e\u5c06\u5176\u9010\u51fa\u5c40</li> <li>\u76ee\u524d\u4e00\u4e2aMGR\u7fa4\u96c6\u6700\u591a\u652f\u63019\u4e2a\u8282\u70b9</li> <li>\u4e0d\u652f\u6301\u5916\u952e\u4e8esave point\u7279\u6027, \u65e0\u6cd5\u505a\u5168\u5c40\u95f4\u7684\u7ea6\u675f\u68c0\u6d4b\u4e0e\u90e8\u5206\u4e8b\u52a1\u56de\u6eda</li> <li>\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e0d\u652f\u6301binlog Event Checksum</li> </ol>"},{"location":"mysql-mgr/#vm","title":"\u691c\u8a3cVM","text":"IP Hostname virt_name spec HV xx.yyy.zzz.1 node1 (rocky8) mysql8-test 22c/160g hv1 xx.yyy.zzz.2 node2 (rocky87-mysql8) rocky87-test 8c/16g hv2 xx.yyy.zzz.3 node3 (amd-rocky8) rocky-mysql8 22c/160g hv2 <ul> <li> <p>MySQL\u518d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb</p> </li> <li> <p>mysql8\u306f\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6e08\u306e\u305f\u3081\u3001\u4e00\u65e6\u524a\u9664\u3059\u308b</p> </li> </ul> <pre><code># backup\n\n[root@node3 work]# pwd\n/root/work\n[root@node3 work]#\ncp /etc/my.cnf my.cnf.20230515\ncp /root/.my.cnf .my.cnf.20230515\ncp /root/.mytop .mytop.20230515\n\n# rpm\u3092\u524a\u9664\n\n[root@node1 work]# for i in `rpm -aq | grep mysql`; do yum -y remove $i; done\n[root@node2 work]# for i in `rpm -aq | grep mysql`; do yum -y remove $i; done\n[root@node3 work]# for i in `rpm -aq | grep mysql`; do yum -y remove $i; done\n\n# \u4e0d\u8981\u30d5\u30a1\u30a4\u30eb\u524a\u9664\n\nrm -rf /etc/my.cnf.rpmsave\nrm -rf /etc/my.cnf\nrm -rf /etc/mysql-version.txt\nrm -rf /home/mysql\nrm -rf /root/.my.cnf\nrm -rf /root/.mytop\n\n\n# Ansible\u3067MySQL8.0\u3092\u518d\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\n\n$ sudo /usr/local/bin/ansible-playbook mysql80.yml --limit xx.yyy.zzz.1,xx.yyy.zzz.2,xx.yyy.zzz.3  -t systool,mysql80 -v\nPLAY RECAP *********************************************************************************************************************\nxx.yyy.zzz.1              : ok=29   changed=12   unreachable=0    failed=0    skipped=6    rescued=0    ignored=0\nxx.yyy.zzz.2              : ok=29   changed=12   unreachable=0    failed=0    skipped=6    rescued=0    ignored=0\nxx.yyy.zzz.3              : ok=28   changed=14   unreachable=0    failed=0    skipped=6    rescued=0    ignored=0\n\n</code></pre>"},{"location":"mysql-mgr/#mycnf","title":"my.cnf","text":"my.cnf <pre><code>[mysql]\ndefault-character-set=utf8mb4\nsocket=/tmp/mysql.sock\nauto-rehash\nprompt=\"\\\\r:\\\\m:\\\\s \\\\u@\\\\h[\\\\d]&gt; \"\n\n[mysqld]\n# mgr\nserver_id=1\ngtid_mode=ON\nenforce_gtid_consistency=ON\nbinlog_checksum=NONE\nlog_replica_updates=ON\nlog_bin=binlog\nrelay_log=relay_log\nbinlog_format=ROW\nplugin-load=mysql_clone.so;group_replication.so\n\nloose-group_replication_group_name=\"aaaaaaaa-1111-2222-3333-bbbbbbbbbbbb\"\nloose-group_replication_start_on_boot=off\nloose-group_replication_local_address=\"node1:33061\"\nloose-group_replication_group_seeds=\"node1:33061,node2:33061,node3:33061\"\nloose-group_replication_bootstrap_group=off\nloose-group_replication_ip_allowlist=\"xx.yyy.zzz.0/25\"\nreport-host=\"node1\"\n\nbinlog_expire_logs_seconds=86400 # \u8868\u793a\u81ea\u52a8\u5220\u96641\u5929\u4ee5\u524d\u7684binlog\uff0c\u53ef\u9009\n\n# general\nuser=mysql\ndatadir=/home/mysql\nsocket=/tmp/mysql.sock\ntmpdir=/home/tmp\nbind-address=0.0.0.0\n\nperformance_schema_show_processlist=1\ndefault_storage_engine=INNODB\nskip-name-resolve\nskip-mysqlx\n# skip-log-bin # MGR\u306e\u305f\u3081\u3001\u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\nevent_scheduler=OFF\n\ntls_version=TLSv1.2,TLSv1.3\nsql_mode=\"ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION\"\n\nmax_connections=100\nmax_connect_errors=300\nmax_allowed_packet=32M\nconnect_timeout=30\nmax_user_connections=30\ntable_open_cache=9600\ninteractive_timeout=300\nwait_timeout=300\ntmp_table_size=256M\nmax_heap_table_size=256M\ndefault_password_lifetime=0\nexplicit_defaults_for_timestamp=1\nlog_timestamps=SYSTEM\ncharacter-set-server=utf8mb4\ncollation-server=utf8mb4_general_ci\n\n# auth\nauthentication_policy = 'mysql_native_password,,'\n\n# ssl_rsa\nauto_generate_certs=ON\ncaching_sha2_password_auto_generate_rsa_keys=0\nsha256_password_auto_generate_rsa_keys=0\n\n# innodb doublewrite\ninnodb_doublewrite_dir=\"/home/mysql/#innodb_dblwr\"\n# innodb_doublewrite_files=16 # (innodb_buffer_pool_instances * 2)\n\n# undo log\ninnodb_max_undo_log_size=1G\n\n# log\nslow_query_log=1\nlog_error_verbosity=3\nlong_query_time=10\nslow_query_log_file=/var/log/mysql/slow_query.log\nlog_error=/var/log/mysql/error.log\nlog_output=FILE\n\n# buffer\nsort_buffer_size=1M\nread_buffer_size=1M\nread_rnd_buffer_size=1M\n\n# MyISAM\nmyisam_sort_buffer_size=128M\nkey_buffer_size=512M\n\n# InnoDB\ninnodb-adaptive-hash-index=OFF\ninnodb-strict-mode=1\ninnodb_file_per_table=1\ninnodb_temp_data_file_path=ibtmp1:12M:autoextend:max:10G\ninnodb_buffer_pool_size=4G\ninnodb_buffer_pool_dump_pct=100\ninnodb_buffer_pool_dump_at_shutdown=1\ninnodb_buffer_pool_load_at_startup=0\ninnodb_redo_log_capacity=512M\ninnodb_io_capacity=2000\ninnodb_io_capacity_max=5000\ninnodb_flush_log_at_trx_commit=2\ninnodb_flush_method=O_DIRECT\ninnodb_flush_neighbors=0\ninnodb_read_ahead_threshold=0\ninnodb_purge_threads=1\n</code></pre>"},{"location":"mysql-mgr/#_2","title":"\u5404\u8282\u70b9\u914d\u7f6e","text":"\u914d\u7f6e\u9879 \u503c \u8bf4\u660e server_id 1 \u552f\u4e00\u6807\u8bc6MySQL\u5b9e\u4f8b gtid_mode ON \u5f00\u542f\u4e8b\u52a1\u7684gtid enforce_gtid_consistency ON \u5f3a\u5236gtid\u4e00\u81f4\u6027 master_info_repository(deprecated) TABLE <code>master.info</code>\u4f7f\u7528\u6570\u636e\u8868\u65b9\u5f0f\u8bb0\u5f55 log_bin ON \u5f00\u542fbinlog binlog_format ROW binlog\u7684\u590d\u5236\u6a21\u5f0f binlog_checksum NONE \u4e0d\u4f7f\u7528binlog\u6821\u9a8c\u548c relay_log_info_repository(deprecated) TABLE \u4f5c\u4e3a\u4ece\u5e93\u540c\u6b65\u4e8b\u52a1\u540e\uff0c\u8bb0\u5f55\u81f3\u6570\u636e\u8868 transaction_write_set_extraction (deprecated) XXHASH64 deprecated as of MySQL 8.0.26 default_authentication_plugin mysql_native_password \u914d\u7f6e\u7528\u6237\u8d26\u6237\u7684\u52a0\u5bc6\u65b9\u5f0f plugin_load mysql_clone.so;group_replication.so \u52a0\u8f7d\u7ec4\u590d\u5236\u63d2\u4ef6 loose-group_replication_group_name \"aaaaaaaa-1111-2222-3333-bbbbbbbbbbbb\" UUID\uff0c\u5206\u7ec4\u7684\u8282\u70b9\u9700\u914d\u7f6e\u4e00\u81f4 loose-group_replication_start_on_boot OFF \u542f\u52a8MySQL\u65f6\u4e0d\u81ea\u52a8\u5f00\u542f\u7ec4\u590d\u5236 loose-group_replication_bootstrap_group OFF \u5173\u95ed\u6b64MySQL\u5b9e\u4f8b\u7684\u7ec4\u5f15\u5bfc loose-group_replication_single_primary_mode OFF \u5173\u95ed\u5355\u4e3b\u6a21\u5f0f\uff0c\u5373\u4f7f\u7528\u591a\u4e3b\u6a21\u5f0f loose-group_replication_enforce_update_everywhere_checks ON \u5728\u591a\u4e3b\u6a21\u5f0f\u4e0b\uff0c\u5efa\u8bae\u5f00\u542f\u6b64\u9009\u9879\uff0c\u4e25\u683c\u68c0\u67e5\u4e00\u81f4\u6027 loose-group_replication_ssl_mode DISABLED \u7ec4\u590d\u5236\u8282\u70b9\u901a\u4fe1\u7981\u7528SSL loose-group_replication_local_address \"node1:33061\" \u5f53\u524dMySQL\u5b9e\u4f8b\u7684\u7ec4\u590d\u5236\u901a\u4fe1\u5730\u5740 loose-group_replication_group_seeds \"node1:33061,node2:33061,node3:33061\" \u7ec4\u590d\u5236\u7684\u8282\u70b9\u901a\u4fe1\u5730\u5740 loose-group_replication_ip_whitelist orloose-group_replication_ip_allowlist xx.yyy.zzz.0/25,127.0.0.1\" \u8bbe\u7f6e\u7ec4\u590d\u5236\u8282\u70b9\u901a\u4fe1\u7684IP\u767d\u540d\u5355\uff0c\u540c\u7f51\u6bb5\u53ef\u7701\u7565 report-host \"node1\" \u8bbe\u7f6e\u672c\u673aMEMBER_HOST,\u9ed8\u8ba4\u4e3ahostname,\u7531\u4e8e\u5f00\u542f\u4e86skip-name-resolve,\u6b64\u5904\u7528IP\u65b9\u5f0f\u901a\u8baf"},{"location":"mysql-mgr/#_3","title":"\u8bbe\u7f6e\u590d\u5236\u8d26\u53f7","text":"<ul> <li>\u4e0b\u8a18\u4f5c\u696d\u306f\u5168node\u3067\u5b9f\u65bd\u3059\u308b</li> </ul> <pre><code>mysql&gt; SET SQL_LOG_BIN=0;\nmysql&gt; CREATE USER 'repl_user'@'%' IDENTIFIED BY 'password';\nmysql&gt; GRANT REPLICATION SLAVE ON *.* TO repl_user@'%';\nmysql&gt; FLUSH PRIVILEGES;\nmysql&gt; SET SQL_LOG_BIN=1;\n# mysql&gt; CHANGE REPLICATION SOURCE TO SOURCE_USER='repl_user', SOURCE_PASSWORD='password' FOR CHANNEL 'group_replication_recovery';\n# mysql&gt; START REPLICA UNTIL SQL_AFTER_MTS_GAPS;\nmysql&gt; START GROUP_REPLICATION USER='repl_user', PASSWORD='password';\nmysql&gt; CHANGE REPLICATION SOURCE TO SOURCE_PORT='3306' FOR CHANNEL 'group_replication_recovery';\n\n# \u53e6\u4e00\u79cd\u5199\u6cd5.\n# CHANGE REPLICATION SOURCE TO SOURCE_HOST='xx.yyy.zzz.1', SOURCE_PORT=33061 FOR CHANNEL 'group_replication_recovery'\nCHANGE REPLICATION SOURCE TO\n  SOURCE_HOST='xx.yyy.zzz.1',\n  SOURCE_USER='repl_user',\n  SOURCE_PASSWORD='password',\n  SOURCE_PORT=33061;\n\nSTART GROUP_REPLICATION USER='repl_user', PASSWORD='password';\n</code></pre> <ul> <li>warning\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u308b\u5834\u5408</li> </ul> <pre><code># replication\u30e6\u30fc\u30b6\u3092\u8ffd\u52a0\u6642\u3001\u4e0b\u8a18\u306ewarning\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u51fa\u308b\u3002\n01:52:21 root@localhost[(none)]&gt; CHANGE REPLICATION SOURCE TO SOURCE_USER='repl_user', SOURCE_PASSWORD='password' FOR CHANNEL 'group_replication_recovery';\nQuery OK, 0 rows affected, 2 warnings (0.00 sec)\n\n01:52:21 root@localhost[(none)]&gt; show warnings\\G\n*************************** 1. row ***************************\n  Level: Note\n   Code: 1759\nMessage: Sending passwords in plain text without SSL/TLS is extremely insecure.\n*************************** 2. row ***************************\n  Level: Note\n   Code: 1760\nMessage: Storing MySQL user name or password information in the connection metadata repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START REPLICA; see the 'START REPLICA Syntax' in the MySQL Manual for more information.\n2 rows in set (0.00 sec)\n\n01:52:29 root@localhost[(none)]&gt;\n\n# \u539f\u56e0\u306fmysql\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u63a5\u7d9a\u6642ssl\u306a\u3057\u3067\u63a5\u7d9a\u3057\u3066\u3044\u308b\u305f\u3081\u3067\u3059\u3002 (node1)\n01:42:17 root@localhost[(none)]&gt; \\s\n--------------\nmysql  Ver 8.0.33 for Linux on x86_64 (MySQL Community Server - GPL)\n\nCurrent user:           root@localhost\nSSL:                    Not in use     &lt;&lt;-- \u3053\u3053\u304cSSL\u306a\u3057\n&lt;SKIP&gt;\n--------------\n\n01:44:41 root@localhost[(none)]&gt;\n\n# \u5bfe\u5fdc\u65b9\u6cd5 (node2)\n- /root/.my.cnf \u306b\u4e0b\u8a18\u306e\u901a\u308a\u306b\u5909\u66f4\n\n01:53:27 root@localhost[(none)]&gt; \\! cat /root/.my.cnf\n[client]\nsocket=/tmp/mysql.sock\nuser=root\npassword=password\nhost=localhost\nssl-mode=required  &lt;--- ssl-mode\u3092\u8ffd\u52a0\u3059\u308b\u3002\u5f37\u5236\u7684\u306bssl\u3092\u5229\u7528\u3059\u308b\n01:53:30 root@localhost[(none)]&gt;\n\n## \u7d50\u679c\n- warning\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u4e00\u3064\u306b\u306a\u308a\u307e\u3057\u305f\u3002\n01:55:10 root@localhost[(none)]&gt; CHANGE REPLICATION SOURCE TO SOURCE_USER='repl_user', SOURCE_PASSWORD='password' FOR CHANNEL 'group_replication_recovery';\nQuery OK, 0 rows affected, 1 warning (0.01 sec)\n\n01:55:10 root@localhost[(none)]&gt;\n01:55:10 root@localhost[(none)]&gt; show warnings\\G\n*************************** 1. row ***************************\n  Level: Note\n   Code: 1760\nMessage: Storing MySQL user name or password information in the connection metadata repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START REPLICA; see the 'START REPLICA Syntax' in the MySQL Manual for more information.\n1 row in set (0.00 sec)\n\n01:55:17 root@localhost[(none)]&gt;\n</code></pre>"},{"location":"mysql-mgr/#master","title":"MASTER\u30b5\u30fc\u30d0","text":"<pre><code># \u4e3b\u670d\u52a1\u5668\nmysql&gt; reset master;\nmysql&gt; SET GLOBAL group_replication_bootstrap_group=ON;\nmysql&gt; START GROUP_REPLICATION;\nmysql&gt; SET GLOBAL group_replication_bootstrap_group=OFF;\n\nmysql&gt; SHOW VARIABLES LIKE 'gtid_executed';\n+---------------+------------------------------------------+\n| Variable_name | Value                                    |\n+---------------+------------------------------------------+\n| gtid_executed | aaaaaaaa-1111-2222-3333-bbbbbbbbbbbb:1-3 |\n+---------------+------------------------------------------+\n1 row in set (0.00 sec)\n\n-- \u67e5\u770bMGR\u7ec4\u4fe1\u606f\nmysql&gt; SELECT * FROM performance_schema.replication_group_members;\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| CHANNEL_NAME              | MEMBER_ID                            | MEMBER_HOST | MEMBER_PORT | MEMBER_STATE | MEMBER_ROLE | MEMBER_VERSION | MEMBER_COMMUNICATION_STACK |\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| group_replication_applier | defba275-f2ef-11ed-9eae-525400e752a2 | node1       |        3306 | ONLINE       | PRIMARY     | 8.0.33         | XCom                       |\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n1 row in set (0.00 sec)\n</code></pre>"},{"location":"mysql-mgr/#slave","title":"SLAVE\u30b5\u30fc\u30d0\u8ffd\u52a0","text":"<pre><code>mysql&gt; stop replica;\nmysql&gt; reset replica all;\nmysql&gt; start group_replication;\nmysql&gt; SHOW VARIABLES LIKE 'gtid_executed';\nmysql&gt; select * from performance_schema.replication_group_members;\nmysql&gt; select * from performance_schema.replication_connection_status;\n\n\n# \u78ba\u8a8d\n04:15:18 root@localhost[(none)]&gt; select * from performance_schema.replication_group_members ;\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| CHANNEL_NAME              | MEMBER_ID                            | MEMBER_HOST | MEMBER_PORT | MEMBER_STATE | MEMBER_ROLE | MEMBER_VERSION | MEMBER_COMMUNICATION_STACK |\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| group_replication_applier | 74ba497e-f2f1-11ed-9e8e-5254007b60ca | node2       |        3306 | ONLINE       | SECONDARY   | 8.0.33         | XCom                       |\n| group_replication_applier | d7239f8c-f2f1-11ed-aeeb-525400c72882 | node3       |        3306 | ONLINE       | SECONDARY   | 8.0.33         | XCom                       |\n| group_replication_applier | defba275-f2ef-11ed-9eae-525400e752a2 | node1       |        3306 | ONLINE       | PRIMARY     | 8.0.33         | XCom                       |\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n3 rows in set (0.00 sec)\n\n04:15:48 root@localhost[(none)]&gt;\n\n</code></pre> <ul> <li>RECOVERING\u306b\u306a\u3063\u305f\u5834\u5408</li> </ul> <pre><code># slave\u30b5\u30fc\u30d0\u8ffd\u52a0\u306e\u969b\u3001MEMBER_STATE\u304c\u305a\u3063\u3068RECOVERING\u306b\u306a\u3063\u305f\u5834\u5408\n-- select * from performance_schema.replication_connection_status\\G \u3067\u30a8\u30e9\u30fc\u3092\u78ba\u8a8d\n-- \u57fa\u672c\u7684\u306b\u306freplication\u30e6\u30fc\u30b6\u306e\u8ffd\u52a0\u3067\u304d\u3066\u306a\u3044\u306e\u304c\u539f\u56e0\u3067\u3059\u3002\n\n## \u5bfe\u7b56\n-- replication\u30e6\u30fc\u30b6\u3092\u8ffd\u52a0\u3059\u308b\n-- CHANGE REPLICATION SOURCE TO SOURCE_USER='repl_user', SOURCE_PASSWORD='password' FOR CHANNEL 'group_replication_recovery';\n-- SELECT MEMBER_ID,MEMBER_HOST,MEMBER_STATE, MEMBER_ROLE FROM performance_schema.replication_group_members; \u3067\u78ba\u8a8d\n\n    04:14:34 root@localhost[(none)]&gt; SELECT MEMBER_ID,MEMBER_HOST,MEMBER_STATE, MEMBER_ROLE FROM performance_schema.replication_group_members;\n    +--------------------------------------+-------------+--------------+-------------+\n    | MEMBER_ID                            | MEMBER_HOST | MEMBER_STATE | MEMBER_ROLE |\n    +--------------------------------------+-------------+--------------+-------------+\n    | 74ba497e-f2f1-11ed-9e8e-5254007b60ca | node2       | ONLINE       | SECONDARY   |\n    | d7239f8c-f2f1-11ed-aeeb-525400c72882 | node3       | ONLINE       | SECONDARY   |\n    | defba275-f2ef-11ed-9eae-525400e752a2 | node1       | ONLINE       | PRIMARY     |\n    +--------------------------------------+-------------+--------------+-------------+\n    3 rows in set (0.00 sec)\n\n    04:15:18 root@localhost[(none)]&gt;\n\n\n\n04:17:57 root@localhost[(none)]&gt; select * from performance_schema.replication_group_members ;\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| CHANNEL_NAME              | MEMBER_ID                            | MEMBER_HOST | MEMBER_PORT | MEMBER_STATE | MEMBER_ROLE | MEMBER_VERSION | MEMBER_COMMUNICATION_STACK |\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| group_replication_applier | 74ba497e-f2f1-11ed-9e8e-5254007b60ca | node2       |        3306 | ONLINE       | SECONDARY   | 8.0.33         | XCom                       |\n| group_replication_applier | d7239f8c-f2f1-11ed-aeeb-525400c72882 | node3       |        3306 | RECOVERING   | SECONDARY   | 8.0.33         | XCom                       |\n| group_replication_applier | defba275-f2ef-11ed-9eae-525400e752a2 | node1       |        3306 | ONLINE       | PRIMARY     | 8.0.33         | XCom                       |\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n3 rows in set (0.00 sec)\n\n04:18:01 root@localhost[(none)]&gt; select * from performance_schema.replication_connection_status\\G\n*************************** 2. row ***************************\n           CHANNEL_NAME: group_replication_recovery\n      LAST_ERROR_NUMBER: 13117\n     LAST_ERROR_MESSAGE: Fatal error: Invalid (empty) username when attempting to connect to the source server. Connection attempt terminated.\n   LAST_ERROR_TIMESTAMP: 2023-05-16 16:17:55.939759\n\n2 rows in set (0.00 sec)\n</code></pre>"},{"location":"mysql-mgr/#_4","title":"\u78ba\u8a8d","text":"<ul> <li>master\u5074\u306fNOT READ_ONLY\u3001slave\u5074\u306fREAD_ONLY</li> </ul> <pre><code># node1\n04:29:11 root@localhost[(none)]&gt; show global variables where Variable_name  like '%hostname%' or Variable_name like '%read_only%';\n+-----------------------+-------+\n| Variable_name         | Value |\n+-----------------------+-------+\n| hostname              | node1 |\n| innodb_read_only      | OFF   |\n| read_only             | OFF   |\n| super_read_only       | OFF   |\n| transaction_read_only | OFF   |\n+-----------------------+-------+\n5 rows in set (0.01 sec)\n\n04:29:44 root@localhost[(none)]&gt;\n\n# node2\n04:33:09 root@localhost[(none)]&gt; show global variables where Variable_name  like '%hostname%' or Variable_name like '%read_only%';\n+-----------------------+-------+\n| Variable_name         | Value |\n+-----------------------+-------+\n| hostname              | node2 |\n| innodb_read_only      | OFF   |\n| read_only             | ON    |\n| super_read_only       | ON    |\n| transaction_read_only | OFF   |\n+-----------------------+-------+\n5 rows in set (0.01 sec)\n\n04:37:22 root@localhost[(none)]&gt;\n\n# node3\n04:35:53 root@localhost[(none)]&gt; show global variables where Variable_name  like '%hostname%' or Variable_name like '%read_only%';\n+-----------------------+-------+\n| Variable_name         | Value |\n+-----------------------+-------+\n| hostname              | node3 |\n| innodb_read_only      | OFF   |\n| read_only             | ON    |\n| super_read_only       | ON    |\n| transaction_read_only | OFF   |\n+-----------------------+-------+\n5 rows in set (0.00 sec)\n\n04:40:09 root@localhost[(none)]&gt;\n\n</code></pre>"},{"location":"mysql-mgr/#sysbench","title":"sysbench\u306e\u691c\u8a3c","text":"<pre><code>## DB\u4f5c\u6210\n&gt; CREATE DATABASE sbtest;\n\n## \u30e6\u30fc\u30b6\u30fc\u4f5c\u6210\n&gt; CREATE USER 'sbtest'@'%' IDENTIFIED BY 'sbtest';\n\n## \u30e6\u30fc\u30b6\u30fc\u306b\u5168\u6a29\u9650\u8ffd\u52a0\n&gt; GRANT all ON *.* TO 'sbtest'@'%';\n\n## \u6a29\u9650\u306e\u5909\u66f4\u3092\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u53cd\u6620\n&gt; FLUSH PRIVILEGES;\n\n## \u78ba\u8a8d\n&gt; show databases;\n&gt; select user,host,authentication_string from mysql.user;\n\n## \u691c\u8a3c\u7528\u30b9\u30af\u30ea\u30d7\u30c8\u4f5c\u6210\n#!/usr/bin/env bash\nPATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin\nexport PATH\nset -e\n\nclear\n\nTHR=$1\nCMD=$2\n\nif [ ! \"$THR\" ]; then\n  echo \"Not threads set! \"\n  exit 1;\nfi\n\nif [ ! \"$CMD\" ]; then\n  echo \"Not command selected! \"\n  exit 1;\nfi\n\nsysbench oltp_read_write \\\n--mysql-host=xx.yyy.zzz.1 \\\n--mysql-dry-run=off \\\n--db-driver=mysql \\\n--mysql-user=sbtest \\\n--mysql-password=sbtest \\\n--table_size=10000 \\\n--threads=$THR \\\n--tables=30 \\\n--time=120 \\\n--report-interval=10 \\\n$CMD\n\n## 2. \u30c6\u30fc\u30d6\u30eb\u6e96\u5099\n&gt; bash sysbench_mgr.sh 300 prepare\n\n## \u6027\u80fd\u691c\u8a3c\n&gt; for i in $(seq 10 10 300); do echo $i; bash sysbench_mgr.sh $i run &gt;&gt; mgr_sysbench.log; done\n\n</code></pre>"},{"location":"mysql-mgr/#master_1","title":"MASTER\u6b7b\u3093\u3060\u5834\u5408\u306e\u78ba\u8a8d","text":"<ul> <li>master\u304c\u6b63\u5e38\u306b\u5207\u308a\u66ff\u3048\u305f\u304b\u3069\u3046\u304b\u3092\u78ba\u8a8d</li> </ul> <pre><code># master\n04:49:35 root@localhost[sbtest]&gt; select * from performance_schema.replication_group_members ;\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| CHANNEL_NAME              | MEMBER_ID                            | MEMBER_HOST | MEMBER_PORT | MEMBER_STATE | MEMBER_ROLE | MEMBER_VERSION | MEMBER_COMMUNICATION_STACK |\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| group_replication_applier | 74ba497e-f2f1-11ed-9e8e-5254007b60ca | node2       |        3306 | ONLINE       | SECONDARY   | 8.0.33         | XCom                       |\n| group_replication_applier | d7239f8c-f2f1-11ed-aeeb-525400c72882 | node3       |        3306 | ONLINE       | SECONDARY   | 8.0.33         | XCom                       |\n| group_replication_applier | defba275-f2ef-11ed-9eae-525400e752a2 | node1       |        3306 | ONLINE       | PRIMARY     | 8.0.33         | XCom                       |\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n3 rows in set (0.00 sec)\n\n04:50:18 root@localhost[sbtest]&gt; select @@hostname;\n+------------+\n| @@hostname |\n+------------+\n| node1      |\n+------------+\n1 row in set (0.00 sec)\n\n04:50:23 root@localhost[sbtest]&gt;\n</code></pre> <ul> <li>master\u306emysqld\u3092\u505c\u6b62</li> </ul> <pre><code># master\u306emysqld\u3092\u505c\u6b62\n[root@node1 work]# systemctl stop mysqld\n</code></pre> <ul> <li>slave\u4e0a\u3067\u78ba\u8a8d</li> </ul> <pre><code># slave\u4e0a\u3067\u78ba\u8a8d\n## node2\n04:59:20 root@localhost[(none)]&gt; SELECT MEMBER_ID,MEMBER_HOST,MEMBER_STATE, MEMBER_ROLE FROM performance_schema.replication_group_members;\n+--------------------------------------+-------------+--------------+-------------+\n| MEMBER_ID                            | MEMBER_HOST | MEMBER_STATE | MEMBER_ROLE |\n+--------------------------------------+-------------+--------------+-------------+\n| 74ba497e-f2f1-11ed-9e8e-5254007b60ca | node2       | ONLINE       | PRIMARY     |  &lt;&lt;-- master\u304cnode2\u306b\u5207\u308a\u66ff\u3048\u305f\u3053\u3068\u78ba\u8a8d\u3067\u304d\u305f\u3002\n| d7239f8c-f2f1-11ed-aeeb-525400c72882 | node3       | ONLINE       | SECONDARY   |\n+--------------------------------------+-------------+--------------+-------------+\n2 rows in set (0.00 sec)\n\n05:00:19 root@localhost[(none)]&gt;\n\n## node3\n05:01:55 root@localhost[(none)]&gt; SELECT MEMBER_ID,MEMBER_HOST,MEMBER_STATE, MEMBER_ROLE FROM performance_schema.replication_group_members;\n+--------------------------------------+-------------+--------------+-------------+\n| MEMBER_ID                            | MEMBER_HOST | MEMBER_STATE | MEMBER_ROLE |\n+--------------------------------------+-------------+--------------+-------------+\n| 74ba497e-f2f1-11ed-9e8e-5254007b60ca | node2       | ONLINE       | PRIMARY     |  &lt;&lt;-- master\u304cnode2\u306b\u5207\u308a\u66ff\u3048\u305f\u3053\u3068\u78ba\u8a8d\u3067\u304d\u305f\u3002\n| d7239f8c-f2f1-11ed-aeeb-525400c72882 | node3       | ONLINE       | SECONDARY   |\n+--------------------------------------+-------------+--------------+-------------+\n2 rows in set (0.00 sec)\n\n\n\n# mysql\u30ed\u30b0\n\n## mysqld\u3092\u505c\u6b62\u306e\u969b\n2023-05-16T16:50:39.420249+09:00 13 [Note] [MY-010559] [Repl] Multi-threaded replica statistics for channel 'group_replication_applier': seconds elapsed = 3044; events assigned = 1025; worker queues filled over overrun level = 0; waited due a Worker queue full = 0; waited due the total size = 0; waited at clock conflicts = 433423400 waited (count) when Workers occupied = 0 waited when Workers occupied = 0\n2023-05-16T16:50:56.719644+09:00 41 [Note] [MY-013730] [Server] 'wait_timeout' period of 300 seconds was exceeded for `root`@`localhost`. The idle time since last command was too long.\n2023-05-16T16:50:56.719745+09:00 41 [Note] [MY-010914] [Server] Aborted connection 41 to db: 'unconnected' user: 'root' host: 'localhost' (The client was disconnected by the server because of inactivity.).\n2023-05-16T16:52:39.039940+09:00 13 [Note] [MY-010559] [Repl] Multi-threaded replica statistics for channel 'group_replication_applier': seconds elapsed = 120; events assigned = 1155073; worker queues filled over overrun level = 0; waited due a Worker queue full = 0; waited due the total size = 0; waited at clock conflicts = 1878944800 waited (count) when Workers occupied = 20404 waited when Workers occupied = 11202672000\n2023-05-16T16:54:39.060182+09:00 13 [Note] [MY-010559] [Repl] Multi-threaded replica statistics for channel 'group_replication_applier': seconds elapsed = 120; events assigned = 3861505; worker queues filled over overrun level = 0; waited due a Worker queue full = 0; waited due the total size = 0; waited at clock conflicts = 1881781000 waited (count) when Workers occupied = 134123 waited when Workers occupied = 63201443400\n2023-05-16T16:56:39.016324+09:00 13 [Note] [MY-010559] [Repl] Multi-threaded replica statistics for channel 'group_replication_applier': seconds elapsed = 120; events assigned = 7382017; worker queues filled over overrun level = 0; waited due a Worker queue full = 0; waited due the total size = 0; waited at clock conflicts = 1883981300 waited (count) when Workers occupied = 361966 waited when Workers occupied = 163103230800\n2023-05-16T16:58:58.960486+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Updating physical connections to other servers'\n2023-05-16T16:58:58.960609+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Using existing server node 0 host node2:33061'\n2023-05-16T16:58:58.960624+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Using existing server node 1 host node3:33061'\n2023-05-16T16:58:58.960636+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Sucessfully installed new site definition. Start synode for this configuration is {dd63b25c 719175 0}, boot key synode is {dd63b25c 719164 0}, configured event horizon=10, my node identifier is 0'\n2023-05-16T16:58:59.735276+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] A configuration change was detected. Sending a Global View Message to all nodes. My node identifier is 0 and my address is node2:33061'\n2023-05-16T16:58:59.739469+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Group is able to support up to communication protocol version 8.0.27'\n\n## MGR\u304b\u3089node1\u3092\u9664\u5916\u3055\u308c\u308b\n2023-05-16T16:58:59.739611+09:00 0 [Warning] [MY-011499] [Repl] Plugin group_replication reported: 'Members removed from the group: node1:3306'\n2023-05-16T16:58:59.739642+09:00 0 [System] [MY-011500] [Repl] Plugin group_replication reported: 'Primary server with address node1:3306 left the group. Electing new Primary.'\n2023-05-16T16:58:59.739912+09:00 0 [Note] [MY-013519] [Repl] Plugin group_replication reported: 'Elected primary member gtid_executed: aaaaaaaa-1111-2222-3333-bbbbbbbbbbbb:1-852676'\n2023-05-16T16:58:59.739948+09:00 0 [Note] [MY-013519] [Repl] Plugin group_replication reported: 'Elected primary member applier channel received_transaction_set: aaaaaaaa-1111-2222-3333-bbbbbbbbbbbb:1-852676'\n\n## \u65b0\u305f\u306a Primary server \u3092node2\u306b\u9078\u629e\u3055\u308c\u305f\n2023-05-16T16:58:59.740007+09:00 0 [System] [MY-011507] [Repl] Plugin group_replication reported: 'A new primary with address node2:3306 was elected. The new primary will execute all previous group transactions before allowing writes.'\n2023-05-16T16:58:59.740757+09:00 0 [System] [MY-011503] [Repl] Plugin group_replication reported: 'Group membership changed to node2:3306, node3:3306 on view 16842195647561739:10.'\n2023-05-16T16:58:59.741723+09:00 46 [System] [MY-011565] [Repl] Plugin group_replication reported: 'Setting super_read_only=ON.'\n2023-05-16T16:58:59.742265+09:00 19 [System] [MY-013731] [Repl] Plugin group_replication reported: 'The member action \"mysql_disable_super_read_only_if_primary\" for event \"AFTER_PRIMARY_ELECTION\" with priority \"1\" will be run.'\n2023-05-16T16:58:59.742318+09:00 19 [System] [MY-011566] [Repl] Plugin group_replication reported: 'Setting super_read_only=OFF.'\n2023-05-16T16:58:59.742649+09:00 19 [System] [MY-013731] [Repl] Plugin group_replication reported: 'The member action \"mysql_start_failover_channels_if_primary\" for event \"AFTER_PRIMARY_ELECTION\" with priority \"10\" will be run.'\n\n2023-05-16T16:58:59.743420+09:00 46 [System] [MY-011510] [Repl] Plugin group_replication reported: 'This server is working as primary member.'\n2023-05-16T16:58:59.743453+09:00 11 [Note] [MY-011485] [Repl] Plugin group_replication reported: 'Primary had applied all relay logs, disabled conflict detection.'\n2023-05-16T16:59:01.971224+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Failure reading from fd=56 n=0 from node1:33061'\n2023-05-16T17:05:19.471719+09:00 42 [Note] [MY-013730] [Server] 'wait_timeout' period of 300 seconds was exceeded for `root`@`localhost`. The idle time since last command was too long.\n2023-05-16T17:05:19.472016+09:00 42 [Note] [MY-010914] [Server] Aborted connection 42 to db: 'unconnected' user: 'root' host: 'localhost' (The client was disconnected by the server because of inactivity.).\n\n## node1\u306emysqld\u3092\u8d77\u52d5\u3057\u3001start group_replication\u3057\u307e\u3057\u305f\u3002\n2023-05-16T17:06:30.683150+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Adding new node to the configuration: node1:33061'\n2023-05-16T17:06:30.683570+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Updating physical connections to other servers'\n2023-05-16T17:06:30.683610+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Using existing server node 0 host node2:33061'\n2023-05-16T17:06:30.683623+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Using existing server node 1 host node3:33061'\n2023-05-16T17:06:30.683634+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Using existing server node 2 host node1:33061'\n2023-05-16T17:06:30.683652+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Sucessfully installed new site definition. Start synode for this configuration is {dd63b25c 834186 0}, boot key synode is {dd63b25c 834175 0}, configured event horizon=10, my node identifier is 0'\n2023-05-16T17:06:30.684085+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Sender task disconnected from node1:33061'\n2023-05-16T17:06:30.684112+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Connecting to node1:33061'\n2023-05-16T17:06:30.684368+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Connected to node1:33061'\n2023-05-16T17:06:31.487931+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] A configuration change was detected. Sending a Global View Message to all nodes. My node identifier is 0 and my address is node2:33061'\n2023-05-16T17:06:37.966205+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] A configuration change was detected. Sending a Global View Message to all nodes. My node identifier is 0 and my address is node2:33061'\n2023-05-16T17:06:38.065989+09:00 0 [Note] [MY-011735] [Repl] Plugin group_replication reported: '[GCS] Group is able to support up to communication protocol version 8.0.27'\n2023-05-16T17:06:38.066211+09:00 0 [Note] [MY-011501] [Repl] Plugin group_replication reported: 'Members joined the group: node1:3306'\n2023-05-16T17:06:38.066410+09:00 0 [System] [MY-011503] [Repl] Plugin group_replication reported: 'Group membership changed to node2:3306, node3:3306, node1:3306 on view 16842195647561739:11.'\n\n## binlog\u3092node1\u306b\u8ee2\u9001\u3059\u308b\n2023-05-16T17:06:38.092124+09:00 62 [Note] [MY-010462] [Repl] Start binlog_dump to source_thread_id(62) replica_server(1), pos(, 4)\n\n## node1\u3092MGR\u306e\u4e00\u54e1\u3068\u3057\u3066join\u3057\u307e\u3057\u305f\u3002\n2023-05-16T17:07:48.293141+09:00 0 [System] [MY-011492] [Repl] Plugin group_replication reported: 'The member with address node1:3306 was declared online within the replication group.'\n2023-05-16T17:08:20.217670+09:00 62 [Note] [MY-010914] [Server] Aborted connection 62 to db: 'unconnected' user: 'repl_user' host: '49.212.126.51' (failed on flush_net()).\n2023-05-16T17:10:49.417733+09:00 58 [Note] [MY-013730] [Server] 'wait_timeout' period of 300 seconds was exceeded for `root`@`localhost`. The idle time since last command was too long.\n2023-05-16T17:10:49.418050+09:00 58 [Note] [MY-010914] [Server] Aborted connection 58 to db: 'unconnected' user: 'root' host: 'localhost' (The client was disconnected by the server because of inactivity.).\n\n</code></pre>"},{"location":"mysql-mgr/#master_2","title":"MASTER\u30b5\u30fc\u30d0\u3092\u969c\u5bb3\u304b\u3089\u5fa9\u6d3b\u306e\u5834\u5408","text":"<pre><code># mysqld\u3092\u8d77\u52d5\n[root@node1 work]# systemctl start mysqld\n\n# \u73fe\u72b6\u78ba\u8a8d\n-- offline\u3067\u3042\u308b\u3053\u3068\n04:59:07 root@localhost[(none)]&gt; select * from performance_schema.replication_group_members ;\n+---------------------------+-----------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| CHANNEL_NAME              | MEMBER_ID | MEMBER_HOST | MEMBER_PORT | MEMBER_STATE | MEMBER_ROLE | MEMBER_VERSION | MEMBER_COMMUNICATION_STACK |\n+---------------------------+-----------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| group_replication_applier |           |             |        NULL | OFFLINE      |             |                |                            |\n+---------------------------+-----------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n1 row in set (0.00 sec)\n\n# MGR\u3092\u8d77\u52d5\u3059\u308b\n04:59:10 root@localhost[(none)]&gt; start group_replication;\nQuery OK, 0 rows affected (8.60 sec)\n\n# MGR\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u3092\u78ba\u8a8d\n# \u8d77\u52d5\u76f4\u5f8c\u306eMEMBER_STATE\u304cRECOVERING\u3067\u3042\u308b\u3053\u3068\n-- \u30c7\u30fc\u30bf\u306e\u81ea\u52d5\u540c\u671f\u4e2d\n\n04:59:25 root@localhost[(none)]&gt; select * from performance_schema.replication_group_members ;\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| CHANNEL_NAME              | MEMBER_ID                            | MEMBER_HOST | MEMBER_PORT | MEMBER_STATE | MEMBER_ROLE | MEMBER_VERSION | MEMBER_COMMUNICATION_STACK |\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n| group_replication_applier | 74ba497e-f2f1-11ed-9e8e-5254007b60ca | node2       |        3306 | ONLINE       | PRIMARY     | 8.0.33         | XCom                       |\n| group_replication_applier | d7239f8c-f2f1-11ed-aeeb-525400c72882 | node3       |        3306 | ONLINE       | SECONDARY   | 8.0.33         | XCom                       |\n| group_replication_applier | defba275-f2ef-11ed-9eae-525400e752a2 | node1       |        3306 | RECOVERING   | SECONDARY   | 8.0.33         | XCom                       |\n+---------------------------+--------------------------------------+-------------+-------------+--------------+-------------+----------------+----------------------------+\n3 rows in set (0.00 sec)\n\n# \u3057\u3070\u3089\u304f\u5f8c\u72b6\u6cc1\u3092\u78ba\u8a8d\n05:04:19 root@localhost[(none)]&gt; SELECT MEMBER_ID,MEMBER_HOST,MEMBER_STATE, MEMBER_ROLE FROM performance_schema.replication_group_members;\n+--------------------------------------+-------------+--------------+-------------+\n| MEMBER_ID                            | MEMBER_HOST | MEMBER_STATE | MEMBER_ROLE |\n+--------------------------------------+-------------+--------------+-------------+\n| 74ba497e-f2f1-11ed-9e8e-5254007b60ca | node2       | ONLINE       | PRIMARY     |\n| d7239f8c-f2f1-11ed-aeeb-525400c72882 | node3       | ONLINE       | SECONDARY   |\n| defba275-f2ef-11ed-9eae-525400e752a2 | node1       | ONLINE       | SECONDARY   |  &lt;&lt;-- ONLINE\u306b\u623b\u308a\u307e\u3057\u305f\u3002\n+--------------------------------------+-------------+--------------+-------------+\n3 rows in set (0.00 sec)\n\n05:04:19 root@localhost[(none)]&gt;\n\n</code></pre>"},{"location":"mysql-table/","title":"MySQL-table","text":"<p>=========================================================================================================================================</p>"},{"location":"mysql-table/#databasetable","title":"\u6307\u5b9a\u7684Database\u91cc\u7684\u6307\u5b9a\u7684Table\u5bb9\u91cf","text":"<pre><code>SELECT \n    table_name AS `Table`, \n    round(((data_length + index_length) / 1024 / 1024), 2) `Size in MB` \nFROM information_schema.TABLES \nWHERE table_schema = \"$DB_NAME\"\n    AND table_name = \"$TABLE_NAME\";\n\nmysql -uroot -e\n  \"SELECT TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 / 1024), 2) AS 'Size (GB)'\n   FROM information_schema.tables \n   WHERE table_schema = '$DB_NAME' AND table_name = '$TABLE_NAME';\"\n - mysql55-dev# mysql -uroot -e \" SELECT TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 / 1024), 2) AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'tigrex_mygoods2' AND table_name = 'g5_apms_like';\"\n</code></pre>"},{"location":"mysql-table/#databasetable_1","title":"\u6307\u5b9a\u7684Database\u91cc\u7684\u6240\u6709\u7684Table\u5bb9\u91cf","text":"<pre><code>[root@mysqlxxx log]# mysql -uroot -e \"SELECT TABLE_SCHEMA, TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 ),2)  AS 'Size (MB)' FROM information_schema.tables  WHERE table_schema = 'zeroen_wp'ORDER BY (data_length + index_length) DESC ;\"\n+--------------+--------------------------------+-----------+\n| TABLE_SCHEMA | TABLE_NAME                     | Size (GB) |\n+--------------+--------------------------------+-----------+\n| zeroen_wp    | wp74e2b1options                |      0.39 |\n| zeroen_wp    | wp74e2b1postmeta               |      0.28 |\n| zeroen_wp    | wp74e2b1posts                  |      0.13 |\n| zeroen_wp    | wp74e2b1comments               |      0.09 |\n| zeroen_wp    | wp74e2b1users                  |      0.06 |\n| zeroen_wp    | wp74e2b1usermeta               |      0.05 |\n| zeroen_wp    | wp74e2b1terms                  |      0.05 |\n| zeroen_wp    | wp74e2b1termmeta               |      0.05 |\n| zeroen_wp    | wp74e2b1term_taxonomy          |      0.05 |\n| zeroen_wp    | wp74e2b1commentmeta            |      0.05 |\n| zeroen_wp    | wp74e2b1term_relationships     |      0.03 |\n| zeroen_wp    | wp74e2b1links                  |      0.03 |\n| zeroen_wp    | wp74e2b1aiowps_login_lockdown  |      0.02 |\n| zeroen_wp    | wp74e2b1aiowps_login_activity  |      0.02 |\n| zeroen_wp    | wp74e2b1aiowps_global_meta     |      0.02 |\n| zeroen_wp    | wp74e2b1aiowps_failed_logins   |      0.02 |\n| zeroen_wp    | wp74e2b1aiowps_events          |      0.02 |\n| zeroen_wp    | wp74e2b1aiowps_permanent_block |      0.02 |\n+--------------+--------------------------------+-----------+\n[root@mysqlxxx log]#\n</code></pre>"},{"location":"mysql-table/#databasetable_2","title":"\u6240\u6709\u7684Database\u91cc\u7684\u6240\u6709\u7684Table\u5bb9\u91cf","text":"<pre><code>SELECT \n     table_schema as `Database`, \n     table_name AS `Table`, \n     round(((data_length + index_length) / 1024 / 1024), 2) `Size in MB` \nFROM information_schema.TABLES \nORDER BY (data_length + index_length) DESC;\n - mysql -uroot -e \"SELECT TABLE_SCHEMA, TABLE_NAME, round(((data_length+index_length) / 1024),2)  AS 'Size (GB)' FROM information_schema.tables  ORDER BY (data_length + index_length) DESC;\"\n - mysql55-dev# mysql -uroot -e \" SELECT TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 / 1024), 2) AS 'Size (GB)' FROM information_schema.tables ORDER BY (data_length + index_length) DESC;\"\n</code></pre>"},{"location":"mysql-table/#databasetable_3","title":"\u6307\u5b9a\u7684Database\u91cc\u7684\u6240\u6709\u7684Table\u5bb9\u91cf","text":"<pre><code>mysql -uroot -e\n  \"SELECT TABLE_SCHEMA AS 'Database Name',\n   TABLE_NAME AS 'TABLE_NAME',\n   SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size (GB)'\n   FROM information_schema.tables \n   WHERE table_schema = '$DB_NAME'\n   ORDER BY (data_length + index_length) DESC;\"\n\n - mysql -uroot -e \"SELECT TABLE_SCHEMA, TABLE_NAME, round(((data_length+index_length) / 1024),2)  AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'tigrex_mygoods' ORDER BY (data_length + index_length) DESC;\"\n</code></pre> <pre><code>use databaseName;\nselect  \ntable_name, engine, table_rows as tbl_rows, avg_row_length as rlen,  \nfloor((data_length+index_length)/1024/1024) as allMB,  #\u7dcf\u5bb9\u91cf\nfloor((data_length)/1024/1024) as dMB,  #\u30c7\u30fc\u30bf\u5bb9\u91cf\nfloor((index_length)/1024/1024) as iMB   #\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u5bb9\u91cf\nfrom information_schema.tables  \nwhere table_schema=database()  \norder by (data_length+index_length) desc; \n</code></pre> <p>=========================================================================================================================================</p> <pre><code>mysql&gt; select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA = 'spacerental2_kikou' and  TABLE_TYPE = 'VIEW';\n+------------------------+\n| TABLE_NAME             |\n+------------------------+\n| roomtimetable_chk_v01  |\n| roomtimetable_disp     |\n| roomtimetable_disp_v01 |\n| roomtimetable_disp_v02 |\n| sagakuview             |\n| sagakuview1            |\n| sagakuview_Ytmp        |\n| sagakuview_n           |\n| sagakuview_ngaku       |\n| sagakuview_s           |\n| sagakuview_sgaku       |\n| sagakuview_y           |\n| sagakuview_ygaku       |\n| yoyakubihintable_v01   |\n| yoyakubihintable_v02   |\n| yoyakubihintable_v03   |\n| yoyakubihintable_v04   |\n+------------------------+\n17 rows in set (0.01 sec)\n</code></pre>"},{"location":"mysql-table/#database","title":"\u6307\u5b9a\u7684Database\u91cc\u7684\u7dcf\u5bb9\u91cf","text":"<pre><code>mysql# mysql -uroot -e \"SELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'test45_wdpress';\"\n\nmysql&gt; sELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'test45_wdpress';\n+----------------+----------------+\n| TABLE_SCHEMA   | Size (GB)      |\n+----------------+----------------+\n| test45_wdpress | 0.000793457031 |\n+----------------+----------------+\n1 row in set (0.01 sec)\n\nmysql&gt;\n</code></pre>"},{"location":"mysql-table/#database_1","title":"\u8907\u6570Database\u306e\u5404\u5bb9\u91cf","text":"<pre><code>mysql&gt; SELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 AS 'Size'  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA IN  (\"dbname_table1\", \"dbname_table2\") GROUP BY TABLE_SCHEMA;\n+--------------------+--------------+\n| TABLE_SCHEMA       | Size         |\n+--------------------+--------------+\n| dbname_table1      | 688.31250000 |\n| dbname_table2      | 657.39062500 |\n+--------------------+--------------+\n2 rows in set (0.09 sec)\n\nmysql&gt;\n</code></pre>"},{"location":"mysql-table/#database-and","title":"\u8907\u6570Database\u306e\u7dcf\u5bb9\u91cf and \u5404\u5bb9\u91cf","text":"<pre><code>mysql&gt; SELECT  SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size GB'  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA like \"dbname_table_%\"  ;\n+----------------+\n| Size GB        |\n+----------------+\n| 3.150512695313 |\n+----------------+\n1 row in set (0.58 sec)\n\nmysql&gt; SELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 AS 'Size'  FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA like \"dbname_table_%\"  GROUP BY TABLE_SCHEMA;\n+---------------------------+--------------+\n| TABLE_SCHEMA              | Size         |\n+---------------------------+--------------+\n| dbname_table_1            | 661.78125000 |\n| dbname_table_2            | 158.42187500 |\n| dbname_table_3            | 472.39062500 |\n| dbname_table_4            | 196.60937500 |\n| dbname_table_5            |  82.23437500 |\n| dbname_table_6            | 479.35937500 |\n| dbname_table_7            | 403.57812500 |\n| dbname_table_8            | 197.03125000 |\n| dbname_table_9            | 156.93750000 |\n| dbname_table_10           | 400.75000000 |\n| dbname_table_11           |  17.03125000 |\n+---------------------------+--------------+\n11 rows in set (0.60 sec)\n\nmysql&gt;\n</code></pre>"},{"location":"mysql/","title":"MySQL","text":""},{"location":"mysql/#mysql","title":"Mysql\u53c2\u6570\u4f18\u5316\u5bf9\u4e8e\u65b0\u624b\u6765\u8bb2\uff0c\u662f\u6bd4\u8f83\u96be\u61c2\u7684\u4e1c\u897f\uff0c\u5176\u5b9e\u8fd9\u4e2a\u53c2\u6570\u4f18\u5316\uff0c\u662f\u4e2a\u5f88\u590d\u6742\u7684\u4e1c\u897f\uff0c","text":"<p>\u5bf9\u4e8e\u4e0d\u540c\u7684\u7f51\u7ad9\uff0c\u53ca\u5176\u5728\u7ebf\u91cf\uff0c\u8bbf\u95ee\u91cf\uff0c\u5e16\u5b50\u6570\u91cf\uff0c\u7f51\u7edc\u60c5\u51b5\uff0c\u4ee5\u53ca\u673a\u5668\u786c\u4ef6\u914d\u7f6e\u90fd\u6709\u5173\u7cfb\uff0c\u4f18\u5316\u4e0d\u53ef\u80fd\u4e00\u6b21\u6027\u5b8c\u6210\uff0c\u9700\u8981\u4e0d\u65ad\u7684\u89c2\u5bdf\u4ee5\u53ca\u8c03\u8bd5\uff0c\u624d\u6709\u53ef\u80fd\u5f97\u5230\u6700\u4f73\u6548\u679c\u3002</p> <pre><code>[client]\nport = 3306\nsocket = /tmp/mysql.sock\n[mysqld]\nport = 3306\nsocket = /tmp/mysql.sock\nbasedir = /usr/local/mysql\ndatadir = /data/mysql\npid-file = /data/mysql/mysql.pid\nuser = mysql\nbind-address = 0.0.0.0\nserver-id = 1 #\u8868\u793a\u662f\u672c\u673a\u7684\u5e8f\u53f7\u4e3a1,\u4e00\u822c\u6765\u8bb2\u5c31\u662fmaster\u7684\u610f\u601d\nskip-name-resolve\n# \u7981\u6b62MySQL\u5bf9\u5916\u90e8\u8fde\u63a5\u8fdb\u884cDNS\u89e3\u6790\uff0c\u4f7f\u7528\u8fd9\u4e00\u9009\u9879\u53ef\u4ee5\u6d88\u9664MySQL\u8fdb\u884cDNS\u89e3\u6790\u7684\u65f6\u95f4\u3002\u4f46\u9700\u8981\u6ce8\u610f\uff0c\u5982\u679c\u5f00\u542f\u8be5\u9009\u9879\uff0c\n# \u5219\u6240\u6709\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u6388\u6743\u90fd\u8981\u4f7f\u7528IP\u5730\u5740\u65b9\u5f0f\uff0c\u5426\u5219MySQL\u5c06\u65e0\u6cd5\u6b63\u5e38\u5904\u7406\u8fde\u63a5\u8bf7\u6c42\n#skip-networking\nback_log = 600\n# MySQL\u80fd\u6709\u7684\u8fde\u63a5\u6570\u91cf\u3002\u5f53\u4e3b\u8981MySQL\u7ebf\u7a0b\u5728\u4e00\u4e2a\u5f88\u77ed\u65f6\u95f4\u5185\u5f97\u5230\u975e\u5e38\u591a\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u8fd9\u5c31\u8d77\u4f5c\u7528\uff0c\n# \u7136\u540e\u4e3b\u7ebf\u7a0b\u82b1\u4e9b\u65f6\u95f4(\u5c3d\u7ba1\u5f88\u77ed)\u68c0\u67e5\u8fde\u63a5\u5e76\u4e14\u542f\u52a8\u4e00\u4e2a\u65b0\u7ebf\u7a0b\u3002back_log\u503c\u6307\u51fa\u5728MySQL\u6682\u65f6\u505c\u6b62\u56de\u7b54\u65b0\u8bf7\u6c42\u4e4b\u524d\u7684\u77ed\u65f6\u95f4\u5185\u591a\u5c11\u4e2a\u8bf7\u6c42\u53ef\u4ee5\u88ab\u5b58\u5728\u5806\u6808\u4e2d\u3002\n# \u5982\u679c\u671f\u671b\u5728\u4e00\u4e2a\u77ed\u65f6\u95f4\u5185\u6709\u5f88\u591a\u8fde\u63a5\uff0c\u4f60\u9700\u8981\u589e\u52a0\u5b83\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679cMySQL\u7684\u8fde\u63a5\u6570\u636e\u8fbe\u5230max_connections\u65f6\uff0c\u65b0\u6765\u7684\u8bf7\u6c42\u5c06\u4f1a\u88ab\u5b58\u5728\u5806\u6808\u4e2d\uff0c\n# \u4ee5\u7b49\u5f85\u67d0\u4e00\u8fde\u63a5\u91ca\u653e\u8d44\u6e90\uff0c\u8be5\u5806\u6808\u7684\u6570\u91cf\u5373back_log\uff0c\u5982\u679c\u7b49\u5f85\u8fde\u63a5\u7684\u6570\u91cf\u8d85\u8fc7back_log\uff0c\u5c06\u4e0d\u88ab\u6388\u4e88\u8fde\u63a5\u8d44\u6e90\u3002\n# \u53e6\u5916\uff0c\u8fd9\u503c\uff08back_log\uff09\u9650\u4e8e\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u5230\u6765\u7684TCP/IP\u8fde\u63a5\u7684\u4fa6\u542c\u961f\u5217\u7684\u5927\u5c0f\u3002\n# \u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u5728\u8fd9\u4e2a\u961f\u5217\u5927\u5c0f\u4e0a\u6709\u5b83\u81ea\u5df1\u7684\u9650\u5236\uff08\u53ef\u4ee5\u68c0\u67e5\u4f60\u7684OS\u6587\u6863\u627e\u51fa\u8fd9\u4e2a\u53d8\u91cf\u7684\u6700\u5927\u503c\uff09\uff0c\u8bd5\u56fe\u8bbe\u5b9aback_log\u9ad8\u4e8e\u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u7684\u9650\u5236\u5c06\u662f\u65e0\u6548\u7684\u3002\n\nmax_connections = 1000\n# MySQL\u7684\u6700\u5927\u8fde\u63a5\u6570\uff0c\u5982\u679c\u670d\u52a1\u5668\u7684\u5e76\u53d1\u8fde\u63a5\u8bf7\u6c42\u91cf\u6bd4\u8f83\u5927\uff0c\u5efa\u8bae\u8c03\u9ad8\u6b64\u503c\uff0c\u4ee5\u589e\u52a0\u5e76\u884c\u8fde\u63a5\u6570\u91cf\uff0c\n# \u5f53\u7136\u8fd9\u5efa\u7acb\u5728\u673a\u5668\u80fd\u652f\u6491\u7684\u60c5\u51b5\u4e0b\uff0c\u56e0\u4e3a\u5982\u679c\u8fde\u63a5\u6570\u8d8a\u591a\uff0c\u4ecb\u4e8eMySQL\u4f1a\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u63d0\u4f9b\u8fde\u63a5\u7f13\u51b2\u533a\uff0c\n# \u5c31\u4f1a\u5f00\u9500\u8d8a\u591a\u7684\u5185\u5b58\uff0c\u6240\u4ee5\u8981\u9002\u5f53\u8c03\u6574\u8be5\u503c\uff0c\u4e0d\u80fd\u76f2\u76ee\u63d0\u9ad8\u8bbe\u503c\u3002\u53ef\u4ee5\u8fc7'conn%'\u901a\u914d\u7b26\u67e5\u770b\u5f53\u524d\u72b6\u6001\u7684\u8fde\u63a5\u6570\u91cf\uff0c\u4ee5\u5b9a\u593a\u8be5\u503c\u7684\u5927\u5c0f\u3002\n\nmax_connect_errors = 6000\n# \u5bf9\u4e8e\u540c\u4e00\u4e3b\u673a\uff0c\u5982\u679c\u6709\u8d85\u51fa\u8be5\u53c2\u6570\u503c\u4e2a\u6570\u7684\u4e2d\u65ad\u9519\u8bef\u8fde\u63a5\uff0c\u5219\u8be5\u4e3b\u673a\u5c06\u88ab\u7981\u6b62\u8fde\u63a5\u3002\u5982\u9700\u5bf9\u8be5\u4e3b\u673a\u8fdb\u884c\u89e3\u7981\uff0c\u6267\u884c\uff1aFLUSH HOST\u3002\n\nopen_files_limit = 65535\n# MySQL\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u9650\u5236\uff0c\u9ed8\u8ba4\u6700\u5c0f1024;\u5f53open_files_limit\u6ca1\u6709\u88ab\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u6bd4\u8f83max_connections*5\u548culimit -n\u7684\u503c\uff0c\u54ea\u4e2a\u5927\u7528\u54ea\u4e2a\uff0c\n# \u5f53open_file_limit\u88ab\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u6bd4\u8f83open_files_limit\u548cmax_connections*5\u7684\u503c\uff0c\u54ea\u4e2a\u5927\u7528\u54ea\u4e2a\u3002\n\ntable_open_cache = 128\n# MySQL\u6bcf\u6253\u5f00\u4e00\u4e2a\u8868\uff0c\u90fd\u4f1a\u8bfb\u5165\u4e00\u4e9b\u6570\u636e\u5230table_open_cache\u7f13\u5b58\u4e2d\uff0c\u5f53MySQL\u5728\u8fd9\u4e2a\u7f13\u5b58\u4e2d\u627e\u4e0d\u5230\u76f8\u5e94\u4fe1\u606f\u65f6\uff0c\u624d\u4f1a\u53bb\u78c1\u76d8\u4e0a\u8bfb\u53d6\u3002\u9ed8\u8ba4\u503c64\n# \u5047\u5b9a\u7cfb\u7edf\u6709200\u4e2a\u5e76\u53d1\u8fde\u63a5\uff0c\u5219\u9700\u5c06\u6b64\u53c2\u6570\u8bbe\u7f6e\u4e3a200*N(N\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u6240\u9700\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u76ee)\uff1b\n# \u5f53\u628atable_open_cache\u8bbe\u7f6e\u4e3a\u5f88\u5927\u65f6\uff0c\u5982\u679c\u7cfb\u7edf\u5904\u7406\u4e0d\u4e86\u90a3\u4e48\u591a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u90a3\u4e48\u5c31\u4f1a\u51fa\u73b0\u5ba2\u6237\u7aef\u5931\u6548\uff0c\u8fde\u63a5\u4e0d\u4e0a\n\nmax_allowed_packet = 4M\n# \u63a5\u53d7\u7684\u6570\u636e\u5305\u5927\u5c0f\uff1b\u589e\u52a0\u8be5\u53d8\u91cf\u7684\u503c\u5341\u5206\u5b89\u5168\uff0c\u8fd9\u662f\u56e0\u4e3a\u4ec5\u5f53\u9700\u8981\u65f6\u624d\u4f1a\u5206\u914d\u989d\u5916\u5185\u5b58\u3002\n# \u4f8b\u5982\uff0c\u4ec5\u5f53\u4f60\u53d1\u51fa\u957f\u67e5\u8be2\u6216MySQLd\u5fc5\u987b\u8fd4\u56de\u5927\u7684\u7ed3\u679c\u884c\u65f6MySQLd\u624d\u4f1a\u5206\u914d\u66f4\u591a\u5185\u5b58\u3002\n# \u8be5\u53d8\u91cf\u4e4b\u6240\u4ee5\u53d6\u8f83\u5c0f\u9ed8\u8ba4\u503c\u662f\u4e00\u79cd\u9884\u9632\u63aa\u65bd\uff0c\u4ee5\u6355\u83b7\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u9519\u8bef\u4fe1\u606f\u5305\uff0c\u5e76\u786e\u4fdd\u4e0d\u4f1a\u56e0\u5076\u7136\u4f7f\u7528\u5927\u7684\u4fe1\u606f\u5305\u800c\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u3002\n\nbinlog_cache_size = 1M\n# \u4e00\u4e2a\u4e8b\u52a1\uff0c\u5728\u6ca1\u6709\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u4ea7\u751f\u7684\u65e5\u5fd7\uff0c\u8bb0\u5f55\u5230Cache\u4e2d\uff1b\u7b49\u5230\u4e8b\u52a1\u63d0\u4ea4\u9700\u8981\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u5219\u628a\u65e5\u5fd7\u6301\u4e45\u5316\u5230\u78c1\u76d8\u3002\u9ed8\u8ba4binlog_cache_size\u5927\u5c0f32K\n\nmax_heap_table_size = 8M\n# \u5b9a\u4e49\u4e86\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u7684\u5185\u5b58\u8868(memory table)\u7684\u5927\u5c0f\u3002\u8fd9\u4e2a\u503c\u7528\u6765\u8ba1\u7b97\u5185\u5b58\u8868\u7684\u6700\u5927\u884c\u6570\u503c\u3002\u8fd9\u4e2a\u53d8\u91cf\u652f\u6301\u52a8\u6001\u6539\u53d8\n\ntmp_table_size = 16M\n# MySQL\u7684heap\uff08\u5806\u79ef\uff09\u8868\u7f13\u51b2\u5927\u5c0f\u3002\u6240\u6709\u8054\u5408\u5728\u4e00\u4e2aDML\u6307\u4ee4\u5185\u5b8c\u6210\uff0c\u5e76\u4e14\u5927\u591a\u6570\u8054\u5408\u751a\u81f3\u53ef\u4ee5\u4e0d\u7528\u4e34\u65f6\u8868\u5373\u53ef\u4ee5\u5b8c\u6210\u3002\n# \u5927\u591a\u6570\u4e34\u65f6\u8868\u662f\u57fa\u4e8e\u5185\u5b58\u7684(HEAP)\u8868\u3002\u5177\u6709\u5927\u7684\u8bb0\u5f55\u957f\u5ea6\u7684\u4e34\u65f6\u8868 (\u6240\u6709\u5217\u7684\u957f\u5ea6\u7684\u548c)\u6216\u5305\u542bBLOB\u5217\u7684\u8868\u5b58\u50a8\u5728\u786c\u76d8\u4e0a\u3002\n# \u5982\u679c\u67d0\u4e2a\u5185\u90e8heap\uff08\u5806\u79ef\uff09\u8868\u5927\u5c0f\u8d85\u8fc7tmp_table_size\uff0cMySQL\u53ef\u4ee5\u6839\u636e\u9700\u8981\u81ea\u52a8\u5c06\u5185\u5b58\u4e2d\u7684heap\u8868\u6539\u4e3a\u57fa\u4e8e\u786c\u76d8\u7684MyISAM\u8868\u3002\n# \u8fd8\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6etmp_table_size\u9009\u9879\u6765\u589e\u52a0\u4e34\u65f6\u8868\u7684\u5927\u5c0f\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u8c03\u9ad8\u8be5\u503c\uff0cMySQL\u540c\u65f6\u5c06\u589e\u52a0heap\u8868\u7684\u5927\u5c0f\uff0c\u53ef\u8fbe\u5230\u63d0\u9ad8\u8054\u63a5\u67e5\u8be2\u901f\u5ea6\u7684\u6548\u679c\n\nread_buffer_size = 2M\n# MySQL\u8bfb\u5165\u7f13\u51b2\u533a\u5927\u5c0f\u3002\u5bf9\u8868\u8fdb\u884c\u987a\u5e8f\u626b\u63cf\u7684\u8bf7\u6c42\u5c06\u5206\u914d\u4e00\u4e2a\u8bfb\u5165\u7f13\u51b2\u533a\uff0cMySQL\u4f1a\u4e3a\u5b83\u5206\u914d\u4e00\u6bb5\u5185\u5b58\u7f13\u51b2\u533a\u3002\n# read_buffer_size\u53d8\u91cf\u63a7\u5236\u8fd9\u4e00\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u3002\n# \u5982\u679c\u5bf9\u8868\u7684\u987a\u5e8f\u626b\u63cf\u8bf7\u6c42\u975e\u5e38\u9891\u7e41\uff0c\u5e76\u4e14\u4f60\u8ba4\u4e3a\u9891\u7e41\u626b\u63cf\u8fdb\u884c\u5f97\u592a\u6162\uff0c\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u8be5\u53d8\u91cf\u503c\u4ee5\u53ca\u5185\u5b58\u7f13\u51b2\u533a\u5927\u5c0f\u63d0\u9ad8\u5176\u6027\u80fd\n\nread_rnd_buffer_size = 8M\n# MySQL\u7684\u968f\u673a\u8bfb\u7f13\u51b2\u533a\u5927\u5c0f\u3002\u5f53\u6309\u4efb\u610f\u987a\u5e8f\u8bfb\u53d6\u884c\u65f6(\u4f8b\u5982\uff0c\u6309\u7167\u6392\u5e8f\u987a\u5e8f)\uff0c\u5c06\u5206\u914d\u4e00\u4e2a\u968f\u673a\u8bfb\u7f13\u5b58\u533a\u3002\u8fdb\u884c\u6392\u5e8f\u67e5\u8be2\u65f6\uff0c\n# MySQL\u4f1a\u9996\u5148\u626b\u63cf\u4e00\u904d\u8be5\u7f13\u51b2\uff0c\u4ee5\u907f\u514d\u78c1\u76d8\u641c\u7d22\uff0c\u63d0\u9ad8\u67e5\u8be2\u901f\u5ea6\uff0c\u5982\u679c\u9700\u8981\u6392\u5e8f\u5927\u91cf\u6570\u636e\uff0c\n# \u53ef\u9002\u5f53\u8c03\u9ad8\u8be5\u503c\u3002\u4f46MySQL\u4f1a\u4e3a\u6bcf\u4e2a\u5ba2\u6237\u8fde\u63a5\u53d1\u653e\u8be5\u7f13\u51b2\u7a7a\u95f4\uff0c\u6240\u4ee5\u5e94\u5c3d\u91cf\u9002\u5f53\u8bbe\u7f6e\u8be5\u503c\uff0c\u4ee5\u907f\u514d\u5185\u5b58\u5f00\u9500\u8fc7\u5927\n\nsort_buffer_size = 8M\n# MySQL\u6267\u884c\u6392\u5e8f\u4f7f\u7528\u7684\u7f13\u51b2\u5927\u5c0f\u3002\u5982\u679c\u60f3\u8981\u589e\u52a0ORDER BY\u7684\u901f\u5ea6\uff0c\u9996\u5148\u770b\u662f\u5426\u53ef\u4ee5\u8ba9MySQL\u4f7f\u7528\u7d22\u5f15\u800c\u4e0d\u662f\u989d\u5916\u7684\u6392\u5e8f\u9636\u6bb5\u3002\n# \u5982\u679c\u4e0d\u80fd\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u589e\u52a0sort_buffer_size\u53d8\u91cf\u7684\u5927\u5c0f\n\njoin_buffer_size = 8M\n# \u8054\u5408\u67e5\u8be2\u64cd\u4f5c\u6240\u80fd\u4f7f\u7528\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u548csort_buffer_size\u4e00\u6837\uff0c\u8be5\u53c2\u6570\u5bf9\u5e94\u7684\u5206\u914d\u5185\u5b58\u4e5f\u662f\u6bcf\u8fde\u63a5\u72ec\u4eab\n\nthread_cache_size = 8\n# \u8fd9\u4e2a\u503c\uff08\u9ed8\u8ba48\uff09\u8868\u793a\u53ef\u4ee5\u91cd\u65b0\u5229\u7528\u4fdd\u5b58\u5728\u7f13\u5b58\u4e2d\u7ebf\u7a0b\u7684\u6570\u91cf\uff0c\u5f53\u65ad\u5f00\u8fde\u63a5\u65f6\u5982\u679c\u7f13\u5b58\u4e2d\u8fd8\u6709\u7a7a\u95f4\uff0c\u90a3\u4e48\u5ba2\u6237\u7aef\u7684\u7ebf\u7a0b\u5c06\u88ab\u653e\u5230\u7f13\u5b58\u4e2d\uff0c\n# \u5982\u679c\u7ebf\u7a0b\u91cd\u65b0\u88ab\u8bf7\u6c42\uff0c\u90a3\u4e48\u8bf7\u6c42\u5c06\u4ece\u7f13\u5b58\u4e2d\u8bfb\u53d6,\u5982\u679c\u7f13\u5b58\u4e2d\u662f\u7a7a\u7684\u6216\u8005\u662f\u65b0\u7684\u8bf7\u6c42\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7ebf\u7a0b\u5c06\u88ab\u91cd\u65b0\u521b\u5efa,\u5982\u679c\u6709\u5f88\u591a\u65b0\u7684\u7ebf\u7a0b\uff0c\n# \u589e\u52a0\u8fd9\u4e2a\u503c\u53ef\u4ee5\u6539\u5584\u7cfb\u7edf\u6027\u80fd.\u901a\u8fc7\u6bd4\u8f83Connections\u548cThreads_created\u72b6\u6001\u7684\u53d8\u91cf\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u53d8\u91cf\u7684\u4f5c\u7528\u3002(\u2013&gt;\u8868\u793a\u8981\u8c03\u6574\u7684\u503c)\n# \u6839\u636e\u7269\u7406\u5185\u5b58\u8bbe\u7f6e\u89c4\u5219\u5982\u4e0b\uff1a\n# 1G - &gt; 8\n# 2G - &gt; 16\n# 3G - &gt; 32\n# \u5927\u4e8e3G - &gt; 64\n\nquery_cache_size = 8M\n# MySQL\u7684\u67e5\u8be2\u7f13\u51b2\u5927\u5c0f\uff08\u4ece4.0.1\u5f00\u59cb\uff0cMySQL\u63d0\u4f9b\u4e86\u67e5\u8be2\u7f13\u51b2\u673a\u5236\uff09\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2\uff0cMySQL\u5c06SELECT\u8bed\u53e5\u548c\u67e5\u8be2\u7ed3\u679c\u5b58\u653e\u5728\u7f13\u51b2\u533a\u4e2d\uff0c\n# \u4eca\u540e\u5bf9\u4e8e\u540c\u6837\u7684SELECT\u8bed\u53e5\uff08\u533a\u5206\u5927\u5c0f\u5199\uff09\uff0c\u5c06\u76f4\u63a5\u4ece\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u7ed3\u679c\u3002\u6839\u636eMySQL\u7528\u6237\u624b\u518c\uff0c\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2\u6700\u591a\u53ef\u4ee5\u8fbe\u5230238%\u7684\u6548\u7387\u3002\n# \u901a\u8fc7\u68c0\u67e5\u72b6\u6001\u503c'Qcache_%'\uff0c\u53ef\u4ee5\u77e5\u9053query_cache_size\u8bbe\u7f6e\u662f\u5426\u5408\u7406\uff1a\u5982\u679cQcache_lowmem_prunes\u7684\u503c\u975e\u5e38\u5927\uff0c\u5219\u8868\u660e\u7ecf\u5e38\u51fa\u73b0\u7f13\u51b2\u4e0d\u591f\u7684\u60c5\u51b5\uff0c\n# \u5982\u679cQcache_hits\u7684\u503c\u4e5f\u975e\u5e38\u5927\uff0c\u5219\u8868\u660e\u67e5\u8be2\u7f13\u51b2\u4f7f\u7528\u975e\u5e38\u9891\u7e41\uff0c\u6b64\u65f6\u9700\u8981\u589e\u52a0\u7f13\u51b2\u5927\u5c0f\uff1b\u5982\u679cQcache_hits\u7684\u503c\u4e0d\u5927\uff0c\u5219\u8868\u660e\u4f60\u7684\u67e5\u8be2\u91cd\u590d\u7387\u5f88\u4f4e\uff0c\n# \u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2\u53cd\u800c\u4f1a\u5f71\u54cd\u6548\u7387\uff0c\u90a3\u4e48\u53ef\u4ee5\u8003\u8651\u4e0d\u7528\u67e5\u8be2\u7f13\u51b2\u3002\u6b64\u5916\uff0c\u5728SELECT\u8bed\u53e5\u4e2d\u52a0\u5165SQL_NO_CACHE\u53ef\u4ee5\u660e\u786e\u8868\u793a\u4e0d\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2\n\nquery_cache_limit = 2M\n#\u6307\u5b9a\u5355\u4e2a\u67e5\u8be2\u80fd\u591f\u4f7f\u7528\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u9ed8\u8ba41M\n\nkey_buffer_size = 4M\n# \u6307\u5b9a\u7528\u4e8e\u7d22\u5f15\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u589e\u52a0\u5b83\u53ef\u5f97\u5230\u66f4\u597d\u5904\u7406\u7684\u7d22\u5f15(\u5bf9\u6240\u6709\u8bfb\u548c\u591a\u91cd\u5199)\uff0c\u5230\u4f60\u80fd\u8d1f\u62c5\u5f97\u8d77\u90a3\u6837\u591a\u3002\u5982\u679c\u4f60\u4f7f\u5b83\u592a\u5927\uff0c\n# \u7cfb\u7edf\u5c06\u5f00\u59cb\u6362\u9875\u5e76\u4e14\u771f\u7684\u53d8\u6162\u4e86\u3002\u5bf9\u4e8e\u5185\u5b58\u57284GB\u5de6\u53f3\u7684\u670d\u52a1\u5668\u8be5\u53c2\u6570\u53ef\u8bbe\u7f6e\u4e3a384M\u6216512M\u3002\u901a\u8fc7\u68c0\u67e5\u72b6\u6001\u503cKey_read_requests\u548cKey_reads\uff0c\n# \u53ef\u4ee5\u77e5\u9053key_buffer_size\u8bbe\u7f6e\u662f\u5426\u5408\u7406\u3002\u6bd4\u4f8bkey_reads/key_read_requests\u5e94\u8be5\u5c3d\u53ef\u80fd\u7684\u4f4e\uff0c\n# \u81f3\u5c11\u662f1:100\uff0c1:1000\u66f4\u597d(\u4e0a\u8ff0\u72b6\u6001\u503c\u53ef\u4ee5\u4f7f\u7528SHOW STATUS LIKE 'key_read%'\u83b7\u5f97)\u3002\u6ce8\u610f\uff1a\u8be5\u53c2\u6570\u503c\u8bbe\u7f6e\u7684\u8fc7\u5927\u53cd\u800c\u4f1a\u662f\u670d\u52a1\u5668\u6574\u4f53\u6548\u7387\u964d\u4f4e\n\nft_min_word_len = 4\n# \u5206\u8bcd\u8bcd\u6c47\u6700\u5c0f\u957f\u5ea6\uff0c\u9ed8\u8ba44\n\ntransaction_isolation = REPEATABLE-READ\n# MySQL\u652f\u63014\u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff0c\u4ed6\u4eec\u5206\u522b\u662f\uff1a\n# READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE.\n# \u5982\u6ca1\u6709\u6307\u5b9a\uff0cMySQL\u9ed8\u8ba4\u91c7\u7528\u7684\u662fREPEATABLE-READ\uff0cORACLE\u9ed8\u8ba4\u7684\u662fREAD-COMMITTED\n\nlog_bin = mysql-bin\nbinlog_format = mixed\nexpire_logs_days = 30 #\u8d85\u8fc730\u5929\u7684binlog\u5220\u9664\nlog_error = /data/mysql/mysql-error.log #\u9519\u8bef\u65e5\u5fd7\u8def\u5f84\nslow_query_log = 1\nlong_query_time = 1 #\u6162\u67e5\u8be2\u65f6\u95f4 \u8d85\u8fc71\u79d2\u5219\u4e3a\u6162\u67e5\u8be2\nslow_query_log_file = /data/mysql/mysql-slow.log\nperformance_schema = 0\nexplicit_defaults_for_timestamp\n#lower_case_table_names = 1 #\u4e0d\u533a\u5206\u5927\u5c0f\u5199\nskip-external-locking #MySQL\u9009\u9879\u4ee5\u907f\u514d\u5916\u90e8\u9501\u5b9a\u3002\u8be5\u9009\u9879\u9ed8\u8ba4\u5f00\u542f\ndefault-storage-engine = InnoDB #\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\n\ninnodb_file_per_table = 1\n# InnoDB\u4e3a\u72ec\u7acb\u8868\u7a7a\u95f4\u6a21\u5f0f\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u7684\u6bcf\u4e2a\u8868\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a\u6570\u636e\u7a7a\u95f4\n# \u72ec\u7acb\u8868\u7a7a\u95f4\u4f18\u70b9\uff1a\n# 1\uff0e\u6bcf\u4e2a\u8868\u90fd\u6709\u81ea\u5df2\u72ec\u7acb\u7684\u8868\u7a7a\u95f4\u3002\n# 2\uff0e\u6bcf\u4e2a\u8868\u7684\u6570\u636e\u548c\u7d22\u5f15\u90fd\u4f1a\u5b58\u5728\u81ea\u5df2\u7684\u8868\u7a7a\u95f4\u4e2d\u3002\n# 3\uff0e\u53ef\u4ee5\u5b9e\u73b0\u5355\u8868\u5728\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e2d\u79fb\u52a8\u3002\n# 4\uff0e\u7a7a\u95f4\u53ef\u4ee5\u56de\u6536\uff08\u9664drop table\u64cd\u4f5c\u5904\uff0c\u8868\u7a7a\u4e0d\u80fd\u81ea\u5df2\u56de\u6536\uff09\n# \u7f3a\u70b9\uff1a\n# \u5355\u8868\u589e\u52a0\u8fc7\u5927\uff0c\u5982\u8d85\u8fc7100G\n# \u7ed3\u8bba\uff1a\n# \u5171\u4eab\u8868\u7a7a\u95f4\u5728Insert\u64cd\u4f5c\u4e0a\u5c11\u6709\u4f18\u52bf\u3002\u5176\u5b83\u90fd\u6ca1\u72ec\u7acb\u8868\u7a7a\u95f4\u8868\u73b0\u597d\u3002\u5f53\u542f\u7528\u72ec\u7acb\u8868\u7a7a\u95f4\u65f6\uff0c\u8bf7\u5408\u7406\u8c03\u6574\uff1ainnodb_open_files\n\ninnodb_open_files = 500\n# \u9650\u5236Innodb\u80fd\u6253\u5f00\u7684\u8868\u7684\u6570\u636e\uff0c\u5982\u679c\u5e93\u91cc\u7684\u8868\u7279\u522b\u591a\u7684\u60c5\u51b5\uff0c\u8bf7\u589e\u52a0\u8fd9\u4e2a\u3002\u8fd9\u4e2a\u503c\u9ed8\u8ba4\u662f300\n\ninnodb_buffer_pool_size = 64M\n# InnoDB\u4f7f\u7528\u4e00\u4e2a\u7f13\u51b2\u6c60\u6765\u4fdd\u5b58\u7d22\u5f15\u548c\u539f\u59cb\u6570\u636e, \u4e0d\u50cfMyISAM.\n# \u8fd9\u91cc\u4f60\u8bbe\u7f6e\u8d8a\u5927,\u4f60\u5728\u5b58\u53d6\u8868\u91cc\u9762\u6570\u636e\u65f6\u6240\u9700\u8981\u7684\u78c1\u76d8I/O\u8d8a\u5c11.\n# \u5728\u4e00\u4e2a\u72ec\u7acb\u4f7f\u7528\u7684\u6570\u636e\u5e93\u670d\u52a1\u5668\u4e0a,\u4f60\u53ef\u4ee5\u8bbe\u7f6e\u8fd9\u4e2a\u53d8\u91cf\u5230\u670d\u52a1\u5668\u7269\u7406\u5185\u5b58\u5927\u5c0f\u768480%\n# \u4e0d\u8981\u8bbe\u7f6e\u8fc7\u5927,\u5426\u5219,\u7531\u4e8e\u7269\u7406\u5185\u5b58\u7684\u7ade\u4e89\u53ef\u80fd\u5bfc\u81f4\u64cd\u4f5c\u7cfb\u7edf\u7684\u6362\u9875\u98a0\u7c38.\n# \u6ce8\u610f\u572832\u4f4d\u7cfb\u7edf\u4e0a\u4f60\u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u80fd\u88ab\u9650\u5236\u5728 2-3.5G \u7528\u6237\u5c42\u9762\u5185\u5b58\u9650\u5236,\n# \u6240\u4ee5\u4e0d\u8981\u8bbe\u7f6e\u7684\u592a\u9ad8.\n\ninnodb_write_io_threads = 4\ninnodb_read_io_threads = 4\n# innodb\u4f7f\u7528\u540e\u53f0\u7ebf\u7a0b\u5904\u7406\u6570\u636e\u9875\u4e0a\u7684\u8bfb\u5199 I/O(\u8f93\u5165\u8f93\u51fa)\u8bf7\u6c42,\u6839\u636e\u4f60\u7684 CPU \u6838\u6570\u6765\u66f4\u6539,\u9ed8\u8ba4\u662f4\n# \u6ce8:\u8fd9\u4e24\u4e2a\u53c2\u6570\u4e0d\u652f\u6301\u52a8\u6001\u6539\u53d8,\u9700\u8981\u628a\u8be5\u53c2\u6570\u52a0\u5165\u5230my.cnf\u91cc\uff0c\u4fee\u6539\u5b8c\u540e\u91cd\u542fMySQL\u670d\u52a1,\u5141\u8bb8\u503c\u7684\u8303\u56f4\u4ece 1-64\n\ninnodb_thread_concurrency = 0\n# \u9ed8\u8ba4\u8bbe\u7f6e\u4e3a 0,\u8868\u793a\u4e0d\u9650\u5236\u5e76\u53d1\u6570\uff0c\u8fd9\u91cc\u63a8\u8350\u8bbe\u7f6e\u4e3a0\uff0c\u66f4\u597d\u53bb\u53d1\u6325CPU\u591a\u6838\u5904\u7406\u80fd\u529b\uff0c\u63d0\u9ad8\u5e76\u53d1\u91cf\n\ninnodb_purge_threads = 1\n# InnoDB\u4e2d\u7684\u6e05\u9664\u64cd\u4f5c\u662f\u4e00\u7c7b\u5b9a\u671f\u56de\u6536\u65e0\u7528\u6570\u636e\u7684\u64cd\u4f5c\u3002\u5728\u4e4b\u524d\u7684\u51e0\u4e2a\u7248\u672c\u4e2d\uff0c\n# \u6e05\u9664\u64cd\u4f5c\u662f\u4e3b\u7ebf\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u610f\u5473\u7740\u8fd0\u884c\u65f6\u5b83\u53ef\u80fd\u4f1a\u5835\u585e\u5176\u5b83\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u3002\n# \u4eceMySQL5.5.X\u7248\u672c\u5f00\u59cb\uff0c\u8be5\u64cd\u4f5c\u8fd0\u884c\u4e8e\u72ec\u7acb\u7684\u7ebf\u7a0b\u4e2d,\u5e76\u652f\u6301\u66f4\u591a\u7684\u5e76\u53d1\u6570\u3002\u7528\u6237\u53ef\u901a\u8fc7\u8bbe\u7f6einnodb_purge_threads\u914d\u7f6e\u53c2\u6570\u6765\u9009\u62e9\u6e05\u9664\u64cd\u4f5c\u662f\u5426\u4f7f\u7528\u5355\n# \u72ec\u7ebf\u7a0b,\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53c2\u6570\u8bbe\u7f6e\u4e3a0(\u4e0d\u4f7f\u7528\u5355\u72ec\u7ebf\u7a0b),\u8bbe\u7f6e\u4e3a 1 \u65f6\u8868\u793a\u4f7f\u7528\u5355\u72ec\u7684\u6e05\u9664\u7ebf\u7a0b\u3002\u5efa\u8bae\u4e3a1\n\ninnodb_flush_log_at_trx_commit = 2\n# 0\uff1a\u5982\u679cinnodb_flush_log_at_trx_commit\u7684\u503c\u4e3a0,\n#    log buffer\u6bcf\u79d2\u5c31\u4f1a\u88ab\u5237\u5199\u65e5\u5fd7\u6587\u4ef6\u5230\u78c1\u76d8\uff0c\u63d0\u4ea4\u4e8b\u52a1\u7684\u65f6\u5019\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c\uff08\u6267\u884c\u662f\u7531mysql\u7684master thread\u7ebf\u7a0b\u6765\u6267\u884c\u7684\u3002\n#    \u4e3b\u7ebf\u7a0b\u4e2d\u6bcf\u79d2\u4f1a\u5c06\u91cd\u505a\u65e5\u5fd7\u7f13\u51b2\u5199\u5165\u78c1\u76d8\u7684\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6(REDO LOG)\u4e2d\u3002\u4e0d\u8bba\u4e8b\u52a1\u662f\u5426\u5df2\u7ecf\u63d0\u4ea4\uff09\u9ed8\u8ba4\u7684\u65e5\u5fd7\u6587\u4ef6\u662fib_logfile0,ib_logfile1\n# 1\uff1a\u5f53\u8bbe\u4e3a\u9ed8\u8ba4\u503c1\u7684\u65f6\u5019\uff0c\u6bcf\u6b21\u63d0\u4ea4\u4e8b\u52a1\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u5c06log buffer\u5237\u5199\u5230\u65e5\u5fd7\u3002\n# 2\uff1a\u5982\u679c\u8bbe\u4e3a2,\u6bcf\u6b21\u63d0\u4ea4\u4e8b\u52a1\u90fd\u4f1a\u5199\u65e5\u5fd7\uff0c\u4f46\u5e76\u4e0d\u4f1a\u6267\u884c\u5237\u7684\u64cd\u4f5c\u3002\u6bcf\u79d2\u5b9a\u65f6\u4f1a\u5237\u5230\u65e5\u5fd7\u6587\u4ef6\u3002\n#    \u8981\u6ce8\u610f\u7684\u662f\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1100%\u6bcf\u79d2\u4e00\u5b9a\u90fd\u4f1a\u5237\u5230\u78c1\u76d8\uff0c\u8fd9\u8981\u53d6\u51b3\u4e8e\u8fdb\u7a0b\u7684\u8c03\u5ea6\u3002\n#    \u6bcf\u6b21\u4e8b\u52a1\u63d0\u4ea4\u7684\u65f6\u5019\u5c06\u6570\u636e\u5199\u5165\u4e8b\u52a1\u65e5\u5fd7\uff0c\u800c\u8fd9\u91cc\u7684\u5199\u5165\u4ec5\u662f\u8c03\u7528\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u5199\u5165\u64cd\u4f5c\uff0c\n#    \u800c\u6587\u4ef6\u7cfb\u7edf\u662f\u6709 \u7f13\u5b58\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u5199\u5165\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u6570\u636e\u5df2\u7ecf\u5199\u5165\u5230\u7269\u7406\u78c1\u76d8\n# \u9ed8\u8ba4\u503c1\u662f\u4e3a\u4e86\u4fdd\u8bc1\u5b8c\u6574\u7684ACID\u3002\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u914d\u7f6e\u9879\u8bbe\u4e3a1\u4ee5\u5916\u7684\u503c\u6765\u6362\u53d6\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u4f46\u662f\u5728\u7cfb\u7edf\u5d29\u6e83\u7684\u65f6\u5019\uff0c\u4f60\u5c06\u4f1a\u4e22\u59311\u79d2\u7684\u6570\u636e\u3002\n# \u8bbe\u4e3a0\u7684\u8bdd\uff0cmysqld\u8fdb\u7a0b\u5d29\u6e83\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u4e22\u5931\u6700\u540e1\u79d2\u7684\u4e8b\u52a1\u3002\n# \u8bbe\u4e3a2,\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u5d29\u6e83\u6216\u8005\u65ad\u7535\u7684\u65f6\u5019\u624d\u4f1a\u4e22\u5931\u6700\u540e1\u79d2\u7684\u6570\u636e\u3002InnoDB\u5728\u505a\u6062\u590d\u7684\u65f6\u5019\u4f1a\u5ffd\u7565\u8fd9\u4e2a\u503c\u3002\n### \u603b\u7ed3 ###\n# \u8bbe\u4e3a1\u5f53\u7136\u662f\u6700\u5b89\u5168\u7684\uff0c\u4f46\u6027\u80fd\u9875\u662f\u6700\u5dee\u7684\uff08\u76f8\u5bf9\u5176\u4ed6\u4e24\u4e2a\u53c2\u6570\u800c\u8a00\uff0c\u4f46\u4e0d\u662f\u4e0d\u80fd\u63a5\u53d7\uff09\u3002\n# \u5982\u679c\u5bf9\u6570\u636e\u4e00\u81f4\u6027\u548c\u5b8c\u6574\u6027\u8981\u6c42\u4e0d\u9ad8\uff0c\u5b8c\u5168\u53ef\u4ee5\u8bbe\u4e3a2\uff0c\u5982\u679c\u53ea\u6700\u6c42\u6027\u80fd\uff0c\u4f8b\u5982\u9ad8\u5e76\u53d1\u5199\u7684\u65e5\u5fd7\u670d\u52a1\u5668\uff0c\u8bbe\u4e3a0\u6765\u83b7\u5f97\u66f4\u9ad8\u6027\u80fd\n\ninnodb_log_buffer_size = 2M\n# \u6b64\u53c2\u6570\u786e\u5b9a\u4e9b\u65e5\u5fd7\u6587\u4ef6\u6240\u7528\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u7f13\u51b2\u533a\u66f4\u5927\u80fd\u63d0\u9ad8\u6027\u80fd\uff0c\u4f46\u610f\u5916\u7684\u6545\u969c\u5c06\u4f1a\u4e22\u5931\u6570\u636e\u3002MySQL\u5f00\u53d1\u4eba\u5458\u5efa\u8bae\u8bbe\u7f6e\u4e3a1\uff0d8M\u4e4b\u95f4\n\ninnodb_log_file_size = 32M\n# \u6b64\u53c2\u6570\u786e\u5b9a\u6570\u636e\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u66f4\u5927\u7684\u8bbe\u7f6e\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\uff0c\u4f46\u4e5f\u4f1a\u589e\u52a0\u6062\u590d\u6545\u969c\u6570\u636e\u5e93\u6240\u9700\u7684\u65f6\u95f4\n\ninnodb_log_files_in_group = 3\n# \u4e3a\u63d0\u9ad8\u6027\u80fd\uff0cMySQL\u53ef\u4ee5\u4ee5\u5faa\u73af\u65b9\u5f0f\u5c06\u65e5\u5fd7\u6587\u4ef6\u5199\u5230\u591a\u4e2a\u6587\u4ef6\u3002\u63a8\u8350\u8bbe\u7f6e\u4e3a3\n\ninnodb_max_dirty_pages_pct = 90\n# innodb\u4e3b\u7ebf\u7a0b\u5237\u65b0\u7f13\u5b58\u6c60\u4e2d\u7684\u6570\u636e\uff0c\u4f7f\u810f\u6570\u636e\u6bd4\u4f8b\u5c0f\u4e8e90%\n\ninnodb_lock_wait_timeout = 120 \n# InnoDB\u4e8b\u52a1\u5728\u88ab\u56de\u6eda\u4e4b\u524d\u53ef\u4ee5\u7b49\u5f85\u4e00\u4e2a\u9501\u5b9a\u7684\u8d85\u65f6\u79d2\u6570\u3002\n# InnoDB\u5728\u5b83\u81ea\u5df1\u7684\u9501\u5b9a\u8868\u4e2d\u81ea\u52a8\u68c0\u6d4b\u4e8b\u52a1\u6b7b\u9501\u5e76\u4e14\u56de\u6eda\u4e8b\u52a1\u3002InnoDB\u7528LOCK TABLES\u8bed\u53e5\u6ce8\u610f\u5230\u9501\u5b9a\u8bbe\u7f6e\u3002\u9ed8\u8ba4\u503c\u662f50\u79d2\n\nbulk_insert_buffer_size = 8M\n# \u6279\u91cf\u63d2\u5165\u7f13\u5b58\u5927\u5c0f\uff0c \u8fd9\u4e2a\u53c2\u6570\u662f\u9488\u5bf9MyISAM\u5b58\u50a8\u5f15\u64ce\u6765\u8bf4\u7684\u3002\n# \u9002\u7528\u4e8e\u5728\u4e00\u6b21\u6027\u63d2\u5165100-1000+\u6761\u8bb0\u5f55\u65f6\uff0c \u63d0\u9ad8\u6548\u7387\u3002\u9ed8\u8ba4\u503c\u662f8M\u3002\u53ef\u4ee5\u9488\u5bf9\u6570\u636e\u91cf\u7684\u5927\u5c0f\uff0c\u7ffb\u500d\u589e\u52a0\u3002\n\nmyisam_sort_buffer_size = 8M\n# MyISAM\u8bbe\u7f6e\u6062\u590d\u8868\u4e4b\u65f6\u4f7f\u7528\u7684\u7f13\u51b2\u533a\u7684\u5c3a\u5bf8\uff0c\u5f53\u5728REPAIR TABLE\u6216\u7528CREATE INDEX\u521b\u5efa\u7d22\u5f15\u6216ALTER TABLE\u8fc7\u7a0b\u4e2d\u6392\u5e8f MyISAM\u7d22\u5f15\u5206\u914d\u7684\u7f13\u51b2\u533a\n\nmyisam_max_sort_file_size = 10G\n# \u5982\u679c\u4e34\u65f6\u6587\u4ef6\u4f1a\u53d8\u5f97\u8d85\u8fc7\u7d22\u5f15\uff0c\u4e0d\u8981\u4f7f\u7528\u5feb\u901f\u6392\u5e8f\u7d22\u5f15\u65b9\u6cd5\u6765\u521b\u5efa\u4e00\u4e2a\u7d22\u5f15\u3002\u6ce8\u91ca\uff1a\u8fd9\u4e2a\u53c2\u6570\u4ee5\u5b57\u8282\u7684\u5f62\u5f0f\u7ed9\u51fa\n\nmyisam_repair_threads = 1\n# \u5982\u679c\u8be5\u503c\u5927\u4e8e1\uff0c\u5728Repair by sorting\u8fc7\u7a0b\u4e2d\u5e76\u884c\u521b\u5efaMyISAM\u8868\u7d22\u5f15(\u6bcf\u4e2a\u7d22\u5f15\u5728\u81ea\u5df1\u7684\u7ebf\u7a0b\u5185) \n\ninteractive_timeout = 28800\n# \u670d\u52a1\u5668\u5173\u95ed\u4ea4\u4e92\u5f0f\u8fde\u63a5\u524d\u7b49\u5f85\u6d3b\u52a8\u7684\u79d2\u6570\u3002\u4ea4\u4e92\u5f0f\u5ba2\u6237\u7aef\u5b9a\u4e49\u4e3a\u5728\n# mysql_real_connect()\u4e2d\u4f7f\u7528CLIENT_INTERACTIVE\u9009\u9879\u7684\u5ba2\u6237\u7aef\u3002\u9ed8\u8ba4\u503c\uff1a28800\u79d2\uff088\u5c0f\u65f6\uff09\n\nwait_timeout = 28800\n# \u670d\u52a1\u5668\u5173\u95ed\u975e\u4ea4\u4e92\u8fde\u63a5\u4e4b\u524d\u7b49\u5f85\u6d3b\u52a8\u7684\u79d2\u6570\u3002\u5728\u7ebf\u7a0b\u542f\u52a8\u65f6\uff0c\u6839\u636e\u5168\u5c40wait_timeout\u503c\u6216\u5168\u5c40interactive_timeout\u503c\u521d\u59cb\u5316\u4f1a\u8bddwait_timeout\u503c\uff0c\n# \u53d6\u51b3\u4e8e\u5ba2\u6237\u7aef\u7c7b\u578b(\u7531mysql_real_connect()\u7684\u8fde\u63a5\u9009\u9879CLIENT_INTERACTIVE\u5b9a\u4e49)\u3002\u53c2\u6570\u9ed8\u8ba4\u503c\uff1a28800\u79d2\uff088\u5c0f\u65f6\uff09\n# MySQL\u670d\u52a1\u5668\u6240\u652f\u6301\u7684\u6700\u5927\u8fde\u63a5\u6570\u662f\u6709\u4e0a\u9650\u7684\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u7684\u5efa\u7acb\u90fd\u4f1a\u6d88\u8017\u5185\u5b58\uff0c\u56e0\u6b64\u6211\u4eec\u5e0c\u671b\u5ba2\u6237\u7aef\u5728\u8fde\u63a5\u5230MySQL Server\u5904\u7406\u5b8c\u76f8\u5e94\u7684\u64cd\u4f5c\u540e\uff0c\n# \u5e94\u8be5\u65ad\u5f00\u8fde\u63a5\u5e76\u91ca\u653e\u5360\u7528\u7684\u5185\u5b58\u3002\u5982\u679c\u4f60\u7684MySQL Server\u6709\u5927\u91cf\u7684\u95f2\u7f6e\u8fde\u63a5\uff0c\u4ed6\u4eec\u4e0d\u4ec5\u4f1a\u767d\u767d\u6d88\u8017\u5185\u5b58\uff0c\u800c\u4e14\u5982\u679c\u8fde\u63a5\u4e00\u76f4\u5728\u7d2f\u52a0\u800c\u4e0d\u65ad\u5f00\uff0c\n# \u6700\u7ec8\u80af\u5b9a\u4f1a\u8fbe\u5230MySQL Server\u7684\u8fde\u63a5\u4e0a\u9650\u6570\uff0c\u8fd9\u4f1a\u62a5'too many connections'\u7684\u9519\u8bef\u3002\u5bf9\u4e8ewait_timeout\u7684\u503c\u8bbe\u5b9a\uff0c\u5e94\u8be5\u6839\u636e\u7cfb\u7edf\u7684\u8fd0\u884c\u60c5\u51b5\u6765\u5224\u65ad\u3002\n# \u5728\u7cfb\u7edf\u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7show processlist\u547d\u4ee4\u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u7684\u8fde\u63a5\u72b6\u6001\uff0c\u5982\u679c\u53d1\u73b0\u6709\u5927\u91cf\u7684sleep\u72b6\u6001\u7684\u8fde\u63a5\u8fdb\u7a0b\uff0c\u5219\u8bf4\u660e\u8be5\u53c2\u6570\u8bbe\u7f6e\u7684\u8fc7\u5927\uff0c\n# \u53ef\u4ee5\u8fdb\u884c\u9002\u5f53\u7684\u8c03\u6574\u5c0f\u4e9b\u3002\u8981\u540c\u65f6\u8bbe\u7f6einteractive_timeout\u548cwait_timeout\u624d\u4f1a\u751f\u6548\u3002\n[mysqldump]\nquick\nmax_allowed_packet = 16M #\u670d\u52a1\u5668\u53d1\u9001\u548c\u63a5\u53d7\u7684\u6700\u5927\u5305\u957f\u5ea6\n[myisamchk]\nkey_buffer_size = 8M\nsort_buffer_size = 8M\nread_buffer = 4M\nwrite_buffer = 4M\n</code></pre>"},{"location":"mysql/#innodb_flush_log_at_trx_commit","title":"innodb_flush_log_at_trx_commit","text":""},{"location":"mysql/#innodb_buffer_pool_size","title":"innodb_buffer_pool_size","text":"<p>\u5982 \u679c\u7528Innodb\uff0c\u90a3\u4e48\u8fd9\u662f\u4e00\u4e2a\u91cd\u8981\u53d8\u91cf\u3002\u76f8\u5bf9\u4e8eMyISAM\u6765\u8bf4\uff0cInnodb\u5bf9\u4e8ebuffer size\u66f4\u654f\u611f\u3002MySIAM\u53ef\u80fd\u5bf9\u4e8e\u5927\u6570\u636e\u91cf\u4f7f\u7528\u9ed8\u8ba4\u7684key_buffer_size\u4e5f\u8fd8\u597d\uff0c\u4f46Innodb\u5728\u5927\u6570\u636e\u91cf\u65f6\u7528\u9ed8\u8ba4\u503c\u5c31\u611f\u89c9\u5728\u722c\u4e86\u3002 Innodb\u7684\u7f13\u51b2\u6c60\u4f1a\u7f13\u5b58\u6570\u636e\u548c\u7d22\u5f15\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u7ed9\u7cfb\u7edf\u7684\u7f13\u5b58\u7559\u7a7a\u95f4\uff0c\u5982\u679c\u53ea\u7528Innodb\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e2a\u503c\u8bbe\u4e3a\u5185\u5b58\u768470%-80%\u3002\u548c key_buffer\u76f8\u540c\uff0c\u5982\u679c\u6570\u636e\u91cf\u6bd4\u8f83\u5c0f\u4e5f\u4e0d\u600e\u4e48\u589e\u52a0\uff0c\u90a3\u4e48\u4e0d\u8981\u628a\u8fd9\u4e2a\u503c\u8bbe\u592a\u9ad8\u4e5f\u53ef\u4ee5\u63d0\u9ad8\u5185\u5b58\u7684\u4f7f\u7528\u7387\u3002</p>"},{"location":"mysql/#innodb_additional_pool_size","title":"innodb_additional_pool_size","text":"<p>\u8fd9\u4e2a\u7684\u6548\u679c\u4e0d\u662f\u5f88\u660e\u663e\uff0c\u81f3\u5c11\u662f\u5f53\u64cd\u4f5c\u7cfb\u7edf\u80fd\u5408\u7406\u5206\u914d\u5185\u5b58\u65f6\u3002\u4f46\u4f60\u53ef\u80fd\u4ecd\u9700\u8981\u8bbe\u621020M\u6216\u66f4\u591a\u4e00\u70b9\u4ee5\u770bInnodb\u4f1a\u5206\u914d\u591a\u5c11\u5185\u5b58\u505a\u5176\u4ed6\u7528\u9014\u3002</p>"},{"location":"mysql/#innodb_log_file_size","title":"innodb_log_file_size","text":"<p>\u5bf9\u4e8e\u5199\u5f88\u591a\u5c24\u5176\u662f\u5927\u6570\u636e\u91cf\u65f6\u975e\u5e38\u91cd\u8981\u3002\u8981\u6ce8\u610f\uff0c\u5927\u7684\u6587\u4ef6\u63d0\u4f9b\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u4f46\u6570\u636e\u5e93\u6062\u590d\u65f6\u4f1a\u7528\u66f4\u591a\u7684\u65f6\u95f4\u3002\u6211\u4e00\u822c\u752864M-512M\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u670d\u52a1\u5668\u7684\u7a7a\u95f4\u3002</p>"},{"location":"mysql/#innodb_log_buffer_size","title":"innodb_log_buffer_size","text":"<p>\u9ed8\u8ba4\u503c\u5bf9\u4e8e\u591a\u6570\u4e2d\u7b49\u5199\u64cd\u4f5c\u548c\u4e8b\u52a1\u77ed\u7684\u8fd0\u7528\u90fd\u662f\u53ef\u4ee5\u7684\u3002\u5982 \u679c\u7ecf\u5e38\u505a\u66f4\u65b0\u6216\u8005\u4f7f\u7528\u4e86\u5f88\u591ablob\u6570\u636e\uff0c\u5e94\u8be5\u589e\u5927\u8fd9\u4e2a\u503c\u3002\u4f46\u592a\u5927\u4e86\u4e5f\u662f\u6d6a\u8d39\u5185\u5b58\uff0c\u56e0\u4e3a1\u79d2\u949f\u603b\u4f1a flush\uff08\u8fd9\u4e2a\u8bcd\u7684\u4e2d\u6587\u600e\u4e48\u8bf4\u5462\uff1f\uff09\u4e00\u6b21\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u8bbe\u5230\u8d85\u8fc71\u79d2\u7684\u9700\u6c42\u30028M-16M\u4e00\u822c\u5e94\u8be5\u591f\u4e86\u3002\u5c0f\u7684\u8fd0\u7528\u53ef\u4ee5\u8bbe\u66f4\u5c0f\u4e00\u70b9\u3002</p>"},{"location":"mysql/#innodb_flush_log_at_trx_commit_1","title":"innodb_flush_log_at_trx_commit  \uff08\u8fd9\u4e2a\u5f88\u7ba1\u7528\uff09","text":"<p>\u62b1\u6028Innodb\u6bd4MyISAM\u6162 100\u500d\uff1f\u90a3\u4e48\u4f60\u5927\u6982\u662f\u5fd8\u4e86\u8c03\u6574\u8fd9\u4e2a\u503c\u3002\u9ed8\u8ba4\u503c1\u7684\u610f\u601d\u662f\u6bcf\u4e00\u6b21\u4e8b\u52a1\u63d0\u4ea4\u6216\u4e8b\u52a1\u5916\u7684\u6307\u4ee4\u90fd\u9700\u8981\u628a\u65e5\u5fd7\u5199\u5165\uff08flush\uff09\u786c\u76d8\uff0c\u8fd9\u662f\u5f88\u8d39\u65f6\u7684\u3002\u7279\u522b\u662f\u4f7f\u7528\u7535 \u6c60\u4f9b\u7535\u7f13\u5b58\uff08Battery backed up cache\uff09\u65f6\u3002\u8bbe\u62102\u5bf9\u4e8e\u5f88\u591a\u8fd0\u7528\uff0c\u7279\u522b\u662f\u4eceMyISAM\u8868\u8f6c\u8fc7\u6765\u7684\u662f\u53ef\u4ee5\u7684\uff0c\u5b83\u7684\u610f\u601d\u662f\u4e0d\u5199\u5165\u786c\u76d8\u800c\u662f\u5199\u5165\u7cfb\u7edf\u7f13\u5b58\u3002\u65e5\u5fd7\u4ecd\u7136\u4f1a\u6bcf\u79d2flush\u5230\u786c \u76d8\uff0c\u6240\u4ee5\u4f60\u4e00\u822c\u4e0d\u4f1a\u4e22\u5931\u8d85\u8fc71-2\u79d2\u7684\u66f4\u65b0\u3002\u8bbe\u62100\u4f1a\u66f4\u5feb\u4e00\u70b9\uff0c\u4f46\u5b89\u5168\u65b9\u9762\u6bd4\u8f83\u5dee\uff0c\u5373\u4f7fMySQL\u6302\u4e86\u4e5f\u53ef\u80fd\u4f1a\u4e22\u5931\u4e8b\u52a1\u7684\u6570\u636e\u3002\u800c\u503c2\u53ea\u4f1a\u5728\u6574\u4e2a\u64cd\u4f5c\u7cfb\u7edf \u6302\u4e86\u65f6\u624d\u53ef\u80fd\u4e22\u6570\u636e\u3002 </p>"},{"location":"mysql/#innodb_flush_log_at_trx_commit_2","title":"innodb_flush_log_at_trx_commit","text":"<pre><code>If the value of innodb_flush_log_at_trx_commit is 0, the log buffer is written out to the log file once per second and the flush to disk operation is performed on the log file, but nothing is done at a transaction commit. When the value is 1, the log buffer is written out to the log file at each transaction commit and the flush to disk operation is performed on the log file. When the value is 2, the log buffer is written out to the file at each commit, but the flush to disk operation is not performed on it. However, the flushing on the log file takes place once per second also when the value is 2. Note that the once-per-second flushing is not 100% guaranteed to happen every second, due to process scheduling issues.\n\nThe default value of this variable is 1 (prior to MySQL 4.0.13, the default is 0).\n\nA value of 1 is required for ACID compliance. You can achieve better performance by setting the value different from 1, but then you can lose at most one second worth of transactions in a crash. With a value of 0, any mysqldprocess crash can erase the last second of transactions. With a value of 2, then only an operating system crash or a power outage can erase the last second of transactions. However, InnoDB's crash recovery is not affected and thus crash recovery does work regardless of the value.\nNote\n\nFor the greatest possible durability and consistency in a replication setup using InnoDB with transactions, use innodb_flush_log_at_trx_commit=1, sync_binlog=1, and innodb-safe-binlog in your master server my.cnf file.\nCaution\n\nMany operating systems and some disk hardware fool the flush-to-disk operation. They may tellmysqld that the flush has taken place, even though it has not. Then the durability of transactions is not guaranteed even with the setting 1, and in the worst case a power outage can even corrupt theInnoDB database. Using a battery-backed disk cache in the SCSI disk controller or in the disk itself speeds up file flushes, and makes the operation safer. You can also try using the Unix commandhdparm to disable the caching of disk writes in hardware caches, or use some other command specific to the hardware vendor.\n</code></pre>"},{"location":"mysql/#mycnf","title":"my.cnf \u6700\u7d42\u5f62\u614b","text":"<pre><code>[mysql]\ndefault-character-set=utf8\nsocket=/tmp/mysql.sock\n\n[mysqld]\nuser=mysql\ndatadir=/home/mysql\nsocket=/tmp/mysql.sock\ntmpdir=/home/tmp\nslow_query_log=1\n# slow query \u6a5f\u80fd\u3092ON\u306b\u3059\u308b\nlong_query_time=10\n# slow query \u6642\u9593\u309210\u79d2\u306b\u8a2d\u5b9a\nslow_query_log_file=/var/log/mysql/slow_query.log\nlog-error=/var/log/mysql/error.log\nlog_output=FILE\n# log\u5f62\u5f0f\u3092file\u5f0f\u306b\u8a2d\u5b9a\n\n#myisam\nmyisam_sort_buffer_size=128M\n# MyISAM\u3067\u4ee5\u4e0b\u306e\u6642\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30bd\u30fc\u30c8\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 \n# REPAIR TABLE\u3001CREATE INDEX\u3001ALTER INDEX\u3002\u901a\u5e38\u306e\u30af\u30a8\u30ea(DML)\u3067\u306f\u4f7f\u308f\u308c\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3001\u305d\u308c\u307b\u3069\u591a\u304f\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u3002\n\nkey_buffer_size=512M\n# MyISAM\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002\n# \u591a\u304f\u5272\u308a\u5f53\u3066\u305f\u65b9\u304c\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u5411\u4e0a\u3057\u307e\u3059\u3002\u30b0\u30ed\u30fc\u30d0\u30eb\u30d0\u30c3\u30d5\u30a1\u306a\u306e\u3067\u3069\u304b\u3093\u3068\u5272\u308a\u5f53\u3066\u3089\u308c\u307e\u3059\u3002\n# \u3082\u3057\u3001MyISAM\u3092(\u3042\u307e\u308a)\u4f7f\u3063\u3066\u306a\u3044\u306e\u306a\u3089\u3070\u3001\u5c0f\u3055\u304f\u3057\u3066\u307b\u304b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u56de\u3059\u306e\u3082\u30a2\u30ea\u3067\u3059\u3002\n\nsort_buffer_size=2M\n# ORDER BY\u3084GROUP BY\u306e\u3068\u304d\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002\n\nread_buffer_size=2M\n# \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u7528\u3044\u306a\u3044\u30c6\u30fc\u30d6\u30eb\u30b9\u30ad\u30e3\u30f3\u306e\u3068\u304d\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002\n\nread_rnd_buffer_size=2M\n# \u30bd\u30fc\u30c8\u5f8c\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u8aad\u3080\u3068\u304d\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002\n# \u30c7\u30a3\u30b9\u30afI/O\u304c\u6e1b\u308b\u306e\u3067ORDER BY\u306e\u6027\u80fd\u5411\u4e0a\u304c\u671f\u5f85\u3067\u304d\u307e\u3059\u3002\n\n#server\ndefault-storage-engine=INNODB\nskip-name-resolve\n# DNS\u89e3\u6c7a\u3092OFF\u306b\u3059\u308b\nskip-ssl\n# MySQL5.7\u3067\u306fSSL\u5229\u7528\u3057\u306a\u3044\u305f\u3081\u3001OFF\u306b\u3059\u308b\n\nmax_connections=300\n# \u6700\u5927\u63a5\u7d9a\u6570\u3092300\u306b\u3059\u308b\u3001\u30b5\u30fc\u30d0\u306e\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3068\u30cd\u30c3\u30c8\u5e2f\u57df\u306b\u3088\u308b\u3082\u306e\u3067\u3001\n# \u4eca\u5f8c\u30b5\u30fc\u30d0\u30ea\u30d7\u30ec\u30fc\u30b9\u306810G\u5316\u3057\u305f\u5f8c\u3001\u5909\u66f4\u3059\u308b\u5fc5\u8981\u3042\u308a\u307e\u3059\u3002\n\nmax_connect_errors=300\n# \u9023\u7d9a\u3057\u3066\u63a5\u7d9a\u8981\u6c42\u304c\u4e2d\u65ad\u3055\u308c\u305f\u5834\u5408\u306b\u305d\u308c\u3092\u8a31\u53ef\u3059\u308b\u56de\u6570\u3092\u6c7a\u5b9a\u3057\u307e\u3059\u3002\n\nmax_allowed_packet=16M\n# MySQL Server \u304a\u3088\u3073\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u9593\u3067\u8ee2\u9001\u53ef\u80fd\u306a\u30d1\u30b1\u30c3\u30c8\u6570\u3002\n\nquery_cache_size=512M\n# \u30af\u30a8\u30ea\u30ad\u30e3\u30c3\u30b7\u30e5\u9818\u57df\u3002\n\nquery_cache_limit=32M\n# \u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u30af\u30a8\u30ea\u7d50\u679c\u306e\u6700\u5927\u30b5\u30a4\u30ba\u3002\nquery_cache_type=1\n# SELECT SQL_NO_CACHE \u4ee5\u5916\u306e\u30af\u30a8\u30ea\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\n\nconnect_timeout=30\n# connect timeout \u6642\u9593\u309230\u79d2\u306b\u8a2d\u5b9a\n\nmax_user_connections=30\n# \u5358\u4e00\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u3088\u308b\u540c\u6642\u63a5\u7d9a\u306e\u6570\n\nthread_cache_size=300\n# \u30b9\u30ec\u30c3\u30c9\u3092\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u306e\u5207\u65ad\u5f8c\u306b\u3082\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u3066\u304a\u304f\u6570\u3002\n# thread_cache_size\u3092N\u306b\u8a2d\u5b9a\u3059\u308b\u3068\u3001N\u500b\u306e\u30a2\u30af\u30c6\u30a3\u30d6\u3067\u306a\u3044\u63a5\u7d9a\u30b9\u30ec\u30c3\u30c9\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3067\u304d\u308b\u3002\n# \u95a2\u9023\u4ed8\u3051\u3089\u308c\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u63a5\u7d9a\u304c\u7d42\u4e86\u3059\u308b\u3068\u3001\u63a5\u7d9a\u30b9\u30ec\u30c3\u30c9\u306f\u30a2\u30af\u30c6\u30a3\u30d6\u3067\u306a\u304f\u306a\u308b\u3002\n\nback_log=50\n# MySQL \u3067\u4fdd\u6301\u3067\u304d\u308b\u672a\u51e6\u7406\u306e\u63a5\u7d9a\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u6570\u3002\n\ntable_open_cache=19200\n# \u3059\u3079\u3066\u306e\u30b9\u30ec\u30c3\u30c9\u306b\u3064\u3044\u3066\u958b\u3044\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u306e\u6570\u3002\n\ntable_definition_cache=16000\n# \u5b9a\u7fa9\u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u683c\u7d0d\u53ef\u80fd\u306a (.frm \u30d5\u30a1\u30a4\u30eb\u304b\u3089\u306e) \u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\u306e\u6570\u3002\n\ndelayed_insert_timeout=60\n# \u7d42\u4e86\u3059\u308b\u524d\u306b\u3001INSERT DELAYED \u30cf\u30f3\u30c9\u30e9\u30b9\u30ec\u30c3\u30c9\u304c INSERT \u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u3092\u5f85\u6a5f\u3059\u308b\u79d2\u6570\u3002\n\ninteractive_timeout=300\n# \u30b5\u30fc\u30d0\u30fc\u304c\u5bfe\u8a71\u578b\u306e\u63a5\u7d9a\u3067\u3001\u5bfe\u8a71\u578b\u306e\u63a5\u7d9a\u3092\u9589\u3058\u308b\u524d\u306b\u30a2\u30af\u30c6\u30a3\u30d3\u30c6\u30a3\u30fc\u3092\u5f85\u6a5f\u3059\u308b\u79d2\u6570\u3002\n\nwait_timeout=300\n# \u975e\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u306a\u63a5\u7d9a\u3092\u9589\u3058\u308b\u524d\u306b\u3001\u30b5\u30fc\u30d0\u30fc\u304c\u305d\u306e\u63a5\u7d9a\u4e0a\u3067\u30a2\u30af\u30c6\u30a3\u30d3\u30c6\u30a3\u30fc\u3092\u5f85\u6a5f\u3059\u308b\u79d2\u6570\u3002\n\ntmp_table_size=256M\n# \u5185\u90e8\u30a4\u30f3\u30e1\u30e2\u30ea\u30fc\u306e\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306e\u6700\u5927\u30b5\u30a4\u30ba\u3002\n\nmax_heap_table_size=256M\n# \u30e6\u30fc\u30b6\u30fc\u304c\u4f5c\u6210\u3057\u305f MEMORY \u30c6\u30fc\u30d6\u30eb\u306e\u5897\u52a0\u304c\u8a31\u53ef\u3055\u308c\u308b\u6700\u5927\u30b5\u30a4\u30ba\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n# \ncharacter-set-server=utf8\ncollation-server=utf8_general_ci\n\n#innodb options\ninnodb_thread_concurrency=32\n# InnoDB \u306f\u3001\u3053\u306e\u5909\u6570\u3067\u6307\u5b9a\u3055\u308c\u305f\u5236\u9650\u4ee5\u4e0b\u306e\u6570\u306e\u30aa\u30da\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u30b7\u30b9\u30c6\u30e0\u30b9\u30ec\u30c3\u30c9\u3092\u540c\u6642\u306b InnoDB \u5185\u90e8\u306b\u4fdd\u6301\u3057\u3088\u3046\u3068\u8a66\u307f\u307e\u3059 \n# \u30b9\u30ec\u30c3\u30c9\u6570\u304c\u3053\u306e\u5236\u9650\u306b\u9054\u3059\u308b\u3068\u3001\u305d\u308c\u4ee5\u964d\u306e\u30b9\u30ec\u30c3\u30c9\u306f\u5b9f\u884c\u3055\u308c\u308b\u307e\u3067,\n# \u300c\u5148\u5165\u308c\u5148\u51fa\u3057\u300d (FIFO) \u30ad\u30e5\u30fc\u5185\u3067\u5f85\u6a5f\u72b6\u614b\u306b\u306a\u308a\u307e\u3059\u3002\u30ed\u30c3\u30af\u3092\u5f85\u6a5f\u3057\u3066\u3044\u308b\u30b9\u30ec\u30c3\u30c9\u306f\u3001\u4e26\u5217\u5b9f\u884c\u4e2d\u306e\u30b9\u30ec\u30c3\u30c9\u306e\u6570\u306b\u30ab\u30a6\u30f3\u30c8\u3055\u308c\u307e\u305b\u3093\u3002\n\ninnodb_buffer_pool_size=48G\n# \u5168\u4f53\u30e1\u30e2\u30ea\u306e50%\u301c60%\u306b\u8a2d\u5b9a\u3059\u308b\u30028\u306e\u500d\u6570\u3002\n\ninnodb_buffer_pool_dump_pct=100\ninnodb_buffer_pool_dump_at_shutdown=1\ninnodb_buffer_pool_load_at_startup=0\n# http://tech.gmo-media.jp/post/128523146249/innodb-buffer-pool-load-at-startup\n\ninnodb_log_file_size=2G\ninnodb_log_files_in_group=2\n# \u30ed\u30b0\u30b0\u30eb\u30fc\u30d7\u5185\u306e\u5404\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30a4\u30ba\u3067\u3059\u3002\u901a\u5e38\u306finnodb_buffer_pool_size\u306e25\uff05\u304c\u826f\u3044\u3068\u8a00\u308f\u308c\u3066\u307e\u3059\u304c\u3001\n# 12G\u306eib_logfile\u304c\u751f\u6210\u3055\u308c\u3001\u30af\u30e9\u30c3\u30b7\u30e5\u30ea\u30ab\u30d0\u30ea\u6642\u306e\u901f\u5ea6\u304c\u9045\u304f\u306a\u308b\u305f\u3081\u30014G\u306b\u3057\u307e\u3057\u305f\u3002\n# \u3082\u3057\u3001SSD\u3067\u306f\u306a\u304f\u3001NVME\u3067\u3042\u308c\u3070\u3001\u9069\u5f53\u306a\u5024\u306b\u5909\u66f4\u3059\u308b\u3079\u304d\u3060\u308d\u3046\u3002\n\ninnodb_log_buffer_size=4M\n# \u30c7\u30a3\u30b9\u30af\u4e0a\u306e\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u3080\u969b\u306b InnoDB \u3067\u4f7f\u7528\u3055\u308c\u308b\u30d0\u30c3\u30d5\u30a1\u30fc\u306e\u30b5\u30a4\u30ba\u3067\u3059\u3002\n# \u30ed\u30b0\u30d0\u30c3\u30d5\u30a1\u30fc\u3092\u5927\u304d\u304f\u3059\u308b\u3068\u3001\u30c7\u30a3\u30b9\u30af I/O \u3092\u7bc0\u7d04\u3067\u304d\u307e\u3059\u304c\u3001\u969c\u5bb3\u6642\u30ed\u30fc\u30b9\u3059\u308b\u30c7\u30fc\u30bf\u3082\u591a\u3044\u3001\n# \u63a8\u5968\u306f1\u301c8M\u3067\u3059\u3002\n\ninnodb_file_per_table\n# \u65b0\u305f\u306b\u4f5c\u6210\u3055\u308c\u305f\u5404\u30c6\u30fc\u30d6\u30eb\u306e\u30c7\u30fc\u30bf\u304a\u3088\u3073\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u30b9\u30da\u30fc\u30b9\u3067\u306f\u306a\u304f,\n# \u500b\u5225\u306e .ibd \u30d5\u30a1\u30a4\u30eb\u306b\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\u3053\u308c\u3089\u306e InnoDB \u30c6\u30fc\u30d6\u30eb\u7528\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u306f\u3001\u30c6\u30fc\u30d6\u30eb\u304c\u524a\u9664\u3055\u308c\u305f\u308a\u3001\n# \u5207\u308a\u6368\u3066\u3089\u308c\u305f\u308a\u3059\u308b\u3068\u518d\u5229\u7528\u3055\u308c\u307e\u3059\u30025.6.6 \u4ee5\u4e0a\u306f\u30c7\u30d5\u30a9\u30eb\u30c8ON\u3067\u3059\u3002\n\ninnodb_open_files=9600\n# \u3053\u306e\u5909\u6570\u306f\u3001\u8907\u6570\u306e InnoDB \u30c6\u30fc\u30d6\u30eb\u30b9\u30da\u30fc\u30b9\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306b\u306e\u307f\u95a2\u9023\u3057\u307e\u3059\u3002\n# MySQL \u3067\u4e00\u5ea6\u306b\u958b\u3044\u305f\u307e\u307e\u306b\u3067\u304d\u308b .ibd \u30d5\u30a1\u30a4\u30eb\u306e\u6700\u5927\u6570\u304c\u6307\u5b9a\u3055\u308c\u307e\u3059\u3002\n\ninnodb_flush_method=O_DIRECT\n# InnoDB \u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304a\u3088\u3073\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306b\u30c7\u30fc\u30bf\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3059\u308b\u969b\u306b\u4f7f\u7528\u3055\u308c\u308b\u65b9\u6cd5\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n# \u3053\u308c\u306b\u3088\u308a\u3001I/O \u30b9\u30eb\u30fc\u30d7\u30c3\u30c8\u304c\u5f71\u97ff\u3092\u53d7\u3051\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u5909\u6570\u306f\u3001Unix \u304a\u3088\u3073 Linux \u30b7\u30b9\u30c6\u30e0\u3067\u306e\u307f\u69cb\u6210\u53ef\u80fd\u3067\u3059\u3002\n# Windows \u30b7\u30b9\u30c6\u30e0\u3067\u306f\u3001\u30d5\u30e9\u30c3\u30b7\u30e5\u65b9\u6cd5\u306f\u5e38\u306b async_unbuffered \u3067\u3042\u308a\u3001\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002\n\n# - fsync: InnoDB \u306f fsync() \u30b7\u30b9\u30c6\u30e0\u30b3\u30fc\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3001\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3068\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u4e21\u65b9\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u307e\u3059\u3002fsync \u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067\u3059\u3002\n# \n# - O_DSYNC: InnoDB \u306f\u3001O_SYNC \u3092\u4f7f\u7528\u3057\u3066\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u3001fsync() \u3092\u4f7f\u7528\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u307e\u3059\u3002\u3055\u307e\u3056\u307e\u306a\u7a2e\u985e\u306e Unix \u3067\u554f\u984c\u304c\u767a\u751f\u3057\u3066\u3044\u308b\u305f\u3081\u3001InnoDB \u3067\u306f\u76f4\u63a5 O_DSYNC \u304c\u4f7f\u7528\u3055\u308c\u307e\u305b\u3093\u3002\n# \n# - O_DIRECT: InnoDB \u306f\u3001O_DIRECT (Solaris \u3067\u306f directio()) \u3092\u4f7f\u7528\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001fsync() \u3092\u4f7f\u7528\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3068\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u4e21\u65b9\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u307e\u3059\u3002\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u3001\u4e00\u90e8\u306e GNU/Linux \u30d0\u30fc\u30b8\u30e7\u30f3\u3001FreeBSD\u3001\u304a\u3088\u3073 Solaris \u3067\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\n# \n# - O_DIRECT_NO_FSYNC: InnoDB \u306f\u3001I/O \u306e\u30d5\u30e9\u30c3\u30b7\u30e5\u6642\u306b O_DIRECT \u3092\u4f7f\u7528\u3057\u307e\u3059\u304c\u3001\u5f8c\u7d9a\u306e fsync() \u30b7\u30b9\u30c6\u30e0\u30b3\u30fc\u30eb\u306f\u30b9\u30ad\u30c3\u30d7\u3057\u307e\u3059\u3002\u3053\u306e\u8a2d\u5b9a\u306f\u3001\u4e00\u90e8\u306e\u30bf\u30a4\u30d7\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306b\u306f\u9069\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u305d\u306e\u4ed6\u306b\u306f\u9069\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u305f\u3068\u3048\u3070\u3001XFS \u306b\u306f\u9069\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u305f\u3068\u3048\u3070\u3001\u4f7f\u7528\u4e2d\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3067\u3059\u3079\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u30e1\u30bf\u30c7\u30fc\u30bf\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u3001fsync() \u304c\u5fc5\u8981\u3067\u3042\u308b\u306e\u304b\u3069\u3046\u304b\u304c\u4e0d\u660e\u306a\u5834\u5408\u306f\u3001\u4ee3\u308f\u308a\u306b O_DIRECT \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f MySQL 5.6.7 (Bug #11754304\u3001Bug #45892) \u3067\u5c0e\u5165\u3055\u308c\u307e\u3057\u305f\u3002\n\ndefault_password_lifetime=0\n# \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u6709\u52b9\u671f\u9650\u3001\u30ec\u30f3\u30b5\u30d0\u3068\u9023\u643a\u3057\u3066\u3044\u308b\u305f\u3081\u3001OFF\u306b\u3057\u307e\u3057\u305f\u3002\n#enforce-gtid-consistency=1\n#gtid-mode=ON\n#safe-user-create=1\n#explicit_defaults_for_timestamp=1\nlog_timestamps=SYSTEM\n# \u30ed\u30b0\u306b\u51fa\u529b\u3055\u308c\u308b\u6642\u523b\u5909\u6570\u3067\u3059\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306fUTC\u3067\u3059\u304c\u3001\u8aad\u307f\u306b\u304f\u3044\u305f\u3081\u3001SYSTEM\u306b\u5909\u66f4\u3057\u307e\u3057\u305f\u3002\n\ndisable-partition-engine-check=1\n# https://yoku0825.blogspot.jp/2017/04/mysql-5717-deprecated-partition-engine.html\n# MySQL8 \u306e\u904e\u6e21\u671f\u306b\u3042\u305f\u308bMySQL 5.7\u306b\u8ffd\u52a0\u3055\u308c\u305f\u3082\u306e\u3067\u3059\u3001\u4eca\u5f8cMySQL8\u30ea\u30ea\u30fc\u30b9\u3057\u305f\u5834\u5408\u3001\n# \u30e6\u30fc\u30b6\u304cDB\u79fb\u8a2d\u3059\u308b\u6642\u7d04\u7acb\u3064\u3060\u308d\u3046\uff08\u3068\u601d\u3046\uff09\u3001\u3057\u304b\u3057\u3001\u6bce\u56deMySQL\u8d77\u52d5\u6642\u306btable\u3068\u30c1\u30a7\u30c3\u30af\u3059\u308b\u305f\u3081\u3001\n# \u6642\u9593\u304b\u304b\u308b\u305f\u3081\u3001disable\u3057\u307e\u3057\u305f\u3002 \n\nshow_compatibility_56=on\n# https://yakst.com/ja/posts/2733\n\ninnodb_buffer_pool_instances=8\n# InnoDB \u306e\u30d0\u30c3\u30d5\u30a1\u30fc\u30d7\u30fc\u30eb\u304c\u5206\u5272\u3055\u308c\u308b\u9818\u57df\u306e\u6570\u3067\u3059\u3002CPU\u30b3\u30a2\u6570\u306b\u5408\u308f\u305b\u308b\u3002\n\ninnodb_rollback_segments=32\n# \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5185\u3067 InnoDB \u304c\u4f7f\u7528\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u30b9\u30da\u30fc\u30b9\u306b\u3042\u308b\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u6570\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\n\ninnodb_write_io_threads=16\ninnodb_read_io_threads=16\n\ninnodb_io_capacity=2000\ninnodb_io_capacity_max=5000\n# MySQL\u30b5\u30fc\u30d0\u306fSSD\u306e\u305f\u3081\u3001io_capacity\u30922000\u301c5000\u306b\u8a2d\u5b9a\u3059\u308b\u3002\n\ninnodb_max_dirty_pages_pct=40\n# InnoDB \u306f\u3001\u30c0\u30fc\u30c6\u30a3\u30fc\u30da\u30fc\u30b8\u306e\u5272\u5408\u304c\u3053\u306e\u5024\u3092\u8d85\u3048\u306a\u3044\u3088\u3046\u306b\u3001\u30d0\u30c3\u30d5\u30a1\u30fc\u30d7\u30fc\u30eb\u304b\u3089\u30c7\u30fc\u30bf\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u3088\u3046\u3068\u8a66\u307f\u307e\u3059\u3002\n\ninnodb_flush_log_at_trx_commit=2\n\n</code></pre>"},{"location":"mysql/#_1","title":"\u73b0\u5728\u7684\u8bbe\u7f6e","text":""},{"location":"mysql/#_2","title":"\u751f\u4ea7\u73af\u5883","text":"<pre><code>[mysql]\ndefault-character-set=utf8mb4\nsocket=/tmp/mysql.sock\n\n[mysqld]\nserver_id=1\nuser=mysql\ndatadir=/home/mysql\nsocket=/tmp/mysql.sock\ntmpdir=/home/tmp\nbind-address=0.0.0.0\n\n# log\nlog_bin=mysql-bin\nbinlog_error_action=IGNORE_ERROR\nexpire_logs_days=2\nslow_query_log=1\nlong_query_time=10\nslow_query_log_file=/var/log/mysql/slow_query.log\nlog_error=/var/log/mysql/error.log\nlog_output=FILE\n\n# server\nsql_mode=\"ONLY_FULL_GROUP_BY,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\"\ndefault_storage_engine=INNODB\nskip-partition\nskip-name-resolve\nskip-ssl\nskip-symbolic-links\nmax_connections=600\nmax_connect_errors=300\nmax_allowed_packet=16M\nconnect_timeout=30\nmax_user_connections=30\ntable_open_cache=19200\ninteractive_timeout=300\nwait_timeout=300\ntmp_table_size=256M\nmax_heap_table_size=256M\ndefault_password_lifetime=0\nexplicit_defaults_for_timestamp=1\nlog_timestamps=SYSTEM\ndisable_partition_engine_check=1\ncharacter-set-server=utf8mb4\ncollation-server=utf8mb4_general_ci\n\n# buffer\nsort_buffer_size=1M\nread_buffer_size=1M\nread_rnd_buffer_size=1M\n\n# MyISAM\nmyisam_sort_buffer_size=128M\nkey_buffer_size=512M\n\n# InnoDB\ninnodb_strict_mode=1\ninnodb_file_per_table\ninnodb_temp_data_file_path=ibtmp1:12M:autoextend:max:10G\ninnodb_buffer_pool_size=56G\ninnodb_buffer_pool_dump_pct=100\ninnodb_buffer_pool_dump_at_shutdown=1\ninnodb_buffer_pool_load_at_startup=0\ninnodb_log_file_size=512M\ninnodb_write_io_threads=16\ninnodb_read_io_threads=16\ninnodb_io_capacity=2000\ninnodb_io_capacity_max=5000\ninnodb_flush_log_at_trx_commit=2\ninnodb_flush_method=O_DIRECT\ninnodb_flush_neighbors=0\ninnodb_read_ahead_threshold=0\n</code></pre>"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/","title":"mysql\u3092\u30bd\u30fc\u30b9\u304b\u3089\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb","text":""},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#linux","title":"Linux\u7cfb\u306e\u30d3\u30eb\u30c9\u30aa\u30d7\u30b7\u30e7\u30f3","text":""},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#mysql56","title":"MySQL5.6","text":"<pre><code>$ cat build-mysql5.6.sh\nexport CC=\"cc\"\nexport CXX=\"c++\"\nexport CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\"\nexport CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions\"\n\n#export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\"\n\ncmake \\\n-DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.6\" \\\n-DINSTALL_DOCDIR=\"share/doc/mysql\" \\\n-DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\\n-DINSTALL_INCLUDEDIR=\"include/mysql\" \\\n-DINSTALL_INFODIR=\"info\" \\\n-DINSTALL_LIBDIR=\"lib/mysql\" \\\n-DINSTALL_MANDIR=\"man\" \\\n-DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\\n-DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\\n-DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\\n-DINSTALL_SBINDIR=\"libexec\" \\\n-DINSTALL_SCRIPTDIR=\"bin\" \\\n-DINSTALL_SHAREDIR=\"share\" \\\n-DINSTALL_SQLBENCHDIR=\"share/mysql\" \\\n-DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\\n-DWITH_UNIT_TESTS=0 \\\n-DWITH_SSL=system \\\n-DWITH_READLINE=1 \\\n-DWITH_LIBWRAP=0 \\\n-DWITHOUT_SERVER=1 \\\n-DWITH_EMBEDDED_SERVER=\"ON\"\n</code></pre> <p><code>make</code> <code>make install</code></p>"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#mysql55","title":"MySQL5.5","text":"<pre><code>\n$ cat build-mysql5.5.sh\nexport CC=\"cc\"\nexport CXX=\"c++\"\nexport CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\"\nexport CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions -fpermissive \"\n\n#export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\"\n\ncmake \\\n-DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.5\" \\\n-DINSTALL_DOCDIR=\"share/doc/mysql\" \\\n-DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\\n-DINSTALL_INCLUDEDIR=\"include/mysql\" \\\n-DINSTALL_INFODIR=\"info\" \\\n-DINSTALL_LIBDIR=\"lib/mysql\" \\\n-DINSTALL_MANDIR=\"man\" \\\n-DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\\n-DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\\n-DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\\n-DINSTALL_SBINDIR=\"libexec\" \\\n-DINSTALL_SCRIPTDIR=\"bin\" \\\n-DINSTALL_SHAREDIR=\"share\" \\\n-DINSTALL_SQLBENCHDIR=\"share/mysql\" \\\n-DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\\n-DWITH_UNIT_TESTS=0 \\\n-DWITH_SSL=system \\\n-DWITH_READLINE=1 \\\n-DWITH_LIBWRAP=0 \\\n-DWITHOUT_SERVER=0 \\\n-DWITH_EMBEDDED_SERVER=\"ON\"\n</code></pre> <p><code>make</code> <code>make install</code></p>"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#freebsd","title":"FreeBSD\u7cfb\u306e\u30d3\u30eb\u30c9\u30aa\u30d7\u30b7\u30e7\u30f3","text":""},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#mysql56_1","title":"MySQL5.6","text":"<pre><code>export CC=\"cc\"\nexport CXX=\"c++\"\nexport CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\"\n#export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\"\nexport CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions\"\n\n\ncmake \\\n-DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.6\" \\\n-DINSTALL_DOCDIR=\"share/doc/mysql\" \\\n-DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\\n-DINSTALL_INCLUDEDIR=\"include/mysql\" \\\n-DINSTALL_INFODIR=\"info\" \\\n-DINSTALL_LIBDIR=\"lib/mysql\" \\\n-DINSTALL_MANDIR=\"man\" \\\n-DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\\n-DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\\n-DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\\n-DINSTALL_SBINDIR=\"libexec\" \\\n-DINSTALL_SCRIPTDIR=\"bin\" \\\n-DINSTALL_SHAREDIR=\"share\" \\\n-DINSTALL_SQLBENCHDIR=\"share/mysql\" \\\n-DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\\n-DWITH_UNIT_TESTS=0 \\\n-DWITH_SSL=system \\\n-DWITH_READLINE=1 \\\n-DWITH_LIBWRAP=0 \\\n-DWITHOUT_SERVER=1 \\\n-DWITH_EMBEDDED_SERVER=\"ON\"\n</code></pre> <p><code>make</code> <code>make install</code></p>"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#mysql55_1","title":"MySQL5.5","text":"<pre><code>$ cat mysql-5.5.61/build-mysql5.5.sh\nexport CC=\"cc\"\nexport CXX=\"c++\"\nexport CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\"\nexport CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions -fpermissive\"\n#export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\"\n#export CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions -fpermissive\"\n\n\ncmake \\\n-DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.5\" \\\n-DINSTALL_DOCDIR=\"share/doc/mysql\" \\\n-DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\\n-DINSTALL_INCLUDEDIR=\"include/mysql\" \\\n-DINSTALL_INFODIR=\"info\" \\\n-DINSTALL_LIBDIR=\"lib/mysql\" \\\n-DINSTALL_MANDIR=\"man\" \\\n-DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\\n-DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\\n-DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\\n-DINSTALL_SBINDIR=\"libexec\" \\\n-DINSTALL_SCRIPTDIR=\"bin\" \\\n-DINSTALL_SHAREDIR=\"share\" \\\n-DINSTALL_SQLBENCHDIR=\"share/mysql\" \\\n-DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\\n-DWITH_UNIT_TESTS=0 \\\n-DWITH_SSL=system \\\n-DWITH_READLINE=1 \\\n-DWITH_LIBWRAP=0 \\\n-DWITHOUT_SERVER=0 \\\n-DWITHOUT_PARTITION_STORAGE_ENGINE=1 \\\n-DWITH_EMBEDDED_SERVER=\"ON\"\n</code></pre> <p><code>make</code> <code>make install</code></p>"},{"location":"psql-vs-mysql/","title":"MySQL\u3068PostgreSQL\u30b3\u30de\u30f3\u30c9\u6bd4\u8f03\u8868","text":""},{"location":"psql-vs-mysql/#mysqlpostgresql","title":"MySQL\u3068PostgreSQL\u30b3\u30de\u30f3\u30c9\u6bd4\u8f03\u8868","text":"<p>\u672c\u6587</p> \u6a5f\u80fd MySQL PostgreSQL \u8d77\u52d5 <code>$ mysql -p -h \u30db\u30b9\u30c8\u540d -P \u30dd\u30fc\u30c8\u756a\u53f7 -u \u30e6\u30fc\u30b6\u540d DB\u540d</code> <code>$ psql -h \u30db\u30b9\u30c8\u540d -p \u30dd\u30fc\u30c8\u756a\u53f7 -U \u30e6\u30fc\u30b6\u540d DB\u540d</code> \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u4e00\u89a7 show databases; \\l \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u5207\u66ff use DB\u540d \\u DB\u540d \\c DB\u540d \u30c6\u30fc\u30d6\u30eb\u4e00\u89a7 show tables; \\d\u3001\\dt\u3001\\d+\u3001\\dt+ \u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\u78ba\u8a8d desc \u30c6\u30fc\u30d6\u30eb\u540d; \\d \u30c6\u30fc\u30d6\u30eb\u540d \u30c6\u30fc\u30d6\u30ebCREATE\u6587\u78ba\u8a8d show create table \u30c6\u30fc\u30d6\u30eb\u540d pg_dump DB\u540d -U \u30e6\u30fc\u30b6\u540d -s -t \u30c6\u30fc\u30d6\u30eb\u540d \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u4e00\u89a7 SHOW INDEX FROM tbl_name; \\d table_name \u884c\u8868\u793a\u306e\u5207\u308a\u66ff\u3048 select * from t \\G \\x select * from t; \u203bmysql\u540c\u69d8\u30011\u56de\u306e\u30af\u30a8\u30ea\u3060\u3051\\x\u3057\u305f\u3044\u5834\u5408\u306f select * from t \\gx psql 9\u4ee5\u524d\u306e\u5834\u5408\u306f\u3053\u3061\u3089 SQL\u30d5\u30a1\u30a4\u30eb\u5b9f\u884c . \\i SQL\u30c0\u30f3\u30d7 mysqldump pg_dump TSV\u30c0\u30f3\u30d7 mysqldump -u USER --password=PASS DATABASE_NAME TABLE_NAME -T /tmp \\copy \u30c6\u30fc\u30d6\u30eb\u540d to 'data.tsv' csv delimiter E'\\t' header; \u307e\u305f\u306f \\copy (select * from \u30c6\u30fc\u30d6\u30eb\u540d) to 'data.tsv' csv delimiter E'\\t' header; TSV\u30a4\u30f3\u30dd\u30fc\u30c8 LOAD DATA LOCAL INFILE \u30d5\u30a1\u30a4\u30eb\u540d REPLACE INTO TABLE \u30c6\u30fc\u30d6\u30eb\u540d IGNORE 1 LINES; copy \u30c6\u30fc\u30d6\u30eb\u540d from '/absolute_path/to/data.tsv' ( delimiter E'\\t', format csv, header true ); SQL\u6642\u9593\u8a08\u6e2c \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u8868\u793a\u3055\u308c\u308b \\timing on \u30ed\u30b0\u51fa\u529b\u958b\u59cb \\T log.txt \\o log.txt \u30ed\u30b0\u51fa\u529b\u7d42\u4e86 \\t \\o 1\u56de\u306e\u30af\u30a8\u30ea\u3060\u3051\u30d5\u30a1\u30a4\u30eb\u306b\u51fa\u529b \u4e0d\u660e SQL\u306e\u672b\u5c3e\u306b\\g FILENAME\u3092\u3064\u3051\u308b 1\u56de\u306e\u30af\u30a8\u30ea\u3060\u3051vim\u3067\u8868\u793a \u4e0d\u660e SQL\u306e\u672b\u5c3e\u306b\\g |vim -\u3092\u3064\u3051\u308b \u5b9a\u7fa9\u3092\u30b3\u30d4\u30fc\u3057\u3066\u30c6\u30fc\u30d6\u30eb\u4f5c\u6210 create table t2 like t1; create table t2 (like t1); \u5b9f\u884c\u8a08\u753b SQL\u306e\u5148\u982d\u306bEXPLAIN\u3092\u3064\u3051\u308b SQL\u306e\u5148\u982d\u306bEXPLAIN\u3092\u3064\u3051\u308b \u63a5\u7d9a\u5148\u30b5\u30fc\u30d0\u78ba\u8a8d \\s \\conninfo SELECT version(); \u63a5\u7d9a\u3092\u78ba\u8a8d show processlist; select * from pg_stat_activity; \u9023\u756aID \u30ab\u30e9\u30e0\u540d int auto_increment \u30ab\u30e9\u30e0\u540d serial \u4eca\u65e5\u306e\u65e5\u4ed8 curdate() current_date \u73fe\u5728\u6642\u523b now() now() \u30d8\u30eb\u30d7 \\h \u307e\u305f\u306f \\? \\h \u3068 \\? \uff08\u5185\u5bb9\u304c\u7570\u306a\u308b\uff09 \u8a2d\u5b9a\u30d5\u30a1\u30a4\u30eb ~/.my.cnf ~/.psqlrc"},{"location":"psql-vs-mysql/#information_schema","title":"information_schema\u306f\u4e21\u65b9\u306b\u5171\u901a","text":"<p>information_schema\u306fSQL\u6a19\u6e96\u306a\u306e\u3067\u3001\u3069\u3061\u3089\u3067\u3082\u540c\u3058SQL\u304c\u4f7f\u3048\u308b\u3002</p>"},{"location":"psql-vs-mysql/#_1","title":"\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7\u3092\u8868\u793a","text":"<pre><code>SELECT table_catalog\n       ,table_schema\n       ,table_name\n       ,table_type\nFROM   information_schema.tables;\n</code></pre>"},{"location":"psql-vs-mysql/#_2","title":"\u30ab\u30e9\u30e0\u4e00\u89a7\u3092\u8868\u793a","text":"<pre><code>SELECT table_schema\n       ,table_name\n       ,column_name\n       ,data_type\n       ,character_maximum_length\n       ,numeric_precision\n       ,column_default\nFROM   information_schema.columns\nWHERE  table_name = 't1'\nORDER  BY table_name\n          ,ordinal_position;\n</code></pre>"},{"location":"psql-vs-mysql/#_3","title":"\u30c7\u30d5\u30a9\u30eb\u30c8\u63a5\u7d9a\u5148","text":"<p>PostgreSQL\uff1a\u74b0\u5883\u5909\u6570\u3067\u8a2d\u5b9a</p> <pre><code>export PGDATABASE=DB\u540d\nexport PGHOST=\u30db\u30b9\u30c8\nexport PGPORT=\u30dd\u30fc\u30c8\u756a\u53f7\nexport PGUSER=\u30e6\u30fc\u30b6\u30fc\u540d\nexport PGPASSWORD=\u30d1\u30b9\u30ef\u30fc\u30c9\n\n\u30d1\u30b9\u30ef\u30fc\u30c9\u306f~/.pgpass\u3067\u3082\u8a2d\u5b9a\u3067\u304d\u308b\u3002\n</code></pre> <p>MySQL\uff1a~/.my.cnf\u3067\u8a2d\u5b9a</p> <pre><code>[client]\ndatabase=DB\u540d\nuser=\u30e6\u30fc\u30b6\u30fc\u540d\npassword=\u30d1\u30b9\u30ef\u30fc\u30c9\n</code></pre>"},{"location":"python-config/","title":"Python \u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u7ba1\u7406\u7684\u6700\u4f73\u5de5\u7a0b\u5b9e\u8df5","text":"<ul> <li>https://cloud.tencent.com/developer/beta/article/2269479</li> </ul> <p>\u6700\u8fd1\u5728\u7ed3\u5408 Python-3.12.0a6 \u7248\u672c\u5f00\u53d1\u4e00\u4e2a\u591a\u7ebf\u7a0b\u67b6\u6784\u7684\u540e\u53f0\u670d\u52a1\uff1b\u670d\u52a1\u542f\u52a8\u65f6\u4f1a\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u4e14\u8981\u6c42\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u540c\u4e00\u4efd\u914d\u7f6e\u3002 \u670d\u52a1\u672c\u8eab\u76f4\u63a5\u901a\u8fc7 http \u63a5\u53e3\u6765\u52a8\u6001\u8c03\u6574\u914d\u7f6e\u9879\u7684\u503c\uff0c\u8fd8\u8981\u505a\u5230\u670d\u52a1\u9000\u51fa\u4e4b\u540e\u6301\u4e45\u5316\u914d\u7f6e\u9879\u5230\u914d\u7f6e\u6587\u4ef6\u3002 \u4e00\u5f00\u59cb\u4ee5\u4e3a\u8fd9\u4e2a\u7528 Python \u5199\u4e5f\u4f1a\u8981\u7528\u51e0\u767e\u884c \uff0c\u6700\u540e\u53d1\u73b0\u5b8c\u6210\u6838\u5fc3\u529f\u80fd\u5c31\u53ea\u9700\u8981\u4e0d\u5230 50 \u884c\uff0cPython \u725b\u903c\uff01\uff01\uff01</p>"},{"location":"python-config/#_1","title":"\u9700\u6c42\u4e00\uff1a\u652f\u6301\u7b80\u5355\u7684\u914d\u7f6e\u9879","text":"<p>\u5047\u8bbe\u6211\u4eec\u76ee\u524d\u53ea\u652f\u6301 name \u548c port \u4e24\u4e2a\u914d\u7f6e\u9879\uff0c\u591a\u652f\u6301\u51e0\u4e2a\u4e0d\u96be\uff0c\u53ea\u662f\u4e0d\u65b9\u4fbf\u6f14\u793a\u3002</p> <pre><code>\"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406\n\"\"\"\n\nfrom dataclasses import dataclass\n\n\n@dataclass\nclass Config(object):\n    name:str= \"mysql\"\n    port:int = 3306\n</code></pre> <p>\u770b\u8d77\u6765\u662f\u6ca1\u95ee\u9898\u4e86\uff0c\u4e0b\u9762\u53ef\u4ee5\u8bd5\u7528\u4e00\u4e0b\uff0c\u4e5f\u987a\u5e26\u5f15\u5bfc\u51fa\u7b2c\u4e8c\u4e2a\u9700\u6c42\u3002</p> <pre><code>In [6]: a = Config()\n\nIn [7]: b = Config()\n\nIn [8]: id(a)\nOut[8]: 4407850896\n\nIn [9]: id(b)\nOut[9]: 4407852496\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u4e24\u4e2a\u914d\u7f6e\u5bf9\u8c61\u7684 ID \u503c\u4e0d\u4e00\u6837\u3002\u7531\u4e8e\u914d\u7f6e\u6587\u4ef6\u53ea\u6709\u4e00\u4e2a\uff0c\u6211\u4eec\u5e0c\u671b\u914d\u7f6e\u5bf9\u8c61\u4e5f\u53ea\u6709\u4e00\u4e2a\u3002</p>"},{"location":"python-config/#_2","title":"\u9700\u6c42\u4e8c\uff1a\u914d\u7f6e\u5bf9\u8c61\u5168\u5c40\u552f\u4e00","text":"<p>\u4ea4\u4ee3\u4e00\u4e2a\u80cc\u666f\uff0c\u89e3\u91ca\u5668\u5728\u505a import \u7684\u65f6\u5019\u662f\u5355\u4e00\u7ebf\u7a0b\u5728\u8dd1\u7684\u3002\u6709\u4e86\u8fd9\u4e2a\u524d\u63d0\u6211\u4eec\u53ef\u4ee5\u5c11\u5199\u4e00\u4e9b\u52a0\u9501\u7684\u4ee3\u7801\uff0c\u80fd\u5c11\u5199\u4e00\u884c\u7b97\u4e00\u884c\u5427\u3002</p> <pre><code>\"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406\n\"\"\"\n\nfrom dataclasses import dataclass\n\n\n@dataclass\nclass Config(object):\n    name:str= \"mysql\"\n    port:int = 3306\n\n    _instance = None\n\n    # \u5355\u4f8b\u6a21\u5f0f\n    def __new__(cls, *args, **kw):\n        if cls._instance is None:\n            cls._instance = object.__new__(cls, *args, **kw)\n        return cls._instance\n</code></pre> <p>\u7528 Python \u5c31\u662f\u8fd9\u4e48\u7684\u7b80\u5355\uff0c\u51e0\u884c\u4ee3\u7801\u5c31\u641e\u5b9a\u4e86\u3002\u4f46\u662f\u8fd8\u662f\u8981\u6d4b\u8bd5\u4e00\u4e0b\u987a\u5e26\u5f15\u5bfc\u51fa\u4e0b\u4e00\u4e2a\u9700\u6c42\u3002</p> <pre><code>In [4]: a = Config()\n\nIn [5]: b = Config()\n\nIn [6]: id(a)\nOut[6]: 4414751568\n\nIn [7]: id(b)\nOut[7]: 4414751568\n</code></pre> <p>\u73b0\u5728\u914d\u7f6e\u5bf9\u8c61\u5df2\u7ecf\u662f\u5355\u4f8b\u4e86\uff0c\u4f46\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5b83\u7684\u6bcf\u4e2a\u914d\u7f6e\u9879\u7684\u503c\u90fd\u662f\u9ed8\u8ba4\u503c\uff0c\u6211\u4eec\u5f53\u7136\u662f\u5e0c\u671b\u5b83\u5728\u521b\u5efa\u5bf9\u8c61\u7684\u65f6\u5019\u662f\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\u5566\u3002\u4e0b\u9762\u770b\u9700\u6c42\u4e09\u600e\u4e48\u5b9e\u73b0</p>"},{"location":"python-config/#_3","title":"\u9700\u6c42\u4e09\uff1a\u6839\u636e\u914d\u7f6e\u6587\u4ef6\u6784\u9020\u914d\u7f6e\u5bf9\u8c61","text":"<p>\u5047\u8bbe\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u88ab \u201c\u6301\u4e45\u5316\u201d \u5230\u4e86 /tmp/config.json \uff0c\u73b0\u5728\u5c31\u53ef\u4ee5\u5199\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u5e76\u66f4\u65b0\u914d\u7f6e\u5bf9\u8c61\u503c\u7684\u4ee3\u7801\u4e86\u3002</p> <pre><code>\"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406\n\"\"\"\n\nimport json\nimport logging\nfrom pathlib import Path\nfrom dataclasses import dataclass\n\n\n@dataclass\nclass Config(object):\n    name:str= \"mysql\"\n    port:int = 3306\n\n    _instance = None\n\n    # \u5355\u4f8b\u6a21\u5f0f\n    def __new__(cls, *args, **kw):\n        if cls._instance is None:\n            cls._instance = object.__new__(cls, *args, **kw)\n        return cls._instance\n\n    # \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\n    def __post_init__(self):\n        \"\"\"\u5982\u679c\u914d\u7f6e\u6587\u4ef6\u5b58\u5728\u5c31\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\uff0c\u8986\u76d6\u9ed8\u8ba4\u503c\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5982\u679c\u9047\u5230\u5f02\u5e38\u5c31\u4fdd\u6301\u9ed8\u8ba4\u503c\n        \"\"\"\n        if (config_file:=Path(\"/tmp/config.json\")) and config_file.exists():\n            try:\n                with open(config_file) as f:\n                    json_data = json.loads(f.read())\n                    self.__dict__.update(json_data)\n            except Exception as err:\n                pass\n        else:\n            logging.warn(\"config file '{}' not exists. well using defautl values .\".format(config_file))\n</code></pre> <p>\u5047\u8bbe\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9\u662f\u8fd9\u6837\u7684\u3002</p> <pre><code>cat /tmp/config.json \n{\n  \"name\": \"trump\",\n  \"port\": 8848\n}\n</code></pre> <p>\u4e0b\u9762\u7684\u6d4b\u8bd5\u4e00\u4e0b</p> <pre><code>In [2]: a = Config()\n\nIn [3]: a\nOut[3]: Config(name='trump', port=8848)\n\nIn [4]: b = Config()\n\nIn [5]: b\nOut[5]: Config(name='trump', port=8848)\n\nIn [6]: a == b\nOut[6]: True\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 name \u548c port \u5df2\u7ecf\u6ca1\u6709\u4f7f\u7528\u9ed8\u8ba4\u7684 \"mysql\" \u548c 3306 \u4e86\uff0c\u800c\u662f\u4f7f\u7528\u4e86\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\u3002 \u5230\u8fd9\u91cc\u6211\u4eec\u53ea\u5269\u4e0b\u6700\u540e\u4e00\u4e2a\u9700\u6c42\uff0c\u5c31\u662f\u5728\u7a0b\u5e8f\u9000\u51fa\u7684\u65f6\u5019\uff0c\u628a\u914d\u7f6e\u5bf9\u8c61\u7684\u503c\u66f4\u65b0\u56de\u914d\u7f6e\u6587\u4ef6\u3002\u8fd9\u4e2a\u5c31\u770b\u9700\u6c42\u56db\u600e\u4e48\u5199\u3002</p>"},{"location":"python-config/#_4","title":"\u9700\u6c42\u56db\uff1a\u7a0b\u5e8f\u9000\u51fa\u524d\u81ea\u52a8\u6301\u4e45\u5316\u914d\u7f6e\u5bf9\u8c61\u5230\u914d\u7f6e\u6587\u4ef6","text":"<p>\u89e3\u91ca\u5668\u5728\u9000\u51fa\u524d\u6709\u4e2a\u94a9\u5b50(atexit)\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u91cc\u6307\u5b9a\u56de\u8c03\u51fd\u6570\uff0c\u8fd9\u4e2a\u65f6\u5019\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6\u518d\u9002\u5408\u4e0d\u8fc7\u3002</p> <pre><code>\"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406\n\"\"\"\n\nimport json\nimport atexit\nimport logging\nfrom pathlib import Path\nfrom dataclasses import dataclass, asdict\n\n\n@dataclass\nclass Config(object):\n    name:str= \"mysql\"\n    port:int = 3306\n\n    _instance = None\n\n    # \u5355\u4f8b\u6a21\u5f0f\n    def __new__(cls, *args, **kw):\n        if cls._instance is None:\n            cls._instance = object.__new__(cls, *args, **kw)\n        return cls._instance\n\n    # \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\n    def __post_init__(self):\n        \"\"\"\u5982\u679c\u914d\u7f6e\u6587\u4ef6\u5b58\u5728\u5c31\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\uff0c\u8986\u76d6\u9ed8\u8ba4\u503c\uff1b\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5982\u679c\u9047\u5230\u5f02\u5e38\u5c31\u4fdd\u6301\u9ed8\u8ba4\u503c\u3002\u7a0b\u5e8f\u9000\u51fa\u65f6\u6301\u4e45\u5230\u5230\u914d\u7f6e\u5230\u6587\u4ef6\u3002\n        \"\"\"\n        if (config_file:=Path(\"/tmp/config.json\")) and config_file.exists():\n            try:\n                with open(config_file) as f:\n                    json_data = json.loads(f.read())\n                    self.__dict__.update(json_data)\n            except Exception as err:\n                pass\n        else:\n            logging.warn(\"config file '{}' not exists. well using defautl values .\".format(config_file))\n\n        # \u7a0b\u5e8f\u9000\u51fa\u65f6\u4fdd\u5b58\u914d\u7f6e\u5230\u914d\u7f6e\u6587\u4ef6 /tmp/config.json\n        def sync_to_disk():\n            \"\"\"\n            \"\"\"\n            json_str = json.dumps(asdict(self), indent=4)\n            with open(config_file, 'w') as f:\n                logging.warning(\"save configs to '{}' \".format(config_file))\n                f.write(json_str) \n\n        atexit.register(sync_to_disk)\n</code></pre> <p>\u9a8c\u8bc1\u4e00\u4e0b</p> <pre><code>In [1]: from appconfig import Config\n\nIn [2]: a = Config()\n\nIn [3]: a.name\nOut[3]: 'trump'\n\nIn [4]: a.name = \"hello-world\"\n\nIn [5]: exit()\nWARNING:root:save configs to '/tmp/config.json' \n</code></pre> <p>\u770b\u65e5\u5fd7\u662f\u5df2\u7ecf\u628a\u914d\u7f6e\u9879\u66f4\u65b0\u56de\u914d\u7f6e\u6587\u4ef6\u4e86\uff0c\u4f46\u662f\u8fd8\u662f cat \u786e\u8ba4\u4e00\u4e0b\u4e3a\u597d\u3002</p> <pre><code>cat /tmp/config.json \n{\n    \"name\": \"hello-world\",\n    \"port\": 8848\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u786e\u5b9e\u5df2\u7ecf\u628a\u914d\u7f6e\u9879\u7684\u503c\u66f4\u65b0\u5230\u6587\u4ef6\u4e86\u3002</p>"},{"location":"python-decorator/","title":"\u8de8\u8fc7\u8fd9\u9053\u88c5\u9970\u5668\u7684\u574e\uff0c\u6216\u8bb8\u4f60\u5c31\u5347\u7ea7\u4e86","text":"<p>\u88c5\u9970\u5668\u662f\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684 Python \u6982\u5ff5\uff0c\u53ef\u80fd\u7b97\u662f\u8fdb\u9636\u7684\u4e00\u5927\u95e8\u69db\u3002\u672c\u6587\u6bd4\u8f83\u5168\u9762\u5730\u5bf9\u88c5\u9970\u5668\u8fdb\u884c\u4e86\u4ecb\u7ecd\uff0c\u5e76\u4e14\u914d\u5907\u4e86\u8be6\u7ec6\u7684\u4ee3\u7801\u793a\u4f8b\uff0c\u63a8\u8350\u9605\u8bfb\u3002</p> <p>\u4f5c\u8005\uff1aToby \u539f\u6587\uff1ahttps://betacat.online/posts/python-decorator/index.html</p> <p>Python \u4e2d\u7684\u88c5\u9970\u5668\u662f\u4f60\u8fdb\u5165 Python \u5927\u95e8\u7684\u4e00\u9053\u574e\uff0c\u4e0d\u7ba1\u4f60\u8de8\u4e0d\u8de8\u8fc7\u53bb\u5b83\u90fd\u5728\u90a3\u91cc\u3002</p>"},{"location":"python-decorator/#_1","title":"\u4e3a\u4ec0\u4e48\u9700\u8981\u88c5\u9970\u5668","text":"<p>\u6211\u4eec\u5047\u8bbe\u4f60\u7684\u7a0b\u5e8f\u5b9e\u73b0\u4e86 <code>say_hello ()</code> \u548c <code>say_goodbye ()</code> \u4e24\u4e2a\u51fd\u6570\u3002</p> <pre><code>def say_hello():\n   print \"hello!\"\n\ndef say_goodbye():\n   print \"hello!\"  # bug here\n\nif __name__ == '__main__':\n   say_hello()\n   say_goodbye()\n</code></pre> <p>\u4f46\u662f\u5728\u5b9e\u9645\u8c03\u7528\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u7a0b\u5e8f\u51fa\u9519\u4e86\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u6253\u5370\u4e86\u4e24\u4e2a hello \u3002\u7ecf\u8fc7\u8c03\u8bd5\u4f60\u53d1\u73b0\u662f <code>say_goodbye ()</code> \u51fa\u9519\u4e86\u3002\u8001\u677f\u8981\u6c42\u8c03\u7528\u6bcf\u4e2a\u65b9\u6cd5\u524d\u90fd\u8981\u8bb0\u5f55\u8fdb\u5165\u51fd\u6570\u7684\u65f6\u95f4\u548c\u540d\u79f0\uff0c\u6bd4\u5982\u8fd9\u6837\uff1a</p> <pre><code>[DEBUG] 2016 - 10 - 27 11:11:11 - Enter say_hello()\nHello!\n\n[DEBUG] 2016 - 10 - 27 11:11:11 - Enter say_goodbye()\nGoodbye!\n</code></pre> <p>\u597d\uff0c\u5c0f A \u662f\u4e2a\u6bd5\u4e1a\u751f\uff0c\u4ed6\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\u3002</p> <pre><code>def say_hello():\n   print \"[DEBUG]: enter say_hello()\"\n   print \"hello!\"\n\ndef say_goodbye():\n   print \"[DEBUG]: enter say_goodbye()\"\n   print \"hello!\"\n\nif __name__ == '__main__':\n   say_hello()\n   say_goodbye()\n</code></pre> <p>\u5f88 low \u5427\uff1f \u55ef\u662f\u7684\u3002\u5c0f B \u5de5\u4f5c\u6709\u4e00\u6bb5\u65f6\u95f4\u4e86\uff0c\u4ed6\u544a\u8bc9\u5c0f A \u5e94\u8be5\u8fd9\u6837\u5199\u3002</p> <pre><code>def debug():\n   import inspect\n   caller_name = inspect.stack()[1][3]    \n   print \"[DEBUG]: enter {}()\".format(caller_name)\n\ndef say_hello():\n   debug()    \n   print \"hello!\"\n\ndef say_goodbye():\n   debug()    \n   print \"goodbye!\"\n\nif __name__ == '__main__':\n   say_hello()\n   say_goodbye()\n</code></pre> <p>\u662f\u4e0d\u662f\u597d\u4e00\u70b9\uff1f\u90a3\u5f53\u7136\uff0c\u4f46\u662f\u6bcf\u4e2a\u4e1a\u52a1\u51fd\u6570\u91cc\u90fd\u8981\u8c03\u7528\u4e00\u4e0b debug () \u51fd\u6570\uff0c\u662f\u4e0d\u662f\u5f88\u96be\u53d7\uff1f\u4e07\u4e00\u8001\u677f\u8bf4 say \u76f8\u5173\u7684\u51fd\u6570\u4e0d\u7528 debug \uff0c do \u76f8\u5173\u7684\u624d\u9700\u8981\u5462\uff1f</p> <p>\u90a3\u4e48\u88c5\u9970\u5668\u8fd9\u65f6\u5019\u5e94\u8be5\u767b\u573a\u4e86\u3002</p> <p>\u88c5\u9970\u5668\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a Python \u51fd\u6570\uff0c\u5b83\u53ef\u4ee5\u8ba9\u5176\u4ed6\u51fd\u6570\u5728\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u4ee3\u7801\u53d8\u52a8\u7684\u524d\u63d0\u4e0b\u589e\u52a0\u989d\u5916\u529f\u80fd\uff0c\u88c5\u9970\u5668\u7684\u8fd4\u56de\u503c\u4e5f\u662f\u4e00\u4e2a\u51fd\u6570\u5bf9\u8c61\u3002\u5b83\u7ecf\u5e38\u7528\u4e8e\u6709\u5207\u9762\u9700\u6c42\u7684\u573a\u666f\uff0c\u6bd4\u5982\uff1a\u63d2\u5165\u65e5\u5fd7\u3001\u6027\u80fd\u6d4b\u8bd5\u3001\u4e8b\u52a1\u5904\u7406\u3001\u7f13\u5b58\u3001\u6743\u9650\u6821\u9a8c\u7b49\u573a\u666f\u3002\u88c5\u9970\u5668\u662f\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\u7684\u7edd\u4f73\u8bbe\u8ba1\uff0c\u6709\u4e86\u88c5\u9970\u5668\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u62bd\u79bb\u51fa\u5927\u91cf\u4e0e\u51fd\u6570\u529f\u80fd\u672c\u8eab\u65e0\u5173\u7684\u96f7\u540c\u4ee3\u7801\u5e76\u7ee7\u7eed\u91cd\u7528\u3002</p> <p>\u6982\u62ec\u7684\u8bb2\uff0c\u88c5\u9970\u5668\u7684\u4f5c\u7528\u5c31\u662f<code>\u4e3a\u5df2\u7ecf\u5b58\u5728\u7684\u51fd\u6570\u6216\u5bf9\u8c61\u6dfb\u52a0\u989d\u5916\u7684\u529f\u80fd\u3002</code></p> <p>\u600e\u4e48\u5199\u4e00\u4e2a\u88c5\u9970\u5668</p> <p>\u5728\u65e9\u4e9b\u65f6\u5019  (Python Version &lt; 2.4\uff0c2004\u5e74\u4ee5\u524d)\uff0c\u4e3a\u4e00\u4e2a\u51fd\u6570\u6dfb\u52a0\u989d\u5916\u529f\u80fd\u7684\u5199\u6cd5\u662f\u8fd9\u6837\u7684\u3002</p> <pre><code>def debug(func):\n   def wrapper():\n       print \"[DEBUG]: enter {}()\".format(func.__name__)        \n       return func()    \n   return wrapper\n\ndef say_hello():\n   print \"hello!\"\n\nsay_hello = debug(say_hello)  # \u6dfb\u52a0\u529f\u80fd\u5e76\u4fdd\u6301\u539f\u51fd\u6570\u540d\u4e0d\u53d8\n</code></pre> <p>\u4e0a\u9762\u7684 debug \u51fd\u6570\u5176\u5b9e\u5df2\u7ecf\u662f\u4e00\u4e2a\u88c5\u9970\u5668\u4e86\uff0c\u5b83\u5bf9\u539f\u51fd\u6570\u505a\u4e86\u5305\u88c5\u5e76\u8fd4\u56de\u4e86\u53e6\u5916\u4e00\u4e2a\u51fd\u6570\uff0c\u989d\u5916\u6dfb\u52a0\u4e86\u4e00\u4e9b\u529f\u80fd\u3002\u56e0\u4e3a\u8fd9\u6837\u5199\u5b9e\u5728\u4e0d\u592a\u4f18\u96c5\uff0c\u4e0b\u9762\u4ee3\u7801\u7b49\u540c\u4e8e\u65e9\u671f\u7684\u5199\u6cd5\u3002</p> <pre><code>def debug(func):\n   def wrapper():\n       print \"[DEBUG]: enter {}()\".format(func.__name__)        \n       return func()    \n   return wrapper\n\n@debug\ndef say_hello():\n   print \"hello!\"\n</code></pre> <p>\u8fd9\u662f\u6700\u7b80\u5355\u7684\u88c5\u9970\u5668\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u88ab\u88c5\u9970\u7684\u51fd\u6570\u9700\u8981\u4f20\u5165\u53c2\u6570\uff0c\u90a3\u4e48\u8fd9\u4e2a\u88c5\u9970\u5668\u5c31\u574f\u4e86\u3002\u56e0\u4e3a\u8fd4\u56de\u7684\u51fd\u6570\u5e76\u4e0d\u80fd\u63a5\u53d7\u53c2\u6570\uff0c\u4f60\u53ef\u4ee5\u6307\u5b9a\u88c5\u9970\u5668\u51fd\u6570 <code>wrapper</code> \u63a5\u53d7\u548c\u539f\u51fd\u6570\u4e00\u6837\u7684\u53c2\u6570\uff0c\u6bd4\u5982\uff1a</p> <pre><code>def debug(func):\n   def wrapper(something):  # \u6307\u5b9a\u4e00\u6bdb\u4e00\u6837\u7684\u53c2\u6570\n       print \"[DEBUG]: enter {}()\".format(func.__name__)        \n       return func(something)    \n   return wrapper  # \u8fd4\u56de\u5305\u88c5\u8fc7\u51fd\u6570\n\n@debug\ndef say(something):\n   print \"hello {}!\".format(something)\n</code></pre> <p>\u8fd9\u6837\u4f60\u5c31\u89e3\u51b3\u4e86\u4e00\u4e2a\u95ee\u9898\uff0c\u4f46\u53c8\u591a\u4e86 N \u4e2a\u95ee\u9898\u3002\u56e0\u4e3a\u51fd\u6570\u6709\u5343\u5343\u4e07\uff0c\u4f60\u53ea\u7ba1\u4f60\u81ea\u5df1\u7684\u51fd\u6570\uff0c\u522b\u4eba\u7684\u51fd\u6570\u53c2\u6570\u662f\u4ec0\u4e48\u6837\u5b50\uff0c\u9b3c\u77e5\u9053\uff1f\u8fd8\u597d Python \u63d0\u4f9b\u4e86\u53ef\u53d8\u53c2\u6570 <code>* args</code> \u548c\u5173\u952e\u5b57\u53c2\u6570 <code>** kwargs</code> \uff0c\u6709\u4e86\u8fd9\u4e24\u4e2a\u53c2\u6570\uff0c\u88c5\u9970\u5668\u5c31\u53ef\u4ee5\u7528\u4e8e\u4efb\u610f\u76ee\u6807\u51fd\u6570\u4e86\u3002</p> <pre><code>def debug(func):\n   def wrapper(*args, **kwargs):  # \u6307\u5b9a\u5b87\u5b99\u65e0\u654c\u53c2\u6570\n       print \"[DEBUG]: enter {}()\".format(func.__name__)        \n       print 'Prepare and say...',        \n       return func(*args, **kwargs)    \n   return wrapper  # \u8fd4\u56de\n\n@debug\ndef say(something):\n   print \"hello {}!\".format(something)\n</code></pre> <p>\u81f3\u6b64\uff0c\u4f60\u5df2\u5b8c\u5168\u638c\u63e1\u521d\u7ea7\u7684\u88c5\u9970\u5668\u5199\u6cd5\u3002</p>"},{"location":"python-decorator/#_2","title":"\u9ad8\u7ea7\u4e00\u70b9\u7684\u88c5\u9970\u5668","text":"<p>\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\u548c\u7c7b\u88c5\u9970\u5668\u5c5e\u4e8e\u8fdb\u9636\u7684\u5185\u5bb9\u3002\u5728\u7406\u89e3\u8fd9\u4e9b\u88c5\u9970\u5668\u4e4b\u524d\uff0c\u6700\u597d\u5bf9\u51fd\u6570\u7684\u95ed\u5305\u548c\u88c5\u9970\u5668\u7684\u63a5\u53e3\u7ea6\u5b9a\u6709\u4e00\u5b9a\u4e86\u89e3\u3002(\u53c2\u89c1http://betacat.online/posts/python- closure/)</p>"},{"location":"python-decorator/#_3","title":"\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668","text":"<p>\u5047\u8bbe\u6211\u4eec\u524d\u6587\u7684\u88c5\u9970\u5668\u9700\u8981\u5b8c\u6210\u7684\u529f\u80fd\u4e0d\u4ec5\u4ec5\u662f\u80fd\u5728\u8fdb\u5165\u67d0\u4e2a\u51fd\u6570\u540e\u6253\u51fa log \u4fe1\u606f\uff0c\u800c\u4e14\u8fd8\u9700\u6307\u5b9a log \u7684\u7ea7\u522b\uff0c\u90a3\u4e48\u88c5\u9970\u5668\u5c31\u4f1a\u662f\u8fd9\u6837\u7684\u3002</p> <pre><code>def debug(func):\ndef logging(level):\n   def wrapper(func):\n       def inner_wrapper(*args, **kwargs):\n           print \"[{level}]: enter function {func}()\".format(\n               level=level,\n               func=func.__name__)            \n           return func(*args, **kwargs)        \n       return inner_wrapper    \n   return wrapper\n\n@logging(level='INFO')\ndef say(something):\n   print \"say {}!\".format(something)\n\n@logging(level='DEBUG')\ndef do(something):\n   print \"do {}...\".format(something)\n\nif __name__ == '__main__':\n   say('hello')\n   do(\"my work\")\n</code></pre> <p>\u662f\u4e0d\u662f\u6709\u4e00\u4e9b\u6655\uff1f\u4f60\u53ef\u4ee5\u8fd9\u4e48\u7406\u89e3\uff0c\u5f53\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\u88ab\u6253\u5728\u67d0\u4e2a\u51fd\u6570\u4e0a\u65f6\uff0c\u6bd4\u5982 <code>@ logging ( level =' DEBUG ')</code> \uff0c\u5b83\u5176\u5b9e\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u4f1a\u9a6c\u4e0a\u88ab\u6267\u884c\uff0c\u53ea\u8981\u8fd9\u4e2a\u5b83\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u88c5\u9970\u5668\u65f6\uff0c\u90a3\u5c31\u6ca1\u95ee\u9898\u3002\u7ec6\u7ec6\u518d\u4f53\u4f1a\u4e00\u4e0b\u3002</p>"},{"location":"python-decorator/#_4","title":"\u57fa\u4e8e\u7c7b\u5b9e\u73b0\u7684\u88c5\u9970\u5668","text":"<p>\u88c5\u9970\u5668\u51fd\u6570\u5176\u5b9e\u662f\u8fd9\u6837\u4e00\u4e2a\u63a5\u53e3\u7ea6\u675f\uff0c\u5b83\u5fc5\u987b\u63a5\u53d7\u4e00\u4e2a callable \u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\uff0c\u7136\u540e\u8fd4\u56de\u4e00\u4e2a callable \u5bf9\u8c61\u3002\u5728 Python \u4e2d\u4e00\u822c callable \u5bf9\u8c61\u90fd\u662f\u51fd\u6570\uff0c\u4f46\u4e5f\u6709\u4f8b\u5916\u3002\u53ea\u8981\u67d0\u4e2a\u5bf9\u8c61\u91cd\u8f7d\u4e86 <code>__call__ ()</code> \u65b9\u6cd5\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u662f callable \u7684\u3002</p> <pre><code>class Test():\n   def __call__(self):\n       print 'call me!'t = Test()\nt()  # call me\n</code></pre> <p>\u50cf <code>__call__</code> \u8fd9\u6837\u524d\u540e\u90fd\u5e26\u4e0b\u5212\u7ebf\u7684\u65b9\u6cd5\u5728 Python \u4e2d\u88ab\u79f0\u4e3a\u5185\u7f6e\u65b9\u6cd5\uff0c\u6709\u65f6\u5019\u4e5f\u88ab\u79f0\u4e3a\u9b54\u6cd5\u65b9\u6cd5\u3002\u91cd\u8f7d\u8fd9\u4e9b\u9b54\u6cd5\u65b9\u6cd5\u4e00\u822c\u4f1a\u6539\u53d8\u5bf9\u8c61\u7684\u5185\u90e8\u884c\u4e3a\u3002\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u5c31\u8ba9\u4e00\u4e2a\u7c7b\u5bf9\u8c61\u62e5\u6709\u4e86\u88ab\u8c03\u7528\u7684\u884c\u4e3a\u3002</p> <p>\u56de\u5230\u88c5\u9970\u5668\u4e0a\u7684\u6982\u5ff5\u4e0a\u6765\uff0c\u88c5\u9970\u5668\u8981\u6c42\u63a5\u53d7\u4e00\u4e2a callable \u5bf9\u8c61\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a callable \u5bf9\u8c61\uff08\u4e0d\u592a\u4e25\u8c28\uff0c\u8be6\u89c1\u540e\u6587\uff09\u3002\u90a3\u4e48\u7528\u7c7b\u6765\u5b9e\u73b0\u4e5f\u662f\u4e5f\u53ef\u4ee5\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u8ba9\u7c7b\u7684\u6784\u9020\u51fd\u6570 <code>__init__ ()</code> \u63a5\u53d7\u4e00\u4e2a\u51fd\u6570\uff0c\u7136\u540e\u91cd\u8f7d <code>__call__ ()</code> \u5e76\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\uff0c\u4e5f\u53ef\u4ee5\u8fbe\u5230\u88c5\u9970\u5668\u51fd\u6570\u7684\u6548\u679c\u3002</p> <pre><code>class logging(object):\n   def __init__(self, func):\n       self.func = func    \n   def __call__(self, *args, **kwargs):\n       print \"[DEBUG]: enter function {func}()\".format(\n           func=self.func.__name__)        \n       return self.func(*args, **kwargs)\n\n@logging\ndef say(something):\n   print \"say {}!\".format(something)\n</code></pre>"},{"location":"python-decorator/#_5","title":"\u5e26\u53c2\u6570\u7684\u7c7b\u88c5\u9970\u5668","text":"<p>\u5982\u679c\u9700\u8981\u901a\u8fc7\u7c7b\u5f62\u5f0f\u5b9e\u73b0\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\uff0c\u90a3\u4e48\u4f1a\u6bd4\u524d\u9762\u7684\u4f8b\u5b50\u7a0d\u5fae\u590d\u6742\u4e00\u70b9\u3002\u90a3\u4e48\u5728\u6784\u9020\u51fd\u6570\u91cc\u63a5\u53d7\u7684\u5c31\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u800c\u662f\u4f20\u5165\u7684\u53c2\u6570\u3002\u901a\u8fc7\u7c7b\u628a\u8fd9\u4e9b\u53c2\u6570\u4fdd\u5b58\u8d77\u6765\u3002\u7136\u540e\u5728\u91cd\u8f7d <code>__call__</code> \u65b9\u6cd5\u662f\u5c31\u9700\u8981\u63a5\u53d7\u4e00\u4e2a\u51fd\u6570\u5e76\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\u3002</p> <pre><code>class logging(object):\n   def __init__(self, level='INFO'):\n       self.level = level    \n   def __call__(self, func):  # \u63a5\u53d7\u51fd\u6570\n       def wrapper(*args, **kwargs):\n           print \"[{level}]: enter function {func}()\".format(\n               level=self.level,\n               func=func.__name__)\n           func(*args, **kwargs)        \n           return wrapper  # \u8fd4\u56de\u51fd\u6570\n\n@logging(level='INFO')\ndef say(something):\n   print \"say {}!\".format(something)\n</code></pre>"},{"location":"python-decorator/#_6","title":"\u5185\u7f6e\u7684\u88c5\u9970\u5668","text":"<p>\u5185\u7f6e\u7684\u88c5\u9970\u5668\u548c\u666e\u901a\u7684\u88c5\u9970\u5668\u539f\u7406\u662f\u4e00\u6837\u7684\uff0c\u53ea\u4e0d\u8fc7\u8fd4\u56de\u7684\u4e0d\u662f\u51fd\u6570\uff0c\u800c\u662f\u7c7b\u5bf9\u8c61\uff0c\u6240\u4ee5\u66f4\u96be\u7406\u89e3\u4e00\u4e9b\u3002</p>"},{"location":"python-decorator/#property","title":"@ property","text":"<p>\u5728\u4e86\u89e3\u8fd9\u4e2a\u88c5\u9970\u5668\u524d\uff0c\u4f60\u9700\u8981\u77e5\u9053\u5728\u4e0d\u4f7f\u7528\u88c5\u9970\u5668\u600e\u4e48\u5199\u4e00\u4e2a\u5c5e\u6027\u3002</p> <pre><code>def getx(self):\n   return self._x\ndef setx(self, value):\n   self._x = value\ndef delx(self):\n   del self._x# create a property\nx = property(getx, setx, delx, \"I am doc for x property\")\n</code></pre> <p>\u4ee5\u4e0a\u5c31\u662f\u4e00\u4e2aPython\u5c5e\u6027\u7684\u6807\u51c6\u5199\u6cd5\uff0c\u5176\u5b9e\u548cJava\u633a\u50cf\u7684\uff0c\u80fd\u8fbe\u5230\u4e00\u6837\u7684\u6548\u679c\u4f46\u770b\u8d77\u6765\u66f4\u7b80\u5355\u3002</p> <pre><code>@property\ndef x(self): ...\n# \u7b49\u540c\u4e8e\ndef x(self): ...\nx = property(x)\n</code></pre> <p>\u5c5e\u6027\u6709\u4e09\u4e2a\u88c5\u9970\u5668\uff1a <code>setter</code> , <code>getter</code> , <code>deleter</code> \uff0c\u90fd\u662f\u5728 <code>property ()</code> \u7684\u57fa\u7840\u4e0a\u505a\u4e86\u4e00\u4e9b\u5c01\u88c5\uff0c\u56e0\u4e3a <code>setter</code> \u548c <code>deleter</code> \u662f <code>property ()</code> \u7684\u7b2c\u4e8c\u548c\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c<code>getter</code> \u88c5\u9970\u5668\u548c\u4e0d\u5e26 <code>getter</code> \u7684\u5c5e\u6027\u88c5\u9970\u5668\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u4f30\u8ba1\u53ea\u662f\u4e3a\u4e86\u51d1\u6570\uff0c\u672c\u8eab\u6ca1\u6709\u4efb\u4f55\u5b58\u5728\u7684\u610f\u4e49\u3002\u7ecf\u8fc7 <code>@ property</code> \u88c5\u9970\u8fc7\u7684\u51fd\u6570\u8fd4\u56de\u7684\u4e0d\u518d\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u800c\u662f\u4e00\u4e2a <code>property</code> \u5bf9\u8c61\u3002</p> <pre><code>&gt;&gt;&gt; property()\n&lt;property object at 0x10ff07940 &gt;\n</code></pre>"},{"location":"python-decorator/#classmethod","title":"@ classmethod","text":"<p>\u6709\u4e86 <code>@ property</code> \u88c5\u9970\u5668\u7684\u4e86\u89e3\uff0c\u8fd9\u4e24\u4e2a\u88c5\u9970\u5668\u7684\u539f\u7406\u662f\u5dee\u4e0d\u591a\u7684\u3002 <code>@ staticmethod</code> \u8fd4\u56de\u7684\u662f\u4e00\u4e2a <code>staticmethod</code> \u7c7b\u5bf9\u8c61\uff0c\u800c <code>@ classmethod</code> \u8fd4\u56de\u7684\u662f\u4e00\u4e2a <code>classmethod</code> \u7c7b\u5bf9\u8c61\u3002\u4ed6\u4eec\u90fd\u662f\u8c03\u7528\u7684\u662f\u5404\u81ea\u7684 <code>__init__ ()</code> \u6784\u9020\u51fd\u6570\u3002</p> <pre><code>class classmethod(object):\n   \"\"\"\n   classmethod(function) -&gt; method\n   \"\"\"\n   def __init__(self, function):  # for @classmethod decorator\n       pass\n   # ...\nclass staticmethod(object):\n   \"\"\"\n   staticmethod(function) -&gt; method\n   \"\"\"\n   def __init__(self, function):  # for @staticmethod decorator\n       pass\n   # ...\nclass Foo(object):\n   @staticmethod\n   def bar():\n       pass\n   # \u7b49\u540c\u4e8e bar = staticmethod(bar)\n</code></pre> <p>\u81f3\u6b64\uff0c\u6211\u4eec\u4e0a\u6587\u63d0\u5230\u7684\u88c5\u9970\u5668\u63a5\u53e3\u5b9a\u4e49\u53ef\u4ee5\u66f4\u52a0\u660e\u786e\u4e00\u4e9b\uff0c\u88c5\u9970\u5668\u5fc5\u987b\u63a5\u53d7\u4e00\u4e2a callable \u5bf9\u8c61\uff0c\u5176\u5b9e\u5b83\u5e76\u4e0d\u5173\u5fc3\u4f60\u8fd4\u56de\u4ec0\u4e48\uff0c\u53ef\u4ee5\u662f\u53e6\u5916\u4e00\u4e2a callable \u5bf9\u8c61\uff08\u5927\u90e8\u5206\u60c5\u51b5\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u7c7b\u5bf9\u8c61\uff0c\u6bd4\u5982 property \u3002</p>"},{"location":"python-decorator/#_7","title":"\u88c5\u9970\u5668\u91cc\u7684\u90a3\u4e9b\u5751","text":"<p>\u88c5\u9970\u5668\u53ef\u4ee5\u8ba9\u4f60\u4ee3\u7801\u66f4\u52a0\u4f18\u96c5\uff0c\u51cf\u5c11\u91cd\u590d\uff0c\u4f46\u4e5f\u4e0d\u5168\u662f\u4f18\u70b9\uff0c\u4e5f\u4f1a\u5e26\u6765\u4e00\u4e9b\u95ee\u9898\u3002</p>"},{"location":"python-decorator/#_8","title":"\u4f4d\u7f6e\u9519\u8bef\u7684\u4ee3\u7801","text":"<p>\u8ba9\u6211\u4eec\u76f4\u63a5\u770b\u793a\u4f8b\u4ee3\u7801\u3002</p> <pre><code>def html_tags(tag_name):\n   print 'begin outer function.'\n   def wrapper_(func):\n       print \"begin of inner wrapper function.\"\n       def wrapper(*args, **kwargs):\n           content = func(*args, **kwargs)            \n           print \"&lt;{tag}&gt;{content}&lt;/{tag}&gt;\".format(tag=tag_name, content=content)               print 'end of inner wrapper function.'\n       return wrapper    \n   print 'end of outer function'\n   return wrapper_@html_tags('b')\n\ndef hello(name='Toby'):\n   return 'Hello {}!'.format(name)\nhello()\nhello()\n</code></pre> <p>\u5728\u88c5\u9970\u5668\u4e2d\u6211\u5728\u5404\u4e2a\u53ef\u80fd\u7684\u4f4d\u7f6e\u90fd\u52a0\u4e0a\u4e86 print \u8bed\u53e5\uff0c\u7528\u4e8e\u8bb0\u5f55\u88ab\u8c03\u7528\u7684\u60c5\u51b5\u3002\u4f60\u77e5\u9053\u4ed6\u4eec\u6700\u540e\u6253\u5370\u51fa\u6765\u7684\u987a\u5e8f\u5417\uff1f\u5982\u679c\u4f60\u5fc3\u91cc\u6ca1\u5e95\uff0c\u90a3\u4e48\u6700\u597d\u4e0d\u8981\u5728\u88c5\u9970\u5668\u51fd\u6570\u4e4b\u5916\u6dfb\u52a0\u903b\u8f91\u529f\u80fd\uff0c\u5426\u5219\u8fd9\u4e2a\u88c5\u9970\u5668\u5c31\u4e0d\u53d7\u4f60\u63a7\u5236\u4e86\u3002\u4ee5\u4e0b\u662f\u8f93\u51fa\u7ed3\u679c\uff1a</p> <pre><code>begin outer function.\nend of outer function\nbegin of inner wrapper function.\nend of inner wrapper function.\n&lt;b &gt; Hello Toby!&lt; /b &gt;\n&lt;b &gt; Hello Toby!&lt; /b &gt;\n</code></pre>"},{"location":"python-decorator/#_9","title":"\u9519\u8bef\u7684\u51fd\u6570\u7b7e\u540d\u548c\u6587\u6863","text":"<p>\u88c5\u9970\u5668\u88c5\u9970\u8fc7\u7684\u51fd\u6570\u770b\u4e0a\u53bb\u540d\u5b57\u6ca1\u53d8\uff0c\u5176\u5b9e\u5df2\u7ecf\u53d8\u4e86\u3002</p> <pre><code>def logging(func):\n   def wrapper(*args, **kwargs):\n       \"\"\"print log before a function.\"\"\"\n       print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__)        \n       return func(*args, **kwargs)    \n   return wrapper\n\n@logging\ndef say(something):\n   \"\"\"say something\"\"\"\n   print \"say {}!\".format(something)\nprint say.__name__  # wrapper\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\u5462\uff1f@\u7b49\u540c\u4e8e\u8fd9\u6837\u7684\u5199\u6cd5\u3002</p> <pre><code>say = logging(say)\n</code></pre> <p><code>logging</code> \u5176\u5b9e\u8fd4\u56de\u7684\u51fd\u6570\u540d\u5b57\u521a\u597d\u662f <code>wrapper</code> \uff0c\u90a3\u4e48\u4e0a\u9762\u7684\u8fd9\u4e2a\u8bed\u53e5\u521a\u597d\u5c31\u662f\u628a\u8fd9\u4e2a\u7ed3\u679c\u8d4b\u503c\u7ed9 <code>say</code> \uff0c <code>say</code> \u7684 <code>__name__</code> \u81ea\u7136\u4e5f\u5c31\u662f <code>wrapper</code> \u4e86\uff0c\u4e0d\u4ec5\u4ec5\u662f <code>name</code> \uff0c\u5176\u4ed6\u5c5e\u6027\u4e5f\u90fd\u662f\u6765\u81ea <code>wrapper</code> \uff0c\u6bd4\u5982 <code>doc</code> \uff0c <code>source</code> \u7b49\u7b49\u3002</p> <p>\u4f7f\u7528\u6807\u51c6\u5e93\u91cc\u7684 functools.wraps \uff0c\u53ef\u4ee5\u57fa\u672c\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <pre><code>from functools import wrapsdef logging(func):\n   @wraps(func)\n   def wrapper(*args, **kwargs):\n       \"\"\"print log before a function.\"\"\"\n       print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__)        \n       return func(*args, **kwargs)    \n   return wrapper\n\n@logging\ndef say(something):\n   \"\"\"say something\"\"\"\n\n   print \"say {}!\".format(something)\n   print say.__name__  # say\n   print say.__doc__  # say something\n</code></pre> <p>\u770b\u4e0a\u53bb\u4e0d\u9519\uff01\u4e3b\u8981\u95ee\u9898\u89e3\u51b3\u4e86\uff0c\u4f46\u5176\u5b9e\u8fd8\u4e0d\u592a\u5b8c\u7f8e\u3002\u56e0\u4e3a\u51fd\u6570\u7684\u7b7e\u540d\u548c\u6e90\u7801\u8fd8\u662f\u62ff\u4e0d\u5230\u7684\u3002</p> <pre><code>import inspect\nprint inspect.getargspec(say)  # failed\nprint inspect.getsource(say)  # failed\n</code></pre> <p>\u5982\u679c\u8981\u5f7b\u5e95\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u501f\u7528\u7b2c\u4e09\u65b9\u5305\uff0c\u6bd4\u5982 <code>wrapt</code> \u3002\u540e\u6587\u6709\u4ecb\u7ecd\u3002</p>"},{"location":"python-decorator/#staticmethod-classmethod","title":"\u4e0d\u80fd\u88c5\u9970@staticmethod \u6216\u8005 @classmethod","text":"<p>\u5f53\u4f60\u60f3\u628a\u88c5\u9970\u5668\u7528\u5728\u4e00\u4e2a\u9759\u6001\u65b9\u6cd5\u6216\u8005\u7c7b\u65b9\u6cd5\u65f6\uff0c\u4e0d\u597d\u610f\u601d\uff0c\u62a5\u9519\u4e86\u3002</p> <pre><code>class Car(object):\n\n   def __init__(self, model):\n       self.model = model    \n\n   @logging  # \u88c5\u9970\u5b9e\u4f8b\u65b9\u6cd5\uff0cOK\n   def run(self):\n       print \"{} is running!\".format(self.model)    \n\n   @logging  # \u88c5\u9970\u9759\u6001\u65b9\u6cd5\uff0cFailed\n   @staticmethod\n   def check_model_for(obj):\n       if isinstance(obj, Car):            \n           print \"The model of your car is {}\".format(obj.model)        \n       else:            \n           print \"{} is not a car!\".format(obj)     \n\"\"\"\nTraceback (most recent call last):\n...\n File \"example_4.py\", line 10, in logging\n\n   @wraps(func)\n File \"C:\\Python27\\lib\\functools.py\", line 33, in update_wrapper\n\n   setattr(wrapper, attr, getattr(wrapped, attr))\nAttributeError: 'staticmethod' object has no attribute '__module__'\n\n\"\"\"\n</code></pre> <p>\u524d\u9762\u5df2\u7ecf\u89e3\u91ca\u4e86 <code>@ staticmethod</code> \u8fd9\u4e2a\u88c5\u9970\u5668\uff0c\u5176\u5b9e\u5b83\u8fd4\u56de\u7684\u5e76\u4e0d\u662f\u4e00\u4e2a <code>callable</code> \u5bf9\u8c61\uff0c\u800c\u662f\u4e00\u4e2a <code>staticmethod</code> \u5bf9\u8c61\uff0c\u90a3\u4e48\u5b83\u662f\u4e0d\u7b26\u5408\u88c5\u9970\u5668\u8981\u6c42\u7684\uff08\u6bd4\u5982\u4f20\u5165\u4e00\u4e2a callable \u5bf9\u8c61\uff09\uff0c\u4f60\u81ea\u7136\u4e0d\u80fd\u5728\u5b83\u4e4b\u4e0a\u518d\u52a0\u522b\u7684\u88c5\u9970\u5668\u3002\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5f88\u7b80\u5355\uff0c\u53ea\u8981\u628a\u4f60\u7684\u88c5\u9970\u5668\u653e\u5728 <code>@ staticmethod</code> \u4e4b\u524d\u5c31\u597d\u4e86\uff0c\u56e0\u4e3a\u4f60\u7684\u88c5\u9970\u5668\u8fd4\u56de\u7684\u8fd8\u662f\u4e00\u4e2a\u6b63\u5e38\u7684\u51fd\u6570\uff0c\u7136\u540e\u518d\u52a0\u4e0a\u4e00\u4e2a <code>@ staticmethod</code> \u662f\u4e0d\u4f1a\u51fa\u95ee\u9898\u7684\u3002</p> <pre><code>class Car(object):\n   def __init__(self, model):\n       self.model = model    \n\n   @staticmethod\n   @logging  \n   def check_model_for(obj):\n       pass\n</code></pre>"},{"location":"python-decorator/#_10","title":"\u5982\u4f55\u4f18\u5316\u4f60\u7684\u88c5\u9970\u5668","text":"<p>\u5d4c\u5957\u7684\u88c5\u9970\u51fd\u6570\u4e0d\u592a\u76f4\u89c2\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e09\u65b9\u5305\u7c7b\u6539\u8fdb\u8fd9\u6837\u7684\u60c5\u51b5\uff0c\u8ba9\u88c5\u9970\u5668\u51fd\u6570\u53ef\u8bfb\u6027\u66f4\u597d\u3002</p>"},{"location":"python-decorator/#decoratorpy","title":"decorator.py","text":"<p><code>decorator.py</code>\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u88c5\u9970\u5668\u52a0\u5f3a\u5305\u3002\u4f60\u53ef\u4ee5\u5f88\u76f4\u89c2\u7684\u5148\u5b9a\u4e49\u5305\u88c5\u51fd\u6570 <code>wrapper ()</code> \uff0c\u518d\u4f7f\u7528 <code>decorate ( func , wrapper )</code> \u65b9\u6cd5\u5c31\u53ef\u4ee5\u5b8c\u6210\u4e00\u4e2a\u88c5\u9970\u5668\u3002</p> <pre><code>from decorator import decorate\ndef wrapper(func, *args, **kwargs):\n   \"\"\"print log before a function.\"\"\"\n   print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__)    \n   return func(*args, **kwargs)\n\ndef logging(func):\n   return decorate(func, wrapper)  # \u7528wrapper\u88c5\u9970func\n</code></pre> <p>\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5b83\u81ea\u5e26\u7684 <code>@ decorator</code> \u88c5\u9970\u5668\u6765\u5b8c\u6210\u4f60\u7684\u88c5\u9970\u5668\u3002</p> <pre><code>from decorator import decorator\n@decorator\ndef logging(func, *args, **kwargs):\n   print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__)    \n   return func(*args, **kwargs)\n</code></pre> <p><code>decorator.py</code> \u5b9e\u73b0\u7684\u88c5\u9970\u5668\u80fd\u5b8c\u6574\u4fdd\u7559\u539f\u51fd\u6570\u7684 <code>name</code> \uff0c <code>doc</code> \u548c <code>args</code> \uff0c\u552f\u4e00\u6709\u95ee\u9898\u7684\u5c31\u662f <code>inspect.getsource ( func )</code> \u8fd4\u56de\u7684\u8fd8\u662f\u88c5\u9970\u5668\u7684\u6e90\u4ee3\u7801\uff0c\u4f60\u9700\u8981\u6539\u6210 <code>inspect.getsource ( func.__wrapped__ )</code> \u3002</p>"},{"location":"python-decorator/#wrapt","title":"wrapt","text":"<p><code>wrapt</code>\u662f\u4e00\u4e2a\u529f\u80fd\u975e\u5e38\u5b8c\u5584\u7684\u5305\uff0c\u7528\u4e8e\u5b9e\u73b0\u5404\u79cd\u4f60\u60f3\u5230\u6216\u8005\u4f60\u6ca1\u60f3\u5230\u7684\u88c5\u9970\u5668\u3002\u4f7f\u7528 wrapt \u5b9e\u73b0\u7684\u88c5\u9970\u5668\u4f60\u4e0d\u9700\u8981\u62c5\u5fc3\u4e4b\u524d inspect \u4e2d\u9047\u5230\u7684\u6240\u6709\u95ee\u9898\uff0c\u56e0\u4e3a\u5b83\u90fd\u5e2e\u4f60\u5904\u7406\u4e86\uff0c\u751a\u81f3 <code>inspect.getsource ( func )</code> \u4e5f\u51c6\u786e\u65e0\u8bef\u3002</p> <pre><code>import wrapt# without argument in decorator\n\n@wrapt.decorator\ndef logging(wrapped, instance, args, kwargs):  # instance is must\n   print \"[DEBUG]: enter {}()\".format(wrapped.__name__)    \n   return wrapped(*args, **kwargs)\n\n@logging\ndef say(something): pass\n</code></pre> <p>\u4f7f\u7528 <code>wrapt</code> \u4f60\u53ea\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u88c5\u9970\u5668\u51fd\u6570\uff0c\u4f46\u662f\u51fd\u6570\u7b7e\u540d\u662f\u56fa\u5b9a\u7684\uff0c\u5fc5\u987b\u662f <code>( wrapped , instance, args, kwargs )</code> \uff0c\u6ce8\u610f\u7b2c\u4e8c\u4e2a\u53c2\u6570 <code>instance</code> \u662f\u5fc5\u987b\u7684\uff0c\u5c31\u7b97\u4f60\u4e0d\u7528\u5b83\u3002\u5f53\u88c5\u9970\u5668\u88c5\u9970\u5728\u4e0d\u540c\u4f4d\u7f6e\u65f6\u5b83\u5c06\u5f97\u5230\u4e0d\u540c\u7684\u503c\uff0c\u6bd4\u5982\u88c5\u9970\u5728\u7c7b\u5b9e\u4f8b\u65b9\u6cd5\u65f6\u4f60\u53ef\u4ee5\u62ff\u5230\u8fd9\u4e2a\u7c7b\u5b9e\u4f8b\u3002\u6839\u636e <code>instance</code> \u7684\u503c\u4f60\u80fd\u591f\u66f4\u52a0\u7075\u6d3b\u7684\u8c03\u6574\u4f60\u7684\u88c5\u9970\u5668\u3002\u53e6\u5916\uff0c <code>args</code> \u548c <code>kwargs</code> \u4e5f\u662f\u56fa\u5b9a\u7684\uff0c\u6ce8\u610f\u524d\u9762\u6ca1\u6709\u661f\u53f7\u3002\u5728\u88c5\u9970\u5668\u5185\u90e8\u8c03\u7528\u539f\u51fd\u6570\u65f6\u624d\u5e26\u661f\u53f7\u3002</p> <p>\u5982\u679c\u4f60\u9700\u8981\u4f7f\u7528 wrapt \u5199\u4e00\u4e2a\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\uff0c\u53ef\u4ee5\u8fd9\u6837\u5199\u3002</p> <pre><code>def logging(level):\n   @wrapt.decorator\n   def wrapper(wrapped, instance, args, kwargs):\n       print \"[{}]: enter {}()\".format(level, wrapped.__name__)        \n       return wrapped(*args, **kwargs)    \n   return wrapper@logging(level=\"INFO\")\n\ndef do(work): pass\n</code></pre> <p>\u5173\u4e8e wrapt \u7684\u4f7f\u7528\uff0c\u5efa\u8bae\u67e5\u9605\u5b98\u65b9\u6587\u6863\uff0c\u5728\u6b64\u4e0d\u5728\u8d58\u8ff0\u3002 http://wrapt.readthedocs.io/en/latest/quick-start.html</p>"},{"location":"python-decorator/#_11","title":"\u5c0f\u7ed3","text":"<p>Python \u7684\u88c5\u9970\u5668\u548c Java \u7684\u6ce8\u89e3\uff08 Annotation \uff09\u5e76\u4e0d\u662f\u540c\u4e00\u56de\u4e8b\uff0c\u548c C# \u4e2d\u7684\u7279\u6027\uff08 Attribute \uff09\u4e5f\u4e0d\u4e00\u6837\uff0c\u5b8c\u5168\u662f\u4e24\u4e2a\u6982\u5ff5\u3002</p> <p>\u88c5\u9970\u5668\u7684\u7406\u5ff5\u662f\u5bf9\u539f\u51fd\u6570\u3001\u5bf9\u8c61\u7684\u52a0\u5f3a\uff0c\u76f8\u5f53\u4e8e\u91cd\u65b0\u5c01\u88c5\uff0c\u6240\u4ee5\u4e00\u822c\u88c5\u9970\u5668\u51fd\u6570\u90fd\u88ab\u547d\u540d\u4e3a <code>wrapper ()</code> \uff0c\u610f\u4e49\u5728\u4e8e\u5305\u88c5\u3002\u51fd\u6570\u53ea\u6709\u5728\u88ab\u8c03\u7528\u65f6\u624d\u4f1a\u53d1\u6325\u5176\u4f5c\u7528\u3002\u6bd4\u5982 <code>@ logging</code> \u88c5\u9970\u5668\u53ef\u4ee5\u5728\u51fd\u6570\u6267\u884c\u65f6\u989d\u5916\u8f93\u51fa\u65e5\u5fd7\uff0c <code>@ cache</code> \u88c5\u9970\u8fc7\u7684\u51fd\u6570\u53ef\u4ee5\u7f13\u5b58\u8ba1\u7b97\u7ed3\u679c\u7b49\u7b49\u3002</p> <p>\u800c\u6ce8\u89e3\u548c\u7279\u6027\u5219\u662f\u5bf9\u76ee\u6807\u51fd\u6570\u6216\u5bf9\u8c61\u6dfb\u52a0\u4e00\u4e9b\u5c5e\u6027\uff0c\u76f8\u5f53\u4e8e\u5c06\u5176\u5206\u7c7b\u3002\u8fd9\u4e9b\u5c5e\u6027\u53ef\u4ee5\u901a\u8fc7\u53cd\u5c04\u62ff\u5230\uff0c\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u5bf9\u4e0d\u540c\u7684\u7279\u6027\u51fd\u6570\u6216\u5bf9\u8c61\u52a0\u4ee5\u5e72\u9884\u3002\u6bd4\u5982\u5e26\u6709 <code>Setup</code> \u7684\u51fd\u6570\u5c31\u5f53\u6210\u51c6\u5907\u6b65\u9aa4\u6267\u884c\uff0c\u6216\u8005\u627e\u5230\u6240\u6709\u5e26\u6709 <code>TestMethod</code> \u7684\u51fd\u6570\u4f9d\u6b21\u6267\u884c\u7b49\u7b49\u3002</p> <p>\u81f3\u6b64\u6211\u6240\u4e86\u89e3\u7684\u88c5\u9970\u5668\u5df2\u7ecf\u8bb2\u5b8c\uff0c\u4f46\u662f\u8fd8\u6709\u4e00\u4e9b\u5185\u5bb9\u6ca1\u6709\u63d0\u5230\uff0c\u6bd4\u5982\u88c5\u9970\u7c7b\u7684\u88c5\u9970\u5668\u3002\u6709\u673a\u4f1a\u518d\u8865\u5145\u3002\u8c22\u8c22\u89c2\u770b\u3002</p> <p>\u672c\u6587\u6e90\u7801 &lt;https://github.com/tobyqin/python_decorator</p>"},{"location":"python-dunder/","title":"Python\u4e2d\u4e0b\u5212\u7ebf\u76845\u79cd\u542b\u4e49","text":"<p>\u672c\u6587\u4ecb\u7ecd\u4e86Python\u4e2d\u5355\u4e0b\u5212\u7ebf\u548c\u53cc\u4e0b\u5212\u7ebf\uff08\"dunder\"\uff09\u7684\u5404\u79cd\u542b\u4e49\u548c\u547d\u540d\u7ea6\u5b9a\uff0c\u540d\u79f0\u4fee\u9970\uff08name mangling\uff09\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u4ee5\u53ca\u5b83\u5982\u4f55\u5f71\u54cd\u4f60\u81ea\u5df1\u7684Python\u7c7b\u3002</p> <p>\u5355\u4e0b\u5212\u7ebf\u548c\u53cc\u4e0b\u5212\u7ebf\u5728Python\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u79f0\u4e2d\u90fd\u5404\u6709\u5176\u542b\u4e49\u3002\u6709\u4e00\u4e9b\u542b\u4e49\u4ec5\u4ec5\u662f\u4f9d\u7167\u7ea6\u5b9a\uff0c\u88ab\u89c6\u4f5c\u662f\u5bf9\u7a0b\u5e8f\u5458\u7684\u63d0\u793a - \u800c\u6709\u4e00\u4e9b\u542b\u4e49\u662f\u7531Python\u89e3\u91ca\u5668\u4e25\u683c\u6267\u884c\u7684\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u77e5\u9053\u201cPython\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u79f0\u4e2d\u5355\u4e0b\u5212\u7ebf\u548c\u53cc\u4e0b\u5212\u7ebf\u7684\u542b\u4e49\u662f\u4ec0\u4e48\uff1f\u201d\uff0c\u6211\u4f1a\u5c3d\u6211\u6240\u80fd\u5728\u8fd9\u91cc\u4e3a\u4f60\u89e3\u7b54\u3002</p> <p>\u5728\u672c\u6587\u4e2d\uff0c\u6211\u5c06\u8ba8\u8bba\u4ee5\u4e0b\u4e94\u79cd\u4e0b\u5212\u7ebf\u6a21\u5f0f\u548c\u547d\u540d\u7ea6\u5b9a\uff0c\u4ee5\u53ca\u5b83\u4eec\u5982\u4f55\u5f71\u54cdPython\u7a0b\u5e8f\u7684\u884c\u4e3a\uff1a</p> <ul> <li>\u5355\u524d\u5bfc\u4e0b\u5212\u7ebf\uff1a_var</li> <li>\u5355\u672b\u5c3e\u4e0b\u5212\u7ebf\uff1avar_</li> <li>\u53cc\u524d\u5bfc\u4e0b\u5212\u7ebf\uff1a__var</li> <li>\u53cc\u524d\u5bfc\u548c\u672b\u5c3e\u4e0b\u5212\u7ebf\uff1a__var__</li> <li>\u5355\u4e0b\u5212\u7ebf\uff1a_</li> </ul> <p>\u5728\u6587\u7ae0\u7ed3\u5c3e\u5904\uff0c\u4f60\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u7b80\u77ed\u7684\u201c\u901f\u67e5\u8868\u201d\uff0c\u603b\u7ed3\u4e86\u4e94\u79cd\u4e0d\u540c\u7684\u4e0b\u5212\u7ebf\u547d\u540d\u7ea6\u5b9a\u53ca\u5176\u542b\u4e49\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7b80\u77ed\u7684\u89c6\u9891\u6559\u7a0b\uff0c\u53ef\u8ba9\u4f60\u4eb2\u8eab\u4f53\u9a8c\u5b83\u4eec\u7684\u884c\u4e3a\u3002</p>"},{"location":"python-dunder/#1-_var","title":"1. \u5355\u524d\u5bfc\u4e0b\u5212\u7ebf _var","text":"<p>\u5f53\u6d89\u53ca\u5230\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u79f0\u65f6\uff0c\u5355\u4e2a\u4e0b\u5212\u7ebf\u524d\u7f00\u6709\u4e00\u4e2a\u7ea6\u5b9a\u4fd7\u6210\u7684\u542b\u4e49\u3002 \u5b83\u662f\u5bf9\u7a0b\u5e8f\u5458\u7684\u4e00\u4e2a\u63d0\u793a - \u610f\u5473\u7740Python\u793e\u533a\u4e00\u81f4\u8ba4\u4e3a\u5b83\u5e94\u8be5\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u4f46\u7a0b\u5e8f\u7684\u884c\u4e3a\u4e0d\u53d7\u5f71\u54cd\u3002</p> <p>\u4e0b\u5212\u7ebf\u524d\u7f00\u7684\u542b\u4e49\u662f\u544a\u77e5\u5176\u4ed6\u7a0b\u5e8f\u5458\uff1a\u4ee5\u5355\u4e2a\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\u53d8\u91cf\u6216\u65b9\u6cd5\u4ec5\u4f9b\u5185\u90e8\u4f7f\u7528\u3002 \u8be5\u7ea6\u5b9a\u5728PEP 8\u4e2d\u6709\u5b9a\u4e49\u3002</p> <p>\u8fd9\u4e0d\u662fPython\u5f3a\u5236\u89c4\u5b9a\u7684\u3002 Python\u4e0d\u50cfJava\u90a3\u6837\u5728\u201c\u79c1\u6709\u201d\u548c\u201c\u516c\u5171\u201d\u53d8\u91cf\u4e4b\u95f4\u6709\u5f88\u5f3a\u7684\u533a\u522b\u3002 \u8fd9\u5c31\u50cf\u6709\u4eba\u63d0\u51fa\u4e86\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4e0b\u5212\u7ebf\u8b66\u544a\u6807\u5fd7\uff0c\u8bf4\uff1a</p> <p>\u201c\u563f\uff0c\u8fd9\u4e0d\u662f\u771f\u7684\u8981\u6210\u4e3a\u7c7b\u7684\u516c\u5171\u63a5\u53e3\u7684\u4e00\u90e8\u5206\u3002\u4e0d\u53bb\u7ba1\u5b83\u5c31\u597d\u3002\u201c \u770b\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a</p> <pre><code>class Test:\n   def __init__(self):\n       self.foo = 11\n       self._bar = 23\n</code></pre> <p>\u5982\u679c\u4f60\u5b9e\u4f8b\u5316\u6b64\u7c7b\uff0c\u5e76\u5c1d\u8bd5\u8bbf\u95ee\u5728__init__\u6784\u9020\u51fd\u6570\u4e2d\u5b9a\u4e49\u7684foo\u548c_bar\u5c5e\u6027\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\uff1f \u8ba9\u6211\u4eec\u6765\u770b\u770b\uff1a</p> <pre><code>&gt;&gt;&gt; t = Test()\n&gt;&gt;&gt; t.foo\n11\n&gt;&gt;&gt; t._bar\n23\n</code></pre> <p>\u4f60\u4f1a\u770b\u5230_bar\u4e2d\u7684\u5355\u4e2a\u4e0b\u5212\u7ebf\u5e76\u6ca1\u6709\u963b\u6b62\u6211\u4eec\u201c\u8fdb\u5165\u201d\u7c7b\u5e76\u8bbf\u95ee\u8be5\u53d8\u91cf\u7684\u503c\u3002 \u8fd9\u662f\u56e0\u4e3aPython\u4e2d\u7684\u5355\u4e2a\u4e0b\u5212\u7ebf\u524d\u7f00\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7ea6\u5b9a - \u81f3\u5c11\u76f8\u5bf9\u4e8e\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u800c\u8a00\u3002</p> <p>\u4f46\u662f\uff0c\u524d\u5bfc\u4e0b\u5212\u7ebf\u7684\u786e\u4f1a\u5f71\u54cd\u4ece\u6a21\u5757\u4e2d\u5bfc\u5165\u540d\u79f0\u7684\u65b9\u5f0f\u3002 </p> <p>\u5047\u8bbe\u4f60\u5728\u4e00\u4e2a\u540d\u4e3amy_module\u7684\u6a21\u5757\u4e2d\u6709\u4ee5\u4e0b\u4ee3\u7801\uff1a</p> <pre><code># This is my_module.py:\n\ndef external_func():\n   return 23\n\ndef _internal_func():\n   return 42\n</code></pre> <p>\u73b0\u5728\uff0c\u5982\u679c\u4f7f\u7528\u901a\u914d\u7b26\u4ece\u6a21\u5757\u4e2d\u5bfc\u5165\u6240\u6709\u540d\u79f0\uff0c\u5219Python\u4e0d\u4f1a\u5bfc\u5165\u5e26\u6709\u524d\u5bfc\u4e0b\u5212\u7ebf\u7684\u540d\u79f0\uff08\u9664\u975e\u6a21\u5757\u5b9a\u4e49\u4e86\u8986\u76d6\u6b64\u884c\u4e3a\u7684__all__\u5217\u8868\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; from my_module import *\n&gt;&gt;&gt; external_func()\n23\n&gt;&gt;&gt; _internal_func()\nNameError: \"name '_internal_func' is not defined\"\n</code></pre> <p>\u987a\u4fbf\u8bf4\u4e00\u4e0b\uff0c\u5e94\u8be5\u907f\u514d\u901a\u914d\u7b26\u5bfc\u5165\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f7f\u540d\u79f0\u7a7a\u95f4\u4e2d\u5b58\u5728\u54ea\u4e9b\u540d\u79f0\u4e0d\u6e05\u695a\u3002 \u4e3a\u4e86\u6e05\u695a\u8d77\u89c1\uff0c\u575a\u6301\u5e38\u89c4\u5bfc\u5165\u66f4\u597d\u3002 \u4e0e\u901a\u914d\u7b26\u5bfc\u5165\u4e0d\u540c\uff0c\u5e38\u89c4\u5bfc\u5165\u4e0d\u53d7\u524d\u5bfc\u5355\u4e2a\u4e0b\u5212\u7ebf\u547d\u540d\u7ea6\u5b9a\u7684\u5f71\u54cd\uff1a</p> <pre><code>&gt;&gt;&gt; import my_module\n&gt;&gt;&gt; my_module.external_func()\n23\n&gt;&gt;&gt; my_module._internal_func()\n42\n</code></pre> <p>\u6211\u77e5\u9053\u8fd9\u4e00\u70b9\u53ef\u80fd\u6709\u70b9\u4ee4\u4eba\u56f0\u60d1\u3002 \u5982\u679c\u4f60\u9075\u5faaPEP 8\u63a8\u8350\uff0c\u907f\u514d\u901a\u914d\u7b26\u5bfc\u5165\uff0c\u90a3\u4e48\u4f60\u771f\u6b63\u9700\u8981\u8bb0\u4f4f\u7684\u53ea\u6709\u8fd9\u4e2a\uff1a</p> <p>\u5355\u4e2a\u4e0b\u5212\u7ebf\u662f\u4e00\u4e2aPython\u547d\u540d\u7ea6\u5b9a\uff0c\u8868\u793a\u8fd9\u4e2a\u540d\u79f0\u662f\u4f9b\u5185\u90e8\u4f7f\u7528\u7684\u3002 \u5b83\u901a\u5e38\u4e0d\u7531Python\u89e3\u91ca\u5668\u5f3a\u5236\u6267\u884c\uff0c\u4ec5\u4ec5\u4f5c\u4e3a\u4e00\u79cd\u5bf9\u7a0b\u5e8f\u5458\u7684\u63d0\u793a\u3002</p>"},{"location":"python-dunder/#2-var_","title":"2. \u5355\u672b\u5c3e\u4e0b\u5212\u7ebf var_","text":"<p>\u6709\u65f6\u5019\uff0c\u4e00\u4e2a\u53d8\u91cf\u7684\u6700\u5408\u9002\u7684\u540d\u79f0\u5df2\u7ecf\u88ab\u4e00\u4e2a\u5173\u952e\u5b57\u6240\u5360\u7528\u3002 \u56e0\u6b64\uff0c\u50cfclass\u6216def\u8fd9\u6837\u7684\u540d\u79f0\u4e0d\u80fd\u7528\u4f5cPython\u4e2d\u7684\u53d8\u91cf\u540d\u79f0\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u4ee5\u9644\u52a0\u4e00\u4e2a\u4e0b\u5212\u7ebf\u6765\u89e3\u51b3\u547d\u540d\u51b2\u7a81\uff1a</p> <pre><code>&gt;&gt;&gt; def make_object(name, class):\nSyntaxError: \"invalid syntax\"\n\n&gt;&gt;&gt; def make_object(name, class_):\n        pass\n</code></pre> <p>\u603b\u4e4b\uff0c\u5355\u4e2a\u672b\u5c3e\u4e0b\u5212\u7ebf\uff08\u540e\u7f00\uff09\u662f\u4e00\u4e2a\u7ea6\u5b9a\uff0c\u7528\u6765\u907f\u514d\u4e0ePython\u5173\u952e\u5b57\u4ea7\u751f\u547d\u540d\u51b2\u7a81\u3002 PEP 8\u89e3\u91ca\u4e86\u8fd9\u4e2a\u7ea6\u5b9a\u3002</p>"},{"location":"python-dunder/#3-__var","title":"3. \u53cc\u524d\u5bfc\u4e0b\u5212\u7ebf __var","text":"<p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u6240\u6d89\u53ca\u7684\u6240\u6709\u547d\u540d\u6a21\u5f0f\u7684\u542b\u4e49\uff0c\u6765\u81ea\u4e8e\u5df2\u8fbe\u6210\u5171\u8bc6\u7684\u7ea6\u5b9a\u3002 \u800c\u5bf9\u4e8e\u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u5934\u7684Python\u7c7b\u7684\u5c5e\u6027\uff08\u5305\u62ec\u53d8\u91cf\u548c\u65b9\u6cd5\uff09\uff0c\u60c5\u51b5\u5c31\u6709\u70b9\u4e0d\u540c\u4e86\u3002</p> <p>\u53cc\u4e0b\u5212\u7ebf\u524d\u7f00\u4f1a\u5bfc\u81f4Python\u89e3\u91ca\u5668\u91cd\u5199\u5c5e\u6027\u540d\u79f0\uff0c\u4ee5\u907f\u514d\u5b50\u7c7b\u4e2d\u7684\u547d\u540d\u51b2\u7a81\u3002</p> <p>\u8fd9\u4e5f\u53eb\u505a\u540d\u79f0\u4fee\u9970\uff08name mangling\uff09 - \u89e3\u91ca\u5668\u66f4\u6539\u53d8\u91cf\u7684\u540d\u79f0\uff0c\u4ee5\u4fbf\u5728\u7c7b\u88ab\u6269\u5c55\u7684\u65f6\u5019\u4e0d\u5bb9\u6613\u4ea7\u751f\u51b2\u7a81\u3002 \u6211\u77e5\u9053\u8fd9\u542c\u8d77\u6765\u5f88\u62bd\u8c61\u3002 \u56e0\u6b64\uff0c\u6211\u7ec4\u5408\u4e86\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4ee3\u7801\u793a\u4f8b\u6765\u4e88\u4ee5\u8bf4\u660e\uff1a</p> <pre><code>class Test:\n   def __init__(self):\n       self.foo = 11\n       self._bar = 23\n       self.__baz = 23\n</code></pre> <p>\u8ba9\u6211\u4eec\u7528\u5185\u7f6e\u7684dir()\u51fd\u6570\u6765\u770b\u770b\u8fd9\u4e2a\u5bf9\u8c61\u7684\u5c5e\u6027\uff1a</p> <pre><code>&gt;&gt;&gt; t = Test()\n&gt;&gt;&gt; dir(t)\n['_Test__baz', '__class__', '__delattr__', '__dict__', '__dir__',\n'__doc__', '__eq__', '__format__', '__ge__', '__getattribute__',\n'__gt__', '__hash__', '__init__', '__le__', '__lt__', '__module__',\n'__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__',\n'__setattr__', '__sizeof__', '__str__', '__subclasshook__',\n'__weakref__', '_bar', 'foo']\n</code></pre> <p>\u4ee5\u4e0a\u662f\u8fd9\u4e2a\u5bf9\u8c61\u5c5e\u6027\u7684\u5217\u8868\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e2a\u5217\u8868\uff0c\u5e76\u5bfb\u627e\u6211\u4eec\u7684\u539f\u59cb\u53d8\u91cf\u540d\u79f0foo\uff0c_bar\u548c__baz - \u6211\u4fdd\u8bc1\u4f60\u4f1a\u6ce8\u610f\u5230\u4e00\u4e9b\u6709\u8da3\u7684\u53d8\u5316\u3002   - self.foo\u53d8\u91cf\u5728\u5c5e\u6027\u5217\u8868\u4e2d\u663e\u793a\u4e3a\u672a\u4fee\u6539\u4e3afoo\u3002   - self._bar\u7684\u884c\u4e3a\u65b9\u5f0f\u76f8\u540c - \u5b83\u4ee5_bar\u7684\u5f62\u5f0f\u663e\u793a\u5728\u7c7b\u4e0a\u3002 \u5c31\u50cf\u6211\u4e4b\u524d\u8bf4\u8fc7\u7684\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u524d\u5bfc\u4e0b\u5212\u7ebf\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7ea6\u5b9a\u3002 \u7ed9\u7a0b\u5e8f\u5458\u4e00\u4e2a\u63d0\u793a\u800c\u5df2\u3002   - \u7136\u800c\uff0c\u5bf9\u4e8eself.__baz\u800c\u8a00\uff0c\u60c5\u51b5\u770b\u8d77\u6765\u6709\u70b9\u4e0d\u540c\u3002 \u5f53\u4f60\u5728\u8be5\u5217\u8868\u4e2d\u641c\u7d22__baz\u65f6\uff0c\u4f60\u4f1a\u770b\u4e0d\u5230\u6709\u8fd9\u4e2a\u540d\u5b57\u7684\u53d8\u91cf\u3002</p> <p>__baz\u51fa\u4ec0\u4e48\u60c5\u51b5\u4e86\uff1f</p> <p>\u5982\u679c\u4f60\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u4f60\u4f1a\u770b\u5230\u6b64\u5bf9\u8c61\u4e0a\u6709\u4e00\u4e2a\u540d\u4e3a_Test__baz\u7684\u5c5e\u6027\u3002 \u8fd9\u5c31\u662fPython\u89e3\u91ca\u5668\u6240\u505a\u7684\u540d\u79f0\u4fee\u9970\u3002 \u5b83\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u9632\u6b62\u53d8\u91cf\u5728\u5b50\u7c7b\u4e2d\u88ab\u91cd\u5199\u3002</p> <p>\u8ba9\u6211\u4eec\u521b\u5efa\u53e6\u4e00\u4e2a\u6269\u5c55Test\u7c7b\u7684\u7c7b\uff0c\u5e76\u5c1d\u8bd5\u91cd\u5199\u6784\u9020\u51fd\u6570\u4e2d\u6dfb\u52a0\u7684\u73b0\u6709\u5c5e\u6027\uff1a</p> <pre><code>class ExtendedTest(Test):\n   def __init__(self):\n       super().__init__()\n       self.foo = 'overridden'\n       self._bar = 'overridden'\n       self.__baz = 'overridden'\n</code></pre> <p>\u73b0\u5728\uff0c\u4f60\u8ba4\u4e3afoo\uff0c_bar\u548c__baz\u7684\u503c\u4f1a\u51fa\u73b0\u5728\u8fd9\u4e2aExtendedTest\u7c7b\u7684\u5b9e\u4f8b\u4e0a\u5417\uff1f \u6211\u4eec\u6765\u770b\u4e00\u770b\uff1a</p> <pre><code>&gt;&gt;&gt; t2 = ExtendedTest()\n&gt;&gt;&gt; t2.foo\n'overridden'\n&gt;&gt;&gt; t2._bar\n'overridden'\n&gt;&gt;&gt; t2.__baz\nAttributeError: \"'ExtendedTest' object has no attribute '__baz'\"\n</code></pre> <p>\u7b49\u4e00\u4e0b\uff0c\u5f53\u6211\u4eec\u5c1d\u8bd5\u67e5\u770bt2 .__ baz\u7684\u503c\u65f6\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u4f1a\u5f97\u5230AttributeError\uff1f \u540d\u79f0\u4fee\u9970\u88ab\u518d\u6b21\u89e6\u53d1\u4e86\uff01 \u4e8b\u5b9e\u8bc1\u660e\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u751a\u81f3\u6ca1\u6709__baz\u5c5e\u6027\uff1a</p> <pre><code>&gt;&gt;&gt; dir(t2)\n['_ExtendedTest__baz', '_Test__baz', '__class__', '__delattr__',\n'__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__',\n'__getattribute__', '__gt__', '__hash__', '__init__', '__le__',\n'__lt__', '__module__', '__ne__', '__new__', '__reduce__',\n'__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__',\n'__subclasshook__', '__weakref__', '_bar', 'foo', 'get_vars']\n</code></pre> <p>\u6b63\u5982\u4f60\u53ef\u4ee5\u770b\u5230__baz\u53d8\u6210_ExtendedTest__baz\u4ee5\u9632\u6b62\u610f\u5916\u4fee\u6539\uff1a</p> <pre><code>&gt;&gt;&gt; t2._ExtendedTest__baz\n'overridden'\n</code></pre> <p>\u4f46\u539f\u6765\u7684_Test__baz\u8fd8\u5728\uff1a</p> <pre><code>&gt;&gt;&gt; t2._Test__baz\n42\n</code></pre> <p>\u53cc\u4e0b\u5212\u7ebf\u540d\u79f0\u4fee\u9970\u5bf9\u7a0b\u5e8f\u5458\u662f\u5b8c\u5168\u900f\u660e\u7684\u3002 \u4e0b\u9762\u7684\u4f8b\u5b50\u8bc1\u5b9e\u4e86\u8fd9\u4e00\u70b9\uff1a</p> <pre><code>class ManglingTest:\n   def __init__(self):\n       self.__mangled = 'hello'\n\n   def get_mangled(self):\n       return self.__mangled\n\n&gt;&gt;&gt; ManglingTest().get_mangled()\n'hello'\n&gt;&gt;&gt; ManglingTest().__mangled\nAttributeError: \"'ManglingTest' object has no attribute '__mangled'\"\n</code></pre> <p>\u540d\u79f0\u4fee\u9970\u662f\u5426\u4e5f\u9002\u7528\u4e8e\u65b9\u6cd5\u540d\u79f0\uff1f \u662f\u7684\uff0c\u4e5f\u9002\u7528\u3002\u540d\u79f0\u4fee\u9970\u4f1a\u5f71\u54cd\u5728\u4e00\u4e2a\u7c7b\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u4ee5\u4e24\u4e2a\u4e0b\u5212\u7ebf\u5b57\u7b26\uff08\"dunders\"\uff09\u5f00\u5934\u7684\u6240\u6709\u540d\u79f0\uff1a</p> <pre><code>class MangledMethod:\n   def __method(self):\n       return 42\n\n   def call_it(self):\n       return self.__method()\n\n&gt;&gt;&gt; MangledMethod().__method()\nAttributeError: \"'MangledMethod' object has no attribute '__method'\"\n&gt;&gt;&gt; MangledMethod().call_it()\n42\n</code></pre> <p>\u8fd9\u662f\u53e6\u4e00\u4e2a\u4e5f\u8bb8\u4ee4\u4eba\u60ca\u8bb6\u7684\u8fd0\u7528\u540d\u79f0\u4fee\u9970\u7684\u4f8b\u5b50\uff1a</p> <pre><code>_MangledGlobal__mangled = 23\n\nclass MangledGlobal:\n   def test(self):\n       return __mangled\n\n&gt;&gt;&gt; MangledGlobal().test()\n23\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u58f0\u660e\u4e86\u4e00\u4e2a\u540d\u4e3a_MangledGlobal__mangled\u7684\u5168\u5c40\u53d8\u91cf\u3002\u7136\u540e\u6211\u5728\u540d\u4e3aMangledGlobal\u7684\u7c7b\u7684\u4e0a\u4e0b\u6587\u4e2d\u8bbf\u95ee\u53d8\u91cf\u3002\u7531\u4e8e\u540d\u79f0\u4fee\u9970\uff0c\u6211\u80fd\u591f\u5728\u7c7b\u7684test()\u65b9\u6cd5\u5185\uff0c\u4ee5__mangled\u6765\u5f15\u7528_MangledGlobal__mangled\u5168\u5c40\u53d8\u91cf\u3002</p> <p>Python\u89e3\u91ca\u5668\u81ea\u52a8\u5c06\u540d\u79f0__mangled\u6269\u5c55\u4e3a_MangledGlobal__mangled\uff0c\u56e0\u4e3a\u5b83\u4ee5\u4e24\u4e2a\u4e0b\u5212\u7ebf\u5b57\u7b26\u5f00\u5934\u3002\u8fd9\u8868\u660e\u540d\u79f0\u4fee\u9970\u4e0d\u662f\u4e13\u95e8\u4e0e\u7c7b\u5c5e\u6027\u5173\u8054\u7684\u3002\u5b83\u9002\u7528\u4e8e\u5728\u7c7b\u4e0a\u4e0b\u6587\u4e2d\u4f7f\u7528\u7684\u4e24\u4e2a\u4e0b\u5212\u7ebf\u5b57\u7b26\u5f00\u5934\u7684\u4efb\u4f55\u540d\u79f0\u3002</p> <p>\u6709\u5f88\u591a\u8981\u5438\u6536\u7684\u5185\u5bb9\u5427\u3002</p> <p>\u8001\u5b9e\u8bf4\uff0c\u8fd9\u4e9b\u4f8b\u5b50\u548c\u89e3\u91ca\u4e0d\u662f\u4ece\u6211\u8111\u5b50\u91cc\u8e66\u51fa\u6765\u7684\u3002\u6211\u4f5c\u4e86\u4e00\u4e9b\u7814\u7a76\u548c\u52a0\u5de5\u624d\u5f04\u51fa\u6765\u3002\u6211\u4e00\u76f4\u4f7f\u7528Python\uff0c\u6709\u5f88\u591a\u5e74\u4e86\uff0c\u4f46\u662f\u50cf\u8fd9\u6837\u7684\u89c4\u5219\u548c\u7279\u6b8a\u60c5\u51b5\u5e76\u4e0d\u603b\u662f\u6d6e\u73b0\u5728\u8111\u6d77\u91cc\u3002</p> <p>\u6709\u65f6\u5019\u7a0b\u5e8f\u5458\u6700\u91cd\u8981\u7684\u6280\u80fd\u662f\u201c\u6a21\u5f0f\u8bc6\u522b\u201d\uff0c\u800c\u4e14\u77e5\u9053\u5728\u54ea\u91cc\u67e5\u9605\u4fe1\u606f\u3002\u5982\u679c\u60a8\u5728\u8fd9\u4e00\u70b9\u4e0a\u611f\u5230\u6709\u70b9\u4e0d\u77e5\u6240\u63aa\uff0c\u8bf7\u4e0d\u8981\u62c5\u5fc3\u3002\u6162\u6162\u6765\uff0c\u8bd5\u8bd5\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u7684\u4e00\u4e9b\u4f8b\u5b50\u3002</p> <p>\u8ba9\u8fd9\u4e9b\u6982\u5ff5\u5b8c\u5168\u6c89\u6d78\u4e0b\u6765\uff0c\u4ee5\u4fbf\u4f60\u80fd\u591f\u7406\u89e3\u540d\u79f0\u4fee\u9970\u7684\u603b\u4f53\u601d\u8def\uff0c\u4ee5\u53ca\u6211\u5411\u60a8\u5c55\u793a\u7684\u4e00\u4e9b\u5176\u4ed6\u7684\u884c\u4e3a\u3002\u5982\u679c\u6709\u4e00\u5929\u4f60\u548c\u5b83\u4eec\u4e0d\u671f\u800c\u9047\uff0c\u4f60\u4f1a\u77e5\u9053\u5728\u6587\u6863\u4e2d\u6309\u4ec0\u4e48\u6765\u67e5\u3002</p>"},{"location":"python-dunder/#4-var","title":"4. \u53cc\u524d\u5bfc\u548c\u53cc\u672b\u5c3e\u4e0b\u5212\u7ebf var","text":"<p>\u4e5f\u8bb8\u4ee4\u4eba\u60ca\u8bb6\u7684\u662f\uff0c\u5982\u679c\u4e00\u4e2a\u540d\u5b57\u540c\u65f6\u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u59cb\u548c\u7ed3\u675f\uff0c\u5219\u4e0d\u4f1a\u5e94\u7528\u540d\u79f0\u4fee\u9970\u3002 \u7531\u53cc\u4e0b\u5212\u7ebf\u524d\u7f00\u548c\u540e\u7f00\u5305\u56f4\u7684\u53d8\u91cf\u4e0d\u4f1a\u88abPython\u89e3\u91ca\u5668\u4fee\u6539\uff1a</p> <pre><code>class PrefixPostfixTest:\n   def __init__(self):\n       self.__bam__ = 42\n\n&gt;&gt;&gt; PrefixPostfixTest().__bam__\n42\n</code></pre> <p>\u4f46\u662f\uff0cPython\u4fdd\u7559\u4e86\u6709\u53cc\u524d\u5bfc\u548c\u53cc\u672b\u5c3e\u4e0b\u5212\u7ebf\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u7279\u6b8a\u7528\u9014\u3002 \u8fd9\u6837\u7684\u4f8b\u5b50\u6709\uff0cinit__\u5bf9\u8c61\u6784\u9020\u51fd\u6570\uff0c\u6216__call --- \u5b83\u4f7f\u5f97\u4e00\u4e2a\u5bf9\u8c61\u53ef\u4ee5\u88ab\u8c03\u7528\u3002 \u8fd9\u4e9bdunder\u65b9\u6cd5\u901a\u5e38\u88ab\u79f0\u4e3a\u795e\u5947\u65b9\u6cd5 - \u4f46Python\u793e\u533a\u4e2d\u7684\u8bb8\u591a\u4eba\uff08\u5305\u62ec\u6211\u81ea\u5df1\uff09\u90fd\u4e0d\u559c\u6b22\u8fd9\u79cd\u65b9\u6cd5\u3002 \u6700\u597d\u907f\u514d\u5728\u81ea\u5df1\u7684\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u4ee5\u53cc\u4e0b\u5212\u7ebf\uff08\u201cdunders\u201d\uff09\u5f00\u5934\u548c\u7ed3\u5c3e\u7684\u540d\u79f0\uff0c\u4ee5\u907f\u514d\u4e0e\u5c06\u6765Python\u8bed\u8a00\u7684\u53d8\u5316\u4ea7\u751f\u51b2\u7a81\u3002</p>"},{"location":"python-dunder/#5-_","title":"5.\u5355\u4e0b\u5212\u7ebf _","text":"<p>\u6309\u7167\u4e60\u60ef\uff0c\u6709\u65f6\u5019\u5355\u4e2a\u72ec\u7acb\u4e0b\u5212\u7ebf\u662f\u7528\u4f5c\u4e00\u4e2a\u540d\u5b57\uff0c\u6765\u8868\u793a\u67d0\u4e2a\u53d8\u91cf\u662f\u4e34\u65f6\u7684\u6216\u65e0\u5173\u7d27\u8981\u7684\u3002 \u4f8b\u5982\uff0c\u5728\u4e0b\u9762\u7684\u5faa\u73af\u4e2d\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u8bbf\u95ee\u6b63\u5728\u8fd0\u884c\u7684\u7d22\u5f15\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u201c_\u201d\u6765\u8868\u793a\u5b83\u53ea\u662f\u4e00\u4e2a\u4e34\u65f6\u503c\uff1a</p> <pre><code>&gt;&gt;&gt; for _ in range(32):\n...    print('Hello, World.')\n</code></pre> <p>\u4f60\u4e5f\u53ef\u4ee5\u5728\u62c6\u5206(unpacking)\u8868\u8fbe\u5f0f\u4e2d\u5c06\u5355\u4e2a\u4e0b\u5212\u7ebf\u7528\u4f5c\u201c\u4e0d\u5173\u5fc3\u7684\u201d\u53d8\u91cf\uff0c\u4ee5\u5ffd\u7565\u7279\u5b9a\u7684\u503c\u3002 \u540c\u6837\uff0c\u8fd9\u4e2a\u542b\u4e49\u53ea\u662f\u201c\u4f9d\u7167\u7ea6\u5b9a\u201d\uff0c\u5e76\u4e0d\u4f1a\u5728Python\u89e3\u91ca\u5668\u4e2d\u89e6\u53d1\u7279\u6b8a\u7684\u884c\u4e3a\u3002 \u5355\u4e2a\u4e0b\u5212\u7ebf\u4ec5\u4ec5\u662f\u4e00\u4e2a\u6709\u6548\u7684\u53d8\u91cf\u540d\u79f0\uff0c\u4f1a\u6709\u8fd9\u4e2a\u7528\u9014\u800c\u5df2\u3002 \u5728\u4e0b\u9762\u7684\u4ee3\u7801\u793a\u4f8b\u4e2d\uff0c\u6211\u5c06\u6c7d\u8f66\u5143\u7ec4\u62c6\u5206\u4e3a\u5355\u72ec\u7684\u53d8\u91cf\uff0c\u4f46\u6211\u53ea\u5bf9\u989c\u8272\u548c\u91cc\u7a0b\u503c\u611f\u5174\u8da3\u3002 \u4f46\u662f\uff0c\u4e3a\u4e86\u4f7f\u62c6\u5206\u8868\u8fbe\u5f0f\u6210\u529f\u8fd0\u884c\uff0c\u6211\u9700\u8981\u5c06\u5305\u542b\u5728\u5143\u7ec4\u4e2d\u7684\u6240\u6709\u503c\u5206\u914d\u7ed9\u53d8\u91cf\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u201c_\u201d\u4f5c\u4e3a\u5360\u4f4d\u7b26\u53d8\u91cf\u53ef\u4ee5\u6d3e\u4e0a\u7528\u573a\uff1a</p> <pre><code>&gt;&gt;&gt; car = ('red', 'auto', 12, 3812.4)\n&gt;&gt;&gt; color, _, _, mileage = car\n\n&gt;&gt;&gt; color\n'red'\n&gt;&gt;&gt; mileage\n3812.4\n&gt;&gt;&gt; _\n12\n</code></pre> <p>\u9664\u4e86\u7528\u4f5c\u4e34\u65f6\u53d8\u91cf\u4e4b\u5916\uff0c\u201c_\u201d\u662f\u5927\u591a\u6570Python REPL\u4e2d\u7684\u4e00\u4e2a\u7279\u6b8a\u53d8\u91cf\uff0c\u5b83\u8868\u793a\u7531\u89e3\u91ca\u5668\u8bc4\u4f30\u7684\u6700\u8fd1\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u3002 \u8fd9\u6837\u5c31\u5f88\u65b9\u4fbf\u4e86\uff0c\u6bd4\u5982\u4f60\u53ef\u4ee5\u5728\u4e00\u4e2a\u89e3\u91ca\u5668\u4f1a\u8bdd\u4e2d\u8bbf\u95ee\u5148\u524d\u8ba1\u7b97\u7684\u7ed3\u679c\uff0c\u6216\u8005\uff0c\u4f60\u662f\u5728\u52a8\u6001\u6784\u5efa\u591a\u4e2a\u5bf9\u8c61\u5e76\u4e0e\u5b83\u4eec\u4ea4\u4e92\uff0c\u65e0\u9700\u4e8b\u5148\u7ed9\u8fd9\u4e9b\u5bf9\u8c61\u5206\u914d\u540d\u5b57\uff1a</p> <pre><code>&gt;&gt;&gt; 20 + 3\n23\n&gt;&gt;&gt; _\n23\n&gt;&gt;&gt; print(_)\n23\n\n&gt;&gt;&gt; list()\n[]\n&gt;&gt;&gt; _.append(1)\n&gt;&gt;&gt; _.append(2)\n&gt;&gt;&gt; _.append(3)\n&gt;&gt;&gt; _\n[1, 2, 3]\n</code></pre> <p>Python\u4e0b\u5212\u7ebf\u547d\u540d\u6a21\u5f0f - \u5c0f\u7ed3 \u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u77ed\u7684\u5c0f\u7ed3\uff0c\u5373\u201c\u901f\u67e5\u8868\u201d\uff0c\u7f57\u5217\u4e86\u6211\u5728\u672c\u6587\u4e2d\u8c08\u5230\u7684\u4e94\u79cdPython\u4e0b\u5212\u7ebf\u6a21\u5f0f\u7684\u542b\u4e49\uff1a</p> <p></p>"},{"location":"python-function/","title":"Python\u4f20\u5165\u53c2\u6570\u7684\u51e0\u79cd\u65b9\u6cd5","text":"<p>Python\u4f20\u5165\u53c2\u6570\u7684\u65b9\u6cd5\u6709\uff1a\u4f4d\u7f6e\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53ef\u53d8\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u3001\u548c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u3001\u4ee5\u53ca\u5404\u79cd\u53c2\u6570\u8c03\u7528\u7684\u7ec4\u5408</p>"},{"location":"python-function/#_1","title":"\u5199\u5728\u524d\u9762","text":"<p>Python\u552f\u4e00\u652f\u6301\u7684\u53c2\u6570\u4f20\u9012\u65b9\u5f0f\u662f\u300e\u5171\u4eab\u4f20\u53c2\u300f\uff08call by sharing\uff09</p> <p>\u591a\u6570\u9762\u5411\u5bf9\u8c61\u8bed\u8a00\u90fd\u91c7\u7528\u8fd9\u4e00\u6a21\u5f0f\uff0c\u5305\u62ecRuby\u3001Smalltalk\u548cJava\uff08Java\u7684\u5f15\u7528\u7c7b\u578b\u662f\u8fd9\u6837\uff0c\u57fa\u672c\u7c7b\u578b\u6309\u503c\u4f20\u9012\uff09</p> <p>\u5171\u4eab\u4f20\u53c2\u662f\u6307\u51fd\u6570\u7684\u5404\u4e2a\u5f62\u5f0f\u53c2\u6570\u83b7\u5f97\u5b9e\u53c2\u4e2d\u5404\u4e2a\u5f15\u7528\u7684\u526f\u672c\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u51fd\u6570\u5185\u90e8\u7684\u5f62\u53c2\u662f\u5b9e\u53c2\u7684\u522b\u540d\uff08alias\uff09</p> <p>\u8fd9\u79cd\u65b9\u6848\u7684\u7ed3\u679c\u662f\uff0c\u51fd\u6570\u53ef\u80fd\u4f1a\u4fee\u6539\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u7684\u53ef\u53d8\u5bf9\u8c61\uff0c\u4f46\u662f\u65e0\u6cd5\u4fee\u6539\u90a3\u4e9b\u5bf9\u8c61\u7684\u6807\u8bc6\uff08\u5373\u4e0d\u80fd\u628a\u4e00\u4e2a\u5bf9\u8c61\u66ff\u6362\u4e3a\u53e6\u4e00\u4e2a\u5bf9\u8c61\uff09</p>"},{"location":"python-function/#_2","title":"\u4f4d\u7f6e\u53c2\u6570","text":"<p>\u4f4d\u7f6e\u53c2\u6570\u662f\u6700\u7b80\u5355\u7684\u4f20\u5165\u53c2\u6570\u7684\u65b9\u5f0f\uff0c\u5728\u5176\u5b83\u7684\u8bed\u8a00\u4e2d\u4e5f\u5e38\u5e38\u88ab\u4f7f\u7528</p>"},{"location":"python-function/#_3","title":"\u6f14\u793a\u4e00\uff1a","text":"<pre><code>def func(a, b):\n    print(a+b)\n\nfunc(1, 2)  #3\n</code></pre>"},{"location":"python-function/#_4","title":"\u6f14\u793a\u4e8c\uff1a","text":"<pre><code>def power(x, n):\n    s = 1\n    while(n &gt; 0):\n        n -= 1\n        s *= n\n    return s\n\npower(2, 3) #8\n</code></pre>"},{"location":"python-function/#_5","title":"\u9ed8\u8ba4\u53c2\u6570","text":"<p>\u9ed8\u8ba4\u53c2\u6570\u5c31\u662f\u5728\u8c03\u7528\u51fd\u6570\u7684\u65f6\u5019\u4f7f\u7528\u4e00\u4e9b\u5305\u542b\u9ed8\u8ba4\u503c\u7684\u53c2\u6570</p> <pre><code>def power(x, n=2):\n    s = 1\n    while(n &gt; 0):\n        n -= 1\n        s *= n\n    reutrn s\n\npower(3)    #9\npower(2, 3) #8\n</code></pre>"},{"location":"python-function/#_6","title":"\u5b9a\u4e49\u9ed8\u8ba4\u53c2\u6570\u8981\u7262\u8bb0\u4e00\u70b9\uff1a\u9ed8\u8ba4\u53c2\u6570\u5fc5\u987b\u6307\u5411\u4e0d\u53d8\u5bf9\u8c61\uff01","text":"<pre><code>#\u4ee5\u4e0b\u8fd9\u4e2a\u51fd\u6570\u5982\u679c\u88ab\u591a\u6b21\u8c03\u7528\u4f1a\u5728\u9ed8\u8ba4\u6dfb\u52a0\u591a\u4e2aEND\u5b57\u7b26\u4e32\ndef add_end(l = []):\n    l.append('END')\n    return l\n</code></pre> <pre><code>#\u4e3a\u4e86\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\uff0c\u5e94\u8be5\u628a\u4f20\u5165\u7684\u9ed8\u8ba4\u53c2\u6570\u8bbe\u7f6e\u4e3a\u4e0d\u53ef\u53d8\u7684\ndef add_end(l = None):\n    l = []\n    l.append('END')\n    return l\n</code></pre>"},{"location":"python-function/#_7","title":"\u53ef\u53d8\u53c2\u6570","text":"<p>\u53ef\u53d8\u53c2\u6570\u5c31\u662f\u5141\u8bb8\u5728\u8c03\u7528\u53c2\u6570\u7684\u65f6\u5019\u4f20\u5165\u591a\u4e2a\uff08\u22650\u4e2a\uff09\u53c2\u6570\uff08\u7c7b\u4f3c\u4e8e\u5217\u8868\u3001\u5b57\u5178\uff09</p> <pre><code>#\u4f20\u5165\u4e00\u4e2a\u5217\u8868\uff0c\u4e25\u683c\u5730\u8bf4\u8fd9\u4e0d\u662f\u53ef\u53d8\u53c2\u6570\ndef calc(l):\n    sum = 0\n    for n in l:\n        sum += n\n    return sum\n\n&gt;&gt;&gt; calc([1,2,3])\n</code></pre> <pre><code>#\u8fd9\u624d\u662f\u53ef\u53d8\u53c2\u6570\uff0c\u867d\u7136\u5728\u4f7f\u7528\u4e0a\u548c\u5217\u8868\u6ca1\u6709\u533a\u522b\uff0c\u4f46\u662f\u53c2\u6570nums\u63a5\u6536\u5230\u7684\u662f\u4e00\u4e2atuple\uff08\u8fd9\u4e9b\u53c2\u6570\u5728\u4f20\u5165\u65f6\u88ab\u81ea\u52a8\u7ec4\u7ec4\u88c5\u4e3a\u4e00\u4e2a\u5143\u7956\uff09\ndef calc(*nums):\n    sum = 0\n    for n in nums:\n        sum += n\n    return sum\n\n&gt;&gt;&gt; calc(1,2,3)\n7\n\n&gt;&gt;&gt; my_ls = [1,2,3]\n&gt;&gt;&gt; calc(*my_ls)\n7\n</code></pre>"},{"location":"python-function/#_8","title":"\u5173\u952e\u5b57\u53c2\u6570","text":"<p>\u53ef\u53d8\u53c2\u6570\u5141\u8bb8\u4f20\u51650\u4e2a\uff5e\u591a\u4e2a\u53c2\u6570\uff0c\u800c\u5173\u952e\u5b57\u53c2\u6570\u5141\u8bb8\u5728\u8c03\u7528\u65f6\u4ee5\u5b57\u5178\u5f62\u5f0f\u4f20\u51650\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\uff08\u6ce8\u610f\u533a\u522b\uff0c\u4e00\u4e2a\u662f\u5b57\u5178\u4e00\u4e2a\u662f\u5217\u8868\uff09\uff1b\u5728\u4f20\u9012\u53c2\u6570\u65f6\u7528\u7b49\u53f7\uff08=\uff09\u8fde\u63a5\u952e\u548c\u503c</p> <pre><code>#\u7528\u4e24\u4e2a\u661f\u53f7\u8868\u793a\u5173\u952e\u5b57\u53c2\u6570\ndef person_info(name, age, **kw):\n    print(\"name\", name, \"age\", age, \"other\", kw)\n\n&gt;&gt;&gt; person_info(\"Xiaoming\", 12)\nname Xiaoming age 12 other{}\n&gt;&gt;&gt; person_info(\"Dahuang\", 35, city = \"Beijing\")\nname Dahuang age 35 other {'city':'Beijing'}\n</code></pre>"},{"location":"python-function/#_9","title":"\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570","text":"<p>\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u5728\u5173\u952e\u5b57\u53c2\u6570\u7684\u57fa\u7840\u4e0a\u9650\u5236\u4f20\u5165\u7684\u7684\u5173\u952e\u5b57\u7684\u53d8\u91cf\u540d</p> <p>\u548c\u666e\u901a\u5173\u952e\u5b57\u53c2\u6570\u4e0d\u540c\uff0c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u9700\u8981\u4e00\u4e2a\u7528\u6765\u533a\u5206\u7684\u5206\u9694\u7b26*\uff0c\u5b83\u540e\u9762\u7684\u53c2\u6570\u88ab\u8ba4\u4e3a\u662f\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570</p> <pre><code>#\u8fd9\u91cc\u661f\u53f7\u5206\u5272\u7b26\u540e\u9762\u7684city\u3001job\u662f\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\nperson_info(name, age, *, city, job):\n    print(name, age, city, job)\n\n&gt;&gt;&gt; person_info(\"Alex\", 17, city = \"Beijing\", job = \"Engineer\")\nAlex 17 Beijing Engineer    #\u770b\u6765\u8fd9\u91cc\u4e0d\u518d\u88ab\u81ea\u52a8\u7ec4\u88c5\u4e3a\u5b57\u5178\n</code></pre> <p>\u4e0d\u8fc7\u4e5f\u6709\u4f8b\u5916\uff0c\u5982\u679c\u53c2\u6570\u4e2d\u5df2\u7ecf\u6709\u4e00\u4e2a\u53ef\u53d8\u53c2\u6570\u7684\u8bdd\uff0c\u524d\u9762\u8bb2\u7684\u661f\u53f7\u5206\u5272\u7b26\u5c31\u4e0d\u8981\u5199\u4e86\uff08\u5176\u5b9e\u661f\u53f7\u662f\u5199\u7ed9Python\u89e3\u91ca\u5668\u770b\u7684\uff0c\u5982\u679c\u4e00\u4e2a\u661f\u53f7\u4e5f\u6ca1\u6709\u7684\u8bdd\u5c31\u65e0\u6cd5\u533a\u5206\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u548c\u4f4d\u7f6e\u53c2\u6570\u4e86\uff0c\u800c\u5982\u679c\u6709\u4e00\u4e2a\u661f\u53f7\u5373\u4f7f\u6765\u81ea\u53d8\u957f\u53c2\u6570\u5c31\u53ef\u4ee5\u533a\u5206\u5f00\u6765\uff09</p> <pre><code>#args\u662f\u53d8\u957f\u53c2\u6570\uff0c\u800ccity\u548cjob\u662f\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\nperson_info(name, age, *args, city, job):\n    print(name, age, args, city)\n\n&gt;&gt;&gt; person_info(\"Liqiang\", 43, \"balabala\", city = \"Wuhan\", job = \"Coder\")\nLiqiang 43 balabala Wuhan Coder\n</code></pre>"},{"location":"python-function/#_10","title":"\u53c2\u6570\u7ec4\u5408","text":"<p>\u603b\u7ed3\u4e00\u4e0b\uff0c\u5728Python\u4e2d\u4e00\u79cd\u53ef\u4ee5\u4f7f\u75285\u4e2d\u4f20\u9012\u53c2\u6570\u7684\u65b9\u5f0f\uff08\u4f4d\u7f6e\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53d8\u957f\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u3001\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff09</p> <p>\u6ce8\u610f\uff0c\u8fd9\u4e9b\u53c2\u6570\u5728\u4e66\u5199\u65f6\u8981\u9075\u5faa\u4e00\u5b9a\u7684\u987a\u5e8f\u5373\uff1a\u4f4d\u7f6e\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53d8\u957f\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u3001\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff08\u548c\u672c\u6587\u7684\u884c\u6587\u987a\u5e8f\u4e00\u81f4\uff09</p> <p>\u8fd9\u91cc\u7b80\u5355\u4e3e\u4e24\u4e2a\u6817\u5b50</p> <pre><code>def f1(a, b, c=0, *args, **kw):\n    print(\"a = \", a, \"b = \", b, \"args = \", args, \"kw = \",kw)\ndef f2(a, b, c=0, *, d, **kw):\n    print(\"a = \", a, \"b = \", b, \"c = \", c, \"d = \", d, \"kw = \", kw)\n\n&gt;&gt;&gt; f1(1, 2)\na = 1 b = 2 c = 0 args =() kw = {}\n&gt;&gt;&gt; f1(1, 2, c=3)\na = 1 b = 2 c = 3 args = () kw = {}\n&gt;&gt;&gt; f1(1, 2, 3, 'a', 'b')\na = 1 b = 2 c = 3 args = ('a', 'b') kw = {}\n&gt;&gt;&gt; f1(1, 2, 3, 'a', 'b', x = 99)\na = 1 b = 2 c = 3 args = ('a', 'b') kw = {'x':99}\n&gt;&gt;&gt; f2(1, 2, d = 99, ext = None)\na = 1 b =2 c = 0 d = 99 kw = {'ext':None}\n</code></pre>"},{"location":"python-function/#_11","title":"\u5199\u5728\u540e\u9762","text":"<p>\u5173\u4e8ePython\u53c2\u6570\u4f20\u9012\uff0c\u6709\u4ee5\u4e0b\u51e0\u70b9\u63d0\u8bf7\u6ce8\u610f\uff1a</p> <ol> <li>\u53c2\u6570\u7684\u4f20\u9012\u662f\u901a\u8fc7\u81ea\u52a8\u5c06\u5bf9\u8c61\u8d4b\u503c\u7ed9\u672c\u5730\u53d8\u91cf\u540d\u6765\u5b9e\u73b0\u7684</li> <li> <p>\u51fd\u6570\u53c2\u6570\u5728\u5b9e\u9645\u4e2d\u53ea\u662fPython\u8d4b\u503c\u7684\u53e6\u4e00\u4e2a\u5b9e\u4f8b\u800c\u5df2\uff0c\u56e0\u4e3a\u5f15\u7528\u53ef\u4ee5\u662f\u4ee5\u6307\u9488\u7684\u5f62\u5f0f\u6765\u5b9e\u73b0\u7684\uff0c\u6240\u6709\u7684\u53c2\u6570\u5b9e\u9645\u4e0a\u90fd\u662f\u901a\u8fc7\u6307\u9488\u8fdb\u884c\u4f20\u9012\u7684\uff0c\u4f5c\u4e3a\u53c2\u6570\u88ab\u4f20\u9012\u7684\u5bf9\u8c61\u4ece\u6765\u4e0d\u81ea\u52a8\u62f7\u8d1d</p> </li> <li> <p>\u5728\u51fd\u6570\u5185\u90e8\u7684\u53c2\u6570\u540d\u7684\u8d4b\u503c\u4e0d\u4f1a\u5f71\u54cd\u8c03\u7528\u8005 </p> </li> <li> <p>\u5728\u51fd\u6570\u8fd0\u884c\u65f6\uff0c\u5728\u51fd\u6570\u5934\u90e8\u7684\u53c2\u6570\u540d\u65f6\u4e00\u4e2a\u65b0\u7684\u3001\u672c\u5730\u7684\u53d8\u91cf\u540d\uff0c\u8fd9\u4e2a\u53d8\u91cf\u540d\u662f\u5728\u51fd\u6570\u7684\u672c\u5730\u4f5c\u7528\u57df\u5185\u7684\uff0c\u51fd\u6570\u53c2\u6570\u540d\u548c\u8c03\u7528\u8005\u4f5c\u7528\u57df\u4e2d\u7684\u53d8\u91cf\u662f\u6ca1\u6709\u533a\u522b\u7684</p> </li> <li> <p>\u6539\u53d8\u51fd\u6570\u7684\u53ef\u53d8\u5bf9\u8c61\u53c2\u6570\u7684\u503c\u4e5f\u8bb8\u4f1a\u5bf9\u8c03\u7528\u8005\u6709\u5f71\u54cd </p> </li> <li>\u6362\u53e5\u8bdd\u8bf4\uff0c\u56e0\u4e3a\u53c2\u6570\u662f\u7b80\u5355\u5730\u8d4b\u503c\u7ed9\u4f20\u5165\u7684\u5bf9\u8c61\uff0c\u51fd\u6570\u5c31\u80fd\u591f\u5c31\u5730\u6539\u53d8\u4f20\u5165\u7684\u53ef\u53d8\u5bf9\u8c61\uff0c\u56e0\u6b64\u5176\u7ed3\u679c\u4f1a\u5f71\u54cd\u8c03\u7528\u8005\uff1b\u53ef\u53d8\u53c2\u6570\u5bf9\u51fd\u6570\u6765\u8bf4\u53ef\u4ee5\u505a\u8f93\u5165\u548c\u8f93\u51fa\u7684</li> </ol>"},{"location":"python-function/#pythoncc","title":"Python\u7684\u901a\u8fc7\u8d4b\u503c\u8fdb\u884c\u4f20\u9012\u7684\u673a\u5236\u4e0eC++\u7684\u5f15\u7528\u53c2\u6570\u9009\u9879\u4e0d\u5b8c\u5168\u76f8\u540c\uff0c\u4f46\u662f\u5b9e\u9645\u4e2d\uff0c\u5b83\u4e0eC\u8bed\u8a00\u7684\u53c2\u6570\u4f20\u9012\u6a21\u578b\u76f8\u5f53\u7c7b\u4f3c\uff1a","text":"<ol> <li>\u4e0d\u53ef\u53d8\u53c2\u6570\u201c\u901a\u8fc7\u503c\u201d\u8fdb\u884c\u4f20\u9012 </li> <li> <p>\u50cf\u6574\u6570\u548c\u5b57\u7b26\u4e32\u8fd9\u6837\u7684\u5bf9\u8c61\u662f\u4e0d\u53ef\u53d8\u5bf9\u8c61\uff0c\u5b83\u4eec\u901a\u8fc7\u5bf9\u8c61\u5f15\u7528\u800c\u4e0d\u662f\u62f7\u8d1d\u8fdb\u884c\u4f20\u9012\u7684\uff0c\u4f46\u662f\u56e0\u4e3a\u65e0\u8bba\u5982\u4f55\u90fd\u4e0d\u53ef\u80fd\u5728\u539f\u5904\u6539\u53d8\u4e0d\u53ef\u53d8\u5bf9\u8c61\uff0c\u5b9e\u9645\u7684\u6548\u679c\u5c31\u5f88\u50cf\u521b\u5efa\u4e86\u4e00\u4efd\u62f7\u8d1d</p> </li> <li> <p>\u53ef\u53d8\u5bf9\u8c61\u662f\u901a\u8fc7\u201c\u6307\u9488\u201d\u8fdb\u884c\u4f20\u9012\u7684 </p> </li> <li>\u5217\u8868\u548c\u5b57\u5178\u8fd9\u6837\u7684\u5bf9\u8c61\u4e5f\u662f\u901a\u8fc7\u5bf9\u8c61\u5f15\u7528\u8fdb\u884c\u4f20\u9012\u7684\uff0c\u8fd9\u4e00\u70b9\u4e0eC\u8bed\u8a00\u4f7f\u7528\u6307\u9488\u4f20\u9012\u6570\u7ec4\u5f88\u76f8\u4f3c\uff0c\u53ef\u53d8\u5bf9\u8c61\u80fd\u591f\u5728\u51fd\u6570\u5185\u90e8\u8fdb\u884c\u539f\u5904\u7684\u6539\u53d8\uff0c\u8fd9\u4e00\u70b9\u548cC\u6570\u7ec4\u5f88\u50cf</li> </ol> <p> </p>"},{"location":"python-mysql/","title":"python \u64cd\u4f5c mysql\u57fa\u7840\u8865\u5145","text":"<p>\u8001\u4e86\u8001\u4e86\uff0c\u8bb0\u4e0d\u4f4f\u4e86\u3002 http://www.cnblogs.com/wenchengxiaopenyou/p/5701899.html</p>"},{"location":"python-mysql/#_1","title":"\u524d\u8a00","text":"<p>\u672c\u7bc7\u7684\u4e3b\u8981\u5185\u5bb9\u4e3a\u6574\u7406mysql\u7684\u57fa\u7840\u5185\u5bb9\uff0c\u5206\u4eab\u7684\u540c\u65f6\u65b9\u4fbf\u65e5\u540e\u67e5\u9605\uff0c\u540c\u65f6\u7ed3\u5408python\u7684\u5b66\u4e60\u6574\u7406python\u64cd\u4f5cmysql\u7684\u65b9\u6cd5\u4ee5\u53capython\u7684ORM\u3002</p>"},{"location":"python-mysql/#_2","title":"\u4e00.\u6570\u636e\u5e93\u521d\u63a2","text":"<pre><code>\u5728\u5f00\u59cbmysql\u4e4b\u524d\u5148\u4e86\u89e3\u4e0b\u4ec0\u4e48\u662f\u6570\u636e\u5e93\uff1a\n\u6570\u636e\u5e93\uff08Database\uff09\u662f\u6309\u7167\u6570\u636e\u7ed3\u6784\u6765\u7ec4\u7ec7\u3001\u5b58\u50a8\u548c\u7ba1\u7406\u6570\u636e\u7684\u4ed3\u5e93\uff0c\u5b83\u4ea7\u751f\u4e8e\u8ddd\u4eca\u516d\u5341\u591a\u5e74\u524d\uff0c\u968f\u7740\u4fe1\u606f\u6280\u672f\u548c\u5e02\u573a\u7684\u53d1\u5c55\uff0c\u7279\u522b\u662f\u4e8c\u5341\u4e16\u7eaa\u4e5d\u5341\u5e74\u4ee3\u4ee5\u540e\uff0c\u6570\u636e\u7ba1\u7406\u4e0d\u518d\u4ec5\u4ec5\u662f\u5b58\u50a8\u548c\u7ba1\u7406\u6570\u636e\uff0c\u800c\u8f6c\u53d8\u6210\u7528\u6237\u6240\u9700\u8981\u7684\u5404\u79cd\u6570\u636e\u7ba1\u7406\u7684\u65b9\u5f0f\u3002\u6570\u636e\u5e93\u6709\u5f88\u591a\u79cd\u7c7b\u578b\uff0c\u4ece\u6700\u7b80\u5355\u7684\u5b58\u50a8\u6709\u5404\u79cd\u6570\u636e\u7684\u8868\u683c\u5230\u80fd\u591f\u8fdb\u884c\u6d77\u91cf\u6570\u636e\u5b58\u50a8\u7684\u5927\u578b\u6570\u636e\u5e93\u7cfb\u7edf\u90fd\u5728\u5404\u4e2a\u65b9\u9762\u5f97\u5230\u4e86\u5e7f\u6cdb\u7684\u5e94\u7528\u3002\n\u901a\u4fd7\u7684\u8bb2\u6570\u636e\u5e93\u5c31\u662f\u8bb2\u6570\u636e\u4fdd\u5b58\u5728\u6587\u4ef6\u6216\u8005\u5185\u5b58\u4e2d\uff0c\u63a5\u6536\u7279\u5b9a\u7684\u547d\u4ee4\u7136\u540e\u5bf9\u6587\u4ef6\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u6570\u636e\u5e93\u5c31\u662f\u4e00\u4e2a\u5de5\u5177\u5b83\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u53bb\u7ba1\u7406\u8fd9\u4e9b\u6587\u4ef6\u5939\u6216\u8005\u6587\u4ef6\uff0c\u6211\u95e8\u53ea\u9700\u8981\u901a\u8fc7\u547d\u4ee4\u7684\u65b9\u5f0f\u544a\u8bc9\u4ed6\u4eec\u53bb\u6267\u884c\u5c31\u884c\u4e86\u3002\n\n\u90a3\u4e48mysql\u53c8\u662f\u4ec0\u4e48\u5462\uff1f\n\nMySQL\u662f\u4e00\u4e2a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u7531\u745e\u5178MySQL AB \u516c\u53f8\u5f00\u53d1\uff0c\u76ee\u524d\u5c5e\u4e8e Oracle \u65d7\u4e0b\u516c\u53f8\u3002MySQL \u6700\u6d41\u884c\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u5728 WEB \u5e94\u7528\u65b9\u9762MySQL\u662f\u6700\u597d\u7684 RDBMS (Relational Database Management System\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf) \u5e94\u7528\u8f6f\u4ef6\u4e4b\u4e00\u3002 \u4e0emysql\u76f8\u7c7b\u4f3c\u529f\u80fd\u7684\u6570\u636e\u5e93\u8fd8\u6709\uff1aMySQL\u3001Oracle\u3001SQLite\u3001Access\u3001MS SQL Server\u7b49\n\n\u518d\u4e86\u89e3\u4e0b\u4ec0\u4e48\u662fSQL\uff1a\n\nSQL\u662fStructured Query Language(\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00)\u7684\u7f29\u5199\u3002SQL\u662f\u4e13\u4e3a\u6570\u636e\u5e93\u800c\u5efa\u7acb\u7684\u64cd\u4f5c\u547d\u4ee4\u96c6\uff0c\u662f\u4e00\u79cd\u529f\u80fd\u9f50\u5168\u7684\u6570\u636e\u5e93\u8bed\u8a00\u3002\u5728\u4f7f\u7528\u5b83\u65f6\uff0c\u53ea\u9700\u8981\u53d1\u51fa\u201c\u505a\u4ec0\u4e48\u201d\u7684\u547d\u4ee4\uff0c\u201c\u600e\u4e48\u505a\u201d\u662f\u4e0d\u7528\u4f7f\u7528\u8005\u8003\u8651\u7684\u3002SQL\u529f\u80fd\u5f3a\u5927\u3001\u7b80\u5355\u6613\u5b66\u3001\u4f7f\u7528\u65b9\u4fbf\uff0c\u5df2\u7ecf\u6210\u4e3a\u4e86\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u57fa\u7840\uff0c\u5e76\u4e14\u73b0\u5728\u51e0\u4e4e\u6240\u6709\u7684\u6570\u636e\u5e93\u5747\u652f\u6301SQL\u3002\u6b63\u5982\u4e0a\u6587\u63d0\u5230\u7684SQl\u5c31\u662f\u6211\u4eec\u63a7\u5236\u6570\u636e\u5e93\u7684\u65b9\u6cd5\uff0c\u547d\u4ee4\u3002\n</code></pre>"},{"location":"python-mysql/#_3","title":"\u4e09.\u771f\u6b63\u7684\u6570\u636e\u5e93\u64cd\u4f5c\uff1a","text":"<p>1.\u663e\u793a\u6570\u636e\u5e93</p> <p><code>SHOW DATABASES;</code></p> <p>\u5b89\u88c5\u5b8cmysql\u6570\u636e\u5e93\u540e\u9ed8\u8ba4\u6570\u636e\u5e93\u5982\u4e0b\uff1a</p> <ul> <li>mysql - \u7528\u6237\u6743\u9650\u76f8\u5173\u6570\u636e</li> <li>test - \u7528\u4e8e\u7528\u6237\u6d4b\u8bd5\u6570\u636e</li> <li>information_schema - MySQL\u672c\u8eab\u67b6\u6784\u76f8\u5173\u6570\u636e</li> </ul> <p>2.\u4f7f\u7528\u6570\u636e\u5e93</p> <pre><code>USE db_name;   \uff03\u6307\u5b9a\u8981\u64cd\u4f5c\u7684\u6570\u636e\u5e93\u540d\u5b57\n</code></pre> <p>3.\u663e\u793a\u6240\u6709\u8868</p> <pre><code>SHOW TABLES;\n</code></pre> <p>4.\u7528\u6237\u6388\u6743</p> <p>\u5728\u7528\u6237\u6388\u6743\u90e8\u5206\u5305\u62ec\uff1a</p> <ul> <li>\u7528\u6237\u7ba1\u7406</li> <li>\u6388\u6743\u7ba1\u7406 </li> </ul> <p>\u7528\u6237\u7ba1\u7406\uff1a</p> <pre><code>\u521b\u5efa\u7528\u6237\n    create user '\u7528\u6237\u540d'@'IP\u5730\u5740' identified by '\u5bc6\u7801';\n\u5220\u9664\u7528\u6237\n    drop user '\u7528\u6237\u540d'@'IP\u5730\u5740';\n\u4fee\u6539\u7528\u6237\n    rename user '\u7528\u6237\u540d'@'IP\u5730\u5740'; to '\u65b0\u7528\u6237\u540d'@'IP\u5730\u5740';\n\u4fee\u6539\u5bc6\u7801\n    set password for '\u7528\u6237\u540d'@'IP\u5730\u5740' = Password('\u65b0\u5bc6\u7801');\n\n\u6ce8\u610f\uff1a\u7528\u6237\u6743\u9650\u76f8\u5173\u6570\u636e\u4fdd\u5b58\u5728\u9ed8\u8ba4\u7684mysql\u6570\u636e\u5e93\u7684user\u8868\u4e2d\uff0c\u867d\u7136\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5bf9\u5176\u8fdb\u884c\u64cd\u4f5c\uff0c\u4f46\u662f\u672a\u6765\u5b89\u5168\u6027\u4e0d\u5efa\u8bae\u90a3\u4e48\u505a\u3002\n</code></pre> <p>\u6388\u6743\u7ba1\u7406\uff1a</p> <pre><code>show grants for '\u7528\u6237'@'IP\u5730\u5740'                  -- \u67e5\u770b\u6743\u9650\ngrant  \u6743\u9650 on \u6570\u636e\u5e93.\u8868 to   '\u7528\u6237'@'IP\u5730\u5740'      -- \u6388\u6743\nrevoke \u6743\u9650 on \u6570\u636e\u5e93.\u8868 from '\u7528\u6237'@'IP\u5730\u5740'      -- \u53d6\u6d88\u6743\u9650\n</code></pre> <p>\u66f4\u52a0\u8be6\u7ec6\uff1a</p> <pre><code>all privileges  \u9664grant\u5916\u7684\u6240\u6709\u6743\u9650\n            select          \u4ec5\u67e5\u6743\u9650\n            select,insert   \u67e5\u548c\u63d2\u5165\u6743\u9650\n            ...\n            usage                   \u65e0\u8bbf\u95ee\u6743\u9650\n            alter                   \u4f7f\u7528alter table\n            alter routine           \u4f7f\u7528alter procedure\u548cdrop procedure\n            create                  \u4f7f\u7528create table\n            create routine          \u4f7f\u7528create procedure\n            create temporary tables \u4f7f\u7528create temporary tables\n            create user             \u4f7f\u7528create user\u3001drop user\u3001rename user\u548crevoke  all privileges\n            create view             \u4f7f\u7528create view\n            delete                  \u4f7f\u7528delete\n            drop                    \u4f7f\u7528drop table\n            execute                 \u4f7f\u7528call\u548c\u5b58\u50a8\u8fc7\u7a0b\n            file                    \u4f7f\u7528select into outfile \u548c load data infile\n            grant option            \u4f7f\u7528grant \u548c revoke\n            index                   \u4f7f\u7528index\n            insert                  \u4f7f\u7528insert\n            lock tables             \u4f7f\u7528lock table\n            process                 \u4f7f\u7528show full processlist\n            select                  \u4f7f\u7528select\n            show databases          \u4f7f\u7528show databases\n            show view               \u4f7f\u7528show view\n            update                  \u4f7f\u7528update\n            reload                  \u4f7f\u7528flush\n            shutdown                \u4f7f\u7528mysqladmin shutdown(\u5173\u95edMySQL)\n            super                   \udbff\udc42\udbff\udc08\u4f7f\u7528change master\u3001kill\u3001logs\u3001purge\u3001master\u548cset global\u3002\u8fd8\u5141\u8bb8mysqladmin\udbff\udd57\udbff\udd58\udbff\udc8a\udbff\udc8b\u8c03\u8bd5\u767b\u9646\n            replication client      \u670d\u52a1\u5668\u4f4d\u7f6e\u7684\u8bbf\u95ee\n            replication slave       \u7531\u590d\u5236\u4ece\u5c5e\u4f7f\u7528\n\n\n        \u5bf9\u4e8e\u76ee\u6807\u6570\u636e\u5e93\u4ee5\u53ca\u5185\u90e8\u5176\u4ed6\uff1a\n            \u6570\u636e\u5e93\u540d.*           \u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\n            \u6570\u636e\u5e93\u540d.\u8868          \u6307\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u67d0\u5f20\u8868\n            \u6570\u636e\u5e93\u540d.\u5b58\u50a8\u8fc7\u7a0b     \u6307\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u5b58\u50a8\u8fc7\u7a0b\n            *.*                \u6240\u6709\u6570\u636e\u5e93\n\n            \u7528\u6237\u540d@IP\u5730\u5740         \u7528\u6237\u53ea\u80fd\u5728\u6539IP\u4e0b\u624d\u80fd\u8bbf\u95ee\n            \u7528\u6237\u540d@192.168.1.%   \u7528\u6237\u53ea\u80fd\u5728\u6539IP\u6bb5\u4e0b\u624d\u80fd\u8bbf\u95ee(\u901a\u914d\u7b26%\u8868\u793a\u4efb\u610f)\n            \u7528\u6237\u540d@%             \u7528\u6237\u53ef\u4ee5\u518d\u4efb\u610fIP\u4e0b\u8bbf\u95ee(\u9ed8\u8ba4IP\u5730\u5740\u4e3a%)\n\n</code></pre>"},{"location":"python-mysql/#_4","title":"\u56db.\u8868\u64cd\u4f5c","text":"<p>1.\u521b\u5efa\u8868</p> <pre><code>create table \u8868\u540d(\n    \u5217\u540d  \u7c7b\u578b  \u662f\u5426\u53ef\u4ee5\u4e3a\u7a7a\uff0c\n    \u5217\u540d  \u7c7b\u578b  \u662f\u5426\u53ef\u4ee5\u4e3a\u7a7a\n)\n</code></pre> <ul> <li>\u662f\u5426\u53ef\u7a7a</li> </ul> <pre><code>        \u662f\u5426\u53ef\u7a7a\uff0cnull\u8868\u793a\u7a7a\uff0c\u975e\u5b57\u7b26\u4e32\n            not null    - \u4e0d\u53ef\u7a7a\n            null        - \u53ef\u7a7a\n</code></pre> <ul> <li>\u9ed8\u8ba4\u503c</li> </ul> <pre><code>        \u9ed8\u8ba4\u503c\uff0c\u521b\u5efa\u5217\u65f6\u53ef\u4ee5\u6307\u5b9a\u9ed8\u8ba4\u503c\uff0c\u5f53\u63d2\u5165\u6570\u636e\u65f6\u5982\u679c\u672a\u4e3b\u52a8\u8bbe\u7f6e\uff0c\u5219\u81ea\u52a8\u6dfb\u52a0\u9ed8\u8ba4\u503c\n            create table tb1(\n                nid int not null defalut 2,\n                num int not null\n            )\n</code></pre> <ul> <li>\u81ea\u589e</li> </ul> <pre><code>\u81ea\u589e\uff0c\u5982\u679c\u4e3a\u67d0\u5217\u8bbe\u7f6e\u81ea\u589e\u5217\uff0c\u63d2\u5165\u6570\u636e\u65f6\u65e0\u9700\u8bbe\u7f6e\u6b64\u5217\uff0c\u9ed8\u8ba4\u5c06\u81ea\u589e\uff08\u8868\u4e2d\u53ea\u80fd\u6709\u4e00\u4e2a\u81ea\u589e\u5217\uff09\n            create table tb1(\n                nid int not null auto_increment primary key,\n                num int null\n            )\n            \u6216\n            create table tb1(\n                nid int not null auto_increment,\n                num int null,\n                index(nid)\n            )\n            \u6ce8\u610f\uff1a1\u3001\u5bf9\u4e8e\u81ea\u589e\u5217\uff0c\u5fc5\u987b\u662f\u7d22\u5f15\uff08\u542b\u4e3b\u952e\uff09\u3002\n                 2\u3001\u5bf9\u4e8e\u81ea\u589e\u53ef\u4ee5\u8bbe\u7f6e\u6b65\u957f\u548c\u8d77\u59cb\u503c\n                     show session variables like 'auto_inc%';\n                     set session auto_increment_increment=2;\n                     set session auto_increment_offset=10;\n\n                     shwo global  variables like 'auto_inc%';\n                     set global auto_increment_increment=2;\n                     set global auto_increment_offset=10;\n</code></pre> <ul> <li>\u4e3b\u952e</li> </ul> <pre><code>\u5916\u952e\uff0c\u4e00\u4e2a\u7279\u6b8a\u7684\u7d22\u5f15\uff0c\u53ea\u80fd\u662f\u6307\u5b9a\u5185\u5bb9\n            creat table color(\n                nid int not null primary key,\n                name char(16) not null\n            )\n\n            create table fruit(\n                nid int not null primary key,\n                smt char(32) null ,\n                color_id int not null,\n                constraint fk_cc foreign key (color_id) references color(nid)\n            )\n</code></pre> <p>2.\u5220\u9664\u8868</p> <pre><code>drop table \u8868\u540d\n</code></pre> <p>3.\u6e05\u7a7a\u8868</p> <pre><code>delete from \u8868\u540d\ntruncate table \u8868\u540d\n</code></pre> <p>4.\u4fee\u6539\u8868</p> <pre><code>\n\u6dfb\u52a0\u5217\uff1aalter table \u8868\u540d add \u5217\u540d \u7c7b\u578b\n\u5220\u9664\u5217\uff1aalter table \u8868\u540d drop column \u5217\u540d\n\u4fee\u6539\u5217\uff1a\n        alter table \u8868\u540d modify column \u5217\u540d \u7c7b\u578b;  -- \u7c7b\u578b\n        alter table \u8868\u540d change \u539f\u5217\u540d \u65b0\u5217\u540d \u7c7b\u578b; -- \u5217\u540d\uff0c\u7c7b\u578b\n\n\u6dfb\u52a0\u4e3b\u952e\uff1a\n        alter table \u8868\u540d add primary key(\u5217\u540d);\n\u5220\u9664\u4e3b\u952e\uff1a\n        alter table \u8868\u540d drop primary key;\n        alter table \u8868\u540d  modify  \u5217\u540d int, drop primary key;\n\n\u6dfb\u52a0\u5916\u952e\uff1aalter table \u4ece\u8868 add constraint \u5916\u952e\u540d\u79f0\uff08\u5f62\u5982\uff1aFK_\u4ece\u8868_\u4e3b\u8868\uff09 foreign key \u4ece\u8868(\u5916\u952e\u5b57\u6bb5) references \u4e3b\u8868(\u4e3b\u952e\u5b57\u6bb5);\n\u5220\u9664\u5916\u952e\uff1aalter table \u8868\u540d drop foreign key \u5916\u952e\u540d\u79f0\n\n\u4fee\u6539\u9ed8\u8ba4\u503c\uff1aALTER TABLE testalter_tbl ALTER i SET DEFAULT 1000;\n\u5220\u9664\u9ed8\u8ba4\u503c\uff1aALTER TABLE testalter_tbl ALTER i DROP DEFAULT;\n</code></pre>"},{"location":"python-mysql/#mysql","title":"\u4e94.mysql\u7684\u57fa\u672c\u64cd\u4f5c","text":"<p>1.\u589e</p> <pre><code>        insert into \u8868 (\u5217\u540d,\u5217\u540d...) values (\u503c,\u503c,\u503c...)\n        insert into \u8868 (\u5217\u540d,\u5217\u540d...) values (\u503c,\u503c,\u503c...),(\u503c,\u503c,\u503c...)\n        insert into \u8868 (\u5217\u540d,\u5217\u540d...) select (\u5217\u540d,\u5217\u540d...) from \u8868\n</code></pre> <p>2.\u5220</p> <pre><code>        delete from \u8868\n        delete from \u8868 where id\uff1d1 and name\uff1d'zhaowencheng'\n</code></pre> <p>3.\u6539</p> <pre><code>        update \u8868 set name \uff1d 'zhaowencheng' where id&gt;1\n</code></pre> <p>4.\u67e5</p> <pre><code>        select * from \u8868\n        select * from \u8868 where id &gt; 1\n        select nid,name,gender as gg from \u8868 where id &gt; 1\n</code></pre> <p>5.\u5176\u5b83</p> <pre><code>1\u3001\u6761\u4ef6\n        select * from \u8868 where id &gt; 1 and name != 'zhaowencheng' and num = 12;\n\n        select * from \u8868 where id between 5 and 16;\n\n        select * from \u8868 where id in (11,22,33)\n        select * from \u8868 where id not in (11,22,33)\n        select * from \u8868 where id in (select nid from \u8868)\n\n    2\u3001\u901a\u914d\u7b26\n        select * from \u8868 where name like 'zhao%'  - zhao\u5f00\u5934\u7684\u6240\u6709\uff08\u591a\u4e2a\u5b57\u7b26\u4e32\uff09\n        select * from \u8868 where name like 'zhao_'  - zhao\u5f00\u5934\u7684\u6240\u6709\uff08\u4e00\u4e2a\u5b57\u7b26\uff09\n\n    3\u3001\u9650\u5236\n        select * from \u8868 limit 5;            - \u524d5\u884c\n        select * from \u8868 limit 4,5;          - \u4ece\u7b2c4\u884c\u5f00\u59cb\u76845\u884c\n        select * from \u8868 limit 5 offset 4    - \u4ece\u7b2c4\u884c\u5f00\u59cb\u76845\u884c\n\n    4\u3001\u6392\u5e8f\n        select * from \u8868 order by \u5217 asc              - \u6839\u636e \u201c\u5217\u201d \u4ece\u5c0f\u5230\u5927\u6392\u5217\n        select * from \u8868 order by \u5217 desc             - \u6839\u636e \u201c\u5217\u201d \u4ece\u5927\u5230\u5c0f\u6392\u5217\n        select * from \u8868 order by \u52171 desc,\u52172 asc    - \u6839\u636e \u201c\u52171\u201d \u4ece\u5927\u5230\u5c0f\u6392\u5217\uff0c\u5982\u679c\u76f8\u540c\u5219\u6309\u52172\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\n\n    5\u3001\u5206\u7ec4\n        select num from \u8868 group by num\n        select num,nid from \u8868 group by num,nid\n        select num,nid from \u8868  where nid &gt; 10 group by num,nid order nid desc\n        select num,nid,count(*),sum(score),max(score),min(score) from \u8868 group by num,nid\n\n        select num from \u8868 group by num having max(id) &gt; 10\n\n        \u7279\u522b\u7684\uff1agroup by \u5fc5\u987b\u5728where\u4e4b\u540e\uff0corder by\u4e4b\u524d\n\n    6\u3001\u8fde\u8868\n        \u65e0\u5bf9\u5e94\u5173\u7cfb\u5219\u4e0d\u663e\u793a\n        select A.num, A.name, B.name\n        from A,B\n        Where A.nid = B.nid\n\n        \u65e0\u5bf9\u5e94\u5173\u7cfb\u5219\u4e0d\u663e\u793a\n        select A.num, A.name, B.name\n        from A inner join B\n        on A.nid = B.nid\n\n        A\u8868\u6240\u6709\u663e\u793a\uff0c\u5982\u679cB\u4e2d\u65e0\u5bf9\u5e94\u5173\u7cfb\uff0c\u5219\u503c\u4e3anull\n        select A.num, A.name, B.name\n        from A left join B\n        on A.nid = B.nid\n\n        B\u8868\u6240\u6709\u663e\u793a\uff0c\u5982\u679cB\u4e2d\u65e0\u5bf9\u5e94\u5173\u7cfb\uff0c\u5219\u503c\u4e3anull\n        select A.num, A.name, B.name\n        from A right join B\n        on A.nid = B.nid\n\n    7\u3001\u7ec4\u5408\n        \u7ec4\u5408\uff0c\u81ea\u52a8\u5904\u7406\u91cd\u5408\n        select nickname\n        from A\n        union\n        select name\n        from B\n\n        \u7ec4\u5408\uff0c\u4e0d\u5904\u7406\u91cd\u5408\n        select nickname\n        from A\n        union all\n        select name\n        from B\n</code></pre>"},{"location":"python-mysql/#pymsql","title":"\u516d.pymsql","text":"<p>1.\u5b89\u88c5pymysql</p> <pre><code>\uff03\u76f4\u63a5pip\u5b89\u88c5\npip3 install pymysql\n</code></pre> <p>2.\u4f7f\u7528</p> <ul> <li>\u6267\u884csql</li> </ul> <pre><code>#!/usr/bin/env python\n# -*- coding:utf-8 -*-\nimport pymysql\n\n# \u521b\u5efa\u8fde\u63a5\nconn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1')\n# \u521b\u5efa\u6e38\u6807\ncursor = conn.cursor()\n\n# \u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u6536\u5f71\u54cd\u884c\u6570\neffect_row = cursor.execute(\"update hosts set host = '1.1.1.2'\")\n\n# \u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u53d7\u5f71\u54cd\u884c\u6570\n#effect_row = cursor.execute(\"update hosts set host = '1.1.1.2' where nid &gt; %s\", (1,))\n\n# \u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u53d7\u5f71\u54cd\u884c\u6570\n#effect_row = cursor.executemany(\"insert into hosts(host,color_id)values(%s,%s)\", [(\"1.1.1.11\",1),(\"1.1.1.11\",2)])\n\n\n# \u63d0\u4ea4\uff0c\u4e0d\u7136\u65e0\u6cd5\u4fdd\u5b58\u65b0\u5efa\u6216\u8005\u4fee\u6539\u7684\u6570\u636e\nconn.commit()\n\n# \u5173\u95ed\u6e38\u6807\ncursor.close()\n# \u5173\u95ed\u8fde\u63a5\nconn.close()\n</code></pre> <ul> <li>\u83b7\u53d6\u65b0\u521b\u5efa\u6570\u636e\u81ea\u589eID</li> </ul> <pre><code>#!/usr/bin/env python\n# -*- coding:utf-8 -*-\nimport pymysql\n\nconn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1')\ncursor = conn.cursor()\ncursor.executemany(\"insert into hosts(host,color_id)values(%s,%s)\", [(\"1.1.1.11\",1),(\"1.1.1.11\",2)])\nconn.commit()\ncursor.close()\nconn.close()\n\n# \u83b7\u53d6\u6700\u65b0\u81ea\u589eID\nnew_id = cursor.lastrowid\n</code></pre> <ul> <li>\u83b7\u53d6\u67e5\u8be2\u6570\u636e</li> </ul> <pre><code>#!/usr/bin/env python\n# -*- coding:utf-8 -*-\nimport pymysql\n\nconn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1')\ncursor = conn.cursor()\ncursor.execute(\"select * from hosts\")\n\n# \u83b7\u53d6\u7b2c\u4e00\u884c\u6570\u636e\nrow_1 = cursor.fetchone()\n\n# \u83b7\u53d6\u524dn\u884c\u6570\u636e\n# row_2 = cursor.fetchmany(3)\n# \u83b7\u53d6\u6240\u6709\u6570\u636e\n# row_3 = cursor.fetchall()\n\nconn.commit()\ncursor.close()\nconn.close()\n\n\u6ce8\uff1a\u5728fetch\u6570\u636e\u65f6\u6309\u7167\u987a\u5e8f\u8fdb\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528cursor.scroll(num,mode)\u6765\u79fb\u52a8\u6e38\u6807\u4f4d\u7f6e\uff0c\u5982\uff1a\ncursor.scroll(1,mode='relative')  # \u76f8\u5bf9\u5f53\u524d\u4f4d\u7f6e\u79fb\u52a8\ncursor.scroll(2,mode='absolute') # \u76f8\u5bf9\u7edd\u5bf9\u4f4d\u7f6e\u79fb\u52a8\n</code></pre> <ul> <li>fetch\u6570\u636e\u7c7b\u578b</li> </ul> <p>\u5173\u4e8e\u9ed8\u8ba4\u83b7\u53d6\u7684\u6570\u636e\u662f\u5143\u7956\u7c7b\u578b\uff0c\u5982\u679c\u60f3\u8981\u6216\u8005\u5b57\u5178\u7c7b\u578b\u7684\u6570\u636e\uff0c\u5373\uff1a</p> <pre><code>#!/usr/bin/env python\n# -*- coding:utf-8 -*-\nimport pymysql\n\nconn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1')\n\n# \u6e38\u6807\u8bbe\u7f6e\u4e3a\u5b57\u5178\u7c7b\u578b\ncursor = conn.cursor(cursor=pymysql.cursors.DictCursor)\nr = cursor.execute(\"call p1()\")\n\nresult = cursor.fetchone()\n\nconn.commit()\ncursor.close()\nconn.close()\n</code></pre>"},{"location":"python-styleguide/","title":"Python \u98ce\u683c\u6307\u5357 - \u5185\u5bb9\u76ee\u5f55","text":"<p>https://zh-google-styleguide.readthedocs.io/en/latest/google-python-styleguide/contents/</p>"},{"location":"python/","title":"python","text":""},{"location":"python/#python-3","title":"Python 3 \u90a3\u4e9b\u975e\u5e38\u89c4\u7684\u6280\u5de7","text":"<ul> <li>\u539f\u6587</li> </ul>"},{"location":"python/#_1","title":"\u5217\u8868\u63a8\u5bfc\u5f0f","text":"<p>\u4f60\u6709\u4e00\u4e2alist\uff1abag = [1, 2, 3, 4, 5]</p> <p>\u73b0\u5728\u4f60\u60f3\u8ba9\u6240\u6709\u5143\u7d20\u7ffb\u500d\uff0c\u8ba9\u5b83\u770b\u8d77\u6765\u662f\u8fd9\u4e2a\u6837\u5b50\uff1a[2, 4, 6, 8, 10]</p> <p>\u5927\u591a\u521d\u5b66\u8005\uff0c\u6839\u636e\u4e4b\u524d\u8bed\u8a00\u7684\u7ecf\u9a8c\u4f1a\u5927\u6982\u8fd9\u6837\u6765\u505a</p> <pre><code>bag = [1, 2, 3, 4, 5]\nfor i in range(len(bag)):\nbag[i] = bag[i] * 2\n</code></pre> <p>\u4f46\u662f\u6709\u66f4\u597d\u7684\u65b9\u6cd5\uff1a</p> <p><code>bag = [elem * 2 for elem in bag]</code></p> <p>\u5f88\u7b80\u6d01\u5bf9\u4e0d\u5bf9\uff1f\u8fd9\u53eb\u505aPython\u7684\u5217\u8868\u63a8\u5bfc\u5f0f\u3002</p> <p>\u70b9\u51fbTrey Hunner\u2019s tutorial[1]\u67e5\u770b\u66f4\u591a\u5173\u4e8e\u5217\u8868\u63a8\u5bfc\u5f0f\u7684\u4ecb\u7ecd\u3002</p>"},{"location":"python/#_2","title":"\u904d\u5386\u5217\u8868","text":"<p>\u7ee7\u7eed\uff0c\u8fd8\u662f\u4e0a\u9762\u7684\u5217\u8868\u3002</p> <p>\u5982\u679c\u53ef\u80fd\u5c3d\u91cf\u907f\u514d\u8fd9\u6837\u505a\uff1a</p> <pre><code>bag = [1, 2, 3, 4, 5]\nfor i in range(len(bag)):\nprint(bag[i])\n</code></pre> <p>\u53d6\u800c\u4ee3\u4e4b\u7684\u5e94\u8be5\u662f\u8fd9\u6837\uff1a</p> <pre><code>bag = [1, 2, 3, 4, 5]\nfor i in bag:\nprint(i)\n</code></pre> <p>\u5982\u679cx\u662f\u4e00\u4e2a\u5217\u8868\uff0c\u4f60\u53ef\u4ee5\u5bf9\u5b83\u7684\u5143\u7d20\u8fdb\u884c\u8fed\u4ee3\u3002\u591a\u6570\u60c5\u51b5\u4e0b\u4f60\u4e0d\u9700\u8981\u5404\u5143\u7d20\u7684\u7d22\u5f15\uff0c\u4f46\u5982\u679c\u4f60\u975e\u8981\u8fd9\u6837\u505a\uff0c\u90a3\u5c31\u7528enumerate\u51fd\u6570\u3002\u5b83\u50cf\u4e0b\u8fb9\u7684\u6837\u5b50\uff1a</p> <pre><code>bag = [1, 2, 3, 4, 5]\nfor index, element in enumerate(bag):\nprint(index, element)\n</code></pre> <p>\u975e\u5e38\u76f4\u89c2\u660e\u4e86\u3002</p>"},{"location":"python/#_3","title":"\u5143\u7d20\u4e92\u6362","text":"<p>\u5982\u679c\u4f60\u662f\u4ecejava\u6216\u8005C\u8bed\u8a00\u8f6c\u5230Python\u6765\uff0c\u53ef\u80fd\u4f1a\u4e60\u60ef\u4e8e\u8fd9\u6837\uff1a</p> <pre><code>a = 5\nb = 10\n\n# \u4ea4\u6362 a \u548c b\n\ntmp = a\na = b\nb = tmp\n</code></pre> <p>\u4f46Python\u63d0\u4f9b\u4e86\u4e00\u4e2a\u66f4\u81ea\u7136\u66f4\u597d\u7684\u65b9\u6cd5\uff01</p> <pre><code>a = 5\nb = 10\n\n# \u4ea4\u6362a \u548c b\n\na, b = b, a\n</code></pre> <p>\u591f\u6f02\u4eae\u5427\uff1f</p>"},{"location":"python/#_4","title":"\u521d\u59cb\u5316\u5217\u8868","text":"<p>\u5047\u5982\u4f60\u8981\u4e00\u4e2a\u662f10\u4e2a\u6574\u65700\u7684\u5217\u8868\uff0c\u4f60\u53ef\u80fd\u9996\u5148\u60f3\u5230\uff1a</p> <pre><code>bag =  \nfor _ in range(10):\nbag.append(0)\n</code></pre> <p>\u6362\u4e2a\u65b9\u5f0f\u5427\uff1a</p> <p><code>bag = [0] * 10</code></p> <p>\u770b\uff0c\u591a\u4f18\u96c5\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u4f60\u5217\u8868\u5305\u542b\u4e86\u5217\u8868\uff0c\u8fd9\u6837\u505a\u4f1a\u4ea7\u751f\u6d45\u62f7\u8d1d\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff1a</p> <pre><code>bag_of_bags = [[0]] * 5 # [[0], [0], [0], [0], [0]]\nbag_of_bags[0][0] = 1 # [[1], [1], [1], [1], [1]]\n</code></pre> <p>Oops\uff01\u6240\u6709\u7684\u5217\u8868\u90fd\u6539\u53d8\u4e86\uff0c\u800c\u6211\u4eec\u53ea\u662f\u60f3\u8981\u6539\u53d8\u7b2c\u4e00\u4e2a\u5217\u8868\u3002</p> <p>\u6539\u4e00\u6539\u5566\uff1a</p> <pre><code>bag_of_bags = [[0] for _ in range(5)]\n# [[0], [0], [0], [0], [0]]\nbag_of_bags[0][0] = 1\n# [[1], [0], [0], [0], [0]]\n</code></pre> <p>\u540c\u65f6\u8bb0\u4f4f\uff1a</p> <p>\u201c\u8fc7\u65e9\u4f18\u5316\u662f\u4e07\u6076\u4e4b\u6e90\u201d</p> <p>\u95ee\u95ee\u81ea\u5df1\uff0c\u521d\u59cb\u5316\u4e00\u4e2a\u5217\u8868\u662f\u5fc5\u987b\u7684\u5417\uff1f</p>"},{"location":"python/#_5","title":"\u6784\u9020\u5b57\u7b26\u4e32","text":"<p>\u4f60\u4f1a\u7ecf\u5e38\u9700\u8981\u6253\u5370\u5b57\u7b26\u4e32\u3002\u8981\u662f\u6709\u5f88\u591a\u53d8\u91cf\uff0c\u907f\u514d\u4e0b\u9762\u8fd9\u6837\uff1a</p> <pre><code>name = \"Raymond\"\nage = 22\nborn_in = \"Oakland, CA\"\nstring = \"Hello my name is \" + name + \"and I'm \" + str(age) + \" years old. I was born in \" + born_in + \".\"\nprint(string)\n</code></pre> <p>\u989d\uff0c\u8fd9\u770b\u8d77\u6765\u591a\u4e71\u5440\uff1f\u4f60\u53ef\u4ee5\u7528\u4e2a\u6f02\u4eae\u7b80\u6d01\u7684\u65b9\u6cd5\u6765\u4ee3\u66ff\uff0c.format\u3002</p> <p>\u8fd9\u6837\u505a\uff1a</p> <pre><code>name = \"Raymond\"\nage = 22\nborn_in = \"Oakland, CA\"\nstring = \"Hello my name is {0} and I'm {1} years old. I was born in {2}.\".format(name, age, born_in)\nprint(string)\n</code></pre> <p>\u597d\u591a\u4e86\uff01</p>"},{"location":"python/#_6","title":"\u8fd4\u56de","text":"<p>Python\u5141\u8bb8\u4f60\u5728\u4e00\u4e2a\u51fd\u6570\u4e2d\u8fd4\u56de\u591a\u4e2a\u5143\u7d20\uff0c\u8fd9\u8ba9\u751f\u6d3b\u66f4\u7b80\u5355\u3002\u4f46\u662f\u5728\u89e3\u5305\u5143\u7ec4\u7684\u65f6\u5019\u51fa\u51fa\u7ebf\u8fd9\u6837\u7684\u5e38\u89c1\u9519\u8bef\uff1a</p> <pre><code>def binary:\nreturn 0, 1\nresult = binary\nzero = result[0]\none = result[1]\n</code></pre> <p>\u8fd9\u662f\u6ca1\u5fc5\u8981\u7684\uff0c\u4f60\u5b8c\u5168\u53ef\u4ee5\u6362\u6210\u8fd9\u6837\uff1a</p> <pre><code>def binary:\nreturn 0, 1\nzero, one = binary\n\u8981\u662f\u4f60\u9700\u8981\u6240\u6709\u7684\u5143\u7d20\u88ab\u8fd4\u56de\uff0c\u7528\u4e2a\u4e0b\u5212\u7ebf_\uff1a\nzero, _ = binary\n</code></pre> <p>\u5c31\u662f\u8fd9\u4e48\u9ad8\u6548\u7387\uff01</p>"},{"location":"python/#_7","title":"\u8bbf\u95ee","text":"<p>\u4f60\u4e5f\u4f1a\u7ecf\u5e38\u7ed9dicts\u4e2d\u5199\u5165key\uff0cpair\uff08\u952e\uff0c\u503c\uff09\u3002</p> <p>\u5982\u679c\u4f60\u8bd5\u56fe\u8bbf\u95ee\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u4e8edict\u7684key\uff0c\u53ef\u80fd\u4f1a\u4e3a\u4e86\u907f\u514dKeyError\u9519\u8bef\uff0c\u4f60\u4f1a\u503e\u5411\u4e8e\u8fd9\u6837\u505a\uff1a</p> <pre><code>countr = {}\nbag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7]\nfor i in bag:\n    if i in countr:\n        countr[i] += 1\n    else:\n        countr[i] = 1\nfor i in range(10):\n    if i in countr:\n        print(\"Count of {}: {}\".format(i, countr[i]))\n    else:\n        print(\"Count of {}: {}\".format(i, 0))\n</code></pre> <p>\u4f46\u662f\uff0c\u7528get\u662f\u4e2a\u66f4\u597d\u7684\u529e\u6cd5\u3002</p> <pre><code>countr = {}\nbag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7]\nfor i in bag:\n    countr[i] = countr.get(i, 0) + 1\n    for i in range(10):\n        print(\"Count of {}: {}\".format(i, countr.get(i, 0)))\n\n\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u7528setdefault\u6765\u4ee3\u66ff\u3002\n</code></pre> <p>\u8fd9\u8fd8\u7528\u4e00\u4e2a\u66f4\u7b80\u5355\u5374\u591a\u8d39\u70b9\u5f00\u9500\u7684\u529e\u6cd5\uff1a</p> <pre><code>bag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7]\ncountr = dict([(num, bag.count(num)) for num in bag])\nfor i in range(10):\n    print(\"Count of {}: {}\".format(i, countr.get(i, 0)))\n</code></pre> <p>\u4f60\u4e5f\u53ef\u4ee5\u7528dict\u63a8\u5bfc\u5f0f\u3002</p> <p><code>countr = {num: bag.count(num) for num in bag}</code></p> <p>\u8fd9\u4e24\u79cd\u65b9\u6cd5\u5f00\u9500\u5927\u662f\u56e0\u4e3a\u5b83\u4eec\u5728\u6bcf\u6b21count\u88ab\u8c03\u7528\u65f6\u90fd\u4f1a\u5bf9\u5217\u8868\u904d\u5386\u3002</p>"},{"location":"python/#_8","title":"\u4f7f\u7528\u5e93","text":"<p>\u73b0\u6709\u7684\u5e93\u53ea\u9700\u5bfc\u5165\u4f60\u5c31\u53ef\u4ee5\u505a\u4f60\u771f\u6b63\u60f3\u505a\u7684\u4e86\u3002</p> <p>\u8fd8\u662f\u8bf4\u524d\u9762\u7684\u4f8b\u5b50\uff0c\u6211\u4eec\u5efa\u4e00\u4e2a\u51fd\u6570\u6765\u6570\u4e00\u4e2a\u6570\u5b57\u5728\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\u3002\u90a3\u4e48\uff0c\u5df2\u7ecf\u6709\u4e00\u4e2a\u5e93\u5c31\u53ef\u4ee5\u505a\u8fd9\u6837\u7684\u4e8b\u60c5\u3002</p> <pre><code>from collections import Counter\nbag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7]\ncountr = Counter(bag)\nfor i in range(10):\nprint(\"Count of {}: {}\".format(i, countr[i]))\n</code></pre> <p>\u4e00\u4e9b\u7528\u5e93\u7684\u7406\u7531\uff1a</p> <p>\u4ee3\u7801\u662f\u6b63\u786e\u800c\u4e14\u7ecf\u8fc7\u6d4b\u8bd5\u7684\u3002</p> <p>\u5b83\u4eec\u7684\u7b97\u6cd5\u53ef\u80fd\u4f1a\u662f\u6700\u4f18\u7684\uff0c\u8fd9\u6837\u5c31\u8dd1\u7684\u66f4\u5feb\u3002</p> <p>\u62bd\u8c61\u5316\uff1a\u5b83\u4eec\u6307\u5411\u660e\u786e\u800c\u4e14\u6587\u6863\u53cb\u597d\uff0c\u4f60\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u90a3\u4e9b\u8fd8\u6ca1\u6709\u88ab\u5b9e\u73b0\u7684\u3002</p> <p>\u6700\u540e\uff0c\u5b83\u90fd\u5df2\u7ecf\u5728\u90a3\u513f\u4e86\uff0c\u4f60\u4e0d\u7528\u518d\u9020\u8f6e\u5b50\u4e86\u3002</p>"},{"location":"python/#_9","title":"\u5728\u5217\u8868\u4e2d\u5207\u7247/\u6b65\u8fdb","text":"<p>\u4f60\u53ef\u4ee5\u6307\u5b9astart\u7684\u70b9\u548cstop\u70b9\uff0c\u5c31\u50cf\u8fd9\u6837list[start:stop:step]\u3002\u6211\u4eec\u53d6\u51fa\u5217\u8868\u4e2d\u7684\u524d5\u4e2a\u5143\u7d20\uff1a</p> <pre><code>bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\nfor elem in bag[:5]:\nprint(elem)\n</code></pre> <p>\u8fd9\u5c31\u662f\u5207\u7247\uff0c\u6211\u4eec\u6307\u5b9astop\u70b9\u662f5\uff0c\u518d\u505c\u6b62\u524d\u5c31\u4f1a\u4ece\u5217\u8868\u4e2d\u53d6\u51fa5\u4e2a\u5143\u7d20\u3002</p> <p>\u8981\u662f\u6700\u540e5\u4e2a\u5143\u7d20\u600e\u4e48\u505a\uff1f</p> <pre><code>bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n\nfor elem in bag[-5:]:\nprint(elem)\n</code></pre> <p>\u6ca1\u770b\u660e\u767d\u5417\uff1f-5\u610f\u5473\u7740\u4ece\u5217\u8868\u7684\u7ed3\u5c3e\u53d6\u51fa5\u4e2a\u5143\u7d20\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u5bf9\u5217\u8868\u4e2d\u5143\u7d20\u95f4\u9694\u64cd\u4f5c\uff0c\u4f60\u53ef\u80fd\u4f1a\u8fd9\u6837\u505a\uff1a</p> <pre><code>bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n\nfor index, elem in enumerate(bag):\nif index % 2 == 0:\nprint(elem)\n</code></pre> <p>\u4f46\u662f\u4f60\u5e94\u8be5\u8fd9\u6837\u6765\u505a\uff1a</p> <pre><code>bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n\nfor elem in bag[::2]:\nprint(elem)\n\n# \u6216\u8005\u7528 ranges\n\nbag = list(range(0,10,2))\nprint(bag)\n</code></pre> <p>\u8fd9\u5c31\u662f\u5217\u8868\u4e2d\u7684\u6b65\u8fdb\u3002list[::2]\u610f\u601d\u662f\u904d\u5386\u5217\u8868\u540c\u65f6\u4e24\u6b65\u53d6\u51fa\u4e00\u4e2a\u5143\u7d20\u3002</p> <p>\u4f60\u53ef\u4ee5\u7528list[::-1]\u5f88\u9177\u7684\u7ffb\u8f6c\u5217\u8868\u3002</p>"},{"location":"python/#tab","title":"tab\u952e\u8fd8\u662f\u7a7a\u683c\u952e","text":"<p>\u957f\u65f6\u95f4\u6765\u770b\uff0c\u5c06tab\u548c\u7a7a\u683c\u6df7\u5728\u4e00\u8d77\u4f1a\u9020\u6210\u707e\u96be\uff0c\u4f60\u4f1a\u770b\u5230IndentationError: unexpected indent\u3002\u4e0d\u7ba1\u4f60\u9009\u62e9tab\u952e\u8fd8\u662f\u7a7a\u683c\u952e\uff0c\u4f60\u5e94\u8be5\u5728\u4f60\u7684\u6587\u4ef6\u548c\u9879\u76ee\u4e2d\u4e00\u76f4\u4fdd\u6301\u4f7f\u7528\u3002</p> <p>\u4e00\u4e2a\u4f7f\u7528\u7a7a\u683c\u800c\u4e0d\u662ftab\u7684\u539f\u56e0\u662f\uff0ctab\u4e0d\u662f\u5728\u6240\u6709\u7f16\u8f91\u5668\u4e2d\u90fd\u4e00\u6837\u7684\u3002\u89c6\u5462\u6240\u7528\u7684\u7f16\u8f91\u5668\uff0ctab\u53ef\u80fd\u4f1a\u88ab\u5f53\u4f5c2\u52308\u4e2a\u7a7a\u683c\u3002</p> <p>\u4f60\u4e5f\u53ef\u4ee5\u5728\u5199\u4ee3\u7801\u65f6\u7528\u7a7a\u683c\u6765\u5b9a\u4e49tab\u3002\u8fd9\u6837\u4f60\u53ef\u4ee5\u81ea\u5df1\u9009\u62e9\u7528\u51e0\u4e2a\u7a7a\u683c\u6765\u5f53\u505atab\u3002\u5927\u591a\u6570Python\u7528\u6237\u662f\u75284\u4e2a\u7a7a\u683c\u3002</p>"},{"location":"python/#for1","title":"for\u6587\u51e6\u7406\u304c1\u884c\u3067\u66f8\u3051\u308b\uff01\u7d20\u6575\u306a\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18","text":"<ul> <li>\u539f\u6587</li> </ul>"},{"location":"python/#1","title":"1\u884c\u3067\u66f8\u304f\u30ea\u30b9\u30c8\u51e6\u7406","text":"<p>\u3055\u3063\u305d\u304f\u30ea\u30b9\u30c8\u5185\u5305\u8a18\u8ff0\uff08list comprehension\uff09\u3092\u6271\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u4eca\u56de\u306f\u4ee5\u4e0b\u306e\u914d\u5217\u30c7\u30fc\u30bf\u3092\u6271\u3046\u3053\u3068\u3068\u3057\u307e\u3059\u3002</p> <pre><code>data = [1, 2, 3, 4, 5] \u3053\u306e\u914d\u5217\u306b\u3064\u3044\u3066\u3001\u5404\u8981\u7d20\u306e\u5024\u30922\u500d\u306b\u3059\u308b\u51e6\u7406\u3092\u901a\u5e38\u306efor\u6587\u3067\u8a18\u8ff0\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\n</code></pre>"},{"location":"python/#data2","title":"data\u914d\u5217\u306e\u4e2d\u8eab\u30922\u500d\u306b\u3059\u308b","text":"<pre><code>newData = []\nfor d in data:\n  newData.append(d * 2)\n</code></pre> <p>\u3053\u306e3\u884c\u306e\u5b9f\u88c5\u3092\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3067\u8a18\u8ff0\u3059\u308b\u30681\u884c\u3067\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u7d20\u6575\uff01</p>"},{"location":"python/#data2_1","title":"data\u914d\u5217\u306e\u4e2d\u8eab\u30922\u500d\u306b\u3059\u308b","text":"<pre><code>newData = [d * 2 for d in data] \n</code></pre> <p>\u3053\u306e\u66f8\u304d\u65b9\u306f\u30b7\u30f3\u30d7\u30eb\u3060\u3057\u76f4\u611f\u7684\u306b\u7406\u89e3\u3067\u304d\u308b\u306e\u3067\u3001\u306a\u304b\u306a\u304b\u4fbf\u5229\u3067\u3059\u3002</p>"},{"location":"python/#1if","title":"1\u884c\u3067\u66f8\u304f\u30ea\u30b9\u30c8\u51e6\u7406\uff08if\u6587\u4ed8\u304d\uff09","text":"<p>\u3055\u3089\u306b\u3001\u51e6\u7406\u306e\u4e2d\u3067\u6761\u4ef6\u5f0f\uff08if\u6587\uff09\u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070\u5076\u6570\u306e\u307f\u51e6\u7406\u3057\u305f\u3044\u5834\u5408\u306b\u3001\u901a\u5e38\u306e\u66f8\u304d\u65b9\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>newData = []\nfor d in data:\n    if d % 2 == 0:\n        newData.append(d * 2)\n</code></pre> <p>\u4e0a\u8a18\u306e\u5834\u5408\u306b\u306f4\u884c\u306e\u5b9f\u88c5\u3067\u3059\u304c\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3060\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b1\u884c\u3067\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>newData = [d * 2 for d in data if d % 2 == 0]\n</code></pre> <p>\u30aa\u30e9\u30a4\u30ea\u30fc\u306e\u672c\u3084Web\u4e0a\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3082\u826f\u304f\u898b\u308b\u8a18\u8ff0\u306a\u306e\u3067\u3001\u3053\u306e\u8a18\u8ff0\u306f\u8aad\u307f\u66f8\u304d\u3067\u304d\u308b\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002</p>"},{"location":"python/#filter","title":"\u30e9\u30e0\u30c0\u5f0f\uff0bfilter\u3067\u540c\u3058\u3053\u3068\u3092\u5b9f\u73fe\u3067\u304d\u308b","text":"<p>\u30e9\u30e0\u30c0\u5f0f\u3067\u3082\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3068\u540c\u3058\u3088\u3046\u306b\u30011\u884c\u3067\u51e6\u7406\u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>newData = []\nfor d in data:\n    if d % 2 == 0:\n        newData.append(d)\n</code></pre> <p>\u3053\u308c\u3092\u30e9\u30e0\u30c0\u5f0f\u3067\u66f8\u304f\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002</p> <pre><code>newData = filter(lambda x:x%2==0, data)\n</code></pre> <p>\u3053\u306e\u8a18\u8ff0\u3082\u306a\u304b\u306a\u304b\u826f\u3055\u305d\u3046\u3067\u3059\u306d\uff01\u305f\u3060\u30e9\u30e0\u30c0\u5f0f\u306e\u5834\u5408\u306b\u306f\u3001filter\u3057\u305f\u5f8c\u306b\u6f14\u7b97\u3092\u884c\u3046\uff08\u4f8b\uff1a\u5024\u30922\u500d\u306b\u3059\u308b\uff09\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306e\u65b9\u304c\u3088\u308a\u67d4\u8edf\u306b\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"python/#_10","title":"\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306f\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3082\u826f\u3044","text":"<p>\u901a\u5e38\u306efor\u6587\u3092\u66f8\u304f\u3088\u308a\u3082\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306e\u65b9\u304c\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u826f\u3044\u3067\u3059\u3002\u3044\u304f\u3064\u304b\u8abf\u3079\u305f\u60c5\u5831\u306b\u3088\u308b\u3068\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3067for\u51e6\u7406\u3059\u308c\u3070\u3001\u8a18\u8ff0\u3057\u305f\u6587\u6cd5\u3092C\u8a00\u8a9e\u30ec\u30d9\u30eb\u3067\u51e6\u7406\u3059\u308b\u305f\u3081\u901f\u3044\u3068\u306e\u3053\u3068\u3002\u5b9f\u969b\u306b\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002</p> <pre><code>import time\n\n# \u5229\u7528\u3059\u308b\u30c7\u30fc\u30bf\ndata = [i for i in range(1, 1000000)]\n\n# \u901a\u5e38\u306efor\u6587\ntime1 = time.clock()\nnewData = []\nfor d in data:\n    if d % 2 == 0:\n        newData.append(d)\ntime2 = time.clock()\nprint time2 - time1 #0.234422\u79d2\n\n# \u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18    \ntime1 = time.clock()\nnewData = [d for d in data if d % 2 == 0]\ntime2 = time.clock()\nprint time2 - time1 #0.185301\u79d2\n\n# filter\u3068\u30e9\u30e0\u30c0\u5f0f\ntime1 = time.clock()\nnewData = filter(lambda x:x%2==0, data)\ntime2 = time.clock()\nprint time2 - time1 #0.184838\n</code></pre> <p>\u4f55\u5ea6\u304b\u8a66\u3057\u305f\u3068\u3053\u308d\u3001\u4e0a\u8a18\u4f8b\u306e\u5834\u5408\u306b\u306f\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306f\u901a\u5e38\u306efor\u6587\u8a18\u8ff0\u3088\u308a\u308222\uff05\u9ad8\u901f\u3067\u3057\u305f\uff08\u50d5\u306eMacBookAir\u306e\u5834\u5408\uff09\u3002</p>"},{"location":"sar/","title":"sar","text":""},{"location":"sar/#sar-linux","title":"sar \u2014\u2014 Linux \u4e0a\u6700\u4e3a\u5168\u9762\u7684\u7cfb\u7edf\u6027\u80fd\u5206\u6790\u5de5\u5177\u4e4b\u4e00","text":"<p><code>sar</code></p> <p>\uff08System Activity Reporter \u7cfb\u7edf\u6d3b\u52a8\u60c5\u51b5\u62a5\u544a\uff09\u662f\u76ee\u524d Linux \u4e0a\u6700\u4e3a\u5168\u9762\u7684\u7cfb\u7edf\u6027\u80fd\u5206\u6790\u5de5\u5177\u4e4b\u4e00\uff0c\u53ef\u4ee5\u4ece\u591a\u65b9\u9762\u5bf9\u7cfb\u7edf\u7684\u6d3b\u52a8\u8fdb\u884c\u62a5\u544a\uff0c\u5305\u62ec\uff1a\u6587\u4ef6\u7684\u8bfb\u5199\u60c5\u51b5\u3001\u7cfb\u7edf\u8c03\u7528\u7684\u4f7f\u7528\u60c5\u51b5\u3001\u78c1\u76d8 I/O\u3001CPU \u6548\u7387\u3001\u5185\u5b58\u4f7f\u7528\u72b6\u51b5\u3001\u8fdb\u7a0b\u6d3b\u52a8\u53ca IPC \u6709\u5173\u7684\u6d3b\u52a8\u7b49\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>sar</code>\u547d\u4ee4\u6765\u83b7\u5f97\u6574\u4e2a\u7cfb\u7edf\u6027\u80fd\u7684\u62a5\u544a\u3002\u8fd9\u6709\u52a9\u4e8e\u6211\u4eec\u5b9a\u4f4d\u7cfb\u7edf\u6027\u80fd\u7684\u74f6\u9888\uff0c\u5e76\u4e14\u6709\u52a9\u4e8e\u6211\u4eec\u627e\u51fa\u8fd9\u4e9b\u70e6\u4eba\u7684\u6027\u80fd\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5\u3002</p> <p>Linux \u5185\u6838\u7ef4\u62a4\u7740\u4e00\u4e9b\u5185\u90e8\u8ba1\u6570\u5668\uff0c\u8fd9\u4e9b\u8ba1\u6570\u5668\u5305\u542b\u4e86\u6240\u6709\u7684\u8bf7\u6c42\u53ca\u5176\u5b8c\u6210\u65f6\u95f4\u548c I/O \u5757\u6570\u7b49\u4fe1\u606f\uff0c<code>sar</code>\u547d\u4ee4\u4ece\u6240\u6709\u7684\u8fd9\u4e9b\u4fe1\u606f\u4e2d\u8ba1\u7b97\u51fa\u8bf7\u6c42\u7684\u5229\u7528\u7387\u548c\u6bd4\u4f8b\uff0c\u4ee5\u4fbf\u627e\u51fa\u74f6\u9888\u6240\u5728\u3002</p> <p><code>sar</code>\u547d\u4ee4\u4e3b\u8981\u7684\u7528\u9014\u662f\u751f\u6210\u67d0\u6bb5\u65f6\u95f4\u5185\u6240\u6709\u6d3b\u52a8\u7684\u62a5\u544a\uff0c\u56e0\u6b64\u5fc5\u9700\u786e\u4fdd<code>sar</code>\u547d\u4ee4\u5728\u9002\u5f53\u7684\u65f6\u95f4\u8fdb\u884c\u6570\u636e\u91c7\u96c6\uff08\u800c\u4e0d\u662f\u5728\u5348\u9910\u65f6\u95f4\u6216\u8005\u5468\u672b\uff09</p> <p>\u539f\u6587\u5730\u5740: https://shockerli.net/post/li...</p>"},{"location":"sar/#_1","title":"\u547d\u4ee4\u53c2\u6570","text":"<pre><code>\u7528\u6cd5: sar [ \u9009\u9879 ] [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n\n\u4e3b\u9009\u9879\u548c\u62a5\u544a\uff1a\n    -b    I/O \u548c\u4f20\u8f93\u901f\u7387\u4fe1\u606f\u72b6\u51b5\n    -B    \u5206\u9875\u72b6\u51b5\n    -d    \u5757\u8bbe\u5907\u72b6\u51b5\n    -I { &lt;\u4e2d\u65ad&gt; | SUM | ALL | XALL }\n        \u4e2d\u65ad\u4fe1\u606f\u72b6\u51b5\n    -m    \u7535\u6e90\u7ba1\u7406\u4fe1\u606f\u72b6\u51b5\n    -n { &lt;\u5173\u952e\u8bcd&gt; [,...] | ALL }\n        \u7f51\u7edc\u7edf\u8ba1\u4fe1\u606f\n        \u5173\u952e\u8bcd\u53ef\u4ee5\u662f\uff1a\n        DEV     \u7f51\u5361\n        EDEV     \u7f51\u5361 (\u9519\u8bef)\n        NFS     NFS \u5ba2\u6237\u7aef\n        NFSD     NFS \u670d\u52a1\u5668\n        SOCK     Sockets (\u5957\u63a5\u5b57)    (v4)\n        IP    IP  \u6d41          (v4)\n        EIP     IP \u6d41       (v4) (\u9519\u8bef)\n        ICMP     ICMP \u6d41    (v4)\n        EICMP     ICMP \u6d41    (v4) (\u9519\u8bef)\n        TCP     TCP \u6d41  (v4)\n        ETCP     TCP \u6d41  (v4) (\u9519\u8bef)\n        UDP     UDP \u6d41  (v4)\n        SOCK6     Sockets (\u5957\u63a5\u5b57)    (v6)\n        IP6     IP \u6d41       (v6)\n        EIP6     IP \u6d41       (v6) (\u9519\u8bef)\n        ICMP6     ICMP \u6d41 (v6)\n        EICMP6 ICMP \u6d41 (v6) (\u9519\u8bef)\n        UDP6    UDP \u6d41       (v6)\n    -q    \u961f\u5217\u957f\u5ea6\u548c\u5e73\u5747\u8d1f\u8f7d\n    -r    \u5185\u5b58\u5229\u7528\u7387\n    -R    \u5185\u5b58\u72b6\u51b5\n    -S    \u4ea4\u6362\u7a7a\u95f4\u5229\u7528\u7387\n    -u [ ALL ]\n        CPU \u5229\u7528\u7387\n    -v    Kernel table \u72b6\u51b5\n    -w    \u4efb\u52a1\u521b\u5efa\u4e0e\u7cfb\u7edf\u8f6c\u6362\u7edf\u8ba1\u4fe1\u606f\n    -W    \u4ea4\u6362\u4fe1\u606f\n    -y    TTY \u8bbe\u5907\u72b6\u51b5\n    -o {&lt;\u6587\u4ef6\u8def\u5f84&gt;}\n       \u5c06\u547d\u4ee4\u7ed3\u679c\u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u5b58\u653e\u5728\u6307\u5b9a\u6587\u4ef6\u4e2d\n</code></pre>"},{"location":"sar/#_2","title":"\u5e38\u7528\u547d\u4ee4","text":"<p><code>sar</code>\u547d\u4ee4\u6765\u81ea\u4e8e<code>sysstat</code>\u5de5\u5177\u5305\uff0c\u5982\u679c\u63d0\u793a<code>sar</code>\u547d\u4ee4\u4e0d\u5b58\u5728\uff0c\u9700\u5148\u5b89\u88c5<code>sysstat</code>\u3002</p>"},{"location":"sar/#_3","title":"\u7f51\u7edc\u7edf\u8ba1\u4fe1\u606f","text":"<pre><code>sar -n &lt;\u5173\u952e\u8bcd&gt; [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -n DEV 1 5\n\n\u5e73\u5747\u65f6\u95f4:     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s\n\u5e73\u5747\u65f6\u95f4:        lo      2.21      2.21      0.18      0.18      0.00      0.00      0.00\n\u5e73\u5747\u65f6\u95f4:      eth0      4.62      3.82      0.37      1.90      0.00      0.00      0.00\n</code></pre> <p>\u547d\u4ee4\u4e2d 1 5 \u8868\u793a\u6bcf\u4e00\u79d2\u949f\u53d6 1 \u6b21\u503c\uff0c\u4e00\u5171\u53d6 5 \u6b21\u3002</p> <p>\u547d\u4ee4\u6267\u884c\u540e\u4f1a\u5217\u51fa\u6bcf\u4e2a\u7f51\u5361\u8fd9 5 \u6b21\u53d6\u503c\u7684\u5e73\u5747\u6570\u636e\uff0c\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u6765\u786e\u5b9a\u5e26\u5bbd\u8dd1\u6ee1\u7684\u7f51\u5361\u540d\u79f0\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b eth0 \u4e3a\u5185\u7f51\u7f51\u5361\uff0ceth1 \u4e3a\u5916\u7f51\u7f51\u5361\u3002</p>"},{"location":"sar/#cpu","title":"CPU \u5229\u7528\u7387","text":"<pre><code>sar -u [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -u 1 3\n\nLinux 2.6.32-642.13.1.el6.x86_64 (upfor106) 2018\u5e7404\u670825\u65e5 _x86_64_ (1 CPU)\n\n10\u65f633\u520608\u79d2     CPU     %user     %nice   %system   %iowait    %steal     %idle\n10\u65f633\u520609\u79d2     all      0.00      0.00      0.00      0.00      0.00    100.00\n10\u65f633\u520610\u79d2     all      0.99      0.00      0.99      0.00      0.00     98.02\n10\u65f633\u520611\u79d2     all      0.00      0.00      0.00      0.00      0.00    100.00\n\u5e73\u5747\u65f6\u95f4:        all      0.33      0.00      0.33      0.00      0.00     99.33\n</code></pre> <p>\u547d\u4ee4\u4e2d 1 3 \u8868\u793a\u6bcf\u4e00\u79d2\u949f\u53d6 1 \u6b21\u503c\uff0c\u4e00\u5171\u53d6 3 \u6b21\u3002</p> <p>\u8f93\u51fa\u9879\u8bf4\u660e\uff1a</p> <pre><code>CPU\uff1aall \u8868\u793a\u7edf\u8ba1\u4fe1\u606f\u4e3a\u6240\u6709 CPU \u7684\u5e73\u5747\u503c\u3002\n\n%user\uff1a\u663e\u793a\u5728\u7528\u6237\u7ea7\u522b(application)\u8fd0\u884c\u4f7f\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4\n\n%nice\uff1a\u663e\u793a\u5728\u7528\u6237\u7ea7\u522b\uff0c\u7528\u4e8enice\u64cd\u4f5c\uff0c\u6240\u5360\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4\n\n%system\uff1a\u5728\u6838\u5fc3\u7ea7\u522b(kernel)\u8fd0\u884c\u6240\u4f7f\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4\n\n%iowait\uff1a\u663e\u793a\u7528\u4e8e\u7b49\u5f85I/O\u64cd\u4f5c\u5360\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4\n\n%steal\uff1a\u7ba1\u7406\u7a0b\u5e8f(hypervisor)\u4e3a\u53e6\u4e00\u4e2a\u865a\u62df\u8fdb\u7a0b\u63d0\u4f9b\u670d\u52a1\u800c\u7b49\u5f85\u865a\u62df CPU \u7684\u767e\u5206\u6bd4\n\n%idle\uff1a\u663e\u793a CPU \u7a7a\u95f2\u65f6\u95f4\u5360\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4\n\n    1. \u82e5 %iowait \u7684\u503c\u8fc7\u9ad8\uff0c\u8868\u793a\u786c\u76d8\u5b58\u5728I/O\u74f6\u9888\n\n    2. \u82e5 %idle \u7684\u503c\u9ad8\u4f46\u7cfb\u7edf\u54cd\u5e94\u6162\u65f6\uff0c\u6709\u53ef\u80fd\u662f CPU \u7b49\u5f85\u5206\u914d\u5185\u5b58\uff0c\u6b64\u65f6\u5e94\u52a0\u5927\u5185\u5b58\u5bb9\u91cf\n\n    3. \u82e5 %idle \u7684\u503c\u6301\u7eed\u4f4e\u4e8e1\uff0c\u5219\u7cfb\u7edf\u7684 CPU \u5904\u7406\u80fd\u529b\u76f8\u5bf9\u8f83\u4f4e\uff0c\u8868\u660e\u7cfb\u7edf\u4e2d\u6700\u9700\u8981\u89e3\u51b3\u7684\u8d44\u6e90\u662f CPU\n</code></pre>"},{"location":"sar/#_4","title":"\u7d22\u5f15\u8282\u70b9\uff0c\u6587\u4ef6\u548c\u5176\u4ed6\u5185\u6838\u8868\u7684\u72b6\u6001","text":"<pre><code>sar -v [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -v 1 3\n\nLinux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU)\n\n10\u65f650\u520629\u79d2 dentunusd   file-nr  inode-nr    pty-nr\n10\u65f650\u520630\u79d2    920045       864     13910         2\n10\u65f650\u520631\u79d2    920045       864     13910         2\n10\u65f650\u520632\u79d2    920045       896     13910         2\n\u5e73\u5747\u65f6\u95f4:       920045       875     13910         2\n</code></pre> <p>\u8f93\u51fa\u9879\u8bf4\u660e\uff1a</p> <pre><code>dentunusd\uff1a\u76ee\u5f55\u9ad8\u901f\u7f13\u5b58\u4e2d\u672a\u88ab\u4f7f\u7528\u7684\u6761\u76ee\u6570\u91cf\n\nfile-nr\uff1a\u6587\u4ef6\u53e5\u67c4\uff08file handle\uff09\u7684\u4f7f\u7528\u6570\u91cf\n\ninode-nr\uff1a\u7d22\u5f15\u8282\u70b9\u53e5\u67c4\uff08inode handle\uff09\u7684\u4f7f\u7528\u6570\u91cf\n\npty-nr\uff1a\u4f7f\u7528\u7684 pty \u6570\u91cf\n</code></pre>"},{"location":"sar/#_5","title":"\u5185\u5b58\u5229\u7528\u7387","text":"<pre><code>sar -r [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -r 1 3\n\nLinux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU)\n\n10\u65f653\u520600\u79d2 kbmemfree kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit\n10\u65f653\u520601\u79d2   2027760   2028732     50.01    145492   1243820   1163900     28.69\n10\u65f653\u520602\u79d2   2027620   2028872     50.02    145492   1243820   1163896     28.69\n10\u65f653\u520603\u79d2   2028100   2028392     50.00    145492   1243820   1163900     28.69\n\u5e73\u5747\u65f6\u95f4:      2027827   2028665     50.01    145492   1243820   1163899     28.69\n</code></pre> <p>\u8f93\u51fa\u9879\u8bf4\u660e\uff1a</p> <pre><code>kbmemfree\uff1a\u8fd9\u4e2a\u503c\u548c free \u547d\u4ee4\u4e2d\u7684 free \u503c\u57fa\u672c\u4e00\u81f4\uff0c\u6240\u4ee5\u5b83\u4e0d\u5305\u62ec buffer \u548c cache \u7684\u7a7a\u95f4\n\nkbmemused\uff1a\u8fd9\u4e2a\u503c\u548c free \u547d\u4ee4\u4e2d\u7684 used \u503c\u57fa\u672c\u4e00\u81f4,\u6240\u4ee5\u5b83\u5305\u62ec buffer \u548c cache \u7684\u7a7a\u95f4\n\n%memused\uff1a\u8fd9\u4e2a\u503c\u662f kbmemused \u548c\u5185\u5b58\u603b\u91cf(\u4e0d\u5305\u62ec swap)\u7684\u4e00\u4e2a\u767e\u5206\u6bd4\n\nkbbuffers \u548c kbcached\uff1a\u8fd9\u4e24\u4e2a\u503c\u5c31\u662f free \u547d\u4ee4\u4e2d\u7684 buffer \u548c cache\n\nkbcommit\uff1a\u4fdd\u8bc1\u5f53\u524d\u7cfb\u7edf\u6240\u9700\u8981\u7684\u5185\u5b58\uff0c\u5373\u4e3a\u4e86\u786e\u4fdd\u4e0d\u6ea2\u51fa\u800c\u9700\u8981\u7684\u5185\u5b58(RAM + swap)\n\n%commit\uff1a\u8fd9\u4e2a\u503c\u662f kbcommit \u4e0e\u5185\u5b58\u603b\u91cf(\u5305\u62ec swap)\u7684\u4e00\u4e2a\u767e\u5206\u6bd4\n</code></pre>"},{"location":"sar/#_6","title":"\u5185\u5b58\u5206\u9875\u72b6\u51b5","text":"<pre><code>sar -B [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -B 1 3\n\nLinux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU)\n\n10\u65f655\u520641\u79d2  pgpgin/s pgpgout/s   fault/s  majflt/s  pgfree/s pgscank/s pgscand/s pgsteal/s    %vmeff\n10\u65f655\u520642\u79d2      0.00      0.00   5723.76      0.00   3356.44      0.00      0.00      0.00      0.00\n10\u65f655\u520643\u79d2      0.00      0.00   1185.00      0.00    312.00      0.00      0.00      0.00      0.00\n10\u65f655\u520644\u79d2      0.00      0.00     27.00      0.00     56.00      0.00      0.00      0.00      0.00\n\u5e73\u5747\u65f6\u95f4:         0.00      0.00   2323.26      0.00   1248.50      0.00      0.00      0.00      0.00\n</code></pre> <p>\u8f93\u51fa\u9879\u8bf4\u660e\uff1a</p> <pre><code>pgpgin/s\uff1a\u8868\u793a\u6bcf\u79d2\u4ece\u78c1\u76d8\u6216SWAP\u7f6e\u6362\u5230\u5185\u5b58\u7684\u5b57\u8282\u6570(KB)\n\npgpgout/s\uff1a\u8868\u793a\u6bcf\u79d2\u4ece\u5185\u5b58\u7f6e\u6362\u5230\u78c1\u76d8\u6216SWAP\u7684\u5b57\u8282\u6570(KB)\n\nfault/s\uff1a\u6bcf\u79d2\u949f\u7cfb\u7edf\u4ea7\u751f\u7684\u7f3a\u9875\u6570\uff0c\u5373\u4e3b\u7f3a\u9875\u4e0e\u6b21\u7f3a\u9875\u4e4b\u548c(major + minor)\n\nmajflt/s\uff1a\u6bcf\u79d2\u949f\u4ea7\u751f\u7684\u4e3b\u7f3a\u9875\u6570\n\npgfree/s\uff1a\u6bcf\u79d2\u88ab\u653e\u5165\u7a7a\u95f2\u961f\u5217\u4e2d\u7684\u9875\u4e2a\u6570\n\npgscank/s\uff1a\u6bcf\u79d2\u88ab kswapd \u626b\u63cf\u7684\u9875\u4e2a\u6570\n\npgscand/s\uff1a\u6bcf\u79d2\u76f4\u63a5\u88ab\u626b\u63cf\u7684\u9875\u4e2a\u6570\n\npgsteal/s\uff1a\u6bcf\u79d2\u949f\u4ece cache \u4e2d\u88ab\u6e05\u9664\u6765\u6ee1\u8db3\u5185\u5b58\u9700\u8981\u7684\u9875\u4e2a\u6570\n\n%vmeff\uff1a\u6bcf\u79d2\u6e05\u9664\u7684\u9875(pgsteal)\u5360\u603b\u626b\u63cf\u9875(pgscank + pgscand)\u7684\u767e\u5206\u6bd4\n</code></pre>"},{"location":"sar/#io","title":"I/O \u548c\u4f20\u8f93\u901f\u7387\u4fe1\u606f\u72b6\u51b5","text":"<pre><code>sar -b [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -b 1 3\n\nLinux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU)\n\n10\u65f658\u520615\u79d2       tps      rtps      wtps   bread/s   bwrtn/s\n10\u65f658\u520616\u79d2      7.00      0.00      7.00      0.00     64.00\n10\u65f658\u520617\u79d2      4.04      0.00      4.04      0.00     80.81\n10\u65f658\u520618\u79d2      0.00      0.00      0.00      0.00      0.00\n\u5e73\u5747\u65f6\u95f4:         3.67      0.00      3.67      0.00     48.00\n</code></pre> <p>\u8f93\u51fa\u9879\u8bf4\u660e\uff1a</p> <pre><code>tps\uff1a\u6bcf\u79d2\u949f\u7269\u7406\u8bbe\u5907\u7684 I/O \u4f20\u8f93\u603b\u91cf\n\nrtps\uff1a\u6bcf\u79d2\u949f\u4ece\u7269\u7406\u8bbe\u5907\u8bfb\u5165\u7684\u6570\u636e\u603b\u91cf\n\nwtps\uff1a\u6bcf\u79d2\u949f\u5411\u7269\u7406\u8bbe\u5907\u5199\u5165\u7684\u6570\u636e\u603b\u91cf\n\nbread/s\uff1a\u6bcf\u79d2\u949f\u4ece\u7269\u7406\u8bbe\u5907\u8bfb\u5165\u7684\u6570\u636e\u91cf\uff0c\u5355\u4f4d\u4e3a\uff1a\u5757/s\n\nbwrtn/s\uff1a\u6bcf\u79d2\u949f\u5411\u7269\u7406\u8bbe\u5907\u5199\u5165\u7684\u6570\u636e\u91cf\uff0c\u5355\u4f4d\u4e3a\uff1a\u5757/s\n</code></pre>"},{"location":"sar/#_7","title":"\u961f\u5217\u957f\u5ea6\u548c\u5e73\u5747\u8d1f\u8f7d","text":"<pre><code>sar -q [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -q 1 3\n\nLinux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU)\n\n11\u65f600\u520635\u79d2   runq-sz  plist-sz   ldavg-1   ldavg-5  ldavg-15\n11\u65f600\u520636\u79d2         0       268      0.00      0.00      0.00\n11\u65f600\u520637\u79d2         0       268      0.00      0.00      0.00\n11\u65f600\u520638\u79d2         0       268      0.00      0.00      0.00\n\u5e73\u5747\u65f6\u95f4:            0       268      0.00      0.00      0.00\n</code></pre> <p>\u8f93\u51fa\u9879\u8bf4\u660e\uff1a</p> <pre><code>runq-sz\uff1a\u8fd0\u884c\u961f\u5217\u7684\u957f\u5ea6\uff08\u7b49\u5f85\u8fd0\u884c\u7684\u8fdb\u7a0b\u6570\uff09\n\nplist-sz\uff1a\u8fdb\u7a0b\u5217\u8868\u4e2d\u8fdb\u7a0b\uff08processes\uff09\u548c\u7ebf\u7a0b\uff08threads\uff09\u7684\u6570\u91cf\n\nldavg-1\uff1a\u6700\u540e1\u5206\u949f\u7684\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d\uff08System load average\uff09\n\nldavg-5\uff1a\u8fc7\u53bb5\u5206\u949f\u7684\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d\n\nldavg-15\uff1a\u8fc7\u53bb15\u5206\u949f\u7684\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d\n</code></pre>"},{"location":"sar/#_8","title":"\u7cfb\u7edf\u4ea4\u6362\u4fe1\u606f","text":"<pre><code>sar -W [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -W 1 3\n\nLinux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU)\n\n11\u65f601\u520645\u79d2  pswpin/s pswpout/s\n11\u65f601\u520646\u79d2      0.00      0.00\n11\u65f601\u520647\u79d2      0.00      0.00\n11\u65f601\u520648\u79d2      0.00      0.00\n\u5e73\u5747\u65f6\u95f4:         0.00      0.00\n</code></pre> <p>\u8f93\u51fa\u9879\u8bf4\u660e\uff1a</p> <pre><code>pswpin/s\uff1a\u6bcf\u79d2\u7cfb\u7edf\u6362\u5165\u7684\u4ea4\u6362\u9875\u9762\uff08swap page\uff09\u6570\u91cf\npswpout/s\uff1a\u6bcf\u79d2\u7cfb\u7edf\u6362\u51fa\u7684\u4ea4\u6362\u9875\u9762\uff08swap page\uff09\u6570\u91cf\n</code></pre>"},{"location":"sar/#_9","title":"\u5757\u8bbe\u5907\u72b6\u51b5","text":"<pre><code>sar -d [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -d 1 3\n\nLinux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU)\n\n11\u65f602\u520646\u79d2       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util\n11\u65f602\u520647\u79d2  dev252-0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n\n11\u65f602\u520647\u79d2       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util\n11\u65f602\u520648\u79d2  dev252-0      6.06      0.00     64.65     10.67      0.00      0.00      0.00      0.00\n\n11\u65f602\u520648\u79d2       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util\n11\u65f602\u520649\u79d2  dev252-0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00\n\n\u5e73\u5747\u65f6\u95f4:       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util\n\u5e73\u5747\u65f6\u95f4:  dev252-0      2.00      0.00     21.33     10.67      0.00      0.00      0.00      0.00\n</code></pre> <p>\u8f93\u51fa\u9879\u8bf4\u660e\uff1a</p> <pre><code>tps: \u6bcf\u79d2\u4ece\u7269\u7406\u78c1\u76d8 I/O \u7684\u6b21\u6570\u3002\u591a\u4e2a\u903b\u8f91\u8bf7\u6c42\u4f1a\u88ab\u5408\u5e76\u4e3a\u4e00\u4e2a I/O \u78c1\u76d8\u8bf7\u6c42\uff0c\u4e00\u6b21\u4f20\u8f93\u7684\u5927\u5c0f\u662f\u4e0d\u786e\u5b9a\u7684\n\nrd_sec/s: \u6bcf\u79d2\u8bfb\u6247\u533a\u7684\u6b21\u6570\n\nwr_sec/s: \u6bcf\u79d2\u5199\u6247\u533a\u7684\u6b21\u6570\n\navgrq-sz: \u5e73\u5747\u6bcf\u6b21\u8bbe\u5907 I/O \u64cd\u4f5c\u7684\u6570\u636e\u5927\u5c0f(\u6247\u533a)\n\navgqu-sz: \u78c1\u76d8\u8bf7\u6c42\u961f\u5217\u7684\u5e73\u5747\u957f\u5ea6\n\nawait: \u4ece\u8bf7\u6c42\u78c1\u76d8\u64cd\u4f5c\u5230\u7cfb\u7edf\u5b8c\u6210\u5904\u7406\uff0c\u6bcf\u6b21\u8bf7\u6c42\u7684\u5e73\u5747\u6d88\u8017\u65f6\u95f4\uff0c\u5305\u62ec\u8bf7\u6c42\u961f\u5217\u7b49\u5f85\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u6beb\u79d2(1\u79d2=1000\u6beb\u79d2)\n\nsvctm: \u7cfb\u7edf\u5904\u7406\u6bcf\u6b21\u8bf7\u6c42\u7684\u5e73\u5747\u65f6\u95f4,\u4e0d\u5305\u62ec\u5728\u8bf7\u6c42\u961f\u5217\u4e2d\u6d88\u8017\u7684\u65f6\u95f4.\n\n%util: I/O\u8bf7\u6c42\u5360CPU\u7684\u767e\u5206\u6bd4\uff0c\u6bd4\u7387\u8d8a\u5927\uff0c\u8bf4\u660e\u8d8a\u9971\u548c\n    1. avgqu-sz \u7684\u503c\u8f83\u4f4e\u65f6\uff0c\u8bbe\u5907\u7684\u5229\u7528\u7387\u8f83\u9ad8\n    2. \u5f53%util\u7684\u503c\u63a5\u8fd1 1% \u65f6\uff0c\u8868\u793a\u8bbe\u5907\u5e26\u5bbd\u5df2\u7ecf\u5360\u6ee1\n</code></pre>"},{"location":"sar/#_10","title":"\u8f93\u51fa\u7edf\u8ba1\u7684\u6570\u636e\u4fe1\u606f","text":"<pre><code>sar -o path_file [\u9009\u9879] [ &lt;\u65f6\u95f4\u95f4\u9694&gt; [ &lt;\u6b21\u6570&gt; ] ]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -o sarfile.log -u 1 3\n</code></pre> <p>\u4e0a\u8ff0\u793a\u4f8b\u547d\u4ee4\u4f1a\u5c06<code>sar -u 1 3</code>\u91c7\u96c6\u5230\u7684\u6570\u636e\u4ee5\u4e8c\u8fdb\u5236\u7684\u683c\u5f0f\u5b58\u653e\u5230\u6587\u4ef6<code>sarfile.log</code>\u4e2d\u3002</p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4<code>sadf -d sarfile.log</code>\u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u6587\u4ef6\u8f6c\u6362\u6210\u6570\u636e\u5e93\u53ef\u8bfb\u7684\u683c\u5f0f\u3002</p> <pre><code>sadf -d sarfile.log\n\n# hostname;interval;timestamp;CPU;%user;%nice;%system;%iowait;%steal;%idle\nupfor163;1;2018-04-25 03:15:02 UTC;-1;0.00;0.00;0.50;0.50;0.00;99.00\nupfor163;1;2018-04-25 03:15:03 UTC;-1;1.01;0.00;0.00;0.00;0.00;98.99\nupfor163;1;2018-04-25 03:15:04 UTC;-1;0.00;0.00;0.00;0.00;0.00;100.00\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u6570\u636e\u5b58\u50a8\u5728\u4e00\u4e2a csv \u6587\u6863\u4e2d\uff0c\u7136\u540e\u7ed8\u5236\u6210\u56fe\u8868\u5c55\u793a\u65b9\u5f0f\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>sadf -d sarfile.log | sed 's/;/,/g' &gt; sarfile.csv\n</code></pre> <p></p>"},{"location":"sar/#_11","title":"\u4ece\u6570\u636e\u6587\u4ef6\u8bfb\u53d6\u4fe1\u606f","text":"<pre><code>sar -f &lt;\u6587\u4ef6\u8def\u5f84&gt;\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>sar -f sarfile.log\n\nLinux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU)\n\n11\u65f615\u520601\u79d2     CPU     %user     %nice   %system   %iowait    %steal     %idle\n11\u65f615\u520602\u79d2     all      0.00      0.00      0.50      0.50      0.00     99.00\n11\u65f615\u520603\u79d2     all      1.01      0.00      0.00      0.00      0.00     98.99\n11\u65f615\u520604\u79d2     all      0.00      0.00      0.00      0.00      0.00    100.00\n\u5e73\u5747\u65f6\u95f4:     all      0.33      0.00      0.17      0.17      0.00     99.33\n</code></pre> <p>\u53c8\u5c06\u4e4b\u524d\u5b58\u50a8\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u7ed9\u8bfb\u53d6\u5e76\u5c55\u793a\u51fa\u6765\u3002</p>"},{"location":"sar/#_12","title":"\u6027\u80fd\u95ee\u9898\u6392\u67e5\u6280\u5de7","text":"<ul> <li>\u6000\u7591 CPU \u5b58\u5728\u74f6\u9888\uff0c\u53ef\u7528<code>sar -u</code>\u548c<code>sar -q</code>\u7b49\u6765\u67e5\u770b</li> <li>\u6000\u7591\u5185\u5b58\u5b58\u5728\u74f6\u9888\uff0c\u53ef\u7528<code>sar -B</code>\u3001<code>sar -r</code>\u548c<code>sar -W</code>\u7b49\u6765\u67e5\u770b</li> <li>\u6000\u7591 I/O \u5b58\u5728\u74f6\u9888\uff0c\u53ef\u7528<code>sar -b</code>\u3001<code>sar -u</code>\u548c<code>sar -d</code>\u7b49\u6765\u67e5\u770b</li> </ul> <p>\u539f\u6587\u5730\u5740: https://shockerli.net/post/li...</p>"},{"location":"sed/","title":"\u4e09\u5341\u5206\u949f\u5b66\u4f1aSED","text":"<ul> <li>\u539f\u6587</li> </ul> <p>\u672c\u6587\u627f\u63a5\u4e4b\u524d\u5199\u7684[\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK][]\u4e00\u6587\uff0c\u5728\u5b66\u4e60\u5b8cAWK\u4e4b\u540e\uff0c\u8d81\u70ed\u6253\u94c1\u53c8\u5b66\u4e60\u4e86\u4e00\u4e0bSED\uff0c\u4e0d\u5f97\u4e0d\u8bf4\u8fd9\u4e24\u4e2a\u5de5\u5177\u771f\u7684\u582a\u79f0\u6587\u672c\u5904\u7406\u795e\u5668\uff0c\u8c01\u7528\u8c01\u77e5\u9053\uff01\u672c\u6587\u5927\u90e8\u5206\u5185\u5bb9\u4f9d\u65e7\u662f\u7ffb\u8bd1\u81eaTutorialspoint\u4e0a\u7684\u5165\u95e8\u6559\u7a0b\uff0c\u8fd9\u6b21\u662f Sed Tutorial \u4e00\u6587\uff0c\u5185\u5bb9\u505a\u4e86\u4e00\u4e9b\u5220\u51cf\u548c\u8865\u5145\uff0c\u589e\u52a0\u4e86\u4e00\u4e9b\u539f\u6587\u4e2d\u6ca1\u6709\u63d0\u53ca\u5230\u7684\u8bed\u6cd5\u548c\u547d\u4ee4\u7684\u8bb2\u89e3\uff0c\u5e76\u4e14\u5bf9\u539f\u6587\u6240\u6709\u7684\u793a\u4f8b\u90fd\u4e00\u4e00\u8fdb\u884c\u4e86\u9a8c\u8bc1\uff0c\u5e0c\u671b\u672c\u6587\u5bf9\u5927\u5bb6\u5b66\u4e60\u548c\u4e86\u89e3Sed\u6709\u6240\u5e2e\u52a9\u3002</p> <p>\u6587\u4e2d\u7528\u5230\u7684\u6d4b\u8bd5\u6587\u4ef6\u53ef\u4ee5\u5728 https://github.com/mylxsw/sed-demo\u627e\u5230\u3002</p> <p>\u672c\u6587\u5c06\u4f1a\u6301\u7eed\u4fee\u6b63\u548c\u66f4\u65b0\uff0c\u6700\u65b0\u5185\u5bb9\u8bf7\u53c2\u8003\u6211\u7684 GITHUB \u4e0a\u7684 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6b22\u8fce Star\u3002</p> <ul> <li>\u4e09\u5341\u5206\u949f\u5b66\u4f1aSED<ul> <li>\u6982\u8ff0<ul> <li>SED\u7684\u5178\u578b\u7528\u9014</li> </ul> </li> <li>\u5de5\u4f5c\u6d41<ul> <li>\u9700\u8981\u6ce8\u610f\u7684\u51e0\u70b9</li> <li>\u793a\u4f8b</li> </ul> </li> <li>\u57fa\u7840\u8bed\u6cd5<ul> <li>\u6807\u51c6\u9009\u9879</li> <li>GNU\u9009\u9879</li> </ul> </li> <li>\u5faa\u73af</li> <li>\u5206\u652f</li> <li>\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4<ul> <li>\u6a21\u5f0f\u7a7a\u95f4</li> <li>\u884c\u5bfb\u5740<ul> <li>\u6570\u5b57\u65b9\u5f0f\u7684\u884c\u5bfb\u5740</li> <li>\u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u8fc7\u6ee4\u5668</li> </ul> </li> <li>\u4fdd\u6301\u7a7a\u95f4</li> </ul> </li> <li>\u57fa\u672c\u547d\u4ee4<ul> <li>\u5220\u9664\u547d\u4ee4  d</li> <li>\u6587\u4ef6\u5199\u5165\u547d\u4ee4 w</li> <li>\u8ffd\u52a0\u547d\u4ee4 a</li> <li>\u884c\u66ff\u6362\u547d\u4ee4 c</li> <li>\u63d2\u5165\u547d\u4ee4 i</li> <li>\u8f6c\u6362\u547d\u4ee4 y</li> <li>\u8f93\u51fa\u9690\u85cf\u5b57\u7b26\u547d\u4ee4 l</li> <li>\u9000\u51fa\u547d\u4ee4 q</li> <li>\u6587\u4ef6\u8bfb\u53d6\u547d\u4ee4 r</li> <li>\u6267\u884c\u5916\u90e8\u547d\u4ee4 e</li> <li>\u6392\u9664\u547d\u4ee4 !</li> <li>\u591a\u884c\u547d\u4ee4<ul> <li>N - \u52a0\u8f7d\u4e0b\u4e00\u884c</li> <li>D - \u5220\u9664\u591a\u884c\u4e2d\u7684\u4e00\u884c</li> <li>P - \u8f93\u51fa\u591a\u884c\u4e2d\u7684\u4e00\u884c</li> </ul> </li> <li>\u5176\u5b83\u547d\u4ee4<ul> <li>n - \u5355\u884cnext</li> <li>v - SED\u7248\u672c\u68c0\u67e5</li> </ul> </li> </ul> </li> <li>\u7279\u6b8a\u5b57\u7b26<ul> <li>=\u547d\u4ee4</li> <li>&amp;\u547d\u4ee4</li> </ul> </li> <li>\u5b57\u7b26\u4e32<ul> <li>\u66ff\u6362\u547d\u4ee4 s</li> <li>\u5339\u914d\u5b50\u5b57\u7b26\u4e32</li> </ul> </li> <li>\u7ba1\u7406\u6a21\u5f0f</li> <li>\u6b63\u5219\u8868\u8fbe\u5f0f<ul> <li>\u6807\u51c6\u6b63\u5219\u8868\u8fbe\u5f0f<ul> <li>^</li> <li>$</li> <li>.</li> <li>[]</li> <li>[\\^]</li> <li>[-]</li> <li>\\? \uff0c\\+ \uff0c*</li> <li>{n} \uff0c{n,} \uff0c{m, n}</li> <li>|</li> </ul> </li> <li>POSIX\u517c\u5bb9\u7684\u6b63\u5219</li> <li>\u5143\u5b57\u7b26<ul> <li>\\s</li> <li>\\S</li> <li>\\w \uff0c \\W</li> </ul> </li> </ul> </li> <li>\u5e38\u7528\u4ee3\u7801\u6bb5<ul> <li>Cat\u547d\u4ee4</li> <li>\u79fb\u9664\u7a7a\u884c</li> <li>\u5220\u9664\u8fde\u7eed\u7a7a\u884c</li> <li>\u5220\u9664\u5f00\u5934\u7684\u7a7a\u884c</li> <li>\u5220\u9664\u7ed3\u5c3e\u7684\u7a7a\u884c</li> <li>\u8fc7\u6ee4\u6240\u6709\u7684html\u6807\u7b7e</li> <li>\u4eceC++\u7a0b\u5e8f\u4e2d\u79fb\u9664\u6ce8\u91ca</li> <li>\u4e3a\u67d0\u4e9b\u884c\u6dfb\u52a0\u6ce8\u91ca</li> <li>\u5b9e\u73b0Wc -l\u547d\u4ee4</li> <li>\u6a21\u62df\u5b9e\u73b0head\u547d\u4ee4</li> <li>\u6a21\u62dftail -1\u547d\u4ee4</li> <li>\u6a21\u62dfDos2unix\u547d\u4ee4</li> <li>\u6a21\u62dfUnix2dos\u547d\u4ee4</li> <li>\u6a21\u62dfcat -E\u547d\u4ee4</li> <li>\u6a21\u62dfcat -ET\u547d\u4ee4</li> <li>\u6a21\u62dfnl\u547d\u4ee4</li> <li>\u6a21\u62dfcp\u547d\u4ee4</li> <li>\u6a21\u62dfexpand\u547d\u4ee4</li> <li>\u6a21\u62dftee\u547d\u4ee4</li> <li>\u6a21\u62dfcat -s\u547d\u4ee4</li> <li>\u6a21\u62dfgrep\u547d\u4ee4</li> <li>\u6a21\u62dfgrep -v\u547d\u4ee4</li> <li>\u6a21\u62dftr\u547d\u4ee4</li> </ul> </li> <li>\u5199\u5728\u6700\u540e</li> <li>\u53c2\u8003</li> </ul> </li> </ul>"},{"location":"sed/#_1","title":"\u6982\u8ff0","text":"<p>SED\u7684\u82f1\u6587\u5168\u79f0\u662f Stream EDitor\uff0c\u5b83\u662f\u4e00\u4e2a\u7b80\u5355\u800c\u5f3a\u5927\u7684\u6587\u672c\u89e3\u6790\u8f6c\u6362\u5de5\u5177\uff0c\u57281973-1974\u5e74\u671f\u95f4\u7531\u8d1d\u5c14\u5b9e\u9a8c\u5ba4\u7684Lee E. McMahon\u5f00\u53d1\uff0c\u4eca\u5929\uff0c\u5b83\u5df2\u7ecf\u8fd0\u884c\u5728\u6240\u6709\u7684\u4e3b\u6d41\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u4e86\u3002</p> <p>McMahon\u521b\u5efa\u4e86\u4e00\u4e2a\u901a\u7528\u7684\u884c\u7f16\u8f91\u5668\uff0c\u6700\u7ec8\u53d8\u6210\u4e3a\u4e86SED\u3002SED\u7684\u5f88\u591a\u8bed\u6cd5\u548c\u7279\u6027\u90fd\u501f\u9274\u4e86ed\u7f16\u8f91\u5668\u3002\u8bbe\u8ba1\u4e4b\u521d\uff0c\u5b83\u5c31\u5df2\u7ecf\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\uff0cSED\u53ef\u4ee5\u4ece\u6587\u4ef6\u4e2d\u63a5\u53d7\u7c7b\u4f3c\u4e8e\u7ba1\u9053\u7684\u8f93\u5165\uff0c\u4e5f\u53ef\u4ee5\u63a5\u53d7\u6765\u81ea\u6807\u51c6\u8f93\u5165\u6d41\u7684\u8f93\u5165\u3002</p> <p>SED\u7531\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u7ec4\u7ec7\uff08FSF\uff09\u5f00\u53d1\u548c\u7ef4\u62a4\u5e76\u4e14\u968f\u7740GNU/Linux\u8fdb\u884c\u5206\u53d1\uff0c\u56e0\u6b64\uff0c\u901a\u5e38\u5b83\u4e5f\u79f0\u4f5c GNU SED\u3002\u5bf9\u4e8e\u65b0\u624b\u6765\u8bf4\uff0cSED\u7684\u8bed\u6cd5\u770b\u8d77\u6765\u53ef\u80fd\u6709\u4e9b\u795e\u79d8\uff0c\u4f46\u662f\uff0c\u4e00\u65e6\u638c\u63e1\u4e86\u5b83\u7684\u8bed\u6cd5\uff0c\u4f60\u5c31\u53ef\u4ee5\u53ea\u7528\u51e0\u884c\u4ee3\u7801\u53bb\u89e3\u51b3\u975e\u5e38\u590d\u6742\u7684\u4efb\u52a1\uff0c\u8fd9\u5c31\u662fSED\u7684\u9b45\u529b\u6240\u5728\u3002</p>"},{"location":"sed/#sed_1","title":"SED\u7684\u5178\u578b\u7528\u9014","text":"<p>SED\u7684\u7528\u9014\u975e\u5e38\u5e7f\u6cdb\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u6587\u672c\u66ff\u6362</li> <li>\u9009\u62e9\u6027\u7684\u8f93\u51fa\u6587\u672c\u6587\u4ef6</li> <li>\u4ece\u6587\u672c\u6587\u4ef6\u7684\u67d0\u5904\u5f00\u59cb\u7f16\u8f91</li> <li>\u65e0\u4ea4\u4e92\u5f0f\u7684\u5bf9\u6587\u672c\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\u7b49</li> </ul>"},{"location":"sed/#_2","title":"\u5de5\u4f5c\u6d41","text":"<p>\u5728\u672c\u7ae0\u4e2d\uff0c\u6211\u4eec\u5c06\u4f1a\u63a2\u7d22SED\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u8981\u60f3\u6210\u4e3a\u4e00\u4e2aSED\u4e13\u5bb6\uff0c\u4f60\u9700\u8981\u77e5\u9053\u5b83\u7684\u5185\u90e8\u5b9e\u73b0\u3002SED\u9075\u5faa\u7b80\u5355\u7684\u5de5\u4f5c\u6d41\uff1a\u8bfb\u53d6\uff0c\u6267\u884c\u548c\u663e\u793a\uff0c\u4e0b\u56fe\u63cf\u8ff0\u4e86\u8be5\u5de5\u4f5c\u6d41\uff1a</p> <ul> <li>\u8bfb\u53d6\uff1a SED\u4ece\u8f93\u5165\u6d41\uff08\u6587\u4ef6\uff0c\u7ba1\u9053\u6216\u8005\u6807\u51c6\u8f93\u5165\uff09\u4e2d\u8bfb\u53d6\u4e00\u884c\u5e76\u4e14\u5b58\u50a8\u5230\u5b83\u53eb\u505a \u6a21\u5f0f\u7a7a\u95f4\uff08pattern buffer\uff09 \u7684\u5185\u90e8\u7f13\u51b2\u533a</li> <li>\u6267\u884c\uff1a \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684SED\u547d\u4ee4\u90fd\u5728\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u987a\u5e8f\u7684\u6267\u884c\uff0c\u9664\u975e\u6307\u5b9a\u4e86\u884c\u7684\u5730\u5740\uff0c\u5426\u5219SED\u547d\u4ee4\u5c06\u4f1a\u5728\u6240\u6709\u7684\u884c\u4e0a\u4f9d\u6b21\u6267\u884c</li> <li>\u663e\u793a\uff1a \u53d1\u9001\u4fee\u6539\u540e\u7684\u5185\u5bb9\u5230\u8f93\u51fa\u6d41\u3002\u5728\u53d1\u9001\u6570\u636e\u4e4b\u540e\uff0c\u6a21\u5f0f\u7a7a\u95f4\u5c06\u4f1a\u88ab\u6e05\u7a7a\u3002</li> <li>\u5728\u6587\u4ef6\u6240\u6709\u7684\u5185\u5bb9\u90fd\u88ab\u5904\u7406\u5b8c\u6210\u4e4b\u524d\uff0c\u4e0a\u8ff0\u8fc7\u7a0b\u5c06\u4f1a\u91cd\u590d\u6267\u884c</li> </ul>"},{"location":"sed/#_3","title":"\u9700\u8981\u6ce8\u610f\u7684\u51e0\u70b9","text":"<ul> <li>\u6a21\u5f0f\u7a7a\u95f4 \uff08pattern buffer\uff09 \u662f\u4e00\u5757\u6d3b\u8dc3\u7684\u7f13\u51b2\u533a\uff0c\u5728sed\u7f16\u8f91\u5668\u6267\u884c\u547d\u4ee4\u65f6\u5b83\u4f1a\u4fdd\u5b58\u5f85\u68c0\u67e5\u7684\u6587\u672c</li> <li>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684SED\u547d\u4ee4\u90fd\u662f\u5728\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u6267\u884c\uff0c\u56e0\u6b64\u8f93\u5165\u6587\u4ef6\u5e76\u4e0d\u4f1a\u53d1\u751f\u6539\u53d8</li> <li>\u8fd8\u6709\u53e6\u5916\u4e00\u4e2a\u7f13\u51b2\u533a\u53eb\u505a \u4fdd\u6301\u7a7a\u95f4 \uff08hold buffer\uff09\uff0c\u5728\u5904\u7406\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u67d0\u4e9b\u884c\u65f6\uff0c\u53ef\u4ee5\u7528\u4fdd\u6301\u7a7a\u95f4\u6765\u4e34\u65f6\u4fdd\u5b58\u4e00\u4e9b\u884c\u3002\u5728\u6bcf\u4e00\u4e2a\u5faa\u73af\u7ed3\u675f\u7684\u65f6\u5019\uff0cSED\u5c06\u4f1a\u79fb\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\uff0c\u4f46\u662f\u8be5\u7f13\u51b2\u533a\u4e2d\u7684\u5185\u5bb9\u5728\u6240\u6709\u7684\u5faa\u73af\u8fc7\u7a0b\u4e2d\u662f\u6301\u4e45\u5b58\u50a8\u7684\u3002SED\u547d\u4ee4\u65e0\u6cd5\u76f4\u63a5\u5728\u8be5\u7f13\u51b2\u533a\u4e2d\u6267\u884c\uff0c\u56e0\u6b64SED\u5141\u8bb8\u6570\u636e\u5728 \u4fdd\u6301\u7a7a\u95f4 \u548c \u6a21\u5f0f\u7a7a\u95f4\u4e4b\u95f4\u5207\u6362</li> <li>\u521d\u59cb\u60c5\u51b5\u4e0b\uff0c\u4fdd\u6301\u7a7a\u95f4 \u548c \u6a21\u5f0f\u7a7a\u95f4 \u8fd9\u4e24\u4e2a\u7f13\u51b2\u533a\u90fd\u662f\u7a7a\u7684</li> <li>\u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u8f93\u5165\u6587\u4ef6\u7684\u8bdd\uff0cSED\u5c06\u4f1a\u4ece\u6807\u51c6\u8f93\u5165\u63a5\u6536\u8bf7\u6c42</li> <li>\u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u5730\u5740\u8303\u56f4\u7684\u8bdd\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bSED\u5c06\u4f1a\u5bf9\u6240\u6709\u7684\u884c\u8fdb\u884c\u64cd\u4f5c</li> </ul>"},{"location":"sed/#_4","title":"\u793a\u4f8b","text":"<p>\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a quote.txt \u7684\u6587\u672c\u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u4e3a\u8457\u540d\u4f5c\u5bb6Paulo Coelho\u7684\u4e00\u6bb5\u540d\u8a00</p> <pre><code>$ vi quote.txt \nThere is only one thing that makes a dream impossible to achieve: the fear of failure. \n - Paulo Coelho, The Alchemist\n</code></pre> <p>\u4e3a\u4e86\u7406\u89e3SED\u7684\u5de5\u4f5c\u6d41\uff0c\u6211\u4eec\u9996\u5148\u4f7f\u7528SED\u663e\u793a\u51faquote.txt\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u8be5\u793a\u4f8b\u4e0e<code>cat</code>\u547d\u4ee4\u7c7b\u4f3c</p> <pre><code>$ sed '' quote.txt\nThere is only one thing that makes a dream impossible to achieve: the fear of failure.\n- Paulo Coelho, The Alchemist\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0cquote.txt\u662f\u8f93\u5165\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u4e24\u4e2a\u5355\u5f15\u53f7\u662f\u8981\u6267\u884c\u7684SED\u547d\u4ee4\u3002</p> <p>\u9996\u5148\uff0cSED\u5c06\u4f1a\u8bfb\u53d6quote.txt\u6587\u4ef6\u4e2d\u7684\u4e00\u884c\u5185\u5bb9\u5b58\u50a8\u5230\u5b83\u7684\u6a21\u5f0f\u7a7a\u95f4\u4e2d\uff0c\u7136\u540e\u4f1a\u5728\u8be5\u7f13\u51b2\u533a\u4e2d\u6267\u884cSED\u547d\u4ee4\u3002\u5728\u8fd9\u91cc\uff0c\u6ca1\u6709\u63d0\u4f9bSED\u547d\u4ee4\uff0c\u56e0\u6b64\u5bf9\u8be5\u7f13\u51b2\u533a\u6ca1\u6709\u8981\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u6700\u540e\u5b83\u4f1a\u5220\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u5e76\u4e14\u6253\u5370\u8be5\u5185\u5bb9\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u5f88\u7b80\u5355\u7684\u8fc7\u7a0b\uff0c\u5bf9\u5427?</p> <p>\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0cSED\u4f1a\u4ece\u6807\u51c6\u8f93\u5165\u6d41\u63a5\u53d7\u8f93\u5165</p> <pre><code>$ sed ''\n</code></pre> <p>\u5f53\u4e0a\u8ff0\u547d\u4ee4\u88ab\u6267\u884c\u7684\u65f6\u5019\uff0c\u5c06\u4f1a\u4ea7\u751f\u4e0b\u5217\u7ed3\u679c</p> <pre><code>There is only one thing that makes a dream impossible to achieve: the fear of failure. \nThere is only one thing that makes a dream impossible to achieve: the fear of failure.\n</code></pre> <p>\u5728\u8fd9\u91cc\uff0c\u7b2c\u4e00\u884c\u5185\u5bb9\u662f\u901a\u8fc7\u952e\u76d8\u8f93\u5165\u7684\u5185\u5bb9\uff0c\u7b2c\u4e8c\u884c\u662fSED\u8f93\u51fa\u7684\u5185\u5bb9\u3002</p> <p>\u4eceSED\u4f1a\u8bdd\u4e2d\u9000\u51fa\uff0c\u4f7f\u7528\u7ec4\u5408\u952e<code>ctrl-D (^D)</code></p>"},{"location":"sed/#_5","title":"\u57fa\u7840\u8bed\u6cd5","text":"<p>\u672c\u7ae0\u4e2d\u5c06\u4f1a\u4ecb\u7ecdSED\u4e2d\u7684\u57fa\u672c\u547d\u4ee4\u548c\u5b83\u7684\u547d\u4ee4\u884c\u4f7f\u7528\u65b9\u6cd5\u3002SED\u53ef\u4ee5\u7528\u4e0b\u5217\u4e24\u79cd\u65b9\u5f0f\u8c03\u7528\uff1a</p> <pre><code>sed [-n] [-e] 'command(s)' files \nsed [-n] -f scriptfile files\n</code></pre> <p>\u7b2c\u4e00\u79cd\u65b9\u5f0f\u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528\u5355\u5f15\u53f7\u6307\u5b9a\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u5219\u6307\u5b9a\u4e86\u5305\u542bSED\u547d\u4ee4\u7684\u811a\u672c\u6587\u4ef6\u3002\u5f53\u7136\uff0c\u8fd9\u4e24\u79cd\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\uff0cSED\u63d0\u4f9b\u4e86\u5f88\u591a\u53c2\u6570\u7528\u4e8e\u63a7\u5236\u8fd9\u79cd\u884c\u4e3a\u3002</p> <p>\u8ba9\u6211\u4eec\u770b\u770b\u5982\u4f55\u6307\u5b9a\u591a\u4e2aSED\u547d\u4ee4\u3002SED\u63d0\u4f9b\u4e86<code>delete</code>\u547d\u4ee4\u7528\u4e8e\u5220\u9664\u67d0\u4e9b\u884c\uff0c\u8fd9\u91cc\u8ba9\u6211\u4eec\u5220\u9664\u7b2c\u4e00\u884c\uff0c\u7b2c\u4e8c\u884c\u548c\u7b2c\u4e94\u884c\uff1a</p> <p>\u9996\u5148\uff0c\u4f7f\u7528<code>cat</code>\u547d\u4ee4\u663e\u793a\u6587\u4ef6\u5185\u5bb9</p> <pre><code>$ cat books.txt \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u73b0\u5728\uff0c\u4f7f\u7528SED\u79fb\u9664\u6307\u5b9a\u7684\u884c\uff0c\u4e3a\u4e86\u5220\u9664\u4e09\u884c\uff0c\u6211\u4eec\u4f7f\u7528<code>-e</code>\u9009\u9879\u6307\u5b9a\u4e09\u4e2a\u72ec\u7acb\u7684\u547d\u4ee4</p> <pre><code>$ sed -e '1d' -e '2d' -e '5d' books.txt\n3) The Alchemist, Paulo Coelho, 197\n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06\u591a\u4e2aSED\u547d\u4ee4\u5199\u5728\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u5c06\u8be5\u6587\u4ef6\u4f5c\u4e3aSED\u547d\u4ee4\u7684\u53c2\u6570\uff0cSED\u53ef\u4ee5\u5bf9\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u6bcf\u4e00\u4e2a\u547d\u4ee4\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u63cf\u8ff0\u4e86SED\u7684\u7b2c\u4e8c\u79cd\u7528\u6cd5</p> <p>\u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a\u5305\u542bSED\u547d\u4ee4\u7684\u6587\u672c\u6587\u4ef6\uff0c\u4e3a\u4e86\u4fbf\u4e8e\u7406\u89e3\uff0c\u6211\u4eec\u4f7f\u7528\u4e0e\u4e4b\u524d\u76f8\u540c\u7684SED\u547d\u4ee4</p> <pre><code>$ echo -e \"1d\\n2d\\n5d\" &gt; commands.txt \n$ cat commands.txt\n1d \n2d \n5d\n</code></pre> <p>\u63a5\u4e0b\u6765\u6784\u9020\u4e00\u4e2aSED\u547d\u4ee4\u53bb\u6267\u884c\u8be5\u64cd\u4f5c</p> <pre><code>$ sed -f commands.txt books.txt\n3) The Alchemist, Paulo Coelho, 197\n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre>"},{"location":"sed/#_6","title":"\u6807\u51c6\u9009\u9879","text":"<p>SED\u652f\u6301\u4e0b\u5217\u6807\u51c6\u9009\u9879\uff1a</p> <ul> <li> <p>-n \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u5728\u5904\u7406\u5b8c\u6210\u540e\u5c06\u4f1a\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u8be5\u9009\u9879\u7528\u4e8e\u963b\u6b62\u8be5\u884c\u4e3a</p> <pre><code>$ sed -n '' quote.txt\n</code></pre> </li> <li> <p>-e \u6307\u5b9a\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4f7f\u7528\u8be5\u53c2\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\u547d\u4ee4\uff0c\u8ba9\u6211\u4eec\u6253\u5370\u6bcf\u4e00\u884c\u4e24\u6b21\uff1a</p> <pre><code>$ sed -e '' -e 'p' quote.txt\nThere is only one thing that makes a dream impossible to achieve: the fear of failure.\nThere is only one thing that makes a dream impossible to achieve: the fear of failure.\n - Paulo Coelho, The Alchemist\n - Paulo Coelho, The Alchemist\n</code></pre> </li> <li> <p>-f \u6307\u5b9a\u5305\u542b\u8981\u6267\u884c\u7684\u547d\u4ee4\u7684\u811a\u672c\u6587\u4ef6</p> <pre><code>$ echo \"p\" &gt; commands\n$\n$ sed -n -f commands quote.txt\nThere is only one thing that makes a dream impossible to achieve: the fear of failure.\n - Paulo Coelho, The Alchemist\n</code></pre> </li> </ul>"},{"location":"sed/#gnu","title":"GNU\u9009\u9879","text":"<p>\u8fd9\u4e9b\u9009\u9879\u662fGNU\u89c4\u8303\u5b9a\u4e49\u7684\uff0c\u53ef\u80fd\u5bf9\u4e8e\u67d0\u4e9b\u7248\u672c\u7684SED\u5e76\u4e0d\u652f\u6301\u3002</p> <ul> <li>-n\uff0c --quiet, --slient\uff1a\u4e0e\u6807\u51c6\u7684-n\u9009\u9879\u76f8\u540c</li> <li>-e script\uff0c--expression=script\uff1a\u4e0e\u6807\u51c6\u7684-e\u9009\u9879\u76f8\u540c</li> <li>-f script-file\uff0c --file=script-file\uff1a\u4e0e\u6807\u51c6\u7684-f\u9009\u9879\u76f8\u540c</li> <li>--follow-symlinks\uff1a\u5982\u679c\u63d0\u4f9b\u8be5\u9009\u9879\u7684\u8bdd\uff0c\u5728\u7f16\u8f91\u7684\u6587\u4ef6\u662f\u7b26\u53f7\u94fe\u63a5\u65f6\uff0cSED\u5c06\u4f1a\u8ddf\u968f\u94fe\u63a5</li> <li>-i[SUFFIX]\uff0c--in-place[=SUFFIX]\uff1a\u8be5\u9009\u9879\u7528\u4e8e\u5bf9\u5f53\u524d\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u5982\u679c\u63d0\u4f9b\u4e86SUFFIX\u7684\u8bdd\uff0c\u5c06\u4f1a\u5907\u4efd\u539f\u59cb\u6587\u4ef6\uff0c\u5426\u5219\u5c06\u4f1a\u8986\u76d6\u539f\u59cb\u6587\u4ef6</li> <li>-l N\uff0c --line-lenght=N\uff1a\u8be5\u9009\u9879\u7528\u4e8e\u8bbe\u7f6e\u884c\u7684\u957f\u5ea6\u4e3aN\u4e2a\u5b57\u7b26</li> <li>--posix\uff1a\u8be5\u9009\u9879\u7981\u7528\u6240\u6709\u7684GNU\u6269\u5c55</li> <li>-r\uff0c--regexp-extended\uff1a\u8be5\u9009\u9879\u5c06\u542f\u7528\u6269\u5c55\u7684\u6b63\u5219\u8868\u8fbe\u5f0f</li> <li>-u\uff0c --unbuffered\uff1a\u6307\u5b9a\u8be5\u9009\u9879\u7684\u65f6\u5019\uff0cSED\u5c06\u4f1a\u4ece\u8f93\u5165\u6587\u4ef6\u4e2d\u52a0\u8f7d\u6700\u5c11\u7684\u6570\u636e\uff0c\u5e76\u4e14\u66f4\u52a0\u9891\u7e41\u7684\u5237\u51fa\u5230\u8f93\u51fa\u7f13\u51b2\u533a\u3002\u5728\u7f16\u8f91<code>tail -f</code>\u547d\u4ee4\u7684\u8f93\u51fa\uff0c\u4f60\u4e0d\u5e0c\u671b\u7b49\u5f85\u8f93\u51fa\u7684\u65f6\u5019\u8be5\u9009\u9879\u662f\u975e\u5e38\u6709\u7528\u7684\u3002</li> <li>-z\uff0c--null-data\uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u5bf9\u6bcf\u4e00\u884c\u4f7f\u7528\u6362\u884c\u7b26\u5206\u5272\uff0c\u5982\u679c\u63d0\u4f9b\u4e86\u8be5\u9009\u9879\u7684\u8bdd\uff0c\u5b83\u5c06\u4f7f\u7528NULL\u5b57\u7b26\u5206\u5272\u884c</li> </ul>"},{"location":"sed/#_7","title":"\u5faa\u73af","text":"<p>\u4e0e\u5176\u5b83\u7f16\u7a0b\u8bed\u8a00\u7c7b\u4f3c\uff0cSED\u63d0\u4f9b\u4e86\u7528\u4e8e\u63a7\u5236\u6267\u884c\u6d41\u7684\u5faa\u73af\u548c\u5206\u652f\u8bed\u53e5\u3002</p> <p>SED\u4e2d\u7684\u5faa\u73af\u6709\u70b9\u7c7b\u4f3c\u4e8egoto\u8bed\u53e5\uff0cSED\u53ef\u4ee5\u6839\u636e\u6807\u7b7e\uff08label\uff09\u8df3\u8f6c\u5230\u67d0\u4e00\u884c\u7ee7\u7eed\u6267\u884c\uff0c\u5728SED\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u5982\u4e0b\u7684\u6807\u7b7e\uff1a</p> <pre><code>:label \n:start \n:end \n:up\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u56db\u4e2a\u6807\u7b7e\u3002</p> <p>\u8981\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u6807\u7b7e\uff0c\u4f7f\u7528 b \u547d\u4ee4\u540e\u9762\u8ddf\u7740\u6807\u7b7e\u540d\uff0c\u5982\u679c\u5ffd\u7565\u6807\u7b7e\u540d\u7684\u8bdd\uff0cSED\u5c06\u4f1a\u8df3\u8f6c\u5230SED\u6587\u4ef6\u7684\u7ed3\u5c3e\u3002</p> <p>b\u6807\u7b7e\u7528\u4e8e\u65e0\u6761\u4ef6\u7684\u8df3\u8f6c\u5230\u6307\u5b9a\u7684label\u3002</p> <p>\u4e3a\u4e86\u66f4\u597d\u5730\u7406\u89e3SED\u4e2d\u7684\u5faa\u73af\u548c\u5206\u652f\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3abooks2.txt\u7684\u6587\u672c\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e9b\u56fe\u4e66\u7684\u6807\u9898\u548c\u4f5c\u8005\u4fe1\u606f\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\u4f1a\u5408\u5e76\u56fe\u4e66\u7684\u6807\u9898\u548c\u4f5c\u8005\uff0c\u4f7f\u7528\u9017\u53f7\u5206\u9694\u3002\u4e4b\u540e\u641c\u7d22\u6240\u6709\u5339\u914d\u201cPaulo\u201d\u7684\u884c\uff0c\u5982\u679c\u5339\u914d\u7684\u8bdd\u5c31\u5728\u8fd9\u4e00\u884c\u7684\u5f00\u5934\u6dfb\u52a0<code>-</code>\uff0c\u5426\u5219\u8df3\u8f6c\u5230<code>Print</code>\u6807\u7b7e\uff0c\u6253\u5370\u51fa\u8be5\u884c\u5185\u5bb9\u3002</p> <pre><code>$ cat books2.txt\nA Storm of Swords\nGeorge R. R. Martin\nThe Two Towers\nJ. R. R. Tolkien\nThe Alchemist\nPaulo Coelho\nThe Fellowship of the Ring\nJ. R. R. Tolkien\nThe Pilgrimage\nPaulo Coelho\nA Game of Thrones\nGeorge R. R. Martin\n\n$ sed -n '\nh;n;H;x\ns/\\n/, /\n/Paulo/!b Print\ns/^/- /\n:Print\np' books2.txt\nA Storm of Swords , George R. R. Martin\nThe Two Towers , J. R. R. Tolkien\n- The Alchemist , Paulo Coelho\nThe Fellowship of the Ring , J. R. R. Tolkien\n- The Pilgrimage , Paulo Coelho\nA Game of Thrones , George R. R. Martin\n</code></pre> <p>\u4e4d\u770b\u6765\u4e0a\u8ff0\u7684\u4ee3\u7801\u975e\u5e38\u795e\u79d8\uff0c\u8ba9\u6211\u4eec\u9010\u6b65\u62c6\u89e3\u4e00\u4e0b</p> <ul> <li>\u7b2c\u4e00\u884c\u662f<code>h;n;H;x</code>\u8fd9\u51e0\u4e2a\u547d\u4ee4\uff0c\u8bb0\u5f97\u4e0a\u9762\u6211\u4eec\u63d0\u5230\u7684 \u4fdd\u6301\u7a7a\u95f4 \u5417\uff1f\u7b2c\u4e00\u4e2a<code>h</code>\u662f\u6307\u5c06\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u8986\u76d6\u5230 \u4fdd\u6301\u7a7a\u95f4\u4e2d\uff0c<code>n</code>\u7528\u4e8e\u63d0\u524d\u8bfb\u53d6\u4e0b\u4e00\u884c\uff0c\u5e76\u4e14\u8986\u76d6\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u8fd9\u4e00\u884c\uff0c<code>H</code>\u5c06\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u8ffd\u52a0\u5230 \u4fdd\u6301\u7a7a\u95f4 \u4e2d\uff0c\u6700\u540e\u7684<code>x</code>\u7528\u4e8e\u4ea4\u6362\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u3002\u56e0\u6b64\u8fd9\u91cc\u5c31\u662f\u6307\u6bcf\u6b21\u8bfb\u53d6\u4e24\u884c\u653e\u5230\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u4ea4\u7ed9\u4e0b\u9762\u7684\u547d\u4ee4\u8fdb\u884c\u5904\u7406</li> <li>\u63a5\u4e0b\u6765\u662f s/\\n/, / \u7528\u4e8e\u5c06\u4e0a\u9762\u7684\u4e24\u884c\u5185\u5bb9\u4e2d\u7684\u6362\u884c\u7b26\u66ff\u6362\u4e3a\u9017\u53f7</li> <li>\u7b2c\u4e09\u4e2a\u547d\u4ee4\u5728\u4e0d\u5339\u914d\u7684\u65f6\u5019\u8df3\u8f6c\u5230Print\u6807\u7b7e\uff0c\u5426\u5219\u7ee7\u7eed\u6267\u884c\u7b2c\u56db\u4e2a\u547d\u4ee4</li> <li>:Print\u4ec5\u4ec5\u662f\u4e00\u4e2a\u6807\u7b7e\u540d\uff0c\u800c<code>p</code>\u5219\u662fprint\u547d\u4ee4</li> </ul> <p>\u4e3a\u4e86\u63d0\u9ad8\u53ef\u8bfb\u6027\uff0c\u6bcf\u4e00\u4e2a\u547d\u4ee4\u90fd\u5360\u4e86\u4e00\u884c\uff0c\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u628a\u6240\u6709\u547d\u4ee4\u653e\u5728\u4e00\u884c</p> <pre><code>$ sed -n 'h;n;H;x;s/\\n/, /;/Paulo/!b Print; s/^/- /; :Print;p' books2.txt\n</code></pre> <p>\u5173\u4e8e<code>h</code>\uff0c<code>H</code>\uff0c<code>x</code>\u547d\u4ee4\u53c2\u8003\u5b98\u65b9\u624b\u518c sed, a stream editor 3.6 Less Frequently-Used Commands\u8282</p>"},{"location":"sed/#_8","title":"\u5206\u652f","text":"<p>\u4f7f\u7528 t \u547d\u4ee4\u521b\u5efa\u5206\u652f\u3002\u53ea\u6709\u5f53\u524d\u7f6e\u6761\u4ef6\u6210\u529f\u7684\u65f6\u5019\uff0ct \u547d\u4ee4\u624d\u4f1a\u8df3\u8f6c\u5230\u8be5\u6807\u7b7e\u3002</p> <p>t\u547d\u4ee4\u53ea\u6709\u5728\u524d\u4e00\u4e2a\u66ff\u6362\uff08s\uff09\u547d\u4ee4\u6267\u884c\u6210\u529f\u7684\u65f6\u5019\u624d\u4f1a\u6267\u884c\u3002</p> <p>\u8ba9\u6211\u4eec\u770b\u4e00\u4e9b\u524d\u9762\u7ae0\u8282\u4e2d\u7684\u4f8b\u5b50\uff0c\u4e0e\u4e4b\u524d\u4e0d\u540c\u7684\u662f\uff0c\u8fd9\u6b21\u6211\u4eec\u5c06\u6253\u5370\u56db\u4e2a\u8fde\u5b57\u7b26\"-\"\uff0c\u800c\u4e4b\u524d\u662f\u4e00\u4e2a\u3002</p> <pre><code>$ sed -n '\nh;n;H;x\ns/\\n/, /\n:Loop\n/Paulo/s/^/-/\n/----/!t Loop\np' books2.txt\nA Storm of Swords , George R. R. Martin\nThe Two Towers , J. R. R. Tolkien\n----The Alchemist , Paulo Coelho\nThe Fellowship of the Ring , J. R. R. Tolkien\n----The Pilgrimage , Paulo Coelho\nA Game of Thrones , George R. R. Martin\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u524d\u9762\u4e24\u884c\u4e0e\u4e0a\u4e00\u8282\u4e2d\u8bb2\u7684\u4f5c\u7528\u4e00\u81f4\uff0c\u7b2c\u4e09\u884c\u5b9a\u4e49\u4e86\u4e00\u4e2aLoop\u6807\u7b7e\uff0c\u63a5\u4e0b\u6765\u5339\u914d\u5b58\u5728\u201cPaulo\u201d\u7684\u884c\uff0c\u5982\u679c\u5b58\u5728\u5219\u5728\u6700\u524d\u9762\u6dfb\u52a0\u4e00\u4e2a-\uff0c\u63a5\u4e0b\u6765\u662f\u6211\u4eec\u8fd9\u91cc\u7684\u91cd\u70b9\uff1a</p> <p><code>/----/!t Loop</code>\u8fd9\u4e00\u884c\u9996\u5148\u68c0\u67e5\u4e0a\u9762\u6dfb\u52a0<code>-</code>\u4e4b\u540e\u662f\u5426\u6ee1\u8db3\u56db\u4e2a<code>-</code>\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u5219\u8df3\u8f6c\u5230Loop\u7ee7\u7eed\u6267\u884c\u7b2c\u4e09\u884c\uff0c\u8fd9\u6837\u4e0d\u505c\u7684\u8ffd\u52a0<code>-</code>\uff0c\u6700\u540e\u5982\u679c\u6539\u884c\u6ee1\u8db3\u524d\u9762\u6709\u56db\u4e2a<code>-</code>\u624d\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\u3002 </p> <p>\u4e3a\u4e86\u63d0\u9ad8\u53ef\u8bfb\u6027\uff0c\u6211\u4eec\u5c06\u6bcf\u4e00\u4e2aSED\u547d\u4ee4\u72ec\u7acb\u4e00\u884c\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u540c\u4e00\u884c\u4e2d\u4f7f\u7528\uff1a</p> <pre><code> sed -n 'h;n;H;x; s/\\n/, /; :Loop;/Paulo/s/^/-/; /----/!t Loop; p' books.txt\n</code></pre>"},{"location":"sed/#_9","title":"\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4","text":""},{"location":"sed/#_10","title":"\u6a21\u5f0f\u7a7a\u95f4","text":"<p>\u5bf9\u4efb\u4f55\u6587\u4ef6\u7684\u6765\u8bf4\uff0c\u6700\u57fa\u672c\u7684\u64cd\u4f5c\u5c31\u662f\u8f93\u51fa\u5b83\u7684\u5185\u5bb9\uff0c\u4e3a\u4e86\u5b9e\u73b0\u8be5\u76ee\u7684\uff0c\u5728SED\u4e2d\u53ef\u4ee5\u4f7f\u7528print\u547d\u4ee4\u6253\u5370\u51fa\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u3002</p> <p>\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u884c\u53f7\uff0c\u4e66\u540d\uff0c\u4f5c\u8005\u548c\u9875\u7801\u6570\u7684\u6587\u4ef6\uff0c\u5728\u672c\u6587\u4e2d\u6211\u4eec\u5c06\u4f1a\u4f7f\u7528\u8be5\u6587\u4ef6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u521b\u5efa\u4efb\u4f55\u5176\u5b83\u7684\u6587\u4ef6\uff0c\u4f46\u662f\u8fd9\u91cc\u6211\u4eec\u5c31\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\u7684\u6587\u4ef6</p> <pre><code>$ vi books.txt \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho,288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u6267\u884c<code>p</code>\u547d\u4ee4</p> <pre><code>$ sed 'p' books.txt\n1) A Storm of Swords, George R. R. Martin, 1216 \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u4f60\u53ef\u80fd\u4f1a\u7591\u60d1\uff0c\u4e3a\u4ec0\u4e48\u6bcf\u4e00\u884c\u88ab\u663e\u793a\u4e86\u4e24\u6b21\uff1f</p> <p>\u4f60\u8fd8\u8bb0\u5f97SED\u7684\u5de5\u4f5c\u6d41\u5417\uff1f\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u5c06\u4f1a\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\uff0c\u53e6\u5916\uff0c\u6211\u4eec\u7684\u547d\u4ee4\u4e2d\u5305\u542b\u4e86\u8f93\u51fa\u547d\u4ee4<code>p</code>\uff0c\u56e0\u6b64\u6bcf\u4e00\u884c\u88ab\u6253\u5370\u4e24\u6b21\u3002\u4f46\u662f\u4e0d\u8981\u62c5\u5fc3\uff0cSED\u63d0\u4f9b\u4e86-n\u53c2\u6570\u7528\u4e8e\u7981\u6b62\u81ea\u52a8\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u7684\u6bcf\u4e00\u884c\u7684\u884c\u4e3a</p> <pre><code>$ sed -n 'p' books.txt \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre>"},{"location":"sed/#_11","title":"\u884c\u5bfb\u5740","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728SED\u4e2d\u4f7f\u7528\u7684\u547d\u4ee4\u4f1a\u4f5c\u7528\u4e8e\u6587\u672c\u6570\u636e\u7684\u6240\u6709\u884c\u3002\u5982\u679c\u53ea\u60f3\u5c06\u547d\u4ee4\u4f5c\u7528\u4e8e\u7279\u5b9a\u7684\u884c\u6216\u8005\u67d0\u4e9b\u884c\uff0c\u5219\u9700\u8981\u4f7f\u7528 \u884c\u5bfb\u5740 \u529f\u80fd\u3002</p> <p>\u5728SED\u4e2d\u5305\u542b\u4e24\u79cd\u5f62\u5f0f\u7684\u884c\u5bfb\u5740\uff1a</p> <ul> <li>\u4ee5\u6570\u5b57\u5f62\u5f0f\u8868\u793a\u7684\u884c\u533a\u95f4</li> <li>\u4ee5\u6587\u672c\u6a21\u5f0f\u6765\u8fc7\u6ee4\u884c</li> </ul> <p>\u4e24\u79cd\u5f62\u5f0f\u90fd\u4f7f\u7528\u76f8\u540c\u7684\u8bed\u6cd5\u683c\u5f0f</p> <pre><code>[address]command\n</code></pre>"},{"location":"sed/#_12","title":"\u6570\u5b57\u65b9\u5f0f\u7684\u884c\u5bfb\u5740","text":"<p>\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2dSED\u53ea\u4f1a\u5bf9\u7b2c3\u884c\u8fdb\u884c\u64cd\u4f5c</p> <pre><code>$ sed -n '3p' books.txt \n3) The Alchemist, Paulo Coelho, 197\n</code></pre> <p>\u5f53\u7136\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8ba9SED\u8f93\u51fa\u67d0\u4e9b\u884c\u3002\u5728SED\u4e2d\u4f7f\u7528\u9017\u53f7,\u5206\u9694\u8f93\u51fa\u884c\u53f7\u7684\u8303\u56f4\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u4ee3\u7801\u4f1a\u8f93\u51fa\u51fa2-5\u884c\u7684\u5185\u5bb9</p> <pre><code>$ sed -n '2,5 p' books.txt \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288\n</code></pre> <p>\u7279\u6b8a\u5b57\u7b26 $ \u4ee3\u8868\u4e86\u6587\u4ef6\u7684\u6700\u540e\u4e00\u884c\uff0c\u8f93\u51fa\u6587\u4ef6\u7684\u6700\u540e\u4e00\u884c</p> <pre><code>$ sed -n '$ p' books.txt \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528 $ \u6307\u5b9a\u8f93\u51fa\u7684\u5730\u5740\u8303\u56f4\uff0c\u4e0b\u5217\u547d\u4ee4\u8f93\u51fa\u7b2c\u4e09\u884c\u5230\u6700\u540e\u4e00\u884c</p> <pre><code>$ sed -n '3,$ p' books.txt\n3) The Alchemist, Paulo Coelho, 197\n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\n5) The Pilgrimage, Paulo Coelho,288\n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>SED\u8fd8\u63d0\u4f9b\u4e86\u53e6\u5916\u4e24\u79cd\u64cd\u4f5c\u7b26\u7528\u4e8e\u6307\u5b9a\u5730\u5740\u8303\u56f4\uff0c\u7b2c\u4e00\u4e2a\u662f\u52a0\u53f7\uff08+\uff09\u64cd\u4f5c\u7b26\uff0c\u5b83\u53ef\u4ee5\u4e0e\u9017\u53f7\uff08,\uff09\u64cd\u4f5c\u7b26\u4e00\u8d77\u4f7f\u7528\uff0c\u4f8b\u5982 <code>M, +n</code> \u5c06\u4f1a\u6253\u5370\u51fa\u4ece\u7b2c<code>M</code>\u884c\u5f00\u59cb\u7684\u4e0b<code>n</code>\u884c\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u4f1a\u8f93\u51fa\u7b2c\u4e8c\u884c\u5f00\u59cb\u7684\u4e0b\u9762\u56db\u884c</p> <pre><code>$ sed -n '2,+4 p' books.txt \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u6ce2\u6d6a\u7ebf\u64cd\u4f5c\u7b26\uff08~\uff09\u6307\u5b9a\u5730\u5740\u8303\u56f4\uff0c\u5b83\u4f7f\u7528<code>M~N</code>\u7684\u5f62\u5f0f\uff0c\u5b83\u544a\u8bc9SED\u5e94\u8be5\u5904\u7406<code>M</code>\u884c\u5f00\u59cb\u7684\u6bcf<code>N</code>\u884c\u3002\u4f8b\u5982\uff0c<code>50~5</code>\u5339\u914d\u884c\u53f750\uff0c55\uff0c60\uff0c65\u7b49\uff0c\u8ba9\u6211\u4eec\u53ea\u8f93\u51fa\u6587\u4ef6\u4e2d\u7684\u5947\u6570\u884c</p> <pre><code>$ sed -n '1~2 p' books.txt \n1) A Storm of Swords, George R. R. Martin, 1216 \n3) The Alchemist, Paulo Coelho, 197 \n5) The Pilgrimage, Paulo Coelho, 288\n</code></pre> <p>\u4e0b\u9762\u7684\u4ee3\u7801\u5219\u662f\u53ea\u8f93\u51fa\u6587\u4ef6\u4e2d\u7684\u5076\u6570\u884c</p> <pre><code>$ sed -n '2~2 p' books.txt \n2) The Two Towers, J. R. R. Tolkien, 352 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u6ce8\u610f\uff0c\u5982\u679c\u4f7f\u7528\u7684\u662fMac\u7cfb\u7edf\u81ea\u5e26\u7684sed\u547d\u4ee4\uff0c\u53ef\u80fd\u4e0d\u652f\u6301~\u548c+\u64cd\u4f5c\u7b26\u3002\u53ef\u4ee5\u4f7f\u7528<code>brew install gnu-sed --with-default-names</code>\u91cd\u65b0\u5b89\u88c5GNU-SED\u3002</p>"},{"location":"sed/#_13","title":"\u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u8fc7\u6ee4\u5668","text":"<p>SED\u7f16\u8f91\u5668\u5141\u8bb8\u6307\u5b9a\u6587\u672c\u6a21\u5f0f\u6765\u8fc7\u6ee4\u51fa\u547d\u4ee4\u8981\u4f5c\u7528\u7684\u884c\u3002\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>/pattern/command\n</code></pre> <p>\u5fc5\u987b\u7528\u6b63\u659c\u7ebf\u5c06\u8981\u6307\u5b9a\u7684pattern\u5c01\u8d77\u6765\u3002sed\u7f16\u8f91\u5668\u4f1a\u5c06\u8be5\u547d\u4ee4\u4f5c\u7528\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u6a21\u5f0f\u7684\u884c\u4e0a\u3002</p> <p>\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u5c06\u4f1a\u8f93\u51fa\u6240\u6709\u4f5c\u8005\u4e3aPaulo Coelho\u7684\u4e66\u7c4d\u3002</p> <pre><code>$ sed -n '/Paulo/ p' books.txt\n3) The Alchemist, Paulo Coelho, 197 \n5) The Pilgrimage, Paulo Coelho, 288\n</code></pre> <p>\u6a21\u5f0f\u5339\u914d\u4e5f\u53ef\u4ee5\u4e0e\u6570\u5b57\u5f62\u5f0f\u7684\u5bfb\u5740\u540c\u65f6\u4f7f\u7528\uff0c\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u4ece\u7b2c\u4e00\u6b21\u5339\u914d\u5230<code>Alchemist</code>\u5f00\u59cb\u8f93\u51fa\uff0c\u76f4\u5230\u7b2c5\u884c\u4e3a\u6b62\u3002</p> <pre><code>$ sed -n '/Alchemist/, 5 p' books.txt\n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288\n</code></pre> <p>\u4f7f\u7528\u9017\u53f7\uff08,\uff09\u64cd\u4f5c\u7b26\u6307\u5b9a\u5339\u914d\u591a\u4e2a\u5339\u914d\u7684\u6a21\u5f0f\u3002\u4e0b\u5217\u7684\u793a\u4f8b\u5c06\u4f1a\u8f93\u51faTwo\u548cPilgrimage\u4e4b\u95f4\u7684\u6240\u6709\u884c</p> <pre><code>$ sed -n '/Two/, /Pilgrimage/ p' books.txt \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288\n</code></pre> <p>\u5728\u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u8fc7\u6ee4\u5668\u7684\u65f6\u5019\uff0c\u4e0e\u6570\u5b57\u65b9\u5f0f\u7684\u884c\u5bfb\u5740\u7c7b\u4f3c\uff0c\u53ef\u4ee5\u4f7f\u7528\u52a0\u53f7\u64cd\u4f5c\u7b26 +\uff0c\u5b83\u4f1a\u8f93\u51fa\u4ece\u5f53\u524d\u5339\u914d\u4f4d\u7f6e\u5f00\u59cb\u7684\u67d0\u51e0\u884c\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u4ece\u7b2c\u4e00\u6b21Two\u51fa\u73b0\u7684\u4f4d\u7f6e\u5f00\u59cb\u8f93\u51fa\u63a5\u4e0b\u6765\u76844\u884c</p> <pre><code>$ sed -n '/Two/, +4 p' books.txt\n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre>"},{"location":"sed/#_14","title":"\u4fdd\u6301\u7a7a\u95f4","text":"<p>\u5728\u5904\u7406\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u67d0\u4e9b\u884c\u65f6\uff0c\u53ef\u4ee5\u7528\u4fdd\u6301\u7a7a\u95f4\u6765\u4e34\u65f6\u4fdd\u5b58\u4e00\u4e9b\u884c\u3002\u67095\u6761\u547d\u4ee4\u53ef\u7528\u6765\u64cd\u4f5c\u4fdd\u6301\u7a7a\u95f4</p> \u547d\u4ee4 \u63cf\u8ff0 h \u5c06\u6a21\u5f0f\u7a7a\u95f4\u590d\u5236\u5230\u4fdd\u6301\u7a7a\u95f4 H \u5c06\u6a21\u5f0f\u7a7a\u95f4\u9644\u52a0\u5230\u4fdd\u6301\u7a7a\u95f4 g \u5c06\u4fdd\u6301\u7a7a\u95f4\u590d\u5236\u5230\u6a21\u5f0f\u7a7a\u95f4 G \u5c06\u4fdd\u6301\u7a7a\u95f4\u9644\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4 x \u4ea4\u6362\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4\u7684\u5185\u5bb9 <p>\u5173\u4e8e\u4fdd\u6301\u7a7a\u95f4\u8fd9\u91cc\u5c31\u4e0d\u5728\u4e3e\u4f8b\u4e86\uff0c\u524d\u9762\u518d\u5faa\u73af\u90e8\u5206\u8bb2\u89e3\u4e0b\u9762\u8fd9\u4e2a\u547d\u4ee4\u7684\u65f6\u5019\u6211\u4eec\u5df2\u7ecf\u5bf9\u5b83\u7684\u4f7f\u7528\u505a\u4e86\u8bf4\u660e\u3002</p> <pre><code> $ sed -n 'h;n;H;x;s/\\n/, /;/Paulo/!b Print; s/^/- /; :Print;p' books2.txt\n</code></pre>"},{"location":"sed/#_15","title":"\u57fa\u672c\u547d\u4ee4","text":"<p>\u672c\u7ae0\u5c06\u4f1a\u8bb2\u89e3\u4e00\u4e9b\u5e38\u7528\u7684SED\u547d\u4ee4\uff0c\u4e3b\u8981\u5305\u62ec<code>DELETE</code>\uff0c<code>WRITE</code>\uff0c<code>APPEND</code>\uff0c<code>CHANGE</code>\uff0c<code>INSERT</code>\uff0c<code>TRANSLATE</code>\uff0c<code>QUIT</code>\uff0c<code>READ</code>\uff0c<code>EXECUTE</code>\u7b49\u547d\u4ee4\u3002</p>"},{"location":"sed/#d","title":"\u5220\u9664\u547d\u4ee4  d","text":"<p>\u5220\u9664\u547d\u4ee4\u683c\u5f0f\u5982\u4e0b</p> <pre><code>[address1[,address2]]d\n</code></pre> <p><code>address1</code>\u548c<code>address2</code>\u662f\u5f00\u59cb\u548c\u622a\u6b62\u5730\u5740\uff0c\u5b83\u4eec\u53ef\u4ee5\u662f\u884c\u53f7\u6216\u8005\u5b57\u7b26\u4e32\u5339\u914d\u6a21\u5f0f\uff0c\u8fd9\u4e24\u79cd\u5730\u5740\u90fd\u662f\u53ef\u9009\u7684\u3002</p> <p>\u7531\u547d\u4ee4\u7684\u540d\u79f0\u53ef\u4ee5\u77e5\u9053\uff0cdelete \u547d\u4ee4\u662f\u7528\u6765\u6267\u884c\u5220\u9664\u64cd\u4f5c\u7684\uff0c\u5e76\u4e14\u56e0\u4e3aSED\u662f\u57fa\u4e8e\u884c\u7684\u7f16\u8f91\u5668\uff0c\u56e0\u6b64\u6211\u4eec\u8bf4\u8be5\u547d\u4ee4\u662f\u7528\u6765\u5220\u9664\u884c\u7684\u3002\u6ce8\u610f\u7684\u662f\uff0c\u8be5\u547d\u4ee4\u53ea\u4f1a\u79fb\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u884c\uff0c\u8fd9\u6837\u8be5\u884c\u5c31\u4e0d\u4f1a\u88ab\u53d1\u9001\u5230\u8f93\u51fa\u6d41\uff0c\u4f46\u539f\u59cb\u5185\u5bb9\u4e0d\u4f1a\u6539\u53d8\u3002</p> <pre><code>$ sed 'd' books.txt\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u6ca1\u6709\u8f93\u51fa\u4efb\u4f55\u5185\u5bb9\uff1f\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u5c06\u4f1a\u5bf9\u6bcf\u4e00\u884c\u6267\u884c\u5220\u9664\u64cd\u4f5c\uff0c\u8fd9\u5c31\u662f\u8be5\u547d\u4ee4\u4e3a\u4ec0\u4e48\u6ca1\u6709\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u8f93\u51fa\u4efb\u4f55\u5185\u5bb9\u7684\u539f\u56e0\u3002</p> <p>\u4e0b\u5217\u547d\u4ee4\u53ea\u79fb\u9664\u7b2c\u56db\u884c</p> <pre><code>[jerry]$ sed '4d' books.txt \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>SED\u4e5f\u63a5\u53d7\u4f7f\u7528\u9017\u53f7(,)\u5206\u9694\u7684\u5730\u5740\u8303\u56f4\u3002\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u5730\u5740\u8303\u56f4\u53bb\u79fb\u9664N1\u5230N2\u884c\uff0c\u4f8b\u5982\uff0c\u4e0b\u5217\u547d\u4ee4\u5c06\u5220\u96642-4\u884c</p> <pre><code>$ sed '2, 4 d' books.txt     \n1) A Storm of Swords, George R. R. Martin, 1216 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>SED\u7684\u5730\u5740\u8303\u56f4\u5e76\u4e0d\u4ec5\u4ec5\u9650\u4e8e\u6570\u5b57\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6307\u5b9a\u6a21\u5f0f\u5339\u914d\u4f5c\u4e3a\u5730\u5740\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u79fb\u9664\u6240\u6709\u4f5c\u8005\u4e3aPaulo Coelho\u7684\u4e66\u7c4d</p> <pre><code>$ sed '/Paulo Coelho/d' books.txt \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u6211\u79fb\u9664\u6240\u6709\u4ee5<code>Storm</code>\u548c<code>Fellowship</code>\u5f00\u5934\u7684\u884c</p> <pre><code>$ sed '/Storm/,/Fellowship/d' books.txt  \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre>"},{"location":"sed/#w","title":"\u6587\u4ef6\u5199\u5165\u547d\u4ee4 w","text":"<p>SED\u63d0\u4f9b\u4e86 write \u547d\u4ee4\u7528\u4e8e\u5c06\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u5199\u5165\u5230\u6587\u4ef6\uff0c\u4e0e delete \u547d\u4ee4\u7c7b\u4f3c\uff0c\u4e0b\u9762\u662f write \u547d\u4ee4\u7684\u8bed\u6cd5</p> <pre><code>[address1[,address2]]w file\n</code></pre> <p>w \u6307\u5b9a\u662f\u5199\u547d\u4ee4\uff0c file \u6307\u7684\u662f\u5b58\u50a8\u6587\u4ef6\u5185\u5bb9\u7684\u6587\u4ef6\u540d\u3002\u4f7f\u7528 file \u64cd\u4f5c\u7b26\u7684\u65f6\u5019\u8981\u5c0f\u5fc3\uff0c\u5f53\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\u4f46\u662f\u6587\u4ef6\u4e0d\u5b58\u5728\u7684\u65f6\u5019\u5b83\u4f1a\u81ea\u52a8\u521b\u5efa\uff0c\u5982\u679c\u5df2\u7ecf\u5b58\u5728\u7684\u8bdd\u5219\u4f1a\u8986\u76d6\u539f\u6587\u4ef6\u7684\u5185\u5bb9\u3002</p> <p>\u4e0b\u9762\u7684SED\u547d\u4ee4\u4f1a\u521b\u5efa\u6587\u4ef6books.txt\u7684\u526f\u672c\uff0c\u5728 w \u548c file \u4e4b\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u7a7a\u683c</p> <pre><code>$ sed -n 'w books.bak' books.txt\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a books.bak \u7684\u6587\u4ef6\uff0c\u9a8c\u8bc1\u4e00\u4e0b\u4e24\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u662f\u5426\u76f8\u540c</p> <pre><code>$ diff books.txt books.bak  \n$ echo $?\n</code></pre> <p>\u4e00\u65e6\u6267\u884c\u4e0a\u8ff0\u7684\u4ee3\u7801\uff0c\u4f60\u5c06\u4f1a\u5f97\u5230\u4e0b\u5217\u8f93\u51fa</p> <pre><code>0\n</code></pre> <p>\u806a\u660e\u7684\u4f60\u53ef\u80fd\u5df2\u7ecf\u60f3\u5230\u4e86\uff0c\u8fd9\u4e0d\u5c31\u662f cp \u547d\u4ee4\u505a\u7684\u4e8b\u60c5\u5417\uff01\u786e\u5b9e\u5982\u6b64\uff0ccp \u547d\u4ee4\u4e5f\u505a\u4e86\u540c\u4e00\u4ef6\u4e8b\u60c5\uff0c\u4f46\u662fSED\u662f\u4e00\u4e2a\u6210\u719f\u7684\u5de5\u5177\uff0c\u4f7f\u7528\u5b83\u4f60\u53ef\u4ee5\u53ea\u590d\u5236\u6587\u4ef6\u4e2d\u7684\u67d0\u4e9b\u884c\u5230\u65b0\u7684\u6587\u4ef6\u4e2d\uff0c\u5982\u4e0b\u4ee3\u7801\u4f1a\u5b58\u50a8\u6587\u4ef6\u4e2d\u7684\u5947\u6570\u884c\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6</p> <pre><code>$ sed -n '2~2 w junk.txt' books.txt  \n$ cat junk.txt \n2) The Two Towers, J. R. R. Tolkien, 352 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u5047\u8bbe\u4f60\u5e0c\u671b\u5b58\u50a8\u6240\u6709\u72ec\u7acb\u4f5c\u8005\u7684\u4e66\u5230\u5355\u72ec\u7684\u6587\u4ef6\u3002\u5982\u679c\u4eba\u5de5\u53bb\u505a\u7684\u8bdd\uff0c\u80af\u5b9a\u662f\u975e\u5e38\u65e0\u804a\u800c\u4e14\u6ca1\u6709\u6280\u672f\u542b\u91cf\u7684\uff0c\u4f46\u662f\u4f7f\u7528SED\uff0c\u4f60\u5c31\u6709\u4e86\u66f4\u52a0\u806a\u660e\u7684\u65b9\u6cd5\u53bb\u5b9e\u73b0</p> <pre><code>$ sed -n -e '/Martin/ w Martin.txt' -e '/Paulo/ w Paulo.txt' -e '/Tolkien/ w Tolkien.txt' books.txt\n\n$ cat Martin.txt\n1) A Storm of Swords, George R. R. Martin, 1216 \n6) A Game of Thrones, George R. R. Martin, 864\n\n$ cat Paulo.txt\n3) The Alchemist, Paulo Coelho, 197 \n5) The Pilgrimage, Paulo Coelho, 288\n\n$ cat Tolkien.txt\n2) The Two Towers, J. R. R. Tolkien, 352 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\n</code></pre>"},{"location":"sed/#a","title":"\u8ffd\u52a0\u547d\u4ee4 a","text":"<p>\u6587\u672c\u8ffd\u52a0\u547d\u4ee4\u8bed\u6cd5\uff1a</p> <pre><code>[address]a\\ \nAppend text\n</code></pre> <p>\u5728\u7b2c\u56db\u884c\u4e4b\u540e\u8ffd\u52a0\u4e00\u672c\u65b0\u4e66\uff1a</p> <pre><code>$ sed '4 a 7) Adultry, Paulo Coelho, 234' books.txt \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n7) Adultry, Paulo Coelho, 234 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u5728\u547d\u4ee4\u90e8\u5206\uff0c4\u6307\u7684\u662f\u884c\u53f7\uff0c<code>a</code> \u662fappend\u547d\u4ee4\uff0c\u5269\u4f59\u90e8\u5206\u4e3a\u8981\u8ffd\u52a0\u7684\u6587\u672c\u3002</p> <p>\u5728\u6587\u4ef6\u7684\u7ed3\u5c3e\u63d2\u5165\u4e00\u884c\u6587\u672c\uff0c\u4f7f\u7528 $ \u4f5c\u4e3a\u5730\u5740</p> <pre><code>$ sed '$ a 7) Adultry, Paulo Coelho, 234' books.txt\n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864 \n7) Adultry, Paulo Coelho, 234\n</code></pre> <p>\u9664\u4e86\u884c\u53f7\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u6307\u5b9a\u5730\u5740\uff0c\u4f8b\u5982\uff0c\u5728\u5339\u914d <code>The Alchemist</code> \u7684\u884c\u4e4b\u540e\u8ffd\u52a0\u6587\u672c</p> <pre><code>$ sed '/The Alchemist/ a 7) Adultry, Paulo Coelho, 234' books.txt  \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n7) Adultry, Paulo Coelho, 234 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre>"},{"location":"sed/#c","title":"\u884c\u66ff\u6362\u547d\u4ee4 c","text":"<p>SED\u901a\u8fc7 c \u63d0\u4f9b\u4e86 change \u548c replace \u547d\u4ee4\uff0c\u8be5\u547d\u4ee4\u5e2e\u52a9\u6211\u4eec\u4f7f\u7528\u65b0\u6587\u672c\u66ff\u6362\u5df2\u7ecf\u5b58\u5728\u7684\u884c\uff0c\u5f53\u63d0\u4f9b\u884c\u7684\u5730\u5740\u8303\u56f4\u65f6\uff0c\u6240\u6709\u7684\u884c\u90fd\u88ab\u4f5c\u4e3a\u4e00\u7ec4\u88ab\u66ff\u6362\u4e3a\u5355\u884c\u6587\u672c\uff0c\u4e0b\u9762\u662f\u8be5\u547d\u4ee4\u7684\u8bed\u6cd5</p> <pre><code>[address1[,address2]]c\\ \nReplace text\n</code></pre> <p>\u6bd4\u5982\uff0c\u66ff\u6362\u6587\u672c\u4e2d\u7684\u7b2c\u4e09\u884c\u4e3a\u65b0\u7684\u5185\u5bb9</p> <pre><code>$ sed '3 c 3) Adultry, Paulo Coelho, 324' books.txt\n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) Adultry, Paulo Coelho, 324 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>SED\u4e5f\u63a5\u53d7\u6a21\u5f0f\u4f5c\u4e3a\u5730\u5740</p> <pre><code>$ sed '/The Alchemist/ c 3) Adultry, Paulo Coelho, 324' books.txt\n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) Adultry, Paulo Coelho, 324 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u591a\u884c\u66ff\u6362\u4e5f\u662f\u652f\u6301\u7684\uff0c\u4e0b\u9762\u7684\u547d\u4ee4\u5b9e\u73b0\u4e86\u5c06\u7b2c4-6\u884c\u5185\u5bb9\u66ff\u6362\u4e3a\u5355\u884c</p> <pre><code>$ sed '4, 6 c 4) Adultry, Paulo Coelho, 324' books.txt  \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n4) Adultry, Paulo Coelho, 324\n</code></pre>"},{"location":"sed/#i","title":"\u63d2\u5165\u547d\u4ee4 i","text":"<p>\u63d2\u5165\u547d\u4ee4\u4e0e\u8ffd\u52a0\u547d\u4ee4\u7c7b\u4f3c\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\u63d2\u5165\u547d\u4ee4\u662f\u5728\u5339\u914d\u7684\u4f4d\u7f6e\u524d\u63d2\u5165\u65b0\u7684\u4e00\u884c\u3002</p> <pre><code>[address]i\\ \nInsert text\n</code></pre> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u4f1a\u5728\u7b2c\u56db\u884c\u524d\u63d2\u5165\u65b0\u7684\u4e00\u884c</p> <pre><code>$ sed '4 i 7) Adultry, Paulo Coelho, 324' books.txt \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \n7) Adultry, Paulo Coelho, 324 \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre>"},{"location":"sed/#y","title":"\u8f6c\u6362\u547d\u4ee4 y","text":"<p>\u8f6c\u6362\uff08Translate\uff09\u547d\u4ee4 y \u662f\u552f\u4e00\u53ef\u4ee5\u5904\u7406\u5355\u4e2a\u5b57\u7b26\u7684sed\u7f16\u8f91\u5668\u547d\u4ee4\u3002\u8f6c\u6362\u547d\u4ee4\u683c\u5f0f \u5982\u4e0b</p> <pre><code>[address]y/inchars/outchars/\n</code></pre> <p>\u8f6c\u6362\u547d\u4ee4\u4f1a\u5bf9inchars\u548coutchars\u503c\u8fdb\u884c\u4e00\u5bf9\u4e00\u7684\u6620\u5c04\u3002inchars\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4f1a\u88ab\u8f6c\u6362\u4e3aoutchars\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\uff0c\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4f1a\u88ab\u8f6c\u6362\u6210outchars\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u3002\u8fd9\u4e2a\u6620\u5c04\u8fc7\u7a0b\u4f1a\u4e00\u76f4\u6301\u7eed\u5230\u5904\u7406\u5b8c\u6307\u5b9a\u5b57\u7b26\u3002\u5982\u679cinchars\u548coutchars\u7684\u957f\u5ea6\u4e0d\u540c\uff0c\u5219sed\u7f16\u8f91\u5668\u4f1a\u4ea7\u751f\u4e00 \u6761\u9519\u8bef\u6d88\u606f\u3002</p> <pre><code>$ echo \"1 5 15 20\" | sed 'y/151520/IVXVXX/'\nI V IV XX\n</code></pre>"},{"location":"sed/#l","title":"\u8f93\u51fa\u9690\u85cf\u5b57\u7b26\u547d\u4ee4 l","text":"<p>\u4f60\u80fd\u901a\u8fc7\u76f4\u63a5\u89c2\u5bdf\u533a\u5206\u51fa\u5355\u8bcd\u662f\u901a\u8fc7\u7a7a\u683c\u8fd8\u662ftab\u8fdb\u884c\u5206\u9694\u7684\u5417\uff1f\u663e\u7136\u662f\u4e0d\u80fd\u7684\uff0c\u4f46\u662fSED\u53ef\u4ee5\u4e3a\u4f60\u505a\u5230\u8fd9\u70b9\u3002\u4f7f\u7528<code>l</code>\u547d\u4ee4\uff08\u82f1\u6587\u5b57\u6bcdL\u7684\u5c0f\u5199\uff09\u53ef\u4ee5\u663e\u793a\u6587\u672c\u4e2d\u7684\u9690\u85cf\u5b57\u7b26\uff08\u4f8b\u5982<code>\\t</code>\u6216\u8005<code>$</code>\u5b57\u7b26\uff09\u3002</p> <pre><code>[address1[,address2]]l \n[address1[,address2]]l [len]\n</code></pre> <p>\u4e3a\u4e86\u6d4b\u8bd5\u8be5\u547d\u4ee4\uff0c\u6211\u4eec\u9996\u5148\u5c06books.txt\u4e2d\u7684\u7a7a\u683c\u66ff\u6362\u4e3atab\u3002</p> <pre><code>$ sed 's/ /\\t/g' books.txt &gt; junk.txt\n</code></pre> <p>\u63a5\u4e0b\u6765\u6267\u884c<code>l</code>\u547d\u4ee4</p> <pre><code>$ sed -n 'l' junk.txt\n1)\\tStorm\\tof\\tSwords,\\tGeorge\\tR.\\tR.\\tMartin,\\t1216\\t$\n2)\\tThe\\tTwo\\tTowers,\\tJ.\\tR.\\tR.\\tTolkien,\\t352\\t$\n3)\\tThe\\tAlchemist,\\tPaulo\\tCoelho,\\t197\\t$\n4)\\tThe\\tFellowship\\tof\\tthe\\tRing,\\tJ.\\tR.\\tR.\\tTolkien,\\t432\\t$\n5)\\tThe\\tPilgrimage,\\tPaulo\\tCoelho,\\t288\\t$\n6)\\tA\\tGame\\tof\\tThrones,\\tGeorge\\tR.\\tR.\\tMartin,\\t864$\n</code></pre> <p>\u4f7f\u7528<code>l</code>\u547d\u4ee4\u7684\u65f6\u5019\uff0c\u4e00\u4e2a\u5f88\u6709\u8da3\u7684\u7279\u6027\u662f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u5b9e\u73b0\u6587\u672c\u6309\u7167\u6307\u5b9a\u7684\u5bbd\u5ea6\u6362\u884c\u3002</p> <pre><code>$ sed -n 'l 25' books.txt\n1) Storm of Swords, Geor\\\nge R. R. Martin, 1216 $\n2) The Two Towers, J. R.\\\n R. Tolkien, 352 $\n3) The Alchemist, Paulo \\\nCoelho, 197 $\n4) The Fellowship of the\\\n Ring, J. R. R. Tolkien,\\\n 432 $\n5) The Pilgrimage, Paulo\\\n Coelho, 288 $\n6) A Game of Thrones, Ge\\\norge R. R. Martin, 864$\n</code></pre> <p>\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\u5728<code>l</code>\u547d\u4ee4\u540e\u8ddf\u4e86\u4e00\u4e2a\u6570\u5b5725\uff0c\u5b83\u544a\u8bc9SED\u6309\u7167\u6bcf\u884c25\u4e2a\u5b57\u7b26\u8fdb\u884c\u6362\u884c\uff0c\u5982\u679c\u6307\u5b9a\u8fd9\u4e2a\u6570\u5b57\u4e3a0\u7684\u8bdd\uff0c\u5219\u53ea\u6709\u5728\u5b58\u5728\u6362\u884c\u7b26\u7684\u60c5\u51b5\u4e0b\u624d\u8fdb\u884c\u6362\u884c\u3002</p> <p><code>l</code>\u547d\u4ee4\u662fGNU-SED\u7684\u4e00\u90e8\u5206\uff0c\u5176\u5b83\u7684\u4e00\u4e9b\u53d8\u4f53\u4e2d\u53ef\u80fd\u65e0\u6cd5\u4f7f\u7528\u8be5\u547d\u4ee4\u3002</p>"},{"location":"sed/#q","title":"\u9000\u51fa\u547d\u4ee4 q","text":"<p>\u5728SED\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528<code>Quit</code>\u547d\u4ee4\u9000\u51fa\u5f53\u524d\u7684\u6267\u884c\u6d41</p> <pre><code>[address]q \n[address]q [value]\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c<code>q</code>\u547d\u4ee4\u4e0d\u652f\u6301\u5730\u5740\u8303\u56f4\uff0c\u53ea\u652f\u6301\u5355\u4e2a\u5730\u5740\u5339\u914d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0bSED\u4f1a\u6309\u7167\u8bfb\u53d6\u3001\u6267\u884c\u3001\u91cd\u590d\u7684\u5de5\u4f5c\u6d41\u6267\u884c\uff0c\u4f46\u5f53\u5b83\u9047\u5230<code>q</code>\u547d\u4ee4\u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u9000\u51fa\u5f53\u524d\u7684\u6267\u884c\u6d41\u3002</p> <pre><code>$ sed '3 q' books.txt\n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197\n\n$ sed '/The Alchemist/ q' books.txt \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197\n</code></pre> <p><code>q</code>\u547d\u4ee4\u4e5f\u652f\u6301\u63d0\u4f9b\u4e00\u4e2avalue\uff0c\u8fd9\u4e2avalue\u5c06\u4f5c\u4e3a\u7a0b\u5e8f\u7684\u8fd4\u56de\u4ee3\u7801\u8fd4\u56de</p> <pre><code>$ sed '/The Alchemist/ q 100' books.txt\n1) A Storm of Swords, George R. R. Martin, 1216\n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197\n\n$ echo $? \n100\n</code></pre>"},{"location":"sed/#r","title":"\u6587\u4ef6\u8bfb\u53d6\u547d\u4ee4 r","text":"<p>\u5728SED\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9SED\u4f7f\u7528Read\u547d\u4ee4\u4ece\u5916\u90e8\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5185\u5bb9\u5e76\u4e14\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u65f6\u5019\u663e\u793a\u51fa\u6765\u3002</p> <pre><code>[address]r file\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c<code>r</code>\u547d\u4ee4\u548c\u6587\u4ef6\u540d\u4e4b\u95f4\u5fc5\u987b\u53ea\u6709\u4e00\u4e2a\u7a7a\u683c\u3002</p> <p>\u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u6253\u5f00junk.txt\u6587\u4ef6\uff0c\u5c06\u5176\u5185\u5bb9\u63d2\u5165\u5230books.txt\u6587\u4ef6\u7684\u7b2c\u4e09\u884c\u4e4b\u540e</p> <pre><code>$ echo \"This is junk text.\" &gt; junk.txt \n$ sed '3 r junk.txt' books.txt \n1) A Storm of Swords, George R. R. Martin, 1216 \n2) The Two Towers, J. R. R. Tolkien, 352 \n3) The Alchemist, Paulo Coelho, 197 \nThis is junk text. \n4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \n5) The Pilgrimage, Paulo Coelho, 288 \n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p><code>r</code>\u547d\u4ee4\u4e5f\u652f\u6301\u5730\u5740\u8303\u56f4\uff0c\u4f8b\u59823, 5 r junk.txt\u4f1a\u5728\u7b2c\u4e09\u884c\uff0c\u7b2c\u56db\u884c\uff0c\u7b2c\u4e94\u884c\u540e\u9762\u5206\u522b\u63d2\u5165junk.txt\u7684\u5185\u5bb9</p>"},{"location":"sed/#e","title":"\u6267\u884c\u5916\u90e8\u547d\u4ee4 e","text":"<p>\u5982\u679c\u4f60\u770b\u8fc7[\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK][]\u4e00\u6587\uff0c\u4f60\u53ef\u80fd\u5df2\u7ecf\u77e5\u9053\u4e86\u5728AWK\u4e2d\u53ef\u4ee5\u6267\u884c\u5916\u90e8\u7684\u547d\u4ee4\uff0c\u90a3\u4e48\u5728SED\u4e2d\u6211\u4eec\u662f\u5426\u4e5f\u53ef\u4ee5\u8fd9\u6837\u505a\uff1f</p> <p>\u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u5728SED\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>e</code>\u547d\u4ee4\u6267\u884c\u5916\u90e8\u547d\u4ee4</p> <pre><code>[address1[,address2]]e [command]\n</code></pre> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u4f1a\u5728\u7b2c\u4e09\u884c\u4e4b\u524d\u6267\u884cdate\u547d\u4ee4</p> <pre><code>$ sed '3 e date' books.txt\n1) Storm of Swords, George R. R. Martin, 1216\n2) The Two Towers, J. R. R. Tolkien, 352\n2016\u5e7411\u670829\u65e5 \u661f\u671f\u4e8c 22\u65f646\u520614\u79d2 CST\n3) The Alchemist, Paulo Coelho, 197\n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\n5) The Pilgrimage, Paulo Coelho, 288\n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u53e6\u4e00\u4e2a\u793a\u4f8b</p> <pre><code>$ sed '3,5 e who' books.txt\n1) Storm of Swords, George R. R. Martin, 1216\n2) The Two Towers, J. R. R. Tolkien, 352\nmylxsw   console  Nov 29 19:30\nmylxsw   ttys000  Nov 29 22:45\n3) The Alchemist, Paulo Coelho, 197\nmylxsw   console  Nov 29 19:30\nmylxsw   ttys000  Nov 29 22:45\n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\nmylxsw   console  Nov 29 19:30\nmylxsw   ttys000  Nov 29 22:45\n5) The Pilgrimage, Paulo Coelho, 288\n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u5982\u679c\u4f60\u4ed4\u7ec6\u89c2\u5bdf<code>e</code>\u547d\u4ee4\u7684\u8bed\u6cd5\uff0c\u4f60\u4f1a\u53d1\u73b0\u5176\u5b9e\u5b83\u7684command\u53c2\u6570\u662f\u53ef\u9009\u7684\u3002\u5728\u6ca1\u6709\u63d0\u4f9b\u5916\u90e8\u547d\u4ee4\u7684\u65f6\u5019\uff0cSED\u4f1a\u5c06\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u4f5c\u4e3a\u8981\u6267\u884c\u7684\u547d\u4ee4\u3002</p> <pre><code>$ echo -e \"date\\ncal\\nuname\" &gt; commands.txt\n$ cat commands.txt\ndate\ncal\nuname\n$ sed 'e' commands.txt\n2016\u5e7411\u670829\u65e5 \u661f\u671f\u4e8c 22\u65f650\u520630\u79d2 CST\n    \u5341\u4e00\u6708 2016\n\u65e5 \u4e00 \u4e8c \u4e09 \u56db \u4e94 \u516d\n       1  2  3  4  5\n 6  7  8  9 10 11 12\n13 14 15 16 17 18 19\n20 21 22 23 24 25 26\n27 28 29 30\n\nDarwin\n</code></pre>"},{"location":"sed/#_16","title":"\u6392\u9664\u547d\u4ee4 !","text":"<p>\u611f\u53f9\u53f7\u547d\u4ee4\uff08!\uff09\u7528\u6765\u6392\u9664\u547d\u4ee4\uff0c\u4e5f\u5c31\u662f\u8ba9\u539f\u672c\u4f1a\u8d77\u4f5c\u7528\u7684\u547d\u4ee4\u4e0d\u8d77\u4f5c\u7528\u3002</p> <pre><code>$ sed -n '/Paulo/p' books.txt\n3) The Alchemist, Paulo Coelho, 197\n5) The Pilgrimage, Paulo Coelho, 288\n$ sed -n '/Paulo/!p' books.txt\n1) Storm of Swords, George R. R. Martin, 1216\n2) The Two Towers, J. R. R. Tolkien, 352\n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u5982\u4e0a\u4f8b\u6240\u793a\uff0c<code>p</code>\u547d\u4ee4\u539f\u5148\u662f\u53ea\u8f93\u51fa\u5339\u914dPaulo\u7684\u884c\uff0c\u6dfb\u52a0<code>!</code>\u4e4b\u540e\uff0c\u53d8\u6210\u4e86\u53ea\u8f93\u51fa\u4e0d\u5339\u914dPaulo\u7684\u884c\u3002</p> <pre><code>$ sed -n '1!G; h; $p' books.txt\n6) A Game of Thrones, George R. R. Martin, 864\n5) The Pilgrimage, Paulo Coelho, 288\n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\n3) The Alchemist, Paulo Coelho, 197\n2) The Two Towers, J. R. R. Tolkien, 352\n1) Storm of Swords, George R. R. Martin, 1216\n</code></pre> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u5b9e\u73b0\u4e86\u7c7b\u4f3c<code>tac</code>\u547d\u4ee4\u7c7b\u4f3c\u7684\u8f93\u51fa\uff0c\u5c06\u6587\u672c\u5185\u5bb9\u5012\u5e8f\u8f93\u51fa\u3002\u770b\u8d77\u6765\u6709\u4e9b\u6666\u6da9\u96be\u61c2\uff0c\u5206\u89e3\u4e00\u4e0b\u5374\u5341\u5206\u7b80\u5355\uff1a</p> <ol> <li>1!G \u8fd9\u53e5\u7684\u610f\u601d\u662f\u51fa\u4e86\u7b2c\u4e00\u884c\u4e4b\u5916\uff0c\u5904\u7406\u6bcf\u4e00\u884c\u7684\u65f6\u5019\u90fd\u5c06\u4fdd\u6301\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u8ffd\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4\uff08\u6b63\u5e8f-&gt;\u5012\u5e8f\uff09</li> <li>h \u5c06\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u590d\u5236\u5230\u4fdd\u6301\u7a7a\u95f4\u4ee5\u5907\u4e0b\u4e00\u884c\u5339\u914d\u7684\u65f6\u5019\u8ffd\u52a0\u5230\u4e0b\u4e00\u884c\u7684\u540e\u9762</li> <li>$p \u5982\u679c\u5339\u914d\u5230\u6700\u540e\u4e00\u884c\u7684\u8bdd\u5219\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9</li> <li>\u4e0a\u8ff0\u6b65\u9aa4\u4e0d\u65ad\u91cd\u590d\u76f4\u5230\u6587\u672c\u7ed3\u675f\u521a\u597d\u5c06\u6587\u4ef6\u5185\u5bb9\u7ffb\u8f6c\u4e86\u4e00\u6b21</li> </ol>"},{"location":"sed/#_17","title":"\u591a\u884c\u547d\u4ee4","text":"<p>\u5728\u4f7f\u7528sed\u7f16\u8f91\u5668\u7684\u57fa\u7840\u547d\u4ee4\u65f6\uff0c\u4f60\u53ef\u80fd\u6ce8\u610f\u5230\u4e86\u4e00\u4e2a\u5c40\u9650\u3002\u6240\u6709\u7684sed\u7f16\u8f91\u5668\u547d\u4ee4\u90fd\u662f\u9488\u5bf9\u5355\u884c\u6570\u636e\u6267\u884c\u64cd\u4f5c\u7684\u3002\u5728sed\u7f16\u8f91\u5668\u8bfb\u53d6\u6570\u636e\u6d41\u65f6\uff0c\u5b83\u4f1a\u57fa\u4e8e\u6362\u884c\u7b26\u7684\u4f4d\u7f6e\u5c06\u6570\u636e\u5206\u6210\u884c\u3002sed\u7f16\u8f91\u5668\u6839\u636e\u5b9a\u4e49\u597d\u7684\u811a\u672c\u547d\u4ee4\u4e00\u6b21\u5904\u7406\u4e00\u884c\u6570\u636e\uff0c\u7136\u540e\u79fb\u5230\u4e0b\u4e00\u884c\u91cd\u590d\u8fd9\u4e2a\u8fc7\u7a0b\u3002</p> <p>\u5e78\u8fd0\u7684\u662f\uff0csed\u7f16\u8f91\u5668\u7684\u8bbe\u8ba1\u4eba\u5458\u5df2\u7ecf\u8003\u8651\u5230\u4e86\u8fd9\u79cd\u60c5\u51b5\uff0c\u5e76\u8bbe\u8ba1\u4e86\u5bf9\u5e94\u7684\u89e3\u51b3\u65b9\u6848\u3002sed\u7f16\u8f91\u5668\u5305\u542b\u4e86\u4e09\u4e2a\u53ef\u7528\u6765\u5904\u7406\u591a\u884c\u6587\u672c\u7684\u7279\u6b8a\u547d\u4ee4\u3002</p> <ul> <li>N\uff1a\u5c06\u6570\u636e\u6d41\u4e2d\u7684\u4e0b\u4e00\u884c\u52a0\u8fdb\u6765\u521b\u5efa\u4e00\u4e2a\u591a\u884c\u7ec4\u6765\u5904\u7406</li> <li>D\uff1a\u5220\u9664\u591a\u884c\u7ec4\u4e2d\u7684\u4e00\u884c</li> <li>P\uff1a\u6253\u5370\u591a\u884c\u7ec4\u4e2d\u7684\u4e00\u884c</li> </ul>"},{"location":"sed/#n-","title":"N - \u52a0\u8f7d\u4e0b\u4e00\u884c","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u662f\u57fa\u4e8e\u5355\u884c\u8fdb\u884c\u64cd\u4f5c\u7684\uff0c\u6709\u4e9b\u60c5\u51b5\u4e0b\u6211\u4eec\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u591a\u884c\u8fdb\u884c\u7f16\u8f91\uff0c\u542f\u7528\u591a\u884c\u7f16\u8f91\u4f7f\u7528<code>N</code>\u547d\u4ee4\uff0c\u4e0e<code>n</code>\u4e0d\u540c\u7684\u662f\uff0c<code>N</code>\u5e76\u4e0d\u4f1a\u6e05\u9664\u3001\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u7684\u5185\u5bb9\uff0c\u800c\u662f\u91c7\u7528\u4e86\u8ffd\u52a0\u6a21\u5f0f\u3002</p> <pre><code>[address1[,address2]]N\n</code></pre> <p>\u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u4f1a\u628abooks2.txt\u4e2d\u7684\u6807\u9898\u548c\u4f5c\u8005\u653e\u5230\u540c\u4e00\u884c\u5c55\u793a\uff0c\u5e76\u4e14\u4f7f\u7528\u9017\u53f7\u8fdb\u884c\u5206\u9694</p> <pre><code>$ sed 'N; s/\\n/,/g' books2.txt\nA Storm of Swords ,George R. R. Martin\nThe Two Towers ,J. R. R. Tolkien\nThe Alchemist ,Paulo Coelho\nThe Fellowship of the Ring ,J. R. R. Tolkien\nThe Pilgrimage ,Paulo Coelho\nA Game of Thrones ,George R. R. Martin\n</code></pre>"},{"location":"sed/#d-","title":"D - \u5220\u9664\u591a\u884c\u4e2d\u7684\u4e00\u884c","text":"<p>sed\u7f16\u8f91\u5668\u63d0\u4f9b\u4e86\u591a\u884c\u5220\u9664\u547d\u4ee4D\uff0c\u5b83\u53ea\u5220\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u7b2c\u4e00\u884c\u3002\u8be5\u547d\u4ee4\u4f1a\u5220\u9664\u5230\u6362\u884c\u7b26\uff08\u542b \u6362\u884c\u7b26\uff09\u4e3a\u6b62\u7684\u6240\u6709\u5b57\u7b26\u3002</p> <pre><code>$ echo '\\nThis is the header line.\\nThis is a data line.\\n\\nThis is the last line.' | sed '/^$/{N; /header/D}'\nThis is the header line.\nThis is a data line.\n\nThis is the last line.\n</code></pre>"},{"location":"sed/#p-","title":"P - \u8f93\u51fa\u591a\u884c\u4e2d\u7684\u4e00\u884c","text":"<p><code>P</code>\u547d\u4ee4\u7528\u4e8e\u8f93\u51fa<code>N</code>\u547d\u4ee4\u521b\u5efa\u7684\u591a\u884c\u6587\u672c\u7684\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u7b2c\u4e00\u884c\u3002</p> <pre><code>[address1[,address2]]P\n</code></pre> <p>\u4f8b\u5982\u4e0b\u9762\u7684\u547d\u4ee4\u53ea\u8f93\u51fa\u4e86\u56fe\u4e66\u7684\u6807\u9898</p> <pre><code>$ sed -n 'N;P' books2.txt\nA Storm of Swords\nThe Two Towers\nThe Alchemist\nThe Fellowship of the Ring\nThe Pilgrimage\nA Game of Thrones\n</code></pre>"},{"location":"sed/#_18","title":"\u5176\u5b83\u547d\u4ee4","text":""},{"location":"sed/#n-next","title":"n - \u5355\u884cnext","text":"<p>\u5c0f\u5199\u7684n\u547d\u4ee4\u4f1a\u544a\u8bc9sed\u7f16\u8f91\u5668\u79fb\u52a8\u5230\u6570\u636e\u6d41\u4e2d\u7684\u4e0b\u4e00\u6587\u672c\u884c\uff0c\u5e76\u4e14\u8986\u76d6\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u884c\u3002</p> <pre><code>$ cat data1.txt \nThis is the header line.\n\nThis is a data line.\n\nThis is the last line.\n$ sed '/header/{n ; d}' data1.txt \nThis is the header line.\nThis is a data line.\n\nThis is the last line.\n</code></pre> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u4e2d\uff0c\u9996\u5148\u4f1a\u5339\u914d\u5305\u542bheader\u7684\u884c\uff0c\u4e4b\u540e\u5c06\u79fb\u52a8\u5230\u6570\u636e\u6d41\u7684\u4e0b\u4e00\u884c\uff0c\u8fd9\u91cc\u662f\u4e00\u4e2a\u7a7a\u884c\uff0c\u7136\u540e\u6267\u884c<code>d</code>\u547d\u4ee4\u5bf9\u6539\u884c\u8fdb\u884c\u5220\u9664\uff0c\u6240\u6709\u5c31\u770b\u5230\u4e86\u8fd9\u6837\u7684\u7ed3\u679c\uff1a\u7b2c\u4e00\u4e2a\u7a7a\u884c\u88ab\u5220\u9664\u6389\u4e86\u3002</p>"},{"location":"sed/#v-sed","title":"v - SED\u7248\u672c\u68c0\u67e5","text":"<p><code>v</code>\u547d\u4ee4\u7528\u4e8e\u68c0\u67e5SED\u7684\u7248\u672c\uff0c\u5982\u679c\u7248\u672c\u5927\u4e8e\u53c2\u6570\u4e2d\u7684\u7248\u672c\u5219\u6b63\u5e38\u6267\u884c\uff0c\u5426\u5219\u5931\u8d25</p> <pre><code>[address1[,address2]]v [version]\n</code></pre> <p>\u4f8b\u5982</p> <pre><code>$ sed --version\nsed (GNU sed) 4.2.2\n\n$ sed 'v 4.2.3' books.txt\nsed: -e expression #1, char 7: expected newer version of sed\n\n$ sed 'v 4.2.2' books.txt\n1) Storm of Swords, George R. R. Martin, 1216\n2) The Two Towers, J. R. R. Tolkien, 352\n3) The Alchemist, Paulo Coelho, 197\n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\n5) The Pilgrimage, Paulo Coelho, 288\n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre>"},{"location":"sed/#_19","title":"\u7279\u6b8a\u5b57\u7b26","text":"<p>\u5728SED\u4e2d\u63d0\u4f9b\u4e86\u4e24\u4e2a\u53ef\u4ee5\u7528\u4f5c\u547d\u4ee4\u7684\u7279\u6b8a\u5b57\u7b26\uff1a= \u548c &amp; \u3002</p>"},{"location":"sed/#_20","title":"<code>=</code>\u547d\u4ee4","text":"<p><code>=</code>\u547d\u4ee4\u7528\u4e8e\u8f93\u51fa\u884c\u53f7\uff0c\u8bed\u6cd5\u683c\u5f0f\u4e3a</p> <pre><code>[/pattern/]= \n[address1[,address2]]=\n</code></pre> <p>\u4f8b\u5982\u4e3a\u6bcf\u4e00\u884c\u8f93\u51fa\u884c\u53f7</p> <pre><code>$ sed '=' books2.txt\n1\nA Storm of Swords\n2\nGeorge R. R. Martin\n...\n</code></pre> <p>\u53ea\u4e3a1-4\u884c\u8f93\u51fa\u884c\u53f7</p> <pre><code>$ sed '1, 4=' books2.txt\n1\nA Storm of Swords\n2\nGeorge R. R. Martin\n3\nThe Two Towers\n4\nJ. R. R. Tolkien\nThe Alchemist\nPaulo Coelho\nThe Fellowship of the Ring\nJ. R. R. Tolkien\nThe Pilgrimage\nPaulo Coelho\nA Game of Thrones\nGeorge R. R. Martin\n</code></pre> <p>\u5339\u914dPaulo\u7684\u884c\u8f93\u51fa\u884c\u53f7</p> <pre><code>$ sed '/Paulo/ =' books2.txt\nA Storm of Swords\nGeorge R. R. Martin\nThe Two Towers\nJ. R. R. Tolkien\nThe Alchemist\n6\nPaulo Coelho\nThe Fellowship of the Ring\nJ. R. R. Tolkien\nThe Pilgrimage\n10\nPaulo Coelho\nA Game of Thrones\nGeorge R. R. Martin\n</code></pre> <p>\u6700\u540e\u4e00\u884c\u8f93\u51fa\u884c\u53f7\uff0c\u8fd9\u4e2a\u547d\u4ee4\u6bd4\u8f83\u6709\u610f\u601d\u4e86\uff0c\u53ef\u4ee5\u7528\u4e8e\u8f93\u51fa\u6587\u4ef6\u603b\u5171\u6709\u591a\u5c11\u884c</p> <pre><code>$ sed -n '$ =' books2.txt\n12\n</code></pre>"},{"location":"sed/#_21","title":"<code>&amp;</code>\u547d\u4ee4","text":"<p>\u7279\u6b8a\u5b57\u7b26<code>&amp;</code>\u7528\u4e8e\u5b58\u50a8\u5339\u914d\u6a21\u5f0f\u7684\u5185\u5bb9\uff0c\u901a\u5e38\u4e0e\u66ff\u6362\u547d\u4ee4<code>s</code>\u4e00\u8d77\u4f7f\u7528\u3002</p> <pre><code>$ sed 's/[[:digit:]]/Book number &amp;/' books.txt\nBook number 1) Storm of Swords, George R. R. Martin, 1216\nBook number 2) The Two Towers, J. R. R. Tolkien, 352\nBook number 3) The Alchemist, Paulo Coelho, 197\nBook number 4) The Fellowship of the Ring, J. R. R. Tolkien, 432\nBook number 5) The Pilgrimage, Paulo Coelho, 288\nBook number 6) A Game of Thrones, George R. R. Martin, 864\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u7528\u4e8e\u5339\u914d\u6bcf\u4e00\u884c\u7b2c\u4e00\u4e2a\u6570\u5b57\uff0c\u5728\u5176\u524d\u9762\u6dfb\u52a0 Book number \u3002\u800c\u4e0b\u9762\u8fd9\u4e2a\u547d\u4ee4\u5219\u5339\u914d\u6700\u540e\u4e00\u4e2a\u6570\u5b57\uff0c\u5e76\u4fee\u6539\u4e3a<code>Pages =</code>\u3002\u5176\u4e2d<code>[[:digit:]]* *$</code>\u53ef\u80fd\u6bd4\u8f83\u8d39\u89e3\uff0c\u8fd9\u4e00\u90e8\u5206\u5176\u5b9e\u662f\uff1a\u5339\u914d0\u4e2a\u6216\u591a\u4e2a\u6570\u5b57+0\u4e2a\u6216\u591a\u4e2a\u7a7a\u683c+\u884c\u5c3e\u3002</p> <pre><code>sed 's/[[:digit:]]* *$/Pages = &amp;/' books.txt\n1) Storm of Swords, George R. R. Martin, Pages = 1216\n2) The Two Towers, J. R. R. Tolkien, Pages = 352\n3) The Alchemist, Paulo Coelho, Pages = 197\n4) The Fellowship of the Ring, J. R. R. Tolkien, Pages = 432\n5) The Pilgrimage, Paulo Coelho, Pages = 288\n6) A Game of Thrones, George R. R. Martin, Pages = 864\n</code></pre>"},{"location":"sed/#_22","title":"\u5b57\u7b26\u4e32","text":""},{"location":"sed/#s","title":"\u66ff\u6362\u547d\u4ee4 s","text":"<p>\u6587\u672c\u66ff\u6362\u547d\u4ee4\u975e\u5e38\u5e38\u89c1\uff0c\u5176\u683c\u5f0f\u5982\u4e0b</p> <pre><code>[address1[,address2]]s/pattern/replacement/[flags]\n</code></pre> <p>\u5728\u524d\u9762\u6211\u4eec\u4f7f\u7528\u7684books.txt\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u9017\u53f7\u201c,\u201d\u5206\u9694\u6bcf\u4e00\u5217\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f1a\u4f7f\u7528\u66ff\u6362\u547d\u4ee4\u5c06\u5176\u66ff\u6362\u4e3a\u7ba1\u9053\u7b26\u201c|\u201d\uff1a</p> <pre><code>$ sed 's/,/ |/' books.txt\n1) Storm of Swords | George R. R. Martin, 1216\n2) The Two Towers | J. R. R. Tolkien, 352\n3) The Alchemist | Paulo Coelho, 197\n4) The Fellowship of the Ring | J. R. R. Tolkien, 432\n5) The Pilgrimage | Paulo Coelho, 288\n6) A Game of Thrones | George R. R. Martin, 864\n</code></pre> <p>\u662f\u4e0d\u662f\u89c9\u5f97\u54ea\u91cc\u4e0d\u5bf9\uff1f\u76f8\u4fe1\u4f60\u5df2\u7ecf\u53d1\u73b0\uff0c\u6bcf\u4e00\u884c\u7684\u7b2c\u4e8c\u4e2a\u9017\u53f7\u90fd\u6ca1\u6709\u88ab\u66ff\u6362\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2a\u88ab\u66ff\u6362\u4e86\uff0c\u786e\u5b9e\u5982\u6b64\uff0c\u5728SED\u4e2d\uff0c\u4f7f\u7528\u66ff\u6362\u547d\u4ee4\u7684\u65f6\u5019\u9ed8\u8ba4\u53ea\u4f1a\u5bf9\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u4f4d\u7f6e\u8fdb\u884c\u66ff\u6362\u3002\u4f7f\u7528<code>g</code>\u9009\u9879\u544a\u8bc9SED\u5bf9\u6240\u6709\u5185\u5bb9\u8fdb\u884c\u66ff\u6362\uff1a</p> <pre><code>$ sed 's/,/ | /g' books.txt\n1) Storm of Swords |  George R. R. Martin |  1216\n2) The Two Towers |  J. R. R. Tolkien |  352\n3) The Alchemist |  Paulo Coelho |  197\n4) The Fellowship of the Ring |  J. R. R. Tolkien |  432\n5) The Pilgrimage |  Paulo Coelho |  288\n6) A Game of Thrones |  George R. R. Martin |  864\n</code></pre> <p>\u5982\u679c\u5bf9\u5339\u914d\u6a21\u5f0f\uff08\u6216\u5730\u5740\u8303\u56f4\uff09\u7684\u884c\u8fdb\u884c\u66ff\u6362\uff0c\u5219\u53ea\u9700\u8981\u5728<code>s</code>\u547d\u4ee4\u524d\u6dfb\u52a0\u5730\u5740\u5373\u53ef\u3002\u6bd4\u5982\u53ea\u66ff\u6362\u5339\u914dThe Pilgrimage\u7684\u884c\uff1a<code>sed '/The Pilgrimage/ s/,/ | /g' books.txt</code></p> <p>\u8fd8\u6709\u4e00\u4e9b\u5176\u5b83\u7684\u9009\u9879\uff0c\u8fd9\u91cc\u5c31\u7b80\u5355\u7684\u63cf\u8ff0\u4e00\u4e0b\uff0c\u4e0d\u5728\u5c55\u5f00\u8bb2\u89e3</p> <ul> <li>\u6570\u5b57n: \u53ea\u66ff\u6362\u7b2cn\u6b21\u5339\u914d\uff0c\u6bd4\u5982<code>sed 's/,/ | /2' books.txt</code>\uff0c\u53ea\u66ff\u6362\u6bcf\u884c\u4e2d\u7b2c\u4e8c\u4e2a\u9017\u53f7</li> <li>p\uff1a\u53ea\u8f93\u51fa\u6539\u53d8\u7684\u884c\uff0c\u6bd4\u5982<code>sed -n 's/Paulo Coelho/PAULO COELHO/p' books.txt</code></li> <li>w\uff1a\u5b58\u50a8\u6539\u53d8\u7684\u884c\u5230\u6587\u4ef6\uff0c\u6bd4\u5982<code>sed -n 's/Paulo Coelho/PAULO COELHO/w junk.txt' books.txt</code></li> <li>i\uff1a\u5339\u914d\u65f6\u5ffd\u7565\u5927\u5c0f\u5199\uff0c\u6bd4\u5982<code>sed  -n 's/pAuLo CoElHo/PAULO COELHO/pi' books.txt</code></li> </ul> <p>\u5728\u6267\u884c\u66ff\u6362\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u5982\u679c\u8981\u66ff\u6362\u7684\u5185\u5bb9\u4e2d\u5305\u542b<code>/</code>\uff0c\u8fd9\u4e2a\u65f6\u5019\u600e\u4e48\u529e\uff1f\u5f88\u7b80\u5355\uff0c\u6dfb\u52a0\u8f6c\u4e49\u64cd\u4f5c\u7b26\u3002</p> <pre><code>$ echo \"/bin/sed\" | sed 's/\\/bin\\/sed/\\/home\\/mylxsw\\/src\\/sed\\/sed-4.2.2\\/sed/'\n/home/mylxsw/src/sed/sed-4.2.2/sed\n</code></pre> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528<code>\\</code>\u5bf9<code>/</code>\u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u4e0d\u8fc7\u8868\u8fbe\u5f0f\u5df2\u7ecf\u770b\u8d77\u6765\u975e\u5e38\u96be\u770b\u4e86\uff0c\u5728SED\u4e2d\u8fd8\u53ef\u4ee5\u4f7f\u7528<code>|</code>\uff0c<code>@</code>\uff0c<code>^</code>\uff0c<code>!</code>\u4f5c\u4e3a\u547d\u4ee4\u7684\u5206\u9694\u7b26\uff0c\u6240\u4ee5\uff0c\u4e0b\u9762\u7684\u51e0\u4e2a\u547d\u4ee4\u548c\u4e0a\u9762\u7684\u662f\u7b49\u4ef7\u7684</p> <pre><code>echo \"/bin/sed\" | sed 's|/bin/sed|/mylxsw/mylxsw/src/sed/sed-4.2.2/sed|'\necho \"/bin/sed\" | sed 's@/bin/sed@/home/mylxsw/src/sed/sed-4.2.2/sed@'\necho \"/bin/sed\" | sed 's^/bin/sed^/home/mylxsw/src/sed/sed-4.2.2/sed^'\necho \"/bin/sed\" | sed 's!/bin/sed!/home/mylxsw/src/sed/sed-4.2.2/sed!'\n</code></pre>"},{"location":"sed/#_23","title":"\u5339\u914d\u5b50\u5b57\u7b26\u4e32","text":"<p>\u524d\u9762\u6211\u4eec\u5b66\u4e60\u4e86\u66ff\u6362\u547d\u4ee4\u7684\u7528\u6cd5\uff0c\u73b0\u5728\u8ba9\u6211\u4eec\u770b\u770b\u5982\u4f55\u83b7\u53d6\u5339\u914d\u6587\u672c\u4e2d\u7684\u67d0\u4e2a\u5b50\u4e32\u3002</p> <p>\u5728SED\u4e2d\uff0c\u4f7f\u7528<code>\\(</code>\u548c<code>\\)</code>\u5bf9\u5339\u914d\u7684\u5185\u5bb9\u8fdb\u884c\u5206\u7ec4\uff0c\u4f7f\u7528<code>\\N</code>\u7684\u65b9\u5f0f\u8fdb\u884c\u5f15\u7528\u3002\u8bf7\u770b\u4e0b\u9762\u793a\u4f8b</p> <pre><code>$ echo \"Three One Two\" | sed 's|\\(\\w\\+\\) \\(\\w\\+\\) \\(\\w\\+\\)|\\2 \\3 \\1|'\nOne Two Three\n</code></pre> <p>\u6211\u4eec\u8f93\u51fa\u4e86Three\uff0cOne\uff0cTwo\u4e09\u4e2a\u5355\u8bcd\uff0c\u5728SED\u7684\u66ff\u6362\u89c4\u5219\u4e2d\uff0c\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u4e86\u4e09\u5c0f\u6bb5\u6b63\u5219\u8868\u8fbe\u5f0f<code>\\(\\w\\+\\)</code>\u6765\u5339\u914d\u6bcf\u4e00\u4e2a\u5355\u8bcd\uff0c\u540e\u9762\u4f7f\u7528<code>\\1</code>\uff0c\uff0c<code>\\2</code>\uff0c<code>\\3</code>\u5206\u522b\u5f15\u7528\u5b83\u4eec\u7684\u503c\u3002</p>"},{"location":"sed/#_24","title":"\u7ba1\u7406\u6a21\u5f0f","text":"<p>\u524d\u9762\u5df2\u7ecf\u8bb2\u89e3\u8fc7\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4\u7684\u7528\u6cd5\uff0c\u5728\u672c\u8282\u4e2d\u6211\u4eec\u5c06\u4f1a\u7ee7\u7eed\u63a2\u7d22\u5b83\u4eec\u7684\u7528\u6cd5\u3002</p> <p>\u672c\u90e8\u5206\u5185\u5bb9\u6682\u672a\u66f4\u65b0\uff0c\u8bf7\u5173\u6ce8\u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6211\u5c06\u6700\u5148\u5728Github\u7684\u8fd9\u4e2a\u4ed3\u5e93\u4e2d\u66f4\u65b0\u6700\u65b0\u5185\u5bb9\u3002</p>"},{"location":"sed/#_25","title":"\u6b63\u5219\u8868\u8fbe\u5f0f","text":"<p>\u8fd9\u4e00\u90e8\u5206\u5c31\u662f\u6807\u51c6\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u4ee5\u5143\u5b57\u7b26\uff0c\u6bd4\u8f83\u719f\u6089\u7684\u8bf7\u7565\u8fc7\u3002</p>"},{"location":"sed/#_26","title":"\u6807\u51c6\u6b63\u5219\u8868\u8fbe\u5f0f","text":""},{"location":"sed/#_27","title":"^","text":"<p>\u5339\u914d\u884c\u7684\u5f00\u59cb\u3002</p> <pre><code>$ sed -n '/^The/ p' books2.txt\nThe Two Towers, J. R. R. Tolkien \nThe Alchemist, Paulo Coelho \nThe Fellowship of the Ring, J. R. R. Tolkien \nThe Pilgrimage, Paulo Coelho\n</code></pre>"},{"location":"sed/#_28","title":"$","text":"<p>\u5339\u914d\u884c\u7684\u7ed3\u5c3e</p> <pre><code>$ sed -n '/Coelho$/ p' books2.txt \nThe Alchemist, Paulo Coelho \nThe Pilgrimage, Paulo Coelho\n</code></pre>"},{"location":"sed/#_29","title":".","text":"<p>\u5339\u914d\u5355\u4e2a\u5b57\u7b26\uff08\u9664\u884c\u5c3e\uff09</p> <pre><code>$ echo -e \"cat\\nbat\\nrat\\nmat\\nbatting\\nrats\\nmats\" | sed -n '/^..t$/p'\ncat\nbat\nrat\nmat\n</code></pre>"},{"location":"sed/#_30","title":"[]","text":"<p>\u5339\u914d\u5b57\u7b26\u96c6</p> <pre><code>$ echo -e \"Call\\nTall\\nBall\" | sed -n '/[CT]all/ p'\nCall\nTall\n</code></pre>"},{"location":"sed/#_31","title":"[\\^]","text":"<p>\u6392\u9664\u5b57\u7b26\u96c6</p> <pre><code>$ echo -e \"Call\\nTall\\nBall\" | sed -n '/[^CT]all/ p'\nBall\n</code></pre>"},{"location":"sed/#-","title":"[-]","text":"<p>\u5b57\u7b26\u8303\u56f4\u3002</p> <pre><code>$ echo -e \"Call\\nTall\\nBall\" | sed -n '/[C-Z]all/ p' \nCall \nTall\n</code></pre>"},{"location":"sed/#_32","title":"\\? \uff0c\\+ \uff0c*","text":"<p>\u5206\u522b\u5bf9\u5e940\u6b21\u52301\u6b21\uff0c\u4e00\u6b21\u5230\u591a\u6b21\uff0c0\u6b21\u5230\u591a\u6b21\u5339\u914d\u3002</p>"},{"location":"sed/#n-n-m-n","title":"{n} \uff0c{n,} \uff0c{m, n}","text":"<p>\u7cbe\u786e\u5339\u914dN\u6b21\uff0c\u81f3\u5c11\u5339\u914dN\u6b21\uff0c\u5339\u914dM-N\u6b21</p>"},{"location":"sed/#_33","title":"|","text":"<p>\u6216\u64cd\u4f5c\u3002</p> <pre><code>$ echo -e \"str1\\nstr2\\nstr3\\nstr4\" | sed -n '/str\\(1\\|3\\)/ p' \nstr1\nstr3\n</code></pre>"},{"location":"sed/#posix","title":"POSIX\u517c\u5bb9\u7684\u6b63\u5219","text":"<p>\u4e3b\u8981\u5305\u542b<code>[:alnum:]</code>\uff0c<code>[:alpha:]</code>\uff0c<code>[:blank:]</code>\uff0c<code>[:digit:]</code>\uff0c<code>[:lower:]</code>\uff0c<code>[:upper:]</code>\uff0c<code>[:punct:]</code>\uff0c<code>[:space:]</code>\uff0c\u8fd9\u4e9b\u57fa\u672c\u90fd\u89c1\u540d\u4e4b\u610f\uff0c\u4e0d\u5728\u8d58\u8ff0\u3002</p>"},{"location":"sed/#_34","title":"\u5143\u5b57\u7b26","text":""},{"location":"sed/#s_1","title":"\\s","text":"<p>\u5339\u914d\u5355\u4e2a\u7a7a\u767d\u5185\u5bb9</p> <pre><code>$ echo -e \"Line\\t1\\nLine2\" | sed -n '/Line\\s/ p'\nLine 1\n</code></pre>"},{"location":"sed/#s_2","title":"\\S","text":"<p>\u5339\u914d\u5355\u4e2a\u975e\u7a7a\u767d\u5185\u5bb9\u3002</p>"},{"location":"sed/#w-w","title":"\\w \uff0c \\W","text":"<p>\u5355\u4e2a\u5355\u8bcd\u3001\u975e\u5355\u8bcd\u3002</p>"},{"location":"sed/#_35","title":"\u5e38\u7528\u4ee3\u7801\u6bb5","text":""},{"location":"sed/#cat","title":"Cat\u547d\u4ee4","text":"<p>\u6a21\u62df<code>cat</code>\u547d\u4ee4\u6bd4\u8f83\u7b80\u5355\uff0c\u6709\u4e0b\u9762\u4e24\u79cd\u65b9\u5f0f</p> <pre><code>$ sed '' books.txt\n1) Storm of Swords, George R. R. Martin, 1216\n2) The Two Towers, J. R. R. Tolkien, 352\n3) The Alchemist, Paulo Coelho, 197\n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\n5) The Pilgrimage, Paulo Coelho, 288\n6) A Game of Thrones, George R. R. Martin, 864\n\n$ sed -n 'p' books.txt\n1) Storm of Swords, George R. R. Martin, 1216\n2) The Two Towers, J. R. R. Tolkien, 352\n3) The Alchemist, Paulo Coelho, 197\n4) The Fellowship of the Ring, J. R. R. Tolkien, 432\n5) The Pilgrimage, Paulo Coelho, 288\n6) A Game of Thrones, George R. R. Martin, 864\n</code></pre>"},{"location":"sed/#_36","title":"\u79fb\u9664\u7a7a\u884c","text":"<pre><code>$ echo -e \"Line #1\\n\\n\\nLine #2\" | sed '/^$/d'\nLine #1\nLine #2\n</code></pre>"},{"location":"sed/#_37","title":"\u5220\u9664\u8fde\u7eed\u7a7a\u884c","text":"<pre><code>$ echo -e \"Line #1\\n\\n\\nLine #2\" | sed '/./,/^$/!d'\nLine #1\n\nLine #2\n</code></pre>"},{"location":"sed/#_38","title":"\u5220\u9664\u5f00\u5934\u7684\u7a7a\u884c","text":"<pre><code>$ echo -e \"\\nLine #1\\n\\nLine #2\" | sed '/./,$!d'\nLine #1\n\nLine #2\n</code></pre>"},{"location":"sed/#_39","title":"\u5220\u9664\u7ed3\u5c3e\u7684\u7a7a\u884c","text":"<pre><code>$ echo -e \"\\nLine #1\\nLine #2\\n\\n\" | sed ':start /^\\n*$/{$d; N; b start }'\n\nLine #1\n\nLine #2\n</code></pre>"},{"location":"sed/#html","title":"\u8fc7\u6ee4\u6240\u6709\u7684html\u6807\u7b7e","text":"<pre><code>$ cat html.txt\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;This is the page title&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;p&gt; This is the &lt;b&gt;first&lt;/b&gt; line in the Web page.\n    This should provide some &lt;i&gt;useful&lt;/i&gt; information to use in our sed script.\n&lt;/body&gt;\n&lt;/html&gt;                                                                                  \n$ sed 's/&lt;[^&gt;]*&gt;//g ; /^$/d' html.txt\n    This is the page title\n     This is the first line in the Web page.\n    This should provide some useful information to use in our sed script.\n</code></pre>"},{"location":"sed/#c_1","title":"\u4eceC++\u7a0b\u5e8f\u4e2d\u79fb\u9664\u6ce8\u91ca","text":"<p>\u6709\u4e0b\u9762\u8fd9\u6837\u4e00\u4e2acpp\u6587\u4ef6</p> <pre><code>$ cat hello.cpp\n#include &lt;iostream&gt; \nusing namespace std; \nint main(void) \n{ \n   // Displays message on stdout. \n   cout &gt;&gt; \"Hello, World !!!\" &gt;&gt; endl;  \n   return 0; // Return success. \n}\n</code></pre> <p>\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u79fb\u9664\u6ce8\u91ca</p> <pre><code>$ sed 's|//.*||g' hello.cpp\n#include &lt;iostream&gt;\nusing namespace std;\nint main(void)\n{\n\n   cout &gt;&gt; \"Hello, World !!!\" &gt;&gt; endl;\n   return 0;\n }\n</code></pre>"},{"location":"sed/#_40","title":"\u4e3a\u67d0\u4e9b\u884c\u6dfb\u52a0\u6ce8\u91ca","text":"<pre><code>$ sed '3,5 s/^/#/' hello.sh \n#!/bin/bash \n#pwd \n#hostname \n#uname -a \nwho \nwho -r \nlsb_release -a\n</code></pre>"},{"location":"sed/#wc-l","title":"\u5b9e\u73b0Wc -l\u547d\u4ee4","text":"<p><code>wc -l</code>\u547d\u4ee4\u7528\u4e8e\u7edf\u8ba1\u6587\u4ef6\u4e2d\u7684\u884c\u6570\uff0c\u4f7f\u7528SED\u4e5f\u53ef\u4ee5\u6a21\u62df\u8be5\u547d\u4ee4</p> <pre><code>$ wc -l hello.cpp\n       9 hello.cpp\n$ sed -n '$ =' hello.cpp\n9\n</code></pre>"},{"location":"sed/#head","title":"\u6a21\u62df\u5b9e\u73b0<code>head</code>\u547d\u4ee4","text":"<p><code>head</code>\u547d\u4ee4\u7528\u4e8e\u8f93\u51fa\u6587\u4ef6\u4e2d\u7684\u524d10\u884c\u5185\u5bb9\u3002</p> <pre><code>$ head books2.txt\nA Storm of Swords\nGeorge R. R. Martin\nThe Two Towers\nJ. R. R. Tolkien\nThe Alchemist\nPaulo Coelho\nThe Fellowship of the Ring\nJ. R. R. Tolkien\nThe Pilgrimage\nPaulo Coelho\n</code></pre> <p>\u4f7f\u7528SED\u4e2d\u7684<code>sed '10 q'</code>\u53ef\u4ee5\u6a21\u62df\u5b83\u7684\u5b9e\u73b0</p> <pre><code>$ sed '10 q' books.txt \nA Storm of Swords \nGeorge R. R. Martin \nThe Two Towers \nJ. R. R. Tolkien \nThe Alchemist \nPaulo Coelho \nThe Fellowship of the Ring \nJ. R. R. Tolkien \nThe Pilgrimage\nPaulo Coelho\n</code></pre>"},{"location":"sed/#tail-1","title":"\u6a21\u62df<code>tail -1</code>\u547d\u4ee4","text":"<p><code>tail -1</code>\u8f93\u51fa\u6587\u4ef6\u7684\u6700\u540e\u4e00\u884c\u3002</p> <pre><code>$ cat test.txt\nLine #1 \nLine #2\n\n$ tail -1 test.txt\nLine #2\n$ sed $ sed -n '$p' test.txt\nLine #2\n</code></pre>"},{"location":"sed/#dos2unix","title":"\u6a21\u62df<code>Dos2unix</code>\u547d\u4ee4","text":"<p>\u5728DOS\u73af\u5883\u4e2d\uff0c\u6362\u884c\u7b26\u662f\u4f7f\u7528CR/LF\u4e24\u4e2a\u5b57\u7b26\u4e00\u8d77\u8868\u793a\u7684\uff0c\u4e0b\u9762\u547d\u4ee4\u6a21\u62df\u4e86<code>dos2unix</code>\u547d\u4ee4\u8f6c\u6362\u8fd9\u4e9b\u6362\u884c\u7b26\u4e3aUNIX\u6362\u884c\u7b26\u3002</p> <p>\u5728GNU/Linux\u73af\u5883\u4e2d\uff0cCR/LF\u901a\u5e38\u4f7f\u7528\"\\^M\"\uff08\u4e0d\u662f\u7b80\u5355\u7684\u4e24\u4e2a\u7b26\u53f7\u7ec4\u5408\uff0c\u8bf7\u4f7f\u7528\u5feb\u6377\u952eCtrl+v,Ctrl+m\u8f93\u5165\uff09\u8fdb\u884c\u8868\u793a\u3002</p> <pre><code>$ echo -e \"Line #1\\r\\nLine #2\\r\" &gt; test.txt\n$ file test.txt\ntest.txt: ASCII text, with CRLF line terminators\n$ sed 's/^M$//' test.txt &gt; new.txt\n$ file new.txt\nnew.txt: ASCII text\n$ cat -vte new.txt\nLine #1$\nLine #2$\n</code></pre>"},{"location":"sed/#unix2dos","title":"\u6a21\u62df<code>Unix2dos</code>\u547d\u4ee4","text":"<pre><code>$ file new.txt\nnew.txt: ASCII text\n$ sed 's/$/\\r/' new.txt &gt; new2.txt\n$ file new2.txt\nnew2.txt: ASCII text, with CRLF line terminators\n\n$ cat -vte new2.txt\nLine #1^M$\nLine #2^M$\n</code></pre>"},{"location":"sed/#cat-e","title":"\u6a21\u62df<code>cat -E</code>\u547d\u4ee4","text":"<p><code>cat -E</code>\u547d\u4ee4\u4f1a\u5728\u6bcf\u4e00\u884c\u7684\u884c\u5c3e\u8f93\u51fa\u4e00\u4e2a$\u7b26\u53f7\u3002</p> <pre><code>$ echo -e \"Line #1\\nLine #2\" | cat -E\nLine #1$\nLine #2$\n$ echo -e \"Line #1\\nLine #2\" | sed 's|$|&amp;$|'\nLine #1$\nLine #2$\n</code></pre> <p>\u6ce8\u610f\uff0c\u5728Mac\u4e0b\u4e0d\u652f\u6301<code>cat -E</code>\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528sed\u4ee3\u66ff</p>"},{"location":"sed/#cat-et","title":"\u6a21\u62df<code>cat -ET</code>\u547d\u4ee4","text":"<p><code>cat -ET</code>\u547d\u4ee4\u4e0d\u4ec5\u5bf9\u6bcf\u4e00\u884c\u7684\u884c\u5c3e\u6dfb\u52a0$\uff0c\u8fd8\u4f1a\u5c06\u6bcf\u4e00\u884c\u4e2d\u7684TAB\u663e\u793a\u4e3a^I\u3002</p> <pre><code>$ echo -e \"Line #1\\tLine #2\" | cat -ET\nLine #1^ILine #2$\n$ echo -e \"Line #1\\tLine #2\" | sed -n 'l' | sed 'y/\\\\t/^I/'\nLine #1^ILine #2$\n</code></pre>"},{"location":"sed/#nl","title":"\u6a21\u62df<code>nl</code>\u547d\u4ee4","text":"<p>\u547d\u4ee4<code>nl</code>\u53ef\u4ee5\u4e3a\u8f93\u5165\u5185\u5bb9\u7684\u6bcf\u4e00\u884c\u6dfb\u52a0\u884c\u53f7\uff0c\u8bb0\u5f97\u4e4b\u524d\u4ecb\u7ecd\u7684<code>=</code>\u64cd\u4f5c\u7b26\u5427\uff0c\u5728SED\u4e2d\u6211\u4eec\u53ef\u4ee5\u7528\u5b83\u6765\u5b9e\u73b0\u4e0e<code>nl</code>\u547d\u4ee4\u7c7b\u4f3c\u7684\u529f\u80fd\u3002</p> <pre><code>$ echo -e \"Line #1\\nLine #2\" |nl\n     1  Line #1\n     2  Line #2\n$ echo -e \"Line #1\\nLine #2\" | sed = |  sed 'N;s/\\n/\\t/'\n1   Line #1\n2   Line #2\n</code></pre> <p>\u4e0a\u9762\u7684SED\u547d\u4ee4\u4f7f\u7528\u4e86\u4e24\u6b21\uff0c\u7b2c\u4e00\u6b21\u4f7f\u7528<code>=</code>\u64cd\u4f5c\u7b26\u4e3a\u6bcf\u4e00\u884c\u8f93\u51fa\u884c\u53f7\uff0c\u6ce8\u610f\u8fd9\u4e2a\u884c\u53f7\u662f\u72ec\u5360\u4e00\u884c\u7684\uff0c\u56e0\u6b64\u4f7f\u7528\u7ba1\u9053\u7b26\u8fde\u63a5\u4e86\u7b2c\u4e8c\u4e2aSED\u547d\u4ee4\uff0c\u6bcf\u6b21\u8bfb\u53d6\u4e24\u884c\uff0c\u5c06\u6362\u884c\u7b26\u66ff\u6362\u4e3aTab\uff0c\u8fd9\u6837\u5c31\u6a21\u62df\u51fa\u4e86<code>nl</code>\u547d\u4ee4\u7684\u6548\u679c\u3002</p>"},{"location":"sed/#cp","title":"\u6a21\u62df<code>cp</code>\u547d\u4ee4","text":"<pre><code>$ sed -n 'w dup.txt' data.txt\n$ diff data.txt dup.txt\n$ echo $?\n0\n</code></pre>"},{"location":"sed/#expand","title":"\u6a21\u62df<code>expand</code>\u547d\u4ee4","text":"<p><code>expand</code>\u547d\u4ee4\u4f1a\u8f6c\u6362\u8f93\u5165\u4e2d\u7684TAB\u4e3a\u7a7a\u683c\uff0c\u5728SED\u4e2d\u4e5f\u53ef\u4ee5\u6a21\u62df\u5b83</p> <pre><code>$ echo -e \"One\\tTwo\\tThree\" &gt; test.txt\n$ expand test.txt &gt; expand.txt\n$ sed 's/\\t/     /g' test.txt &gt; new.txt\n$ diff new.txt expand.txt\n$ echo $?\n0\n</code></pre>"},{"location":"sed/#tee","title":"\u6a21\u62df<code>tee</code>\u547d\u4ee4","text":"<p><code>tee</code>\u547d\u4ee4\u4f1a\u5c06\u6570\u636e\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u7684\u540c\u65f6\u5199\u5165\u6587\u4ef6\u3002</p> <pre><code>$ echo -e \"Line #1\\nLine #2\" | tee test.txt  \nLine #1 \nLine #2\n</code></pre> <p>\u5728SED\u4e2d\uff0c\u5b9e\u73b0\u8be5\u547d\u4ee4\u975e\u5e38\u7b80\u5355</p> <pre><code>$ sed -n 'p; w new.txt' test.txt\nOne Two Three\n</code></pre>"},{"location":"sed/#cat-s","title":"\u6a21\u62df<code>cat -s</code>\u547d\u4ee4","text":"<p><code>cat -s</code>\u547d\u4ee4\u4f1a\u5c06\u8f93\u5165\u6587\u4ef6\u4e2d\u7684\u591a\u884c\u7a7a\u884c\u5408\u5e76\u4e3a\u4e00\u884c\u3002</p> <pre><code>$ echo -e \"Line #1\\n\\n\\n\\nLine #2\\n\\n\\nLine #3\" | cat -s\nLine #1\n\nLine #2\n\nLine #3\n</code></pre> <p>\u5728SED\u4e2d\u5b9e\u73b0</p> <pre><code>$ echo -e \"Line #1\\n\\n\\n\\nLine #2\\n\\n\\nLine #3\" | sed '1s/^$//p;/./,/^$/!d'\nLine #1\n\nLine #2\n\nLine #3\n</code></pre> <p>\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f<code>/./,/^$/!d</code>\u8fd9\u4e2a\u547d\u4ee4\uff0c\u5b83\u7684\u610f\u601d\u662f\u5339\u914d\u533a\u95f4<code>/./</code>\u5230<code>/^$</code>\uff0c\u533a\u95f4\u7684\u5f00\u59cb\u4f1a\u5339\u914d\u81f3\u5c11\u5305\u542b\u4e00\u4e2a\u5b57\u7b26\u7684\u884c\uff0c\u7ed3\u675f\u4f1a\u5339\u914d\u4e00\u4e2a\u7a7a\u884c\uff0c\u5728\u8fd9\u4e2a\u533a\u95f4\u4e2d\u7684\u884c\u4e0d\u4f1a\u88ab\u5220\u9664\u3002</p>"},{"location":"sed/#grep","title":"\u6a21\u62df<code>grep</code>\u547d\u4ee4","text":"<pre><code>$ echo -e \"Line #1\\nLine #2\\nLine #3\" | grep 'Line #1'\nLine #1\n$ echo -e \"Line #1\\nLine #2\\nLine #3\" | sed -n '/Line #1/p'\nLine #1\n</code></pre>"},{"location":"sed/#grep-v","title":"\u6a21\u62df<code>grep -v</code>\u547d\u4ee4","text":"<pre><code>$ echo -e \"Line #1\\nLine #2\\nLine #3\" | grep -v 'Line #1'\nLine #2\nLine #3\n$ echo -e \"Line #1\\nLine #2\\nLine #3\" | sed -n '/Line #1/!p'\nLine #2\nLine #3\n</code></pre>"},{"location":"sed/#tr","title":"\u6a21\u62df<code>tr</code>\u547d\u4ee4","text":"<p><code>tr</code>\u547d\u4ee4\u7528\u4e8e\u5b57\u7b26\u8f6c\u6362</p> <pre><code>$ echo \"ABC\" | tr \"ABC\" \"abc\"\nabc\n$ echo \"ABC\" | sed 'y/ABC/abc/'\nabc\n</code></pre>"},{"location":"sed/#_41","title":"\u5199\u5728\u6700\u540e","text":"<p>\u770b\u5230\u8fd9\u91cc\uff0c\u4f60\u80af\u5b9a\u8981\u5410\u69fd\u4e86\uff0c\u4e0d\u662f\u8bf4\u4e86\u4e09\u5341\u5206\u949f\u5b66\u4f1a\u5417\uff1f\u4f60\u786e\u5b9a\u4f60\u80fd\u4e09\u5341\u5206\u949f\u5b66\u4f1a\uff1f\u4e0a\u6b21\u7684[\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK][]\u8bf4\u4e09\u5341\u5206\u949f\u5b66\u4f1a\u4e0d\u9760\u8c31\uff0c\u8fd9\u6b21\u53c8\u4e0d\u9760\u8c31\u4e86\u3002\u4e0d\u597d\u610f\u601d\uff0c\u8fd9\u91cc\u7684\u4e09\u5341\u5206\u949f\u5176\u5b9e\u53ea\u662f\u4e3a\u4e86\u5438\u5f15\u4f60\u7684\u6ce8\u610f\u800c\u5df2\uff0c\u53ea\u6709\u5728\u4f60\u5df2\u7ecf\u7528\u8fc7SED\u5e76\u5bf9\u5b83\u7684\u4e00\u4e9b\u7279\u6027\u6709\u6240\u4e86\u89e3\u7684\u60c5\u51b5\u4e0b\u4e09\u5341\u5206\u949f\u770b\u5b8c\u624d\u662f\u6709\u53ef\u80fd\u7684\uff0c\u6bd5\u7adf\u90a3\u4e48\u591a\u7279\u6b8a\u5b57\u7b26\uff0c\u90a3\u4e48\u591a\u547d\u4ee4\u9700\u8981\u8bb0\u4f4f\u3002\u4e0d\u8fc7\u8bdd\u8bf4\u56de\u6765\uff0c\u770b\u5b8c\u4e4b\u540e\u4f60\u6709\u6536\u83b7\u5417\uff1f\u6709\u7684\u8bdd\uff0c\u90a3\u672c\u6587\u7684\u76ee\u7684\u5c31\u8fbe\u5230\u4e86\uff0c\u4e4b\u540e\u7528\u5230SED\u7684\u65f6\u5019\u518d\u56de\u6765\u53c2\u8003\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u672c\u6587\u5c06\u4f1a\u6301\u7eed\u4fee\u6b63\u548c\u66f4\u65b0\uff0c\u6700\u65b0\u5185\u5bb9\u8bf7\u53c2\u8003\u6211\u7684 GITHUB \u4e0a\u7684 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6b22\u8fce Star\u3002</p>"},{"location":"sed/#_42","title":"\u53c2\u8003","text":"<ul> <li>Sed Tutorial</li> <li>Linux\u547d\u4ee4\u884c\u4e0eshell\u811a\u672c\u7f16\u7a0b\u5927\u5168\uff08\u7b2c3\u7248\uff09</li> </ul>"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/","title":"\u30bf\u30b0VLAN \u3068\u306f","text":"<p>\u30bf\u30b0VLAN (Tag VLAN) \u3068\u306f\u3001\u8907\u6570\u306eVLAN\u30921\u672c\u306eLAN\u63a5\u7d9a\u3060\u3051\u3067\u8907\u6570\u30b9\u30a4\u30c3\u30c1\u9593\u3067\u5171\u6709\u3067\u304d\u308b\u6280\u8853\u3067\u3059\u3002</p> <p><code>IEEE802.1q</code> \u3068\u3044\u3046\u898f\u683c\u3067\u898f\u5b9a\u3055\u308c\u3066\u304a\u308a\u3001VLAN ID \u306f <code>1\uff5e4094</code> \u304c\u4f7f\u3048\u307e\u3059\u3002</p> <p>\u5177\u4f53\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30b9\u30a4\u30c3\u30c1\u540c\u58eb\u3092\u63a5\u7d9a\u3059\u308b\u30dd\u30fc\u30c8\u306b <code>trunk port</code> (\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3002 <code>tag port</code> \u3068\u547c\u3070\u308c\u305f\u308a\u3057\u307e\u3059) \u306e\u8a2d\u5b9a\u3092\u5165\u308c\u3066\u63a5\u7d9a\u3057\u307e\u3059\u3002</p> <p>\u3059\u308b\u3068\u305d\u306e\u30ea\u30f3\u30af(\u30c8\u30e9\u30f3\u30af\u30ea\u30f3\u30af)\u306f VLAN ID \u60c5\u5831\u3092\u542b\u3080 Tag \u3092\u4ed8\u3051\u3066\u901a\u4fe1\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002</p> <p></p> <p>\u4f8b\u3067\u306f VLAN \u304c 3 \u3064\u3060\u3051\u3067\u3059\u306e\u3067\u3001\u5404VLAN 1\u672c\u305a\u3064\u3001 \u7cfb3\u672c\u306e\u30b1\u30fc\u30d6\u30eb\u3092\u30b9\u30a4\u30c3\u30c1\u9593\u3067\u63a5\u7d9a\u3059\u308b\u69cb\u6210\u3082\u53ef\u80fd\u3067\u3059\u304c\u3053\u308c\u306f\u975e\u52b9\u7387\u3067\u3059\u3002 \u4f8b\u3048\u3070\u3053\u308c\u304c\u3001VLAN \u304c20\u500b\u3042\u3063\u305f\u3068\u3057\u305f\u3089\u305d\u308c\u3060\u3051\u3067\u30b1\u30fc\u30d6\u30eb\u3068\u30dd\u30fc\u30c8\u309220\u30dd\u30fc\u30c8\u3082\u6d88\u8cbb\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002</p> <p>\u3053\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u3067\u3082\u3001\u30bf\u30b0 VLAN \u3092\u4f7f\u3048\u3070 1 \u30dd\u30fc\u30c8\u3060\u3051\u3067 20 \u500b\u306e VLAN \u3092\u5171\u6709\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#native-vlan-pvid","title":"Native VLAN (PVID) \u3068\u306f","text":"<p>Native VLAN \u3068\u306f\u3001\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u306e\u4e2d\u3067\u3001\u30bf\u30b0\u3092\u4ed8\u3051\u306a\u3044 VLAN ID \u306e\u3053\u3068\u3092\u6307\u3057\u307e\u3059\u3002 <code>\u30c7\u30d5\u30a9\u30eb\u30c8VLAN</code> \u3084 <code>PVID (Port VLAN ID)</code> \u3082\u540c\u3058\u610f\u5473\u3067\u3059\u3002</p> <p>\u3053\u306e Native VLAN \u3082 IEEE802.1q \u306e\u898f\u683c\u3067\u6c7a\u307e\u3063\u3066\u304a\u308a\u3001 \u5404\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u30671\u3064\u3060\u3051\u3001\u3053\u306e Native VLAN \u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059 \uff08\u6a5f\u5668\u5358\u4f4d\u3067\u306f\u306a\u304f\u30dd\u30fc\u30c8\u5358\u4f4d\u3067\u6307\u5b9a\u3067\u304d\u308b\u3082\u306e\u304c\u591a\u3044\u3067\u3059\uff09\u3002  </p> <p>\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u5168\u30dd\u30fc\u30c8 <code>VLAN ID=1</code> \u304c <code>Native VLAN</code> \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#native-vlan","title":"Native VLAN \u306e\u4e0d\u4e00\u81f4","text":"<p>\u4e0a\u56f3\u5de6\u5074\u306e\u4f8b\u306b\u793a\u3057\u305f\u901a\u308a\u3001Native VLAN \u306f\u30c8\u30e9\u30f3\u30af\u30ea\u30f3\u30af\u306e\u4e21\u7aef\u3067\u63c3\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059 \uff08\u30b9\u30a4\u30c3\u30c1\u306e\u5168\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3067\u305d\u308d\u3048\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\uff09\u3002</p> <p>\u3082\u3057\u63c3\u3048\u306a\u3044\u3068\u3001\u4f8b\u306e\u53f3\u5074\u306e\u300c\u60aa\u3044\u4f8b\u300d\u306e\u3088\u3046\u306b\u3001VLAN 1 \u306e\u901a\u4fe1\u304c VLAN 2 \u306b\u6df7\u5165\u3057\u305f\u308a\u3068\u3001 \u8ad6\u7406\u69cb\u6210\u306b\u637b\u3058\u308c\u304c\u767a\u751f\u3057\u305f\u308a\u3057\u307e\u3059\u3002</p> <p>Native VLAN \u306e\u4e0d\u4e00\u81f4\u306f\u3001\u7279\u306b PVSTP\u3067\u306f\u30eb\u30fc\u30d7\u306e\u691c\u77e5\u304c\u51fa\u6765\u306a\u304f\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u305f\u3081\u3001 \u30a8\u30e9\u30fc\u306b\u3082\u51fa\u529b\u3055\u308c\u307e\u3059\u3002</p> <p>\u306a\u304a\u3001<code>CDP (Cisco Discovery Protocol)</code> \u306b\u306f Native VLAN \u60c5\u5831\u3082\u4e57\u3063\u3066\u304a\u308a\u3001\u4e0d\u4e00\u81f4\u304c\u3042\u308b\u3068 <code>\"%CDP-4-NATIVE_VLAN_MISMATCH: Native VLAN mismatch discovered on \"</code> \u3068\u3044\u3063\u305f\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002</p>"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#vlan_1","title":"\u3069\u3046\u3044\u3046\u6642\u306b\u30cd\u30a4\u30c6\u30a3\u30d6VLAN\u3092\u5909\u66f4\u3059\u308b\uff1f","text":"<p>\u5909\u66f4\u3059\u308b\u7406\u7531\u306f\u57fa\u672c\u7684\u306b\u306f\u7121\u3044\u306f\u305a\u3067\u3059\u304c\u3001\u30b1\u30fc\u30b9\u3068\u3057\u30662\u3064\u4f8b\u3092\u6319\u3052\u307e\u3059\u3002</p> <ul> <li>1\u3064\u76ee\u306f\u3001\u4f8b\u3048\u3070\u30cd\u30a4\u30c6\u30a3\u30d6 VLAN \u3092 10 \u306b\u3059\u308b\u3068\u3001 \u305d\u306e\u30dd\u30fc\u30c8\u306b PC \u3084 VLAN \u975e\u5bfe\u5fdc\u306e\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30cf\u30d6\u3092\u63a5\u7d9a\u3059\u308b\u3068\u3001 VLAN 10 \u3067\u901a\u4fe1\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u3042\u305f\u308a\u306f\u4e0b\u8a18\u8a18\u4e8b\u306b\u3082\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002</li> </ul> <p>\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3068\u30a2\u30af\u30bb\u30b9\u30dd\u30fc\u30c8\u306e\u9055\u3044\u3001trunk port \u306b access port \u3084 PC \u3092\u63a5\u7d9a\u3059\u308b\u3068\u3069\u3046\u306a\u308b\u304b</p> <ul> <li>2\u3064\u76ee\u306f\u30011\u3064\u76ee\u306b\u95a2\u9023\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8 VLAN \u3067\u3042\u308b VLAN 1 \u306f\u3001 telnet \u63a5\u7d9a\u7528\u7b49\u306e\u7ba1\u7406\u7528\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u3053\u3068\u3082\u591a\u3044\u3067\u3059\u3002 \u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3092\u4e00\u822c\u30e6\u30fc\u30b6\u304c\u7269\u7406\u7684\u306b\u3044\u3058\u308c\u308b\u4f4d\u7f6e\u306b\u3042\u308b\u3068\u3001 \u305d\u306e\u30dd\u30fc\u30c8\u3092\u5f15\u3063\u3053\u629c\u3044\u3066 PC \u306b\u63a5\u7d9a\u3059\u308b\u3068 VLAN 1 \u3078\u30a2\u30af\u30bb\u30b9\u3067\u304d\u3066\u3057\u307e\u3044\u307e\u3059\u3002</li> </ul> <p>\u305d\u306e\u3088\u3046\u306a\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u7406\u7531\u3067\u3001\u9069\u5f53\u306a VLAN \u306b\u5909\u66f4\u3059\u308b\u30b1\u30fc\u30b9\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u3002</p>"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#accesstrunktagged-untagged","title":"access\u30dd\u30fc\u30c8\u3001trunk\u30dd\u30fc\u30c8\u3068tagged, untagged\u306b\u3064\u3044\u3066","text":"<p>\u30e1\u30fc\u30ab\u306b\u3088\u3063\u3066\u306f\u3001<code>access \u30dd\u30fc\u30c8</code>\u3001<code>trunk \u30dd\u30fc\u30c8</code>\u3068\u3044\u3046\u62ec\u308a\u304c\u306a\u304f\u3001 \u5358\u7d14\u306b\u30dd\u30fc\u30c8\u5358\u4f4d\u3067 <code>tagged</code>\u3001<code>untagged</code> \u306eVLAN ID \u3092\u6307\u5b9a\u3059\u308b\u30b9\u30a4\u30c3\u30c1\u3082\u3042\u308a\u307e\u3059\u3002</p> <p>\u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5bfe\u5fdc\u306b\u306a\u308a\u307e\u3059\u3002</p> access, trunk tagged, untagged access vlan=10 untagged=10 trunk vlan=10,20 tagged=10,20 trunk vlan=20(native vlan), 30,40 untagged=20, tagged=30,40 <p>\u5404\u30dd\u30fc\u30c8\u3067 untagged \u306e VLAN \u306f 0\uff5e1\u500b\u3001tagged \u306e VLAN \u306f0\u500b\u4ee5\u4e0a\u3067\u3059\u3002</p> <p>\u4e21\u65b9\u3068\u3082 0 \u500b\u306b\u306a\u308b\u3053\u3068\u306f\u306a\u304f\u3001untagged \u304c 1 \u500b\u3060\u3051\u306a\u3089\u305d\u306e\u30dd\u30fc\u30c8\u306f\u30a2\u30af\u30bb\u30b9\u30dd\u30fc\u30c8\u3001 \u305d\u3053\u306b tagged \u30821\u500b\u4ee5\u4e0a\u4e57\u308b\u306a\u3089\u305d\u308c\u306f\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8(untagged \u306f native VLAN)\u306b\u306a\u308a\u307e\u3059\u3002</p>"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#native-vlan_1","title":"Native VLAN \u3092\u30bf\u30b0\u4ed8\u304d\u3067\u53d7\u4fe1\u3057\u305f\u5834\u5408\u306e\u6319\u52d5","text":"<p>Native VLAN \u3084 untagged \u306b\u6307\u5b9a\u3057\u305fVLAN \u3092\u3001\u30bf\u30b0\u4ed8\u304d\u3067\u53d7\u4fe1\u3057\u305f\u5834\u5408\u306e\u6319\u52d5\u306f\u3001\u30e1\u30fc\u30ab\u306b\u3088\u3063\u3066\u7570\u306a\u308a\u307e\u3059\u3002</p> <p>\u4f8b\u3048\u3070\u3001Native VLAN=10 \u306b\u8a2d\u5b9a\u3057\u305f\u30dd\u30fc\u30c8\u3067\u3001\u30bf\u30b0\u4ed8\u304d\u306e VLAN 10 \u3092\u53d7\u4fe1\u3057\u305f\u5834\u5408\u3001 \u901a\u5e38\u306e VLAN=10 \u3068\u3057\u3066\u8a31\u53ef\u3059\u308b\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3057\u3001\u7834\u68c4\u3055\u308c\u3066\u3057\u307e\u3046\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u306e\u3067\u3001 \u3082\u3057\u305d\u306e\u3088\u3046\u306a\u69cb\u6210\u3092\u3059\u308b\u5834\u5408\u306f\u4e8b\u524d\u306b\u78ba\u8a8d\u304c\u5fc5\u8981\u3067\u3059\u3002</p>"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#voice-vlan","title":"voice vlan \u3067\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u7406\u7531","text":"<p><code>voice vlan</code> \u306f\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u306e\u304c <code>cisco</code> \u306e\u63a8\u5968\u3067\u3059\u3002 2 byte \u3068\u306f\u3044\u3048\u3001\u901f\u5ea6\u306b\u30b7\u30d3\u30a2\u306a\u97f3\u58f0\u30d1\u30b1\u30c3\u30c8\u306b\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9\u3068\u3082\u306a\u308b\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u306e\u306f\u4f55\u6545\u3067\u3057\u3087\u3046\u304b\uff1f</p> <p>\u3053\u308c\u306f\u3001<code>tag vlan</code> \u306b\u306f <code>IEEE802.1p</code> \u3068\u3044\u3046 <code>QoS</code> \u3067\u5229\u7528\u3067\u304d\u308b\u30d5\u30a3\u30fc\u30eb\u30c9 (\u901a\u79f0 cos) \u304c\u3042\u308b\u304b\u3089\u3067\u3059\u3002 \u97f3\u58f0\u30d1\u30b1\u30c3\u30c8\u306f\u3053\u306e <code>cos</code> \u5024\u3092 <code>5</code> \u306b\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\u30b9\u30a4\u30c3\u30c1\u306b\u300e\u3053\u306e\u30d1\u30b1\u30c3\u30c8\u306f\u512a\u5148\u3067\u901a\u904e\u3055\u305b\u3066\u306d\u300f\u3068\u4f1d\u3048\u308b\u306e\u3067\u3059\u3002</p> <p>\u306a\u304a\u3001\u5358\u306b <code>cos</code> \u5024\u3092 <code>5</code> \u306b\u30bb\u30c3\u30c8\u3059\u308b\u3060\u3051\u3067\u306f <code>QoS</code> \u306f\u52d5\u4f5c\u3057\u307e\u305b\u3093\u3002 \u7d4c\u7531\u3059\u308b\u5404\u30b9\u30a4\u30c3\u30c1\u3067\u300ecos \u5024 = 5 \u306e\u30d1\u30b1\u30c3\u30c8\u3092\u512a\u5148\u3067\u51fa\u529b\u3059\u308b\u300f\u3068\u3044\u3046\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002</p>"},{"location":"ubnt/","title":"ubnt","text":"<ul> <li>Edgerouter Lite-3\u3067DS-Lite</li> </ul>"},{"location":"ubnt/#add-nat","title":"Add nat","text":"<ul> <li>EdgeRouter - Port Forwarding</li> </ul> <pre><code>    set firewall name WAN_IN rule 22 action accept\n    set firewall name WAN_IN rule 22 destination address 192.168.1.100\n    set firewall name WAN_IN rule 22 destination port 22\n    set firewall name WAN_IN rule 22 protocol tcp\n\n    set service nat rule 22 description \"port forward to Server (ssh)\"\n    set service nat rule 22 destination port 22\n    set service nat rule 22 inbound-interface pppoe0\n    set service nat rule 22 inside-address address 192.168.1.100\n    set service nat rule 22 inside-address port 22\n    set service nat rule 22 protocol tcp\n    set service nat rule 22 type destination\n    commit\n    save\n</code></pre>"},{"location":"ubnt/#add-dynamic-dns","title":"Add dynamic DNS","text":"\u8a2d\u5b9a\u5024 Duck DNS domain return-0.duckdns.org Interface pppoe0 Service custom-duckdns Hostname return-0 Login nouser Password Duck DNS \u306e\u30b5\u30a4\u30c8\u306b\u8868\u793a\u3055\u308c\u308b<code>token</code> Protocol dyndns2 Server www.duckdns.org <ul> <li>duckdns</li> <li>EdgeRouter X - 5. \u30c0\u30a4\u30ca\u30df\u30c3\u30af DNS \u306e\u8a2d\u5b9a ( DDNS )</li> </ul> <pre><code>root@ubnt:/home/ubnt# configure\n[edit]\nroot@ubnt# set service dns dynamic interface pppoe0  service custom-duckdns host-name return-0\n[edit]\nroot@ubnt# set service dns dynamic interface pppoe0  service custom-duckdns login nosuer\n[edit]\nroot@ubnt# set service dns dynamic interface pppoe0  service custom-duckdns password xxxtokenxxxx\n[edit]\nroot@ubnt# set service dns dynamic interface pppoe0  service custom-duckdns protocol dyndns2\n[edit]\nroot@ubnt# set service dns dynamic interface pppoe0  service custom-duckdns server www.duckdns.org\n[edit]\nroot@ubnt# commit\n[edit]\nroot@ubnt# save\nSaving configuration to '/config/config.boot'...\nDone\n[edit]\nroot@ubnt#\nroot@ubnt:/home/ubnt# show dns dynamic status\n# ddns\ninterface    : pppoe0\nip address   : &lt;PublicIP&gt;\nhost-name    : &lt;hostname&gt; (xxx.ddns.net)\nlast update  : Wed Apr 25 10:28:27 2018\nupdate-status: good\n# duckdns\ninterface    : pppoe0\nip address   : &lt;PublicIP&gt;\nhost-name    : &lt;hostname&gt; (xxx)\nlast update  : Wed Apr 25 10:28:27 2018\nupdate-status: good\nroot@ubnt:/home/ubnt#\n</code></pre>"},{"location":"ubnt/#create-vpn-l2tp","title":"create VPN L2TP","text":"<pre><code>SSH \u3067\u30eb\u30fc\u30bf\u30fc\u306b\u30a2\u30af\u30bb\u30b9\n## \u8a2d\u5b9a\u30e2\u30fc\u30c9\u306b\u5165\u308b\nconfigure\n</code></pre>"},{"location":"ubnt/#add-firewall-rules-for-the-l2tp-traffic-to-the-local-firewall-policy","title":"Add firewall rules for the L2TP traffic to the local firewall policy.","text":"<pre><code>    set firewall name WAN_LOCAL rule 30 action accept\n    set firewall name WAN_LOCAL rule 30 description ike\n    set firewall name WAN_LOCAL rule 30 destination port 500\n    set firewall name WAN_LOCAL rule 30 log disable\n    set firewall name WAN_LOCAL rule 30 protocol udp\n\n    set firewall name WAN_LOCAL rule 40 action accept\n    set firewall name WAN_LOCAL rule 40 description esp\n    set firewall name WAN_LOCAL rule 40 log disable\n    set firewall name WAN_LOCAL rule 40 protocol esp\n\n    set firewall name WAN_LOCAL rule 50 action accept\n    set firewall name WAN_LOCAL rule 50 description nat-t\n    set firewall name WAN_LOCAL rule 50 destination port 4500\n    set firewall name WAN_LOCAL rule 50 log disable\n    set firewall name WAN_LOCAL rule 50 protocol udp\n\n    set firewall name WAN_LOCAL rule 60 action accept\n    set firewall name WAN_LOCAL rule 60 description l2tp\n    set firewall name WAN_LOCAL rule 60 destination port 1701\n    set firewall name WAN_LOCAL rule 60 ipsec match-ipsec\n    set firewall name WAN_LOCAL rule 60 log disable\n    set firewall name WAN_LOCAL rule 60 protocol udp\n</code></pre>"},{"location":"ubnt/#ipsec","title":"\u57fa\u672c\u7684\u306a IPsec \u306e\u8a2d\u5b9a","text":"<pre><code>  set vpn ipsec ipsec-interfaces interface pppoe0\n  set vpn ipsec nat-networks allowed-network 0.0.0.0/0\n  set vpn ipsec nat-traversal enable\n</code></pre>"},{"location":"ubnt/#wan-ip-pppoe0","title":"WAN \u5074 IP \u30a2\u30c9\u30ec\u30b9\u304c pppoe0 \u7d4c\u7531\u3067\u5272\u308a\u5f53\u3066\u306e\u5834\u5408\u3053\u308c\u3092\u6307\u5b9a","text":"<pre><code>  set vpn l2tp remote-access outside-address 0.0.0.0\n</code></pre>"},{"location":"ubnt/#l2tp-ip","title":"L2TP \u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304d\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u5272\u308a\u5f53\u3066\u308b IP \u30a2\u30c9\u30ec\u30b9\u306e\u7bc4\u56f2\u3092\u6307\u5b9a","text":"<pre><code>  set vpn l2tp remote-access client-ip-pool start 192.168.1.121\n  set vpn l2tp remote-access client-ip-pool stop 192.168.1.140\n</code></pre>"},{"location":"ubnt/#l2tp","title":"L2TP \u306e\u300c\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u300d\u3092\u8a2d\u5b9a","text":"<ul> <li><code>PASSWORD</code> \u306e\u90e8\u5206\u3092\u4efb\u610f\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u5909\u66f4\u3057\u3066\u5165\u529b</li> </ul> <pre><code>  set vpn l2tp remote-access ipsec-settings authentication mode pre-shared-secret\n  set vpn l2tp remote-access ipsec-settings authentication pre-shared-secret PASSWORD\n  set vpn l2tp remote-access ipsec-settings ike-lifetime 3600\n</code></pre>"},{"location":"ubnt/#l2tp_1","title":"L2TP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u8a8d\u8a3c\u65b9\u6cd5\u3092\u30ed\u30fc\u30ab\u30eb\u306b\u8a2d\u5b9a","text":"<pre><code>  set vpn l2tp remote-access authentication mode local\n</code></pre>"},{"location":"ubnt/#l2tp_2","title":"L2TP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30e6\u30fc\u30b6\u30fc\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a","text":"<ul> <li><code>USER</code> \u3068 <code>PASSWORD</code> \u306e\u90e8\u5206\u3092\u5909\u66f4\u3057\u3066\u5165\u529b</li> </ul> <pre><code>  set vpn l2tp remote-access authentication local-users username USER password PASSWORD\n</code></pre>"},{"location":"ubnt/#l2tp-mtu","title":"L2TP \u306e MTU \u3092\u4fdd\u5b88\u7684\u306b\u8a2d\u5b9a","text":"<pre><code>  set vpn l2tp remote-access mtu 1280\n</code></pre>"},{"location":"ubnt/#l2tp-dns-google-dns","title":"L2TP \u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u4f7f\u3046 DNS \u3092\u30eb\u30fc\u30bf\u30fc\u81ea\u8eab\u3068 Google DNS \u306b\u8a2d\u5b9a","text":"<pre><code>  set vpn l2tp remote-access dns-servers server-1 192.168.1.1\n  set vpn l2tp remote-access dns-servers server-2 8.8.8.8\n</code></pre>"},{"location":"ubnt/#dns-l2tp-dns-frowarding","title":"\u30eb\u30fc\u30bf\u30fc\u306e DNS \u304c L2TP \u304b\u3089\u4f7f\u3048\u308b\u3088\u3046 DNS Frowarding \u3092\u30eb\u30fc\u30bf\u30fc\u81ea\u8eab\u306b\u8a2d\u5b9a","text":"<pre><code>   set service dns forwarding listen-on lo\n</code></pre>"},{"location":"ubnt/#_1","title":"\u8a2d\u5b9a\u4fdd\u5b58","text":"<pre><code>  commit\n  save\n</code></pre>"},{"location":"ubnt/#my-mac","title":"\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u3068\u306e\u7af6\u5408\u5bfe\u7b56","text":"<pre><code>UDP \u30dd\u30fc\u30c8 4500\u306f\u3001\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u3067\u3082\u4f7f\u7528\u3057\u3066\u3044\u308b\u305f\u3081\u3001\nMac\u5074\u3067\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3001L2TP/IPSec\u3068\u7af6\u5408\u3057\u3066\u30a2\u30af\u30bb\u30b9\u4e0d\u80fd\u306b\u9665\u308a\u307e\u3059\u3002\n\u3000\u30fb\u3000\u56de\u907f\u65b9\u6cd5\n\u3000\u3000\u305d\u306e1\uff09 \u30ed\u30fc\u30ab\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306b\u3042\u308b\u3059\u3079\u3066\u306eMac\u3067\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u3092\u7121\u52b9\u306b\u3059\u308b\n\u3000\u3000\u305d\u306e2\uff09 Edgerouter\u306eUPnP2\u3092\u7121\u52b9\u306b\u3059\u308b\u3000\u203b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u7684\u306b\u306fUPnP\u3092\u7121\u52b9\u306b\u3059\u308b\u306e\u304c\u5409\n\u3000\u3000\u305d\u306e3\uff09 UPnP\u304c\u5fc5\u8981\u306a\u5834\u5408\u3001UPnP2\u3067UDP \u30dd\u30fc\u30c8 4500\u3067\u306e\u8ee2\u9001\u3092\u6b62\u3081\u308b\n</code></pre>"},{"location":"ubnt/#3","title":"\u305d\u306e3\uff09\u3092\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u3059\u308b\u5834\u5408","text":""},{"location":"ubnt/#_2","title":"\u5bfe\u7b56 \u8a2d\u5b9a\u30e2\u30fc\u30c9\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u8a2d\u5b9a","text":"<pre><code>  configure\n  set service upnp2 acl rule 10 action deny\n  set service upnp2 acl rule 10 description \"Block Port 4500\"\n  set service upnp2 acl rule 10 external-port 4500\n  set service upnp2 acl rule 10 local-port 4500\n  set service upnp2 acl rule 10 subnet 192.168.1.0/24\n  set service upnp2 listen-on pppoe0\n  set service upnp2 wan pppoe0\n</code></pre>"},{"location":"ubnt/#_3","title":"\u8a2d\u5b9a\u3092\u53cd\u6620\u3057\u3066\u4fdd\u5b58\u3001\u8a2d\u5b9a\u30e2\u30fc\u30c9\u7d42\u4e86","text":"<pre><code>  commit\n  save\n  exit\n</code></pre>"},{"location":"ubnt/#_4","title":"\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8","text":"<pre><code>  root@ubnt:/home/ubnt# df -h\n  Filesystem                Size      Used Available Use% Mounted on\n  ubi0_0                  214.9M    155.8M     54.4M  74% /root.dev\n  aufs                    214.9M    155.8M     54.4M  74% /\n  devtmpfs                124.3M         0    124.3M   0% /dev\n  tmpfs                   124.4M    220.0K    124.2M   0% /run\n  tmpfs                   124.4M    220.0K    124.2M   0% /run\n  tmpfs                   124.4M     18.7M    105.8M  15% /var/log\n  tmpfs                   124.4M     12.0K    124.4M   0% /tmp\n  none                    124.4M    756.0K    123.7M   1% /opt/vyatta/config\n  root@ubnt:/home/ubnt# \n\n  root@ubnt:/home/ubnt# show system image\n  The system currently has the following image(s) installed:\n\n  v1.10.5.5098943.180622.1555    (running image) (default boot)\n  v1.9.0.4901118.160804.1131\n\n  root@ubnt:/home/ubnt# show system image storage\n  Image name                        Read-Only   Read-Write        Total\n  ------------------------------ ------------ ------------ ------------\n  v1.10.5.5098943.180622.1555           77760          940        78700\n  v1.9.0.4901118.160804.1131            76760        14152        90912\n  root@ubnt:/home/ubnt# delete system image\n  Possible completions:\n    &lt;Enter&gt;       Execute the current command\n\n\n  root@ubnt:/home/ubnt# delete system image\n  The system currently has the following image(s) installed:\n\n  v1.10.5.5098943.180622.1555    (running image) (default boot)\n  v1.9.0.4901118.160804.1131\n\n  You are about to delete image [v1.9.0.4901118.160804.1131]\n  Are you sure you want to delete ? (Yes/No) [Yes]: Yes\n  Removing old image... Done\n  root@ubnt:/home/ubnt#\n  root@ubnt:/home/ubnt# df -h\n  Filesystem                Size      Used Available Use% Mounted on\n  ubi0_0                  214.9M     74.1M    136.1M  35% /root.dev\n  aufs                    214.9M     74.1M    136.1M  35% /\n  devtmpfs                124.3M         0    124.3M   0% /dev\n  tmpfs                   124.4M    220.0K    124.2M   0% /run\n  tmpfs                   124.4M    220.0K    124.2M   0% /run\n  tmpfs                   124.4M     18.7M    105.7M  15% /var/log\n  tmpfs                   124.4M     12.0K    124.4M   0% /tmp\n  none                    124.4M    756.0K    123.7M   1% /opt/vyatta/config\n  root@ubnt:/home/ubnt# \n\n  root@ubnt:/home/ubnt# ls\n  ER-e50.v1.10.7.5127989.tar\n  root@ubnt:/home/ubnt# add system image ^C\n  root@ubnt:/home/ubnt# show version\n  Version:      v1.10.5\n  Build ID:     5098943\n  Build on:     06/22/18 15:55\n  Copyright:    2012-2018 Ubiquiti Networks, Inc.\n  HW model:     EdgeRouter X 5-Port\n  HW S/N:       F09FC2087E8A\n  Uptime:       12:45:43 up 85 days, 13:33,  1 user,  load average: 1.26, 1.24, 1.19\n  root@ubnt:/home/ubnt# add system image  ER-e50.v1.10.7.5127989.tar\n  Checking upgrade image...Done\n  Preparing to upgrade...Done\n  Clearing directory /var/cache/apt (356.0K)...Done\n  Copying upgrade image...Not enough disk space for root file system\n  Do you want to delete old version first? (Yes/No) [Yes]: Yes\n  Removing old image...Done\n  Still not enough disk space for root file system\n  Canceling upgrade\n  /home/ubnt\n  root@ubnt:/home/ubnt#\n  root@ubnt:/home/ubnt# df -h\n  Filesystem                Size      Used Available Use% Mounted on\n  ubi0_0                  214.9M    149.9M     60.3M  71% /root.dev\n  aufs                    214.9M    149.9M     60.3M  71% /\n  devtmpfs                124.3M         0    124.3M   0% /dev\n  tmpfs                   124.4M    220.0K    124.2M   0% /run\n  tmpfs                   124.4M    220.0K    124.2M   0% /run\n  tmpfs                   124.4M     18.7M    105.7M  15% /var/log\n  tmpfs                   124.4M     12.0K    124.4M   0% /tmp\n  none                    124.4M    756.0K    123.7M   1% /opt/vyatta/config\n  root@ubnt:/home/ubnt# ls -lath ER-e50.v1.10.7.5127989.tar\n  -rw-r--r--    1 ubnt     users      78.3M Nov  1 12:44 ER-e50.v1.10.7.5127989.tar\n  root@ubnt:/home/ubnt#\n\n\n  root@ubnt:/home/ubnt# add system image https://dl.ubnt.com/firmwares/edgemax/v1.10.x/ER-e50.v1.10.7.5127989.tar\n  Trying to get upgrade file from https://dl.ubnt.com/firmwares/edgemax/v1.10.x/ER-e50.v1.10.7.5127989.tar\n    % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                   Dload  Upload   Total   Spent    Left  Speed\n  100 78.3M  100 78.3M    0     0  3586k      0  0:00:22  0:00:22 --:--:-- 4926k\n  Download succeeded\n  Checking upgrade image...Done\n  Preparing to upgrade...Done\n  Clearing directory /var/cache/apt (356.0K)...Done\n  Copying upgrade image...Done\n  Removing old image...Done\n  Checking upgrade image...Done\n  Copying config data...Done\n  Finishing upgrade...Done\n  Upgrade completed\n  root@ubnt:/home/ubnt#\n\n\n  root@ubnt:/home/ubnt# show system image\n  The system currently has the following image(s) installed:\n\n  v1.10.7.5127989.181001.1227    (default boot)\n  v1.10.5.5098943.180622.1555    (running image)\n\n  A reboot is needed to boot default image\n  root@ubnt:/home/ubnt# show system image storage\n  Image name                        Read-Only   Read-Write        Total\n  ------------------------------ ------------ ------------ ------------\n  v1.10.7.5127989.181001.1227           78500           88        78588\n  v1.10.5.5098943.180622.1555           77760          588        78348\n  root@ubnt:/home/ubnt#\n\n  root@ubnt:/home/ubnt# show system image\n  The system currently has the following image(s) installed:\n\n  v1.10.7.5127989.181001.1227    (default boot)\n  v1.10.5.5098943.180622.1555    (running image)\n\n  A reboot is needed to boot default image\n  root@ubnt:/home/ubnt# set system image default-boot\n  The system currently has the following image(s) installed:\n\n  v1.10.7.5127989.181001.1227    (default boot)\n  v1.10.5.5098943.180622.1555    (running image)\n\n  A reboot is needed to boot default image\n  Are you sure you want to switch images? (Yes/No) [Yes]:\n  Moving images...\n  Done\n  Switched from\n    Version:      v1.10.7.5127989.181001.1227\n  to\n    Version:      v1.10.5.5098943.180622.1555\n  root@ubnt:/home/ubnt#\n  root@ubnt:/home/ubnt# show system image\n  The system currently has the following image(s) installed:\n\n  v1.10.5.5098943.180622.1555    (running image) (default boot)\n  v1.10.7.5127989.181001.1227\n\n  root@ubnt:/home/ubnt# set system image default-boot\n  The system currently has the following image(s) installed:\n\n  v1.10.5.5098943.180622.1555    (running image) (default boot)\n  v1.10.7.5127989.181001.1227\n\n  Are you sure you want to switch images? (Yes/No) [Yes]:\n  Moving images...\n  Done\n  Switched from\n    Version:      v1.10.5.5098943.180622.1555\n  to\n    Version:      v1.10.7.5127989.181001.1227\n  root@ubnt:/home/ubnt# show system image\n  The system currently has the following image(s) installed:\n\n  v1.10.7.5127989.181001.1227    (default boot)\n  v1.10.5.5098943.180622.1555    (running image)\n\n  A reboot is needed to boot default image\n  root@ubnt:/home/ubnt#\n  root@ubnt:/home/ubnt# reboot\n</code></pre>"},{"location":"vim/","title":"VIM","text":""},{"location":"vim/#build-vim","title":"build vim\u76ee\u6b21","text":"<pre><code>$ ./configure --prefix=$HOME/myetc \\\n--with-features=huge \\\n--enable-gui=gnome2 \\\n--enable-perlinterp \\\n--enable-pythoninterp \\\n--enable-python3interp \\\n--enable-fail-if-missing \\\n--disable-selinux \\\n--enable-pythoninterp=dynamic \\\n--with-python-config-dir=/home/user/.pyenv/versions/2.7.14/lib/python2.7/config \\\n--enable-python3interp=dynamic \\\n--with-python3-config-dir=/home/user/.pyenv/versions/3.6.5/lib/python3.6/config-3.6m \\\n--enable-rubyinterp=dynamic \\\n--enable-cscope \\\n--enable-fontset \\\n--enable-multibyte \\\nvi_cv_path_python3=/home/uers/.pyenv/versions/3.6.5/bin/python3.6\n\nmake\nmake install\nvim ~/.zshrc\nalias vi='~/myetc/bin/vim'\nalias vim='~/myetc/bin/vim'\n\n\n</code></pre> \u30ad\u30fc\u5165\u529b \u52d5\u4f5c vi \u30d5\u30a1\u30a4\u30eb\u540d \u5bfe\u8c61\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\uff08\u8907\u6570\u30d5\u30a1\u30a4\u30eb\u53ef\uff09 vi +n \u30d5\u30a1\u30a4\u30eb\u540d n \u884c\u76ee\u304b\u3089\u5bfe\u8c61\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f vi -r \u30d5\u30a1\u30a4\u30eb\u540d \u58ca\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30ab\u30d0\u30ea i \u30ab\u30fc\u30bd\u30eb\u306e\u5de6\u304b\u3089\u5165\u529b\u958b\u59cb I \u884c\u982d\u304b\u3089\u5165\u529b\u958b\u59cb a \u30ab\u30fc\u30bd\u30eb\u306e\u53f3\u304b\u3089\u5165\u529b\u958b\u59cb A \u884c\u672b\u304b\u3089\u5165\u529b\u958b\u59cb ZZ vi \u3092\u7d42\u4e86\uff08\u5185\u5bb9\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u4fdd\u5b58\uff09 :wq \u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\u3001vi \u3092\u7d42\u4e86 :#,# w #\u884c\u76ee\u304b\u3089#\u884c\u76ee\u307e\u3067\u3092\u4fdd\u5b58 :q vi \u3092\u7d42\u4e86\uff08\u5185\u5bb9\u304c\u5909\u66f4\u3055\u308c\u3044\u308b\u5834\u5408\u306f\u8b66\u544a\uff09 :q! vi \u3092\u5f37\u5236\u7d42\u4e86\uff08\u5185\u5bb9\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u3066\u3082\u4fdd\u5b58\u3057\u306a\u3044\uff09 :ls \u30d0\u30c3\u30d5\u30a1\u30ea\u30b9\u30c8\u306e\u8868\u793a :b \u30d0\u30c3\u30d5\u30a1 \u30d0\u30c3\u30d5\u30a1\u3092\u8868\u793a :bn \u6b21\u306e\u30d0\u30c3\u30d5\u30a1\u3092\u8868\u793a :bp \u524d\u306e\u30d0\u30c3\u30d5\u30a1\u3092\u8868\u793a [n] x \u30ab\u30fc\u30bd\u30eb\u4e0a\u306e1\u6587\u5b57\u524a\u9664 [n] X \u30ab\u30fc\u30bd\u30eb\u306e\u5de6\u306e\u6587\u5b57\u30921\u6587\u5b57\u524a\u9664 p \u30d0\u30c3\u30d5\u30a1\u5185\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u633f\u5165\uff08\u6587\u5b57\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u53f3\u3001\u884c\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u4e0b\u306b\u633f\u5165\uff09 P \u30d0\u30c3\u30d5\u30a1\u5185\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u633f\u5165\uff08\u6587\u5b57\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u5de6\u3001\u884c\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u4e0a\u306b\u633f\u5165\uff09 :r [\u30d5\u30a1\u30a4\u30eb\u540d] \u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u3092\u633f\u5165\u3059\u308b [n] d  \u76ee\u7684\u8a9e \\ d [n] \u76ee\u7684\u8a9e \u76ee\u7684\u8a9e\u4e00\u89a7: ::: w - \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u7a7a\u767d\u3092\u542b\u3080\u5358\u8a9e\u306e\u672b\u5c3e\u307e\u3067\u524a\u9664 ::: e - \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u7a7a\u767d\u3092\u542b\u307e\u306a\u3044\u5358\u8a9e\u306e\u672b\u5c3e\u307e\u3067\u524a\u9664 ::: $ - \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u884c\u672b\u307e\u3067\u524a\u9664 ::: d - 1\u884c\u524a\u9664\u5207\u308a\u53d6\u308a\uff08\u30ab\u30c3\u30c8\uff09 /&lt;\u6587\u5b57\u5217&gt; \u6587\u5b57\u5217 \u3092\u691c\u7d22\u3059\u308b\uff08\u9806\u65b9\u5411\uff09 ?&lt;\u6587\u5b57\u5217&gt; \u6587\u5b57\u5217\u3092\u691c\u7d22\u3059\u308b\uff08\u9006\u65b9\u5411\uff09 n \u9806\u65b9\u5411\u3078\u691c\u7d22\u3059\u308b N \u9006\u65b9\u5411\u3078\u691c\u7d22\u3059\u308b % (,[\u306b\u5bfe\u3057\u3066\u5bfe\u5fdc\u3059\u308b ),] \u3084 } \u3092\u691c\u7d22 r \u30ab\u30fc\u30bd\u30eb\u306e\u4e0b\u306e\u6587\u5b57\u3092\u7f6e\u304d\u63db\u3048\u308b [n] c \u76ee\u7684\u8a9e \\ c [n] \u76ee\u7684\u8a9e \u76ee\u7684\u8a9e\u4e00\u89a7: ::: w - \u5358\u8a9e\u306e\u4e00\u90e8\u3092\u5909\u66f4\u3059\u308b ::: $ - \u884c\u306e\u4e00\u90e8\u3092\u5909\u66f4\u3059\u308b :s/[old]/[new] [old]\u3092[new]\u306b\u7f6e\u63db\u3059\u308b ::: \u73fe\u5728\u884c\u306e\u6700\u521d\u306e old \u3092 new \u306b\u7f6e\u63db\u3059\u308b :s/old/new ::: \u73fe\u5728\u884c\u306e\u5168\u3066\u306e old \u3092 new \u306b\u7f6e\u63db\u3059\u308b :s/old/new/g ::: 2\u3064\u306e # \u9593\u3067\u8a9e\u53e5\u3092\u7f6e\u63db\u3059\u308b :#,#s/old/new/g ::: \u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u306e\u5168\u3066\u306e\u691c\u7d22\u8a9e\u53e5\u3092\u7f6e\u63db\u3059\u308b: :%s/old/new/g ::: 'c' \u3092\u52a0\u3048\u308b\u3068\u7f6e\u63db\u306e\u5ea6\u306b\u78ba\u8a8d\u3092\u6c42\u3081\u308b :%s/old/new/gc CTRL-g \u30d5\u30a1\u30a4\u30eb\u5185\u3067\u306e\u4f4d\u7f6e\u3068\u30d5\u30a1\u30a4\u30eb\u306e\u72b6\u614b\u3092\u8868\u793a [n] Shift-g \u30d5\u30a1\u30a4\u30eb\u5185\u306en\u884c\u306b\u79fb\u52d5\uff08n\u304c\u7121\u3051\u308c\u3070\u30d5\u30a1\u30a4\u30eb\u672b\u306b\u79fb\u52d5\uff09 :sp [\u30d5\u30a1\u30a4\u30eb] \u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u6a2a\u306b\u5206\u5272 :vs [\u30d5\u30a1\u30a4\u30eb] \u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u7e26\u306b\u5206\u5272 : q , :only \u30ab\u30fc\u30bd\u30eb\u306e\u3042\u308b\u30a6\u30a3\u30f3\u30c9\u30a6\u4ee5\u5916\u3092\u5168\u90e8\u9589\u3058\u308b :new \u7a7a\u306e\u6a2a\u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u958b\u304f :vnew \u7a7a\u306e\u7e26\u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u958b\u304f Ctrl-w w \u6b21\u306e\u30a6\u30a4\u30f3\u30c9\u30a6\u306b\u79fb\u52d5 Ctrl-w p \u524d\u306e\u30a6\u30a4\u30f3\u30c9\u30a6\u306b\u79fb\u52d5 Ctrl-w o \u73fe\u5728\u306e\u30a6\u30a4\u30f3\u30c9\u30a6\u4ee5\u5916\u3092\u9589\u3058\u308b u \u76f4\u524d\u306e\u64cd\u4f5c\u3092\u53d6\u308a\u3084\u3081\u308b U \u884c\u5168\u4f53\u306e\u64cd\u4f5c\u3092\u53d6\u308a\u3084\u3081\u308b Ctrl-R \u53d6\u308a\u6d88\u3057\u306e\u53d6\u308a\u6d88\u3057 . \u76f4\u524d\u306e\u64cd\u4f5c\u306e\u7e70\u308a\u8fd4\u3057 :! [\u5916\u90e8\u30b3\u30de\u30f3\u30c9] \u5916\u90e8\u30b7\u30a7\u30eb\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c U \u884c\u5168\u4f53\u306e\u64cd\u4f5c\u3092\u53d6\u308a\u3084\u3081\u308b :set number\u3001 :set nu \u884c\u756a\u53f7\u3092\u8868\u793a :set no number\u3001 :set nonu \u884c\u756a\u53f7\u306e\u8868\u793a\u3092\u3084\u3081\u308b :set showmode \u73fe\u5728\u306e\u30e2\u30fc\u30c9\u3092\u8868\u793a :set showmatch () \u3084 {} \u306e\u5bfe\u5fdc\u3092\u5831\u544a :set ignorecase \u5927\u6587\u5b57/\u5c0f\u6587\u5b57\u306e\u533a\u5225\u306a\u304f\u691c\u7d22 :set autoindent \u81ea\u52d5\u30a4\u30f3\u30c7\u30f3\u30c8\u30e2\u30fc\u30c9 :set noautoindent \u81ea\u52d5\u30a4\u30f3\u30c7\u30f3\u30c8\u30e2\u30fc\u30c9\u3092\u3084\u3081\u308b :set all \u3059\u3079\u3066\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8868\u793a :e [\u30d5\u30a1\u30a4\u30eb] \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f :syntax on \u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u30cf\u30a4\u30e9\u30a4\u30c8\u8868\u793a\u3059\u308b :vert diffsplit [\u30d5\u30a1\u30a4\u30eb] \u4eca\u306e\u30d5\u30a1\u30a4\u30eb\u3068\u3001\u4ed6\u306e\u30d5\u30a1\u30a4\u30eb\u3068\u306e\u5dee\u5206\u3092\u53d6\u308b\u30b3\u30de\u30f3\u30c9 :Tutorial 30\u5206\u7a0b\u5ea6\u306eVi\u5229\u7528\u65b9\u6cd5\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb <p> Vim\u306e\u4f7f\u3044\u65b9 \u57fa\u672c\u64cd\u4f5c\u307e\u3068\u3081 <p>Vim\u306e\u4f7f\u3044\u65b9, \u7279\u306b\u81ea\u5206\u304c\u3088\u304f\u4f7f\u3046\u57fa\u672c\u64cd\u4f5c\u3092\u307e\u3068\u3081\u3066\u307f\u307e\u3057\u305f.</p> <ul> <li>\u7de8\u96c6, \u4fdd\u5b58, \u7d42\u4e86</li> <li>\u79fb\u52d5\u7cfb</li> <li>\u30e2\u30fc\u30c9\u5909\u66f4</li> <li>\u524a\u9664, \u30b3\u30d4\u30fc</li> <li>\u691c\u7d22</li> <li>Undo, Redo, \u7e70\u308a\u8fd4\u3057</li> <li>\u30a4\u30f3\u30c7\u30f3\u30c8</li> <li>\u7f6e\u63db</li> <li>\u30a6\u30a3\u30f3\u30c9\u30a6\u64cd\u4f5c</li> <li>\u30bf\u30d6</li> <li>\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8, \u30c7\u30af\u30ea\u30e1\u30f3\u30c8</li> <li>\u6ce8\u610f</li> </ul> <p></p>"},{"location":"vim/#edit","title":"\u7de8\u96c6, \u4fdd\u5b58, \u7d42\u4e86","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c :e [file] file\u3092\u958b\u304f :e. \u30a8\u30af\u30b9\u30d7\u30ed\u30fc\u30e9\u30fc\u3092\u958b\u304f :w \u4fdd\u5b58 :q \u7d42\u4e86 :q! \u4fdd\u5b58\u305b\u305a\u7d42\u4e86 ZZ \u4fdd\u5b58\u3057\u3066\u7d42\u4e86 ZQ \u4fdd\u5b58\u305b\u305a\u306b\u7d42\u4e86"},{"location":"vim/#move","title":"\u79fb\u52d5\u7cfb","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c h, j, k, l \u5de6, \u4e0b, \u4e0a, \u53f3 gj, gk \u4e0b, \u4e0a\u306b1\u884c\u79fb\u52d5. (\u30a8\u30c7\u30a3\u30bf\u3067\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u884c\u4e0a\u3067\u79fb\u52d5, \u3064\u307e\u308a, \u30a8\u30c7\u30a3\u30bf\u306e\u6a2a\u5e45\u306e\u5236\u7d04\u306b\u3088\u3063\u3066\u884c\u304c\u6298\u308a\u8fd4\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3067\u3082, \u79fb\u52d5\u53ef\u80fd) w 1\u5358\u8a9e\u5206\u9032\u3080 W 1\u5358\u8a9e\u5206\u9032\u3080(\u8a18\u53f7\u3067\u306f\u533a\u5207\u3089\u308c\u306a\u3044\u306e\u3067, \u6b21\u306e\u30b9\u30da\u30fc\u30b9\u3084, \u6539\u884c\u6587\u5b57\u307e\u3067\u98db\u3076) b 1\u5358\u8a9e\u5206\u623b\u308b B 1\u5358\u8a9e\u5206\u623b\u308b(\u8a18\u53f7\u3067\u306f\u533a\u5207\u3089\u308c\u306a\u3044\u306e\u3067, \u524d\u306e\u30b9\u30da\u30fc\u30b9\u3084, \u6539\u884c\u6587\u5b57\u307e\u3067\u98db\u3076) f[\u6587\u5b57] \u6b21\u306e[\u6587\u5b57]\u307e\u3067\u98db\u3076 F[\u6587\u5b57] \u524d\u306e[\u6587\u5b57]\u307e\u3067\u98db\u3076 t[\u6587\u5b57] \u6b21\u306e[\u6587\u5b57]\u306e\u624b\u524d\u307e\u3067\u98db\u3076 T[\u6587\u5b57] \u524d\u306e[\u6587\u5b57]\u306e\u6b21\u307e\u3067\u98db\u3076 ; f, F, t, T\u3067\u691c\u7d22\u3057\u305f\u6587\u5b57\u3092\u540c\u65b9\u5411\u306b\u7e70\u308a\u8fd4\u3057\u691c\u7d22\u3059\u308b , f, F, t, T\u3067\u691c\u7d22\u3057\u305f\u6587\u5b57\u3092\u9006\u65b9\u5411\u306b\u7e70\u308a\u8fd4\u3057\u691c\u7d22\u3059\u308b g; \u76f4\u524d\u306b\u5909\u66f4\u3057\u305f\u4f4d\u7f6e\u306b\u30ab\u30fc\u30bd\u30eb\u3092\u79fb\u52d5(\u7e70\u308a\u8fd4\u3057\u5165\u529b\u3059\u308b\u3053\u3068\u3067, \u5909\u66f4\u30ea\u30b9\u30c8\u3092\u9061\u308b) g, g#\u3092\u4f7f\u7528\u3057\u3066\u9061\u3063\u305f\u5909\u66f4\u30ea\u30b9\u30c8\u3092\u9006\u9806\u306b\u9032\u3081, \u30ab\u30fc\u30bd\u30eb\u3092\u79fb\u52d5\u3059\u308b. gg \u30d5\u30a1\u30a4\u30eb\u306e\u5148\u982d\u306b\u79fb\u52d5 G \u30d5\u30a1\u30a4\u30eb\u306e\u6700\u5f8c\u306b\u79fb\u52d5 [\u6570\u5024]gg, [\u6570\u5024]G, :[\u6570\u5024] [\u6570\u5024]\u884c\u306b\u79fb\u52d5 H, M, L \u753b\u9762\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u884c\u306b\u3064\u3044\u3066, \u6700\u521d\u306e\u884c(H), \u771f\u3093\u4e2d\u306e\u884c(M), \u6700\u5f8c\u306e\u884c(L)\u306b\u79fb\u52d5 0 \u884c\u306e\u5148\u982d\u306b\u79fb\u52d5 ^ \u884c\u306e\u30c6\u30ad\u30b9\u30c8\u90e8\u5206\u306e\u5148\u982d\u306b\u79fb\u52d5 $ \u884c\u306e\u6700\u5f8c\u306b\u79fb\u52d5 % \u5bfe\u5fdc\u3059\u308b\u62ec\u5f27\u306b\u79fb\u52d5 ( \u6587\u5358\u4f4d\u3067\u306e\u79fb\u52d5. \u524d\u306e\u6587\u306e\u5148\u982d\u306b\u79fb\u52d5 ) \u6587\u5358\u4f4d\u3067\u306e\u79fb\u52d5. \u5f8c\u308d\u306e\u6587\u306e\u5148\u982d\u306b\u79fb\u52d5 { \u6bb5\u843d\u5358\u4f4d\u3067\u306e\u79fb\u52d5. \u524d\u306e\u6bb5\u843d\u306e\u5148\u982d\u306b\u79fb\u52d5 } \u6bb5\u843d\u5358\u4f4d\u3067\u306e\u79fb\u52d5. \u5f8c\u308d\u306e\u6bb5\u843d\u306e\u5148\u982d\u306b\u79fb\u52d5 Ctrl-u \u534a\u753b\u9762\u5206\u623b\u308b Ctrl-d \u534a\u753b\u9762\u5206\u9032\u3080 Ctrl-b 1\u753b\u9762\u5206\u623b\u308b Ctrl-f 1\u753b\u9762\u5206\u9032\u3080 Ctrl-o \u30b8\u30e3\u30f3\u30d7\u30ea\u30b9\u30c8\u3092\u9061\u3063\u3066\u30ab\u30fc\u30bd\u30eb\u3092\u79fb\u52d5\u3059\u308b(\u691c\u7d22\u3084\u884c\u6570\u6307\u5b9a\u79fb\u52d5\u306a\u3069\u304c\u30b8\u30e3\u30f3\u30d7\u30ea\u30b9\u30c8\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b) Ctrl-i \u30b8\u30e3\u30f3\u30d7\u30ea\u30b9\u30c8\u3092\u9032\u3081\u3066\u30ab\u30fc\u30bd\u30eb\u3092\u79fb\u52d5\u3059\u308b(\u691c\u7d22\u3084\u884c\u6570\u6307\u5b9a\u79fb\u52d5\u306a\u3069\u304c\u30b8\u30e3\u30f3\u30d7\u30ea\u30b9\u30c8\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b)"},{"location":"vim/#mode","title":"\u30e2\u30fc\u30c9\u5909\u66f4","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c esc \u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u308b Ctrl-[ \u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u308b i \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b a \u30ab\u30fc\u30bd\u30eb\u306e\u76f4\u5f8c\u304b\u3089\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b I \u884c\u982d\u304b\u3089\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b A \u884c\u672b\u304b\u3089\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b Ctrl-o(\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u4e2d\u306b) \u30a4\u30f3\u30b5\u30fc\u30c8\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u5165\u308b(\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u4e2d\u306b1\u30b3\u30de\u30f3\u30c9\u306e\u307f\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3067\u304d\u308b) v \u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u306b\u5165\u308b V \u884c\u5358\u4f4d\u306e\u9078\u629e\u3092\u3059\u308b\u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u306b\u5165\u308b Ctrl-v \u77e9\u5f62\u9078\u629e\u3092\u3059\u308b\u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u306b\u5165\u308b gv \u524d\u56de\u9078\u629e\u3057\u305f\u7bc4\u56f2\u304c\u518d\u9078\u629e\u3055\u308c\u305f\u72b6\u614b\u3067\u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u306b\u5165\u308b : \u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30e2\u30fc\u30c9\u306b\u5165\u308b(\u7d9a\u3051\u3066\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3061, Enter\u3067\u5b9f\u884c) <p>\u77e9\u5f62\u9078\u629e\u306e\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\u306f, \uff62\u77e9\u5f62\u9078\u629e\u30e2\u30fc\u30c9\u306e\u4f7f\u3044\u65b9\uff63\u3067\u3082\u89e3\u8aac\u3057\u3066\u3044\u307e\u3059\u306e\u3067, \u3088\u308d\u3057\u3051\u308c\u3070\u53c2\u8003\u306b\u306a\u3055\u3063\u3066\u304f\u3060\u3055\u3044.</p>"},{"location":"vim/#del","title":"\u524a\u9664, \u30b3\u30d4\u30fc","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c x \u30ab\u30fc\u30bd\u30eb\u4e0a\u306e\u6587\u5b57\u3092\u6d88\u3059 s \u30ab\u30fc\u30bd\u30eb\u4e0a\u306e\u6587\u5b57\u3092\u6d88\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b dd \u30ab\u30fc\u30bd\u30eb\u304c\u3042\u308b\u884c\u3092\u6d88\u3059 dw \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u30891\u5358\u8a9e\u5206\u524a\u9664\u3059\u308b diw \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306b\u3042\u308b\u5358\u8a9e\u30921\u3064\u524a\u9664\u3059\u308b dt( \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089, \u6b21\u306b\u6700\u521d\u306b\u51fa\u73fe\u3059\u308b(\u307e\u3067\u3092\u524a\u9664\u3059\u308b cc \u30ab\u30fc\u30bd\u30eb\u304c\u3042\u308b\u884c\u3092\u6d88\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b cw \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u30891\u5358\u8a9e\u5206\u524a\u9664\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b ciw \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306b\u3042\u308b\u5358\u8a9e\u30921\u3064\u524a\u9664\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b ct( \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089, \u6b21\u306b\u6700\u521d\u306b\u51fa\u73fe\u3059\u308b(\u307e\u3067\u3092\u524a\u9664\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b D \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u884c\u672b\u307e\u3067\u524a\u9664 C \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u884c\u672b\u307e\u3067\u524a\u9664\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b yy \u30ab\u30fc\u30bd\u30eb\u304c\u3042\u308b\u884c\u3092\u30b3\u30d4\u30fc y \u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u3067\u9078\u629e\u3055\u308c\u3066\u3044\u308b\u90e8\u5206\u3092\u30b3\u30d4\u30fc p \u30ab\u30fc\u30bd\u30eb\u884c\u306e\u4e0b\u306e\u884c\u306b\u30da\u30fc\u30b9\u30c8 P \u30ab\u30fc\u30bd\u30eb\u884c\u306e\u4e0a\u306e\u884c\u306b\u30da\u30fc\u30b9\u30c8 Ctrl-r 0(\u30bc\u30ed)(\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u4e2d\u306b) \u30ec\u30b8\u30b9\u30bf0\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u6587\u5b57\u5217\u3092\u8cbc\u308a\u4ed8\u3051\u308b. \u901a\u5e38, y\u3092\u4f7f\u7528\u3057\u3066\u30b3\u30d4\u30fc\u3057\u305f\u6587\u5b57\u5217\u306f, \u30ec\u30b8\u30b9\u30bf0\u306b\u4fdd\u5b58\u3055\u308c\u308b."},{"location":"vim/#search","title":"\u691c\u7d22","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c / \u7d9a\u3051\u3066\u6587\u5b57\u3092\u6253\u3061, Enter\u3067\u6587\u5b57\u5217\u3092\u78ba\u5b9a\u3057, \u5f8c\u65b9\u691c\u7d22\u3092\u304b\u3051\u308b ? \u7d9a\u3051\u3066\u6587\u5b57\u3092\u6253\u3061, Enter\u3067\u6587\u5b57\u5217\u3092\u78ba\u5b9a\u3057, \u524d\u65b9\u691c\u7d22\u3092\u304b\u3051\u308b * \u30ab\u30fc\u30bd\u30eb\u4e0b\u306e\u5358\u8a9e\u3092, \u5f8c\u65b9\u691c\u7d22\u3059\u308b # \u30ab\u30fc\u30bd\u30eb\u4e0b\u306e\u5358\u8a9e\u3092, \u524d\u65b9\u691c\u7d22\u3059\u308b g* \u30ab\u30fc\u30bd\u30eb\u4e0b\u306e\u5358\u8a9e\u3092\u542b\u3080\u6587\u5b57\u5217\u3092, \u5f8c\u65b9\u691c\u7d22\u3059\u308b g# \u30ab\u30fc\u30bd\u30eb\u4e0b\u306e\u5358\u8a9e\u3092\u542b\u3080\u6587\u5b57\u5217\u3092, \u524d\u65b9\u691c\u7d22\u3059\u308b n \u6b21\u306e\u5358\u8a9e\u306b\u79fb\u308b N \u524d\u306e\u5358\u8a9e\u306b\u79fb\u308b"},{"location":"vim/#undo","title":"Undo, Redo, \u7e70\u308a\u8fd4\u3057","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c u Undo Ctrl-r Redo . \u76f4\u524d\u306e\u64cd\u4f5c\u306e\u7e70\u308a\u8fd4\u3057 <p>Vim\u3067\u30b3\u30de\u30f3\u30c9\u3092\u7e70\u308a\u8fd4\u3057\u305f\u3044\u3068\u304d\u306b\u975e\u5e38\u306b\u4fbf\u5229\u306a\u6a5f\u80fd\u3068\u3057\u3066, \u30de\u30af\u30ed\u304c\u3042\u308a\u307e\u3059. \u4efb\u610f\u306e\u30b3\u30de\u30f3\u30c9\u3092\u8a18\u61b6\u3055\u305b\u3066, \u305d\u308c\u3092\u3044\u3064\u3067\u3082\u7e70\u308a\u8fd4\u305b\u308b\u3088\u3046\u306b\u3067\u304d\u308b\u3068\u3044\u3046\u3082\u306e\u3067\u3059. \u4f7f\u3044\u65b9\u3092\uff62Vim\u306e\u30de\u30af\u30ed\u306e\u4f7f\u3044\u65b9\uff63, \u30de\u30af\u30ed\u3092\u4f7f\u3063\u305f\u4fbf\u5229\u64cd\u4f5c\u306e\u4e00\u4f8b\u3092\uff62Vim\u3067\u30de\u30af\u30ed\u3092\u4f7f\u3063\u3066\u9023\u756a\u306e\u6587\u3092\u7c21\u5358\u306b\u5165\u529b\u3059\u308b\u65b9\u6cd5\uff63\u3067\u89e3\u8aac\u3057\u3066\u304a\u308a\u307e\u3059\u306e\u3067, \u3088\u308d\u3057\u3051\u308c\u3070\u53c2\u8003\u306b\u306a\u3055\u3063\u3066\u4e0b\u3055\u3044.</p>"},{"location":"vim/#indent","title":"\u30a4\u30f3\u30c7\u30f3\u30c8","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c = \u30ab\u30fc\u30bd\u30eb\u304c\u3042\u308b\u884c\u3092\u30a4\u30f3\u30c7\u30f3\u30c8. \u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u3067\u7bc4\u56f2\u3092\u9078\u629e\u3057\u3066\u3044\u308c\u3070, \u305d\u306e\u7bc4\u56f2\u3092\u30a4\u30f3\u30c7\u30f3\u30c8 &gt;&gt; \u30a4\u30f3\u30c7\u30f3\u30c8\u3092\u8ffd\u52a0 &lt;&lt; \u30a4\u30f3\u30c7\u30f3\u30c8\u3092\u524a\u9664"},{"location":"vim/#substitution","title":"\u7f6e\u63db","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c r[\u6587\u5b57] \u30ab\u30fc\u30bd\u30eb\u4e0a\u306e\u6587\u5b57\u3092[\u6587\u5b57]\u306b\u7f6e\u63db :%s/before/after/g \u30d5\u30a1\u30a4\u30eb\u4e0a\u306e\u5168\u3066\u306e\"before\"\u3092\"after\"\u306b\u7f6e\u63db :s/before/after/g \u30ab\u30fc\u30bd\u30eb\u306e\u884c\u306e\u5168\u3066\u306e\"before\"\u3092\"after\"\u306b\u7f6e\u63db :10,20s/before/after/g 10~20\u884c\u76ee\u306e\u5168\u3066\u306e\"before\"\u3092\"after\"\u306b\u7f6e\u63db :'&lt;,'&gt;s/before/after/g \u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u3067\u9078\u629e\u4e2d\u306e\u7bc4\u56f2\u306e\u5168\u3066\u306e\"before\"\u3092\"after\"\u306b\u7f6e\u63db. \" '&lt;,'&gt; \"\u306e\u90e8\u5206\u306f, \u7bc4\u56f2\u3092\u9078\u629e\u4e2d\u306b\":\"\u3092\u62bc\u3059\u3068\u81ea\u52d5\u7684\u306b\u51fa\u307e\u3059. <p>\u7f6e\u63db\u306b\u3064\u3044\u3066\u306f, \uff62Vim\u306e\u7f6e\u63db\u30b3\u30de\u30f3\u30c9\u306e\u4f7f\u3044\u65b9\uff63\u3067\u3082\u89e3\u8aac\u3057\u3066\u3044\u307e\u3059\u306e\u3067, \u3088\u308d\u3057\u3051\u308c\u3070\u53c2\u8003\u306b\u306a\u3055\u3063\u3066\u304f\u3060\u3055\u3044.</p>"},{"location":"vim/#window","title":"\u30a6\u30a3\u30f3\u30c9\u30a6\u64cd\u4f5c","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c :sp [file] \u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u6a2a\u306b\u5206\u5272\u3057, file\u3092\u958b\u304f(file\u540d\u306f\u306a\u304f\u3066\u3082\u826f\u3044) :vs [file] \u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u7e26\u306b\u5206\u5272\u3057, file\u3092\u958b\u304f(file\u540d\u306f\u306a\u304f\u3066\u3082\u826f\u3044) Ctrl-w s \u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u6a2a\u306b\u5206\u5272\u3059\u308b Ctrl-w v \u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u7e26\u306b\u5206\u5272\u3059\u308b :only \u30ab\u30fc\u30bd\u30eb\u306e\u3042\u308b\u30a6\u30a3\u30f3\u30c9\u30a6\u4ee5\u5916\u9589\u3058\u308b Ctrl-w o \u30ab\u30fc\u30bd\u30eb\u306e\u3042\u308b\u30a6\u30a3\u30f3\u30c9\u30a6\u4ee5\u5916\u9589\u3058\u308b Ctrl-w w \u6b21\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u306b\u79fb\u52d5 Ctrl-w p \u524d\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u306b\u79fb\u52d5 Ctrl-w h, j, k, l \u5de6, \u4e0b, \u4e0a, \u53f3\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u306b\u79fb\u52d5\u3059\u308b Ctrl-w H, J, K, L \u30ab\u30fc\u30bd\u30eb\u304c\u3042\u308b\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u5de6, \u4e0b, \u4e0a, \u53f3\u65b9\u5411\u306b\u79fb\u52d5\u3059\u308b"},{"location":"vim/#tab","title":"\u30bf\u30d6","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c :tabnew [file] \u65b0\u3057\u3044\u30bf\u30d6\u3092\u958b\u304f. \u30d5\u30a1\u30a4\u30eb\u540d\u3092\u5165\u529b\u3057\u305f\u5834\u5408\u306f, \u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f :tabclose \u30bf\u30d6\u3092\u9589\u3058\u308b(:q\u306a\u3069\u3067\u3082\u9589\u3058\u3089\u308c\u307e\u3059) :tabnext \u6b21\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b :tabprevious \u524d\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b :tabfirst 1\u756a\u76ee\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b :tablast \u6700\u5f8c\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b :tabonly \u73fe\u5728\u306e\u30bf\u30d6\u4ee5\u5916\u5168\u3066\u306e\u30bf\u30d6\u3092\u9589\u3058\u308b gt \u6b21\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b. gt\u306e\u76f4\u524d\u306b\u6570\u5b57\u3092\u3064\u3051\u308b\u3068, \u6570\u5b57\u756a\u76ee\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b gT \u4e00\u3064\u524d\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b"},{"location":"vim/#increment","title":"\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8, \u30c7\u30af\u30ea\u30e1\u30f3\u30c8","text":"\u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c Ctrl-a \u30ab\u30fc\u30bd\u30eb\u884c\u4e0a\u3067, \u30ab\u30fc\u30bd\u30eb\u4ee5\u964d\u306e\u6700\u521d\u306b\u51fa\u73fe\u3057\u305f\u6570\u5b57\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8 Ctrl-x \u30ab\u30fc\u30bd\u30eb\u884c\u4e0a\u3067, \u30ab\u30fc\u30bd\u30eb\u4ee5\u964d\u306e\u6700\u521d\u306b\u51fa\u73fe\u3057\u305f\u6570\u5b57\u3092\u30c7\u30af\u30ea\u30e1\u30f3\u30c8 <p>\u30ab\u30fc\u30bd\u30eb\u4e0b\u306b\u6570\u5b57\u304c\u306a\u304f\u3066\u3082\u4f7f\u7528\u3067\u304d\u308b\u305f\u3081, \u79fb\u52d5\u306b\u3082\u4f7f\u3048\u307e\u3059.</p>"},{"location":"vim/#attention","title":"\u6ce8\u610f","text":"<p>\u4e3b\u306b\u3044\u3064\u3082\u4f7f\u3063\u3066\u3044\u308b\u30b3\u30de\u30f3\u30c9\u3092\u307e\u3068\u3081\u3066\u307f\u307e\u3057\u305f. \u591a\u304f\u306e\u30b3\u30de\u30f3\u30c9\u306f, \u76f4\u524d\u306b\u6570\u5b57\u306a\u3069\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059. \u4f8b\u3048\u3070, 3dd\u3068\u3059\u308c\u30703\u884c\u524a\u9664\u3067\u304d\u307e\u3059. 10i\u3067\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u3063\u3066, \u6587\u5b57\u3092\u5165\u529b\u3057\u305f\u5f8c\u306b\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u3082\u3069\u308c\u306f, \u5165\u529b\u3057\u305f\u6587\u5b57\u304c10\u500b\u5206\u5165\u529b\u3055\u308c\u307e\u3059. \u3042\u3068, \u3053\u3053\u306b\u66f8\u3044\u3066\u3042\u308b\u4ee5\u5916\u306b\u3082\u305f\u304f\u3055\u3093\u30b3\u30de\u30f3\u30c9\u306f\u3042\u308a\u307e\u3059\u306e\u3067, \u3042\u3057\u304b\u3089\u305a.</p>"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/","title":"\u4e00\u884c Python \u4ee3\u7801\u5b9e\u73b0\u5e76\u884c","text":"<ul> <li>\u539f\u6587</li> </ul> <p>Python \u5728\u7a0b\u5e8f\u5e76\u884c\u5316\u65b9\u9762\u591a\u5c11\u6709\u4e9b\u58f0\u540d\u72fc\u85c9\u3002\u6487\u5f00\u6280\u672f\u4e0a\u7684\u95ee\u9898\uff0c\u4f8b\u5982\u7ebf\u7a0b\u7684\u5b9e\u73b0\u548c GIL1\uff0c\u6211\u89c9\u5f97\u9519\u8bef\u7684\u6559\u5b66\u6307\u5bfc\u624d\u662f\u4e3b\u8981\u95ee\u9898\u3002 \u5e38\u89c1\u7684\u7ecf\u5178 Python \u591a\u7ebf\u7a0b\u3001\u591a\u8fdb\u7a0b\u6559\u7a0b\u591a\u663e\u5f97\u504f\u201c\u91cd\u201d\u3002\u800c\u4e14\u5f80\u5f80\u9694\u9774\u6414\u75d2\uff0c\u6ca1\u6709\u6df1\u5165\u63a2\u8ba8\u65e5\u5e38\u5de5\u4f5c\u4e2d\u6700\u6709\u7528\u7684\u5185\u5bb9\u3002</p>"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#_1","title":"\u4f20\u7edf\u7684\u4f8b\u5b50","text":"<p>\u7b80\u5355\u641c\u7d22\u4e0b\u201cPython \u591a\u7ebf\u7a0b\u6559\u7a0b\u201d\uff0c\u4e0d\u96be\u53d1\u73b0\u51e0\u4e4e\u6240\u6709\u7684\u6559\u7a0b\u90fd\u7ed9\u51fa\u6d89\u53ca\u7c7b\u548c\u961f\u5217\u7684\u4f8b\u5b50\uff1a</p> <pre><code>#Example.py\n'''\nStandard Producer/Consumer Threading Pattern\n'''\n\nimport time \nimport threading \nimport Queue \n\nclass Consumer(threading.Thread): \n    def __init__(self, queue): \n        threading.Thread.__init__(self)\n        self._queue = queue \n\n    def run(self):\n        while True: \n            # queue.get() blocks the current thread until \n            # an item is retrieved. \n            msg = self._queue.get() \n            # Checks if the current message is \n            # the \"Poison Pill\"\n            if isinstance(msg, str) and msg == 'quit':\n                # if so, exists the loop\n                break\n            # \"Processes\" (or in our case, prints) the queue item    \n            print \"I'm a thread, and I received %s!!\" % msg\n        # Always be friendly! \n        print 'Bye byes!'\n\n\ndef Producer():\n    # Queue is used to share items between\n    # the threads.\n    queue = Queue.Queue()\n\n    # Create an instance of the worker\n    worker = Consumer(queue)\n    # start calls the internal run() method to \n    # kick off the thread\n    worker.start() \n\n    # variable to keep track of when we started\n    start_time = time.time() \n    # While under 5 seconds.. \n    while time.time() - start_time &lt; 5: \n        # \"Produce\" a piece of work and stick it in \n        # the queue for the Consumer to process\n        queue.put('something at %s' % time.time())\n        # Sleep a bit just to avoid an absurd number of messages\n        time.sleep(1)\n\n    # This the \"poison pill\" method of killing a thread. \n    queue.put('quit')\n    # wait for the thread to close down\n    worker.join()\n\n\nif __name__ == '__main__':\n    Producer()\n</code></pre> <p>\u54c8\uff0c\u770b\u8d77\u6765\u6709\u4e9b\u50cf Java \u4e0d\u662f\u5417\uff1f</p> <p>\u6211\u5e76\u4e0d\u662f\u8bf4\u4f7f\u7528\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6a21\u578b\u5904\u7406\u591a\u7ebf\u7a0b/\u591a\u8fdb\u7a0b\u4efb\u52a1\u662f\u9519\u8bef\u7684\uff08\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e00\u6a21\u578b\u81ea\u6709\u5176\u7528\u6b66\u4e4b\u5730\uff09\u3002\u53ea\u662f\uff0c\u5904\u7406\u65e5\u5e38\u811a\u672c\u4efb\u52a1\u65f6\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u66f4\u6709\u6548\u7387\u7684\u6a21\u578b\u3002</p>"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#_2","title":"\u95ee\u9898\u5728\u4e8e\u2026","text":"<p>\u9996\u5148\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u6837\u677f\u7c7b\uff1b \u5176\u6b21\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u961f\u5217\u6765\u4f20\u9012\u5bf9\u8c61\uff1b \u800c\u4e14\uff0c\u4f60\u8fd8\u9700\u8981\u5728\u901a\u9053\u4e24\u7aef\u90fd\u6784\u5efa\u76f8\u5e94\u7684\u65b9\u6cd5\u6765\u534f\u52a9\u5176\u5de5\u4f5c\uff08\u5982\u679c\u9700\u60f3\u8981\u8fdb\u884c\u53cc\u5411\u901a\u4fe1\u6216\u662f\u4fdd\u5b58\u7ed3\u679c\u8fd8\u9700\u8981\u518d\u5f15\u5165\u4e00\u4e2a\u961f\u5217\uff09\u3002</p>"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#worker","title":"worker \u8d8a\u591a\uff0c\u95ee\u9898\u8d8a\u591a","text":"<p>\u6309\u7167\u8fd9\u4e00\u601d\u8def\uff0c\u4f60\u73b0\u5728\u9700\u8981\u4e00\u4e2a worker \u7ebf\u7a0b\u7684\u7ebf\u7a0b\u6c60\u3002\u4e0b\u9762\u662f\u4e00\u7bc7 IBM \u7ecf\u5178\u6559\u7a0b \u4e2d\u7684\u4f8b\u5b50\u2014\u2014\u5728\u8fdb\u884c\u7f51\u9875\u68c0\u7d22\u65f6\u901a\u8fc7\u591a\u7ebf\u7a0b\u8fdb\u884c\u52a0\u901f\u3002</p> <pre><code>#Example2.py\n'''\nA more realistic thread pool example \n'''\n\nimport time \nimport threading \nimport Queue \nimport urllib2 \n\nclass Consumer(threading.Thread): \n    def __init__(self, queue): \n        threading.Thread.__init__(self)\n        self._queue = queue \n\n    def run(self):\n        while True: \n            content = self._queue.get() \n            if isinstance(content, str) and content == 'quit':\n                break\n            response = urllib2.urlopen(content)\n        print 'Bye byes!'\n\n\ndef Producer():\n    urls = [\n        'http://www.python.org', 'http://www.yahoo.com'\n        'http://www.scala.org', 'http://www.google.com'\n        # etc.. \n    ]\n    queue = Queue.Queue()\n    worker_threads = build_worker_pool(queue, 4)\n    start_time = time.time()\n\n    # Add the urls to process\n    for url in urls: \n        queue.put(url)  \n    # Add the poison pillv\n    for worker in worker_threads:\n        queue.put('quit')\n    for worker in worker_threads:\n        worker.join()\n\n    print 'Done! Time taken: {}'.format(time.time() - start_time)\n\ndef build_worker_pool(queue, size):\n    workers = []\n    for _ in range(size):\n        worker = Consumer(queue)\n        worker.start() \n        workers.append(worker)\n    return workers\n\nif __name__ == '__main__':\n    Producer()\n</code></pre> <p>\u8fd9\u6bb5\u4ee3\u7801\u80fd\u6b63\u786e\u7684\u8fd0\u884c\uff0c\u4f46\u4ed4\u7ec6\u770b\u770b\u6211\u4eec\u9700\u8981\u505a\u4e9b\u4ec0\u4e48\uff1a\u6784\u9020\u4e0d\u540c\u7684\u65b9\u6cd5\u3001\u8ffd\u8e2a\u4e00\u7cfb\u5217\u7684\u7ebf\u7a0b\uff0c\u8fd8\u6709\u4e3a\u4e86\u89e3\u51b3\u607c\u4eba\u7684\u6b7b\u9501\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u884c\u4e00\u7cfb\u5217\u7684 join \u64cd\u4f5c\u3002\u8fd9\u8fd8\u53ea\u662f\u5f00\u59cb\u2026\u2026</p> <p>\u81f3\u6b64\u6211\u4eec\u56de\u987e\u4e86\u7ecf\u5178\u7684\u591a\u7ebf\u7a0b\u6559\u7a0b\uff0c\u591a\u5c11\u6709\u4e9b\u7a7a\u6d1e\u4e0d\u662f\u5417\uff1f\u6837\u677f\u5316\u800c\u4e14\u6613\u51fa\u9519\uff0c\u8fd9\u6837\u4e8b\u500d\u529f\u534a\u7684\u98ce\u683c\u663e\u7136\u4e0d\u90a3\u4e48\u9002\u5408\u65e5\u5e38\u4f7f\u7528\uff0c\u597d\u5728\u6211\u4eec\u8fd8\u6709\u66f4\u597d\u7684\u65b9\u6cd5\u3002</p>"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#map","title":"\u4f55\u4e0d\u8bd5\u8bd5 map","text":"<p>map \u8fd9\u4e00\u5c0f\u5de7\u7cbe\u81f4\u7684\u51fd\u6570\u662f\u7b80\u6377\u5b9e\u73b0 Python \u7a0b\u5e8f\u5e76\u884c\u5316\u7684\u5173\u952e\u3002map \u6e90\u4e8e Lisp \u8fd9\u7c7b\u51fd\u6570\u5f0f\u7f16\u7a0b\u8bed\u8a00\u3002\u5b83\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u5e8f\u5217\u5b9e\u73b0\u4e24\u4e2a\u51fd\u6570\u4e4b\u95f4\u7684\u6620\u5c04\u3002</p> <pre><code>    urls = ['http://www.yahoo.com', 'http://www.reddit.com']\n    results = map(urllib2.urlopen, urls)\n</code></pre> <p>\u4e0a\u9762\u7684\u8fd9\u4e24\u884c\u4ee3\u7801\u5c06 urls \u8fd9\u4e00\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230 urlopen \u65b9\u6cd5\u4e2d\uff0c\u5e76\u5c06\u6240\u6709\u7ed3\u679c\u4fdd\u5b58\u5230 results \u8fd9\u4e00\u5217\u8868\u4e2d\u3002\u5176\u7ed3\u679c\u5927\u81f4\u76f8\u5f53\u4e8e\uff1a</p> <pre><code>results = []\nfor url in urls: \n    results.append(urllib2.urlopen(url))\n</code></pre> <p>map \u51fd\u6570\u4e00\u624b\u5305\u529e\u4e86\u5e8f\u5217\u64cd\u4f5c\u3001\u53c2\u6570\u4f20\u9012\u548c\u7ed3\u679c\u4fdd\u5b58\u7b49\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\u3002</p> <p>\u4e3a\u4ec0\u4e48\u8fd9\u5f88\u91cd\u8981\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u501f\u52a9\u6b63\u786e\u7684\u5e93\uff0cmap \u53ef\u4ee5\u8f7b\u677e\u5b9e\u73b0\u5e76\u884c\u5316\u64cd\u4f5c\u3002</p> <p></p> <p>\u5728 Python \u4e2d\u6709\u4e2a\u4e24\u4e2a\u5e93\u5305\u542b\u4e86 map \u51fd\u6570\uff1a multiprocessing \u548c\u5b83\u9c9c\u4e3a\u4eba\u77e5\u7684\u5b50\u5e93 multiprocessing.dummy.</p> <p>\u8fd9\u91cc\u591a\u626f\u4e24\u53e5\uff1a multiprocessing.dummy\uff1f mltiprocessing \u5e93\u7684\u7ebf\u7a0b\u7248\u514b\u9686\uff1f\u8fd9\u662f\u867e\u7c73\uff1f\u5373\u4fbf\u5728 multiprocessing \u5e93\u7684\u5b98\u65b9\u6587\u6863\u91cc\u5173\u4e8e\u8fd9\u4e00\u5b50\u5e93\u4e5f\u53ea\u6709\u4e00\u53e5\u76f8\u5173\u63cf\u8ff0\u3002\u800c\u8fd9\u53e5\u63cf\u8ff0\u8bd1\u6210\u4eba\u8bdd\u57fa\u672c\u5c31\u662f\u8bf4:\"\u561b\uff0c\u6709\u8fd9\u4e48\u4e2a\u4e1c\u897f\uff0c\u4f60\u77e5\u9053\u5c31\u6210.\"\u76f8\u4fe1\u6211\uff0c\u8fd9\u4e2a\u5e93\u88ab\u4e25\u91cd\u4f4e\u4f30\u4e86\uff01</p> <p>dummy \u662f multiprocessing \u6a21\u5757\u7684\u5b8c\u6574\u514b\u9686\uff0c\u552f\u4e00\u7684\u4e0d\u540c\u5728\u4e8e multiprocessing \u4f5c\u7528\u4e8e\u8fdb\u7a0b\uff0c\u800c dummy \u6a21\u5757\u4f5c\u7528\u4e8e\u7ebf\u7a0b\uff08\u56e0\u6b64\u4e5f\u5305\u62ec\u4e86 Python \u6240\u6709\u5e38\u89c1\u7684\u591a\u7ebf\u7a0b\u9650\u5236\uff09\u3002 \u6240\u4ee5\u66ff\u6362\u4f7f\u7528\u8fd9\u4e24\u4e2a\u5e93\u5f02\u5e38\u5bb9\u6613\u3002\u4f60\u53ef\u4ee5\u9488\u5bf9 IO \u5bc6\u96c6\u578b\u4efb\u52a1\u548c CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u6765\u9009\u62e9\u4e0d\u540c\u7684\u5e93\u3002</p>"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#_3","title":"\u52a8\u624b\u5c1d\u8bd5","text":"<p>\u4f7f\u7528\u4e0b\u9762\u7684\u4e24\u884c\u4ee3\u7801\u6765\u5f15\u7528\u5305\u542b\u5e76\u884c\u5316 map \u51fd\u6570\u7684\u5e93\uff1a</p> <pre><code>from multiprocessing import Pool\nfrom multiprocessing.dummy import Pool as ThreadPool\n</code></pre> <p>\u5b9e\u4f8b\u5316 Pool \u5bf9\u8c61\uff1a</p> <pre><code>pool = ThreadPool()\n</code></pre> <p>\u8fd9\u6761\u7b80\u5355\u7684\u8bed\u53e5\u66ff\u4ee3\u4e86 example2.py \u4e2d build_worker_pool \u51fd\u6570 7 \u884c\u4ee3\u7801\u7684\u5de5\u4f5c\u3002\u5b83\u751f\u6210\u4e86\u4e00\u7cfb\u5217\u7684 worker \u7ebf\u7a0b\u5e76\u5b8c\u6210\u521d\u59cb\u5316\u5de5\u4f5c\u3001\u5c06\u5b83\u4eec\u50a8\u5b58\u5728\u53d8\u91cf\u4e2d\u4ee5\u65b9\u4fbf\u8bbf\u95ee\u3002</p> <p>Pool \u5bf9\u8c61\u6709\u4e00\u4e9b\u53c2\u6570\uff0c\u8fd9\u91cc\u6211\u6240\u9700\u8981\u5173\u6ce8\u7684\u53ea\u662f\u5b83\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1aprocesses. \u8fd9\u4e00\u53c2\u6570\u7528\u4e8e\u8bbe\u5b9a\u7ebf\u7a0b\u6c60\u4e2d\u7684\u7ebf\u7a0b\u6570\u3002\u5176\u9ed8\u8ba4\u503c\u4e3a\u5f53\u524d\u673a\u5668 CPU \u7684\u6838\u6570\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u6267\u884c CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u65f6\uff0c\u8c03\u7528\u8d8a\u591a\u7684\u6838\u901f\u5ea6\u5c31\u8d8a\u5feb\u3002\u4f46\u662f\u5f53\u5904\u7406\u7f51\u7edc\u5bc6\u96c6\u578b\u4efb\u52a1\u65f6\uff0c\u4e8b\u60c5\u6709\u6709\u4e9b\u96be\u4ee5\u9884\u8ba1\u4e86\uff0c\u901a\u8fc7\u5b9e\u9a8c\u6765\u786e\u5b9a\u7ebf\u7a0b\u6c60\u7684\u5927\u5c0f\u624d\u662f\u660e\u667a\u7684\u3002</p> <pre><code>pool = ThreadPool(4) # Sets the pool size to 4\n</code></pre> <p>\u7ebf\u7a0b\u6570\u8fc7\u591a\u65f6\uff0c\u5207\u6362\u7ebf\u7a0b\u6240\u6d88\u8017\u7684\u65f6\u95f4\u751a\u81f3\u4f1a\u8d85\u8fc7\u5b9e\u9645\u5de5\u4f5c\u65f6\u95f4\u3002\u5bf9\u4e8e\u4e0d\u540c\u7684\u5de5\u4f5c\uff0c\u901a\u8fc7\u5c1d\u8bd5\u6765\u627e\u5230\u7ebf\u7a0b\u6c60\u5927\u5c0f\u7684\u6700\u4f18\u503c\u662f\u4e2a\u4e0d\u9519\u7684\u4e3b\u610f\u3002</p> <p>\u521b\u5efa\u597d Pool \u5bf9\u8c61\u540e\uff0c\u5e76\u884c\u5316\u7684\u7a0b\u5e8f\u4fbf\u547c\u4e4b\u6b32\u51fa\u4e86\u3002\u6211\u4eec\u6765\u770b\u770b\u6539\u5199\u540e\u7684 example2.py</p> <pre><code>import urllib2 \nfrom multiprocessing.dummy import Pool as ThreadPool \n\nurls = [\n    'http://www.python.org', \n    'http://www.python.org/about/',\n    'http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html',\n    'http://www.python.org/doc/',\n    'http://www.python.org/download/',\n    'http://www.python.org/getit/',\n    'http://www.python.org/community/',\n    'https://wiki.python.org/moin/',\n    'http://planet.python.org/',\n    'https://wiki.python.org/moin/LocalUserGroups',\n    'http://www.python.org/psf/',\n    'http://docs.python.org/devguide/',\n    'http://www.python.org/community/awards/'\n    # etc.. \n    ]\n\n# Make the Pool of workers\npool = ThreadPool(4) \n# Open the urls in their own threads\n# and return the results\nresults = pool.map(urllib2.urlopen, urls)\n#close the pool and wait for the work to finish \npool.close() \npool.join() \n</code></pre> <p>\u5b9e\u9645\u8d77\u4f5c\u7528\u7684\u4ee3\u7801\u53ea\u6709 4 \u884c\uff0c\u5176\u4e2d\u53ea\u6709\u4e00\u884c\u662f\u5173\u952e\u7684\u3002map \u51fd\u6570\u8f7b\u800c\u6613\u4e3e\u7684\u53d6\u4ee3\u4e86\u524d\u6587\u4e2d\u8d85\u8fc7 40 \u884c\u7684\u4f8b\u5b50\u3002\u4e3a\u4e86\u66f4\u6709\u8da3\u4e00\u4e9b\uff0c\u6211\u7edf\u8ba1\u4e86\u4e0d\u540c\u65b9\u6cd5\u3001\u4e0d\u540c\u7ebf\u7a0b\u6c60\u5927\u5c0f\u7684\u8017\u65f6\u60c5\u51b5\u3002</p> <pre><code># results = [] \n# for url in urls:\n#   result = urllib2.urlopen(url)\n#   results.append(result)\n\n# # ------- VERSUS ------- # \n\n\n# # ------- 4 Pool ------- # \n# pool = ThreadPool(4) \n# results = pool.map(urllib2.urlopen, urls)\n\n# # ------- 8 Pool ------- # \n\n# pool = ThreadPool(8) \n# results = pool.map(urllib2.urlopen, urls)\n\n# # ------- 13 Pool ------- # \n\n# pool = ThreadPool(13) \n# results = pool.map(urllib2.urlopen, urls)\n</code></pre> <p>\u7ed3\u679c\uff1a</p> <pre><code>#        Single thread:  14.4 Seconds \n#               4 Pool:   3.1 Seconds\n#               8 Pool:   1.4 Seconds\n#              13 Pool:   1.3 Seconds\n</code></pre> <p>\u5f88\u68d2\u7684\u7ed3\u679c\u4e0d\u662f\u5417\uff1f\u8fd9\u4e00\u7ed3\u679c\u4e5f\u8bf4\u660e\u4e86\u4e3a\u4ec0\u4e48\u8981\u901a\u8fc7\u5b9e\u9a8c\u6765\u786e\u5b9a\u7ebf\u7a0b\u6c60\u7684\u5927\u5c0f\u3002\u5728\u6211\u7684\u673a\u5668\u4e0a\u5f53\u7ebf\u7a0b\u6c60\u5927\u5c0f\u5927\u4e8e 9 \u5e26\u6765\u7684\u6536\u76ca\u5c31\u5341\u5206\u6709\u9650\u4e86\u3002</p>"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#_4","title":"\u53e6\u4e00\u4e2a\u771f\u5b9e\u7684\u4f8b\u5b50","text":"<p>\u751f\u6210\u4e0a\u5343\u5f20\u56fe\u7247\u7684\u7f29\u7565\u56fe \u8fd9\u662f\u4e00\u4e2a CPU \u5bc6\u96c6\u578b\u7684\u4efb\u52a1\uff0c\u5e76\u4e14\u5341\u5206\u9002\u5408\u8fdb\u884c\u5e76\u884c\u5316\u3002</p>"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#_5","title":"\u57fa\u7840\u5355\u8fdb\u7a0b\u7248\u672c","text":"<pre><code>import os \nimport PIL \n\nfrom multiprocessing import Pool \nfrom PIL import Image\n\nSIZE = (75,75)\nSAVE_DIRECTORY = 'thumbs'\n\ndef get_image_paths(folder):\n    return (os.path.join(folder, f) \n            for f in os.listdir(folder) \n            if 'jpeg' in f)\n\ndef create_thumbnail(filename): \n    im = Image.open(filename)\n    im.thumbnail(SIZE, Image.ANTIALIAS)\n    base, fname = os.path.split(filename) \n    save_path = os.path.join(base, SAVE_DIRECTORY, fname)\n    im.save(save_path)\n\nif __name__ == '__main__':\n    folder = os.path.abspath(\n        '11_18_2013_R000_IQM_Big_Sur_Mon__e10d1958e7b766c3e840')\n    os.mkdir(os.path.join(folder, SAVE_DIRECTORY))\n\n    images = get_image_paths(folder)\n\n    for image in images:\n        create_thumbnail(Image)\n</code></pre> <p>\u4e0a\u8fb9\u8fd9\u6bb5\u4ee3\u7801\u7684\u4e3b\u8981\u5de5\u4f5c\u5c31\u662f\u5c06\u904d\u5386\u4f20\u5165\u7684\u6587\u4ef6\u5939\u4e2d\u7684\u56fe\u7247\u6587\u4ef6\uff0c\u4e00\u4e00\u751f\u6210\u7f29\u7565\u56fe\uff0c\u5e76\u5c06\u8fd9\u4e9b\u7f29\u7565\u56fe\u4fdd\u5b58\u5230\u7279\u5b9a\u6587\u4ef6\u5939\u4e2d\u3002</p> <p>\u8fd9\u6211\u7684\u673a\u5668\u4e0a\uff0c\u7528\u8fd9\u4e00\u7a0b\u5e8f\u5904\u7406 6000 \u5f20\u56fe\u7247\u9700\u8981\u82b1\u8d39 27.9 \u79d2\u3002</p> <p>\u5982\u679c\u6211\u4eec\u4f7f\u7528 map \u51fd\u6570\u6765\u4ee3\u66ff for \u5faa\u73af\uff1a</p> <pre><code>import os \nimport PIL \n\nfrom multiprocessing import Pool \nfrom PIL import Image\n\nSIZE = (75,75)\nSAVE_DIRECTORY = 'thumbs'\n\ndef get_image_paths(folder):\n    return (os.path.join(folder, f) \n            for f in os.listdir(folder) \n            if 'jpeg' in f)\n\ndef create_thumbnail(filename): \n    im = Image.open(filename)\n    im.thumbnail(SIZE, Image.ANTIALIAS)\n    base, fname = os.path.split(filename) \n    save_path = os.path.join(base, SAVE_DIRECTORY, fname)\n    im.save(save_path)\n\nif __name__ == '__main__':\n    folder = os.path.abspath(\n        '11_18_2013_R000_IQM_Big_Sur_Mon__e10d1958e7b766c3e840')\n    os.mkdir(os.path.join(folder, SAVE_DIRECTORY))\n\n    images = get_image_paths(folder)\n\n    pool = Pool()\n    pool.map(creat_thumbnail, images)\n    pool.close()\n    pool.join()\n</code></pre>"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#56","title":"5.6 \u79d2\uff01","text":"<p>\u867d\u7136\u53ea\u6539\u52a8\u4e86\u51e0\u884c\u4ee3\u7801\uff0c\u6211\u4eec\u5374\u660e\u663e\u63d0\u9ad8\u4e86\u7a0b\u5e8f\u7684\u6267\u884c\u901f\u5ea6\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u548c IO \u5bc6\u96c6\u578b\u4efb\u52a1\u5206\u522b\u9009\u62e9\u591a\u8fdb\u7a0b\u548c\u591a\u7ebf\u7a0b\u5e93\u6765\u8fdb\u4e00\u6b65\u63d0\u9ad8\u6267\u884c\u901f\u5ea6\u2014\u2014\u8fd9\u4e5f\u662f\u89e3\u51b3\u6b7b\u9501\u95ee\u9898\u7684\u826f\u65b9\u3002\u6b64\u5916\uff0c\u7531\u4e8e map \u51fd\u6570\u5e76\u4e0d\u652f\u6301\u624b\u52a8\u7ebf\u7a0b\u7ba1\u7406\uff0c\u53cd\u800c\u4f7f\u5f97\u76f8\u5173\u7684 debug \u5de5\u4f5c\u4e5f\u53d8\u5f97\u5f02\u5e38\u7b80\u5355\u3002</p> <p>\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\uff08\u57fa\u672c\uff09\u901a\u8fc7\u4e00\u884c Python \u5b9e\u73b0\u5e76\u884c\u5316\u3002</p> <ul> <li>\u4e0b\u9762\u7684\u7f51\u5740\u4e2d\u53ef\u4ee5\u627e\u5230\u5173\u4e8e GIL\uff08Global Interpretor Lock\uff0c\u5168\u5c40\u89e3\u91ca\u5668\u9501\uff09\u66f4\u591a\u7684\u8ba8\u8bba\uff1a http://stackoverflow.com/questions/3044580/multiprocessing-vs-threading-python</li> <li>\u7b80\u8a00\u4e4b\uff0cIO \u5bc6\u96c6\u578b\u4efb\u52a1\u9009\u62e9multiprocessing.dummy\uff0cCPU \u5bc6\u96c6\u578b\u4efb\u52a1\u9009\u62e9multiprocessing </li> </ul>"}]}