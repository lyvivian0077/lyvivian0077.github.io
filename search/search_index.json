{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to My Docs \u00b6 Commands \u00b6 mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout \u00b6 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files. Deploying docs \u00b6 https://mkdocs.nakaken88.com/use/write/ https://dev.classmethod.jp/articles/mkdocs-and-material-for-mkdocs-tips-matome/ https://www.mkdocs.org/getting-started/ https://www.mkdocs.org/user-guide/deploying-your-docs/ # python3 -m pip install --upgrade pip # pip install mkdocs # pip install mkdocs-material # mkdocs serve -a 127.0.0.1:8000 -v my-project/ mkdocs.yml docs/ orgname.github.io/ cd ../orgname.github.io/ mkdocs gh-deploy --config-file ../my-project/mkdocs.yml --remote-branch master or cd ../my-project/ # mkdocs build -d ../lyvivian0077.github.io/ # cd ../lyvivian0077.github.io/ # git add . # git commit -m 'test' # git push","title":"Welcome"},{"location":"#welcome-to-my-docs","text":"","title":"Welcome to My Docs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"#deploying-docs","text":"https://mkdocs.nakaken88.com/use/write/ https://dev.classmethod.jp/articles/mkdocs-and-material-for-mkdocs-tips-matome/ https://www.mkdocs.org/getting-started/ https://www.mkdocs.org/user-guide/deploying-your-docs/ # python3 -m pip install --upgrade pip # pip install mkdocs # pip install mkdocs-material # mkdocs serve -a 127.0.0.1:8000 -v my-project/ mkdocs.yml docs/ orgname.github.io/ cd ../orgname.github.io/ mkdocs gh-deploy --config-file ../my-project/mkdocs.yml --remote-branch master or cd ../my-project/ # mkdocs build -d ../lyvivian0077.github.io/ # cd ../lyvivian0077.github.io/ # git add . # git commit -m 'test' # git push","title":"Deploying docs"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/","text":"\u539f\u6587 \u5728Linux\u5b66\u4e60\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u65e0\u53ef\u907f\u514d\u7684\u4f1a\u78b0\u5230\u4e00\u4e2a\u65e2\u8ba9\u4eba\u559c\u6b22\uff0c\u53c8\u4ee4\u4eba\u5934\u75bc\u7684\u795e\u5947\u7684\u4e1c\u897f\u2014\u2014bash\u7f16\u7a0b\uff0c\u5373shell\u811a\u672c\u3002 \u90a3\u4e48\u4ec0\u4e48\u662fshell\u811a\u672c\u5462\uff1fshell\u662f\u4e00\u4e2a\u547d\u4ee4\u8bed\u8a00\u89e3\u91ca\u5668\uff0c\u800cshell\u811a\u672c\u5219\u662fLinux\u547d\u4ee4\u7684\u96c6\u5408\uff0c \u6309\u7167\u9884\u8bbe\u7684\u987a\u5e8f\u4f9d\u6b21\u89e3\u91ca\u6267\u884c\uff0c\u6765\u5b8c\u6210\u7279\u5b9a\u7684\u3001\u8f83\u590d\u6742\u7684\u7cfb\u7edf\u7ba1\u7406\u4efb\u52a1\uff0c\u7c7b\u4f3c\u4e8eWindows\u4e2d\u7684\u6279\u5904\u7406\u6587\u4ef6\u3002 \u672c\u6587\u5e26\u6765\u7684\u662fbash\u7f16\u7a0b\u7684\u57fa\u7840\u8bed\u6cd5\u8bb2\u89e3\u3002 bash\u7f16\u7a0b\u4e4b\u53d8\u91cf \u00b6 bash\u53d8\u91cf\u7c7b\u522b \u00b6 \u672c\u5730\u53d8\u91cf : \u53ea\u5bf9\u5f53\u524dshell\u8fdb\u7a0b\u6709\u6548\u7684\u53d8\u91cf\uff0c\u5bf9\u5176\u5b83shell\u8fdb\u7a0b\u65e0\u6548\uff0c\u5305\u5f53\u524dshell\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b VAR_NAME=VALUE \u53d8\u91cf\u8d4b\u503c : \u5411\u53d8\u91cf\u7684\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58\u6570\u636e \u53d8\u91cf\u5f15\u7528 : ${VAR_NAME} \"\":\u5f31\u5f15\u7528\uff0c\u91cc\u9762\u7684\u53d8\u91cf\u4f1a\u88ab\u66ff\u6362 '':\u5f3a\u5f15\u7528\uff0c\u91cc\u9762\u7684\u6240\u6709\u5b57\u7b26\u90fd\u662f\u5b57\u9762\u91cf\uff0c\u76f4\u63a5\u8f93\u51fa \u73af\u5883\u53d8\u91cf : \u5bf9\u5f53\u524dshell\u8fdb\u7a0b\u53ca\u5176\u5b50shell\u6709\u6548\uff0c\u5bf9\u5176\u5b83\u7684shell\u8fdb\u7a0b\u65e0\u6548 \u5b9a\u4e49\uff1aexport VAR_NAME=VALUE \u5bfc\u51fa\uff1aexport VAR_NAME \u64a4\u6d88\u53d8\u91cf\uff1aunset VAR_NAME \u53ea\u8bfb\u53d8\u91cf\uff1areadonly VAR_NAME \u5c40\u90e8\u53d8\u91cf : \u5bf9shell\u811a\u672c\u4e2d\u67d0\u4ee3\u7801\u7247\u65ad\u6709\u6548\uff0c\u901a\u5e38\u7528\u4e8e\u51fd\u6570\u672c\u5730 local VAR_NAME=VALUE \u4f4d\u7f6e\u53d8\u91cf : \u7528\u6765\u63a5\u53d7\u53d8\u91cf\u6307\u5b9a\u4f4d\u7f6e\u7684\u53c2\u6570 $1,$2...,${10} \u7279\u6b8a\u53d8\u91cf : shell\u5bf9\u4e00\u4e9b\u53c2\u6570\u505a\u7279\u6b8a\u5904\u7406,\u8fd9\u4e9b\u53c2\u6570\u53ea\u80fd\u88ab\u5f15\u7528\u800c\u4e0d\u80fd\u88ab\u8d4b\u503c $# \u4f20\u9012\u5230\u811a\u672c\u7684\u53c2\u6570\u4e2a\u6570 $* \u663e\u793a\u6240\u6709\u5411\u811a\u672c\u4f20\u9012\u7684\u53c2\u6570 #\u4e0e\u4f4d\u7f6e\u53d8\u91cf\u4e0d\u540c\uff0c\u6b64\u9009\u9879\u53c2\u6570\u53ef\u8d85\u8fc79\u4e2a $$ \u83b7\u53d6\u5f53\u524dshell\u7684\u8fdb\u7a0b\u53f7 $! \u6267\u884c\u4e0a\u4e00\u4e2a\u6307\u4ee4\u7684\u8fdb\u7a0b\u53f7 $? \u83b7\u53d6\u6267\u884c\u7684\u4e0a\u4e00\u4e2a\u6307\u4ee4\u7684\u8fd4\u56de\u503c #0\u4e3a\u6267\u884c\u6210\u529f\uff0c\u975e\u96f6\u4e3a\u6267\u884c\u5931\u8d25 $- \u663e\u793ashell\u4f7f\u7528\u7684\u5f53\u524d\u9009\u9879\uff0c\u4e0eset\u547d\u4ee4\u529f\u80fd\u76f8\u540c $@ \u4e0e$*\u76f8\u540c\uff0c\u4f46\u662f\u4f7f\u7528\u65f6\u52a0\u5f15\u53f7\uff0c\u5e76\u5728\u5f15\u53f7\u4e2d\u8fd4\u56de\u6bcf\u4e2a\u53c2\u6570 \u67e5\u770b\u53d8\u91cf : set\uff1a\u67e5\u770b\u5f53\u524dshell\u8fdb\u7a0b\u4e2d\u7684\u6240\u6709\u53d8\u91cf export, printenv, env\uff1a\u67e5\u770b\u5f53\u524dshell\u8fdb\u7a0b\u4e2d\u7684\u6240\u6709\u73af\u5883\u53d8\u91cf \u53d8\u91cf\u547d\u540d : 1. \u4e0d\u80fd\u4f7f\u7528\u7a0b\u5e8f\u4e2d\u7684\u5173\u952e\u5b57\uff08\u4fdd\u7559\u5b57\uff09 2. \u53ea\u80fd\u4f7f\u7528\u6570\u5b57\u3001\u5b57\u6bcd\u548c\u4e0b\u5212\u7ebf\uff0c\u4e14\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934 3. \u8981\u89c1\u540d\u77e5\u4e49 \u53d8\u91cf\u7c7b\u578b : \u6570\u503c\u578b\uff1a\u7cbe\u786e\u6570\u503c(\u6574\u6570)\uff0c\u8fd1\u4f3c\u6570\u503c\uff08\u6d6e\u70b9\u578b\uff09 \u5b57\u7b26\u578b\uff1achar,string \u5e03\u5c14\u578b\uff1atrue, false \u7c7b\u578b\u8f6c\u6362 : \u663e\u5f0f\u8f6c\u6362 \u9690\u5f0f\u8f6c\u6362 bash\u7684\u914d\u7f6e\u6587\u4ef6\uff1a \u00b6 \u529f\u80fd\uff1a\u8bbe\u5b9a\u672c\u5730\u53d8\u91cf\uff0c\u5b9a\u4e49\u547d\u4ee4\u522b\u540d \u00b6 profile\u7c7b\uff1a\u4e3a\u4ea4\u4e92\u5f0f\u767b\u5f55\u7684\u7528\u6237\u63d0\u4f9b\u914d\u7f6e \u5168\u5c40\uff1a/etc/profile\u3001/etc/profile.d/*.sh \u7528\u6237\uff1a~/.bash_profile bashrc\u7c7b\uff1a\u4e3a\u975e\u4ea4\u4e92\u5f0f\u7684\u7528\u6237\u63d0\u4f9b\u914d\u7f6e \u5168\u5c40\uff1a/etc/bashrc \u7528\u6237\uff1a~/.bashrc bash\u7f16\u7a0b\u4e4b\u7f16\u5199\u683c\u5f0f\u53ca\u6267\u884c\u65b9\u5f0f \u00b6 \u7f16\u5199\u683c\u5f0f\uff1ashell\u811a\u672c\u7b2c\u4e00\u884c\u5fc5\u987b\u9876\u683c\u5199\uff0c\u7528shebang\u5b9a\u4e49\u6307\u5b9a\u7684\u89e3\u91ca\u5668\u6765\u89e3\u91ca\u8be5\u811a\u672c\u3002 #!/bin/bash #!\u5373\u4e3ashebang # \u5176\u5b83\u7684\u4ee5#\u5f00\u5934\u7684\u884c\u5747\u4e3a\u6ce8\u91ca\uff0c\u4f1a\u88ab\u89e3\u91ca\u5668\u5ffd\u7565\uff0c\u53ef\u7528\u6765\u6ce8\u91ca\u811a\u672c\u7528\u9014\u53ca\u7248\u672c\uff0c\u65b9\u4fbf\u4f7f\u7528\u7ba1\u7406\u3002 \u6267\u884c\u65b9\u5f0f\uff1abash\u7f16\u7a0b\u5c5e\u4e8e\u9762\u5411\u8fc7\u7a0b\u7f16\u7a0b\uff0c\u6267\u884c\u65b9\u5f0f\u5982\u4e0b\uff1a \u987a\u5e8f\u6267\u884c\uff1a\u6309\u547d\u4ee4\u5148\u540e\u987a\u5bfb\u4f9d\u6b21\u6267\u884c \u9009\u62e9\u6267\u884c\uff1a\u6d4b\u8bd5\u6761\u4ef6\uff0c\u53ef\u80fd\u4f1a\u591a\u4e2a\u6d4b\u8bd5\u6761\u4ef6\uff0c\u67d0\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0c\u5219\u6267\u884c\u5bf9\u5e94\u7684\u5206\u652f \u5faa\u73af\u6267\u884c\uff1a\u5c06\u540c\u4e00\u6bb5\u4ee3\u7801\u53cd\u590d\u6267\u884c\u591a\u6b21\uff0c\u56e0\u6b64\uff0c\u5faa\u73af\u5fc5\u987b\u6709\u9000\u51fa\u6761\u4ef6\uff1b\u5426\u5219\uff0c\u5219\u9677\u5165\u6b7b\u5faa\u73af bash\u6267\u884c\u9009\u9879\uff1a bash -n SHELLNAME #\u8bed\u6cd5\u6d4b\u8bd5\uff0c\u6d4b\u8bd5\u662f\u5426\u5b58\u5728\u8bed\u6cd5\u9519\u8bef bash -x SHELLNAME #\u6a21\u62df\u5355\u6b65\u6267\u884c\uff0c\u663e\u793a\u6bcf\u4e00\u6b65\u6267\u884c\u8fc7\u7a0b bash\u4e4b\u7b97\u6570\u8fd0\u7b97\u4e0e\u903b\u8f91\u8fd0\u7b97 \u00b6 \u7b97\u6570\u8fd0\u7b97 \u5b9a\u4e49\u6574\u578b\u53d8\u91cf\uff1a let VAR_NAME=INTEGER_VALUE #\u4f8b\u5982\uff1alet a=3 declare -i VAR_NAME=INTEGER_VALUE #declare -i a=3 \u5b9e\u73b0\u7b97\u672f\u8fd0\u7b97\u7684\u65b9\u5f0f\uff1a let VAR_NAME=ARITHMATIC_EXPRESSION VAR_NAME=$[ARITHMATIC_EXRESSION] VAR_NAME=$((EXPRESSION)) VAR_NAME=$(expr $num1 + $num2) \u7b97\u672f\u8fd0\u7b97\u7b26\uff1a +\uff1a\u52a0\u6cd5 -\uff1a\u51cf\u6cd5 *\uff1a\u4e58\u6cd5 /\uff1a\u6574\u9664 %\uff1a\u53d6\u4f59\u6570 **\uff1a\u4e58\u5e42 \u6ce8\u610f\uff1a\u5373\u4f7f\u6ca1\u6709\u5b9a\u4e49\u4e3a\u6574\u578b\u53d8\u91cf\uff0c\u5b57\u7b26\u578b\u7684\u6570\u5b57\u4f9d\u7136\u53ef\u4ee5\u53c2\u4e0e\u7b97\u672f\u8fd0\u7b97\uff0cbash\u4f1a\u6267\u884c\u53d8\u91cf\u7c7b\u578b\u7684\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\u3002 - \u903b\u8f91\u8fd0\u7b97 \u5e03\u5c14\u8fd0\u7b97\uff1a\u771f\uff0c\u5047 \u4e0e\u8fd0\u7b97\uff1a\u771f && \u771f = \u771f \u771f && \u5047 = \u5047 \u5047 && \u771f = \u5047 \u5047 && \u5047 = \u5047 \u6216\u8fd0\u7b97\uff1a\u771f || \u771f = \u771f \u771f || \u5047 = \u771f \u5047 || \u771f = \u771f \u5047 || \u5047 = \u5047 \u975e\u8fd0\u7b97\uff1a\uff01\u771f=\u5047 \uff01\u5047=\u771f bash\u7f16\u7a0b\u4e4b\u6761\u4ef6\u6d4b\u8bd5\u8bed\u53e5 \u00b6 bash\u6761\u4ef6\u6d4b\u8bd5 \u00b6 \u6574\u578b\u6d4b\u8bd5 \uff1a\u6574\u6570\u6bd4\u8f83 \u4f8b\u5982 [ $num1 -gt $num2 ] -gt: \u5927\u4e8e\u5219\u4e3a\u771f -lt: \u5c0f\u4e8e\u5219\u4e3a\u771f -ge: \u5927\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f -le: \u5c0f\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f -eq: \u7b49\u4e8e\u5219\u4e3a\u771f -ne: \u4e0d\u7b49\u4e8e\u5219\u4e3a\u771f \u5b57\u7b26\u6d4b\u8bd5 \uff1a\u5b57\u7b26\u4e32\u6bd4\u8f83 \u53cc\u76ee\uff1a \u4f8b\u5982[[ \"$str1\" > \"$str2\" ]] >: \u5927\u4e8e\u5219\u4e3a\u771f <: \u5c0f\u4e8e\u5219\u4e3a\u771f >=\uff1a\u5927\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f <=\uff1a\u5c0f\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f ==\uff1a\u7b49\u4e8e\u5219\u4e3a\u771f !=\uff1a\u4e0d\u7b49\u4e8e\u5219\u4e3a\u771f \u5355\u76ee\uff1a -n String: \u662f\u5426\u4e0d\u7a7a\uff0c\u4e0d\u7a7a\u5219\u4e3a\u771f\uff0c\u7a7a\u5219\u4e3a\u5047 -z String: \u662f\u5426\u4e3a\u7a7a\uff0c\u7a7a\u5219\u4e3a\u771f\uff0c\u4e0d\u7a7a\u5219\u5047 \u6587\u4ef6\u6d4b\u8bd5\uff1a\u5224\u65ad\u6587\u4ef6\u7684\u5b58\u5728\u6027\u53ca\u5c5e\u6027\u7b49 -a FILE\uff1a\u5b58\u5728\u5219\u4e3a\u771f\uff1b\u5426\u5219\u5219\u4e3a\u5047\uff1b -e FILE: \u5b58\u5728\u5219\u4e3a\u771f\uff1b\u5426\u5219\u5219\u4e3a\u5047\uff1b -f FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u666e\u901a\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b -d FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u76ee\u5f55\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b -L/-h FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u7b26\u53f7\u94fe\u63a5\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b -b: \u5b58\u5728\u5e76\u4e14\u4e3a\u5757\u8bbe\u5907\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b -c: \u5b58\u5728\u5e76\u4e14\u4e3a\u5b57\u7b26\u8bbe\u5907\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047 -S: \u5b58\u5728\u5e76\u4e14\u4e3a\u5957\u63a5\u5b57\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047 -p: \u5b58\u5728\u5e76\u4e14\u4e3a\u547d\u540d\u7ba1\u9053\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047 -s FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u975e\u7a7a\u6587\u4ef6\u5219\u4e3a\u503c\uff0c\u5426\u5219\u4e3a\u5047\uff1b -r FILE\uff1a\u6587\u4ef6\u53ef\u8bfb\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047 -w FILE\uff1a\u6587\u4ef6\u53ef\u5199\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047 -x FILE\uff1a\u6587\u4ef6\u53ef\u6267\u884c\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047 file1 -nt file2: file1\u7684mtime\u65b0\u4e8efile2\u5219\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047\uff1b file1 -ot file2\uff1afile1\u7684mtime\u65e7\u4e8efile2\u5219\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047\uff1b \u7ec4\u5408\u6761\u4ef6\u6d4b\u8bd5\uff1a\u5728\u591a\u4e2a\u6761\u4ef6\u95f4\u5b9e\u73b0\u903b\u8f91\u8fd0\u7b97 \u4e0e\uff1a[ condition1 -a condition2 ] condition1 && condition2 \u6216\uff1a[ condition1 -o condition2 ] condition1 || condition2 \u975e\uff1a[ -not condition ] ! condition \u4e0e\uff1aCOMMAND1 && COMMAND2 COMMAND1\u5982\u679c\u4e3a\u5047\uff0c\u5219COMMAND2\u4e0d\u6267\u884c \u6216\uff1aCOMMAND1 || COMMAND2 COMMAND1\u5982\u679c\u4e3a\u771f\uff0c\u5219COMMAND2\u4e0d\u6267\u884c \u975e\uff1a! COMMAND \u6761\u4ef6\u6d4b\u8bd5\u4e4bif\u8bed\u53e5 1\u3001if\u8bed\u53e5\u4e4b\u5355\u5206\u652f \u8bed\u53e5\u7ed3\u6784\uff1a if \u6d4b\u8bd5\u6761\u4ef6;then \u9009\u62e9\u5206\u652f fi \u8868\u793a\u6761\u4ef6\u6d4b\u8bd5\u72b6\u6001\u8fd4\u56de\u503c\u4e3a\u503c\uff0c\u5219\u6267\u884c\u9009\u62e9\u5206\u652f \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u662f\u7528\u6237\u540d\uff1b\u5982\u679c\u6b64\u7528\u6237\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\u8be5\u7528\u6237\uff1b #\uff01/bin/bash if ! id $1 &> /dev/null;then useradd $1 fi 2\u3001if\u8bed\u53e5\u4e4b\u53cc\u5206\u652f \u8bed\u53e5\u7ed3\u6784\uff1a if \u6d4b\u8bd5\u6761\u4ef6;then \u9009\u62e9\u5206\u652f1 else \u9009\u62e9\u5206\u652f2 fi \u4e24\u4e2a\u5206\u652f\u4ec5\u6267\u884c\u5176\u4e2d\u4e4b\u4e00 \u4f8b\uff1a\u901a\u8fc7\u547d\u4ee4\u884c\u7ed9\u5b9a\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\uff0c\u800c\u540e\u5224\u65ad\uff1a\u5982\u679c\u6b64\u6587\u4ef6\u4e2d\u5b58\u5728\u7a7a\u767d\u884c\uff0c\u5219\u663e\u793a\u5176\u7a7a\u767d\u884c\u7684\u603b\u6570\uff1b\u5426\u5219\uff0c\u5219\u663e\u793a\u65e0\u7a7a\u767d\u884c\uff1b #\uff01/bin/bash if grep \"^[[:space]]*$\" $1 &> /dev/null; then echo \"$1 has $(grep \"^[[:space]]*$\" $1 | wc -l) blank lines.\" else echo \"No blank lines\" fi \u6ce8\u610f\uff1a\u5982\u679c\u628a\u547d\u4ee4\u6267\u884c\u6210\u529f\u4e0e\u5426\u5f53\u4f5c\u6761\u4ef6\uff0c\u5219if\u8bed\u53e5\u540e\u5fc5\u987b\u53ea\u8ddf\u547d\u4ee4\u672c\u8eab\uff0c\u800c\u4e0d\u80fd\u5f15\u7528\u3002 3\u3001if\u8bed\u53e5\u4e4b\u591a\u5206\u652f \u8bed\u53e5\u7ed3\u6784\uff1a if \u6761\u4ef61;then \u5206\u652f1 elif \u6761\u4ef62;then \u5206\u652f2 elif \u6761\u4ef63;then \u5206\u652f3 ... else \u5206\u652fn fi \u4f8b\uff1a\u4f20\u9012\u4e00\u4e2a\u7528\u6237\u540d\u7ed9\u811a\u672c\uff1a\u5982\u679c\u6b64\u7528\u6237\u7684id\u53f7\u4e3a0\uff0c\u5219\u663e\u793a\u8bf4\u8fd9\u662f\u7ba1\u7406\u5458\uff1b\u5982\u679c\u6b64\u7528\u6237\u7684id\u53f7\u5927\u4e8e\u7b49\u4e8e500\uff0c\u5219\u663e\u793a\u8bf4\u8fd9\u662f\u666e\u901a\u7528\u6237\uff1b\u5426\u5219\uff0c\u5219\u8bf4\u8fd9\u662f\u7cfb\u7edf\u7528\u6237\u3002 #!/bin/bash if [ $# -lt 1 ]; then echo \"Usage: `basename $0` username\" exit 1 fi if ! id -u $1 &> /dev/null; then echo \"Usage: `basename $0` username\" echo \"No this user $1.\" exit 2 fi if [ $(id -u $1) -eq 0 ]; then echo \"Admin\" elif [ $(id -u $1) -ge 500 ]; then echo \"Common user.\" else echo \"System user.\" fi bash\u4ea4\u4e92\u5f0f\u7f16\u7a0b read [option] \u201cprompt\u201d-p:\u76f4\u63a5\u6307\u5b9a\u4e00\u4e2a\u53d8\u91cf\u63a5\u53d7\u53c2\u6570 -t timaout\uff1a\u6307\u5b9a\u7b49\u5f85\u63a5\u53d7\u53c2\u6570\u7684\u65f6\u95f4 -n:\u8868\u793a\u4e0d\u6362\u884c \u4f8b\uff1a\u8f93\u5165\u7528\u6237\u540d\uff0c\u53ef\u8fd4\u56de\u5176shell #!/bin/bash read -p \"Plz input a username: \" userName if id $userName &> /dev/null; then echo \"The shell of $userName is `grep \"^$userName\\>\" /etc/passwd | cut -d: -f7`.\" else echo \"No such user. stupid.\" fi \u6761\u4ef6\u6d4b\u8bd5\u4e4bcase\u8bed\u53e5 case\u8bed\u53e5\uff1a\u6709\u591a\u4e2a\u6d4b\u8bd5\u6761\u4ef6\u65f6\uff0ccase\u8bed\u53e5\u4f1a\u4f7f\u5f97\u8bed\u6cd5\u7ed3\u6784\u66f4\u660e\u6670 \u8bed\u53e5\u7ed3\u6784\uff1a case \u53d8\u91cf\u5f15\u7528 in PATTERN1) \u5206\u652f1 ;; PATTERN2) \u5206\u652f2 ;; ... *) \u5206\u652fn ;; esac PATTERN\uff1a\u7c7b\u540c\u4e8e\u6587\u4ef6\u540d\u901a\u914d\u673a\u5236\uff0c\u4f46\u652f\u6301\u4f7f\u7528|\u8868\u793a\u6216\u8005 a|b: a\u6216\u8005b*\uff1a\u5339\u914d\u4efb\u610f\u957f\u5ea6\u7684\u4efb\u610f\u5b57\u7b26 ?: \u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26 []: \u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u5355\u4e2a\u5b57\u7b26 \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u5b8c\u6210\u5982\u4e0b\u4efb\u52a1\uff0c\u5176\u4f7f\u7528\u5f62\u5f0f\u5982\u4e0b\u6240\u793a\uff1a script.sh {start|stop|restart|status} \u5176\u4e2d\uff1a\u5982\u679c\u53c2\u6570\u4e3a\u7a7a\uff0c\u5219\u663e\u793a\u5e2e\u52a9\u4fe1\u606f\uff0c\u5e76\u9000\u51fa\u811a\u672c\uff1b \u5982\u679c\u53c2\u6570\u4e3astart\uff0c\u5219\u521b\u5efa\u7a7a\u6587\u4ef6/var/lock/subsys/script\uff0c\u5e76\u663e\u793a\u201cstarting script successfully.\u201d \u5982\u679c\u53c2\u6570\u4e3astop\uff0c\u5219\u5220\u9664\u6587\u4ef6/var/lock/subsys/script\uff0c\u5e76\u663e\u793a\u201cStop script successfully.\u201d \u5982\u679c\u53c2\u6570\u4e3arestart\uff0c\u5219\u5220\u9664\u6587\u4ef6/var/locksubsys/script\u5e76\u91cd\u65b0\u521b\u5efa\uff0c\u800c\u540e\u663e\u793a\u201cRestarting script successfully.\u201d \u5982\u679c\u53c2\u6570\u4e3astatus\uff0c\u90a3\u4e48\uff1a\u5982\u679c\u6587\u4ef6/var/lock/subsys/script\u5b58\u5728\uff0c\u5219\u663e\u793a\u201cScript is running\u2026\u201d\uff0c\u5426\u5219\uff0c\u5219\u663e\u793a\u201cScript is stopped.\u201d #!/bin/bash file='/var/lock/subsys/script' case $1 in start) if [ -f $file ];then echo \"Script is running...\" exit 3 else touch $file [ $? -eq 0 ] && echo \"Starting script successfully.\" fi ;; stop) if [ -f $file ];then rm -rf $file [ $? -eq 0 ] && echo \"Stop script successfully.\" else echo \"Script is stopped...\" exit 4 fi ;; restart) if [ -f $file ];then rm -rf $file [ $? -eq 0 ] && echo \"Stop script successfully\" else echo \"Script is stopped...\" exit 5 fi touch $file [ $? -eq 0 ] && echo \"Starting script successfully\" ;; status) if [ -f $file ];then echo \"Script is running...\" else echo \"Script is stopped.\" fi ;; *) echo \"`basename $0` {start|stop|restart|status}\" exit 2 ;; esac bash\u7f16\u7a0b\u4e4b\u5faa\u73af\u8bed\u53e5 \u00b6 \u5faa\u73af\u4e4bfor\u5faa\u73af 1\u3001for\u8bed\u53e5\u683c\u5f0f\u4e00 \u8bed\u53e5\u7ed3\u6784\uff1a for \u53d8\u91cf\u540d in \u5217\u8868; do \u5faa\u73af\u4f53 done \u5217\u8868\uff1a\u53ef\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5143\u7d20 \u5faa\u73af\u4f53\uff1a\u4f9d\u8d56\u4e8e\u8c03\u7528\u53d8\u91cf\u6765\u5b9e\u73b0\u5176\u53d8\u5316 \u5faa\u73af\u53ef\u5d4c\u5957 \u9000\u51fa\u6761\u4ef6\uff1a\u904d\u5386\u5143\u7d20\u5217\u8868\u7ed3\u675f \u4f8b\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u6b63\u6574\u6570\u4e4b\u548c #!/bin/bash declare -i sum=0 for i in {1..100}; do let sum+=$i done echo $sum 2\u3001for\u8bed\u53e5\u683c\u5f0f\u4e8c for ((\u521d\u59cb\u6761\u4ef6;\u6d4b\u8bd5\u6761\u4ef6;\u4fee\u6539\u8868\u8fbe\u5f0f)); do \u5faa\u73af\u4f53 done \u5148\u7528\u521d\u59cb\u6761\u4ef6\u548c\u6d4b\u8bd5\u6761\u4ef6\u505a\u5224\u65ad\uff0c\u5982\u679c\u7b26\u5408\u6d4b\u8bd5\u6761\u4ef6\u5219\u6267\u884c\u5faa\u73af\u4f53\uff0c\u518d\u4fee\u6539\u8868\u8fbe\u5f0f\uff0c\u5426\u5219\u76f4\u63a5\u8df3\u51fa\u5faa\u73af\u3002 \u4f8b\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u6b63\u6574\u6570\u4e4b\u548c\uff08for\u4e8c\u5b9e\u73b0\uff09 #!/bin/bash declare -i sum=0 for ((counter=1;$counter <= 100; counter++)); do let sum+=$counter done echo $sum \u5faa\u73af\u4e4bwhile\u8bed\u53e5 while\u9002\u7528\u4e8e\u5faa\u73af\u6b21\u6570\u672a\u77e5\uff0c\u6216\u4e0d\u4fbf\u7528for\u76f4\u63a5\u751f\u6210\u8f83\u5927\u7684\u5217\u8868\u65f6 \u8bed\u53e5\u7ed3\u6784\uff1a while \u6d4b\u8bd5\u6761\u4ef6; do \u5faa\u73af\u4f53 done \u6d4b\u8bd5\u6761\u4ef6\u4e3a\u771f\uff0c\u8fdb\u5165\u5faa\u73af\uff1b\u6d4b\u8bd5\u6761\u4ef6\u4e3a\u5047\uff0c\u9000\u51fa\u5faa\u73af \u4f8b1\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u5076\u6570\u4e4b\u548c\uff0c\u8981\u6c42\u4f7f\u7528\u53d6\u6a21\u65b9\u6cd5 #!/bin/bash declare -i counter=1 declare -i sum=0 while [ $counter -le 100 ]; do if [ $[$counter%2] -eq 0 ]; then let sum+=$counter fi let counter++ done echo $sum \u4f8b2\uff1a\u63d0\u793a\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u7528\u6237\u540d\uff0c\u5982\u679c\u7528\u6237\u5b58\u5728\uff0c\u5c31\u663e\u793a\u7528\u6237\u7684ID\u53f7\u548cshell\uff1b\u5426\u5219\u663e\u793a\u7528\u6237\u4e0d\u5b58\u5728\uff1b\u663e\u793a\u5b8c\u6210\u4e4b\u540e\u4e0d\u9000\u51fa\uff0c\u518d\u6b21\u91cd\u590d\u524d\u9762\u7684\u64cd\u4f5c\uff0c\u76f4\u5230\u7528\u6237\u8f93\u5165q\u6216quit\u4e3a\u6b62 #!/bin/bash read -p \"Plz enter a username: \" userName while [ \"$userName\" != 'q' -a \"$userName\" != 'quit' ]; do if id $userName &> /dev/null; then grep \"^$userName\\>\" /etc/passwd | cut -d: -f3,7 else echo \"No such user.\" fi read -p \"Plz enter a username again: \" userName done while\u7279\u6b8a\u7528\u6cd5\uff1a\u904d\u5386\u6587\u672c\u6587\u4ef6 \u8bed\u53e5\u7ed3\u6784\uff1a while read \u53d8\u91cf\u540d; do \u5faa\u73af\u4f53 done < /path/to/somefile \u53d8\u91cf\u540d\uff0c\u6bcf\u5faa\u73af\u4e00\u6b21\uff0c\u8bb0\u5fc6\u4e86\u6587\u4ef6\u4e2d\u4e00\u884c\u6587\u672c \u4f8b\uff1a\u663e\u793aID\u53f7\u4e3a\u5076\u6570\uff0c\u4e14ID\u53f7\u540cGID\u7684\u7528\u6237\u7684\u7528\u6237\u540d\u3001ID\u548cSHELL while read line; do userID=`echo $line | cut -d: -f3` groupID=`echo $line | cut -d: -f4` if [ $[$userID%2] -eq 0 -a $userID -eq $groupID ]; then echo $line | cut -d: -f1,3,7 fi done < /etc/passwd \u5faa\u73af\u4e4buntil\u8bed\u53e5 \u8bed\u53e5\u7ed3\u6784\uff1a until \u6d4b\u8bd5\u6761\u4ef6; do \u5faa\u73af\u4f53 done \u6d4b\u8bd5\u6761\u4ef6\u4e3a\u5047\uff0c\u8fdb\u5165\u5faa\u73af\uff1b\u6d4b\u8bd5\u6761\u4ef6\u4e3a\u771f\uff0c\u9000\u51fa\u5faa\u73af \u4f8b\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u5076\u6570\u4e4b\u548c\uff0c\u8981\u6c42\u4f7f\u7528\u53d6\u6a21\u65b9\u6cd5\uff08until\u5b9e\u73b0\uff09 #!/bin/bash declare -i counter=1 declare -i sum=0 until [ $counter -gt 100 ]; do if [ $[$counter%2] -eq 0 ]; then let sum+=$counter fi let counter++ done echo $sum \u4f8b\uff1a\u63d0\u793a\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u7528\u6237\u540d\uff0c\u5982\u679c\u7528\u6237\u5b58\u5728\uff0c\u5c31\u663e\u793a\u7528\u6237\u7684ID\u53f7\u548cshell\uff1b\u5426\u5219\u663e\u793a\u7528\u6237\u4e0d\u5b58\u5728\uff1b\u663e\u793a\u5b8c\u6210\u4e4b\u540e\u4e0d\u9000\u51fa\uff0c\u518d\u6b21\u91cd\u590d\u524d\u9762\u7684\u64cd\u4f5c\uff0c\u76f4\u5230\u7528\u6237\u8f93\u5165q\u6216quit\u4e3a\u6b62\uff08until\u5b9e\u73b0\uff09 #!/bin/bash read -p \"Plz enter a username: \" userName until [ \"$userName\" = 'q' -a \"$userName\" = 'quit' ]; do if id $userName &> /dev/null; then grep \"^$userName\\>\" /etc/passwd | cut -d: -f3,7 else echo \"No such user.\" fi read -p \"Plz enter a username again: \" userName done \u5faa\u73af\u4e4b\u5faa\u73af\u63a7\u5236\u548cshift \u5faa\u73af\u63a7\u5236\u547d\u4ee4\uff1a break\uff1a\u63d0\u524d\u9000\u51fa\u5faa\u73af break [N]: \u9000\u51faN\u5c42\u5faa\u73af\uff1bN\u7701\u7565\u65f6\u8868\u793a\u9000\u51fabreak\u8bed\u53e5\u6240\u5728\u7684\u5faa\u73af continue: \u63d0\u524d\u7ed3\u675f\u672c\u8f6e\u5faa\u73af\uff0c\u800c\u76f4\u63a5\u8fdb\u5165\u4e0b\u8f6e\u5faa\u73af continue [N]\uff1a\u63d0\u524d\u7b2cN\u5c42\u7684\u5faa\u73af\u7684\u672c\u8f6e\u5faa\u73af\uff0c\u800c\u76f4\u63a5\u8fdb\u5165\u4e0b\u8f6e\u5faa\u73af \u6b7b\u5faa\u73af\uff1a #while\u4f53while true; do \u5faa\u73af\u4f53 done #until\u4f53 until false; do \u5faa\u73af\u4f53 done \u4f8b1\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u5224\u65ad\u7ed9\u5b9a\u7684\u7528\u6237\u662f\u5426\u767b\u5f55\u4e86\u5f53\u524d\u7cfb\u7edf (1) \u5982\u679c\u767b\u5f55\u4e86\uff0c\u5219\u811a\u672c\u7ec8\u6b62\uff1b (2) \u6bcf5\u79d2\u79cd\uff0c\u67e5\u770b\u4e00\u6b21\u7528\u6237\u662f\u5426\u767b\u5f55\uff1b #!/bin/bash while true; do who | grep \"gentoo\" &> /dev/null if [ $? -eq 0 ];then break fi sleep 5 done echo \"gentoo is logged.\" shift\uff1a \u5982\u679c\u6ca1\u6709\u6570\u5b57\uff0c\u53ea\u6709shift \u5c31\u662f\u8df3\u8fc7\u4e00\u4e2a\u53c2\u6570\u83b7\u53d6\u4e0b\u4e00\u4e2a\u53c2\u6570\uff0c\u5982\u679c\u52a0\u4e0a\u6570\u5b57\uff0c\u6bd4\u5982shift 2 \uff0c\u8df3\u8fc7\u4e24\u4e2a\u53c2\u6570\u83b7\u53d6\u4e0b\u4e00\u4e2a\u53c2\u6570\u3002 \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u4f7f\u7528\u5f62\u5f0f\u5982\u4e0b\u6240\u793a showifinfo.sh [-i INTERFACE|-a] [-v] \u8981\u6c42\uff1a 1\u3001-i\u6216-a\u4e0d\u53ef\u540c\u65f6\u4f7f\u7528\uff0c-i\u7528\u4e8e\u6307\u5b9a\u7279\u5b9a\u7f51\u5361\u63a5\u53e3\uff0c-a\u7528\u4e8e\u6307\u5b9a\u6240\u6709\u63a5\u53e3\uff1b \u663e\u793a\u63a5\u53e3\u7684ip\u5730\u5740 2\u3001\u4f7f\u7528-v\uff0c\u5219\u8868\u793a\u663e\u793a\u8be6\u7ec6\u4fe1\u606f\uff0c\u663e\u793a\u63a5\u53e3\u7684ip\u5730\u5740\u3001\u5b50\u7f51\u63a9\u7801\u3001\u5e7f\u64ad\u5730\u5740\uff1b 3\u3001\u9ed8\u8ba4\u8868\u793a\u4ec5\u4f7f\u7528-a\u9009\u9879; #!/bin/bash allinterface=0 ifflag=0 verbose=0 interface=0 if [ $# -eq 0 ];then ifconfig | grep \"inet addr:\" | awk '{print $2}' fi while [ $# -ge 1 ];do case $1 in -a) allinterface=1 shift 1 ;; -i) ifflag=1 interface=$2 shift 2 ;; -v) verbose=1 shift 1 ;; *) echo \"error option\" exit 2 ;; esac done if [ $allinterface -eq 1 ];then if [ $ifflag -eq 1 ];then echo \"command not found\" exit 5 fi if [ $verbose -eq 1 ];then ifconfig | grep \"inet addr:\" else ifconfig | grep \"inet addr:\" | awk '{print $2}' fi fi if [ $ifflag -eq 1 ];then if [ $allinterface -eq 1 ];then echo \"command not found\" exit 5 fi if [ $verbose -eq 1 ];then ifconfig $interface | grep \"inet addr:\" else ifconfig $interface | grep \"inet addr:\" | awk '{print $2}' fi fi bash\u7f16\u7a0b\u4e4b\u51fd\u6570 \u00b6 \u8bed\u6cd5\u7ed3\u6784\uff1a \u00b6 function F_NAME { \u51fd\u6570\u4f53 } F_NAME() { \u51fd\u6570\u4f53 } \u53ef\u8c03\u7528\uff1a\u4f7f\u7528\u51fd\u6570\u540d\uff0c\u51fd\u6570\u540d\u51fa\u73b0\u7684\u5730\u65b9\uff0c\u4f1a\u88ab\u81ea\u52a8\u66ff\u6362\u4e3a\u51fd\u6570 \u51fd\u6570\u7684\u8fd4\u56de\u503c\uff1a \u51fd\u6570\u7684\u6267\u884c\u7ed3\u679c\u8fd4\u56de\u503c\uff1a\u4ee3\u7801\u7684\u8f93\u51fa \u51fd\u6570\u4e2d\u4f7f\u7528\u6253\u5370\u8bed\u53e5\uff1aecho, printf \u51fd\u6570\u4e2d\u8c03\u7528\u7684\u7cfb\u7edf\u547d\u4ee4\u6267\u884c\u540e\u8fd4\u56de\u7684\u7ed3\u679c \u6267\u884c\u72b6\u6001\u8fd4\u56de\u503c\uff1a \u9ed8\u8ba4\u53d6\u51b3\u4e8e\u51fd\u6570\u4f53\u6267\u884c\u7684\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u72b6\u6001\u7ed3\u679c \u81ea\u5b9a\u4e49\u9000\u51fa\u72b6\u6001\u7801\uff1areturn [0-255] \u6ce8\u610f\uff1a\u51fd\u6570\u4f53\u8fd0\u884c\u65f6\uff0c\u4e00\u65e6\u9047\u5230return\u8bed\u53e5\uff0c\u51fd\u6570\u5373\u8fd4\u56de\uff1b \u51fd\u6570\u53ef\u4ee5\u63a5\u53d7\u53c2\u6570\uff1a \u5728\u51fd\u6570\u4f53\u4e2d\u8c03\u7528\u51fd\u6570\u53c2\u6570\u7684\u65b9\u5f0f\u540c\u811a\u672c\u4e2d\u8c03\u7528\u811a\u672c\u53c2\u6570\u7684\u65b9\u5f0f\uff1a \u4f4d\u7f6e\u53c2\u6570 $1, $2, \u2026 $#, $*, $@ \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u5b8c\u6210\u5982\u4e0b\u529f\u80fd(\u4f7f\u7528\u51fd\u6570)\uff1a 1\u3001\u63d0\u793a\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u53ef\u6267\u884c\u547d\u4ee4\uff1b 2\u3001\u83b7\u53d6\u8fd9\u4e2a\u547d\u4ee4\u6240\u4f9d\u8d56\u7684\u6240\u6709\u5e93\u6587\u4ef6(\u4f7f\u7528ldd\u547d\u4ee4)\uff1b 3\u3001\u590d\u5236\u547d\u4ee4\u81f3/mnt/sysroot/\u5bf9\u5e94\u7684\u76ee\u5f55\u4e2d \u89e3\u91ca\uff1a\u5047\u8bbe\uff0c\u5982\u679c\u590d\u5236\u7684\u662fcat\u547d\u4ee4\uff0c\u5176\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u8def\u5f84\u662f/bin/cat\uff0c\u90a3\u4e48\u5c31\u8981\u5c06/bin/cat\u590d\u5230/mnt/sysroot/bin/\u76ee\u5f55\u4e2d\uff0c\u5982\u679c\u590d\u5236\u7684\u662fuseradd\u547d\u4ee4\uff0c\u800cuseradd\u7684\u53ef\u6267\u884c\u6587\u4ef6\u8def\u5f84\u4e3a/usr/sbin/useradd\uff0c\u90a3\u4e48\u5c31\u8981\u5c06\u5176\u590d\u5236\u5230/mnt/sysroot/usr/sbin/\u76ee\u5f55\u4e2d\uff1b 4\u3001\u590d\u5236\u5404\u5e93\u6587\u4ef6\u81f3/mnt/sysroot/\u5bf9\u5e94\u7684\u76ee\u5f55\u4e2d\uff1b #!/bin/bash target=/mnt/sysroot/ [ -d $target ] || mkdir $target preCommand() { if which $1 &> /dev/null; then commandPath=`which --skip-alias $1` return 0 else echo \"No such command.\" return 1 fi } commandCopy() { commandDir=`dirname $1` [ -d ${target}${commandDir} ] || mkdir -p ${target}${commandDir} [ -f ${target}${commandPath} ] || cp $1 ${target}${commandDir} } libCopy() { for lib in `ldd $1 | egrep -o \"/[^[:space:]]+\"`; do libDir=`dirname $lib` [ -d ${target}${libDir} ] || mkdir -p ${target}${libDir} [ -f ${target}${lib} ] || cp $lib ${target}${libDir} done } read -p \"Plz enter a command: \" command until [ \"$command\" == 'quit' ]; do if preCommand $command &> /dev/null; then commandCopy $commandPath libCopy $commandPath fi read -p \"Plz enter a command: \" command done bash\u7f16\u7a0b\u4e4b\u4fe1\u53f7\u6355\u6349 \u00b6 trap\u547d\u4ee4\u7528\u4e8e\u5728shell\u7a0b\u5e8f\u4e2d\u6355\u6349\u5230\u4fe1\u53f7\uff0c\u4e4b\u540e\u53ef\u4ee5\u6709\u4e09\u79cd\u53cd\u5e94\u65b9\u5f0f\uff1a (1)\u6267\u884c\u4e00\u6bb5\u7a0b\u5e8f\u6765\u5904\u7406\u8fd9\u4e00\u4fe1\u53f7 (2)\u63a5\u53d7\u4fe1\u53f7\u7684\u9ed8\u8ba4\u64cd\u4f5c (3)\u5ffd\u89c6\u8fd9\u4e00\u4fe1\u53f7 trap\u5bf9\u4e0a\u9762\u4e09\u79cd\u65b9\u5f0f\u63d0\u4f9b\u4e86\u4e09\u79cd\u57fa\u672c\u5f62\u5f0f\uff1a \u7b2c\u4e00\u79cd\u5f62\u5f0f\u7684trap\u547d\u4ee4\u5728shell\u63a5\u6536\u5230signal list\u6e05\u5355\u4e2d\u6570\u503c\u76f8\u540c\u7684\u4fe1\u53f7\u65f6\uff0c\u5c06\u6267\u884c\u53cc\u5f15\u53f7\u4e2d\u7684\u547d\u4ee4\u4e32\u3002 trap 'commands' signal-list trap \"commands\" signal-list \u7b2c\u4e8c\u79cd\u5f62\u5f0f\u7684trap\u547d\u4ee4\u6062\u590d\u4fe1\u53f7\u7684\u9ed8\u8ba4\u64cd\u4f5c\uff1a trap signal-list \u7b2c\u4e09\u79cd\u5f62\u5f0f\u7684trap\u547d\u4ee4\u5141\u8bb8\u5ffd\u89c6\u4fe1\u53f7\uff1a trap \" \" signal-list trap 'COMMAND' SIGINT\uff08\u8868\u793a\u5173\u95ed\u8fdb\u7a0b\uff09 \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u80fd\u591fping\u63a2\u6d4b\u6307\u5b9a\u7f51\u7edc\u5185\u7684\u6240\u6709\u4e3b\u673a\u662f\u5426\u5728\u7ebf,\u5f53\u6ca1\u6709\u6267\u884c\u5b8c\u65f6\u53ef\u63a5\u6536ctrl+c\u547d\u4ee4\u9000\u51fa\u3002 #!/bin/bash quitScript() { echo \"Quit...\" } trap 'quitScript; exit 5' SIGINT cnetPing() { for i in {1..254}; do if ping -c 1 -W 1 $1.$i &> /dev/null; then echo \"$1.$i is up.\" else echo \"$1.$i is down.\" fi done } bnetPing() { for j in {0..255}; do cnetPing $1.$j done } anetPing() { for m in {0..255}; do bnetPing $1.$m done } netType=`echo $1 | cut -d\".\" -f1` if [ $netType -ge 1 -a $netType -le 126 ]; then anetPing $netType elif [ $netType -ge 128 -a $netType -le 191 ]; then bnetPing $(echo $1 | cut -d'.' -f1,2) elif [ $netType -ge 192 -a $netType -le 223 ]; then cnetPing $(echo $1 | cut -d'.' -f1-3) else echo \"Wrong\" exit 2 fi bash\u7f16\u7a0b\u4e4b\u6570\u7ec4 \u00b6 \u6570\u7ec4 \uff1a\u8fde\u7eed\u7684\u591a\u4e2a\u72ec\u7acb\u5185\u5b58\u7a7a\u95f4\uff0c\u6bcf\u4e2a\u5185\u5b58\u7a7a\u95f4\u76f8\u5f53\u4e8e\u4e00\u4e2a\u53d8\u91cf \u6570\u7ec4\u5143\u7d20 \uff1a\u6570\u7ec4\u540d+\u7d22\u5f15\uff08\u4ece0\u5f00\u59cb\u7f16\u53f7\uff09 \u7d22\u5f15\u7684\u8868\u793a\u65b9\u5f0f \uff1aa[0], a[1] \u58f0\u660e\u6570\u7ec4 \uff1a declare -a ARRAR_NAME \u5173\u8054\u6570\u7ec4 \uff1a declare -A ARRAY_NAME \u652f\u6301\u7a00\u758f\u683c\u5f0f\uff1a\u4ec5\u4e00\u7ef4\u6570\u7ec4 \u6570\u7ec4\u5143\u7d20\u7684\u8d4b\u503c\uff1a (1) \u4e00\u6b21\u53ea\u8d4b\u503c\u4e00\u4e2a\u5143\u7d20 a[0]=$RANDOM (2) \u4e00\u6b21\u8d4b\u503c\u5168\u90e8\u5143\u7d20 a=(red blue yellow green) (3) \u6307\u5b9a\u7d22\u5f15\u8fdb\u884c\u8d4b\u503c a=([0]=green [3]=red [2]=blue [6]=yellow) (4) \u7528\u6237\u8f93\u5165 read -a ARRAY \u6570\u7ec4\u7684\u8bbf\u95ee \uff1a \u7528\u7d22\u5f15\u8bbf\u95ee \uff1a ARRAY[index] \u6570\u7ec4\u7684\u957f\u5ea6 \uff1a ${#ARRAY[*]} ${#ARRAY[@]} \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u751f\u621010\u4e2a\u968f\u673a\u6570\uff0c\u4fdd\u5b58\u81f3\u6570\u7ec4\u4e2d\uff1b\u800c\u540e\u663e\u793a\u6570\u7ec4\u4e0b\u6807\u4e3a\u5076\u6570\u7684\u5143\u7d20 #\uff01/bin/bash for i in {0..9}; do rand[$i]=$RANDOM [ $[$i%2] -eq 0 ] && echo \"$i:${rand[$i]}\" done \u4ece\u6570\u7ec4\u4e2d\u6311\u9009\u67d0\u5143\u7d20 : ${ARRAY[@]:offset:number} \u5207\u7247 \uff1a offset: \u504f\u79fb\u7684\u5143\u7d20\u4e2a\u6570 number: \u53d6\u51fa\u7684\u5143\u7d20\u7684\u4e2a\u6570 ${ARRAY[@]:offset}\uff1a\u53d6\u51fa\u504f\u79fb\u91cf\u540e\u7684\u6240\u6709\u5143\u7d20 ${ARRAY[@]}: \u53d6\u51fa\u6240\u6709\u5143\u7d20 \u6570\u7ec4\u590d\u5236 \uff1a\u8981\u4f7f\u7528${ARRAY[@]} $@: \u6bcf\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u4e32 $*: \u6240\u6709\u53c2\u6570\u662f\u4e00\u4e2a\u4e32 \u5411\u6570\u7ec4\u4e2d\u8ffd\u52a0\u5143\u7d20 \uff1a\u975e\u7a00\u758f\u683c\u5f0f week, week[${#week[@]}] \u4ece\u6570\u7ec4\u4e2d\u5220\u9664\u5143\u7d20 \uff1a unset ARRAY[index] \u4f8b\uff1a\u590d\u5236\u4e00\u4e2a\u6570\u7ec4\u4e2d\u4e0b\u6807\u4e3a\u5076\u6570\u7684\u5143\u7d20\u81f3\u4e00\u4e2a\u65b0\u6570\u7ec4\u4e2d #!/bin/bash declare -a mylogs logs=(/var/log/*.log) echo ${logs[@]} for i in `seq 0 ${#logs[@]}`; do if [ $[$i%2] -eq 0 ];then index=${#mylogs[@]} mylogs[$index]=${logs[$i]} fi done echo ${mylogs[@]} \u4f8b2\uff1a\u751f\u621010\u4e2a\u968f\u673a\u6570\uff0c\u5347\u5e8f\u6392\u5e8f #!/bin/bash for((i=0;i<10;i++)) do rnd[$i]=$RANDOM done echo -e \"total=${#rnd[@]}\\n${rnd[@]}\\nBegin to sort\" for((i=9;i>=1;i--)) do for((j=0;j<i;j++)) do if [ ${rnd[$j]} -gt ${rnd[$[$j+1]]} ] ;then swapValue=${rnd[$j]} rnd[$j]=${rnd[$[$j+1]]} rnd[$[$j+1]]=$swapValue fi done done echo ${rnd[@]} \u4f8b3\uff1a\u6253\u5370\u4e5d\u4e5d\u4e58\u6cd5\u8868 #!/bin/bashfor((i=1;i<=9;i++)) do strLine=\"\" for((j=1;i<=9;j++)) do strLine=$strLine\"$i*$j=\"$[$i*$j]\"\\t\" [ $i -eq $j ] && echo -e $strLine && break done done bash\u7f16\u7a0b\u4e4b\u5b57\u7b26\u4e32\u64cd\u4f5c \u00b6 \u5b57\u7b26\u4e32\u5207\u7247 \uff1a ${string:offset:length} [root@scholar scripts]# string='hello word' [root@scholar scripts]# echo ${string:2:4} llo \u53d6\u5c3e\u90e8\u7684\u6307\u5b9a\u4e2a\u6570\u7684\u5b57\u7b26\uff1a ${string: -length} [root@scholar scripts]# echo ${string: -2} rd \u53d6\u5b50\u4e32 \uff1a\u57fa\u4e8e\u6a21\u5f0f ${variable#*word} \uff1a\u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u5de6\u800c\u53f3\uff0c\u67e5\u627e\u7b2c\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u5b57\u7b26\u5f00\u59cb\u81f3\u6b64word\u5904\u7684\u6240\u6709\u5185\u5bb9\uff1b $ {variable##*word} \uff1a\u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u5de6\u800c\u53f3\uff0c\u67e5\u627e\u6700\u540e\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u5b57\u7b26\u5f00\u59cb\u81f3\u6b64word\u5904\u7684\u6240\u6709\u5185\u5bb9\uff1b file='/var/log/messages' ${file#*/}: \u8fd4\u56de\u7684\u7ed3\u679c\u662fvar/log/messages ${file##*/}: \u8fd4\u56demessages ${variable%word*} : \u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u53f3\u800c\u5de6\uff0c\u67e5\u627e\u7b2c\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u6b64word\u5904\u81f3\u5b57\u4e32\u5c3e\u90e8\u7684\u6240\u6709\u5185\u5bb9\uff1b ${variable%%world*} :\u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u53f3\u800c\u5de6\uff0c\u67e5\u627e\u6700\u540e\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u6b64word\u5904\u81f3\u5b57\u4e32\u5c3e\u90e8\u7684\u6240\u6709\u5185\u5bb9\uff1b file='/var/log/messages' ${file%*/}: \u8fd4\u56de\u7684\u7ed3\u679c\u662f/var/log ${file%%*/}: \u8fd4\u56de\u7ed3\u679c\u4e3a\u7a7a \u4f8b\uff1aurl=\"http://www.redhat.com:80\" \u53d6\u7aef\u53e3\uff1a${url##*:} \u53d6\u534f\u8bae\uff1a${url%%:*} \u67e5\u627e\u66ff\u6362 \uff1a ${variable/pattern/substi} : \u66ff\u6362\u7b2c\u4e00\u6b21\u51fa\u73b0 #userinfo=`tail -1 /etc/passwd #echo $userinfo scholar:x:500:500:scholar:/home/scholar:/bin/bash #echo ${userinfo/scholar/redhat} redhat:x:500:500:scholar:/home/scholar:/bin/bash ${variable//pattern/substi} \uff1a\u66ff\u6362\u6240\u6709\u7684\u51fa\u73b0 #echo ${userinfo//scholar/redhat} redhat:x:500:500:redhat:/home/redhat:/bin/bash ${variable/#pattern/substi} \uff1a\u66ff\u6362\u884c\u9996\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9 #echo ${userinfo/#scholar/redhat} redhat:x:500:500:scholar:/home/scholar:/bin/bash ${variable/%pattern/substi} \uff1a\u66ff\u6362\u884c\u5c3e\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9 #echo ${userinfo/%bash/redhat} scholar:x:500:500:scholar:/home/scholar:/bin/redhat pattern\u53ef\u4ee5\u4f7f\u7528globbing\u4e2d\u7684\u5143\u5b57\u7b26\uff1a * \uff1f \u00b6 \u67e5\u627e\u5220\u9664 \uff1a ${variable/pattern} \uff1a\u5220\u9664\u7b2c\u4e00\u6b21\u51fa\u73b0 #echo ${userinfo/scholar} :x:500:500:scholar:/home/scholar:/bin/bash ${variable//pattern} \uff1a\u5220\u9664\u6240\u6709\u7684\u51fa\u73b0 #echo ${userinfo//scholar} :x:500:500::/home/:/bin/bash ${variable/#pattern} \uff1a\u5220\u9664\u884c\u9996\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9 #echo ${userinfo/#scholar} :x:500:500:scholar:/home/scholar:/bin/bash ${variable/%pattern} \uff1a\u5220\u9664\u884c\u5c3e\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9 #echo ${userinfo/%bash} scholar:x:500:500:scholar:/home/scholar:/bin/ \u5927\u5c0f\u5199\u8f6c\u6362 \uff1a \u5c0f\u2013>\u5927\uff1a ${variable^^} #echo ${userinfo^^} SCHOLAR:X:500:500:SCHOLAR:/HOME/SCHOLAR:/BIN/BASH \u5927\u2013>\u5c0f\uff1a ${variable,,} #name=\"SCHOLAR\" #echo ${name,,} scholar \u53d8\u91cf\u8d4b\u503c\u64cd\u4f5c\uff1a \u00b6 ${variable:-string} :variable\u4e3a\u7a7a\u6216\u672a\u8bbe\u5b9a\uff0c\u90a3\u4e48\u8fd4\u56destring\uff0c\u5426\u5219\uff0c\u8fd4\u56devariable\u53d8\u91cf\u7684\u503c\uff1b ${variable:=string} :variable\u4e3a\u7a7a\u6216\u672a\u8bbe\u5b9a\uff0c\u5219\u8fd4\u56destring\uff0c\u4e14\u5c06string\u8d4b\u503c\u7ed9\u53d8\u91cfvariable\uff0c\u5426\u5219\uff0c\u8fd4\u56devariable\u7684\u503c\uff1b \u4e3a\u811a\u672c\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u786e\u4fdd\u67d0\u53d8\u91cf\u6709\u53ef\u7528\u503c\u7684\u65b9\u5f0f variable=${variable:-default vaule} \u5199\u4e2a\u811a\u672c\uff0c\u914d\u7f6eetc\u76ee\u5f55\uff1b (1) \u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5b9a\u4e49\u53d8\u91cf\uff1b (2) \u5728\u811a\u672c\u4e2dsource\u914d\u7f6e\u6587\u4ef6\uff1b #!/bin/bash [ -f /etc/sysconfig/network ] && source /etc/network/network [-z \"$HOSTAME\" -o \"$HOSTNAME\" = '(none)' ] || HOSTNAME ='localhost' /bin/hostname $HOSTNAME /bin/hostname mktemp\u547d\u4ee4\uff1a \u00b6 mktemp [OPTIONS] filename.XXX -d: \u521b\u5efa\u4e34\u65f6\u76ee\u5f55 --tmpdir=/path/to/somewhere \uff1a\u6307\u5b9a\u4e34\u65f6\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55 mktemp /tmp/tmp.XXX #XXX\u751f\u6210\u76f8\u540c\u6570\u91cf\u968f\u673a\u5b57\u7b26 mktemp --tmpdir=/var/tmp tmp.XXX #\u6307\u5b9a\u76ee\u5f55\u521b\u5efa\u4e34\u65f6\u6587\u4ef6 mktemp --tmpdir=/var/tmp -d tmp.XXX #\u6307\u5b9a\u76ee\u5f55\u521b\u5efa\u4e34\u65f6\u76ee\u5f55 install\u547d\u4ee4: \u00b6 install [OPTIONS] SOURCE DEST install [OPTIONS] SOURCE\u2026 DIR install [OPTIONS] -d DIR \u2026 \u589e\u5f3a\u578b\u7684\u590d\u5236\u547d\u4ee4\uff1a -o OWNER -g GROUP -m MODE -d : \u521b\u5efa\u76ee\u5f55 install /etc/fstab /tmp #\u590d\u5236\u6587\u4ef6\u5230\u6307\u5b9a\u76ee\u5f55 install --mode=644 /etc/fstab /tmp/ #\u590d\u5236\u65f6\u6307\u5b9a\u6743\u9650 install --owner=scholar /etc/fstab /tmp #\u590d\u5236\u65f6\u6307\u5b9a\u5c5e\u4e3b install --group=scholar /etc/fstab /tmp #\u590d\u5236\u65f6\u6307\u5b9a\u5c5e\u7ec4 install -d /tmp/install #\u521b\u5efa\u76ee\u5f55","title":"Bash\u7f16\u7a0b\u8d85\u8be6\u7ec6\u8bed\u6cd5\u603b\u7ed3"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash","text":"","title":"bash\u7f16\u7a0b\u4e4b\u53d8\u91cf"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_1","text":"\u672c\u5730\u53d8\u91cf : \u53ea\u5bf9\u5f53\u524dshell\u8fdb\u7a0b\u6709\u6548\u7684\u53d8\u91cf\uff0c\u5bf9\u5176\u5b83shell\u8fdb\u7a0b\u65e0\u6548\uff0c\u5305\u5f53\u524dshell\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b VAR_NAME=VALUE \u53d8\u91cf\u8d4b\u503c : \u5411\u53d8\u91cf\u7684\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58\u6570\u636e \u53d8\u91cf\u5f15\u7528 : ${VAR_NAME} \"\":\u5f31\u5f15\u7528\uff0c\u91cc\u9762\u7684\u53d8\u91cf\u4f1a\u88ab\u66ff\u6362 '':\u5f3a\u5f15\u7528\uff0c\u91cc\u9762\u7684\u6240\u6709\u5b57\u7b26\u90fd\u662f\u5b57\u9762\u91cf\uff0c\u76f4\u63a5\u8f93\u51fa \u73af\u5883\u53d8\u91cf : \u5bf9\u5f53\u524dshell\u8fdb\u7a0b\u53ca\u5176\u5b50shell\u6709\u6548\uff0c\u5bf9\u5176\u5b83\u7684shell\u8fdb\u7a0b\u65e0\u6548 \u5b9a\u4e49\uff1aexport VAR_NAME=VALUE \u5bfc\u51fa\uff1aexport VAR_NAME \u64a4\u6d88\u53d8\u91cf\uff1aunset VAR_NAME \u53ea\u8bfb\u53d8\u91cf\uff1areadonly VAR_NAME \u5c40\u90e8\u53d8\u91cf : \u5bf9shell\u811a\u672c\u4e2d\u67d0\u4ee3\u7801\u7247\u65ad\u6709\u6548\uff0c\u901a\u5e38\u7528\u4e8e\u51fd\u6570\u672c\u5730 local VAR_NAME=VALUE \u4f4d\u7f6e\u53d8\u91cf : \u7528\u6765\u63a5\u53d7\u53d8\u91cf\u6307\u5b9a\u4f4d\u7f6e\u7684\u53c2\u6570 $1,$2...,${10} \u7279\u6b8a\u53d8\u91cf : shell\u5bf9\u4e00\u4e9b\u53c2\u6570\u505a\u7279\u6b8a\u5904\u7406,\u8fd9\u4e9b\u53c2\u6570\u53ea\u80fd\u88ab\u5f15\u7528\u800c\u4e0d\u80fd\u88ab\u8d4b\u503c $# \u4f20\u9012\u5230\u811a\u672c\u7684\u53c2\u6570\u4e2a\u6570 $* \u663e\u793a\u6240\u6709\u5411\u811a\u672c\u4f20\u9012\u7684\u53c2\u6570 #\u4e0e\u4f4d\u7f6e\u53d8\u91cf\u4e0d\u540c\uff0c\u6b64\u9009\u9879\u53c2\u6570\u53ef\u8d85\u8fc79\u4e2a $$ \u83b7\u53d6\u5f53\u524dshell\u7684\u8fdb\u7a0b\u53f7 $! \u6267\u884c\u4e0a\u4e00\u4e2a\u6307\u4ee4\u7684\u8fdb\u7a0b\u53f7 $? \u83b7\u53d6\u6267\u884c\u7684\u4e0a\u4e00\u4e2a\u6307\u4ee4\u7684\u8fd4\u56de\u503c #0\u4e3a\u6267\u884c\u6210\u529f\uff0c\u975e\u96f6\u4e3a\u6267\u884c\u5931\u8d25 $- \u663e\u793ashell\u4f7f\u7528\u7684\u5f53\u524d\u9009\u9879\uff0c\u4e0eset\u547d\u4ee4\u529f\u80fd\u76f8\u540c $@ \u4e0e$*\u76f8\u540c\uff0c\u4f46\u662f\u4f7f\u7528\u65f6\u52a0\u5f15\u53f7\uff0c\u5e76\u5728\u5f15\u53f7\u4e2d\u8fd4\u56de\u6bcf\u4e2a\u53c2\u6570 \u67e5\u770b\u53d8\u91cf : set\uff1a\u67e5\u770b\u5f53\u524dshell\u8fdb\u7a0b\u4e2d\u7684\u6240\u6709\u53d8\u91cf export, printenv, env\uff1a\u67e5\u770b\u5f53\u524dshell\u8fdb\u7a0b\u4e2d\u7684\u6240\u6709\u73af\u5883\u53d8\u91cf \u53d8\u91cf\u547d\u540d : 1. \u4e0d\u80fd\u4f7f\u7528\u7a0b\u5e8f\u4e2d\u7684\u5173\u952e\u5b57\uff08\u4fdd\u7559\u5b57\uff09 2. \u53ea\u80fd\u4f7f\u7528\u6570\u5b57\u3001\u5b57\u6bcd\u548c\u4e0b\u5212\u7ebf\uff0c\u4e14\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934 3. \u8981\u89c1\u540d\u77e5\u4e49 \u53d8\u91cf\u7c7b\u578b : \u6570\u503c\u578b\uff1a\u7cbe\u786e\u6570\u503c(\u6574\u6570)\uff0c\u8fd1\u4f3c\u6570\u503c\uff08\u6d6e\u70b9\u578b\uff09 \u5b57\u7b26\u578b\uff1achar,string \u5e03\u5c14\u578b\uff1atrue, false \u7c7b\u578b\u8f6c\u6362 : \u663e\u5f0f\u8f6c\u6362 \u9690\u5f0f\u8f6c\u6362","title":"bash\u53d8\u91cf\u7c7b\u522b"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_2","text":"","title":"bash\u7684\u914d\u7f6e\u6587\u4ef6\uff1a"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#_1","text":"profile\u7c7b\uff1a\u4e3a\u4ea4\u4e92\u5f0f\u767b\u5f55\u7684\u7528\u6237\u63d0\u4f9b\u914d\u7f6e \u5168\u5c40\uff1a/etc/profile\u3001/etc/profile.d/*.sh \u7528\u6237\uff1a~/.bash_profile bashrc\u7c7b\uff1a\u4e3a\u975e\u4ea4\u4e92\u5f0f\u7684\u7528\u6237\u63d0\u4f9b\u914d\u7f6e \u5168\u5c40\uff1a/etc/bashrc \u7528\u6237\uff1a~/.bashrc","title":"\u529f\u80fd\uff1a\u8bbe\u5b9a\u672c\u5730\u53d8\u91cf\uff0c\u5b9a\u4e49\u547d\u4ee4\u522b\u540d"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_3","text":"\u7f16\u5199\u683c\u5f0f\uff1ashell\u811a\u672c\u7b2c\u4e00\u884c\u5fc5\u987b\u9876\u683c\u5199\uff0c\u7528shebang\u5b9a\u4e49\u6307\u5b9a\u7684\u89e3\u91ca\u5668\u6765\u89e3\u91ca\u8be5\u811a\u672c\u3002 #!/bin/bash #!\u5373\u4e3ashebang # \u5176\u5b83\u7684\u4ee5#\u5f00\u5934\u7684\u884c\u5747\u4e3a\u6ce8\u91ca\uff0c\u4f1a\u88ab\u89e3\u91ca\u5668\u5ffd\u7565\uff0c\u53ef\u7528\u6765\u6ce8\u91ca\u811a\u672c\u7528\u9014\u53ca\u7248\u672c\uff0c\u65b9\u4fbf\u4f7f\u7528\u7ba1\u7406\u3002 \u6267\u884c\u65b9\u5f0f\uff1abash\u7f16\u7a0b\u5c5e\u4e8e\u9762\u5411\u8fc7\u7a0b\u7f16\u7a0b\uff0c\u6267\u884c\u65b9\u5f0f\u5982\u4e0b\uff1a \u987a\u5e8f\u6267\u884c\uff1a\u6309\u547d\u4ee4\u5148\u540e\u987a\u5bfb\u4f9d\u6b21\u6267\u884c \u9009\u62e9\u6267\u884c\uff1a\u6d4b\u8bd5\u6761\u4ef6\uff0c\u53ef\u80fd\u4f1a\u591a\u4e2a\u6d4b\u8bd5\u6761\u4ef6\uff0c\u67d0\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0c\u5219\u6267\u884c\u5bf9\u5e94\u7684\u5206\u652f \u5faa\u73af\u6267\u884c\uff1a\u5c06\u540c\u4e00\u6bb5\u4ee3\u7801\u53cd\u590d\u6267\u884c\u591a\u6b21\uff0c\u56e0\u6b64\uff0c\u5faa\u73af\u5fc5\u987b\u6709\u9000\u51fa\u6761\u4ef6\uff1b\u5426\u5219\uff0c\u5219\u9677\u5165\u6b7b\u5faa\u73af bash\u6267\u884c\u9009\u9879\uff1a bash -n SHELLNAME #\u8bed\u6cd5\u6d4b\u8bd5\uff0c\u6d4b\u8bd5\u662f\u5426\u5b58\u5728\u8bed\u6cd5\u9519\u8bef bash -x SHELLNAME #\u6a21\u62df\u5355\u6b65\u6267\u884c\uff0c\u663e\u793a\u6bcf\u4e00\u6b65\u6267\u884c\u8fc7\u7a0b","title":"bash\u7f16\u7a0b\u4e4b\u7f16\u5199\u683c\u5f0f\u53ca\u6267\u884c\u65b9\u5f0f"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_4","text":"\u7b97\u6570\u8fd0\u7b97 \u5b9a\u4e49\u6574\u578b\u53d8\u91cf\uff1a let VAR_NAME=INTEGER_VALUE #\u4f8b\u5982\uff1alet a=3 declare -i VAR_NAME=INTEGER_VALUE #declare -i a=3 \u5b9e\u73b0\u7b97\u672f\u8fd0\u7b97\u7684\u65b9\u5f0f\uff1a let VAR_NAME=ARITHMATIC_EXPRESSION VAR_NAME=$[ARITHMATIC_EXRESSION] VAR_NAME=$((EXPRESSION)) VAR_NAME=$(expr $num1 + $num2) \u7b97\u672f\u8fd0\u7b97\u7b26\uff1a +\uff1a\u52a0\u6cd5 -\uff1a\u51cf\u6cd5 *\uff1a\u4e58\u6cd5 /\uff1a\u6574\u9664 %\uff1a\u53d6\u4f59\u6570 **\uff1a\u4e58\u5e42 \u6ce8\u610f\uff1a\u5373\u4f7f\u6ca1\u6709\u5b9a\u4e49\u4e3a\u6574\u578b\u53d8\u91cf\uff0c\u5b57\u7b26\u578b\u7684\u6570\u5b57\u4f9d\u7136\u53ef\u4ee5\u53c2\u4e0e\u7b97\u672f\u8fd0\u7b97\uff0cbash\u4f1a\u6267\u884c\u53d8\u91cf\u7c7b\u578b\u7684\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\u3002 - \u903b\u8f91\u8fd0\u7b97 \u5e03\u5c14\u8fd0\u7b97\uff1a\u771f\uff0c\u5047 \u4e0e\u8fd0\u7b97\uff1a\u771f && \u771f = \u771f \u771f && \u5047 = \u5047 \u5047 && \u771f = \u5047 \u5047 && \u5047 = \u5047 \u6216\u8fd0\u7b97\uff1a\u771f || \u771f = \u771f \u771f || \u5047 = \u771f \u5047 || \u771f = \u771f \u5047 || \u5047 = \u5047 \u975e\u8fd0\u7b97\uff1a\uff01\u771f=\u5047 \uff01\u5047=\u771f","title":"bash\u4e4b\u7b97\u6570\u8fd0\u7b97\u4e0e\u903b\u8f91\u8fd0\u7b97"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_5","text":"","title":"bash\u7f16\u7a0b\u4e4b\u6761\u4ef6\u6d4b\u8bd5\u8bed\u53e5"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_6","text":"\u6574\u578b\u6d4b\u8bd5 \uff1a\u6574\u6570\u6bd4\u8f83 \u4f8b\u5982 [ $num1 -gt $num2 ] -gt: \u5927\u4e8e\u5219\u4e3a\u771f -lt: \u5c0f\u4e8e\u5219\u4e3a\u771f -ge: \u5927\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f -le: \u5c0f\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f -eq: \u7b49\u4e8e\u5219\u4e3a\u771f -ne: \u4e0d\u7b49\u4e8e\u5219\u4e3a\u771f \u5b57\u7b26\u6d4b\u8bd5 \uff1a\u5b57\u7b26\u4e32\u6bd4\u8f83 \u53cc\u76ee\uff1a \u4f8b\u5982[[ \"$str1\" > \"$str2\" ]] >: \u5927\u4e8e\u5219\u4e3a\u771f <: \u5c0f\u4e8e\u5219\u4e3a\u771f >=\uff1a\u5927\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f <=\uff1a\u5c0f\u4e8e\u7b49\u4e8e\u5219\u4e3a\u771f ==\uff1a\u7b49\u4e8e\u5219\u4e3a\u771f !=\uff1a\u4e0d\u7b49\u4e8e\u5219\u4e3a\u771f \u5355\u76ee\uff1a -n String: \u662f\u5426\u4e0d\u7a7a\uff0c\u4e0d\u7a7a\u5219\u4e3a\u771f\uff0c\u7a7a\u5219\u4e3a\u5047 -z String: \u662f\u5426\u4e3a\u7a7a\uff0c\u7a7a\u5219\u4e3a\u771f\uff0c\u4e0d\u7a7a\u5219\u5047 \u6587\u4ef6\u6d4b\u8bd5\uff1a\u5224\u65ad\u6587\u4ef6\u7684\u5b58\u5728\u6027\u53ca\u5c5e\u6027\u7b49 -a FILE\uff1a\u5b58\u5728\u5219\u4e3a\u771f\uff1b\u5426\u5219\u5219\u4e3a\u5047\uff1b -e FILE: \u5b58\u5728\u5219\u4e3a\u771f\uff1b\u5426\u5219\u5219\u4e3a\u5047\uff1b -f FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u666e\u901a\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b -d FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u76ee\u5f55\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b -L/-h FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u7b26\u53f7\u94fe\u63a5\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b -b: \u5b58\u5728\u5e76\u4e14\u4e3a\u5757\u8bbe\u5907\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047\uff1b -c: \u5b58\u5728\u5e76\u4e14\u4e3a\u5b57\u7b26\u8bbe\u5907\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047 -S: \u5b58\u5728\u5e76\u4e14\u4e3a\u5957\u63a5\u5b57\u6587\u4ef6\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047 -p: \u5b58\u5728\u5e76\u4e14\u4e3a\u547d\u540d\u7ba1\u9053\uff0c\u5219\u4e3a\u771f\uff1b\u5426\u5219\u4e3a\u5047 -s FILE: \u5b58\u5728\u5e76\u4e14\u4e3a\u975e\u7a7a\u6587\u4ef6\u5219\u4e3a\u503c\uff0c\u5426\u5219\u4e3a\u5047\uff1b -r FILE\uff1a\u6587\u4ef6\u53ef\u8bfb\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047 -w FILE\uff1a\u6587\u4ef6\u53ef\u5199\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047 -x FILE\uff1a\u6587\u4ef6\u53ef\u6267\u884c\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047 file1 -nt file2: file1\u7684mtime\u65b0\u4e8efile2\u5219\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047\uff1b file1 -ot file2\uff1afile1\u7684mtime\u65e7\u4e8efile2\u5219\u4e3a\u771f\uff0c\u5426\u5219\u4e3a\u5047\uff1b \u7ec4\u5408\u6761\u4ef6\u6d4b\u8bd5\uff1a\u5728\u591a\u4e2a\u6761\u4ef6\u95f4\u5b9e\u73b0\u903b\u8f91\u8fd0\u7b97 \u4e0e\uff1a[ condition1 -a condition2 ] condition1 && condition2 \u6216\uff1a[ condition1 -o condition2 ] condition1 || condition2 \u975e\uff1a[ -not condition ] ! condition \u4e0e\uff1aCOMMAND1 && COMMAND2 COMMAND1\u5982\u679c\u4e3a\u5047\uff0c\u5219COMMAND2\u4e0d\u6267\u884c \u6216\uff1aCOMMAND1 || COMMAND2 COMMAND1\u5982\u679c\u4e3a\u771f\uff0c\u5219COMMAND2\u4e0d\u6267\u884c \u975e\uff1a! COMMAND \u6761\u4ef6\u6d4b\u8bd5\u4e4bif\u8bed\u53e5 1\u3001if\u8bed\u53e5\u4e4b\u5355\u5206\u652f \u8bed\u53e5\u7ed3\u6784\uff1a if \u6d4b\u8bd5\u6761\u4ef6;then \u9009\u62e9\u5206\u652f fi \u8868\u793a\u6761\u4ef6\u6d4b\u8bd5\u72b6\u6001\u8fd4\u56de\u503c\u4e3a\u503c\uff0c\u5219\u6267\u884c\u9009\u62e9\u5206\u652f \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u662f\u7528\u6237\u540d\uff1b\u5982\u679c\u6b64\u7528\u6237\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\u8be5\u7528\u6237\uff1b #\uff01/bin/bash if ! id $1 &> /dev/null;then useradd $1 fi 2\u3001if\u8bed\u53e5\u4e4b\u53cc\u5206\u652f \u8bed\u53e5\u7ed3\u6784\uff1a if \u6d4b\u8bd5\u6761\u4ef6;then \u9009\u62e9\u5206\u652f1 else \u9009\u62e9\u5206\u652f2 fi \u4e24\u4e2a\u5206\u652f\u4ec5\u6267\u884c\u5176\u4e2d\u4e4b\u4e00 \u4f8b\uff1a\u901a\u8fc7\u547d\u4ee4\u884c\u7ed9\u5b9a\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\uff0c\u800c\u540e\u5224\u65ad\uff1a\u5982\u679c\u6b64\u6587\u4ef6\u4e2d\u5b58\u5728\u7a7a\u767d\u884c\uff0c\u5219\u663e\u793a\u5176\u7a7a\u767d\u884c\u7684\u603b\u6570\uff1b\u5426\u5219\uff0c\u5219\u663e\u793a\u65e0\u7a7a\u767d\u884c\uff1b #\uff01/bin/bash if grep \"^[[:space]]*$\" $1 &> /dev/null; then echo \"$1 has $(grep \"^[[:space]]*$\" $1 | wc -l) blank lines.\" else echo \"No blank lines\" fi \u6ce8\u610f\uff1a\u5982\u679c\u628a\u547d\u4ee4\u6267\u884c\u6210\u529f\u4e0e\u5426\u5f53\u4f5c\u6761\u4ef6\uff0c\u5219if\u8bed\u53e5\u540e\u5fc5\u987b\u53ea\u8ddf\u547d\u4ee4\u672c\u8eab\uff0c\u800c\u4e0d\u80fd\u5f15\u7528\u3002 3\u3001if\u8bed\u53e5\u4e4b\u591a\u5206\u652f \u8bed\u53e5\u7ed3\u6784\uff1a if \u6761\u4ef61;then \u5206\u652f1 elif \u6761\u4ef62;then \u5206\u652f2 elif \u6761\u4ef63;then \u5206\u652f3 ... else \u5206\u652fn fi \u4f8b\uff1a\u4f20\u9012\u4e00\u4e2a\u7528\u6237\u540d\u7ed9\u811a\u672c\uff1a\u5982\u679c\u6b64\u7528\u6237\u7684id\u53f7\u4e3a0\uff0c\u5219\u663e\u793a\u8bf4\u8fd9\u662f\u7ba1\u7406\u5458\uff1b\u5982\u679c\u6b64\u7528\u6237\u7684id\u53f7\u5927\u4e8e\u7b49\u4e8e500\uff0c\u5219\u663e\u793a\u8bf4\u8fd9\u662f\u666e\u901a\u7528\u6237\uff1b\u5426\u5219\uff0c\u5219\u8bf4\u8fd9\u662f\u7cfb\u7edf\u7528\u6237\u3002 #!/bin/bash if [ $# -lt 1 ]; then echo \"Usage: `basename $0` username\" exit 1 fi if ! id -u $1 &> /dev/null; then echo \"Usage: `basename $0` username\" echo \"No this user $1.\" exit 2 fi if [ $(id -u $1) -eq 0 ]; then echo \"Admin\" elif [ $(id -u $1) -ge 500 ]; then echo \"Common user.\" else echo \"System user.\" fi bash\u4ea4\u4e92\u5f0f\u7f16\u7a0b read [option] \u201cprompt\u201d-p:\u76f4\u63a5\u6307\u5b9a\u4e00\u4e2a\u53d8\u91cf\u63a5\u53d7\u53c2\u6570 -t timaout\uff1a\u6307\u5b9a\u7b49\u5f85\u63a5\u53d7\u53c2\u6570\u7684\u65f6\u95f4 -n:\u8868\u793a\u4e0d\u6362\u884c \u4f8b\uff1a\u8f93\u5165\u7528\u6237\u540d\uff0c\u53ef\u8fd4\u56de\u5176shell #!/bin/bash read -p \"Plz input a username: \" userName if id $userName &> /dev/null; then echo \"The shell of $userName is `grep \"^$userName\\>\" /etc/passwd | cut -d: -f7`.\" else echo \"No such user. stupid.\" fi \u6761\u4ef6\u6d4b\u8bd5\u4e4bcase\u8bed\u53e5 case\u8bed\u53e5\uff1a\u6709\u591a\u4e2a\u6d4b\u8bd5\u6761\u4ef6\u65f6\uff0ccase\u8bed\u53e5\u4f1a\u4f7f\u5f97\u8bed\u6cd5\u7ed3\u6784\u66f4\u660e\u6670 \u8bed\u53e5\u7ed3\u6784\uff1a case \u53d8\u91cf\u5f15\u7528 in PATTERN1) \u5206\u652f1 ;; PATTERN2) \u5206\u652f2 ;; ... *) \u5206\u652fn ;; esac PATTERN\uff1a\u7c7b\u540c\u4e8e\u6587\u4ef6\u540d\u901a\u914d\u673a\u5236\uff0c\u4f46\u652f\u6301\u4f7f\u7528|\u8868\u793a\u6216\u8005 a|b: a\u6216\u8005b*\uff1a\u5339\u914d\u4efb\u610f\u957f\u5ea6\u7684\u4efb\u610f\u5b57\u7b26 ?: \u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26 []: \u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u5355\u4e2a\u5b57\u7b26 \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u5b8c\u6210\u5982\u4e0b\u4efb\u52a1\uff0c\u5176\u4f7f\u7528\u5f62\u5f0f\u5982\u4e0b\u6240\u793a\uff1a script.sh {start|stop|restart|status} \u5176\u4e2d\uff1a\u5982\u679c\u53c2\u6570\u4e3a\u7a7a\uff0c\u5219\u663e\u793a\u5e2e\u52a9\u4fe1\u606f\uff0c\u5e76\u9000\u51fa\u811a\u672c\uff1b \u5982\u679c\u53c2\u6570\u4e3astart\uff0c\u5219\u521b\u5efa\u7a7a\u6587\u4ef6/var/lock/subsys/script\uff0c\u5e76\u663e\u793a\u201cstarting script successfully.\u201d \u5982\u679c\u53c2\u6570\u4e3astop\uff0c\u5219\u5220\u9664\u6587\u4ef6/var/lock/subsys/script\uff0c\u5e76\u663e\u793a\u201cStop script successfully.\u201d \u5982\u679c\u53c2\u6570\u4e3arestart\uff0c\u5219\u5220\u9664\u6587\u4ef6/var/locksubsys/script\u5e76\u91cd\u65b0\u521b\u5efa\uff0c\u800c\u540e\u663e\u793a\u201cRestarting script successfully.\u201d \u5982\u679c\u53c2\u6570\u4e3astatus\uff0c\u90a3\u4e48\uff1a\u5982\u679c\u6587\u4ef6/var/lock/subsys/script\u5b58\u5728\uff0c\u5219\u663e\u793a\u201cScript is running\u2026\u201d\uff0c\u5426\u5219\uff0c\u5219\u663e\u793a\u201cScript is stopped.\u201d #!/bin/bash file='/var/lock/subsys/script' case $1 in start) if [ -f $file ];then echo \"Script is running...\" exit 3 else touch $file [ $? -eq 0 ] && echo \"Starting script successfully.\" fi ;; stop) if [ -f $file ];then rm -rf $file [ $? -eq 0 ] && echo \"Stop script successfully.\" else echo \"Script is stopped...\" exit 4 fi ;; restart) if [ -f $file ];then rm -rf $file [ $? -eq 0 ] && echo \"Stop script successfully\" else echo \"Script is stopped...\" exit 5 fi touch $file [ $? -eq 0 ] && echo \"Starting script successfully\" ;; status) if [ -f $file ];then echo \"Script is running...\" else echo \"Script is stopped.\" fi ;; *) echo \"`basename $0` {start|stop|restart|status}\" exit 2 ;; esac","title":"bash\u6761\u4ef6\u6d4b\u8bd5"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_7","text":"\u5faa\u73af\u4e4bfor\u5faa\u73af 1\u3001for\u8bed\u53e5\u683c\u5f0f\u4e00 \u8bed\u53e5\u7ed3\u6784\uff1a for \u53d8\u91cf\u540d in \u5217\u8868; do \u5faa\u73af\u4f53 done \u5217\u8868\uff1a\u53ef\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5143\u7d20 \u5faa\u73af\u4f53\uff1a\u4f9d\u8d56\u4e8e\u8c03\u7528\u53d8\u91cf\u6765\u5b9e\u73b0\u5176\u53d8\u5316 \u5faa\u73af\u53ef\u5d4c\u5957 \u9000\u51fa\u6761\u4ef6\uff1a\u904d\u5386\u5143\u7d20\u5217\u8868\u7ed3\u675f \u4f8b\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u6b63\u6574\u6570\u4e4b\u548c #!/bin/bash declare -i sum=0 for i in {1..100}; do let sum+=$i done echo $sum 2\u3001for\u8bed\u53e5\u683c\u5f0f\u4e8c for ((\u521d\u59cb\u6761\u4ef6;\u6d4b\u8bd5\u6761\u4ef6;\u4fee\u6539\u8868\u8fbe\u5f0f)); do \u5faa\u73af\u4f53 done \u5148\u7528\u521d\u59cb\u6761\u4ef6\u548c\u6d4b\u8bd5\u6761\u4ef6\u505a\u5224\u65ad\uff0c\u5982\u679c\u7b26\u5408\u6d4b\u8bd5\u6761\u4ef6\u5219\u6267\u884c\u5faa\u73af\u4f53\uff0c\u518d\u4fee\u6539\u8868\u8fbe\u5f0f\uff0c\u5426\u5219\u76f4\u63a5\u8df3\u51fa\u5faa\u73af\u3002 \u4f8b\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u6b63\u6574\u6570\u4e4b\u548c\uff08for\u4e8c\u5b9e\u73b0\uff09 #!/bin/bash declare -i sum=0 for ((counter=1;$counter <= 100; counter++)); do let sum+=$counter done echo $sum \u5faa\u73af\u4e4bwhile\u8bed\u53e5 while\u9002\u7528\u4e8e\u5faa\u73af\u6b21\u6570\u672a\u77e5\uff0c\u6216\u4e0d\u4fbf\u7528for\u76f4\u63a5\u751f\u6210\u8f83\u5927\u7684\u5217\u8868\u65f6 \u8bed\u53e5\u7ed3\u6784\uff1a while \u6d4b\u8bd5\u6761\u4ef6; do \u5faa\u73af\u4f53 done \u6d4b\u8bd5\u6761\u4ef6\u4e3a\u771f\uff0c\u8fdb\u5165\u5faa\u73af\uff1b\u6d4b\u8bd5\u6761\u4ef6\u4e3a\u5047\uff0c\u9000\u51fa\u5faa\u73af \u4f8b1\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u5076\u6570\u4e4b\u548c\uff0c\u8981\u6c42\u4f7f\u7528\u53d6\u6a21\u65b9\u6cd5 #!/bin/bash declare -i counter=1 declare -i sum=0 while [ $counter -le 100 ]; do if [ $[$counter%2] -eq 0 ]; then let sum+=$counter fi let counter++ done echo $sum \u4f8b2\uff1a\u63d0\u793a\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u7528\u6237\u540d\uff0c\u5982\u679c\u7528\u6237\u5b58\u5728\uff0c\u5c31\u663e\u793a\u7528\u6237\u7684ID\u53f7\u548cshell\uff1b\u5426\u5219\u663e\u793a\u7528\u6237\u4e0d\u5b58\u5728\uff1b\u663e\u793a\u5b8c\u6210\u4e4b\u540e\u4e0d\u9000\u51fa\uff0c\u518d\u6b21\u91cd\u590d\u524d\u9762\u7684\u64cd\u4f5c\uff0c\u76f4\u5230\u7528\u6237\u8f93\u5165q\u6216quit\u4e3a\u6b62 #!/bin/bash read -p \"Plz enter a username: \" userName while [ \"$userName\" != 'q' -a \"$userName\" != 'quit' ]; do if id $userName &> /dev/null; then grep \"^$userName\\>\" /etc/passwd | cut -d: -f3,7 else echo \"No such user.\" fi read -p \"Plz enter a username again: \" userName done while\u7279\u6b8a\u7528\u6cd5\uff1a\u904d\u5386\u6587\u672c\u6587\u4ef6 \u8bed\u53e5\u7ed3\u6784\uff1a while read \u53d8\u91cf\u540d; do \u5faa\u73af\u4f53 done < /path/to/somefile \u53d8\u91cf\u540d\uff0c\u6bcf\u5faa\u73af\u4e00\u6b21\uff0c\u8bb0\u5fc6\u4e86\u6587\u4ef6\u4e2d\u4e00\u884c\u6587\u672c \u4f8b\uff1a\u663e\u793aID\u53f7\u4e3a\u5076\u6570\uff0c\u4e14ID\u53f7\u540cGID\u7684\u7528\u6237\u7684\u7528\u6237\u540d\u3001ID\u548cSHELL while read line; do userID=`echo $line | cut -d: -f3` groupID=`echo $line | cut -d: -f4` if [ $[$userID%2] -eq 0 -a $userID -eq $groupID ]; then echo $line | cut -d: -f1,3,7 fi done < /etc/passwd \u5faa\u73af\u4e4buntil\u8bed\u53e5 \u8bed\u53e5\u7ed3\u6784\uff1a until \u6d4b\u8bd5\u6761\u4ef6; do \u5faa\u73af\u4f53 done \u6d4b\u8bd5\u6761\u4ef6\u4e3a\u5047\uff0c\u8fdb\u5165\u5faa\u73af\uff1b\u6d4b\u8bd5\u6761\u4ef6\u4e3a\u771f\uff0c\u9000\u51fa\u5faa\u73af \u4f8b\uff1a\u6c42100\u4ee5\u5185\u6240\u6709\u5076\u6570\u4e4b\u548c\uff0c\u8981\u6c42\u4f7f\u7528\u53d6\u6a21\u65b9\u6cd5\uff08until\u5b9e\u73b0\uff09 #!/bin/bash declare -i counter=1 declare -i sum=0 until [ $counter -gt 100 ]; do if [ $[$counter%2] -eq 0 ]; then let sum+=$counter fi let counter++ done echo $sum \u4f8b\uff1a\u63d0\u793a\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u7528\u6237\u540d\uff0c\u5982\u679c\u7528\u6237\u5b58\u5728\uff0c\u5c31\u663e\u793a\u7528\u6237\u7684ID\u53f7\u548cshell\uff1b\u5426\u5219\u663e\u793a\u7528\u6237\u4e0d\u5b58\u5728\uff1b\u663e\u793a\u5b8c\u6210\u4e4b\u540e\u4e0d\u9000\u51fa\uff0c\u518d\u6b21\u91cd\u590d\u524d\u9762\u7684\u64cd\u4f5c\uff0c\u76f4\u5230\u7528\u6237\u8f93\u5165q\u6216quit\u4e3a\u6b62\uff08until\u5b9e\u73b0\uff09 #!/bin/bash read -p \"Plz enter a username: \" userName until [ \"$userName\" = 'q' -a \"$userName\" = 'quit' ]; do if id $userName &> /dev/null; then grep \"^$userName\\>\" /etc/passwd | cut -d: -f3,7 else echo \"No such user.\" fi read -p \"Plz enter a username again: \" userName done \u5faa\u73af\u4e4b\u5faa\u73af\u63a7\u5236\u548cshift \u5faa\u73af\u63a7\u5236\u547d\u4ee4\uff1a break\uff1a\u63d0\u524d\u9000\u51fa\u5faa\u73af break [N]: \u9000\u51faN\u5c42\u5faa\u73af\uff1bN\u7701\u7565\u65f6\u8868\u793a\u9000\u51fabreak\u8bed\u53e5\u6240\u5728\u7684\u5faa\u73af continue: \u63d0\u524d\u7ed3\u675f\u672c\u8f6e\u5faa\u73af\uff0c\u800c\u76f4\u63a5\u8fdb\u5165\u4e0b\u8f6e\u5faa\u73af continue [N]\uff1a\u63d0\u524d\u7b2cN\u5c42\u7684\u5faa\u73af\u7684\u672c\u8f6e\u5faa\u73af\uff0c\u800c\u76f4\u63a5\u8fdb\u5165\u4e0b\u8f6e\u5faa\u73af \u6b7b\u5faa\u73af\uff1a #while\u4f53while true; do \u5faa\u73af\u4f53 done #until\u4f53 until false; do \u5faa\u73af\u4f53 done \u4f8b1\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u5224\u65ad\u7ed9\u5b9a\u7684\u7528\u6237\u662f\u5426\u767b\u5f55\u4e86\u5f53\u524d\u7cfb\u7edf (1) \u5982\u679c\u767b\u5f55\u4e86\uff0c\u5219\u811a\u672c\u7ec8\u6b62\uff1b (2) \u6bcf5\u79d2\u79cd\uff0c\u67e5\u770b\u4e00\u6b21\u7528\u6237\u662f\u5426\u767b\u5f55\uff1b #!/bin/bash while true; do who | grep \"gentoo\" &> /dev/null if [ $? -eq 0 ];then break fi sleep 5 done echo \"gentoo is logged.\" shift\uff1a \u5982\u679c\u6ca1\u6709\u6570\u5b57\uff0c\u53ea\u6709shift \u5c31\u662f\u8df3\u8fc7\u4e00\u4e2a\u53c2\u6570\u83b7\u53d6\u4e0b\u4e00\u4e2a\u53c2\u6570\uff0c\u5982\u679c\u52a0\u4e0a\u6570\u5b57\uff0c\u6bd4\u5982shift 2 \uff0c\u8df3\u8fc7\u4e24\u4e2a\u53c2\u6570\u83b7\u53d6\u4e0b\u4e00\u4e2a\u53c2\u6570\u3002 \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u4f7f\u7528\u5f62\u5f0f\u5982\u4e0b\u6240\u793a showifinfo.sh [-i INTERFACE|-a] [-v] \u8981\u6c42\uff1a 1\u3001-i\u6216-a\u4e0d\u53ef\u540c\u65f6\u4f7f\u7528\uff0c-i\u7528\u4e8e\u6307\u5b9a\u7279\u5b9a\u7f51\u5361\u63a5\u53e3\uff0c-a\u7528\u4e8e\u6307\u5b9a\u6240\u6709\u63a5\u53e3\uff1b \u663e\u793a\u63a5\u53e3\u7684ip\u5730\u5740 2\u3001\u4f7f\u7528-v\uff0c\u5219\u8868\u793a\u663e\u793a\u8be6\u7ec6\u4fe1\u606f\uff0c\u663e\u793a\u63a5\u53e3\u7684ip\u5730\u5740\u3001\u5b50\u7f51\u63a9\u7801\u3001\u5e7f\u64ad\u5730\u5740\uff1b 3\u3001\u9ed8\u8ba4\u8868\u793a\u4ec5\u4f7f\u7528-a\u9009\u9879; #!/bin/bash allinterface=0 ifflag=0 verbose=0 interface=0 if [ $# -eq 0 ];then ifconfig | grep \"inet addr:\" | awk '{print $2}' fi while [ $# -ge 1 ];do case $1 in -a) allinterface=1 shift 1 ;; -i) ifflag=1 interface=$2 shift 2 ;; -v) verbose=1 shift 1 ;; *) echo \"error option\" exit 2 ;; esac done if [ $allinterface -eq 1 ];then if [ $ifflag -eq 1 ];then echo \"command not found\" exit 5 fi if [ $verbose -eq 1 ];then ifconfig | grep \"inet addr:\" else ifconfig | grep \"inet addr:\" | awk '{print $2}' fi fi if [ $ifflag -eq 1 ];then if [ $allinterface -eq 1 ];then echo \"command not found\" exit 5 fi if [ $verbose -eq 1 ];then ifconfig $interface | grep \"inet addr:\" else ifconfig $interface | grep \"inet addr:\" | awk '{print $2}' fi fi","title":"bash\u7f16\u7a0b\u4e4b\u5faa\u73af\u8bed\u53e5"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_8","text":"","title":"bash\u7f16\u7a0b\u4e4b\u51fd\u6570"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#_2","text":"function F_NAME { \u51fd\u6570\u4f53 } F_NAME() { \u51fd\u6570\u4f53 } \u53ef\u8c03\u7528\uff1a\u4f7f\u7528\u51fd\u6570\u540d\uff0c\u51fd\u6570\u540d\u51fa\u73b0\u7684\u5730\u65b9\uff0c\u4f1a\u88ab\u81ea\u52a8\u66ff\u6362\u4e3a\u51fd\u6570 \u51fd\u6570\u7684\u8fd4\u56de\u503c\uff1a \u51fd\u6570\u7684\u6267\u884c\u7ed3\u679c\u8fd4\u56de\u503c\uff1a\u4ee3\u7801\u7684\u8f93\u51fa \u51fd\u6570\u4e2d\u4f7f\u7528\u6253\u5370\u8bed\u53e5\uff1aecho, printf \u51fd\u6570\u4e2d\u8c03\u7528\u7684\u7cfb\u7edf\u547d\u4ee4\u6267\u884c\u540e\u8fd4\u56de\u7684\u7ed3\u679c \u6267\u884c\u72b6\u6001\u8fd4\u56de\u503c\uff1a \u9ed8\u8ba4\u53d6\u51b3\u4e8e\u51fd\u6570\u4f53\u6267\u884c\u7684\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u72b6\u6001\u7ed3\u679c \u81ea\u5b9a\u4e49\u9000\u51fa\u72b6\u6001\u7801\uff1areturn [0-255] \u6ce8\u610f\uff1a\u51fd\u6570\u4f53\u8fd0\u884c\u65f6\uff0c\u4e00\u65e6\u9047\u5230return\u8bed\u53e5\uff0c\u51fd\u6570\u5373\u8fd4\u56de\uff1b \u51fd\u6570\u53ef\u4ee5\u63a5\u53d7\u53c2\u6570\uff1a \u5728\u51fd\u6570\u4f53\u4e2d\u8c03\u7528\u51fd\u6570\u53c2\u6570\u7684\u65b9\u5f0f\u540c\u811a\u672c\u4e2d\u8c03\u7528\u811a\u672c\u53c2\u6570\u7684\u65b9\u5f0f\uff1a \u4f4d\u7f6e\u53c2\u6570 $1, $2, \u2026 $#, $*, $@ \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u5b8c\u6210\u5982\u4e0b\u529f\u80fd(\u4f7f\u7528\u51fd\u6570)\uff1a 1\u3001\u63d0\u793a\u7528\u6237\u8f93\u5165\u4e00\u4e2a\u53ef\u6267\u884c\u547d\u4ee4\uff1b 2\u3001\u83b7\u53d6\u8fd9\u4e2a\u547d\u4ee4\u6240\u4f9d\u8d56\u7684\u6240\u6709\u5e93\u6587\u4ef6(\u4f7f\u7528ldd\u547d\u4ee4)\uff1b 3\u3001\u590d\u5236\u547d\u4ee4\u81f3/mnt/sysroot/\u5bf9\u5e94\u7684\u76ee\u5f55\u4e2d \u89e3\u91ca\uff1a\u5047\u8bbe\uff0c\u5982\u679c\u590d\u5236\u7684\u662fcat\u547d\u4ee4\uff0c\u5176\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u8def\u5f84\u662f/bin/cat\uff0c\u90a3\u4e48\u5c31\u8981\u5c06/bin/cat\u590d\u5230/mnt/sysroot/bin/\u76ee\u5f55\u4e2d\uff0c\u5982\u679c\u590d\u5236\u7684\u662fuseradd\u547d\u4ee4\uff0c\u800cuseradd\u7684\u53ef\u6267\u884c\u6587\u4ef6\u8def\u5f84\u4e3a/usr/sbin/useradd\uff0c\u90a3\u4e48\u5c31\u8981\u5c06\u5176\u590d\u5236\u5230/mnt/sysroot/usr/sbin/\u76ee\u5f55\u4e2d\uff1b 4\u3001\u590d\u5236\u5404\u5e93\u6587\u4ef6\u81f3/mnt/sysroot/\u5bf9\u5e94\u7684\u76ee\u5f55\u4e2d\uff1b #!/bin/bash target=/mnt/sysroot/ [ -d $target ] || mkdir $target preCommand() { if which $1 &> /dev/null; then commandPath=`which --skip-alias $1` return 0 else echo \"No such command.\" return 1 fi } commandCopy() { commandDir=`dirname $1` [ -d ${target}${commandDir} ] || mkdir -p ${target}${commandDir} [ -f ${target}${commandPath} ] || cp $1 ${target}${commandDir} } libCopy() { for lib in `ldd $1 | egrep -o \"/[^[:space:]]+\"`; do libDir=`dirname $lib` [ -d ${target}${libDir} ] || mkdir -p ${target}${libDir} [ -f ${target}${lib} ] || cp $lib ${target}${libDir} done } read -p \"Plz enter a command: \" command until [ \"$command\" == 'quit' ]; do if preCommand $command &> /dev/null; then commandCopy $commandPath libCopy $commandPath fi read -p \"Plz enter a command: \" command done","title":"\u8bed\u6cd5\u7ed3\u6784\uff1a"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_9","text":"trap\u547d\u4ee4\u7528\u4e8e\u5728shell\u7a0b\u5e8f\u4e2d\u6355\u6349\u5230\u4fe1\u53f7\uff0c\u4e4b\u540e\u53ef\u4ee5\u6709\u4e09\u79cd\u53cd\u5e94\u65b9\u5f0f\uff1a (1)\u6267\u884c\u4e00\u6bb5\u7a0b\u5e8f\u6765\u5904\u7406\u8fd9\u4e00\u4fe1\u53f7 (2)\u63a5\u53d7\u4fe1\u53f7\u7684\u9ed8\u8ba4\u64cd\u4f5c (3)\u5ffd\u89c6\u8fd9\u4e00\u4fe1\u53f7 trap\u5bf9\u4e0a\u9762\u4e09\u79cd\u65b9\u5f0f\u63d0\u4f9b\u4e86\u4e09\u79cd\u57fa\u672c\u5f62\u5f0f\uff1a \u7b2c\u4e00\u79cd\u5f62\u5f0f\u7684trap\u547d\u4ee4\u5728shell\u63a5\u6536\u5230signal list\u6e05\u5355\u4e2d\u6570\u503c\u76f8\u540c\u7684\u4fe1\u53f7\u65f6\uff0c\u5c06\u6267\u884c\u53cc\u5f15\u53f7\u4e2d\u7684\u547d\u4ee4\u4e32\u3002 trap 'commands' signal-list trap \"commands\" signal-list \u7b2c\u4e8c\u79cd\u5f62\u5f0f\u7684trap\u547d\u4ee4\u6062\u590d\u4fe1\u53f7\u7684\u9ed8\u8ba4\u64cd\u4f5c\uff1a trap signal-list \u7b2c\u4e09\u79cd\u5f62\u5f0f\u7684trap\u547d\u4ee4\u5141\u8bb8\u5ffd\u89c6\u4fe1\u53f7\uff1a trap \" \" signal-list trap 'COMMAND' SIGINT\uff08\u8868\u793a\u5173\u95ed\u8fdb\u7a0b\uff09 \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u80fd\u591fping\u63a2\u6d4b\u6307\u5b9a\u7f51\u7edc\u5185\u7684\u6240\u6709\u4e3b\u673a\u662f\u5426\u5728\u7ebf,\u5f53\u6ca1\u6709\u6267\u884c\u5b8c\u65f6\u53ef\u63a5\u6536ctrl+c\u547d\u4ee4\u9000\u51fa\u3002 #!/bin/bash quitScript() { echo \"Quit...\" } trap 'quitScript; exit 5' SIGINT cnetPing() { for i in {1..254}; do if ping -c 1 -W 1 $1.$i &> /dev/null; then echo \"$1.$i is up.\" else echo \"$1.$i is down.\" fi done } bnetPing() { for j in {0..255}; do cnetPing $1.$j done } anetPing() { for m in {0..255}; do bnetPing $1.$m done } netType=`echo $1 | cut -d\".\" -f1` if [ $netType -ge 1 -a $netType -le 126 ]; then anetPing $netType elif [ $netType -ge 128 -a $netType -le 191 ]; then bnetPing $(echo $1 | cut -d'.' -f1,2) elif [ $netType -ge 192 -a $netType -le 223 ]; then cnetPing $(echo $1 | cut -d'.' -f1-3) else echo \"Wrong\" exit 2 fi","title":"bash\u7f16\u7a0b\u4e4b\u4fe1\u53f7\u6355\u6349"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_10","text":"\u6570\u7ec4 \uff1a\u8fde\u7eed\u7684\u591a\u4e2a\u72ec\u7acb\u5185\u5b58\u7a7a\u95f4\uff0c\u6bcf\u4e2a\u5185\u5b58\u7a7a\u95f4\u76f8\u5f53\u4e8e\u4e00\u4e2a\u53d8\u91cf \u6570\u7ec4\u5143\u7d20 \uff1a\u6570\u7ec4\u540d+\u7d22\u5f15\uff08\u4ece0\u5f00\u59cb\u7f16\u53f7\uff09 \u7d22\u5f15\u7684\u8868\u793a\u65b9\u5f0f \uff1aa[0], a[1] \u58f0\u660e\u6570\u7ec4 \uff1a declare -a ARRAR_NAME \u5173\u8054\u6570\u7ec4 \uff1a declare -A ARRAY_NAME \u652f\u6301\u7a00\u758f\u683c\u5f0f\uff1a\u4ec5\u4e00\u7ef4\u6570\u7ec4 \u6570\u7ec4\u5143\u7d20\u7684\u8d4b\u503c\uff1a (1) \u4e00\u6b21\u53ea\u8d4b\u503c\u4e00\u4e2a\u5143\u7d20 a[0]=$RANDOM (2) \u4e00\u6b21\u8d4b\u503c\u5168\u90e8\u5143\u7d20 a=(red blue yellow green) (3) \u6307\u5b9a\u7d22\u5f15\u8fdb\u884c\u8d4b\u503c a=([0]=green [3]=red [2]=blue [6]=yellow) (4) \u7528\u6237\u8f93\u5165 read -a ARRAY \u6570\u7ec4\u7684\u8bbf\u95ee \uff1a \u7528\u7d22\u5f15\u8bbf\u95ee \uff1a ARRAY[index] \u6570\u7ec4\u7684\u957f\u5ea6 \uff1a ${#ARRAY[*]} ${#ARRAY[@]} \u4f8b\uff1a\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u751f\u621010\u4e2a\u968f\u673a\u6570\uff0c\u4fdd\u5b58\u81f3\u6570\u7ec4\u4e2d\uff1b\u800c\u540e\u663e\u793a\u6570\u7ec4\u4e0b\u6807\u4e3a\u5076\u6570\u7684\u5143\u7d20 #\uff01/bin/bash for i in {0..9}; do rand[$i]=$RANDOM [ $[$i%2] -eq 0 ] && echo \"$i:${rand[$i]}\" done \u4ece\u6570\u7ec4\u4e2d\u6311\u9009\u67d0\u5143\u7d20 : ${ARRAY[@]:offset:number} \u5207\u7247 \uff1a offset: \u504f\u79fb\u7684\u5143\u7d20\u4e2a\u6570 number: \u53d6\u51fa\u7684\u5143\u7d20\u7684\u4e2a\u6570 ${ARRAY[@]:offset}\uff1a\u53d6\u51fa\u504f\u79fb\u91cf\u540e\u7684\u6240\u6709\u5143\u7d20 ${ARRAY[@]}: \u53d6\u51fa\u6240\u6709\u5143\u7d20 \u6570\u7ec4\u590d\u5236 \uff1a\u8981\u4f7f\u7528${ARRAY[@]} $@: \u6bcf\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u4e32 $*: \u6240\u6709\u53c2\u6570\u662f\u4e00\u4e2a\u4e32 \u5411\u6570\u7ec4\u4e2d\u8ffd\u52a0\u5143\u7d20 \uff1a\u975e\u7a00\u758f\u683c\u5f0f week, week[${#week[@]}] \u4ece\u6570\u7ec4\u4e2d\u5220\u9664\u5143\u7d20 \uff1a unset ARRAY[index] \u4f8b\uff1a\u590d\u5236\u4e00\u4e2a\u6570\u7ec4\u4e2d\u4e0b\u6807\u4e3a\u5076\u6570\u7684\u5143\u7d20\u81f3\u4e00\u4e2a\u65b0\u6570\u7ec4\u4e2d #!/bin/bash declare -a mylogs logs=(/var/log/*.log) echo ${logs[@]} for i in `seq 0 ${#logs[@]}`; do if [ $[$i%2] -eq 0 ];then index=${#mylogs[@]} mylogs[$index]=${logs[$i]} fi done echo ${mylogs[@]} \u4f8b2\uff1a\u751f\u621010\u4e2a\u968f\u673a\u6570\uff0c\u5347\u5e8f\u6392\u5e8f #!/bin/bash for((i=0;i<10;i++)) do rnd[$i]=$RANDOM done echo -e \"total=${#rnd[@]}\\n${rnd[@]}\\nBegin to sort\" for((i=9;i>=1;i--)) do for((j=0;j<i;j++)) do if [ ${rnd[$j]} -gt ${rnd[$[$j+1]]} ] ;then swapValue=${rnd[$j]} rnd[$j]=${rnd[$[$j+1]]} rnd[$[$j+1]]=$swapValue fi done done echo ${rnd[@]} \u4f8b3\uff1a\u6253\u5370\u4e5d\u4e5d\u4e58\u6cd5\u8868 #!/bin/bashfor((i=1;i<=9;i++)) do strLine=\"\" for((j=1;i<=9;j++)) do strLine=$strLine\"$i*$j=\"$[$i*$j]\"\\t\" [ $i -eq $j ] && echo -e $strLine && break done done","title":"bash\u7f16\u7a0b\u4e4b\u6570\u7ec4"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#bash_11","text":"\u5b57\u7b26\u4e32\u5207\u7247 \uff1a ${string:offset:length} [root@scholar scripts]# string='hello word' [root@scholar scripts]# echo ${string:2:4} llo \u53d6\u5c3e\u90e8\u7684\u6307\u5b9a\u4e2a\u6570\u7684\u5b57\u7b26\uff1a ${string: -length} [root@scholar scripts]# echo ${string: -2} rd \u53d6\u5b50\u4e32 \uff1a\u57fa\u4e8e\u6a21\u5f0f ${variable#*word} \uff1a\u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u5de6\u800c\u53f3\uff0c\u67e5\u627e\u7b2c\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u5b57\u7b26\u5f00\u59cb\u81f3\u6b64word\u5904\u7684\u6240\u6709\u5185\u5bb9\uff1b $ {variable##*word} \uff1a\u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u5de6\u800c\u53f3\uff0c\u67e5\u627e\u6700\u540e\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u5b57\u7b26\u5f00\u59cb\u81f3\u6b64word\u5904\u7684\u6240\u6709\u5185\u5bb9\uff1b file='/var/log/messages' ${file#*/}: \u8fd4\u56de\u7684\u7ed3\u679c\u662fvar/log/messages ${file##*/}: \u8fd4\u56demessages ${variable%word*} : \u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u53f3\u800c\u5de6\uff0c\u67e5\u627e\u7b2c\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u6b64word\u5904\u81f3\u5b57\u4e32\u5c3e\u90e8\u7684\u6240\u6709\u5185\u5bb9\uff1b ${variable%%world*} :\u5728variable\u4e2d\u5b58\u50a8\u5b57\u4e32\u4e0a\uff0c\u81ea\u53f3\u800c\u5de6\uff0c\u67e5\u627e\u6700\u540e\u4e00\u6b21\u51fa\u73b0word\uff0c\u5220\u9664\u6b64word\u5904\u81f3\u5b57\u4e32\u5c3e\u90e8\u7684\u6240\u6709\u5185\u5bb9\uff1b file='/var/log/messages' ${file%*/}: \u8fd4\u56de\u7684\u7ed3\u679c\u662f/var/log ${file%%*/}: \u8fd4\u56de\u7ed3\u679c\u4e3a\u7a7a \u4f8b\uff1aurl=\"http://www.redhat.com:80\" \u53d6\u7aef\u53e3\uff1a${url##*:} \u53d6\u534f\u8bae\uff1a${url%%:*} \u67e5\u627e\u66ff\u6362 \uff1a ${variable/pattern/substi} : \u66ff\u6362\u7b2c\u4e00\u6b21\u51fa\u73b0 #userinfo=`tail -1 /etc/passwd #echo $userinfo scholar:x:500:500:scholar:/home/scholar:/bin/bash #echo ${userinfo/scholar/redhat} redhat:x:500:500:scholar:/home/scholar:/bin/bash ${variable//pattern/substi} \uff1a\u66ff\u6362\u6240\u6709\u7684\u51fa\u73b0 #echo ${userinfo//scholar/redhat} redhat:x:500:500:redhat:/home/redhat:/bin/bash ${variable/#pattern/substi} \uff1a\u66ff\u6362\u884c\u9996\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9 #echo ${userinfo/#scholar/redhat} redhat:x:500:500:scholar:/home/scholar:/bin/bash ${variable/%pattern/substi} \uff1a\u66ff\u6362\u884c\u5c3e\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9 #echo ${userinfo/%bash/redhat} scholar:x:500:500:scholar:/home/scholar:/bin/redhat","title":"bash\u7f16\u7a0b\u4e4b\u5b57\u7b26\u4e32\u64cd\u4f5c"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#patternglobbing","text":"\u67e5\u627e\u5220\u9664 \uff1a ${variable/pattern} \uff1a\u5220\u9664\u7b2c\u4e00\u6b21\u51fa\u73b0 #echo ${userinfo/scholar} :x:500:500:scholar:/home/scholar:/bin/bash ${variable//pattern} \uff1a\u5220\u9664\u6240\u6709\u7684\u51fa\u73b0 #echo ${userinfo//scholar} :x:500:500::/home/:/bin/bash ${variable/#pattern} \uff1a\u5220\u9664\u884c\u9996\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9 #echo ${userinfo/#scholar} :x:500:500:scholar:/home/scholar:/bin/bash ${variable/%pattern} \uff1a\u5220\u9664\u884c\u5c3e\u88abpattern\u5339\u914d\u5230\u7684\u5185\u5bb9 #echo ${userinfo/%bash} scholar:x:500:500:scholar:/home/scholar:/bin/ \u5927\u5c0f\u5199\u8f6c\u6362 \uff1a \u5c0f\u2013>\u5927\uff1a ${variable^^} #echo ${userinfo^^} SCHOLAR:X:500:500:SCHOLAR:/HOME/SCHOLAR:/BIN/BASH \u5927\u2013>\u5c0f\uff1a ${variable,,} #name=\"SCHOLAR\" #echo ${name,,} scholar","title":"pattern\u53ef\u4ee5\u4f7f\u7528globbing\u4e2d\u7684\u5143\u5b57\u7b26\uff1a* \uff1f"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#_3","text":"${variable:-string} :variable\u4e3a\u7a7a\u6216\u672a\u8bbe\u5b9a\uff0c\u90a3\u4e48\u8fd4\u56destring\uff0c\u5426\u5219\uff0c\u8fd4\u56devariable\u53d8\u91cf\u7684\u503c\uff1b ${variable:=string} :variable\u4e3a\u7a7a\u6216\u672a\u8bbe\u5b9a\uff0c\u5219\u8fd4\u56destring\uff0c\u4e14\u5c06string\u8d4b\u503c\u7ed9\u53d8\u91cfvariable\uff0c\u5426\u5219\uff0c\u8fd4\u56devariable\u7684\u503c\uff1b \u4e3a\u811a\u672c\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u786e\u4fdd\u67d0\u53d8\u91cf\u6709\u53ef\u7528\u503c\u7684\u65b9\u5f0f variable=${variable:-default vaule} \u5199\u4e2a\u811a\u672c\uff0c\u914d\u7f6eetc\u76ee\u5f55\uff1b (1) \u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5b9a\u4e49\u53d8\u91cf\uff1b (2) \u5728\u811a\u672c\u4e2dsource\u914d\u7f6e\u6587\u4ef6\uff1b #!/bin/bash [ -f /etc/sysconfig/network ] && source /etc/network/network [-z \"$HOSTAME\" -o \"$HOSTNAME\" = '(none)' ] || HOSTNAME ='localhost' /bin/hostname $HOSTNAME /bin/hostname","title":"\u53d8\u91cf\u8d4b\u503c\u64cd\u4f5c\uff1a"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#mktemp","text":"mktemp [OPTIONS] filename.XXX -d: \u521b\u5efa\u4e34\u65f6\u76ee\u5f55 --tmpdir=/path/to/somewhere \uff1a\u6307\u5b9a\u4e34\u65f6\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55 mktemp /tmp/tmp.XXX #XXX\u751f\u6210\u76f8\u540c\u6570\u91cf\u968f\u673a\u5b57\u7b26 mktemp --tmpdir=/var/tmp tmp.XXX #\u6307\u5b9a\u76ee\u5f55\u521b\u5efa\u4e34\u65f6\u6587\u4ef6 mktemp --tmpdir=/var/tmp -d tmp.XXX #\u6307\u5b9a\u76ee\u5f55\u521b\u5efa\u4e34\u65f6\u76ee\u5f55","title":"mktemp\u547d\u4ee4\uff1a"},{"location":"Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/#install","text":"install [OPTIONS] SOURCE DEST install [OPTIONS] SOURCE\u2026 DIR install [OPTIONS] -d DIR \u2026 \u589e\u5f3a\u578b\u7684\u590d\u5236\u547d\u4ee4\uff1a -o OWNER -g GROUP -m MODE -d : \u521b\u5efa\u76ee\u5f55 install /etc/fstab /tmp #\u590d\u5236\u6587\u4ef6\u5230\u6307\u5b9a\u76ee\u5f55 install --mode=644 /etc/fstab /tmp/ #\u590d\u5236\u65f6\u6307\u5b9a\u6743\u9650 install --owner=scholar /etc/fstab /tmp #\u590d\u5236\u65f6\u6307\u5b9a\u5c5e\u4e3b install --group=scholar /etc/fstab /tmp #\u590d\u5236\u65f6\u6307\u5b9a\u5c5e\u7ec4 install -d /tmp/install #\u521b\u5efa\u76ee\u5f55","title":"install\u547d\u4ee4:"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/","text":"explain\u8be6\u89e3\u4e0e\u7d22\u5f15\u6700\u4f73\u5b9e\u8df5 \u00b6 info \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 select_type \u542b\u4e49 SIMPLE \u7b80\u5355\u7684select\u67e5\u8be2,\u67e5\u8be2\u4e2d\u4e0d\u5305\u542b\u5b50\u67e5\u8be2\u6216\u8005UNION PRIMARY \u67e5\u8be2\u4e2d\u82e5\u5305\u542b\u4efb\u4f55\u590d\u6742\u7684\u5b57\u67e5\u8be2,\u6700\u5916\u5c42\u67e5\u8be2\u6807\u8bb0\u4e3a\u8be5\u6807\u8bc6 SUBQUERY \u5728SELECT\u6216WHERE\u5217\u8868\u4e2d\u5305\u542b\u4e86\u5b50\u67e5\u8be2 DERIVED \u5728FROM\u5217\u8868\u4e2d\u5305\u542b\u7684\u5b50\u67e5\u8be2,\u88ab\u6807\u8bb0\u4e3aDERIVED(\u884d\u751f)MySQL\u4f1a\u9012\u5f52\u6267\u884c\u8fd9\u4e9b\u5b50\u67e5\u8be2,\u628a\u7ed3\u679c\u653e\u5728\u4e34\u65f6\u8868\u4e2d UNION \u82e5\u7b2c\u4e8c\u4e2aSELECT\u51fa\u73b0\u5728UNION\u4e4b\u540e,\u5219\u6807\u8bb0\u4e3aUNION;\u82e5UNION\u5305\u542b\u5728FROM\u5b57\u53e5\u7684\u5b50\u67e5\u8be2\u4e2d,\u5916\u5c42SELECT\u5c06\u88ab\u6807\u8bb0\u4e3a:DERIVED UNION RESULT \u4eceUNION\u8868\u83b7\u53d6\u7ed3\u679c\u7684SELECT explain \u4e4btype \u00b6 type \u542b\u4e49 NULL MySQL\u4e0d\u8bbf\u95ee\u4efb\u4f55\u8868,\u7d22\u5f15,\u76f4\u63a5\u8fd4\u56de\u7ed3\u679c system \u8868\u53ea\u6709\u4e00\u884c\u8bb0\u5f55(\u7b49\u4e8e\u7cfb\u7edf\u8868),\u8fd9\u662fconst\u7c7b\u578b\u7684\u7279\u4f8b,\u4e00\u822c\u4e0d\u4f1a\u51fa\u73b0 const \u8868\u793a\u901a\u8fc7\u7d22\u5f15\u4e00\u6b21\u5c31\u627e\u5230\u4e86,const\u7528\u4e8e\u6bd4\u8f83primary key\u6216\u8005unique\u7d22\u5f15.\u56e0\u4e3a\u53ea\u5339\u914d\u4e00\u884c\u6570\u636e,\u6240\u4ee5\u5f88\u5feb.\u5982\u5c06\u4e3b\u952e\u7f6e\u4e8ewhere\u5217\u8868\u4e2d,MySQL\u5c31\u80fd\u5c06\u8be5\u67e5\u8be2\u8f6c\u6362\u4e3a\u4e00\u4e2a\u5e38\u91cf.const\u4e8e\u5c06\"\u4e3b\u952e\"\u6216\"\u552f\u4e00\"\u7d22\u5f15\u7684\u6240\u6709\u90e8\u5206\u4e0e\u5e38\u91cf\u503c\u8fdb\u884c\u6bd4\u8f83 eq_ref \u7c7b\u578bref,\u533a\u522b\u5728\u4e8e\u4f7f\u7528\u7684\u662f\u552f\u4e00\u7d22\u5f15,\u4f7f\u7528\u4e3b\u952e\u7684\u5e76\u8054\u67e5\u8be2,\u5173\u8054\u67e5\u8be2\u7684\u8bb0\u5f55\u53ea\u6709\u4e00\u6761.\u5e38\u89c1\u4e8e\u4e3b\u952e\u6216\u552f\u4e00\u7d22\u5f15\u63cf\u8ff0 ref \u975e\u552f\u4e00\u6027\u7d22\u5f15\u63cf\u8ff0,\u8fd4\u56de\u5339\u914d\u67d0\u4e2a\u5355\u72ec\u503c\u5f97\u6240\u6709\u884c.\u672c\u8d28\u4e0a\u4e5f\u662f\u4e00\u79cd\u7d22\u5f15\u8bbf\u95ee,\u8fd4\u56de\u6240\u6709\u5339\u914d\u67d0\u4e2a\u5355\u72ec\u503c\u7684\u6240\u6709\u884c(\u591a\u4e2a) range \u53ea\u68c0\u7d22\u7ed9\u5b9a\u8fd4\u56de\u7684\u884c,\u4f7f\u7528\u4e00\u4e2a\u7d22\u5f15\u6765\u9009\u62e9\u884c.where\u4e4b\u540e\u51fa\u73b0between,<,>,in \u7b49\u64cd\u4f5c index index\u4e0eALL\u7684\u533a\u522b\u4e3aindex\u7c7b\u578b\u53ea\u662f\u904d\u5386\u4e86\u7d22\u5f15\u6811,\u901a\u5e38\u6bd4ALL\u5feb,ALL\u662f\u904d\u5386\u6570\u636e\u6587\u4ef6 ALL \u5c06\u904d\u5386\u5168\u8868\u4ee5\u627e\u5230\u5339\u914d\u7684\u884c \u7ed3\u679c\u503c\u4ece \u6700\u597d \u5230 \u6700\u574f \u4f9d\u6b21\u662f: NULL > system > const > eq_ref > ref > fulltext > ref_or_null > index_merge > unique_subquery > index_subquery > range > index > ALL system > const > eq_ref > ref > range > index > ALL \u4e00\u822c\u6765\u8bf4,\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u67e5\u8be2\u81f3\u5c11\u8fbe\u5230range\u7ea7\u522b, \u6700\u540e\u8fbe\u5230ref. explain \u4e4bkey \u00b6 possible_keys: \u663e\u793a\u53ef\u80fd\u5e94\u7528\u5728\u8fd9\u5f20\u8868\u7684\u7d22\u5f15, \u4e00\u4e2a\u6216\u591a\u4e2a key: \u5b9e\u9645\u4f7f\u7528\u7684\u7d22\u5f15,\u5982\u679c\u4e3aNULL,\u5219\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15 key_len: \u8868\u793a\u7d22\u5f15\u4e2d\u4f7f\u7528\u7684\u5b57\u8282\u6570, \u8be5\u503c\u4e3a\u7d22\u5f15\u5b57\u6bb5\u6700\u5927\u53ef\u80fd\u957f\u5ea6,\u5e76\u975e\u5b9e\u9645\u4f7f\u7528\u957f\u5ea6,\u5728\u4e0d\u635f\u5931\u7cbe\u786e\u6027\u7684\u524d\u63d0\u4e0b,\u957f\u5ea6\u8d8a\u77ed\u8d8a\u597d. explain \u4e4brows \u00b6 \u626b\u63cf\u884c\u7684\u6570\u91cf explain \u4e4bextra \u00b6 \u5176\u4ed6\u7684\u989d\u5916\u7684\u6267\u884c\u8ba1\u5212\u4fe1\u606f,\u5728\u8be5\u5217\u663e\u793a. extra \u542b\u4e49 using filesort \u8bf4\u660emysql\u4f1a\u5bf9\u6570\u636e\u4f7f\u7528\u4e00\u4e2a\u5916\u90e8\u7684\u7d22\u5f15\u6392\u5e8f,\u800c\u4e0d\u662f\u6309\u7167\u8868\u5185\u7684\u7d22\u5f15\u987a\u5e8f\u8fdb\u884c\u8bfb\u53d6,\u79f0\u4e3a\"\u6587\u4ef6\u6392\u5e8f\",\u6548\u7387\u4f4e. using temporary \u4f7f\u7528\u4e86\u4e34\u65f6\u8868\u4fdd\u5b58\u4e2d\u95f4\u7ed3\u679c,MySQL\u5728\u5bf9\u67e5\u8be2\u7ed3\u679c\u6392\u5e8f\u65f6\u4f7f\u7528\u4e34\u65f6\u8868. \u5e38\u89c1\u4e8eorder by \u548c group by, \u6548\u7387\u4f4e. using index \u8868\u793a\u76f8\u5e94\u7684select\u64cd\u4f5c\u4f7f\u7528\u4e86\u8986\u76d6\u7d22\u5f15,\u907f\u514d\u8bbf\u95ee\u8868\u7684\u6570\u636e\u884c,\u6548\u7387\u4e0d\u9519. 6). \u5c3d\u91cf\u4f7f\u7528\u8986\u76d6\u7d22\u5f15,\u907f\u514dselect * \u5c3d\u91cf\u4f7f\u7528\u8986\u76d6\u7d22\u5f15(\u53ea\u8bbf\u95ee\u7d22\u5f15\u7684\u67e5\u8be2( \u7d22\u5f15\u5217 \u5b8c\u5168\u5305\u542b \u67e5\u8be2\u5217 )),\u51cf\u5c11 select * . \u5982\u679c\u67e5\u8be2\u7c7b,\u8d85\u51fa\u7d22\u5f15\u5217,\u4e5f\u4f1a\u964d\u4f4e\u6027\u80fd. TIP: using index: \u4f7f\u7528\u8986\u76d6\u7d22\u5f15\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0 using where: \u5728\u67e5\u627e\u4f7f\u7528\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b, \u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e using index condition: \u67e5\u627e\u4f7f\u7528\u4e86\u7d22\u5f15, \u4f46\u662f\u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e using index; using where: \u67e5\u627e\u4f7f\u7528\u4e86\u7d22\u5f15, \u4f46\u662f\u9700\u8981\u7684\u6570\u636e\u90fd\u5728\u7d22\u5f15\u5217\u4e2d\u80fd\u627e\u5230, \u6240\u4ee5\u4e0d\u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e 12) \u5355\u5217\u7d22\u5f15\u548c\u590d\u5408\u7d22\u5f15 \u5c3d\u91cf\u4f7f\u7528\u590d\u5408\u7d22\u5f15, \u800c\u5c11\u4f7f\u7528\u5355\u5217\u7d22\u5f15 \u521b\u5efa\u590d\u5408\u7d22\u5f15 create index idx_name_sta_address on tb_seller(name, status, address); \u5c31\u76f8\u5f53\u4e8e\u521b\u5efa\u4e86\u4e09\u4e2a\u7d22\u5f15: name name + status name + status + address \u521b\u5efa\u5355\u5217\u7d22\u5f15 create index idx_seller_name on tb_sell(name); create index idx_seller_status on tb_sell(status); create index idx_seller_address on tb_sell(address); \u6570\u636e\u5e93\u4f1a\u9009\u62e9\u4e00\u4e2a\u6700\u4f18\u7684\u7d22\u5f15(\u8fa8\u8bc6\u5ea6\u6700\u9ad8\u7d22\u5f15)\u6765\u4f7f\u7528,\u5e76\u4e0d\u4f1a\u4f7f\u7528\u5168\u90e8\u7d22\u5f15. \u67e5\u770b\u7d22\u5f15\u7d22\u5f15\u60c5\u51b5 \u00b6 show status like 'Handler_read%'; show global status like 'Handler_read%'; 02:06:55 root@localhost[database1]> show status like 'Handler_read%'; +-----------------------+-------+ | Variable_name | Value | +-----------------------+-------+ | Handler_read_first | 0 | | Handler_read_key | 0 | | Handler_read_last | 0 | | Handler_read_next | 0 | | Handler_read_prev | 0 | | Handler_read_rnd | 0 | | Handler_read_rnd_next | 34 | +-----------------------+-------+ 7 rows in set (0.01 sec) 05:08:03 root@localhost[database1]> show global status like 'Handler_read%'; +-----------------------+--------------+ | Variable_name | Value | +-----------------------+--------------+ | Handler_read_first | 622670 | | Handler_read_key | 254215292 | | Handler_read_last | 29 | | Handler_read_next | 273266451 | | Handler_read_prev | 97 | | Handler_read_rnd | 10101645 | | Handler_read_rnd_next | 166307007667 | +-----------------------+--------------+ 7 rows in set (0.00 sec) 05:08:11 root@localhost[database1]> - Handler_read_first: \u7d22\u5f15\u4e2d\u7b2c\u4e00\u6761\u88ab\u8bfb\u7684\u6b21\u6570.\u5982\u679c\u9ad8,\u8868\u793a\u670d\u52a1\u5668\u6b63\u6267\u884c\u5927\u91cf\u5168\u7d22\u5f15\u626b\u63cf(\u8fd9\u4e2a\u503c\u8d8a\u4f4e\u8d8a\u597d). - Handler_read_key: \u5982\u679c\u7d22\u5f15\u6b63\u5728\u5de5\u4f5c,\u8fd9\u4e2a\u503c\u4ee3\u8868\u4e00\u4e2a\u884c\u88ab\u7d22\u5f15\u503c\u8bfb\u7684\u6b21\u6570,\u5982\u679c\u503c\u8d8a\u4f4e,\u8868\u793a\u7d22\u5f15\u5f97\u5230\u7684\u6027\u80fd\u6539\u5584\u4e0d\u9ad8,\u56e0\u4e3a\u7d22\u5f15\u4e0d\u7ecf\u5e38\u4f7f\u7528(\u8fd9\u4e2a\u503c\u8d8a\u9ad8\u8d8a\u597d). - Handler_read_rnd: \u6839\u636e\u56fa\u5b9a\u4f4d\u7f6e\u8bfb\u4e00\u884c\u7684\u8bf7\u6c42\u503c. \u5982\u679c\u4f60\u6b63\u6267\u884c\u5927\u91cf\u67e5\u8be2\u5e76\u9700\u8981\u5bf9\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f,\u8be5\u503c\u5e94\u8be5\u8f83\u9ad8. \u4f60\u53ef\u80fd\u4f7f\u7528\u4e86\u5927\u91cf\u9700\u8981MySQL\u626b\u63cf\u8fd9\u4e2a\u8868\u7684\u67e5\u8be2\u6216\u4f60\u7684\u8fde\u63a5\u6ca1\u6709\u6b63\u786e\u4f7f\u7528\u952e.\u8fd9\u4e2a\u503c\u8f83\u9ad8,\u610f\u5473\u7740\u8fd0\u884c\u6548\u7387\u4f4e,\u53ef\u4ee5\u5efa\u7acb\u7d22\u5f15\u6765\u8865\u6551. - Handler_read_rnd_next: \u5728\u6570\u636e\u6587\u4ef6\u4e2d\u8bfb\u4e0b\u4e00\u884c\u7684\u8bf7\u6c42\u6570.\u5982\u679c\u4f60\u6b63\u5728\u8fdb\u884c\u5927\u91cf\u7684\u8868\u626b\u63cf,\u8be5\u503c\u8f83\u9ad8.\u901a\u5e38\u8bf4\u660e\u4f60\u7684\u8868\u7684\u7d22\u5f15\u4e0d\u6b63\u786e\u6216\u5199\u5165\u7684\u67e5\u8be2\u6ca1\u6709\u5229\u7528\u7d22\u5f15. SQL\u4f18\u5316 \u00b6 \u5927\u6279\u91cf\u63d2\u5165 \u00b6 \u4f7f\u7528load\u547d\u4ee4\u5bfc\u5165\u6570\u636e\u7684\u65f6\u5019,\u9002\u5f53\u7684\u8bbe\u7f6e\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387. \u5bf9\u4e8eInnoDB\u7c7b\u578b\u7684\u8868,\u6709\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387: \u4e3b\u952e\u987a\u5e8f\u63d2\u5165 \u56e0\u4e3aInnoDB\u7c7b\u578b\u7684\u8868\u793a\u6309\u7167\u4e3b\u952e\u7684\u987a\u5e8f\u4fdd\u5b58\u7684,\u6240\u4ee5\u5c06\u5bfc\u5165\u7684\u6570\u636e\u6309\u7167\u4e3b\u952e\u7684\u987a\u5e8f\u6392\u5217,\u53ef\u4ee5\u6709\u6548\u7684\u63d0\u9ad8\u5bfc\u5165\u6570\u636e\u7684\u6548\u7387. \u5982\u679cInnoDB\u8868\u6ca1\u6709\u4e3b\u952e,\u90a3\u4e48\u7cfb\u7edf\u4f1a\u81ea\u52a8\u9ed8\u8ba4\u521b\u5efa\u4e00\u4e2a\u5185\u90e8\u5217\u4f5c\u4e3a\u4e3b\u952e,\u6240\u4ee5\u5982\u679c\u53ef\u4ee5\u7ed9\u8868\u521b\u5efa\u4e00\u4e2a\u4e3b\u952e,\u5c06\u53ef\u4ee5\u5229\u7528\u8fd9\u70b9,\u6765\u63d0\u9ad8\u5bfc\u5165\u6570\u636e\u7684\u6548\u7387. \u63d2\u5165ID\u987a\u5e8f\u6392\u5217\u6570\u636e \u63d2\u5165ID\u65e0\u5e8f\u6392\u5217\u6570\u636e \u5173\u95ed\u552f\u4e00\u6027\u6821\u9a8c \u5728\u5bfc\u5165\u6570\u636e\u524d\u6267\u884c SET UNIQUE_CHECKS = 0 , \u5173\u95ed\u552f\u4e00\u6027\u6821\u9a8c, \u5728\u5bfc\u5165\u7ed3\u675f\u540e\u6267\u884c SET UNIQUE_CHECKS = 1 , \u6062\u590d\u552f\u4e00\u6027\u6821\u9a8c, \u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387. \u624b\u52a8\u63d0\u4ea4\u4e8b\u52a1 \u5982\u679c\u5e94\u7528\u4f7f\u7528\u81ea\u52a8\u63d0\u4ea4\u7684\u65b9\u5f0f,\u5efa\u8bae\u5728\u5bfc\u5165\u524d\u6267\u884c SET AUTOCOMMIT=0 , \u5173\u95ed\u81ea\u52a8\u63d0\u4ea4, \u5bfc\u5165\u7ed3\u675f\u540e\u518d\u6267\u884c SET AUTOCOMMIT=1 , \u6253\u5f00\u81ea\u52a8\u63d0\u4ea4, \u4e5f\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387. \u4f18\u5316insert\u8bed\u53e5 \u00b6 \u5f53\u8fdb\u884c\u6570\u636e\u7684insert\u64cd\u4f5c\u7684\u65f6\u5019,\u53ef\u4ee5\u8003\u8651\u91c7\u7528\u4ee5\u4e0b\u51e0\u79cd\u4f18\u5316\u65b9\u6848 \u5982\u679c\u9700\u8981\u540c\u65f6\u5bf9\u4e00\u5f20\u8868\u63d2\u5165\u5f88\u591a\u884c\u6570\u636e\u65f6,\u5e94\u8be5\u5c3d\u91cf\u4f7f\u7528\u591a\u4e2a\u503c\u8868\u7684insert\u8bed\u53e5,\u8fd9\u79cd\u65b9\u5f0f\u5c06\u5927\u5927\u7684\u7f29\u51cf\u5ba2\u6237\u7aef\u4e0e\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u8fde\u63a5,\u5173\u95ed\u793a\u4f8b,\u539f\u59cb\u65b9\u5f0f\u4e3a: \u4f18\u5316\u540e\u7684\u65b9\u6848\u524d: insert into tb_test values(1,'Tom'); insert into tb_test values(2,'Cat'); insert into tb_test values(3,'Jerry'); \u4f18\u5316\u540e\u7684\u65b9\u6848\u4e3a: insert into tb_test values(1,'Tom'),(2,'Cat'),(3,'Jerry'); \u5728\u4e8b\u52a1\u4e2d\u8fdb\u884c\u6570\u636e\u63d2\u5165 start transaction; insert into tb_test values(1,'Tom'); insert into tb_test values(2,'Cat'); insert into tb_test values(3,'Jerry'); commit; \u6570\u636e\u6709\u5e8f\u63d2\u5165 insert into tb_test values(1,'Tom'); insert into tb_test values(2,'Cat'); insert into tb_test values(3,'Jerry'); insert into tb_test values(4,'Tim'); insert into tb_test values(5,'Rose'); \u4f18\u5316order by\u8bed\u53e5 \u00b6 \u4e24\u79cd\u6392\u5e8f\u65b9\u5f0f \u7b2c\u4e00\u79cd\u662f\u901a\u8fc7\u5bf9\u8fd4\u56de\u6570\u636e\u8fdb\u884c\u6392\u5e8f,\u4e5f\u5c31\u662f\u901a\u5e38\u8bf4\u7684 filesort \u6392\u5e8f, \u6240\u6709\u4e0d\u662f\u901a\u8fc7\u7d22\u5f15\u76f4\u63a5\u8fd4\u56de\u6392\u5e8f\u7ed3\u679c\u7684\u6392\u5e8f\u90fd\u53ebFilesort\u6392\u5e8f. \u7b2c\u4e8c\u79cd\u901a\u8fc7\u6709\u5e8f\u7d22\u5f15\u987a\u5e8f\u626b\u63cf\u76f4\u63a5\u8fd4\u56de\u6709\u5e8f\u6570\u636e,\u8fd9\u79cd\u60c5\u51b5\u5373\u4e3a using index , \u4e0d\u9700\u8981\u989d\u5916\u6392\u5e8f,\u64cd\u4f5c\u6548\u7387\u9ad8. \u4e86\u89e3\u4e86MySQL\u7684\u6392\u5e8f\u65b9\u5f0f,\u4f18\u5316\u76ee\u6807\u5c31\u6e05\u6670\u4e86: \u5c3d\u91cf\u51cf\u5c11\u989d\u5916\u7684\u6392\u5e8f,\u901a\u8fc7\u7d22\u5f15\u76f4\u63a5\u8fd4\u56de\u6709\u5e8f\u6570\u636e. where \u6761\u4ef6\u548c order by \u4f7f\u7528 \u76f8\u540c\u7684\u7d22\u5f15 ,\u5e76\u4e14 Order by \u7684\u987a\u5e8f\u548c \u7d22\u5f15\u987a\u5e8f \u76f8\u540c , \u5e76\u4e14 order by \u7684\u5b57\u6bb5 \u90fd\u662f\u5347\u5e8f ,\u6216\u8005 \u90fd\u662f\u964d\u5e8f . \u5426\u5219\u80af\u5b9a\u9700\u8981\u989d\u5916\u7684\u64cd\u4f5c, \u8fd9\u6837\u5c31\u4f1a\u51fa\u73b0FileSort. Filesort\u7684\u4f18\u5316 \u00b6 \u901a\u8fc7\u521b\u5efa\u5408\u9002\u7684\u7d22\u5f15,\u80fd\u591f\u51cf\u5c11filesort\u7684\u51fa\u73b0,\u4f46\u662f\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b,\u6761\u4ef6\u9650\u5236\u4e0d\u80fd\u8ba9Filesort\u6d88\u5931,\u90a3\u5c31\u9700\u8981\u52a0\u5febFilesort\u7684\u6392\u5e8f\u64cd\u4f5c.\u5bf9\u4e8eFileSort, MySQL\u6709\u4e24\u79cd\u6392\u5e8f\u7b97\u6cd5: \u4e24\u6b21\u626b\u63cf\u7b97\u6cd5: MySQL4.1 \u4e4b\u524d, \u4f7f\u7528\u8be5\u65b9\u5f0f\u6392\u5e8f. \u9996\u5148\u6839\u636e\u6761\u4ef6\u53d6\u51fa\u6392\u5e8f\u5b57\u6bb5\u548c\u884c\u6307\u9488\u4fe1\u606f,\u7136\u540e\u5728\u6392\u5e8f\u533a sort buffer \u4e2d\u6392\u5e8f, \u5982\u679csort buffer \u4e0d\u591f,\u5219\u5728\u4e34\u65f6\u8868temporary table \u4e2d\u5b58\u50a8\u6392\u5e8f\u7ed3\u679c. \u5b8c\u6210\u6392\u5e8f\u540e, \u518d\u6839\u636e\u884c\u6307\u9488\u56de\u8868\u8bfb\u53d6\u8bb0\u5f55, \u8be5\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u91cf\u968f\u673aIO\u64cd\u4f5c. \u4e00\u6b21\u626b\u63cf\u7b97\u6cd5: \u4e00\u6b21\u6027\u53d6\u51fa\u6ee1\u8db3\u6761\u4ef6\u7684\u7d22\u5f15\u5b57\u6bb5,\u7136\u540e\u5728\u6392\u5e8f\u533asort buffer \u4e2d\u6392\u5e8f\u540e\u76f4\u63a5\u8f93\u51fa\u7ed3\u679c\u96c6. \u6392\u5e8f\u65f6\u5185\u5b58\u5f00\u9500\u8f83\u5927, \u4f46\u662f\u6392\u5e8f\u6548\u7387\u6bd4\u4e24\u6b21\u626b\u63cf\u7b97\u6cd5\u8981\u9ad8. MySQL\u901a\u8fc7\u6bd4\u8f83\u7cfb\u7edf\u53d8\u91cf max_length_for_sort_data \u7684\u5927\u5c0f\u548cQuery\u8bed\u53e5\u53d6\u51fa\u7684\u5b57\u6bb5\u603b\u5927\u5c0f,\u6765\u5224\u65ad\u662f\u5426\u90a3\u79cd\u6392\u5e8f\u7b97\u6cd5,\u5982\u679c max_length_for_sort_data \u66f4\u5927,\u90a3\u4e48\u4f7f\u7528\u7b2c\u4e8c\u79cd\u4f18\u5316\u4e4b\u540e\u7684\u7b97\u6cd5,\u5426\u5219\u4f7f\u7528\u7b2c\u4e00\u79cd. \u53ef\u4ee5\u9002\u5f53\u63d0\u9ad8 sort_buffer_size \u548c max_length_for_sort_date \u7cfb\u7edf\u53d8\u91cf,\u6765\u589e\u5927\u6392\u5e8f\u533a\u7684\u5927\u5c0f,\u63d0\u9ad8\u6392\u5e8f\u7684\u6548\u7387. \u4f18\u5316group by\u8bed\u53e5 \u00b6 \u7531\u4e8egroup by \u5b9e\u9645\u4e0a\u4e5f\u540c\u6837\u4f1a\u8fdb\u884c\u6392\u5e8f\u64cd\u4f5c, \u800c\u4e14\u4e8eorder by \u76f8\u6bd4,group by \u53ea\u8981\u53ea\u662f\u591a\u4e86\u6392\u5e8f\u4e4b\u540e\u7684\u5206\u7ec4\u64cd\u4f5c. \u5f53\u7136,\u5982\u679c\u5728\u5206\u7ec4\u7684\u65f6\u5019\u8fd8\u4f7f\u7528\u4e86\u5176\u4ed6\u7684\u4e00\u4e9b\u805a\u5408\u51fd\u6570, \u90a3\u4e48\u8fd8\u9700\u8981\u4e00\u4e9b\u805a\u5408\u51fd\u6570\u7684\u8ba1\u7b97.\u6240\u4ee5,\u5728group by \u7684\u5b9e\u73b0\u8fc7\u7a0b\u4e2d,\u4e8eorder by\u4e00\u6837\u4e5f\u53ef\u4ee5\u5229\u7528\u5230\u7d22\u5f15. \u5982\u679c\u67e5\u8be2\u5305\u542bgroup by \u4f46\u662f\u7528\u6237\u60f3\u8981\u907f\u514d\u6392\u5e8f\u7ed3\u679c\u7684\u6d88\u8017,\u5219\u53ef\u4ee5\u6267\u884c order by null \u7981\u6b62\u6392\u5e8f. \u5982\u4e0b: explain select age, count(*) from emp group by age; \u4f18\u5316\u540e explain select age,count(*) from emp group by age order by null; \u4f18\u5316\u5d4c\u5957\u67e5\u8be2 \u00b6 MySQL4.1 \u7248\u672c\u4e4b\u540e,\u5f00\u59cb\u652f\u6301SQL\u7684\u5b50\u67e5\u8be2.\u8fd9\u4e2a\u6280\u672f\u53ef\u4ee5\u4f7f\u7528select\u8bed\u53e5\u6765\u521b\u5efa\u4e00\u4e2a\u5355\u5217\u7684\u67e5\u8be2,\u7136\u540e\u628a\u8fd9\u4e2a\u7ed3\u679c\u4f5c\u4e3a\u8fc7\u6ee4\u6761\u4ef6\u7528\u5728\u53e6\u4e00\u4e2a\u67e5\u8be2\u4e2d. \u4f7f\u7528\u5b50\u67e5\u8be2\u53ef\u4ee5\u4e00\u6b21\u6027\u7684\u5b8c\u6210\u5f88\u591a\u903b\u8f91\u4e0a\u9700\u8981\u591a\u4e2a\u6b65\u9aa4\u624d\u80fd\u5b8c\u6210\u7684SQL\u64cd\u4f5c, \u540c\u65f6\u4e5f\u53ef\u4ee5\u907f\u514d\u4e8b\u52a1\u6216\u8868\u9501\u6b7b, \u5e76\u4e14\u5199\u8d77\u6765\u4e5f\u5f88\u5bb9\u6613. \u4f46\u662f,\u6709\u4e9b\u60c5\u51b5\u4e0b,\u5b50\u67e5\u8be2\u662f\u53ef\u4ee5\u88ab\u8ddf\u9ad8\u6548\u7684\u8fde\u63a5(JOIN)\u4ee3\u66ff. \u4f18\u5316OR\u6761\u4ef6 \u00b6 \u5bf9\u4e8e\u5305\u542bOR\u67e5\u8be2\u5b50\u53e5,\u5982\u679c\u8981\u5229\u7528\u7d22\u5f15,\u5219OR\u4e4b\u95f4\u7684\u6bcf\u4e2a\u6761\u4ef6\u5217\u90fd\u5fc5\u987b\u7528\u5230\u7d22\u5f15, \u800c\u4e14\u4e0d\u80fd\u4f7f\u7528\u5230\u590d\u5408\u7d22\u5f15; \u5982\u679c\u6ca1\u6709\u7d22\u5f15,\u5219\u5e94\u8be5\u8003\u8651\u589e\u52a0\u7d22\u5f15. \u5efa\u8bae\u4f7f\u7528union\u66ff\u6362or . type\u663e\u793a\u7684\u662f\u8bbf\u95ee\u7c7b\u578b,\u662f\u8f83\u4e3a\u91cd\u8981\u7684\u4e00\u4e2a\u6307\u6807,\u7ed3\u679c\u503c\u4ece\u597d\u5230\u574f\u4f9d\u6b21\u662f: system > const > eq_ref > ref > fulltext > ref_or_null > index_merger > unique_subquery > index_subquery > range > index > ALL UNION \u8bed\u53e5\u7684type\u503c\u4e3aref, OR\u8bed\u53e5\u7684type\u503c\u4e3arange, \u53ef\u4ee5\u770b\u5230\u8fd9\u662f\u4e00\u4e2a\u5f88\u660e\u663e\u7684\u5dee\u8ddd UNION \u8bed\u53e5\u7684ref\u503c\u4e3aconst, OR\u8bed\u53e5\u7684type\u503c\u4e3anull, const\u8868\u793a\u662f\u5e38\u91cf\u503c\u5f15\u7528,\u975e\u5e38\u5feb \u8fd9\u4e24\u9879\u7684\u5dee\u8ddd\u5c31\u8bf4\u660e\u4e86UNION\u8981\u4f18\u4e8eOR. \u4f18\u5316\u5206\u9875\u67e5\u8be2 \u00b6 \u4e00\u822c\u5206\u9875\u67e5\u8be2\u65f6,\u901a\u8fc7\u521b\u5efa\u8986\u76d6\u7d22\u5f15\u80fd\u591f\u6bd4\u8f83\u597d\u7684\u63d0\u9ad8\u6027\u80fd. \u4e00\u4e2a\u5e38\u89c1\u53c8\u975e\u5e38\u5934\u75bc\u7684\u95ee\u9898\u5c31\u662f limit 2000000, 10 , \u6b64\u65f6\u9700\u8981MySQL\u6392\u5e8f\u524d 2000010 \u8bb0\u5f55, \u4ec5\u4ec5\u8fd4\u56de2000000 - 2000010 \u7684\u8bb0\u5f55, \u5176\u4ed6\u8bb0\u5f55\u4e22\u5f03, \u67e5\u8be2\u6392\u5e8f\u7684\u4ee3\u4ef7\u975e\u5e38\u5927. \u4f18\u5316\u601d\u8def\u4e00 \u5728\u7d22\u5f15\u4e0a\u5b8c\u6210\u6392\u5e8f\u5206\u9875\u64cd\u4f5c, \u6700\u540e\u6839\u636e\u4e3b\u952e\u5173\u8054\u56de\u539f\u8868\u67e5\u8be2\u6240\u9700\u8981\u7684\u5176\u4ed6\u5217\u5185\u5bb9. \u4f18\u5316\u601d\u8def\u4e8c \u8be5\u65b9\u6848\u9002\u5e94\u4e8e\u4e3b\u952e\u81ea\u589e\u7684\u8868,\u53ef\u4ee5\u628aLimit\u67e5\u8be2\u8f6c\u6362\u6210\u67d0\u4e2a\u4f4d\u7f6e\u7684\u67e5\u8be2. \u9002\u5e94SQL\u63d0\u793a SQL\u63d0\u793a, \u662f\u4f18\u5316\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u91cd\u8981\u5b57\u6bb5, \u7b80\u5355\u6765\u8bf4, \u5c31\u662f\u5728SQL\u8bed\u53e5\u4e2d\u52a0\u5165\u4e00\u4e9b\u4eba\u4e3a\u7684\u63d0\u793a\u6765\u8fbe\u5230\u4f18\u5316\u64cd\u4f5c\u7684\u76ee\u7684. USE INDEX \u5728\u67e5\u8be2\u8bed\u53e5\u4e2d\u8868\u540d\u7684\u540e\u9762,\u6dfb\u52a0 use index \u6765\u63d0\u4f9b\u5e0c\u671bMySQL\u53bb\u53c2\u8003\u7684\u7d22\u5f15\u5217\u8868,\u5c31\u53ef\u4ee5\u8ba9MySQL\u4e0d\u518d\u8003\u8651\u5176\u4ed6\u53ef\u7528\u7684\u7d22\u5f15. create index idx_serller_name on tb_sellwe(name); IGNORE INDEX \u5982\u679c\u7528\u6237\u53ea\u662f\u5355\u7eaf\u7684\u60f3\u8ba9MySQL\u5ffd\u7565\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u7d22\u5f15, \u5219\u53ef\u4ee5\u4f7f\u7528 ignore index \u4f5c\u4e3a hint. explain select * from tb_seller ignore index(idx_seller_name) where name = 'xxx'; FORCE INDEX \u4e3a\u5f3a\u5236MySQL\u4f7f\u7528\u4e00\u4e2a\u7279\u5b9a\u7684\u7d22\u5f15, \u53ef\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528 force index \u4f5c\u4e3ahint. explain select * from tb_seller force index(idx_seller_address) wher address = 'xxx'; \u67e5\u8be2\u7f13\u5b58\u914d\u7f6e \u00b6 mysql> show status like 'Qcache%'; +-------------------------+------------+ | Variable_name | Value | +-------------------------+------------+ | Qcache_free_blocks | 23822 | <- \u53ef\u7528\u7684\u5185\u5b58\u7684\u5757\u7684\u4e2a\u6570 | Qcache_free_memory | 70259792 | <- \u53ef\u7528\u7684\u5185\u5b58\u7684\u7a7a\u95f4,\u5bb9\u91cf | Qcache_hits | 1594706026 | <- \u67e5\u8be2\u7f13\u51b2\u7684\u547d\u4e2d\u6b21\u6570 | Qcache_inserts | 678651145 | <- \u6dfb\u52a0\u5230\u67e5\u8be2\u7f13\u51b2\u7684\u6b21\u6570 | Qcache_lowmem_prunes | 237160055 | <- \u5982\u679c\u5185\u5b58\u4e0d\u8db3,\u5c06\u6570\u636e\u79fb\u9664\u51fa\u5185\u5b58\u7a7a\u95f4\u7684\u6b21\u6570 | Qcache_not_cached | 1344572761 | <- \u672a\u505a\u7f13\u5b58\u7684\u6b21\u6570 | Qcache_queries_in_cache | 67682 | <- \u67e5\u8be2\u7f13\u5b58\u4e2d\u6ce8\u518c\u7684\u67e5\u8be2\u6570 | Qcache_total_blocks | 181973 | <- \u67e5\u8be2\u7f13\u5b58\u4e2d\u7684\u5757\u603b\u6570 +-------------------------+------------+ \u53c2\u6570 \u542b\u4e49 Qcache_free_blocks \u67e5\u8be2\u7f13\u5b58\u4e2d\u7684\u53ef\u4ee5\u5185\u5b58\u5757\u6570 Qcache_free_memory \u67e5\u8be2\u7f13\u5b58\u7684\u53ef\u7528\u5185\u5b58\u91cf Qcache_hits \u67e5\u8be2\u7f13\u5b58\u547d\u4e2d\u7387 Qcache_inserts \u6dfb\u52a0\u5230\u67e5\u8be2\u7f13\u5b58\u7684\u67e5\u8be2\u6570 Qcache_lowmem_prunes \u7531\u4e8e\u5185\u5b58\u4e0d\u8db3\u800c\u4ece\u67e5\u8be2\u7f13\u5b58\u4e2d\u5220\u9664\u7684\u67e5\u8be2\u6570 Qcache_not_cached \u975e\u7f13\u5b58\u67e5\u8be2\u7684\u6570\u91cf(\u7531\u4e8equery_cache_type\u8bbe\u7f6e\u800c\u65e0\u6cd5\u7f13\u5b58\u6216\u672a\u7f13\u5b58) Qcache_queries_in_cache \u67e5\u8be2\u7f13\u5b58\u4e2d\u6ce8\u518c\u7684\u67e5\u8be2\u6570 Qcache_total_blocks \u67e5\u8be2\u7f13\u5b58\u4e2d\u7684\u5757\u603b\u6570 \u5f00\u542f\u67e5\u8be2\u7f13\u5b58 \u00b6 MySQL\u7684\u67e5\u8be2\u7f13\u5b58\u9ed8\u8ba4\u662f\u5173\u95ed\u7684, \u9700\u8981\u624b\u52a8\u914d\u7f6e\u53c2\u6570 query_cache_type ,\u6765\u5f00\u542f\u67e5\u8be2\u7f13\u5b58. query_cache_type \u8be5\u53c2\u6570\u7684\u53ef\u53d6\u503c\u6709\u4e09\u4e2a \u503c \u542b\u4e49 OFF \u6216 0 \u67e5\u8be2\u7f13\u5b58\u529f\u80fd\u5173\u95ed ON \u6216 1 \u67e5\u8be2\u7f13\u5b58\u529f\u80fd\u6253\u5f00, SELECT \u7684\u7ed3\u679c\u7b26\u5408\u7f13\u5b58\u6761\u4ef6\u5373\u4f1a\u7f13\u5b58,\u5426\u5219,\u4e0d\u4e88\u7f13\u5b58, \u663e\u793a\u6307\u5b9aSQL_NO_CACHE, \u4e0d\u4e88\u7f13\u5b58 DEMAND \u6216 2 \u67e5\u8be2\u7f13\u5b58\u529f\u80fd\u6309\u9700\u8fdb\u884c, \u663e\u793a\u6307\u5b9aSQL_CACHE\u7684SELECT\u8bed\u53e5\u624d\u4f1a\u7f13\u5b58; \u5176\u4ed6\u5747\u4e0d\u4e88\u7f13\u5b58 \u67e5\u8be2\u7f13\u5b58\u5931\u6548\u7684\u60c5\u51b5 \u00b6 1) SQL\u8bed\u53e5\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5,\u60f3\u8981\u547d\u4e2d\u67e5\u8be2\u7f13\u5b58,\u67e5\u8be2\u7684SQL\u8bed\u53e5\u5fc5\u987b\u4e00\u81f4. 2) \u5f53\u67e5\u8be2\u8bed\u53e5\u4e2d\u6709\u4e00\u4e9b\u4e0d\u786e\u5b9a\u7684\u65f6,\u5219\u4e0d\u4f1a\u7f13\u5b58. \u5982: now(), current_date(),curdate(),curtime(),rand(),uuid(),user(),databases(). 3) \u4e0d\u4f7f\u7528\u4efb\u4f55\u8868\u67e5\u8be2\u8bed\u53e5 4) \u67e5\u8be2 mysql, information_schema,\u6216performance_schema \u6570\u636e\u5e93\u4e2d\u7684\u8868\u65f6,\u4e0d\u4f1a\u8d70\u67e5\u8be2\u7f13\u5b58. 5) \u5728\u5b58\u50a8\u7684\u51fd\u6570, \u89e6\u53d1\u5668\u6216\u4e8b\u4ef6\u7684\u4e3b\u4f53\u5185\u6267\u884c\u7684\u67e5\u8be2. 6) \u5982\u679c\u8868\u66f4\u6539,\u5219\u4f7f\u7528\u8be5\u8868\u7684\u6240\u6709\u9ad8\u901f\u7f13\u5b58\u67e5\u8be2\u90fd\u5c06\u53d8\u4e3a\u65e0\u6548\u5e76\u4ece\u9ad8\u901f\u7f13\u5b58\u4e2d\u5220\u9664. \u8fd9\u5305\u62ec\u4f7f\u7528 MERGE \u6620\u5c04\u5230\u5df2\u66f4\u6539\u8868\u7684\u67e5\u8be2.\u4e00\u4e2a\u8868\u53ef\u4ee5\u88ab\u8bb8\u591a\u7c7b\u578b\u7684\u8bed\u53e5, \u5982\u88ab\u6539\u53d8 INSERT, UPDATE, DELETE, TRUNCATE TABLE, ALTER TABLE, DROP TABLE, \u6216 DROP DATABASE. MySQL\u5185\u5b58\u7ba1\u7406\u53ca\u4f18\u5316 \u00b6 \u5185\u5b58\u4f18\u5316\u539f\u5219 \u00b6 1) \u5c06\u5c3d\u91cf\u591a\u7684\u5185\u5b58\u5206\u914d\u7ed9MySQL\u505a\u7f13\u5b58, \u4f46\u8981\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u548c\u5176\u4ed6\u67e5\u8be2\u9884\u7559\u8db3\u591f\u5185\u5b58. 2) MyISAM\u5b58\u50a8\u5f15\u64ce\u7684\u6570\u636e\u6587\u4ef6\u8bfb\u53d6\u4f9d\u8d56\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u81ea\u8eab\u7684 IO \u7f13\u5b58,\u56e0\u6b64,\u5982\u679c\u6709MyISAM\u8868, \u5c31\u8981\u9884\u7559\u66f4\u591a\u7684\u5185\u5b58\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u505aIO\u7f13\u5b58. 3) \u6392\u5e8f\u533a, \u8fde\u63a5\u533a\u7b49\u7f13\u5b58\u662f\u5206\u914d\u7ed9\u6bcf\u4e2a\u6570\u636e\u5e93\u5bf9\u8bdd(session)\u4e13\u4e1a\u7684,\u5176\u9ed8\u8ba4\u503c\u7684\u8bbe\u7f6e\u8981\u6839\u636e\u6700\u5927\u8fde\u63a5\u6570\u5408\u7406\u5206\u914d, \u5982\u679c\u8bbe\u7f6e\u592a\u5927, \u4e0d\u4f46\u6d6a\u8d39\u8d44\u6e90,\u800c\u4e14\u5728\u5e76\u53d1\u8fde\u63a5\u8f83\u9ad8\u65f6\u4f1a\u5bfc\u81f4\u7269\u7406\u5185\u5b58\u8017\u5c3d. MyISAM \u5185\u5b58\u4f18\u5316 \u00b6 MyISAM\u5b58\u50a8\u5f15\u64ce\u4f7f\u7528 key_buffer \u7f13\u5b58\u7d22\u5f15\u5757, \u52a0\u901fMyISAM\u7d22\u5f15\u7684\u8bfb\u5199\u901f\u5ea6. \u5bf9\u4e8eMyISAM\u8868\u7684\u6570\u636e\u5757, mysql\u6ca1\u6709\u7279\u522b\u7684\u7f13\u5b58\u673a\u5236, \u5b8c\u5168\u4f9d\u8d56\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684IO\u7f13\u5b58. key_buffer_size \u00b6 key_buffer_size \u51b3\u5b9aMyISAM\u7d22\u5f15\u5757\u7f13\u51b2\u533a\u7684\u5927\u5c0f, \u76f4\u63a5\u5f71\u54cd\u5230MyISAM\u8868\u7684\u8bfb\u53d6\u6548\u7387. \u53ef\u4ee5\u5728MySQL\u53c2\u6570\u6587\u4ef6\u4e2d\u8bbe\u7f6ekey_buffer_size\u7684\u503c, \u5bf9\u4e8e\u4e00\u822cMyISAM\u6570\u636e\u5e93, \u5efa\u8bae\u81f3\u5c11\u5c06 1/4 \u53ef\u7528\u5185\u5b58\u5206\u914d\u7ed9key_buffer_size. read_buffer_size \u00b6 \u5982\u679c\u9700\u8981\u7ecf\u5e38\u987a\u5e8f\u626b\u63cfmyisam\u8868,\u53ef\u4ee5\u901a\u8fc7\u589e\u5927read_buffer_size\u7684\u503c\u6765\u6539\u5584\u6027\u80fd. \u4f46\u9700\u8981\u6ce8\u610f\u7684\u662fread_buffer_size\u662f\u6bcf\u4e2asession\u72ec\u5360\u7684,\u5982\u679c\u9ed8\u8ba4\u503c\u8bbe\u7f6e\u592a\u5927,\u5c31\u597d\u9020\u6210\u5185\u5b58\u6d6a\u8d39. read_rnd_buffer_size \u00b6 \u5bf9\u4e8e\u9700\u8981\u6392\u5e8f\u7684myisam\u8868\u7684\u67e5\u8be2, \u5982\u5e26\u6709order by \u5b50\u53e5\u7684sql, \u9002\u5f53\u589e\u52a0 read_rnd_buffer_size\u7684\u503c, \u53ef\u4ee5\u6539\u5584\u6b64\u7c7b\u7684sql\u6027\u80fd. \u4f46\u9700\u6ce8\u610f\u7684\u662f, read_rnd_buffer_size\u662f\u6bcf\u4e2asession\u72ec\u5360\u7684, \u5982\u679c\u9ed8\u8ba4\u503c\u8bbe\u7f6e\u592a\u5927,\u5c31\u597d\u9020\u6210\u5185\u5b58\u6d6a\u8d39. InnoDB\u5185\u5b58\u4f18\u5316 \u00b6 innodb\u7528\u4e00\u5757\u5185\u5b58\u533a\u505aIO\u7f13\u5b58, \u8be5\u7f13\u5b58\u6c60\u4e0d\u4ec5\u7528\u6765\u7f13\u5b58innodb\u7684\u7d22\u5f15\u5757, \u800c\u4e14\u4e5f\u7528\u6765\u7f13\u5b58innodb\u7684\u6570\u636e\u5757. innodb_buffer_pool_size \u00b6 \u8be5\u53d8\u91cf\u51b3\u5b9a\u4e86Innodb\u5b58\u50a8\u5f15\u64ce\u8868\u6570\u636e\u548c\u7d22\u5f15\u6570\u636e\u7684\u6700\u5927\u7f13\u5b58\u533a\u5927\u5c0f. \u5728\u4fdd\u8bc1\u64cd\u4f5c\u7cfb\u7edf\u53ca\u5176\u4ed6\u7a0b\u5e8f\u6709\u8db3\u591f\u5185\u5b58\u53ef\u7528\u7684\u60c5\u51b5\u4e0b,innodb_buffer_pool_size \u7684\u503c\u8d8a\u5927, \u7f13\u5b58\u547d\u4e2d\u7387\u8d8a\u9ad8, \u8bbf\u95eeInnoDB\u8868\u9700\u8981\u7684\u78c1\u76d8IO\u5c31\u8d8a\u5c11, \u6027\u80fd\u4e5f\u5c31\u8d8a\u9ad8. innodb_log_buffer_size \u00b6 \u51b3\u5b9a\u4e86InnoDB\u91cd\u505a\u65e5\u5fd7\u7f13\u5b58\u7684\u5927\u5c0f, \u5bf9\u4e8e\u53ef\u80fd\u4ea7\u751f\u5927\u91cf\u66f4\u65b0\u8bb0\u5f55\u7684\u5927\u4e8b\u52a1, \u589e\u52a0innodb_log_buffer_size\u7684\u5927\u5c0f, \u53ef\u7528\u907f\u514dinnodb\u5728\u4e8b\u52a1\u63d0\u4ea4\u524d\u5c31\u6267\u884c\u4e0d\u5fc5\u8981\u7684\u65e5\u5fd7\u5199\u5165\u78c1\u76d8. MySQL\u5e76\u53d1\u53c2\u6570\u8c03\u6574 \u00b6 \u4ece\u5b9e\u73b0\u4e0a\u6765\u8bf4, MySQL Server \u662f\u591a\u7ebf\u7a0b\u7ed3\u679c, \u5305\u62ec\u540e\u53f0\u7ebf\u7a0b\u548c\u5ba2\u6237\u7aef\u7ebf\u7a0b. \u591a\u7ebf\u7a0b\u53ef\u7528\u6709\u6548\u5229\u7528\u670d\u52a1\u5668\u8d44\u6e90,\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u5e76\u53d1\u6027\u80fd. \u5728MySQL\u4e2d, \u63a7\u5236\u5e76\u53d1\u8fde\u63a5\u548c\u7ebf\u7a0b\u7684\u4e3b\u8981\u53c2\u6570\u5305\u62ec max_connections, back_log, thread_cache_size, table_open_cache. max_connections \u00b6 \u91c7\u7528max_connections\u63a7\u5236\u5141\u8bb8\u8fde\u63a5\u5230MySQL\u6570\u636e\u5e93\u7684\u6700\u5927\u6570\u91cf, \u9ed8\u8ba4\u662f151. \u5f53\u5ba2\u6237\u7aef\u8fde\u63a5\u670d\u52a1\u7aef\u65f6,\u5f53\u540c\u65f6\u8fde\u63a5\u7684\u8bf7\u6c42\u8d85\u8fc7151\u65f6,\u5c31\u6ca1\u6709\u53ef\u7528\u7684\u8fde\u63a5\u6765\u5904\u7406\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42,\u540e\u9762\u8fdb\u6765\u7684\u8fde\u63a5\u90fd\u4f1a\u8fdb\u5165\u7b49\u5f85\u72b6\u6001. connections_errors_max_connections \u4e3a\u5f53\u8fde\u63a5\u8fbe\u5230\u6700\u5927\u8bf7\u6c42\u503c\u65f6,\u8fde\u63a5\u62a5\u9519\u7684\u4fe1\u606f. \u5982\u679c\u72b6\u6001\u53d8\u91cf connections_errors_max_connections \u4e0d\u4e3a\u96f6,\u5e76\u4e14\u4e00\u76f4\u589e\u957f, \u5219\u8bf4\u660e\u4e0d\u65ad\u6709\u8fde\u63a5\u8bf7\u6c42\u56e0\u6570\u636e\u5e93\u8fde\u63a5\u5df2\u8fbe\u5230\u5141\u8bb8\u6700\u5927\u503c\u800c\u5931\u8d25, \u8fd9\u65f6\u53ef\u4ee5\u8003\u8651\u589e\u5927max_connections\u7684\u503c. MySQL\u6700\u5927\u53ef\u652f\u6301\u7684\u8fde\u63a5\u6570, \u53d6\u51b3\u4e8e\u5f88\u591a\u56e0\u7d20,\u5305\u62ec\u7ed9\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u7ebf\u7a0b\u5e93\u7684\u8d28\u91cf,\u5185\u5b58\u5927\u5c0f,\u6bcf\u4e2a\u8fde\u63a5\u7684\u8d1f\u8377,CPU\u7684\u5904\u7406\u901f\u5ea6,\u671f\u671b\u7684\u54cd\u5e94\u65f6\u95f4\u7b49.\u5728Linux\u5e73\u53f0\u4e0b,\u6027\u80fd\u597d\u7684\u670d\u52a1\u5668,\u652f\u6301500-1000\u4e2a\u8fde\u63a5\u4e0d\u662f\u96be\u4e8b,\u9700\u8981\u6839\u636e\u670d\u52a1\u5668\u6027\u80fd\u8fdb\u884c\u8bbe\u5b9a. back_log \u00b6 back_log\u53c2\u6570\u63a7\u5236MySQL\u76d1\u542cTCP\u7aef\u53e3\u65f6\u8bbe\u7f6e\u7684\u79ef\u538b\u8bf7\u6c42\u6808\u5927\u5c0f. \u5982\u679cMySQL\u7684\u8fde\u63a5\u6570\u8fbe\u5230max_connections\u65f6,\u65b0\u6765\u7684\u8bf7\u6c42\u5c06\u4f1a\u88ab\u5b58\u5728\u5806\u6808\u4e2d,\u4ee5\u7b49\u5f85\u67d0\u4e00\u8fde\u63a5\u91ca\u653e\u8d44\u6e90, \u8be5\u5806\u6808\u7684\u6570\u91cf\u65e2\u662fback_log. \u5982\u679c\u7b49\u5f85\u7684\u8fde\u63a5\u7684\u6570\u91cf\u8d85\u8fc7back_log, \u5c06\u4e0d\u88ab\u6388\u4e88\u8fde\u63a5\u8d44\u6e90,\u5c06\u4f1a\u62a5\u9519. 5.5.5\u7248\u672c\u4e4b\u524d\u9ed8\u8ba4\u503c\u4e3a50, \u4e4b\u540e\u7684\u7248\u672c\u9ed8\u8ba4\u4e3a50+(max_connections / 5), \u4f46\u6700\u5927\u4e0d\u8d85\u8fc7900. \u5982\u679c\u9700\u8981\u6570\u636e\u5e93\u5728\u77ed\u7684\u65f6\u95f4\u5185\u5904\u7406\u5927\u91cf\u7684\u8fde\u63a5\u8bf7\u6c42, \u53ef\u4ee5\u8003\u8651\u9002\u5f53\u589e\u5927back_log\u7684\u503c. table_open_cache \u00b6 \u8be5\u53c2\u6570\u7528\u6765\u63a7\u5236\u6240\u6709SQL\u8bed\u53e5\u6267\u884c\u7ebf\u7a0b\u53ef\u6253\u5f00\u8868\u7f13\u5b58\u7684\u6570\u91cf, \u800c\u5728\u6267\u884cSQL\u8bed\u53e5\u65f6, \u6bcf\u4e00\u4e2aSQL\u6267\u884c\u7ebf\u7a0b\u81f3\u5c11\u8981\u6253\u5f001\u4e2a\u8868\u7f13\u5b58. \u8be5\u53c2\u6570\u7684\u503c\u5e94\u8be5\u6839\u636e\u8bbe\u7f6e\u7684\u6700\u5927\u8fde\u63a5\u6570max_connections\u4e00\u4e2a\u6bcf\u4e2a\u8fde\u63a5\u6267\u884c\u5173\u8054\u67e5\u8be2\u4e2d\u6d89\u53ca\u7684\u8868\u7684\u6700\u5927\u6570\u91cf\u6765\u8bbe\u5b9a: max_connections x N; hread_cache_size \u00b6 \u4e3a\u4e86\u52a0\u5feb\u6570\u636e\u5e93\u7684\u901f\u5ea6\uff0cMySQL\u4f1a\u7f13\u5b58\u4e00\u5b9a\u6570\u91cf\u7684\u5ba2\u6237\u670d\u52a1\u7ebf\u7a0b\u4ee5\u5907\u91cd\u7528\uff0c\u901a\u8fc7\u53c2\u6570 thread_cache_size \u53ef\u63a7\u5236 MySQL \u7f13\u5b58\u5ba2\u6237\u7aef\u670d\u52a1\u7ebf\u7a0b\u7684\u6570\u91cf\u3002 innodb_lock_wait_timeout \u00b6 \u8be5\u53c2\u6570\u662f\u7528\u6765\u8bbe\u7f6e InnoDB \u4e8b\u52a1\u7b49\u5f85\u884c\u9501\u7684\u65f6\u95f4\uff0c\u9ed8\u8ba4\u503c\u662f 50 ms\uff0c\u53ef\u4ee5\u6839\u636e\u8fdb\u884c\u52a8\u6001\u8bbe\u7f6e\u3002\u5bf9\u4e8e\u9700\u8981\u5feb\u901f\u53cd\u9988\u7684\u4e1a\u52a1\u7cfb\u7edf\u6765\u8bf4\uff0c\u53ef\u4ee5\u5c06\u884c\u9501\u7684\u7b49\u5f85\u65f6\u95f4\u8c03\u5c0f\uff0c\u4ee5\u907f\u514d\u4e8b\u52a1\u957f\u65f6\u95f4\u6302\u8d77\uff1b\u5bf9\u4e8e\u540e\u53f0\u8fd0\u884c\u7684\u6279\u91cf\u5904\u7406\u7a0b\u5e8f\u6765\u8bf4\uff0c\u53ef\u4ee5\u5c06\u884c\u9501\u7684\u7b49\u5f85\u65f6\u95f4\u8c03\u5927\uff0c\u4ee5\u907f\u514d\u53d1\u751f\u5927\u7684\u56de\u6eda\u64cd\u4f5c\u3002 2\u3001MySQL \u9501\u95ee\u9898 \u00b6 2.1\u3001\u9501\u6982\u8ff0 \u00b6 \u9501 \u662f\u8ba1\u7b97\u673a\u534f\u8c03\u591a\u4e2a\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u5e76\u53d1\u8bbf\u95ee\u67d0\u4e00\u8d44\u6e90\u7684\u673a\u5236\uff08\u907f\u514d\u4e89\u62a2\uff09\u3002 \u5728\u6570\u636e\u5e93\u4e2d\uff0c\u9664\u4f20\u7edf\u7684\u8ba1\u7b97\u8d44\u6e90\uff08\u5982\uff1aCPU\u3001RAM\u3001I/O \u7b49\uff09\u7684\u4e89\u7528\u4ee5\u5916\uff0c\u6570\u636e\u4e5f\u662f\u4e00\u79cd\u4f9b\u8bb8\u591a\u7528\u6237\u5171\u4eab\u7684\u8d44\u6e90\u3002\u5982\u4f55\u4fdd\u8bc1\u6570\u636e\u5e76\u53d1\u8bbf\u95ee\u7684\u4e00\u81f4\u6027\u3001\u6709\u6548\u6027\u662f\u6240\u6709\u6570\u636e\u5e93\u5fc5\u987b\u89e3\u51b3\u7684\u4e00\u4e2a\u95ee\u9898\uff0c\u9501\u51b2\u7a81\u4e5f\u662f\u5f71\u54cd\u6570\u636e\u5e93\u5e76\u53d1\u8bbf\u95ee\u6027\u80fd\u7684\u4e00\u4e2a\u91cd\u8981\u56e0\u7d20\u3002 2.2\u3001\u9501\u5206\u7c7b \u00b6 \u4ece\u5bf9\u6570\u636e\u64cd\u4f5c\u7684\u7c92\u5ea6\u5206\uff1a \u8868\u9501\uff1a\u64cd\u4f5c\u65f6\uff0c\u4f1a\u9501\u5b9a\u6574\u4e2a\u8868 \u884c\u9501\uff1a\u64cd\u4f5c\u65f6\uff0c\u4f1a\u9501\u5b9a\u5f53\u524d\u64cd\u4f5c\u884c \u4ece\u5bf9\u6570\u636e\u64cd\u4f5c\u7684\u7c7b\u578b\u5206\uff1a \u8bfb\u9501\uff08\u5171\u4eab\u9501\uff09\uff1a\u9488\u5bf9\u540c\u4e00\u4efd\u6570\u636e\uff0c\u591a\u4e2a\u8bfb\u64cd\u4f5c\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c\u800c\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd \u5199\u9501\uff08\u6392\u5b83\u9501\uff09\uff1a\u5f53\u524d\u64cd\u4f5c\u6ca1\u6709\u5b8c\u6210\u4e4b\u524d\uff0c\u5b83\u4f1a\u963b\u65ad\u5176\u4ed6\u5199\u9501\u548c\u8bfb\u9501 2.3\u3001MySQL\u9501 \u00b6 \u76f8\u5bf9\u4e8e\u5176\u4ed6\u6570\u636e\u5e93\u800c\u8a00\uff0cMySQL \u7684\u9501\u673a\u5236\u6bd4\u8f83\u7b80\u5355\uff0c\u5176\u6700\u663e\u8457\u7684\u7279\u70b9\u5c31\u662f\u4e0d\u540c\u7684\u5b58\u50a8\u5f15\u64ce\u652f\u6301\u4e0d\u540c\u7684\u9501\u673a\u5236\u3002\u4e0b\u8868\u4e2d\u7f57\u5217\u51fa\u4e86\u5404\u4e2a\u5b58\u50a8\u5f15\u64ce\u5bf9\u9501\u7684\u652f\u6301\u60c5\u51b5 \u5b58\u50a8\u5f15\u64ce \u8868\u7ea7\u9501 \u884c\u7ea7\u9501 \u9875\u9762\u9501 MyISAM \u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 InnoDB \u652f\u6301 \u652f\u6301 \u4e0d\u652f\u6301 MEMORY \u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 BDB \u652f\u6301 \u4e0d\u652f\u6301 \u652f\u6301 MySQL \u8fd93\u4e2d\u9501\u7684\u7279\u6027\u53ef\u5927\u81f4\u5f52\u7eb3\u5982\u4e0b\uff1a \u9501\u7c7b\u578b \u7279\u70b9 \u8868\u6781\u9501 \u504f\u5411 MyISAM \u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u9500\u5c0f\uff0c\u52a0\u9501\u5feb\uff1b\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u5927\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u9ad8\uff0c\u5e76\u53d1\u5ea6\u6700\u4f4e \u884c\u6781\u9501 \u504f\u5411 InnoDB \u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u9500\u5927\uff0c\u52a0\u9501\u6162\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u6700\u5c0f\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u4f4e\uff0c\u5e76\u53d1\u5ea6\u4e5f\u6700\u9ad8 \u9875\u9762\u9501 \u5f00\u9501\u548c\u52a0\u9501\u65f6\u95f4\u4ecb\u4e8e\u8868\u9501\u548c\u884c\u9501\u4e4b\u95f4\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u4ecb\u4e8e\u8868\u9501\u548c\u884c\u9501\u4e4b\u95f4\uff0c\u5e76\u53d1\u5ea6\u4e00\u822c \u4ece\u4e0a\u8ff0\u6765\u770b\uff0c\u5f88\u96be\u7b3c\u7edf\u5730\u8bf4\u54ea\u79cd\u9501\u66f4\u597d\uff0c\u53ea\u80fd\u5c31\u5177\u4f53\u5e94\u7528\u7684\u7279\u70b9\u6765\u8bf4\u54ea\u79cd\u9501\u66f4\u5408\u9002\u3002 \u4ec5\u4ece\u9501\u7684\u89d2\u5ea6\u6765\u8bf4\uff1a \u8868\u7ea7\u9501 \u66f4\u9002\u5408\u4ee5\u67e5\u8be2\u4e3a\u4e3b\uff0c\u53ea\u6709\u5c11\u91cf\u6309\u7d22\u5f15\u6761\u4ef6\u66f4\u65b0\u6570\u636e\u7684\u5e94\u7528\uff0c\u5982web\u5e94\u7528\uff1b \u884c\u7ea7\u9501 \u66f4\u9002\u5408\u4e8e\u6709\u5927\u91cf\u6309\u7d22\u5f15\u6761\u4ef6\u5e76\u53d1\u66f4\u65b0\u5c11\u91cf\u4e0d\u540c\u6570\u636e\uff0c\u540c\u65f6\u53c8\u6709\u5e76\u67e5\u8be2\u7684\u5e94\u7528\uff0c\u5982\u4e00\u4e9b\u5728\u7ebf\u4e8b\u52a1\u5904\u7406\uff08OLTP\uff09\u7cfb\u7edf\u3002 2.4\u3001MyISAM \u8868\u9501 \u00b6 MyISAM \u5b58\u50a8\u5f15\u64ce\u53ea\u652f\u6301\u8868\u9501\uff0c\u8fd9\u4e5f\u662f MySQL \u5f00\u59cb\u51e0\u4e2a\u7248\u672c\u4e2d\u552f\u4e00\u652f\u6301\u7684\u9501\u7c7b\u578b\u3002 2.4.1\u3001\u5982\u4f55\u52a0\u8868\u9501 \u00b6 MyISAM \u5728\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff08SELECT\uff09\u524d\uff0c\u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u7684\u6240\u6709\u8868\u52a0\u8bfb\u9501\uff0c\u5728\u6267\u884c\u66f4\u65b0\u64cd\u4f5c\uff08UPDATE\u3001DELETE\u3001INSERT\u7b49\uff09\u524d\uff0c\u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u7684\u8868\u52a0\u5199\u9501\u3002 \u8fd9\u4e2a\u8fc7\u7a0b\u5e76\u4e0d\u9700\u8981\u7528\u6237\u5e72\u9884\uff0c\u56e0\u6b64\uff0c\u7528\u6237\u4e00\u822c\u4e0d\u9700\u8981\u76f4\u63a5\u7528 LOCJ TABLE \u547d\u4ee4\u7ed9 MyISAM \u8868\u663e\u793a\u52a0\u9501\u3002 \u663e\u793a\u52a0\u8868\u9501\u8bed\u6cd5\uff1a \u52a0\u8bfb\u9501\uff1alock table table_name read; \u52a0\u5199\u9501\uff1alock table table_name write; 2.4.4\u3001\u7ed3\u8bba \u00b6 \u5f53\u524d\u9501\u6a21\u5f0f\\\u8bf7\u6c42\u9501\u6a21\u5f0f None \u8bfb\u9501 \u5199\u9501 \u8bfb\u9501 \u662f \u662f \u5426 \u5199\u9501 \u662f \u5426 \u5426 \u7531\u4e0a\u8868\u53ef\u89c1\uff1a 1\uff09\u5bf9 MyISAM \u8868\u7684\u8bfb\u64cd\u4f5c\uff0c\u4e0d\u4f1a\u963b\u585e\u5176\u4ed6\u7528\u6237\u5bf9\u540c\u4e00\u8868\u7684\u8bfb\u8bf7\u6c42\uff0c\u4f46\u4f1a\u963b\u585e\u5bf9\u7edf\u4e00\u8868\u7684\u5199\u8bf7\u6c42\uff1b 2\uff09\u5bf9 MyISAM \u8868\u7684\u5199\u64cd\u4f5c\uff0c\u5219\u4f1a\u963b\u585e\u5176\u4ed6\u7528\u6237\u5bf9\u540c\u4e00\u8868\u7684\u8bfb\u548c\u5199\u64cd\u4f5c\uff1b \u7b80\u800c\u8a00\u4e4b\uff0c \u5c31\u662f\u8bfb\u9501\u4f1a\u963b\u585e\u5199\uff0c\u4f46\u662f\u4e0d\u4f1a\u963b\u585e\u8bfb \u3002\u800c\u5199\u9501\uff0c \u65e2\u4f1a\u963b\u585e\u8bfb\uff0c\u53c8\u4f1a\u963b\u585e\u5199 \u3002 \u6b64\u5916\uff0c MyISAM \u7684\u8bfb\u5199\u9501\u8c03\u5ea6\u662f \u5199 \u4f18\u5148\u3002\u8fd9\u4e5f\u662f MyISAM \u4e0d\u9002\u5408\u4f5c\u4e3a\u5199\u4e3a\u4e3b\u7684\u8868\u7684\u5b58\u50a8\u5f15\u64ce\u7684\u539f\u56e0\u3002\u56e0\u4e3a\u5199\u9501\u540e\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4e0d\u80fd\u505a\u4efb\u4f55\u64cd\u4f5c\uff0c\u5927\u91cf\u7684\u66f4\u65b0\u4f1a\u4f7f\u67e5\u8be2\u5f88\u96be\u5f97\u5230\u9501\uff0c\u4ece\u800c\u9020\u6210\u6c38\u8fdc\u963b\u585e\u3002 2.4.5\u3001\u67e5\u770b\u9501\u7684\u4e89\u7528\u60c5\u51b5 \u00b6 show open tables; In_use\uff1a\u8868\u5f53\u524d\u88ab\u67e5\u8be2\u4f7f\u7528\u7684\u6b21\u6570\uff0c\u5982\u679c\u4e3a\u96f6\uff0c\u5219\u8868\u662f\u6253\u5f00\u7684\uff0c\u4f46\u662f\u5f53\u524d\u6ca1\u6709\u88ab\u4f7f\u7528\u3002 Name_locked\uff1a\u8868\u540d\u79f0\u662f\u5426\u88ab\u9501\u5b9a\u3002\u540d\u79f0\u9501\u5b9a\u7528\u4e8e\u53d6\u6d88\u8868\u6216\u5bf9\u8868\u8fdb\u884c\u91cd\u547d\u540d\u7b49\u64cd\u4f5c\u3002 show status like 'Table_locks%'; mysql> show status like 'Table_lock%'; +-----------------------+------------+ | Variable_name | Value | +-----------------------+------------+ | Table_locks_immediate | 2772892035 | | Table_locks_waited | 64713 | +-----------------------+------------+ 2 rows in set (0.00 sec) Table_locks_immediate\uff1a\u6307\u7684\u662f\u80fd\u591f\u7acb\u5373\u83b7\u5f97\u8868\u7ea7\u9501\u7684\u6b21\u6570\uff0c\u6bcf\u7acb\u5373\u83b7\u53d6\u9501\uff0c\u503c\u52a0 1\u3002 Table_locks_waited\uff1a\u6307\u7684\u662f\u4e0d\u80fd\u7acb\u5373\u83b7\u53d6\u8868\u6781\u9501\u800c\u9700\u8981\u7b49\u5f85\u7684\u6b21\u6570\uff0c\u6bcf\u7b49\u5f85\u4e00\u6b21\uff0c\u8be5\u503c\u52a0 1\uff0c\u6b64\u503c\u8d8a\u9ad8\u8bf4\u660e\u5b58\u5728\u7740\u8f83\u4e3a\u4e25\u91cd\u7684\u8868\u6781\u9501\u4e89\u7528\u60c5\u51b5\u3002 2.5\u3001InnoDB \u884c\u9501 \u00b6 2.5.1\u3001\u884c\u9501\u4ecb\u7ecd \u00b6 \u884c\u9501\u7279\u70b9\uff1a\u504f\u5411 InnoDB \u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u9500\u5927\uff0c\u52a0\u9501\u6162\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u5c0f\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u4f4e\uff0c\u5e76\u53d1\u5ea6\u6700\u9ad8\u3002 InnoDB \u4e0e MyISAM \u7684\u6700\u5927\u4e0d\u540c\u6709\u4e24\u70b9\uff1a\u4e00\u662f\u652f\u6301\u4e8b\u52a1\uff0c\u4e8c\u662f\u91c7\u7528\u4e86\u884c\u7ea7\u9501\u3002 2.5.2\u3001\u80cc\u666f\u77e5\u8bc6 \u00b6 1\u3001\u4e8b\u52a1\u53ca\u5176ACID\u5c5e\u6027 \u4e8b\u52a1\u662f\u7531\u4e00\u7ec4 SQL \u8bed\u53e5\u7ec4\u6210\u7684\u903b\u8f91\u5904\u7406\u5355\u5143\u3002 \u4e8b\u52a1\u5177\u6709\u4ee5\u4e0b 4 \u4e2a\u7279\u6027\uff0c\u7b80\u79f0\u4e3a \u4e8b\u52a1ACID\u5c5e\u6027 \u3002 ACID\u5c5e\u6027 \u542b\u4e49 \u539f\u5b50\u6027\uff08Atomicity\uff09 \u4e8b\u52a1\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\u5355\u5143\uff0c\u5176\u5bf9\u6570\u636e\u7684\u4fee\u6539\uff0c\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e48\u5168\u90e8\u5931\u8d25 \u4e00\u81f4\u6027\uff08Consistent\uff09 \u5728\u4e8b\u52a1\u5f00\u59cb\u548c\u5b8c\u6210\u65f6\uff0c\u6570\u636e\u90fd\u5fc5\u987b\u4fdd\u6301\u4e00\u81f4\u72b6\u6001 \u9694\u79bb\u6027\uff08Isolation\uff09 \u6570\u636e\u5e93\u7cfb\u7edf\u63d0\u4f9b\u4e00\u5b9a\u7684\u9694\u79bb\u673a\u5236\uff0c\u4fdd\u8bc1\u4e8b\u52a1\u5728\u4e0d\u53d7\u5916\u90e8\u5e76\u53d1\u64cd\u4f5c\u5f71\u54cd\u7684\u201c\u72ec\u7acb\u73af\u5883\u201d\u4e0b\u8fd0\u884c \u6301\u4e45\u6027\uff08Durable\uff09 \u4e8b\u52a1\u5b8c\u6210\u4e4b\u540e\uff0c\u5bf9\u4e8e\u6570\u636e\u7684\u4fee\u6539\u662f\u6c38\u4e45\u7684\u3002 2\u3001\u5e76\u53d1\u4e8b\u52a1\u5904\u7406\u5e26\u6765\u7684\u95ee\u9898 \u95ee\u9898 \u542b\u4e49 \u4e22\u5931\u66f4\u65b0\uff08Lost Update\uff09 \u5f53\u4e24\u4e2a\u6216\u591a\u4e2a\u4e8b\u52a1\u9009\u62e9\u540c\u4e00\u884c\uff0c\u6700\u521d\u7684\u4e8b\u52a1\u4fee\u6539\u7684\u503c\uff0c\u4f1a\u88ab\u540e\u9762\u7684\u4e8b\u52a1\u4fee\u6539\u7684\u503c\u8986\u76d6\u3002 \u810f\u8bfb\uff08Dirty Reads\uff09 \u5f53\u4e00\u4e2a\u4e8b\u52a1\u6b63\u5728\u8bbf\u95ee\u6570\u636e\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u884c\u4e86\u4fee\u6539\uff0c\u800c\u8fd9\u79cd\u4fee\u6539\u8fd8\u6ca1\u6709\u63d0\u4ea4\u5230\u6570\u636e\u5e93\u4e2d\u3002\u8fd9\u65f6\uff0c\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u4e5f\u8bbf\u95ee\u4e86\u8fd9\u4e2a\u6570\u636e\uff0c\u7136\u540e\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6570\u636e\u3002 \u4e0d\u53ef\u91cd\u590d\u8bfb\uff08Non-Repeatable Reads\uff09 \u4e00\u4e2a\u4e8b\u52a1\u5728\u8bfb\u53d6\u67d0\u4e9b\u6570\u636e\u540e\u7684\u67d0\u4e2a\u65f6\u95f4\uff0c\u518d\u6b21\u8bfb\u53d6\u4ee5\u524d\u8bfb\u8fc7\u7684\u6570\u636e\uff0c\u5374\u53d1\u73b0\u548c\u4ee5\u524d\u8bfb\u51fa\u7684\u6570\u636e\u4e0d\u4e00\u81f4\u3002 \u5e7b\u8bfb\uff08Phantom Reads\uff09 \u4e00\u4e2a\u4e8b\u52a1\u6309\u7167\u76f8\u540c\u7684\u67e5\u8be2\u6761\u4ef6\u91cd\u65b0\u8bfb\u53d6\u4ee5\u524d\u67e5\u8be2\u8fc7\u7684\u6570\u636e\uff0c\u5374\u53d1\u73b0\u5176\u4ed6\u4e8b\u52a1\u63d2\u5165\u4e86\u6ee1\u8db3\u67e5\u8be2\u6761\u4ef6\u7684\u65b0\u6570\u636e\u3002 3\u3001\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b \u4e3a\u4e86\u89e3\u51b3\u4e0a\u8ff0\u63d0\u5230\u7684\u4e8b\u52a1\u5e76\u53d1\u95ee\u9898\uff0c\u6570\u636e\u5e93\u63d0\u4f9b\u4e00\u5b9a\u7684\u4e8b\u52a1\u9694\u79bb\u673a\u5236\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u9694\u79bb\u8d8a\u4e25\u683c\uff0c\u5e76\u53d1\u526f\u4f5c\u7528\u8d8a\u5c0f\uff0c\u4f46\u4ed8\u51fa\u7684\u4ee3\u4ef7\u4e5f\u5c31\u8d8a\u5927\uff0c\u56e0\u4e3a\u4e8b\u52a1\u9694\u79bb\u5b9e\u8d28\u4e0a\u5c31\u662f\u4f7f\u7528\u4e8b\u52a1\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u201c\u4e32\u884c\u5316\u201d\u8fdb\u884c\uff0c\u8fd9\u663e\u7136\u4e0e\u201d\u5e76\u53d1\u201c\u662f\u77db\u76fe\u7684\u3002 \u6570\u636e\u5e93\u7684\u9694\u79bb\u7ea7\u522b\u6709 4 \u4e2a\uff0c\u7531\u4f4e\u5230\u9ad8\u4f9d\u6b21\u4e3a Read uncommitted \u3001 Read committed \u3001 Repeatable read \u3001 Serializbale \uff0c\u8fd9\u56db\u4e2a\u51e0\u676f\u53ef\u4ee5\u9010\u4e2a\u89e3\u51b3 \u810f\u5199\u3001\u810f\u8bfb\u3001\u4e0d\u53ef\u91cd\u590d\u8bfb\u3001\u5e7b\u8bfb\u8fd9\u51e0\u7c7b\u95ee\u9898\u3002 \u9694\u79bb\u7ea7\u522b \u4e22\u5931\u66f4\u65b0 \u810f\u8bfb \u4e0d\u53ef\u91cd\u590d\u8bfb \u5e7b\u8bfb Read uncommitted \u00d7 \u221a \u221a \u221a Read committed \u00d7 \u00d7 \u221a \u221a Repeatable read\uff08\u9ed8\u8ba4\uff09 \u00d7 \u00d7 \u00d7 \u221a Serializable \u00d7 \u00d7 \u00d7 \u00d7 \u5907\u6ce8 \uff1a \u221a \u4ee3\u8868\u53ef\u80fd\u51fa\u73b0 \uff0c \u00d7 \u4ee3\u8868\u4e0d\u4f1a\u51fa\u73b0 \u3002 MySQL \u7684\u6570\u636e\u5e93\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u4e3a Repeatable read \uff0c\u67e5\u770b\u65b9\u5f0f\u4e3a\uff1a show variables like 'tx_isolation'; 2.5.3\u3001InnoDB \u7684\u884c\u9501\u6a21\u5f0f \u00b6 InnoDB \u5b9e\u73b0\u4e86\u4ee5\u4e0b\u4e24\u79cd\u7c7b\u578b\u7684\u884c\u9501\u3002 \u5171\u4eab\u9501\uff08S\uff09\uff1a\u53c8\u79f0\u4e3a \u8bfb\u9501\uff0c\u7b80\u79f0 S\u9501 \uff0c\u5171\u4eab\u9501\u5c31\u662f\u591a\u4e2a\u4e8b\u52a1\u5bf9\u4e8e\u540c\u4e00\u6570\u636e\u53ef\u4ee5\u5171\u4eab\u4e00\u628a\u9501\uff0c\u90fd\u80fd\u8bbf\u95ee\u5230\u6570\u636e\uff0c\u4f46\u662f\u53ea\u80fd\u8bfb\u4e0d\u80fd\u4fee\u6539\u3002 \u6392\u4ed6\u9501\uff08X\uff09\uff1a\u53c8\u79f0\u4e3a \u5199\u9501\uff0c\u7b80\u79f0 X\u9501 \uff0c\u6392\u4ed6\u9501\u4e0d\u80fd\u4e0e\u5176\u4ed6\u9501\u5e76\u5b58\uff0c\u5982\u4e00\u4e2a\u4e8b\u52a1\u83b7\u53d6\u4e86\u4e00\u4e2a\u6570\u636e\u884c\u7684\u6392\u4ed6\u9501\uff0c\u5176\u4ed6\u4e8b\u52a1\u5c31\u4e0d\u80fd\u518d\u83b7\u53d6\u8be5\u884c\u7684\u5176\u4ed6\u9501\uff0c\u5305\u62ec\u5171\u4eab\u9501\u548c\u6392\u4ed6\u9501\uff0c\u4f46\u662f\u83b7\u53d6\u6392\u4ed6\u9501\u7684\u4e8b\u52a1\u662f\u53ef\u4ee5\u5bf9\u6570\u636e\u5c31 \u884c \u8bfb\u53d6\u548c\u4fee\u6539\u3002 \u5bf9\u4e8e UPDATE\u3001DELETE\u3001INSERT \u8bed\u53e5\uff0cInnoDB \u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u6570\u636e\u96c6\u52a0 \u6392\u4ed6\u9501\uff08X\uff09\uff1b \u5bf9\u4e8e\u666e\u901a SELECT \u8bed\u53e5\uff0c InnoDB \u4e0d\u4f1a\u52a0\u4efb\u4f55\u9501\uff1b \u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u8bed\u53e5\u663e\u793a\u7ed9\u8bb0\u5f55\u96c6\u52a0\u5171\u4eab\u9501\u6216\u6392\u4ed6\u9501\u3002 \u5171\u4eab\u9501\uff08S\uff09\uff1aselect * from table_name where ... lock in share mode \u6392\u4ed6\u9501\uff08X\uff09\uff1aselect * from table_name where ... for update 2.5.6\u3001\u65e0\u7d22\u5f15\u884c\u9501\u5347\u7ea7\u4e3a\u8868\u9501 \u00b6 \u5982\u679c\u4e0d\u901a\u8fc7\u7d22\u5f15\u6761\u4ef6\u68c0\u7d22\u6570\u636e\uff0c\u90a3\u4e48 InnoDB \u5c06\u5bf9\u8868\u4e2d\u7684\u6240\u6709\u8bb0\u5f55\u52a0\u9501\uff0c\u5b9e\u9645\u6548\u679c\u8ddf\u8868\u9501\u4e00\u6837\u3002 \u67e5\u770b\u5f53\u524d\u8868\u7684\u7d22\u5f15\uff1a show index from test_innodb_lock; \u7531\u4e8e\u6267\u884c\u66f4\u65b0\u65f6\uff0c name \u5b57\u6bb5\u672c\u6765\u4e3a varchar \u7c7b\u578b\uff0c\u6211\u4eec\u662f\u4f5c\u4e3a\u6570\u636e\u7c7b\u578b\u4f7f\u7528\uff0c\u5b58\u5728\u7c7b\u578b\u8f6c\u6362\uff0c\u7d22\u5f15\u5931\u6548\uff0c\u6700\u7ec8 \u884c\u9501\u53d8\u4e3a\u8868\u9501\u3002 2.5.7\u3001\u95f4\u9699\u9501\u5371\u5bb3 \u00b6 \u5f53\u6211\u4eec\u7528\u8303\u56f4\u6761\u4ef6\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u76f8\u7b49\u6761\u4ef6\u68c0\u7d22\u6570\u636e\uff0c\u5e76\u8bf7\u6c42\u5171\u4eab\u6216\u6392\u5b83\u9501\u65f6\uff0cInnoDB \u4f1a\u7ed9\u7b26\u5408\u6761\u4ef6\u7684\u5df2\u6709\u6570\u636e\u8fdb\u884c\u52a0\u9501\uff1b\u5bf9\u4e8e\u952e\u503c\u5728\u6761\u4ef6\u8303\u56f4\u5185\u4f46\u4e0d\u5b58\u5728\u8bb0\u5f55\uff0c\u53eb\u505a\u201c \u95f4\u9699\uff08GAP\uff09 \u201d\uff0cInnoDB \u4e5f\u4f1a\u5bf9\u8fd9\u4e2a\u201c\u95f4\u9699\u201d\u52a0\u9501\uff0c\u8fd9\u79cd\u673a\u5236\u5c31\u662f\u6240\u8c13\u7684 \u95f4\u9699\u9501\uff08Next-key\u9501\uff09 2.5.8\u3001InnoDB\u884c\u9501\u4e89\u7528\u60c5\u51b5 \u00b6 show status like 'innodb_row_lock%'; Innodb_row_lock_current_waits: \u5f53\u524d\u6b63\u5728\u7b49\u5f85\u9501\u5b9a\u7684\u6570\u91cf Innodb_row_lock_time: \u4ece\u7cfb\u7edf\u542f\u52a8\u5230\u73b0\u5728\u9501\u5b9a\u603b\u65f6\u95f4\u957f\u5ea6 Innodb_row_lock_time_avg:\u6bcf\u6b21\u7b49\u5f85\u6240\u82b1\u5e73\u5747\u65f6\u957f Innodb_row_lock_time_max:\u4ece\u7cfb\u7edf\u542f\u52a8\u5230\u73b0\u5728\u7b49\u5f85\u6700\u957f\u7684\u4e00\u6b21\u6240\u82b1\u7684\u65f6\u95f4 Innodb_row_lock_waits: \u7cfb\u7edf\u542f\u52a8\u540e\u5230\u73b0\u5728\u603b\u5171\u7b49\u5f85\u7684\u6b21\u6570 \u5f53\u7b49\u5f85\u7684\u6b21\u6570\u5f88\u9ad8\uff0c\u800c\u4e14\u6bcf\u6b21\u7b49\u5f85\u7684\u65f6\u957f\u4e5f\u4e0d\u5c0f\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5206\u6790\u7cfb\u7edf\u4e2d\u4e3a\u4ec0\u4e48\u4f1a\u6709\u5982\u6b64\u591a\u7684\u7b49\u5f85\uff0c\u7136\u540e\u6839\u636e\u5206\u6790\u7ed3\u679c\u7740\u624b\u5236\u5b9a\u4f18\u5316\u8ba1\u5212\u3002 2.5.9\u3001\u603b\u7ed3 \u00b6 InnoDB \u5b58\u50a8\u5f15\u64ce\u7531\u4e8e\u5b9e\u73b0\u4e86\u884c\u7ea7\u9501\u5b9a\uff0c\u867d\u7136\u5728\u9501\u5b9a\u673a\u5236\u7684\u5b9e\u73b0\u65b9\u9762\u5e26\u6765\u4e86\u6027\u80fd\u635f\u8017\u53ef\u80fd\u6bd4\u8868\u6781\u9501\u4f1a\u66f4\u9ad8\u4e00\u4e9b\uff0c\u4f46\u662f\u5728\u6574\u4f53\u5e76\u53d1\u5904\u7406\u80fd\u529b\u65b9\u9762\u8981\u8fdc\u8fdc\u4f18\u4e8eMyISAM\u7684\u8868\u9501\u7684\u3002\u5f53\u7cfb\u7edf\u5e76\u53d1\u91cf\u6bd4\u8f83\u9ad8\u7684\u65f6\u5019\uff0cInnoDB \u7684\u6574\u4f53\u6027\u80fd\u548c MyISAM \u76f8\u6bd4\u5c31\u4f1a\u6709\u6bd4\u8f83\u660e\u663e\u7684\u4f18\u52bf\u3002 \u4f46\u662f\uff0cInnoDB \u7684\u884c\u7ea7\u9501\u4e5f\u6709\u8106\u5f31\u7684\u4e00\u9762\uff0c\u5f53\u6211\u4eec\u4f7f\u7528\u4e0d\u5f53\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u8ba9 InnoDB \u7684\u6574\u4f53\u6027\u80fd\u8868\u73b0\u4e0d\u4ec5\u4e0d\u80fd\u6bd4 MyISAM \u9ad8\uff0c\u751a\u81f3\u4f1a\u66f4\u5dee\u3002 2.5.10\u3001\u4f18\u5316\u5efa\u8bae \u00b6 \u5c3d\u53ef\u80fd\u8ba9\u6240\u6709\u6570\u636e\u68c0\u7d22\u90fd\u80fd\u901a\u8fc7\u7d22\u5f15\u6765\u5b8c\u6210\uff0c\u907f\u514d\u65e0\u7d22\u5f15\u884c\u9501\u5347\u7ea7\u4e3a\u8868\u9501\u3002 \u5408\u7406\u8bbe\u8ba1\u7d22\u5f15\uff0c\u5c3d\u91cf\u7f29\u5c0f\u9501\u7684\u8303\u56f4 \u5c3d\u53ef\u80fd\u51cf\u5c11\u7d22\u5f15\u6761\u4ef6\uff0c\u53ca\u7d22\u5f15\u8303\u56f4\uff0c\u907f\u514d\u95f4\u9699\u9501 \u5c3d\u91cf\u63a7\u5236\u4e8b\u52a1\u5927\u5c0f\uff0c\u51cf\u5c11\u9501\u5b9a\u8d44\u6e90\u91cf\u548c\u65f6\u95f4\u957f\u5ea6 \u5c3d\u53ef\u80fd\u4f7f\u7528\u4f4e\u7ea7\u522b\u4e8b\u52a1\u9694\u79bb\uff08\u4f46\u662f\u9700\u8981\u4e1a\u52a1\u5c42\u6ee1\u8db3\u9700\u6c42\uff09 3\u3001\u5e38\u7528MySQL\u6280\u5de7 \u00b6 1. SQL \u6267\u884c\u987a\u5e8f \u00b6 \u7f16\u5199\u987a\u5e8f SELECT DISTINCT <select list> FROM <left_table> <join_type> JOIN <right_table> ON <join_condition> WHERE <where_condition> GROUP BY <group_by_list> HAVING <having_condition> ORDER BY <order_by_condition> LIMIT <limit_params> 12345678910111213141516 \u6267\u884c\u987a\u5e8f FROM <left_table> ON <join_condition> <join_type> JOIN <right_table> WHERE <where_condition> GROUP BY <group_by_list> HAVING <having_condition> SELECT DISTINCT <select list> ORDER BY <order_by_condition> LIMIT <limit_params> 2. \u6b63\u5219\u8868\u8fbe\u5f0f\u4f7f\u7528 \u00b6 \u6b63\u5219\u8868\u8fbe\u5f0f\uff08Regular Expression\uff09\u662f\u6307\u4e00\u4e2a\u7528\u6765\u63cf\u8ff0\u6216\u8005\u5339\u914d\u4e00\u7cfb\u5217\u7b26\u5408\u67d0\u4e2a\u53e5\u6cd5\u89c4\u5219\u7684\u5b57\u7b26\u4e32\u7684\u5355\u4e2a\u5b57\u7b26\u4e32\u3002 \u7b26\u53f7 \u542b\u4e49 ^ \u5728\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u8fdb\u884c\u5339\u914d $ \u5728\u5b57\u7b26\u4e32\u672b\u5c3e\u5904\u8fdb\u884c\u5339\u914d . \u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26, \u5305\u62ec\u6362\u884c\u7b26 [\u2026] \u5339\u914d\u51fa\u62ec\u53f7\u5185\u7684\u4efb\u610f\u5b57\u7b26 [^\u2026] \u5339\u914d\u4e0d\u51fa\u62ec\u53f7\u5185\u7684\u4efb\u610f\u5b57\u7b26 a* \u5339\u914d\u96f6\u4e2a\u6216\u8005\u591a\u4e2aa(\u5305\u62ec\u7a7a\u4e32) a+ \u5339\u914d\u4e00\u4e2a\u6216\u8005\u591a\u4e2aa(\u4e0d\u5305\u62ec\u7a7a\u4e32) a? \u5339\u914d\u96f6\u4e2a\u6216\u8005\u4e00\u4e2aa a1|a2 \u5339\u914da1\u6216a2 a(m) \u5339\u914dm\u4e2aa a(m,) \u81f3\u5c11\u5339\u914dm\u4e2aa a(m,n) \u5339\u914dm\u4e2aa \u5230 n\u4e2aa a(,n) \u5339\u914d0\u5230n\u4e2aa (\u2026) \u5c06\u6a21\u5f0f\u5143\u7d20\u7ec4\u6210\u5355\u4e00\u5143\u7d20 select * from emp where name regexp '^T'; select * from emp where name regexp '2$'; select * from emp where name regexp '[uvw]'; 12345 3. MySQL \u5e38\u7528\u51fd\u6570 \u00b6 \u6570\u5b57\u51fd\u6570 \u51fd\u6570\u540d\u79f0 \u4f5c \u7528 ABS \u6c42\u7edd\u5bf9\u503c SQRT \u6c42\u4e8c\u6b21\u65b9\u6839 MOD \u6c42\u4f59\u6570 CEIL \u548c CEILING \u4e24\u4e2a\u51fd\u6570\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u8fd4\u56de\u4e0d\u5c0f\u4e8e\u53c2\u6570\u7684\u6700\u5c0f\u6574\u6570\uff0c\u5373\u5411\u4e0a\u53d6\u6574 FLOOR \u5411\u4e0b\u53d6\u6574\uff0c\u8fd4\u56de\u503c\u8f6c\u5316\u4e3a\u4e00\u4e2aBIGINT RAND \u751f\u6210\u4e00\u4e2a0~1\u4e4b\u95f4\u7684\u968f\u673a\u6570\uff0c\u4f20\u5165\u6574\u6570\u53c2\u6570\u662f\uff0c\u7528\u6765\u4ea7\u751f\u91cd\u590d\u5e8f\u5217 ROUND \u5bf9\u6240\u4f20\u53c2\u6570\u8fdb\u884c\u56db\u820d\u4e94\u5165 SIGN \u8fd4\u56de\u53c2\u6570\u7684\u7b26\u53f7 POW \u548c POWER \u4e24\u4e2a\u51fd\u6570\u7684\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u6240\u4f20\u53c2\u6570\u7684\u6b21\u65b9\u7684\u7ed3\u679c\u503c SIN \u6c42\u6b63\u5f26\u503c ASIN \u6c42\u53cd\u6b63\u5f26\u503c\uff0c\u4e0e\u51fd\u6570 SIN \u4e92\u4e3a\u53cd\u51fd\u6570 COS \u6c42\u4f59\u5f26\u503c ACOS \u6c42\u53cd\u4f59\u5f26\u503c\uff0c\u4e0e\u51fd\u6570 COS \u4e92\u4e3a\u53cd\u51fd\u6570 TAN \u6c42\u6b63\u5207\u503c ATAN \u6c42\u53cd\u6b63\u5207\u503c\uff0c\u4e0e\u51fd\u6570 TAN \u4e92\u4e3a\u53cd\u51fd\u6570 COT \u6c42\u4f59\u5207\u503c \u5b57\u7b26\u4e32\u51fd\u6570 \u51fd\u6570\u540d\u79f0 \u4f5c \u7528 LENGTH \u8ba1\u7b97\u5b57\u7b26\u4e32\u957f\u5ea6\u51fd\u6570\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u5b57\u8282\u957f\u5ea6 CONCAT \u5408\u5e76\u5b57\u7b26\u4e32\u51fd\u6570\uff0c\u8fd4\u56de\u7ed3\u679c\u4e3a\u8fde\u63a5\u53c2\u6570\u4ea7\u751f\u7684\u5b57\u7b26\u4e32\uff0c\u53c2\u6570\u53ef\u4ee5\u4f7f\u4e00\u4e2a\u6216\u591a\u4e2a INSERT \u66ff\u6362\u5b57\u7b26\u4e32\u51fd\u6570 LOWER \u5c06\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5c0f\u5199 UPPER \u5c06\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5927\u5199 LEFT \u4ece\u5de6\u4fa7\u5b57\u622a\u53d6\u7b26\u4e32\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u5de6\u8fb9\u7684\u82e5\u5e72\u4e2a\u5b57\u7b26 RIGHT \u4ece\u53f3\u4fa7\u5b57\u622a\u53d6\u7b26\u4e32\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u53f3\u8fb9\u7684\u82e5\u5e72\u4e2a\u5b57\u7b26 TRIM \u5220\u9664\u5b57\u7b26\u4e32\u5de6\u53f3\u4e24\u4fa7\u7684\u7a7a\u683c REPLACE \u5b57\u7b26\u4e32\u66ff\u6362\u51fd\u6570\uff0c\u8fd4\u56de\u66ff\u6362\u540e\u7684\u65b0\u5b57\u7b26\u4e32 SUBSTRING \u622a\u53d6\u5b57\u7b26\u4e32\uff0c\u8fd4\u56de\u4ece\u6307\u5b9a\u4f4d\u7f6e\u5f00\u59cb\u7684\u6307\u5b9a\u957f\u5ea6\u7684\u5b57\u7b26\u6362 REVERSE \u5b57\u7b26\u4e32\u53cd\u8f6c\uff08\u9006\u5e8f\uff09\u51fd\u6570\uff0c\u8fd4\u56de\u4e0e\u539f\u59cb\u5b57\u7b26\u4e32\u987a\u5e8f\u76f8\u53cd\u7684\u5b57\u7b26\u4e32 \u65e5\u671f\u51fd\u6570 \u51fd\u6570\u540d\u79f0 \u4f5c \u7528 CURDATE \u548c CURRENT_DATE \u4e24\u4e2a\u51fd\u6570\u4f5c\u7528\u76f8\u540c\uff0c\u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u7684\u65e5\u671f\u503c CURTIME \u548c CURRENT_TIME \u4e24\u4e2a\u51fd\u6570\u4f5c\u7528\u76f8\u540c\uff0c\u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u7684\u65f6\u95f4\u503c NOW \u548c SYSDATE \u4e24\u4e2a\u51fd\u6570\u4f5c\u7528\u76f8\u540c\uff0c\u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u7684\u65e5\u671f\u548c\u65f6\u95f4\u503c MONTH \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u4e2d\u7684\u6708\u4efd MONTHNAME \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u4e2d\u7684\u6708\u4efd\u82f1\u6587\u540d\u79f0 DAYNAME \u83b7\u53d6\u6307\u5b9a\u66f0\u671f\u5bf9\u5e94\u7684\u661f\u671f\u51e0\u7684\u82f1\u6587\u540d\u79f0 DAYOFWEEK \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u5bf9\u5e94\u7684\u4e00\u5468\u7684\u7d22\u5f15\u4f4d\u7f6e\u503c WEEK \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u662f\u4e00\u5e74\u4e2d\u7684\u7b2c\u51e0\u5468\uff0c\u8fd4\u56de\u503c\u7684\u8303\u56f4\u662f\u5426\u4e3a 0\u301c52 \u6216 1\u301c53 DAYOFYEAR \u83b7\u53d6\u6307\u5b9a\u66f0\u671f\u662f\u4e00\u5e74\u4e2d\u7684\u7b2c\u51e0\u5929\uff0c\u8fd4\u56de\u503c\u8303\u56f4\u662f1~366 DAYOFMONTH \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u662f\u4e00\u4e2a\u6708\u4e2d\u662f\u7b2c\u51e0\u5929\uff0c\u8fd4\u56de\u503c\u8303\u56f4\u662f1~31 YEAR \u83b7\u53d6\u5e74\u4efd\uff0c\u8fd4\u56de\u503c\u8303\u56f4\u662f 1970\u301c2069 TIME_TO_SEC \u5c06\u65f6\u95f4\u53c2\u6570\u8f6c\u6362\u4e3a\u79d2\u6570 SEC_TO_TIME \u5c06\u79d2\u6570\u8f6c\u6362\u4e3a\u65f6\u95f4\uff0c\u4e0eTIME_TO_SEC \u4e92\u4e3a\u53cd\u51fd\u6570 DATE_ADD \u548c ADDDATE \u4e24\u4e2a\u51fd\u6570\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u5411\u65e5\u671f\u6dfb\u52a0\u6307\u5b9a\u7684\u65f6\u95f4\u95f4\u9694 DATE_SUB \u548c SUBDATE \u4e24\u4e2a\u51fd\u6570\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u5411\u65e5\u671f\u51cf\u53bb\u6307\u5b9a\u7684\u65f6\u95f4\u95f4\u9694 ADDTIME \u65f6\u95f4\u52a0\u6cd5\u8fd0\u7b97\uff0c\u5728\u539f\u59cb\u65f6\u95f4\u4e0a\u6dfb\u52a0\u6307\u5b9a\u7684\u65f6\u95f4 SUBTIME \u65f6\u95f4\u51cf\u6cd5\u8fd0\u7b97\uff0c\u5728\u539f\u59cb\u65f6\u95f4\u4e0a\u51cf\u53bb\u6307\u5b9a\u7684\u65f6\u95f4 DATEDIFF \u83b7\u53d6\u4e24\u4e2a\u65e5\u671f\u4e4b\u95f4\u95f4\u9694\uff0c\u8fd4\u56de\u53c2\u6570 1 \u51cf\u53bb\u53c2\u6570 2 \u7684\u503c DATE_FORMAT \u683c\u5f0f\u5316\u6307\u5b9a\u7684\u65e5\u671f\uff0c\u6839\u636e\u53c2\u6570\u8fd4\u56de\u6307\u5b9a\u683c\u5f0f\u7684\u503c WEEKDAY \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u5728\u4e00\u5468\u5185\u7684\u5bf9\u5e94\u7684\u5de5\u4f5c\u65e5\u7d22\u5f15 \u805a\u5408\u51fd\u6570 \u51fd\u6570\u540d\u79f0 \u4f5c\u7528 MAX \u67e5\u8be2\u6307\u5b9a\u5217\u7684\u6700\u5927\u503c MIN \u67e5\u8be2\u6307\u5b9a\u5217\u7684\u6700\u5c0f\u503c COUNT \u7edf\u8ba1\u67e5\u8be2\u7ed3\u679c\u7684\u884c\u6570 SUM \u6c42\u548c\uff0c\u8fd4\u56de\u6307\u5b9a\u5217\u7684\u603b\u548c AVG \u6c42\u5e73\u5747\u503c\uff0c\u8fd4\u56de\u6307\u5b9a\u5217\u6570\u636e\u7684\u5e73\u5747\u503c","title":"Explain\u8be6\u89e3\u4e0e\u7d22\u5f15\u6700\u4f73\u5b9e\u8df5"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#explain","text":"","title":"explain\u8be6\u89e3\u4e0e\u7d22\u5f15\u6700\u4f73\u5b9e\u8df5"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#info","text":"1 2 3 4 5 6 7 8 9 10 11 12 select_type \u542b\u4e49 SIMPLE \u7b80\u5355\u7684select\u67e5\u8be2,\u67e5\u8be2\u4e2d\u4e0d\u5305\u542b\u5b50\u67e5\u8be2\u6216\u8005UNION PRIMARY \u67e5\u8be2\u4e2d\u82e5\u5305\u542b\u4efb\u4f55\u590d\u6742\u7684\u5b57\u67e5\u8be2,\u6700\u5916\u5c42\u67e5\u8be2\u6807\u8bb0\u4e3a\u8be5\u6807\u8bc6 SUBQUERY \u5728SELECT\u6216WHERE\u5217\u8868\u4e2d\u5305\u542b\u4e86\u5b50\u67e5\u8be2 DERIVED \u5728FROM\u5217\u8868\u4e2d\u5305\u542b\u7684\u5b50\u67e5\u8be2,\u88ab\u6807\u8bb0\u4e3aDERIVED(\u884d\u751f)MySQL\u4f1a\u9012\u5f52\u6267\u884c\u8fd9\u4e9b\u5b50\u67e5\u8be2,\u628a\u7ed3\u679c\u653e\u5728\u4e34\u65f6\u8868\u4e2d UNION \u82e5\u7b2c\u4e8c\u4e2aSELECT\u51fa\u73b0\u5728UNION\u4e4b\u540e,\u5219\u6807\u8bb0\u4e3aUNION;\u82e5UNION\u5305\u542b\u5728FROM\u5b57\u53e5\u7684\u5b50\u67e5\u8be2\u4e2d,\u5916\u5c42SELECT\u5c06\u88ab\u6807\u8bb0\u4e3a:DERIVED UNION RESULT \u4eceUNION\u8868\u83b7\u53d6\u7ed3\u679c\u7684SELECT","title":"info"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#explain-type","text":"type \u542b\u4e49 NULL MySQL\u4e0d\u8bbf\u95ee\u4efb\u4f55\u8868,\u7d22\u5f15,\u76f4\u63a5\u8fd4\u56de\u7ed3\u679c system \u8868\u53ea\u6709\u4e00\u884c\u8bb0\u5f55(\u7b49\u4e8e\u7cfb\u7edf\u8868),\u8fd9\u662fconst\u7c7b\u578b\u7684\u7279\u4f8b,\u4e00\u822c\u4e0d\u4f1a\u51fa\u73b0 const \u8868\u793a\u901a\u8fc7\u7d22\u5f15\u4e00\u6b21\u5c31\u627e\u5230\u4e86,const\u7528\u4e8e\u6bd4\u8f83primary key\u6216\u8005unique\u7d22\u5f15.\u56e0\u4e3a\u53ea\u5339\u914d\u4e00\u884c\u6570\u636e,\u6240\u4ee5\u5f88\u5feb.\u5982\u5c06\u4e3b\u952e\u7f6e\u4e8ewhere\u5217\u8868\u4e2d,MySQL\u5c31\u80fd\u5c06\u8be5\u67e5\u8be2\u8f6c\u6362\u4e3a\u4e00\u4e2a\u5e38\u91cf.const\u4e8e\u5c06\"\u4e3b\u952e\"\u6216\"\u552f\u4e00\"\u7d22\u5f15\u7684\u6240\u6709\u90e8\u5206\u4e0e\u5e38\u91cf\u503c\u8fdb\u884c\u6bd4\u8f83 eq_ref \u7c7b\u578bref,\u533a\u522b\u5728\u4e8e\u4f7f\u7528\u7684\u662f\u552f\u4e00\u7d22\u5f15,\u4f7f\u7528\u4e3b\u952e\u7684\u5e76\u8054\u67e5\u8be2,\u5173\u8054\u67e5\u8be2\u7684\u8bb0\u5f55\u53ea\u6709\u4e00\u6761.\u5e38\u89c1\u4e8e\u4e3b\u952e\u6216\u552f\u4e00\u7d22\u5f15\u63cf\u8ff0 ref \u975e\u552f\u4e00\u6027\u7d22\u5f15\u63cf\u8ff0,\u8fd4\u56de\u5339\u914d\u67d0\u4e2a\u5355\u72ec\u503c\u5f97\u6240\u6709\u884c.\u672c\u8d28\u4e0a\u4e5f\u662f\u4e00\u79cd\u7d22\u5f15\u8bbf\u95ee,\u8fd4\u56de\u6240\u6709\u5339\u914d\u67d0\u4e2a\u5355\u72ec\u503c\u7684\u6240\u6709\u884c(\u591a\u4e2a) range \u53ea\u68c0\u7d22\u7ed9\u5b9a\u8fd4\u56de\u7684\u884c,\u4f7f\u7528\u4e00\u4e2a\u7d22\u5f15\u6765\u9009\u62e9\u884c.where\u4e4b\u540e\u51fa\u73b0between,<,>,in \u7b49\u64cd\u4f5c index index\u4e0eALL\u7684\u533a\u522b\u4e3aindex\u7c7b\u578b\u53ea\u662f\u904d\u5386\u4e86\u7d22\u5f15\u6811,\u901a\u5e38\u6bd4ALL\u5feb,ALL\u662f\u904d\u5386\u6570\u636e\u6587\u4ef6 ALL \u5c06\u904d\u5386\u5168\u8868\u4ee5\u627e\u5230\u5339\u914d\u7684\u884c \u7ed3\u679c\u503c\u4ece \u6700\u597d \u5230 \u6700\u574f \u4f9d\u6b21\u662f: NULL > system > const > eq_ref > ref > fulltext > ref_or_null > index_merge > unique_subquery > index_subquery > range > index > ALL system > const > eq_ref > ref > range > index > ALL \u4e00\u822c\u6765\u8bf4,\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u67e5\u8be2\u81f3\u5c11\u8fbe\u5230range\u7ea7\u522b, \u6700\u540e\u8fbe\u5230ref.","title":"explain \u4e4btype"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#explain-key","text":"possible_keys: \u663e\u793a\u53ef\u80fd\u5e94\u7528\u5728\u8fd9\u5f20\u8868\u7684\u7d22\u5f15, \u4e00\u4e2a\u6216\u591a\u4e2a key: \u5b9e\u9645\u4f7f\u7528\u7684\u7d22\u5f15,\u5982\u679c\u4e3aNULL,\u5219\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15 key_len: \u8868\u793a\u7d22\u5f15\u4e2d\u4f7f\u7528\u7684\u5b57\u8282\u6570, \u8be5\u503c\u4e3a\u7d22\u5f15\u5b57\u6bb5\u6700\u5927\u53ef\u80fd\u957f\u5ea6,\u5e76\u975e\u5b9e\u9645\u4f7f\u7528\u957f\u5ea6,\u5728\u4e0d\u635f\u5931\u7cbe\u786e\u6027\u7684\u524d\u63d0\u4e0b,\u957f\u5ea6\u8d8a\u77ed\u8d8a\u597d.","title":"explain \u4e4bkey"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#explain-rows","text":"\u626b\u63cf\u884c\u7684\u6570\u91cf","title":"explain \u4e4brows"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#explain-extra","text":"\u5176\u4ed6\u7684\u989d\u5916\u7684\u6267\u884c\u8ba1\u5212\u4fe1\u606f,\u5728\u8be5\u5217\u663e\u793a. extra \u542b\u4e49 using filesort \u8bf4\u660emysql\u4f1a\u5bf9\u6570\u636e\u4f7f\u7528\u4e00\u4e2a\u5916\u90e8\u7684\u7d22\u5f15\u6392\u5e8f,\u800c\u4e0d\u662f\u6309\u7167\u8868\u5185\u7684\u7d22\u5f15\u987a\u5e8f\u8fdb\u884c\u8bfb\u53d6,\u79f0\u4e3a\"\u6587\u4ef6\u6392\u5e8f\",\u6548\u7387\u4f4e. using temporary \u4f7f\u7528\u4e86\u4e34\u65f6\u8868\u4fdd\u5b58\u4e2d\u95f4\u7ed3\u679c,MySQL\u5728\u5bf9\u67e5\u8be2\u7ed3\u679c\u6392\u5e8f\u65f6\u4f7f\u7528\u4e34\u65f6\u8868. \u5e38\u89c1\u4e8eorder by \u548c group by, \u6548\u7387\u4f4e. using index \u8868\u793a\u76f8\u5e94\u7684select\u64cd\u4f5c\u4f7f\u7528\u4e86\u8986\u76d6\u7d22\u5f15,\u907f\u514d\u8bbf\u95ee\u8868\u7684\u6570\u636e\u884c,\u6548\u7387\u4e0d\u9519. 6). \u5c3d\u91cf\u4f7f\u7528\u8986\u76d6\u7d22\u5f15,\u907f\u514dselect * \u5c3d\u91cf\u4f7f\u7528\u8986\u76d6\u7d22\u5f15(\u53ea\u8bbf\u95ee\u7d22\u5f15\u7684\u67e5\u8be2( \u7d22\u5f15\u5217 \u5b8c\u5168\u5305\u542b \u67e5\u8be2\u5217 )),\u51cf\u5c11 select * . \u5982\u679c\u67e5\u8be2\u7c7b,\u8d85\u51fa\u7d22\u5f15\u5217,\u4e5f\u4f1a\u964d\u4f4e\u6027\u80fd. TIP: using index: \u4f7f\u7528\u8986\u76d6\u7d22\u5f15\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0 using where: \u5728\u67e5\u627e\u4f7f\u7528\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b, \u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e using index condition: \u67e5\u627e\u4f7f\u7528\u4e86\u7d22\u5f15, \u4f46\u662f\u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e using index; using where: \u67e5\u627e\u4f7f\u7528\u4e86\u7d22\u5f15, \u4f46\u662f\u9700\u8981\u7684\u6570\u636e\u90fd\u5728\u7d22\u5f15\u5217\u4e2d\u80fd\u627e\u5230, \u6240\u4ee5\u4e0d\u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e 12) \u5355\u5217\u7d22\u5f15\u548c\u590d\u5408\u7d22\u5f15 \u5c3d\u91cf\u4f7f\u7528\u590d\u5408\u7d22\u5f15, \u800c\u5c11\u4f7f\u7528\u5355\u5217\u7d22\u5f15 \u521b\u5efa\u590d\u5408\u7d22\u5f15 create index idx_name_sta_address on tb_seller(name, status, address); \u5c31\u76f8\u5f53\u4e8e\u521b\u5efa\u4e86\u4e09\u4e2a\u7d22\u5f15: name name + status name + status + address \u521b\u5efa\u5355\u5217\u7d22\u5f15 create index idx_seller_name on tb_sell(name); create index idx_seller_status on tb_sell(status); create index idx_seller_address on tb_sell(address); \u6570\u636e\u5e93\u4f1a\u9009\u62e9\u4e00\u4e2a\u6700\u4f18\u7684\u7d22\u5f15(\u8fa8\u8bc6\u5ea6\u6700\u9ad8\u7d22\u5f15)\u6765\u4f7f\u7528,\u5e76\u4e0d\u4f1a\u4f7f\u7528\u5168\u90e8\u7d22\u5f15.","title":"explain \u4e4bextra"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_1","text":"show status like 'Handler_read%'; show global status like 'Handler_read%'; 02:06:55 root@localhost[database1]> show status like 'Handler_read%'; +-----------------------+-------+ | Variable_name | Value | +-----------------------+-------+ | Handler_read_first | 0 | | Handler_read_key | 0 | | Handler_read_last | 0 | | Handler_read_next | 0 | | Handler_read_prev | 0 | | Handler_read_rnd | 0 | | Handler_read_rnd_next | 34 | +-----------------------+-------+ 7 rows in set (0.01 sec) 05:08:03 root@localhost[database1]> show global status like 'Handler_read%'; +-----------------------+--------------+ | Variable_name | Value | +-----------------------+--------------+ | Handler_read_first | 622670 | | Handler_read_key | 254215292 | | Handler_read_last | 29 | | Handler_read_next | 273266451 | | Handler_read_prev | 97 | | Handler_read_rnd | 10101645 | | Handler_read_rnd_next | 166307007667 | +-----------------------+--------------+ 7 rows in set (0.00 sec) 05:08:11 root@localhost[database1]> - Handler_read_first: \u7d22\u5f15\u4e2d\u7b2c\u4e00\u6761\u88ab\u8bfb\u7684\u6b21\u6570.\u5982\u679c\u9ad8,\u8868\u793a\u670d\u52a1\u5668\u6b63\u6267\u884c\u5927\u91cf\u5168\u7d22\u5f15\u626b\u63cf(\u8fd9\u4e2a\u503c\u8d8a\u4f4e\u8d8a\u597d). - Handler_read_key: \u5982\u679c\u7d22\u5f15\u6b63\u5728\u5de5\u4f5c,\u8fd9\u4e2a\u503c\u4ee3\u8868\u4e00\u4e2a\u884c\u88ab\u7d22\u5f15\u503c\u8bfb\u7684\u6b21\u6570,\u5982\u679c\u503c\u8d8a\u4f4e,\u8868\u793a\u7d22\u5f15\u5f97\u5230\u7684\u6027\u80fd\u6539\u5584\u4e0d\u9ad8,\u56e0\u4e3a\u7d22\u5f15\u4e0d\u7ecf\u5e38\u4f7f\u7528(\u8fd9\u4e2a\u503c\u8d8a\u9ad8\u8d8a\u597d). - Handler_read_rnd: \u6839\u636e\u56fa\u5b9a\u4f4d\u7f6e\u8bfb\u4e00\u884c\u7684\u8bf7\u6c42\u503c. \u5982\u679c\u4f60\u6b63\u6267\u884c\u5927\u91cf\u67e5\u8be2\u5e76\u9700\u8981\u5bf9\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f,\u8be5\u503c\u5e94\u8be5\u8f83\u9ad8. \u4f60\u53ef\u80fd\u4f7f\u7528\u4e86\u5927\u91cf\u9700\u8981MySQL\u626b\u63cf\u8fd9\u4e2a\u8868\u7684\u67e5\u8be2\u6216\u4f60\u7684\u8fde\u63a5\u6ca1\u6709\u6b63\u786e\u4f7f\u7528\u952e.\u8fd9\u4e2a\u503c\u8f83\u9ad8,\u610f\u5473\u7740\u8fd0\u884c\u6548\u7387\u4f4e,\u53ef\u4ee5\u5efa\u7acb\u7d22\u5f15\u6765\u8865\u6551. - Handler_read_rnd_next: \u5728\u6570\u636e\u6587\u4ef6\u4e2d\u8bfb\u4e0b\u4e00\u884c\u7684\u8bf7\u6c42\u6570.\u5982\u679c\u4f60\u6b63\u5728\u8fdb\u884c\u5927\u91cf\u7684\u8868\u626b\u63cf,\u8be5\u503c\u8f83\u9ad8.\u901a\u5e38\u8bf4\u660e\u4f60\u7684\u8868\u7684\u7d22\u5f15\u4e0d\u6b63\u786e\u6216\u5199\u5165\u7684\u67e5\u8be2\u6ca1\u6709\u5229\u7528\u7d22\u5f15.","title":"\u67e5\u770b\u7d22\u5f15\u7d22\u5f15\u60c5\u51b5"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#sql","text":"","title":"SQL\u4f18\u5316"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_2","text":"\u4f7f\u7528load\u547d\u4ee4\u5bfc\u5165\u6570\u636e\u7684\u65f6\u5019,\u9002\u5f53\u7684\u8bbe\u7f6e\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387. \u5bf9\u4e8eInnoDB\u7c7b\u578b\u7684\u8868,\u6709\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387: \u4e3b\u952e\u987a\u5e8f\u63d2\u5165 \u56e0\u4e3aInnoDB\u7c7b\u578b\u7684\u8868\u793a\u6309\u7167\u4e3b\u952e\u7684\u987a\u5e8f\u4fdd\u5b58\u7684,\u6240\u4ee5\u5c06\u5bfc\u5165\u7684\u6570\u636e\u6309\u7167\u4e3b\u952e\u7684\u987a\u5e8f\u6392\u5217,\u53ef\u4ee5\u6709\u6548\u7684\u63d0\u9ad8\u5bfc\u5165\u6570\u636e\u7684\u6548\u7387. \u5982\u679cInnoDB\u8868\u6ca1\u6709\u4e3b\u952e,\u90a3\u4e48\u7cfb\u7edf\u4f1a\u81ea\u52a8\u9ed8\u8ba4\u521b\u5efa\u4e00\u4e2a\u5185\u90e8\u5217\u4f5c\u4e3a\u4e3b\u952e,\u6240\u4ee5\u5982\u679c\u53ef\u4ee5\u7ed9\u8868\u521b\u5efa\u4e00\u4e2a\u4e3b\u952e,\u5c06\u53ef\u4ee5\u5229\u7528\u8fd9\u70b9,\u6765\u63d0\u9ad8\u5bfc\u5165\u6570\u636e\u7684\u6548\u7387. \u63d2\u5165ID\u987a\u5e8f\u6392\u5217\u6570\u636e \u63d2\u5165ID\u65e0\u5e8f\u6392\u5217\u6570\u636e \u5173\u95ed\u552f\u4e00\u6027\u6821\u9a8c \u5728\u5bfc\u5165\u6570\u636e\u524d\u6267\u884c SET UNIQUE_CHECKS = 0 , \u5173\u95ed\u552f\u4e00\u6027\u6821\u9a8c, \u5728\u5bfc\u5165\u7ed3\u675f\u540e\u6267\u884c SET UNIQUE_CHECKS = 1 , \u6062\u590d\u552f\u4e00\u6027\u6821\u9a8c, \u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387. \u624b\u52a8\u63d0\u4ea4\u4e8b\u52a1 \u5982\u679c\u5e94\u7528\u4f7f\u7528\u81ea\u52a8\u63d0\u4ea4\u7684\u65b9\u5f0f,\u5efa\u8bae\u5728\u5bfc\u5165\u524d\u6267\u884c SET AUTOCOMMIT=0 , \u5173\u95ed\u81ea\u52a8\u63d0\u4ea4, \u5bfc\u5165\u7ed3\u675f\u540e\u518d\u6267\u884c SET AUTOCOMMIT=1 , \u6253\u5f00\u81ea\u52a8\u63d0\u4ea4, \u4e5f\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387.","title":"\u5927\u6279\u91cf\u63d2\u5165"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#insert","text":"\u5f53\u8fdb\u884c\u6570\u636e\u7684insert\u64cd\u4f5c\u7684\u65f6\u5019,\u53ef\u4ee5\u8003\u8651\u91c7\u7528\u4ee5\u4e0b\u51e0\u79cd\u4f18\u5316\u65b9\u6848 \u5982\u679c\u9700\u8981\u540c\u65f6\u5bf9\u4e00\u5f20\u8868\u63d2\u5165\u5f88\u591a\u884c\u6570\u636e\u65f6,\u5e94\u8be5\u5c3d\u91cf\u4f7f\u7528\u591a\u4e2a\u503c\u8868\u7684insert\u8bed\u53e5,\u8fd9\u79cd\u65b9\u5f0f\u5c06\u5927\u5927\u7684\u7f29\u51cf\u5ba2\u6237\u7aef\u4e0e\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u8fde\u63a5,\u5173\u95ed\u793a\u4f8b,\u539f\u59cb\u65b9\u5f0f\u4e3a: \u4f18\u5316\u540e\u7684\u65b9\u6848\u524d: insert into tb_test values(1,'Tom'); insert into tb_test values(2,'Cat'); insert into tb_test values(3,'Jerry'); \u4f18\u5316\u540e\u7684\u65b9\u6848\u4e3a: insert into tb_test values(1,'Tom'),(2,'Cat'),(3,'Jerry'); \u5728\u4e8b\u52a1\u4e2d\u8fdb\u884c\u6570\u636e\u63d2\u5165 start transaction; insert into tb_test values(1,'Tom'); insert into tb_test values(2,'Cat'); insert into tb_test values(3,'Jerry'); commit; \u6570\u636e\u6709\u5e8f\u63d2\u5165 insert into tb_test values(1,'Tom'); insert into tb_test values(2,'Cat'); insert into tb_test values(3,'Jerry'); insert into tb_test values(4,'Tim'); insert into tb_test values(5,'Rose');","title":"\u4f18\u5316insert\u8bed\u53e5"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#order-by","text":"\u4e24\u79cd\u6392\u5e8f\u65b9\u5f0f \u7b2c\u4e00\u79cd\u662f\u901a\u8fc7\u5bf9\u8fd4\u56de\u6570\u636e\u8fdb\u884c\u6392\u5e8f,\u4e5f\u5c31\u662f\u901a\u5e38\u8bf4\u7684 filesort \u6392\u5e8f, \u6240\u6709\u4e0d\u662f\u901a\u8fc7\u7d22\u5f15\u76f4\u63a5\u8fd4\u56de\u6392\u5e8f\u7ed3\u679c\u7684\u6392\u5e8f\u90fd\u53ebFilesort\u6392\u5e8f. \u7b2c\u4e8c\u79cd\u901a\u8fc7\u6709\u5e8f\u7d22\u5f15\u987a\u5e8f\u626b\u63cf\u76f4\u63a5\u8fd4\u56de\u6709\u5e8f\u6570\u636e,\u8fd9\u79cd\u60c5\u51b5\u5373\u4e3a using index , \u4e0d\u9700\u8981\u989d\u5916\u6392\u5e8f,\u64cd\u4f5c\u6548\u7387\u9ad8. \u4e86\u89e3\u4e86MySQL\u7684\u6392\u5e8f\u65b9\u5f0f,\u4f18\u5316\u76ee\u6807\u5c31\u6e05\u6670\u4e86: \u5c3d\u91cf\u51cf\u5c11\u989d\u5916\u7684\u6392\u5e8f,\u901a\u8fc7\u7d22\u5f15\u76f4\u63a5\u8fd4\u56de\u6709\u5e8f\u6570\u636e. where \u6761\u4ef6\u548c order by \u4f7f\u7528 \u76f8\u540c\u7684\u7d22\u5f15 ,\u5e76\u4e14 Order by \u7684\u987a\u5e8f\u548c \u7d22\u5f15\u987a\u5e8f \u76f8\u540c , \u5e76\u4e14 order by \u7684\u5b57\u6bb5 \u90fd\u662f\u5347\u5e8f ,\u6216\u8005 \u90fd\u662f\u964d\u5e8f . \u5426\u5219\u80af\u5b9a\u9700\u8981\u989d\u5916\u7684\u64cd\u4f5c, \u8fd9\u6837\u5c31\u4f1a\u51fa\u73b0FileSort.","title":"\u4f18\u5316order by\u8bed\u53e5"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#filesort","text":"\u901a\u8fc7\u521b\u5efa\u5408\u9002\u7684\u7d22\u5f15,\u80fd\u591f\u51cf\u5c11filesort\u7684\u51fa\u73b0,\u4f46\u662f\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b,\u6761\u4ef6\u9650\u5236\u4e0d\u80fd\u8ba9Filesort\u6d88\u5931,\u90a3\u5c31\u9700\u8981\u52a0\u5febFilesort\u7684\u6392\u5e8f\u64cd\u4f5c.\u5bf9\u4e8eFileSort, MySQL\u6709\u4e24\u79cd\u6392\u5e8f\u7b97\u6cd5: \u4e24\u6b21\u626b\u63cf\u7b97\u6cd5: MySQL4.1 \u4e4b\u524d, \u4f7f\u7528\u8be5\u65b9\u5f0f\u6392\u5e8f. \u9996\u5148\u6839\u636e\u6761\u4ef6\u53d6\u51fa\u6392\u5e8f\u5b57\u6bb5\u548c\u884c\u6307\u9488\u4fe1\u606f,\u7136\u540e\u5728\u6392\u5e8f\u533a sort buffer \u4e2d\u6392\u5e8f, \u5982\u679csort buffer \u4e0d\u591f,\u5219\u5728\u4e34\u65f6\u8868temporary table \u4e2d\u5b58\u50a8\u6392\u5e8f\u7ed3\u679c. \u5b8c\u6210\u6392\u5e8f\u540e, \u518d\u6839\u636e\u884c\u6307\u9488\u56de\u8868\u8bfb\u53d6\u8bb0\u5f55, \u8be5\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u91cf\u968f\u673aIO\u64cd\u4f5c. \u4e00\u6b21\u626b\u63cf\u7b97\u6cd5: \u4e00\u6b21\u6027\u53d6\u51fa\u6ee1\u8db3\u6761\u4ef6\u7684\u7d22\u5f15\u5b57\u6bb5,\u7136\u540e\u5728\u6392\u5e8f\u533asort buffer \u4e2d\u6392\u5e8f\u540e\u76f4\u63a5\u8f93\u51fa\u7ed3\u679c\u96c6. \u6392\u5e8f\u65f6\u5185\u5b58\u5f00\u9500\u8f83\u5927, \u4f46\u662f\u6392\u5e8f\u6548\u7387\u6bd4\u4e24\u6b21\u626b\u63cf\u7b97\u6cd5\u8981\u9ad8. MySQL\u901a\u8fc7\u6bd4\u8f83\u7cfb\u7edf\u53d8\u91cf max_length_for_sort_data \u7684\u5927\u5c0f\u548cQuery\u8bed\u53e5\u53d6\u51fa\u7684\u5b57\u6bb5\u603b\u5927\u5c0f,\u6765\u5224\u65ad\u662f\u5426\u90a3\u79cd\u6392\u5e8f\u7b97\u6cd5,\u5982\u679c max_length_for_sort_data \u66f4\u5927,\u90a3\u4e48\u4f7f\u7528\u7b2c\u4e8c\u79cd\u4f18\u5316\u4e4b\u540e\u7684\u7b97\u6cd5,\u5426\u5219\u4f7f\u7528\u7b2c\u4e00\u79cd. \u53ef\u4ee5\u9002\u5f53\u63d0\u9ad8 sort_buffer_size \u548c max_length_for_sort_date \u7cfb\u7edf\u53d8\u91cf,\u6765\u589e\u5927\u6392\u5e8f\u533a\u7684\u5927\u5c0f,\u63d0\u9ad8\u6392\u5e8f\u7684\u6548\u7387.","title":"Filesort\u7684\u4f18\u5316"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#group-by","text":"\u7531\u4e8egroup by \u5b9e\u9645\u4e0a\u4e5f\u540c\u6837\u4f1a\u8fdb\u884c\u6392\u5e8f\u64cd\u4f5c, \u800c\u4e14\u4e8eorder by \u76f8\u6bd4,group by \u53ea\u8981\u53ea\u662f\u591a\u4e86\u6392\u5e8f\u4e4b\u540e\u7684\u5206\u7ec4\u64cd\u4f5c. \u5f53\u7136,\u5982\u679c\u5728\u5206\u7ec4\u7684\u65f6\u5019\u8fd8\u4f7f\u7528\u4e86\u5176\u4ed6\u7684\u4e00\u4e9b\u805a\u5408\u51fd\u6570, \u90a3\u4e48\u8fd8\u9700\u8981\u4e00\u4e9b\u805a\u5408\u51fd\u6570\u7684\u8ba1\u7b97.\u6240\u4ee5,\u5728group by \u7684\u5b9e\u73b0\u8fc7\u7a0b\u4e2d,\u4e8eorder by\u4e00\u6837\u4e5f\u53ef\u4ee5\u5229\u7528\u5230\u7d22\u5f15. \u5982\u679c\u67e5\u8be2\u5305\u542bgroup by \u4f46\u662f\u7528\u6237\u60f3\u8981\u907f\u514d\u6392\u5e8f\u7ed3\u679c\u7684\u6d88\u8017,\u5219\u53ef\u4ee5\u6267\u884c order by null \u7981\u6b62\u6392\u5e8f. \u5982\u4e0b: explain select age, count(*) from emp group by age; \u4f18\u5316\u540e explain select age,count(*) from emp group by age order by null;","title":"\u4f18\u5316group by\u8bed\u53e5"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_3","text":"MySQL4.1 \u7248\u672c\u4e4b\u540e,\u5f00\u59cb\u652f\u6301SQL\u7684\u5b50\u67e5\u8be2.\u8fd9\u4e2a\u6280\u672f\u53ef\u4ee5\u4f7f\u7528select\u8bed\u53e5\u6765\u521b\u5efa\u4e00\u4e2a\u5355\u5217\u7684\u67e5\u8be2,\u7136\u540e\u628a\u8fd9\u4e2a\u7ed3\u679c\u4f5c\u4e3a\u8fc7\u6ee4\u6761\u4ef6\u7528\u5728\u53e6\u4e00\u4e2a\u67e5\u8be2\u4e2d. \u4f7f\u7528\u5b50\u67e5\u8be2\u53ef\u4ee5\u4e00\u6b21\u6027\u7684\u5b8c\u6210\u5f88\u591a\u903b\u8f91\u4e0a\u9700\u8981\u591a\u4e2a\u6b65\u9aa4\u624d\u80fd\u5b8c\u6210\u7684SQL\u64cd\u4f5c, \u540c\u65f6\u4e5f\u53ef\u4ee5\u907f\u514d\u4e8b\u52a1\u6216\u8868\u9501\u6b7b, \u5e76\u4e14\u5199\u8d77\u6765\u4e5f\u5f88\u5bb9\u6613. \u4f46\u662f,\u6709\u4e9b\u60c5\u51b5\u4e0b,\u5b50\u67e5\u8be2\u662f\u53ef\u4ee5\u88ab\u8ddf\u9ad8\u6548\u7684\u8fde\u63a5(JOIN)\u4ee3\u66ff.","title":"\u4f18\u5316\u5d4c\u5957\u67e5\u8be2"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#or","text":"\u5bf9\u4e8e\u5305\u542bOR\u67e5\u8be2\u5b50\u53e5,\u5982\u679c\u8981\u5229\u7528\u7d22\u5f15,\u5219OR\u4e4b\u95f4\u7684\u6bcf\u4e2a\u6761\u4ef6\u5217\u90fd\u5fc5\u987b\u7528\u5230\u7d22\u5f15, \u800c\u4e14\u4e0d\u80fd\u4f7f\u7528\u5230\u590d\u5408\u7d22\u5f15; \u5982\u679c\u6ca1\u6709\u7d22\u5f15,\u5219\u5e94\u8be5\u8003\u8651\u589e\u52a0\u7d22\u5f15. \u5efa\u8bae\u4f7f\u7528union\u66ff\u6362or . type\u663e\u793a\u7684\u662f\u8bbf\u95ee\u7c7b\u578b,\u662f\u8f83\u4e3a\u91cd\u8981\u7684\u4e00\u4e2a\u6307\u6807,\u7ed3\u679c\u503c\u4ece\u597d\u5230\u574f\u4f9d\u6b21\u662f: system > const > eq_ref > ref > fulltext > ref_or_null > index_merger > unique_subquery > index_subquery > range > index > ALL UNION \u8bed\u53e5\u7684type\u503c\u4e3aref, OR\u8bed\u53e5\u7684type\u503c\u4e3arange, \u53ef\u4ee5\u770b\u5230\u8fd9\u662f\u4e00\u4e2a\u5f88\u660e\u663e\u7684\u5dee\u8ddd UNION \u8bed\u53e5\u7684ref\u503c\u4e3aconst, OR\u8bed\u53e5\u7684type\u503c\u4e3anull, const\u8868\u793a\u662f\u5e38\u91cf\u503c\u5f15\u7528,\u975e\u5e38\u5feb \u8fd9\u4e24\u9879\u7684\u5dee\u8ddd\u5c31\u8bf4\u660e\u4e86UNION\u8981\u4f18\u4e8eOR.","title":"\u4f18\u5316OR\u6761\u4ef6"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_4","text":"\u4e00\u822c\u5206\u9875\u67e5\u8be2\u65f6,\u901a\u8fc7\u521b\u5efa\u8986\u76d6\u7d22\u5f15\u80fd\u591f\u6bd4\u8f83\u597d\u7684\u63d0\u9ad8\u6027\u80fd. \u4e00\u4e2a\u5e38\u89c1\u53c8\u975e\u5e38\u5934\u75bc\u7684\u95ee\u9898\u5c31\u662f limit 2000000, 10 , \u6b64\u65f6\u9700\u8981MySQL\u6392\u5e8f\u524d 2000010 \u8bb0\u5f55, \u4ec5\u4ec5\u8fd4\u56de2000000 - 2000010 \u7684\u8bb0\u5f55, \u5176\u4ed6\u8bb0\u5f55\u4e22\u5f03, \u67e5\u8be2\u6392\u5e8f\u7684\u4ee3\u4ef7\u975e\u5e38\u5927. \u4f18\u5316\u601d\u8def\u4e00 \u5728\u7d22\u5f15\u4e0a\u5b8c\u6210\u6392\u5e8f\u5206\u9875\u64cd\u4f5c, \u6700\u540e\u6839\u636e\u4e3b\u952e\u5173\u8054\u56de\u539f\u8868\u67e5\u8be2\u6240\u9700\u8981\u7684\u5176\u4ed6\u5217\u5185\u5bb9. \u4f18\u5316\u601d\u8def\u4e8c \u8be5\u65b9\u6848\u9002\u5e94\u4e8e\u4e3b\u952e\u81ea\u589e\u7684\u8868,\u53ef\u4ee5\u628aLimit\u67e5\u8be2\u8f6c\u6362\u6210\u67d0\u4e2a\u4f4d\u7f6e\u7684\u67e5\u8be2. \u9002\u5e94SQL\u63d0\u793a SQL\u63d0\u793a, \u662f\u4f18\u5316\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u91cd\u8981\u5b57\u6bb5, \u7b80\u5355\u6765\u8bf4, \u5c31\u662f\u5728SQL\u8bed\u53e5\u4e2d\u52a0\u5165\u4e00\u4e9b\u4eba\u4e3a\u7684\u63d0\u793a\u6765\u8fbe\u5230\u4f18\u5316\u64cd\u4f5c\u7684\u76ee\u7684. USE INDEX \u5728\u67e5\u8be2\u8bed\u53e5\u4e2d\u8868\u540d\u7684\u540e\u9762,\u6dfb\u52a0 use index \u6765\u63d0\u4f9b\u5e0c\u671bMySQL\u53bb\u53c2\u8003\u7684\u7d22\u5f15\u5217\u8868,\u5c31\u53ef\u4ee5\u8ba9MySQL\u4e0d\u518d\u8003\u8651\u5176\u4ed6\u53ef\u7528\u7684\u7d22\u5f15. create index idx_serller_name on tb_sellwe(name); IGNORE INDEX \u5982\u679c\u7528\u6237\u53ea\u662f\u5355\u7eaf\u7684\u60f3\u8ba9MySQL\u5ffd\u7565\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u7d22\u5f15, \u5219\u53ef\u4ee5\u4f7f\u7528 ignore index \u4f5c\u4e3a hint. explain select * from tb_seller ignore index(idx_seller_name) where name = 'xxx'; FORCE INDEX \u4e3a\u5f3a\u5236MySQL\u4f7f\u7528\u4e00\u4e2a\u7279\u5b9a\u7684\u7d22\u5f15, \u53ef\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528 force index \u4f5c\u4e3ahint. explain select * from tb_seller force index(idx_seller_address) wher address = 'xxx';","title":"\u4f18\u5316\u5206\u9875\u67e5\u8be2"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_5","text":"mysql> show status like 'Qcache%'; +-------------------------+------------+ | Variable_name | Value | +-------------------------+------------+ | Qcache_free_blocks | 23822 | <- \u53ef\u7528\u7684\u5185\u5b58\u7684\u5757\u7684\u4e2a\u6570 | Qcache_free_memory | 70259792 | <- \u53ef\u7528\u7684\u5185\u5b58\u7684\u7a7a\u95f4,\u5bb9\u91cf | Qcache_hits | 1594706026 | <- \u67e5\u8be2\u7f13\u51b2\u7684\u547d\u4e2d\u6b21\u6570 | Qcache_inserts | 678651145 | <- \u6dfb\u52a0\u5230\u67e5\u8be2\u7f13\u51b2\u7684\u6b21\u6570 | Qcache_lowmem_prunes | 237160055 | <- \u5982\u679c\u5185\u5b58\u4e0d\u8db3,\u5c06\u6570\u636e\u79fb\u9664\u51fa\u5185\u5b58\u7a7a\u95f4\u7684\u6b21\u6570 | Qcache_not_cached | 1344572761 | <- \u672a\u505a\u7f13\u5b58\u7684\u6b21\u6570 | Qcache_queries_in_cache | 67682 | <- \u67e5\u8be2\u7f13\u5b58\u4e2d\u6ce8\u518c\u7684\u67e5\u8be2\u6570 | Qcache_total_blocks | 181973 | <- \u67e5\u8be2\u7f13\u5b58\u4e2d\u7684\u5757\u603b\u6570 +-------------------------+------------+ \u53c2\u6570 \u542b\u4e49 Qcache_free_blocks \u67e5\u8be2\u7f13\u5b58\u4e2d\u7684\u53ef\u4ee5\u5185\u5b58\u5757\u6570 Qcache_free_memory \u67e5\u8be2\u7f13\u5b58\u7684\u53ef\u7528\u5185\u5b58\u91cf Qcache_hits \u67e5\u8be2\u7f13\u5b58\u547d\u4e2d\u7387 Qcache_inserts \u6dfb\u52a0\u5230\u67e5\u8be2\u7f13\u5b58\u7684\u67e5\u8be2\u6570 Qcache_lowmem_prunes \u7531\u4e8e\u5185\u5b58\u4e0d\u8db3\u800c\u4ece\u67e5\u8be2\u7f13\u5b58\u4e2d\u5220\u9664\u7684\u67e5\u8be2\u6570 Qcache_not_cached \u975e\u7f13\u5b58\u67e5\u8be2\u7684\u6570\u91cf(\u7531\u4e8equery_cache_type\u8bbe\u7f6e\u800c\u65e0\u6cd5\u7f13\u5b58\u6216\u672a\u7f13\u5b58) Qcache_queries_in_cache \u67e5\u8be2\u7f13\u5b58\u4e2d\u6ce8\u518c\u7684\u67e5\u8be2\u6570 Qcache_total_blocks \u67e5\u8be2\u7f13\u5b58\u4e2d\u7684\u5757\u603b\u6570","title":"\u67e5\u8be2\u7f13\u5b58\u914d\u7f6e"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_6","text":"MySQL\u7684\u67e5\u8be2\u7f13\u5b58\u9ed8\u8ba4\u662f\u5173\u95ed\u7684, \u9700\u8981\u624b\u52a8\u914d\u7f6e\u53c2\u6570 query_cache_type ,\u6765\u5f00\u542f\u67e5\u8be2\u7f13\u5b58. query_cache_type \u8be5\u53c2\u6570\u7684\u53ef\u53d6\u503c\u6709\u4e09\u4e2a \u503c \u542b\u4e49 OFF \u6216 0 \u67e5\u8be2\u7f13\u5b58\u529f\u80fd\u5173\u95ed ON \u6216 1 \u67e5\u8be2\u7f13\u5b58\u529f\u80fd\u6253\u5f00, SELECT \u7684\u7ed3\u679c\u7b26\u5408\u7f13\u5b58\u6761\u4ef6\u5373\u4f1a\u7f13\u5b58,\u5426\u5219,\u4e0d\u4e88\u7f13\u5b58, \u663e\u793a\u6307\u5b9aSQL_NO_CACHE, \u4e0d\u4e88\u7f13\u5b58 DEMAND \u6216 2 \u67e5\u8be2\u7f13\u5b58\u529f\u80fd\u6309\u9700\u8fdb\u884c, \u663e\u793a\u6307\u5b9aSQL_CACHE\u7684SELECT\u8bed\u53e5\u624d\u4f1a\u7f13\u5b58; \u5176\u4ed6\u5747\u4e0d\u4e88\u7f13\u5b58","title":"\u5f00\u542f\u67e5\u8be2\u7f13\u5b58"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_7","text":"1) SQL\u8bed\u53e5\u4e0d\u4e00\u81f4\u7684\u60c5\u51b5,\u60f3\u8981\u547d\u4e2d\u67e5\u8be2\u7f13\u5b58,\u67e5\u8be2\u7684SQL\u8bed\u53e5\u5fc5\u987b\u4e00\u81f4. 2) \u5f53\u67e5\u8be2\u8bed\u53e5\u4e2d\u6709\u4e00\u4e9b\u4e0d\u786e\u5b9a\u7684\u65f6,\u5219\u4e0d\u4f1a\u7f13\u5b58. \u5982: now(), current_date(),curdate(),curtime(),rand(),uuid(),user(),databases(). 3) \u4e0d\u4f7f\u7528\u4efb\u4f55\u8868\u67e5\u8be2\u8bed\u53e5 4) \u67e5\u8be2 mysql, information_schema,\u6216performance_schema \u6570\u636e\u5e93\u4e2d\u7684\u8868\u65f6,\u4e0d\u4f1a\u8d70\u67e5\u8be2\u7f13\u5b58. 5) \u5728\u5b58\u50a8\u7684\u51fd\u6570, \u89e6\u53d1\u5668\u6216\u4e8b\u4ef6\u7684\u4e3b\u4f53\u5185\u6267\u884c\u7684\u67e5\u8be2. 6) \u5982\u679c\u8868\u66f4\u6539,\u5219\u4f7f\u7528\u8be5\u8868\u7684\u6240\u6709\u9ad8\u901f\u7f13\u5b58\u67e5\u8be2\u90fd\u5c06\u53d8\u4e3a\u65e0\u6548\u5e76\u4ece\u9ad8\u901f\u7f13\u5b58\u4e2d\u5220\u9664. \u8fd9\u5305\u62ec\u4f7f\u7528 MERGE \u6620\u5c04\u5230\u5df2\u66f4\u6539\u8868\u7684\u67e5\u8be2.\u4e00\u4e2a\u8868\u53ef\u4ee5\u88ab\u8bb8\u591a\u7c7b\u578b\u7684\u8bed\u53e5, \u5982\u88ab\u6539\u53d8 INSERT, UPDATE, DELETE, TRUNCATE TABLE, ALTER TABLE, DROP TABLE, \u6216 DROP DATABASE.","title":"\u67e5\u8be2\u7f13\u5b58\u5931\u6548\u7684\u60c5\u51b5"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#mysql","text":"","title":"MySQL\u5185\u5b58\u7ba1\u7406\u53ca\u4f18\u5316"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#_8","text":"1) \u5c06\u5c3d\u91cf\u591a\u7684\u5185\u5b58\u5206\u914d\u7ed9MySQL\u505a\u7f13\u5b58, \u4f46\u8981\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u548c\u5176\u4ed6\u67e5\u8be2\u9884\u7559\u8db3\u591f\u5185\u5b58. 2) MyISAM\u5b58\u50a8\u5f15\u64ce\u7684\u6570\u636e\u6587\u4ef6\u8bfb\u53d6\u4f9d\u8d56\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u81ea\u8eab\u7684 IO \u7f13\u5b58,\u56e0\u6b64,\u5982\u679c\u6709MyISAM\u8868, \u5c31\u8981\u9884\u7559\u66f4\u591a\u7684\u5185\u5b58\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u505aIO\u7f13\u5b58. 3) \u6392\u5e8f\u533a, \u8fde\u63a5\u533a\u7b49\u7f13\u5b58\u662f\u5206\u914d\u7ed9\u6bcf\u4e2a\u6570\u636e\u5e93\u5bf9\u8bdd(session)\u4e13\u4e1a\u7684,\u5176\u9ed8\u8ba4\u503c\u7684\u8bbe\u7f6e\u8981\u6839\u636e\u6700\u5927\u8fde\u63a5\u6570\u5408\u7406\u5206\u914d, \u5982\u679c\u8bbe\u7f6e\u592a\u5927, \u4e0d\u4f46\u6d6a\u8d39\u8d44\u6e90,\u800c\u4e14\u5728\u5e76\u53d1\u8fde\u63a5\u8f83\u9ad8\u65f6\u4f1a\u5bfc\u81f4\u7269\u7406\u5185\u5b58\u8017\u5c3d.","title":"\u5185\u5b58\u4f18\u5316\u539f\u5219"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#myisam","text":"MyISAM\u5b58\u50a8\u5f15\u64ce\u4f7f\u7528 key_buffer \u7f13\u5b58\u7d22\u5f15\u5757, \u52a0\u901fMyISAM\u7d22\u5f15\u7684\u8bfb\u5199\u901f\u5ea6. \u5bf9\u4e8eMyISAM\u8868\u7684\u6570\u636e\u5757, mysql\u6ca1\u6709\u7279\u522b\u7684\u7f13\u5b58\u673a\u5236, \u5b8c\u5168\u4f9d\u8d56\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684IO\u7f13\u5b58.","title":"MyISAM \u5185\u5b58\u4f18\u5316"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#key_buffer_size","text":"key_buffer_size \u51b3\u5b9aMyISAM\u7d22\u5f15\u5757\u7f13\u51b2\u533a\u7684\u5927\u5c0f, \u76f4\u63a5\u5f71\u54cd\u5230MyISAM\u8868\u7684\u8bfb\u53d6\u6548\u7387. \u53ef\u4ee5\u5728MySQL\u53c2\u6570\u6587\u4ef6\u4e2d\u8bbe\u7f6ekey_buffer_size\u7684\u503c, \u5bf9\u4e8e\u4e00\u822cMyISAM\u6570\u636e\u5e93, \u5efa\u8bae\u81f3\u5c11\u5c06 1/4 \u53ef\u7528\u5185\u5b58\u5206\u914d\u7ed9key_buffer_size.","title":"key_buffer_size"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#read_buffer_size","text":"\u5982\u679c\u9700\u8981\u7ecf\u5e38\u987a\u5e8f\u626b\u63cfmyisam\u8868,\u53ef\u4ee5\u901a\u8fc7\u589e\u5927read_buffer_size\u7684\u503c\u6765\u6539\u5584\u6027\u80fd. \u4f46\u9700\u8981\u6ce8\u610f\u7684\u662fread_buffer_size\u662f\u6bcf\u4e2asession\u72ec\u5360\u7684,\u5982\u679c\u9ed8\u8ba4\u503c\u8bbe\u7f6e\u592a\u5927,\u5c31\u597d\u9020\u6210\u5185\u5b58\u6d6a\u8d39.","title":"read_buffer_size"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#read_rnd_buffer_size","text":"\u5bf9\u4e8e\u9700\u8981\u6392\u5e8f\u7684myisam\u8868\u7684\u67e5\u8be2, \u5982\u5e26\u6709order by \u5b50\u53e5\u7684sql, \u9002\u5f53\u589e\u52a0 read_rnd_buffer_size\u7684\u503c, \u53ef\u4ee5\u6539\u5584\u6b64\u7c7b\u7684sql\u6027\u80fd. \u4f46\u9700\u6ce8\u610f\u7684\u662f, read_rnd_buffer_size\u662f\u6bcf\u4e2asession\u72ec\u5360\u7684, \u5982\u679c\u9ed8\u8ba4\u503c\u8bbe\u7f6e\u592a\u5927,\u5c31\u597d\u9020\u6210\u5185\u5b58\u6d6a\u8d39.","title":"read_rnd_buffer_size"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#innodb","text":"innodb\u7528\u4e00\u5757\u5185\u5b58\u533a\u505aIO\u7f13\u5b58, \u8be5\u7f13\u5b58\u6c60\u4e0d\u4ec5\u7528\u6765\u7f13\u5b58innodb\u7684\u7d22\u5f15\u5757, \u800c\u4e14\u4e5f\u7528\u6765\u7f13\u5b58innodb\u7684\u6570\u636e\u5757.","title":"InnoDB\u5185\u5b58\u4f18\u5316"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#innodb_buffer_pool_size","text":"\u8be5\u53d8\u91cf\u51b3\u5b9a\u4e86Innodb\u5b58\u50a8\u5f15\u64ce\u8868\u6570\u636e\u548c\u7d22\u5f15\u6570\u636e\u7684\u6700\u5927\u7f13\u5b58\u533a\u5927\u5c0f. \u5728\u4fdd\u8bc1\u64cd\u4f5c\u7cfb\u7edf\u53ca\u5176\u4ed6\u7a0b\u5e8f\u6709\u8db3\u591f\u5185\u5b58\u53ef\u7528\u7684\u60c5\u51b5\u4e0b,innodb_buffer_pool_size \u7684\u503c\u8d8a\u5927, \u7f13\u5b58\u547d\u4e2d\u7387\u8d8a\u9ad8, \u8bbf\u95eeInnoDB\u8868\u9700\u8981\u7684\u78c1\u76d8IO\u5c31\u8d8a\u5c11, \u6027\u80fd\u4e5f\u5c31\u8d8a\u9ad8.","title":"innodb_buffer_pool_size"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#innodb_log_buffer_size","text":"\u51b3\u5b9a\u4e86InnoDB\u91cd\u505a\u65e5\u5fd7\u7f13\u5b58\u7684\u5927\u5c0f, \u5bf9\u4e8e\u53ef\u80fd\u4ea7\u751f\u5927\u91cf\u66f4\u65b0\u8bb0\u5f55\u7684\u5927\u4e8b\u52a1, \u589e\u52a0innodb_log_buffer_size\u7684\u5927\u5c0f, \u53ef\u7528\u907f\u514dinnodb\u5728\u4e8b\u52a1\u63d0\u4ea4\u524d\u5c31\u6267\u884c\u4e0d\u5fc5\u8981\u7684\u65e5\u5fd7\u5199\u5165\u78c1\u76d8.","title":"innodb_log_buffer_size"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#mysql_1","text":"\u4ece\u5b9e\u73b0\u4e0a\u6765\u8bf4, MySQL Server \u662f\u591a\u7ebf\u7a0b\u7ed3\u679c, \u5305\u62ec\u540e\u53f0\u7ebf\u7a0b\u548c\u5ba2\u6237\u7aef\u7ebf\u7a0b. \u591a\u7ebf\u7a0b\u53ef\u7528\u6709\u6548\u5229\u7528\u670d\u52a1\u5668\u8d44\u6e90,\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u5e76\u53d1\u6027\u80fd. \u5728MySQL\u4e2d, \u63a7\u5236\u5e76\u53d1\u8fde\u63a5\u548c\u7ebf\u7a0b\u7684\u4e3b\u8981\u53c2\u6570\u5305\u62ec max_connections, back_log, thread_cache_size, table_open_cache.","title":"MySQL\u5e76\u53d1\u53c2\u6570\u8c03\u6574"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#max_connections","text":"\u91c7\u7528max_connections\u63a7\u5236\u5141\u8bb8\u8fde\u63a5\u5230MySQL\u6570\u636e\u5e93\u7684\u6700\u5927\u6570\u91cf, \u9ed8\u8ba4\u662f151. \u5f53\u5ba2\u6237\u7aef\u8fde\u63a5\u670d\u52a1\u7aef\u65f6,\u5f53\u540c\u65f6\u8fde\u63a5\u7684\u8bf7\u6c42\u8d85\u8fc7151\u65f6,\u5c31\u6ca1\u6709\u53ef\u7528\u7684\u8fde\u63a5\u6765\u5904\u7406\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42,\u540e\u9762\u8fdb\u6765\u7684\u8fde\u63a5\u90fd\u4f1a\u8fdb\u5165\u7b49\u5f85\u72b6\u6001. connections_errors_max_connections \u4e3a\u5f53\u8fde\u63a5\u8fbe\u5230\u6700\u5927\u8bf7\u6c42\u503c\u65f6,\u8fde\u63a5\u62a5\u9519\u7684\u4fe1\u606f. \u5982\u679c\u72b6\u6001\u53d8\u91cf connections_errors_max_connections \u4e0d\u4e3a\u96f6,\u5e76\u4e14\u4e00\u76f4\u589e\u957f, \u5219\u8bf4\u660e\u4e0d\u65ad\u6709\u8fde\u63a5\u8bf7\u6c42\u56e0\u6570\u636e\u5e93\u8fde\u63a5\u5df2\u8fbe\u5230\u5141\u8bb8\u6700\u5927\u503c\u800c\u5931\u8d25, \u8fd9\u65f6\u53ef\u4ee5\u8003\u8651\u589e\u5927max_connections\u7684\u503c. MySQL\u6700\u5927\u53ef\u652f\u6301\u7684\u8fde\u63a5\u6570, \u53d6\u51b3\u4e8e\u5f88\u591a\u56e0\u7d20,\u5305\u62ec\u7ed9\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u7684\u7ebf\u7a0b\u5e93\u7684\u8d28\u91cf,\u5185\u5b58\u5927\u5c0f,\u6bcf\u4e2a\u8fde\u63a5\u7684\u8d1f\u8377,CPU\u7684\u5904\u7406\u901f\u5ea6,\u671f\u671b\u7684\u54cd\u5e94\u65f6\u95f4\u7b49.\u5728Linux\u5e73\u53f0\u4e0b,\u6027\u80fd\u597d\u7684\u670d\u52a1\u5668,\u652f\u6301500-1000\u4e2a\u8fde\u63a5\u4e0d\u662f\u96be\u4e8b,\u9700\u8981\u6839\u636e\u670d\u52a1\u5668\u6027\u80fd\u8fdb\u884c\u8bbe\u5b9a.","title":"max_connections"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#back_log","text":"back_log\u53c2\u6570\u63a7\u5236MySQL\u76d1\u542cTCP\u7aef\u53e3\u65f6\u8bbe\u7f6e\u7684\u79ef\u538b\u8bf7\u6c42\u6808\u5927\u5c0f. \u5982\u679cMySQL\u7684\u8fde\u63a5\u6570\u8fbe\u5230max_connections\u65f6,\u65b0\u6765\u7684\u8bf7\u6c42\u5c06\u4f1a\u88ab\u5b58\u5728\u5806\u6808\u4e2d,\u4ee5\u7b49\u5f85\u67d0\u4e00\u8fde\u63a5\u91ca\u653e\u8d44\u6e90, \u8be5\u5806\u6808\u7684\u6570\u91cf\u65e2\u662fback_log. \u5982\u679c\u7b49\u5f85\u7684\u8fde\u63a5\u7684\u6570\u91cf\u8d85\u8fc7back_log, \u5c06\u4e0d\u88ab\u6388\u4e88\u8fde\u63a5\u8d44\u6e90,\u5c06\u4f1a\u62a5\u9519. 5.5.5\u7248\u672c\u4e4b\u524d\u9ed8\u8ba4\u503c\u4e3a50, \u4e4b\u540e\u7684\u7248\u672c\u9ed8\u8ba4\u4e3a50+(max_connections / 5), \u4f46\u6700\u5927\u4e0d\u8d85\u8fc7900. \u5982\u679c\u9700\u8981\u6570\u636e\u5e93\u5728\u77ed\u7684\u65f6\u95f4\u5185\u5904\u7406\u5927\u91cf\u7684\u8fde\u63a5\u8bf7\u6c42, \u53ef\u4ee5\u8003\u8651\u9002\u5f53\u589e\u5927back_log\u7684\u503c.","title":"back_log"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#table_open_cache","text":"\u8be5\u53c2\u6570\u7528\u6765\u63a7\u5236\u6240\u6709SQL\u8bed\u53e5\u6267\u884c\u7ebf\u7a0b\u53ef\u6253\u5f00\u8868\u7f13\u5b58\u7684\u6570\u91cf, \u800c\u5728\u6267\u884cSQL\u8bed\u53e5\u65f6, \u6bcf\u4e00\u4e2aSQL\u6267\u884c\u7ebf\u7a0b\u81f3\u5c11\u8981\u6253\u5f001\u4e2a\u8868\u7f13\u5b58. \u8be5\u53c2\u6570\u7684\u503c\u5e94\u8be5\u6839\u636e\u8bbe\u7f6e\u7684\u6700\u5927\u8fde\u63a5\u6570max_connections\u4e00\u4e2a\u6bcf\u4e2a\u8fde\u63a5\u6267\u884c\u5173\u8054\u67e5\u8be2\u4e2d\u6d89\u53ca\u7684\u8868\u7684\u6700\u5927\u6570\u91cf\u6765\u8bbe\u5b9a: max_connections x N;","title":"table_open_cache"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#hread_cache_size","text":"\u4e3a\u4e86\u52a0\u5feb\u6570\u636e\u5e93\u7684\u901f\u5ea6\uff0cMySQL\u4f1a\u7f13\u5b58\u4e00\u5b9a\u6570\u91cf\u7684\u5ba2\u6237\u670d\u52a1\u7ebf\u7a0b\u4ee5\u5907\u91cd\u7528\uff0c\u901a\u8fc7\u53c2\u6570 thread_cache_size \u53ef\u63a7\u5236 MySQL \u7f13\u5b58\u5ba2\u6237\u7aef\u670d\u52a1\u7ebf\u7a0b\u7684\u6570\u91cf\u3002","title":"hread_cache_size"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#innodb_lock_wait_timeout","text":"\u8be5\u53c2\u6570\u662f\u7528\u6765\u8bbe\u7f6e InnoDB \u4e8b\u52a1\u7b49\u5f85\u884c\u9501\u7684\u65f6\u95f4\uff0c\u9ed8\u8ba4\u503c\u662f 50 ms\uff0c\u53ef\u4ee5\u6839\u636e\u8fdb\u884c\u52a8\u6001\u8bbe\u7f6e\u3002\u5bf9\u4e8e\u9700\u8981\u5feb\u901f\u53cd\u9988\u7684\u4e1a\u52a1\u7cfb\u7edf\u6765\u8bf4\uff0c\u53ef\u4ee5\u5c06\u884c\u9501\u7684\u7b49\u5f85\u65f6\u95f4\u8c03\u5c0f\uff0c\u4ee5\u907f\u514d\u4e8b\u52a1\u957f\u65f6\u95f4\u6302\u8d77\uff1b\u5bf9\u4e8e\u540e\u53f0\u8fd0\u884c\u7684\u6279\u91cf\u5904\u7406\u7a0b\u5e8f\u6765\u8bf4\uff0c\u53ef\u4ee5\u5c06\u884c\u9501\u7684\u7b49\u5f85\u65f6\u95f4\u8c03\u5927\uff0c\u4ee5\u907f\u514d\u53d1\u751f\u5927\u7684\u56de\u6eda\u64cd\u4f5c\u3002","title":"innodb_lock_wait_timeout"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#2mysql","text":"","title":"2\u3001MySQL \u9501\u95ee\u9898"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#21","text":"\u9501 \u662f\u8ba1\u7b97\u673a\u534f\u8c03\u591a\u4e2a\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u5e76\u53d1\u8bbf\u95ee\u67d0\u4e00\u8d44\u6e90\u7684\u673a\u5236\uff08\u907f\u514d\u4e89\u62a2\uff09\u3002 \u5728\u6570\u636e\u5e93\u4e2d\uff0c\u9664\u4f20\u7edf\u7684\u8ba1\u7b97\u8d44\u6e90\uff08\u5982\uff1aCPU\u3001RAM\u3001I/O \u7b49\uff09\u7684\u4e89\u7528\u4ee5\u5916\uff0c\u6570\u636e\u4e5f\u662f\u4e00\u79cd\u4f9b\u8bb8\u591a\u7528\u6237\u5171\u4eab\u7684\u8d44\u6e90\u3002\u5982\u4f55\u4fdd\u8bc1\u6570\u636e\u5e76\u53d1\u8bbf\u95ee\u7684\u4e00\u81f4\u6027\u3001\u6709\u6548\u6027\u662f\u6240\u6709\u6570\u636e\u5e93\u5fc5\u987b\u89e3\u51b3\u7684\u4e00\u4e2a\u95ee\u9898\uff0c\u9501\u51b2\u7a81\u4e5f\u662f\u5f71\u54cd\u6570\u636e\u5e93\u5e76\u53d1\u8bbf\u95ee\u6027\u80fd\u7684\u4e00\u4e2a\u91cd\u8981\u56e0\u7d20\u3002","title":"2.1\u3001\u9501\u6982\u8ff0"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#22","text":"\u4ece\u5bf9\u6570\u636e\u64cd\u4f5c\u7684\u7c92\u5ea6\u5206\uff1a \u8868\u9501\uff1a\u64cd\u4f5c\u65f6\uff0c\u4f1a\u9501\u5b9a\u6574\u4e2a\u8868 \u884c\u9501\uff1a\u64cd\u4f5c\u65f6\uff0c\u4f1a\u9501\u5b9a\u5f53\u524d\u64cd\u4f5c\u884c \u4ece\u5bf9\u6570\u636e\u64cd\u4f5c\u7684\u7c7b\u578b\u5206\uff1a \u8bfb\u9501\uff08\u5171\u4eab\u9501\uff09\uff1a\u9488\u5bf9\u540c\u4e00\u4efd\u6570\u636e\uff0c\u591a\u4e2a\u8bfb\u64cd\u4f5c\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c\u800c\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd \u5199\u9501\uff08\u6392\u5b83\u9501\uff09\uff1a\u5f53\u524d\u64cd\u4f5c\u6ca1\u6709\u5b8c\u6210\u4e4b\u524d\uff0c\u5b83\u4f1a\u963b\u65ad\u5176\u4ed6\u5199\u9501\u548c\u8bfb\u9501","title":"2.2\u3001\u9501\u5206\u7c7b"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#23mysql","text":"\u76f8\u5bf9\u4e8e\u5176\u4ed6\u6570\u636e\u5e93\u800c\u8a00\uff0cMySQL \u7684\u9501\u673a\u5236\u6bd4\u8f83\u7b80\u5355\uff0c\u5176\u6700\u663e\u8457\u7684\u7279\u70b9\u5c31\u662f\u4e0d\u540c\u7684\u5b58\u50a8\u5f15\u64ce\u652f\u6301\u4e0d\u540c\u7684\u9501\u673a\u5236\u3002\u4e0b\u8868\u4e2d\u7f57\u5217\u51fa\u4e86\u5404\u4e2a\u5b58\u50a8\u5f15\u64ce\u5bf9\u9501\u7684\u652f\u6301\u60c5\u51b5 \u5b58\u50a8\u5f15\u64ce \u8868\u7ea7\u9501 \u884c\u7ea7\u9501 \u9875\u9762\u9501 MyISAM \u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 InnoDB \u652f\u6301 \u652f\u6301 \u4e0d\u652f\u6301 MEMORY \u652f\u6301 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 BDB \u652f\u6301 \u4e0d\u652f\u6301 \u652f\u6301 MySQL \u8fd93\u4e2d\u9501\u7684\u7279\u6027\u53ef\u5927\u81f4\u5f52\u7eb3\u5982\u4e0b\uff1a \u9501\u7c7b\u578b \u7279\u70b9 \u8868\u6781\u9501 \u504f\u5411 MyISAM \u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u9500\u5c0f\uff0c\u52a0\u9501\u5feb\uff1b\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u5927\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u9ad8\uff0c\u5e76\u53d1\u5ea6\u6700\u4f4e \u884c\u6781\u9501 \u504f\u5411 InnoDB \u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u9500\u5927\uff0c\u52a0\u9501\u6162\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u6700\u5c0f\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u4f4e\uff0c\u5e76\u53d1\u5ea6\u4e5f\u6700\u9ad8 \u9875\u9762\u9501 \u5f00\u9501\u548c\u52a0\u9501\u65f6\u95f4\u4ecb\u4e8e\u8868\u9501\u548c\u884c\u9501\u4e4b\u95f4\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u4ecb\u4e8e\u8868\u9501\u548c\u884c\u9501\u4e4b\u95f4\uff0c\u5e76\u53d1\u5ea6\u4e00\u822c \u4ece\u4e0a\u8ff0\u6765\u770b\uff0c\u5f88\u96be\u7b3c\u7edf\u5730\u8bf4\u54ea\u79cd\u9501\u66f4\u597d\uff0c\u53ea\u80fd\u5c31\u5177\u4f53\u5e94\u7528\u7684\u7279\u70b9\u6765\u8bf4\u54ea\u79cd\u9501\u66f4\u5408\u9002\u3002 \u4ec5\u4ece\u9501\u7684\u89d2\u5ea6\u6765\u8bf4\uff1a \u8868\u7ea7\u9501 \u66f4\u9002\u5408\u4ee5\u67e5\u8be2\u4e3a\u4e3b\uff0c\u53ea\u6709\u5c11\u91cf\u6309\u7d22\u5f15\u6761\u4ef6\u66f4\u65b0\u6570\u636e\u7684\u5e94\u7528\uff0c\u5982web\u5e94\u7528\uff1b \u884c\u7ea7\u9501 \u66f4\u9002\u5408\u4e8e\u6709\u5927\u91cf\u6309\u7d22\u5f15\u6761\u4ef6\u5e76\u53d1\u66f4\u65b0\u5c11\u91cf\u4e0d\u540c\u6570\u636e\uff0c\u540c\u65f6\u53c8\u6709\u5e76\u67e5\u8be2\u7684\u5e94\u7528\uff0c\u5982\u4e00\u4e9b\u5728\u7ebf\u4e8b\u52a1\u5904\u7406\uff08OLTP\uff09\u7cfb\u7edf\u3002","title":"2.3\u3001MySQL\u9501"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#24myisam","text":"MyISAM \u5b58\u50a8\u5f15\u64ce\u53ea\u652f\u6301\u8868\u9501\uff0c\u8fd9\u4e5f\u662f MySQL \u5f00\u59cb\u51e0\u4e2a\u7248\u672c\u4e2d\u552f\u4e00\u652f\u6301\u7684\u9501\u7c7b\u578b\u3002","title":"2.4\u3001MyISAM \u8868\u9501"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#241","text":"MyISAM \u5728\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff08SELECT\uff09\u524d\uff0c\u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u7684\u6240\u6709\u8868\u52a0\u8bfb\u9501\uff0c\u5728\u6267\u884c\u66f4\u65b0\u64cd\u4f5c\uff08UPDATE\u3001DELETE\u3001INSERT\u7b49\uff09\u524d\uff0c\u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u7684\u8868\u52a0\u5199\u9501\u3002 \u8fd9\u4e2a\u8fc7\u7a0b\u5e76\u4e0d\u9700\u8981\u7528\u6237\u5e72\u9884\uff0c\u56e0\u6b64\uff0c\u7528\u6237\u4e00\u822c\u4e0d\u9700\u8981\u76f4\u63a5\u7528 LOCJ TABLE \u547d\u4ee4\u7ed9 MyISAM \u8868\u663e\u793a\u52a0\u9501\u3002 \u663e\u793a\u52a0\u8868\u9501\u8bed\u6cd5\uff1a \u52a0\u8bfb\u9501\uff1alock table table_name read; \u52a0\u5199\u9501\uff1alock table table_name write;","title":"2.4.1\u3001\u5982\u4f55\u52a0\u8868\u9501"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#244","text":"\u5f53\u524d\u9501\u6a21\u5f0f\\\u8bf7\u6c42\u9501\u6a21\u5f0f None \u8bfb\u9501 \u5199\u9501 \u8bfb\u9501 \u662f \u662f \u5426 \u5199\u9501 \u662f \u5426 \u5426 \u7531\u4e0a\u8868\u53ef\u89c1\uff1a 1\uff09\u5bf9 MyISAM \u8868\u7684\u8bfb\u64cd\u4f5c\uff0c\u4e0d\u4f1a\u963b\u585e\u5176\u4ed6\u7528\u6237\u5bf9\u540c\u4e00\u8868\u7684\u8bfb\u8bf7\u6c42\uff0c\u4f46\u4f1a\u963b\u585e\u5bf9\u7edf\u4e00\u8868\u7684\u5199\u8bf7\u6c42\uff1b 2\uff09\u5bf9 MyISAM \u8868\u7684\u5199\u64cd\u4f5c\uff0c\u5219\u4f1a\u963b\u585e\u5176\u4ed6\u7528\u6237\u5bf9\u540c\u4e00\u8868\u7684\u8bfb\u548c\u5199\u64cd\u4f5c\uff1b \u7b80\u800c\u8a00\u4e4b\uff0c \u5c31\u662f\u8bfb\u9501\u4f1a\u963b\u585e\u5199\uff0c\u4f46\u662f\u4e0d\u4f1a\u963b\u585e\u8bfb \u3002\u800c\u5199\u9501\uff0c \u65e2\u4f1a\u963b\u585e\u8bfb\uff0c\u53c8\u4f1a\u963b\u585e\u5199 \u3002 \u6b64\u5916\uff0c MyISAM \u7684\u8bfb\u5199\u9501\u8c03\u5ea6\u662f \u5199 \u4f18\u5148\u3002\u8fd9\u4e5f\u662f MyISAM \u4e0d\u9002\u5408\u4f5c\u4e3a\u5199\u4e3a\u4e3b\u7684\u8868\u7684\u5b58\u50a8\u5f15\u64ce\u7684\u539f\u56e0\u3002\u56e0\u4e3a\u5199\u9501\u540e\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4e0d\u80fd\u505a\u4efb\u4f55\u64cd\u4f5c\uff0c\u5927\u91cf\u7684\u66f4\u65b0\u4f1a\u4f7f\u67e5\u8be2\u5f88\u96be\u5f97\u5230\u9501\uff0c\u4ece\u800c\u9020\u6210\u6c38\u8fdc\u963b\u585e\u3002","title":"2.4.4\u3001\u7ed3\u8bba"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#245","text":"show open tables; In_use\uff1a\u8868\u5f53\u524d\u88ab\u67e5\u8be2\u4f7f\u7528\u7684\u6b21\u6570\uff0c\u5982\u679c\u4e3a\u96f6\uff0c\u5219\u8868\u662f\u6253\u5f00\u7684\uff0c\u4f46\u662f\u5f53\u524d\u6ca1\u6709\u88ab\u4f7f\u7528\u3002 Name_locked\uff1a\u8868\u540d\u79f0\u662f\u5426\u88ab\u9501\u5b9a\u3002\u540d\u79f0\u9501\u5b9a\u7528\u4e8e\u53d6\u6d88\u8868\u6216\u5bf9\u8868\u8fdb\u884c\u91cd\u547d\u540d\u7b49\u64cd\u4f5c\u3002 show status like 'Table_locks%'; mysql> show status like 'Table_lock%'; +-----------------------+------------+ | Variable_name | Value | +-----------------------+------------+ | Table_locks_immediate | 2772892035 | | Table_locks_waited | 64713 | +-----------------------+------------+ 2 rows in set (0.00 sec) Table_locks_immediate\uff1a\u6307\u7684\u662f\u80fd\u591f\u7acb\u5373\u83b7\u5f97\u8868\u7ea7\u9501\u7684\u6b21\u6570\uff0c\u6bcf\u7acb\u5373\u83b7\u53d6\u9501\uff0c\u503c\u52a0 1\u3002 Table_locks_waited\uff1a\u6307\u7684\u662f\u4e0d\u80fd\u7acb\u5373\u83b7\u53d6\u8868\u6781\u9501\u800c\u9700\u8981\u7b49\u5f85\u7684\u6b21\u6570\uff0c\u6bcf\u7b49\u5f85\u4e00\u6b21\uff0c\u8be5\u503c\u52a0 1\uff0c\u6b64\u503c\u8d8a\u9ad8\u8bf4\u660e\u5b58\u5728\u7740\u8f83\u4e3a\u4e25\u91cd\u7684\u8868\u6781\u9501\u4e89\u7528\u60c5\u51b5\u3002","title":"2.4.5\u3001\u67e5\u770b\u9501\u7684\u4e89\u7528\u60c5\u51b5"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#25innodb","text":"","title":"2.5\u3001InnoDB \u884c\u9501"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#251","text":"\u884c\u9501\u7279\u70b9\uff1a\u504f\u5411 InnoDB \u5b58\u50a8\u5f15\u64ce\uff0c\u5f00\u9500\u5927\uff0c\u52a0\u9501\u6162\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u5c0f\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u4f4e\uff0c\u5e76\u53d1\u5ea6\u6700\u9ad8\u3002 InnoDB \u4e0e MyISAM \u7684\u6700\u5927\u4e0d\u540c\u6709\u4e24\u70b9\uff1a\u4e00\u662f\u652f\u6301\u4e8b\u52a1\uff0c\u4e8c\u662f\u91c7\u7528\u4e86\u884c\u7ea7\u9501\u3002","title":"2.5.1\u3001\u884c\u9501\u4ecb\u7ecd"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#252","text":"1\u3001\u4e8b\u52a1\u53ca\u5176ACID\u5c5e\u6027 \u4e8b\u52a1\u662f\u7531\u4e00\u7ec4 SQL \u8bed\u53e5\u7ec4\u6210\u7684\u903b\u8f91\u5904\u7406\u5355\u5143\u3002 \u4e8b\u52a1\u5177\u6709\u4ee5\u4e0b 4 \u4e2a\u7279\u6027\uff0c\u7b80\u79f0\u4e3a \u4e8b\u52a1ACID\u5c5e\u6027 \u3002 ACID\u5c5e\u6027 \u542b\u4e49 \u539f\u5b50\u6027\uff08Atomicity\uff09 \u4e8b\u52a1\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\u5355\u5143\uff0c\u5176\u5bf9\u6570\u636e\u7684\u4fee\u6539\uff0c\u8981\u4e48\u5168\u90e8\u6210\u529f\uff0c\u8981\u4e48\u5168\u90e8\u5931\u8d25 \u4e00\u81f4\u6027\uff08Consistent\uff09 \u5728\u4e8b\u52a1\u5f00\u59cb\u548c\u5b8c\u6210\u65f6\uff0c\u6570\u636e\u90fd\u5fc5\u987b\u4fdd\u6301\u4e00\u81f4\u72b6\u6001 \u9694\u79bb\u6027\uff08Isolation\uff09 \u6570\u636e\u5e93\u7cfb\u7edf\u63d0\u4f9b\u4e00\u5b9a\u7684\u9694\u79bb\u673a\u5236\uff0c\u4fdd\u8bc1\u4e8b\u52a1\u5728\u4e0d\u53d7\u5916\u90e8\u5e76\u53d1\u64cd\u4f5c\u5f71\u54cd\u7684\u201c\u72ec\u7acb\u73af\u5883\u201d\u4e0b\u8fd0\u884c \u6301\u4e45\u6027\uff08Durable\uff09 \u4e8b\u52a1\u5b8c\u6210\u4e4b\u540e\uff0c\u5bf9\u4e8e\u6570\u636e\u7684\u4fee\u6539\u662f\u6c38\u4e45\u7684\u3002 2\u3001\u5e76\u53d1\u4e8b\u52a1\u5904\u7406\u5e26\u6765\u7684\u95ee\u9898 \u95ee\u9898 \u542b\u4e49 \u4e22\u5931\u66f4\u65b0\uff08Lost Update\uff09 \u5f53\u4e24\u4e2a\u6216\u591a\u4e2a\u4e8b\u52a1\u9009\u62e9\u540c\u4e00\u884c\uff0c\u6700\u521d\u7684\u4e8b\u52a1\u4fee\u6539\u7684\u503c\uff0c\u4f1a\u88ab\u540e\u9762\u7684\u4e8b\u52a1\u4fee\u6539\u7684\u503c\u8986\u76d6\u3002 \u810f\u8bfb\uff08Dirty Reads\uff09 \u5f53\u4e00\u4e2a\u4e8b\u52a1\u6b63\u5728\u8bbf\u95ee\u6570\u636e\uff0c\u5e76\u5bf9\u6570\u636e\u8fdb\u884c\u4e86\u4fee\u6539\uff0c\u800c\u8fd9\u79cd\u4fee\u6539\u8fd8\u6ca1\u6709\u63d0\u4ea4\u5230\u6570\u636e\u5e93\u4e2d\u3002\u8fd9\u65f6\uff0c\u53e6\u5916\u4e00\u4e2a\u4e8b\u52a1\u4e5f\u8bbf\u95ee\u4e86\u8fd9\u4e2a\u6570\u636e\uff0c\u7136\u540e\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6570\u636e\u3002 \u4e0d\u53ef\u91cd\u590d\u8bfb\uff08Non-Repeatable Reads\uff09 \u4e00\u4e2a\u4e8b\u52a1\u5728\u8bfb\u53d6\u67d0\u4e9b\u6570\u636e\u540e\u7684\u67d0\u4e2a\u65f6\u95f4\uff0c\u518d\u6b21\u8bfb\u53d6\u4ee5\u524d\u8bfb\u8fc7\u7684\u6570\u636e\uff0c\u5374\u53d1\u73b0\u548c\u4ee5\u524d\u8bfb\u51fa\u7684\u6570\u636e\u4e0d\u4e00\u81f4\u3002 \u5e7b\u8bfb\uff08Phantom Reads\uff09 \u4e00\u4e2a\u4e8b\u52a1\u6309\u7167\u76f8\u540c\u7684\u67e5\u8be2\u6761\u4ef6\u91cd\u65b0\u8bfb\u53d6\u4ee5\u524d\u67e5\u8be2\u8fc7\u7684\u6570\u636e\uff0c\u5374\u53d1\u73b0\u5176\u4ed6\u4e8b\u52a1\u63d2\u5165\u4e86\u6ee1\u8db3\u67e5\u8be2\u6761\u4ef6\u7684\u65b0\u6570\u636e\u3002 3\u3001\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b \u4e3a\u4e86\u89e3\u51b3\u4e0a\u8ff0\u63d0\u5230\u7684\u4e8b\u52a1\u5e76\u53d1\u95ee\u9898\uff0c\u6570\u636e\u5e93\u63d0\u4f9b\u4e00\u5b9a\u7684\u4e8b\u52a1\u9694\u79bb\u673a\u5236\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u9694\u79bb\u8d8a\u4e25\u683c\uff0c\u5e76\u53d1\u526f\u4f5c\u7528\u8d8a\u5c0f\uff0c\u4f46\u4ed8\u51fa\u7684\u4ee3\u4ef7\u4e5f\u5c31\u8d8a\u5927\uff0c\u56e0\u4e3a\u4e8b\u52a1\u9694\u79bb\u5b9e\u8d28\u4e0a\u5c31\u662f\u4f7f\u7528\u4e8b\u52a1\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u201c\u4e32\u884c\u5316\u201d\u8fdb\u884c\uff0c\u8fd9\u663e\u7136\u4e0e\u201d\u5e76\u53d1\u201c\u662f\u77db\u76fe\u7684\u3002 \u6570\u636e\u5e93\u7684\u9694\u79bb\u7ea7\u522b\u6709 4 \u4e2a\uff0c\u7531\u4f4e\u5230\u9ad8\u4f9d\u6b21\u4e3a Read uncommitted \u3001 Read committed \u3001 Repeatable read \u3001 Serializbale \uff0c\u8fd9\u56db\u4e2a\u51e0\u676f\u53ef\u4ee5\u9010\u4e2a\u89e3\u51b3 \u810f\u5199\u3001\u810f\u8bfb\u3001\u4e0d\u53ef\u91cd\u590d\u8bfb\u3001\u5e7b\u8bfb\u8fd9\u51e0\u7c7b\u95ee\u9898\u3002 \u9694\u79bb\u7ea7\u522b \u4e22\u5931\u66f4\u65b0 \u810f\u8bfb \u4e0d\u53ef\u91cd\u590d\u8bfb \u5e7b\u8bfb Read uncommitted \u00d7 \u221a \u221a \u221a Read committed \u00d7 \u00d7 \u221a \u221a Repeatable read\uff08\u9ed8\u8ba4\uff09 \u00d7 \u00d7 \u00d7 \u221a Serializable \u00d7 \u00d7 \u00d7 \u00d7 \u5907\u6ce8 \uff1a \u221a \u4ee3\u8868\u53ef\u80fd\u51fa\u73b0 \uff0c \u00d7 \u4ee3\u8868\u4e0d\u4f1a\u51fa\u73b0 \u3002 MySQL \u7684\u6570\u636e\u5e93\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u4e3a Repeatable read \uff0c\u67e5\u770b\u65b9\u5f0f\u4e3a\uff1a show variables like 'tx_isolation';","title":"2.5.2\u3001\u80cc\u666f\u77e5\u8bc6"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#253innodb","text":"InnoDB \u5b9e\u73b0\u4e86\u4ee5\u4e0b\u4e24\u79cd\u7c7b\u578b\u7684\u884c\u9501\u3002 \u5171\u4eab\u9501\uff08S\uff09\uff1a\u53c8\u79f0\u4e3a \u8bfb\u9501\uff0c\u7b80\u79f0 S\u9501 \uff0c\u5171\u4eab\u9501\u5c31\u662f\u591a\u4e2a\u4e8b\u52a1\u5bf9\u4e8e\u540c\u4e00\u6570\u636e\u53ef\u4ee5\u5171\u4eab\u4e00\u628a\u9501\uff0c\u90fd\u80fd\u8bbf\u95ee\u5230\u6570\u636e\uff0c\u4f46\u662f\u53ea\u80fd\u8bfb\u4e0d\u80fd\u4fee\u6539\u3002 \u6392\u4ed6\u9501\uff08X\uff09\uff1a\u53c8\u79f0\u4e3a \u5199\u9501\uff0c\u7b80\u79f0 X\u9501 \uff0c\u6392\u4ed6\u9501\u4e0d\u80fd\u4e0e\u5176\u4ed6\u9501\u5e76\u5b58\uff0c\u5982\u4e00\u4e2a\u4e8b\u52a1\u83b7\u53d6\u4e86\u4e00\u4e2a\u6570\u636e\u884c\u7684\u6392\u4ed6\u9501\uff0c\u5176\u4ed6\u4e8b\u52a1\u5c31\u4e0d\u80fd\u518d\u83b7\u53d6\u8be5\u884c\u7684\u5176\u4ed6\u9501\uff0c\u5305\u62ec\u5171\u4eab\u9501\u548c\u6392\u4ed6\u9501\uff0c\u4f46\u662f\u83b7\u53d6\u6392\u4ed6\u9501\u7684\u4e8b\u52a1\u662f\u53ef\u4ee5\u5bf9\u6570\u636e\u5c31 \u884c \u8bfb\u53d6\u548c\u4fee\u6539\u3002 \u5bf9\u4e8e UPDATE\u3001DELETE\u3001INSERT \u8bed\u53e5\uff0cInnoDB \u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u6570\u636e\u96c6\u52a0 \u6392\u4ed6\u9501\uff08X\uff09\uff1b \u5bf9\u4e8e\u666e\u901a SELECT \u8bed\u53e5\uff0c InnoDB \u4e0d\u4f1a\u52a0\u4efb\u4f55\u9501\uff1b \u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u8bed\u53e5\u663e\u793a\u7ed9\u8bb0\u5f55\u96c6\u52a0\u5171\u4eab\u9501\u6216\u6392\u4ed6\u9501\u3002 \u5171\u4eab\u9501\uff08S\uff09\uff1aselect * from table_name where ... lock in share mode \u6392\u4ed6\u9501\uff08X\uff09\uff1aselect * from table_name where ... for update","title":"2.5.3\u3001InnoDB \u7684\u884c\u9501\u6a21\u5f0f"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#256","text":"\u5982\u679c\u4e0d\u901a\u8fc7\u7d22\u5f15\u6761\u4ef6\u68c0\u7d22\u6570\u636e\uff0c\u90a3\u4e48 InnoDB \u5c06\u5bf9\u8868\u4e2d\u7684\u6240\u6709\u8bb0\u5f55\u52a0\u9501\uff0c\u5b9e\u9645\u6548\u679c\u8ddf\u8868\u9501\u4e00\u6837\u3002 \u67e5\u770b\u5f53\u524d\u8868\u7684\u7d22\u5f15\uff1a show index from test_innodb_lock; \u7531\u4e8e\u6267\u884c\u66f4\u65b0\u65f6\uff0c name \u5b57\u6bb5\u672c\u6765\u4e3a varchar \u7c7b\u578b\uff0c\u6211\u4eec\u662f\u4f5c\u4e3a\u6570\u636e\u7c7b\u578b\u4f7f\u7528\uff0c\u5b58\u5728\u7c7b\u578b\u8f6c\u6362\uff0c\u7d22\u5f15\u5931\u6548\uff0c\u6700\u7ec8 \u884c\u9501\u53d8\u4e3a\u8868\u9501\u3002","title":"2.5.6\u3001\u65e0\u7d22\u5f15\u884c\u9501\u5347\u7ea7\u4e3a\u8868\u9501"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#257","text":"\u5f53\u6211\u4eec\u7528\u8303\u56f4\u6761\u4ef6\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u76f8\u7b49\u6761\u4ef6\u68c0\u7d22\u6570\u636e\uff0c\u5e76\u8bf7\u6c42\u5171\u4eab\u6216\u6392\u5b83\u9501\u65f6\uff0cInnoDB \u4f1a\u7ed9\u7b26\u5408\u6761\u4ef6\u7684\u5df2\u6709\u6570\u636e\u8fdb\u884c\u52a0\u9501\uff1b\u5bf9\u4e8e\u952e\u503c\u5728\u6761\u4ef6\u8303\u56f4\u5185\u4f46\u4e0d\u5b58\u5728\u8bb0\u5f55\uff0c\u53eb\u505a\u201c \u95f4\u9699\uff08GAP\uff09 \u201d\uff0cInnoDB \u4e5f\u4f1a\u5bf9\u8fd9\u4e2a\u201c\u95f4\u9699\u201d\u52a0\u9501\uff0c\u8fd9\u79cd\u673a\u5236\u5c31\u662f\u6240\u8c13\u7684 \u95f4\u9699\u9501\uff08Next-key\u9501\uff09","title":"2.5.7\u3001\u95f4\u9699\u9501\u5371\u5bb3"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#258innodb","text":"show status like 'innodb_row_lock%'; Innodb_row_lock_current_waits: \u5f53\u524d\u6b63\u5728\u7b49\u5f85\u9501\u5b9a\u7684\u6570\u91cf Innodb_row_lock_time: \u4ece\u7cfb\u7edf\u542f\u52a8\u5230\u73b0\u5728\u9501\u5b9a\u603b\u65f6\u95f4\u957f\u5ea6 Innodb_row_lock_time_avg:\u6bcf\u6b21\u7b49\u5f85\u6240\u82b1\u5e73\u5747\u65f6\u957f Innodb_row_lock_time_max:\u4ece\u7cfb\u7edf\u542f\u52a8\u5230\u73b0\u5728\u7b49\u5f85\u6700\u957f\u7684\u4e00\u6b21\u6240\u82b1\u7684\u65f6\u95f4 Innodb_row_lock_waits: \u7cfb\u7edf\u542f\u52a8\u540e\u5230\u73b0\u5728\u603b\u5171\u7b49\u5f85\u7684\u6b21\u6570 \u5f53\u7b49\u5f85\u7684\u6b21\u6570\u5f88\u9ad8\uff0c\u800c\u4e14\u6bcf\u6b21\u7b49\u5f85\u7684\u65f6\u957f\u4e5f\u4e0d\u5c0f\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5206\u6790\u7cfb\u7edf\u4e2d\u4e3a\u4ec0\u4e48\u4f1a\u6709\u5982\u6b64\u591a\u7684\u7b49\u5f85\uff0c\u7136\u540e\u6839\u636e\u5206\u6790\u7ed3\u679c\u7740\u624b\u5236\u5b9a\u4f18\u5316\u8ba1\u5212\u3002","title":"2.5.8\u3001InnoDB\u884c\u9501\u4e89\u7528\u60c5\u51b5"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#259","text":"InnoDB \u5b58\u50a8\u5f15\u64ce\u7531\u4e8e\u5b9e\u73b0\u4e86\u884c\u7ea7\u9501\u5b9a\uff0c\u867d\u7136\u5728\u9501\u5b9a\u673a\u5236\u7684\u5b9e\u73b0\u65b9\u9762\u5e26\u6765\u4e86\u6027\u80fd\u635f\u8017\u53ef\u80fd\u6bd4\u8868\u6781\u9501\u4f1a\u66f4\u9ad8\u4e00\u4e9b\uff0c\u4f46\u662f\u5728\u6574\u4f53\u5e76\u53d1\u5904\u7406\u80fd\u529b\u65b9\u9762\u8981\u8fdc\u8fdc\u4f18\u4e8eMyISAM\u7684\u8868\u9501\u7684\u3002\u5f53\u7cfb\u7edf\u5e76\u53d1\u91cf\u6bd4\u8f83\u9ad8\u7684\u65f6\u5019\uff0cInnoDB \u7684\u6574\u4f53\u6027\u80fd\u548c MyISAM \u76f8\u6bd4\u5c31\u4f1a\u6709\u6bd4\u8f83\u660e\u663e\u7684\u4f18\u52bf\u3002 \u4f46\u662f\uff0cInnoDB \u7684\u884c\u7ea7\u9501\u4e5f\u6709\u8106\u5f31\u7684\u4e00\u9762\uff0c\u5f53\u6211\u4eec\u4f7f\u7528\u4e0d\u5f53\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u8ba9 InnoDB \u7684\u6574\u4f53\u6027\u80fd\u8868\u73b0\u4e0d\u4ec5\u4e0d\u80fd\u6bd4 MyISAM \u9ad8\uff0c\u751a\u81f3\u4f1a\u66f4\u5dee\u3002","title":"2.5.9\u3001\u603b\u7ed3"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#2510","text":"\u5c3d\u53ef\u80fd\u8ba9\u6240\u6709\u6570\u636e\u68c0\u7d22\u90fd\u80fd\u901a\u8fc7\u7d22\u5f15\u6765\u5b8c\u6210\uff0c\u907f\u514d\u65e0\u7d22\u5f15\u884c\u9501\u5347\u7ea7\u4e3a\u8868\u9501\u3002 \u5408\u7406\u8bbe\u8ba1\u7d22\u5f15\uff0c\u5c3d\u91cf\u7f29\u5c0f\u9501\u7684\u8303\u56f4 \u5c3d\u53ef\u80fd\u51cf\u5c11\u7d22\u5f15\u6761\u4ef6\uff0c\u53ca\u7d22\u5f15\u8303\u56f4\uff0c\u907f\u514d\u95f4\u9699\u9501 \u5c3d\u91cf\u63a7\u5236\u4e8b\u52a1\u5927\u5c0f\uff0c\u51cf\u5c11\u9501\u5b9a\u8d44\u6e90\u91cf\u548c\u65f6\u95f4\u957f\u5ea6 \u5c3d\u53ef\u80fd\u4f7f\u7528\u4f4e\u7ea7\u522b\u4e8b\u52a1\u9694\u79bb\uff08\u4f46\u662f\u9700\u8981\u4e1a\u52a1\u5c42\u6ee1\u8db3\u9700\u6c42\uff09","title":"2.5.10\u3001\u4f18\u5316\u5efa\u8bae"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#3mysql","text":"","title":"3\u3001\u5e38\u7528MySQL\u6280\u5de7"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#1-sql","text":"\u7f16\u5199\u987a\u5e8f SELECT DISTINCT <select list> FROM <left_table> <join_type> JOIN <right_table> ON <join_condition> WHERE <where_condition> GROUP BY <group_by_list> HAVING <having_condition> ORDER BY <order_by_condition> LIMIT <limit_params> 12345678910111213141516 \u6267\u884c\u987a\u5e8f FROM <left_table> ON <join_condition> <join_type> JOIN <right_table> WHERE <where_condition> GROUP BY <group_by_list> HAVING <having_condition> SELECT DISTINCT <select list> ORDER BY <order_by_condition> LIMIT <limit_params>","title":"1. SQL \u6267\u884c\u987a\u5e8f"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#2","text":"\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Regular Expression\uff09\u662f\u6307\u4e00\u4e2a\u7528\u6765\u63cf\u8ff0\u6216\u8005\u5339\u914d\u4e00\u7cfb\u5217\u7b26\u5408\u67d0\u4e2a\u53e5\u6cd5\u89c4\u5219\u7684\u5b57\u7b26\u4e32\u7684\u5355\u4e2a\u5b57\u7b26\u4e32\u3002 \u7b26\u53f7 \u542b\u4e49 ^ \u5728\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u8fdb\u884c\u5339\u914d $ \u5728\u5b57\u7b26\u4e32\u672b\u5c3e\u5904\u8fdb\u884c\u5339\u914d . \u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26, \u5305\u62ec\u6362\u884c\u7b26 [\u2026] \u5339\u914d\u51fa\u62ec\u53f7\u5185\u7684\u4efb\u610f\u5b57\u7b26 [^\u2026] \u5339\u914d\u4e0d\u51fa\u62ec\u53f7\u5185\u7684\u4efb\u610f\u5b57\u7b26 a* \u5339\u914d\u96f6\u4e2a\u6216\u8005\u591a\u4e2aa(\u5305\u62ec\u7a7a\u4e32) a+ \u5339\u914d\u4e00\u4e2a\u6216\u8005\u591a\u4e2aa(\u4e0d\u5305\u62ec\u7a7a\u4e32) a? \u5339\u914d\u96f6\u4e2a\u6216\u8005\u4e00\u4e2aa a1|a2 \u5339\u914da1\u6216a2 a(m) \u5339\u914dm\u4e2aa a(m,) \u81f3\u5c11\u5339\u914dm\u4e2aa a(m,n) \u5339\u914dm\u4e2aa \u5230 n\u4e2aa a(,n) \u5339\u914d0\u5230n\u4e2aa (\u2026) \u5c06\u6a21\u5f0f\u5143\u7d20\u7ec4\u6210\u5355\u4e00\u5143\u7d20 select * from emp where name regexp '^T'; select * from emp where name regexp '2$'; select * from emp where name regexp '[uvw]'; 12345","title":"2. \u6b63\u5219\u8868\u8fbe\u5f0f\u4f7f\u7528"},{"location":"Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/#3-mysql","text":"\u6570\u5b57\u51fd\u6570 \u51fd\u6570\u540d\u79f0 \u4f5c \u7528 ABS \u6c42\u7edd\u5bf9\u503c SQRT \u6c42\u4e8c\u6b21\u65b9\u6839 MOD \u6c42\u4f59\u6570 CEIL \u548c CEILING \u4e24\u4e2a\u51fd\u6570\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u8fd4\u56de\u4e0d\u5c0f\u4e8e\u53c2\u6570\u7684\u6700\u5c0f\u6574\u6570\uff0c\u5373\u5411\u4e0a\u53d6\u6574 FLOOR \u5411\u4e0b\u53d6\u6574\uff0c\u8fd4\u56de\u503c\u8f6c\u5316\u4e3a\u4e00\u4e2aBIGINT RAND \u751f\u6210\u4e00\u4e2a0~1\u4e4b\u95f4\u7684\u968f\u673a\u6570\uff0c\u4f20\u5165\u6574\u6570\u53c2\u6570\u662f\uff0c\u7528\u6765\u4ea7\u751f\u91cd\u590d\u5e8f\u5217 ROUND \u5bf9\u6240\u4f20\u53c2\u6570\u8fdb\u884c\u56db\u820d\u4e94\u5165 SIGN \u8fd4\u56de\u53c2\u6570\u7684\u7b26\u53f7 POW \u548c POWER \u4e24\u4e2a\u51fd\u6570\u7684\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u6240\u4f20\u53c2\u6570\u7684\u6b21\u65b9\u7684\u7ed3\u679c\u503c SIN \u6c42\u6b63\u5f26\u503c ASIN \u6c42\u53cd\u6b63\u5f26\u503c\uff0c\u4e0e\u51fd\u6570 SIN \u4e92\u4e3a\u53cd\u51fd\u6570 COS \u6c42\u4f59\u5f26\u503c ACOS \u6c42\u53cd\u4f59\u5f26\u503c\uff0c\u4e0e\u51fd\u6570 COS \u4e92\u4e3a\u53cd\u51fd\u6570 TAN \u6c42\u6b63\u5207\u503c ATAN \u6c42\u53cd\u6b63\u5207\u503c\uff0c\u4e0e\u51fd\u6570 TAN \u4e92\u4e3a\u53cd\u51fd\u6570 COT \u6c42\u4f59\u5207\u503c \u5b57\u7b26\u4e32\u51fd\u6570 \u51fd\u6570\u540d\u79f0 \u4f5c \u7528 LENGTH \u8ba1\u7b97\u5b57\u7b26\u4e32\u957f\u5ea6\u51fd\u6570\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u5b57\u8282\u957f\u5ea6 CONCAT \u5408\u5e76\u5b57\u7b26\u4e32\u51fd\u6570\uff0c\u8fd4\u56de\u7ed3\u679c\u4e3a\u8fde\u63a5\u53c2\u6570\u4ea7\u751f\u7684\u5b57\u7b26\u4e32\uff0c\u53c2\u6570\u53ef\u4ee5\u4f7f\u4e00\u4e2a\u6216\u591a\u4e2a INSERT \u66ff\u6362\u5b57\u7b26\u4e32\u51fd\u6570 LOWER \u5c06\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5c0f\u5199 UPPER \u5c06\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5927\u5199 LEFT \u4ece\u5de6\u4fa7\u5b57\u622a\u53d6\u7b26\u4e32\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u5de6\u8fb9\u7684\u82e5\u5e72\u4e2a\u5b57\u7b26 RIGHT \u4ece\u53f3\u4fa7\u5b57\u622a\u53d6\u7b26\u4e32\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u53f3\u8fb9\u7684\u82e5\u5e72\u4e2a\u5b57\u7b26 TRIM \u5220\u9664\u5b57\u7b26\u4e32\u5de6\u53f3\u4e24\u4fa7\u7684\u7a7a\u683c REPLACE \u5b57\u7b26\u4e32\u66ff\u6362\u51fd\u6570\uff0c\u8fd4\u56de\u66ff\u6362\u540e\u7684\u65b0\u5b57\u7b26\u4e32 SUBSTRING \u622a\u53d6\u5b57\u7b26\u4e32\uff0c\u8fd4\u56de\u4ece\u6307\u5b9a\u4f4d\u7f6e\u5f00\u59cb\u7684\u6307\u5b9a\u957f\u5ea6\u7684\u5b57\u7b26\u6362 REVERSE \u5b57\u7b26\u4e32\u53cd\u8f6c\uff08\u9006\u5e8f\uff09\u51fd\u6570\uff0c\u8fd4\u56de\u4e0e\u539f\u59cb\u5b57\u7b26\u4e32\u987a\u5e8f\u76f8\u53cd\u7684\u5b57\u7b26\u4e32 \u65e5\u671f\u51fd\u6570 \u51fd\u6570\u540d\u79f0 \u4f5c \u7528 CURDATE \u548c CURRENT_DATE \u4e24\u4e2a\u51fd\u6570\u4f5c\u7528\u76f8\u540c\uff0c\u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u7684\u65e5\u671f\u503c CURTIME \u548c CURRENT_TIME \u4e24\u4e2a\u51fd\u6570\u4f5c\u7528\u76f8\u540c\uff0c\u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u7684\u65f6\u95f4\u503c NOW \u548c SYSDATE \u4e24\u4e2a\u51fd\u6570\u4f5c\u7528\u76f8\u540c\uff0c\u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u7684\u65e5\u671f\u548c\u65f6\u95f4\u503c MONTH \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u4e2d\u7684\u6708\u4efd MONTHNAME \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u4e2d\u7684\u6708\u4efd\u82f1\u6587\u540d\u79f0 DAYNAME \u83b7\u53d6\u6307\u5b9a\u66f0\u671f\u5bf9\u5e94\u7684\u661f\u671f\u51e0\u7684\u82f1\u6587\u540d\u79f0 DAYOFWEEK \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u5bf9\u5e94\u7684\u4e00\u5468\u7684\u7d22\u5f15\u4f4d\u7f6e\u503c WEEK \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u662f\u4e00\u5e74\u4e2d\u7684\u7b2c\u51e0\u5468\uff0c\u8fd4\u56de\u503c\u7684\u8303\u56f4\u662f\u5426\u4e3a 0\u301c52 \u6216 1\u301c53 DAYOFYEAR \u83b7\u53d6\u6307\u5b9a\u66f0\u671f\u662f\u4e00\u5e74\u4e2d\u7684\u7b2c\u51e0\u5929\uff0c\u8fd4\u56de\u503c\u8303\u56f4\u662f1~366 DAYOFMONTH \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u662f\u4e00\u4e2a\u6708\u4e2d\u662f\u7b2c\u51e0\u5929\uff0c\u8fd4\u56de\u503c\u8303\u56f4\u662f1~31 YEAR \u83b7\u53d6\u5e74\u4efd\uff0c\u8fd4\u56de\u503c\u8303\u56f4\u662f 1970\u301c2069 TIME_TO_SEC \u5c06\u65f6\u95f4\u53c2\u6570\u8f6c\u6362\u4e3a\u79d2\u6570 SEC_TO_TIME \u5c06\u79d2\u6570\u8f6c\u6362\u4e3a\u65f6\u95f4\uff0c\u4e0eTIME_TO_SEC \u4e92\u4e3a\u53cd\u51fd\u6570 DATE_ADD \u548c ADDDATE \u4e24\u4e2a\u51fd\u6570\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u5411\u65e5\u671f\u6dfb\u52a0\u6307\u5b9a\u7684\u65f6\u95f4\u95f4\u9694 DATE_SUB \u548c SUBDATE \u4e24\u4e2a\u51fd\u6570\u529f\u80fd\u76f8\u540c\uff0c\u90fd\u662f\u5411\u65e5\u671f\u51cf\u53bb\u6307\u5b9a\u7684\u65f6\u95f4\u95f4\u9694 ADDTIME \u65f6\u95f4\u52a0\u6cd5\u8fd0\u7b97\uff0c\u5728\u539f\u59cb\u65f6\u95f4\u4e0a\u6dfb\u52a0\u6307\u5b9a\u7684\u65f6\u95f4 SUBTIME \u65f6\u95f4\u51cf\u6cd5\u8fd0\u7b97\uff0c\u5728\u539f\u59cb\u65f6\u95f4\u4e0a\u51cf\u53bb\u6307\u5b9a\u7684\u65f6\u95f4 DATEDIFF \u83b7\u53d6\u4e24\u4e2a\u65e5\u671f\u4e4b\u95f4\u95f4\u9694\uff0c\u8fd4\u56de\u53c2\u6570 1 \u51cf\u53bb\u53c2\u6570 2 \u7684\u503c DATE_FORMAT \u683c\u5f0f\u5316\u6307\u5b9a\u7684\u65e5\u671f\uff0c\u6839\u636e\u53c2\u6570\u8fd4\u56de\u6307\u5b9a\u683c\u5f0f\u7684\u503c WEEKDAY \u83b7\u53d6\u6307\u5b9a\u65e5\u671f\u5728\u4e00\u5468\u5185\u7684\u5bf9\u5e94\u7684\u5de5\u4f5c\u65e5\u7d22\u5f15 \u805a\u5408\u51fd\u6570 \u51fd\u6570\u540d\u79f0 \u4f5c\u7528 MAX \u67e5\u8be2\u6307\u5b9a\u5217\u7684\u6700\u5927\u503c MIN \u67e5\u8be2\u6307\u5b9a\u5217\u7684\u6700\u5c0f\u503c COUNT \u7edf\u8ba1\u67e5\u8be2\u7ed3\u679c\u7684\u884c\u6570 SUM \u6c42\u548c\uff0c\u8fd4\u56de\u6307\u5b9a\u5217\u7684\u603b\u548c AVG \u6c42\u5e73\u5747\u503c\uff0c\u8fd4\u56de\u6307\u5b9a\u5217\u6570\u636e\u7684\u5e73\u5747\u503c","title":"3. MySQL \u5e38\u7528\u51fd\u6570"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/","text":"\u4e00\u3001\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406 \u00b6 \u5176\u5b9e\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u6211\u4eec\u7684\u78c1\u76d8\u7ba1\u7406\u673a\u5236\u548cwindows\u4e0a\u7684\u5dee\u4e0d\u591a\uff0c\u7edd\u5927\u591a\u6570\u90fd\u662f\u4f7f\u7528MBR(Master Boot Recorder)\u90fd\u662f\u901a\u8fc7\u5148\u5bf9\u4e00\u4e2a\u786c\u76d8\u8fdb\u884c\u5206\u533a\uff0c\u7136\u540e\u518d\u5c06\u8be5\u5206\u533a\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\uff0c\u5728Linux\u7cfb\u7edf\u4e2d\u5982\u679c\u8981\u4f7f\u7528\u8be5\u5206\u533a\u5c31\u5c06\u5176\u6302\u8f7d\u4e0a\u53bb\u5373\u53ef\uff0cwindows\u7684\u8bdd\u5176\u5b9e\u5e95\u5c42\u4e5f\u5c31\u662f\u81ea\u52a8\u5c06\u6240\u6709\u7684\u5206\u533a\u6302\u8f7d\u597d\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u8be5\u5206\u533a\u8fdb\u884c\u4f7f\u7528\u4e86\u3002 \u4f46\u662f\u8fd9\u79cd\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u7ecf\u5e38\u4f1a\u5e26\u6765\u5f88\u591a\u7684\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4\u5f53\u6211\u4eec\u4f7f\u7528\u7684\u4e00\u4e2a\u5206\u533a\uff0c\u5176\u7a7a\u95f4\u5927\u5c0f\u5df2\u7ecf\u4e0d\u518d\u591f\u7528\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\u901a\u8fc7\u62c9\u4f38\u5206\u533a\u6765\u8fdb\u884c\u5206\u533a\u6269\u5145\uff0c\u5f53\u7136\u76ee\u524d\u4e5f\u6709\u5176\u4ed6\u7b2c\u4e09\u65b9\u7684\u78c1\u76d8\u7ba1\u7406\u8f6f\u4ef6\u53ef\u4ee5\u8fdb\u884c\u78c1\u76d8\u7684\u5206\u533a\u7a7a\u95f4\u5212\u5206\uff0c\u4f46\u662f\u8fd9\u6837\u4f1a\u7ed9\u6211\u4eec\u7684\u6587\u4ef6\u7cfb\u7edf\u9020\u6210\u5f88\u5927\u7684\u4f24\u5bb3\uff0c\u6709\u65f6\u4f1a\u5bfc\u81f4\u6587\u4ef6\u7cfb\u7edf\u5d29\u6e83\u7b49\u95ee\u9898\u3002\u5bf9\u4e8e\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u5982\u679c\u8bf4\u6211\u4eec\u78b0\u5230\u5f53\u5206\u533a\u5927\u5c0f\u4e0d\u8db3\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ea\u80fd\u901a\u8fc7\u589e\u52a0\u65b0\u7684\u786c\u76d8\uff0c\u7136\u540e\u5728\u65b0\u7684\u786c\u76d8\u4e0a\u521b\u5efa\u5206\u533a\uff0c\u5bf9\u5206\u533a\u8fdb\u884c\u683c\u5f0f\u5316\u4ee5\u540e\uff0c\u7136\u540e\u5c06\u4e4b\u524d\u5206\u533a\u7684\u6240\u6709\u4e1c\u897f\u90fd\u62f7\u8d1d\u5230\u65b0\u7684\u5206\u533a\u91cc\u9762\u624d\u884c\u3002 \u4f46\u662f\u65b0\u589e\u52a0\u7684\u786c\u76d8\u662f\u4f5c\u4e3a\u72ec\u7acb\u7684\u6587\u4ef6\u7cfb\u7edf\u5b58\u5728\u7684\uff0c\u539f\u6709\u7684\u6587\u4ef6\u7cfb\u7edf\u5e76\u6ca1\u6709\u5f97\u5230\u4efb\u4f55\u7684\u6269\u5145\uff0c\u4e0a\u5c42\u5e94\u7528\u53ea\u80fd\u8bbf\u95ee\u5230\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u3002 \u8fd9\u6837\u7684\u65b9\u5f0f\u5bf9\u4e2a\u4eba\u7684\u7535\u8111\u6765\u8bf4\u53ef\u80fd\u8fd8\u80fd\u63a5\u53d7\uff0c\u4f46\u662f\u5982\u679c\u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\u4e0b\u7684\u670d\u52a1\u5668\u6765\u8bf4\uff0c\u8fd9\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\u3002\u56e0\u4e3a\u5982\u679c\u8981\u628a\u4e00\u4e2a\u5206\u533a\u7684\u5185\u5bb9\u90fd\u62f7\u8d1d\u5230\u53e6\u4e00\u4e2a\u5206\u533a\u4e0a\u53bb\uff0c\u52bf\u5fc5\u8981\u9996\u5148\u5378\u8f7d\u6389\u4e4b\u524d\u7684\u90a3\u4e2a\u5206\u533a\uff0c\u7136\u540e\u5bf9\u6574\u4e2a\u5206\u533a\u8fdb\u884c\u62f7\u8d1d\uff0c\u5982\u679c\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7740\u4e00\u4e2a\u91cd\u8981\u7684\u670d\u52a1\uff0c\u6bd4\u5982\u8bf4WWW\u6216\u8005FTP\uff0c\u5176\u8981\u6c42\u662f 7*24 \u5c0f\u65f6\u8fd0\u884c\u6b63\u5e38\u7684\uff0c\u90a3\u4e48\u5378\u8f7d\u6389\u5206\u533a\u8fd9\u662f\u4e0d\u53ef\u60f3\u8c61\u7684\uff0c\u540c\u65f6\u5982\u679c\u8be5\u5206\u533a\u4fdd\u5b58\u7684\u5185\u5bb9\u975e\u5e38\u975e\u5e38\u7684\u591a\uff0c\u90a3\u4e48\u5728\u5bf9\u5206\u533a\u8fdb\u884c\u8f6c\u79fb\u65f6\u65f6\u95f4\u53ef\u80fd\u4f1a\u8017\u8d39\u5f88\u4e45\uff0c\u6240\u4ee5\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u4f1a\u53d7\u5230\u4f20\u7edf\u78c1\u76d8\u7ba1\u7406\u7684\u9650\u5236\uff0c\u56e0\u4e3a\u5176\u4e0d\u80fd\u591f\u8fdb\u884c\u52a8\u6001\u7684\u78c1\u76d8\u7ba1\u7406\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cLVM\u6280\u672f\u5c31\u8bde\u751f\u4e86\uff01\uff01\uff01 \u4e8c\u3001LVM\u7684\u78c1\u76d8\u7ba1\u7406 \u00b6 \u6b63\u662f\u56e0\u4e3a\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u4e0d\u80fd\u5bf9\u6211\u4eec\u7684\u78c1\u76d8\u7a7a\u95f4\u8fdb\u884c\u52a8\u6001\u7684\u7ba1\u7406\uff0c\u56e0\u6b64\u5c31\u8bde\u751f\u51fa\u4e86LVM\u8fd9\u4e2a\u6280\u672f\uff0c\u90a3\u4e48LVM\u5230\u5e95\u662f\u4ec0\u4e48\u5462\uff1f\u5b83\u53c8\u662f\u600e\u4e48\u5bf9\u78c1\u76d8\u8fdb\u884c\u7ba1\u7406\u7684\u5462\uff1f LVM(Logical volume Manager)\u662f\u903b\u8f91\u5377\u7ba1\u7406\u7684\u7b80\u79f0\u3002\u5b83\u662fLinux\u73af\u5883\u4e0b\u5bf9\u78c1\u76d8\u5206\u533a\u8fdb\u884c\u7ba1\u7406\u7684\u4e00\u79cd\u673a\u5236\u3002\u73b0\u5728\u4e0d\u4ec5\u4ec5\u662fLinux\u7cfb\u7edf\u4e0a\u53ef\u4ee5\u4f7f\u7528LVM\u8fd9\u79cd\u78c1\u76d8\u7ba1\u7406\u673a\u5236\uff0c\u5bf9\u4e8e\u5176\u5b83\u7684\u7c7bUNIX\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4ee5\u53cawindows\u64cd\u4f5c\u7cfb\u7edf\u90fd\u6709\u7c7b\u4f3c\u4e0eLVM\u8fd9\u79cd\u78c1\u76d8\u7ba1\u7406\u8f6f\u4ef6\u3002 LVM\u7684\u5de5\u4f5c\u539f\u7406\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5b83\u5c31\u662f\u901a\u8fc7\u5c06\u5e95\u5c42\u7684\u7269\u7406\u786c\u76d8\u62bd\u8c61\u7684\u5c01\u88c5\u8d77\u6765\uff0c\u7136\u540e\u4ee5\u903b\u8f91\u5377\u7684\u65b9\u5f0f\u5448\u73b0\u7ed9\u4e0a\u5c42\u5e94\u7528\u3002\u5728\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u673a\u5236\u4e2d\uff0c\u6211\u4eec\u7684\u4e0a\u5c42\u5e94\u7528\u662f\u76f4\u63a5\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf\uff0c\u4ece\u800c\u5bf9\u5e95\u5c42\u7684\u7269\u7406\u786c\u76d8\u8fdb\u884c\u8bfb\u53d6\uff0c\u800c\u5728LVM\u4e2d\uff0c\u5176\u901a\u8fc7\u5bf9\u5e95\u5c42\u7684\u786c\u76d8\u8fdb\u884c\u5c01\u88c5\uff0c\u5f53\u6211\u4eec\u5bf9\u5e95\u5c42\u7684\u7269\u7406\u786c\u76d8\u8fdb\u884c\u64cd\u4f5c\u65f6\uff0c\u5176\u4e0d\u518d\u662f\u9488\u5bf9\u4e8e\u5206\u533a\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u662f\u901a\u8fc7\u4e00\u4e2a\u53eb\u505a\u903b\u8f91\u5377\u7684\u4e1c\u897f\u6765\u5bf9\u5176\u8fdb\u884c\u5e95\u5c42\u7684\u78c1\u76d8\u7ba1\u7406\u64cd\u4f5c\u3002\u6bd4\u5982\u8bf4\u6211\u589e\u52a0\u4e00\u4e2a\u7269\u7406\u786c\u76d8\uff0c\u8fd9\u4e2a\u65f6\u5019\u4e0a\u5c42\u7684\u670d\u52a1\u662f\u611f\u89c9\u4e0d\u5230\u7684\uff0c\u56e0\u4e3a\u5448\u73b0\u7ed9\u4e0a\u6b21\u670d\u52a1\u7684\u662f\u4ee5\u903b\u8f91\u5377\u7684\u65b9\u5f0f\u3002 LVM\u6700\u5927\u7684\u7279\u70b9\u5c31\u662f\u53ef\u4ee5\u5bf9\u78c1\u76d8\u8fdb\u884c\u52a8\u6001\u7ba1\u7406\u3002\u56e0\u4e3a\u903b\u8f91\u5377\u7684\u5927\u5c0f\u662f\u53ef\u4ee5\u52a8\u6001\u8c03\u6574\u7684\uff0c\u800c\u4e14\u4e0d\u4f1a\u4e22\u5931\u73b0\u6709\u7684\u6570\u636e\u3002\u6211\u4eec\u5982\u679c\u65b0\u589e\u52a0\u4e86\u786c\u76d8\uff0c\u5176\u4e5f\u4e0d\u4f1a\u6539\u53d8\u73b0\u6709\u4e0a\u5c42\u7684\u903b\u8f91\u5377\u3002\u4f5c\u4e3a\u4e00\u4e2a\u52a8\u6001\u78c1\u76d8\u7ba1\u7406\u673a\u5236\uff0c\u903b\u8f91\u5377\u6280\u672f\u5927\u5927\u63d0\u9ad8\u4e86\u78c1\u76d8\u7ba1\u7406\u7684\u7075\u6d3b\u6027\uff01\uff01\uff01 \u4e09\u3001LVM\u7684\u539f\u7406 \u00b6 \u8981\u60f3\u7406\u89e3\u597dLVM\u7684\u539f\u7406\uff0c\u6211\u4eec\u5fc5\u987b\u9996\u5148\u8981\u638c\u63e14\u4e2a\u57fa\u672c\u7684\u903b\u8f91\u5377\u6982\u5ff5\u3002 \u2460PE (Physical Extend) \u7269\u7406\u62d3\u5c55 \u2461PV (Physical Volume) \u7269\u7406\u5377 \u2462VG (Volume Group) \u5377\u7ec4 \u2463LV (Logical Volume) \u903b\u8f91\u5377 \u6211\u4eec\u77e5\u9053\u5728\u4f7f\u7528LVM\u5bf9\u78c1\u76d8\u8fdb\u884c\u52a8\u6001\u7ba1\u7406\u4ee5\u540e\uff0c\u6211\u4eec\u662f\u4ee5\u903b\u8f91\u5377\u7684\u65b9\u5f0f\u5448\u73b0\u7ed9\u4e0a\u5c42\u7684\u670d\u52a1\u7684\u3002\u6240\u4ee5\u6211\u4eec\u6240\u6709\u7684\u64cd\u4f5c\u76ee\u7684\uff0c\u5176\u5b9e\u5c31\u662f\u53bb\u521b\u5efa\u4e00\u4e2aLV(Logical Volume),\u903b\u8f91\u5377\u5c31\u662f\u7528\u6765\u53d6\u4ee3\u6211\u4eec\u4e4b\u524d\u7684\u5206\u533a\uff0c\u6211\u4eec\u901a\u8fc7\u5bf9\u903b\u8f91\u5377\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u7136\u540e\u8fdb\u884c\u6302\u8f7d\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002\u90a3\u4e48LVM\u7684\u5de5\u4f5c\u539f\u7406\u662f\u4ec0\u4e48\u5462\uff1f\u6240\u8c13\u65e0\u56fe\u65e0\u771f\u76f8\uff0c\u54b1\u4eec\u4e0b\u9762\u901a\u8fc7\u56fe\u6765\u5bf9\u903b\u8f91\u5377\u7684\u539f\u7406\u8fdb\u884c\u89e3\u91ca\uff01\uff01 1.\u5c06\u6211\u4eec\u7684\u7269\u7406\u786c\u76d8\u683c\u5f0f\u5316\u6210PV(Physical Volume) \u00b6 \u6211\u4eec\u770b\u5230\uff0c\u8fd9\u91cc\u6709\u4e24\u5757\u786c\u76d8\uff0c\u4e00\u5757\u662fsda\uff0c\u53e6\u4e00\u5757\u662fsdb\uff0c\u5728LVM\u78c1\u76d8\u7ba1\u7406\u91cc\uff0c\u6211\u9996\u5148\u8981\u5c06\u8fd9\u4e24\u5757\u786c\u76d8\u683c\u5f0f\u5316\u4e3a\u6211\u4eec\u7684PV(Physical Volume),\u4e5f\u5c31\u662f\u6211\u4eec\u7684\u7269\u7406\u5377\uff0c\u5176\u5b9e\u683c\u5f0f\u5316\u7269\u7406\u5377\u7684\u8fc7\u7a0b\u4e2dLVM\u662f\u5c06\u5e95\u5c42\u7684\u786c\u76d8\u5212\u5206\u4e3a\u4e86\u4e00\u4e2a\u4e00\u4e2a\u7684PE(Physical Extend), \u6211\u4eec\u7684LVM\u78c1\u76d8\u7ba1\u7406\u4e2dPE\u7684\u9ed8\u8ba4\u5927\u5c0f\u662f4M\u5927\u5c0f \uff0c\u5176\u5b9ePE\u5c31\u662f\u6211\u4eec\u903b\u8f91\u5377\u7ba1\u7406\u7684\u6700\u57fa\u672c\u5355\u4f4d\u3002\u6bd4\u5982\u8bf4\u6211\u6709\u4e00\u4e2a400M\u7684\u786c\u76d8\uff0c\u90a3\u4e48\u5728\u5c06\u5176\u683c\u5f0f\u5316\u6210PV\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u9645\u5c31\u662f\u5c06\u8fd9\u5757\u7269\u7406\u786c\u76d8\u5212\u5206\u6210\u4e86100\u4e2a\u7684PE\uff0c\u56e0\u4e3aPE\u9ed8\u8ba4\u7684\u5927\u5c0f\u5c31\u662f4M\u3002\u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u7684\u7b2c\u4e00\u6b65\u64cd\u4f5c\u3002 2.\u521b\u5efa\u4e00\u4e2aVG(Volume Group) \u00b6 \u5728\u5c06\u786c\u76d8\u683c\u5f0f\u5316\u6210PV\u4ee5\u540e\uff0c\u6211\u4eec\u7b2c\u4e8c\u6b65\u64cd\u4f5c\u5c31\u662f\u521b\u5efa\u4e00\u4e2a\u5377\u7ec4\uff0c\u4e5f\u5c31\u662fVG(Volume Group),\u5377\u7ec4\u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u62bd\u8c61\u5316\u6210\u4e00\u4e2a\u7a7a\u95f4\u6c60\uff0cVG\u7684\u4f5c\u7528\u5c31\u662f\u7528\u6765\u88c5PE\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u4e2a\u6216\u8005\u591a\u4e2aPV\u52a0\u5230VG\u5f53\u4e2d\uff0c\u56e0\u4e3a\u5728\u7b2c\u4e00\u6b65\u64cd\u4f5c\u65f6\u5c31\u5df2\u7ecf\u5c06\u8be5\u786c\u76d8\u5212\u5206\u6210\u4e86\u591a\u4e2aPE\uff0c\u6240\u4ee5\u5c06\u591a\u4e2aPV\u52a0\u5230VG\u91cc\u9762\u540e\uff0cVG\u91cc\u9762\u5c31\u5b58\u653e\u4e86\u8bb8\u8bb8\u591a\u591a\u6765\u81ea\u4e0d\u540cPV\u4e2d\u7684PE\uff0c\u6211\u4eec\u901a\u8fc7\u4e0a\u9762\u7684\u56fe\u7247\u5c31\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u683c\u5f0f\u5316\u4e86\u4e24\u5757\u786c\u76d8\uff0c\u6bcf\u4e2a\u786c\u76d8\u5206\u522b\u683c\u5f0f\u5316\u6210\u4e863\u4e2aPE\uff0c\u7136\u540e\u5c06\u4e24\u5757\u786c\u76d8\u7684PE\u90fd\u52a0\u5230\u4e86\u6211\u4eec\u7684VG\u5f53\u4e2d\uff0c\u90a3\u4e48\u6211\u4eec\u7684VG\u5f53\u4e2d\u5c31\u5305\u542b\u4e866\u4e2aPE\uff0c\u8fd96\u4e2aPE\u5c31\u662f\u4e24\u4e2a\u786c\u76d8\u7684PE\u4e4b\u548c\u3002\u901a\u5e38\u521b\u5efa\u4e00\u4e2a\u5377\u7ec4\u7684\u65f6\u5019\u6211\u4eec\u4f1a\u4e3a\u5176\u53d6\u4e00\u4e2a\u540d\u5b57\uff0c\u4e5f\u5c31\u662f\u8be5VG\u7684\u540d\u5b57\u3002 3.\u57fa\u4e8eVG\u521b\u5efa\u6211\u4eec\u6700\u540e\u8981\u4f7f\u7528\u7684LV(Logical Volume) \u00b6 \u3010\u6ce8\u610f\u3011PV\u4ee5\u53caVG\u521b\u5efa\u597d\u4ee5\u540e\u6211\u4eec\u662f\u4e0d\u80fd\u591f\u76f4\u63a5\u4f7f\u7528\u7684\uff0c\u56e0\u4e3aPV\u3001VG\u662f\u6211\u4eec\u903b\u8f91\u5377\u5e95\u5c42\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u5176\u5b9e\u6700\u540e\u4f7f\u7528\u7684\u662f\u5728VG\u57fa\u7840\u4e0a\u521b\u5efa\u7684LV(Logical Volume),\u6240\u4ee5\u7b2c\u4e09\u6b65\u64cd\u4f5c\u5c31\u662f\u57fa\u4e8eVG\u6765\u521b\u5efa\u6211\u4eec\u6700\u7ec8\u8981\u4f7f\u7528\u7684LV\u3002 \u5f53\u6211\u4eec\u521b\u5efa\u597d\u6211\u4eec\u7684VG\u4ee5\u540e\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u521b\u5efaLV\u5176\u5b9e\u5c31\u662f\u4eceVG\u4e2d\u62ff\u51fa\u6211\u4eec\u6307\u5b9a\u6570\u91cf\u7684PE\uff0c\u8fd8\u662f\u62ff\u4e0a\u56fe\u6765\u8bf4\uff0c\u6211\u4eec\u770b\u5230\u6211\u4eec\u6b64\u65f6\u7684VG\u91cc\u9762\u5df2\u7ecf\u62e5\u6709\u4e866\u4e2aPE\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u521b\u5efa\u4e86\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u903b\u8f91\u5377\uff0c\u5b83\u7684\u5927\u5c0f\u662f4\u4e2aPE\u7684\u5927\u5c0f\uff0c\u4e5f\u5c31\u662f16M( \u56e0\u4e3a\u4e00\u4e2aPE\u7684\u9ed8\u8ba4\u5927\u5c0f\u662f4M )\uff0c\u800c\u8fd94\u4e2aPE\u6709\u4e09\u4e2a\u662f\u6765\u81ea\u4e8e\u7b2c\u4e00\u5757\u786c\u76d8\uff0c\u800c\u53e6\u5916\u4e00\u4e2aPE\u5219\u662f\u6765\u81ea\u7b2c\u4e8c\u5757\u786c\u76d8\u3002\u5f53\u6211\u4eec\u521b\u5efa\u7b2c\u4e8c\u4e2a\u903b\u8f91\u5377\u65f6\uff0c\u5b83\u7684\u5927\u5c0f\u5c31\u6700\u591a\u53ea\u6709\u4e24\u4e2aPE\u7684\u5927\u5c0f\u4e86\uff0c\u56e0\u4e3a\u5176\u4e2d\u76844\u4e2aPE\u5df2\u7ecf\u5206\u914d\u7ed9\u4e86\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u903b\u8f91\u5377\u3002 \u6240\u4ee5\u521b\u5efa\u903b\u8f91\u5377\u5176\u5b9e\u5c31\u662f\u6211\u4eec\u4eceVG\u4e2d\u62ff\u51fa\u6211\u4eec\u6307\u5b9a\u6570\u91cf\u7684PE\uff0cVG\u4e2d\u7684PE\u53ef\u4ee5\u6765\u81ea\u4e0d\u540c\u7684PV\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u7684\u903b\u8f91\u5377\u7684\u5927\u5c0f\u53d6\u51b3\u4e8eVG\u5f53\u4e2dPE\u5b58\u5728\u7684\u6570\u91cf\uff0c\u5e76\u4e14\u6211\u4eec\u521b\u5efa\u7684\u903b\u8f91\u5377\u5176\u5927\u5c0f\u4e00\u5b9a\u662fPE\u7684\u6574\u6570\u500d(\u5373\u903b\u8f91\u5377\u7684\u5927\u5c0f\u4e00\u5b9a\u8981\u662f4M\u7684\u6574\u6570\u500d)\u3002 4.\u5c06\u6211\u4eec\u521b\u5efa\u597d\u7684LV\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\uff0c\u7136\u540e\u6302\u8f7d\u4f7f\u7528 \u00b6 \u5728\u521b\u5efa\u597dLV\u4ee5\u540e\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u80fd\u591f\u5bf9\u5176\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\u4e86\uff0c\u6211\u4eec\u6700\u7ec8\u4f7f\u7528\u7684\u5c31\u662f\u6211\u4eec\u521a\u521b\u5efa\u597d\u7684LV\uff0c\u5176\u5c31\u76f8\u5f53\u4e8e\u4f20\u7edf\u7684\u6587\u4ef6\u7ba1\u7406\u7684\u5206\u533a\uff0c\u6211\u4eec\u9996\u5148\u8981\u5bf9\u5176\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\u64cd\u4f5c\uff0c\u7136\u540e\u901a\u8fc7mount\u547d\u4ee4\u5bf9\u5176\u8fdb\u884c\u6302\u8f7d\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u80fd\u591f\u50cf\u4f7f\u7528\u5e73\u5e38\u7684\u5206\u533a\u4e00\u6837\u6765\u4f7f\u7528\u6211\u4eec\u7684\u903b\u8f91\u5377\u4e86\u3002 \u6211\u4eec\u5728\u521b\u5efa\u597dLV\u4ee5\u540e\uff0c\u6211\u4eec\u4f1a\u5728 /dev \u76ee\u5f55\u4e0b\u770b\u5230\u6211\u4eec\u7684LV\u4fe1\u606f\uff0c\u4f8b\u5982 /dev/vgname/lvname \uff0c \u6211\u4eec\u6bcf\u521b\u5efa\u4e00\u4e2aVG\uff0c\u5176\u4f1a\u5728 /dev \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u4ee5\u8be5VG\u540d\u5b57\u547d\u540d\u7684\u6587\u4ef6\u5939\uff0c\u5728\u8be5VG\u7684\u57fa\u7840\u4e0a\u521b\u5efa\u597dLV\u4ee5\u540e\uff0c\u6211\u4eec\u4f1a\u5728\u8fd9\u4e2aVG\u76ee\u5f55\u4e0b\u591a\u51fa\u4e00\u4e2a\u4ee5LV\u540d\u5b57\u547d\u540d\u7684\u903b\u8f91\u5377\u3002 \u4e0b\u9762\u6211\u4eec\u6765\u5bf9\u6574\u4e2aLVM\u7684\u5de5\u4f5c\u539f\u7406\u8fdb\u884c\u4e00\u4e2a\u603b\u7ed3\uff1a (1)\u7269\u7406\u78c1\u76d8\u88ab\u683c\u5f0f\u5316\u4e3aPV\uff0c\u7a7a\u95f4\u88ab\u5212\u5206\u4e3a\u4e00\u4e2a\u4e2a\u7684PE (2)\u4e0d\u540c\u7684PV\u52a0\u5165\u5230\u540c\u4e00\u4e2aVG\u4e2d\uff0c\u4e0d\u540cPV\u7684PE\u5168\u90e8\u8fdb\u5165\u5230\u4e86VG\u7684PE\u6c60\u5185 (3)LV\u57fa\u4e8ePE\u521b\u5efa\uff0c\u5927\u5c0f\u4e3aPE\u7684\u6574\u6570\u500d\uff0c\u7ec4\u6210LV\u7684PE\u53ef\u80fd\u6765\u81ea\u4e0d\u540c\u7684\u7269\u7406\u78c1\u76d8 (4)LV\u73b0\u5728\u5c31\u76f4\u63a5\u53ef\u4ee5\u683c\u5f0f\u5316\u540e\u6302\u8f7d\u4f7f\u7528\u4e86 (5)LV\u7684\u6269\u5145\u7f29\u51cf\u5b9e\u9645\u4e0a\u5c31\u662f\u589e\u52a0\u6216\u51cf\u5c11\u7ec4\u6210\u8be5LV\u7684PE\u6570\u91cf\uff0c\u5176\u8fc7\u7a0b\u4e0d\u4f1a\u4e22\u5931\u539f\u59cb\u6570\u636e \u6211\u4eec\u770b\u5230\uff0c\u6211\u4eec\u8fd9\u91cc\u5982\u679c\u8981\u5bf9LV\u8fdb\u884c\u6269\u5145\uff0c\u76f4\u63a5\u52a0\u8fdb\u6765\u4e00\u5757sdc\u786c\u76d8\uff0c\u7136\u540e\u5c06\u5176\u683c\u5f0f\u5316\u6210PE\uff0c\u7136\u540e\u5c06\u8be5PV\u52a0\u5165\u5230\u4e86VG\u5f53\u4e2d\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0LV\u4e2dPE\u7684\u6570\u91cf\u6765\u52a8\u6001\u7684\u5bf9LV\u8fdb\u884c\u6269\u5145\u4e86\uff0c\u53ea\u8981\u6211\u4eec\u7684LV\u7684\u5927\u5c0f\u4e0d\u8981\u8d85\u8fc7\u6211\u4eecVG\u7a7a\u4f59\u7a7a\u95f4\u7684\u5927\u5c0f\u5c31\u884c\u4e86\uff01\uff01","title":"LVM\u903b\u8f91\u5377\u57fa\u672c\u6982\u5ff5\u53caLVM\u7684\u5de5\u4f5c\u539f\u7406"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#_1","text":"\u5176\u5b9e\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u6211\u4eec\u7684\u78c1\u76d8\u7ba1\u7406\u673a\u5236\u548cwindows\u4e0a\u7684\u5dee\u4e0d\u591a\uff0c\u7edd\u5927\u591a\u6570\u90fd\u662f\u4f7f\u7528MBR(Master Boot Recorder)\u90fd\u662f\u901a\u8fc7\u5148\u5bf9\u4e00\u4e2a\u786c\u76d8\u8fdb\u884c\u5206\u533a\uff0c\u7136\u540e\u518d\u5c06\u8be5\u5206\u533a\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\uff0c\u5728Linux\u7cfb\u7edf\u4e2d\u5982\u679c\u8981\u4f7f\u7528\u8be5\u5206\u533a\u5c31\u5c06\u5176\u6302\u8f7d\u4e0a\u53bb\u5373\u53ef\uff0cwindows\u7684\u8bdd\u5176\u5b9e\u5e95\u5c42\u4e5f\u5c31\u662f\u81ea\u52a8\u5c06\u6240\u6709\u7684\u5206\u533a\u6302\u8f7d\u597d\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u8be5\u5206\u533a\u8fdb\u884c\u4f7f\u7528\u4e86\u3002 \u4f46\u662f\u8fd9\u79cd\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u7ecf\u5e38\u4f1a\u5e26\u6765\u5f88\u591a\u7684\u95ee\u9898\uff0c\u6bd4\u5982\u8bf4\u5f53\u6211\u4eec\u4f7f\u7528\u7684\u4e00\u4e2a\u5206\u533a\uff0c\u5176\u7a7a\u95f4\u5927\u5c0f\u5df2\u7ecf\u4e0d\u518d\u591f\u7528\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\u901a\u8fc7\u62c9\u4f38\u5206\u533a\u6765\u8fdb\u884c\u5206\u533a\u6269\u5145\uff0c\u5f53\u7136\u76ee\u524d\u4e5f\u6709\u5176\u4ed6\u7b2c\u4e09\u65b9\u7684\u78c1\u76d8\u7ba1\u7406\u8f6f\u4ef6\u53ef\u4ee5\u8fdb\u884c\u78c1\u76d8\u7684\u5206\u533a\u7a7a\u95f4\u5212\u5206\uff0c\u4f46\u662f\u8fd9\u6837\u4f1a\u7ed9\u6211\u4eec\u7684\u6587\u4ef6\u7cfb\u7edf\u9020\u6210\u5f88\u5927\u7684\u4f24\u5bb3\uff0c\u6709\u65f6\u4f1a\u5bfc\u81f4\u6587\u4ef6\u7cfb\u7edf\u5d29\u6e83\u7b49\u95ee\u9898\u3002\u5bf9\u4e8e\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u5982\u679c\u8bf4\u6211\u4eec\u78b0\u5230\u5f53\u5206\u533a\u5927\u5c0f\u4e0d\u8db3\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ea\u80fd\u901a\u8fc7\u589e\u52a0\u65b0\u7684\u786c\u76d8\uff0c\u7136\u540e\u5728\u65b0\u7684\u786c\u76d8\u4e0a\u521b\u5efa\u5206\u533a\uff0c\u5bf9\u5206\u533a\u8fdb\u884c\u683c\u5f0f\u5316\u4ee5\u540e\uff0c\u7136\u540e\u5c06\u4e4b\u524d\u5206\u533a\u7684\u6240\u6709\u4e1c\u897f\u90fd\u62f7\u8d1d\u5230\u65b0\u7684\u5206\u533a\u91cc\u9762\u624d\u884c\u3002 \u4f46\u662f\u65b0\u589e\u52a0\u7684\u786c\u76d8\u662f\u4f5c\u4e3a\u72ec\u7acb\u7684\u6587\u4ef6\u7cfb\u7edf\u5b58\u5728\u7684\uff0c\u539f\u6709\u7684\u6587\u4ef6\u7cfb\u7edf\u5e76\u6ca1\u6709\u5f97\u5230\u4efb\u4f55\u7684\u6269\u5145\uff0c\u4e0a\u5c42\u5e94\u7528\u53ea\u80fd\u8bbf\u95ee\u5230\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u3002 \u8fd9\u6837\u7684\u65b9\u5f0f\u5bf9\u4e2a\u4eba\u7684\u7535\u8111\u6765\u8bf4\u53ef\u80fd\u8fd8\u80fd\u63a5\u53d7\uff0c\u4f46\u662f\u5982\u679c\u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\u4e0b\u7684\u670d\u52a1\u5668\u6765\u8bf4\uff0c\u8fd9\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\u3002\u56e0\u4e3a\u5982\u679c\u8981\u628a\u4e00\u4e2a\u5206\u533a\u7684\u5185\u5bb9\u90fd\u62f7\u8d1d\u5230\u53e6\u4e00\u4e2a\u5206\u533a\u4e0a\u53bb\uff0c\u52bf\u5fc5\u8981\u9996\u5148\u5378\u8f7d\u6389\u4e4b\u524d\u7684\u90a3\u4e2a\u5206\u533a\uff0c\u7136\u540e\u5bf9\u6574\u4e2a\u5206\u533a\u8fdb\u884c\u62f7\u8d1d\uff0c\u5982\u679c\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7740\u4e00\u4e2a\u91cd\u8981\u7684\u670d\u52a1\uff0c\u6bd4\u5982\u8bf4WWW\u6216\u8005FTP\uff0c\u5176\u8981\u6c42\u662f 7*24 \u5c0f\u65f6\u8fd0\u884c\u6b63\u5e38\u7684\uff0c\u90a3\u4e48\u5378\u8f7d\u6389\u5206\u533a\u8fd9\u662f\u4e0d\u53ef\u60f3\u8c61\u7684\uff0c\u540c\u65f6\u5982\u679c\u8be5\u5206\u533a\u4fdd\u5b58\u7684\u5185\u5bb9\u975e\u5e38\u975e\u5e38\u7684\u591a\uff0c\u90a3\u4e48\u5728\u5bf9\u5206\u533a\u8fdb\u884c\u8f6c\u79fb\u65f6\u65f6\u95f4\u53ef\u80fd\u4f1a\u8017\u8d39\u5f88\u4e45\uff0c\u6240\u4ee5\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u4f1a\u53d7\u5230\u4f20\u7edf\u78c1\u76d8\u7ba1\u7406\u7684\u9650\u5236\uff0c\u56e0\u4e3a\u5176\u4e0d\u80fd\u591f\u8fdb\u884c\u52a8\u6001\u7684\u78c1\u76d8\u7ba1\u7406\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cLVM\u6280\u672f\u5c31\u8bde\u751f\u4e86\uff01\uff01\uff01","title":"\u4e00\u3001\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#lvm","text":"\u6b63\u662f\u56e0\u4e3a\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u4e0d\u80fd\u5bf9\u6211\u4eec\u7684\u78c1\u76d8\u7a7a\u95f4\u8fdb\u884c\u52a8\u6001\u7684\u7ba1\u7406\uff0c\u56e0\u6b64\u5c31\u8bde\u751f\u51fa\u4e86LVM\u8fd9\u4e2a\u6280\u672f\uff0c\u90a3\u4e48LVM\u5230\u5e95\u662f\u4ec0\u4e48\u5462\uff1f\u5b83\u53c8\u662f\u600e\u4e48\u5bf9\u78c1\u76d8\u8fdb\u884c\u7ba1\u7406\u7684\u5462\uff1f LVM(Logical volume Manager)\u662f\u903b\u8f91\u5377\u7ba1\u7406\u7684\u7b80\u79f0\u3002\u5b83\u662fLinux\u73af\u5883\u4e0b\u5bf9\u78c1\u76d8\u5206\u533a\u8fdb\u884c\u7ba1\u7406\u7684\u4e00\u79cd\u673a\u5236\u3002\u73b0\u5728\u4e0d\u4ec5\u4ec5\u662fLinux\u7cfb\u7edf\u4e0a\u53ef\u4ee5\u4f7f\u7528LVM\u8fd9\u79cd\u78c1\u76d8\u7ba1\u7406\u673a\u5236\uff0c\u5bf9\u4e8e\u5176\u5b83\u7684\u7c7bUNIX\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4ee5\u53cawindows\u64cd\u4f5c\u7cfb\u7edf\u90fd\u6709\u7c7b\u4f3c\u4e0eLVM\u8fd9\u79cd\u78c1\u76d8\u7ba1\u7406\u8f6f\u4ef6\u3002 LVM\u7684\u5de5\u4f5c\u539f\u7406\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5b83\u5c31\u662f\u901a\u8fc7\u5c06\u5e95\u5c42\u7684\u7269\u7406\u786c\u76d8\u62bd\u8c61\u7684\u5c01\u88c5\u8d77\u6765\uff0c\u7136\u540e\u4ee5\u903b\u8f91\u5377\u7684\u65b9\u5f0f\u5448\u73b0\u7ed9\u4e0a\u5c42\u5e94\u7528\u3002\u5728\u4f20\u7edf\u7684\u78c1\u76d8\u7ba1\u7406\u673a\u5236\u4e2d\uff0c\u6211\u4eec\u7684\u4e0a\u5c42\u5e94\u7528\u662f\u76f4\u63a5\u8bbf\u95ee\u6587\u4ef6\u7cfb\u7edf\uff0c\u4ece\u800c\u5bf9\u5e95\u5c42\u7684\u7269\u7406\u786c\u76d8\u8fdb\u884c\u8bfb\u53d6\uff0c\u800c\u5728LVM\u4e2d\uff0c\u5176\u901a\u8fc7\u5bf9\u5e95\u5c42\u7684\u786c\u76d8\u8fdb\u884c\u5c01\u88c5\uff0c\u5f53\u6211\u4eec\u5bf9\u5e95\u5c42\u7684\u7269\u7406\u786c\u76d8\u8fdb\u884c\u64cd\u4f5c\u65f6\uff0c\u5176\u4e0d\u518d\u662f\u9488\u5bf9\u4e8e\u5206\u533a\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u662f\u901a\u8fc7\u4e00\u4e2a\u53eb\u505a\u903b\u8f91\u5377\u7684\u4e1c\u897f\u6765\u5bf9\u5176\u8fdb\u884c\u5e95\u5c42\u7684\u78c1\u76d8\u7ba1\u7406\u64cd\u4f5c\u3002\u6bd4\u5982\u8bf4\u6211\u589e\u52a0\u4e00\u4e2a\u7269\u7406\u786c\u76d8\uff0c\u8fd9\u4e2a\u65f6\u5019\u4e0a\u5c42\u7684\u670d\u52a1\u662f\u611f\u89c9\u4e0d\u5230\u7684\uff0c\u56e0\u4e3a\u5448\u73b0\u7ed9\u4e0a\u6b21\u670d\u52a1\u7684\u662f\u4ee5\u903b\u8f91\u5377\u7684\u65b9\u5f0f\u3002 LVM\u6700\u5927\u7684\u7279\u70b9\u5c31\u662f\u53ef\u4ee5\u5bf9\u78c1\u76d8\u8fdb\u884c\u52a8\u6001\u7ba1\u7406\u3002\u56e0\u4e3a\u903b\u8f91\u5377\u7684\u5927\u5c0f\u662f\u53ef\u4ee5\u52a8\u6001\u8c03\u6574\u7684\uff0c\u800c\u4e14\u4e0d\u4f1a\u4e22\u5931\u73b0\u6709\u7684\u6570\u636e\u3002\u6211\u4eec\u5982\u679c\u65b0\u589e\u52a0\u4e86\u786c\u76d8\uff0c\u5176\u4e5f\u4e0d\u4f1a\u6539\u53d8\u73b0\u6709\u4e0a\u5c42\u7684\u903b\u8f91\u5377\u3002\u4f5c\u4e3a\u4e00\u4e2a\u52a8\u6001\u78c1\u76d8\u7ba1\u7406\u673a\u5236\uff0c\u903b\u8f91\u5377\u6280\u672f\u5927\u5927\u63d0\u9ad8\u4e86\u78c1\u76d8\u7ba1\u7406\u7684\u7075\u6d3b\u6027\uff01\uff01\uff01","title":"\u4e8c\u3001LVM\u7684\u78c1\u76d8\u7ba1\u7406"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#lvm_1","text":"\u8981\u60f3\u7406\u89e3\u597dLVM\u7684\u539f\u7406\uff0c\u6211\u4eec\u5fc5\u987b\u9996\u5148\u8981\u638c\u63e14\u4e2a\u57fa\u672c\u7684\u903b\u8f91\u5377\u6982\u5ff5\u3002 \u2460PE (Physical Extend) \u7269\u7406\u62d3\u5c55 \u2461PV (Physical Volume) \u7269\u7406\u5377 \u2462VG (Volume Group) \u5377\u7ec4 \u2463LV (Logical Volume) \u903b\u8f91\u5377 \u6211\u4eec\u77e5\u9053\u5728\u4f7f\u7528LVM\u5bf9\u78c1\u76d8\u8fdb\u884c\u52a8\u6001\u7ba1\u7406\u4ee5\u540e\uff0c\u6211\u4eec\u662f\u4ee5\u903b\u8f91\u5377\u7684\u65b9\u5f0f\u5448\u73b0\u7ed9\u4e0a\u5c42\u7684\u670d\u52a1\u7684\u3002\u6240\u4ee5\u6211\u4eec\u6240\u6709\u7684\u64cd\u4f5c\u76ee\u7684\uff0c\u5176\u5b9e\u5c31\u662f\u53bb\u521b\u5efa\u4e00\u4e2aLV(Logical Volume),\u903b\u8f91\u5377\u5c31\u662f\u7528\u6765\u53d6\u4ee3\u6211\u4eec\u4e4b\u524d\u7684\u5206\u533a\uff0c\u6211\u4eec\u901a\u8fc7\u5bf9\u903b\u8f91\u5377\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u7136\u540e\u8fdb\u884c\u6302\u8f7d\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002\u90a3\u4e48LVM\u7684\u5de5\u4f5c\u539f\u7406\u662f\u4ec0\u4e48\u5462\uff1f\u6240\u8c13\u65e0\u56fe\u65e0\u771f\u76f8\uff0c\u54b1\u4eec\u4e0b\u9762\u901a\u8fc7\u56fe\u6765\u5bf9\u903b\u8f91\u5377\u7684\u539f\u7406\u8fdb\u884c\u89e3\u91ca\uff01\uff01","title":"\u4e09\u3001LVM\u7684\u539f\u7406"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#1pvphysical-volume","text":"\u6211\u4eec\u770b\u5230\uff0c\u8fd9\u91cc\u6709\u4e24\u5757\u786c\u76d8\uff0c\u4e00\u5757\u662fsda\uff0c\u53e6\u4e00\u5757\u662fsdb\uff0c\u5728LVM\u78c1\u76d8\u7ba1\u7406\u91cc\uff0c\u6211\u9996\u5148\u8981\u5c06\u8fd9\u4e24\u5757\u786c\u76d8\u683c\u5f0f\u5316\u4e3a\u6211\u4eec\u7684PV(Physical Volume),\u4e5f\u5c31\u662f\u6211\u4eec\u7684\u7269\u7406\u5377\uff0c\u5176\u5b9e\u683c\u5f0f\u5316\u7269\u7406\u5377\u7684\u8fc7\u7a0b\u4e2dLVM\u662f\u5c06\u5e95\u5c42\u7684\u786c\u76d8\u5212\u5206\u4e3a\u4e86\u4e00\u4e2a\u4e00\u4e2a\u7684PE(Physical Extend), \u6211\u4eec\u7684LVM\u78c1\u76d8\u7ba1\u7406\u4e2dPE\u7684\u9ed8\u8ba4\u5927\u5c0f\u662f4M\u5927\u5c0f \uff0c\u5176\u5b9ePE\u5c31\u662f\u6211\u4eec\u903b\u8f91\u5377\u7ba1\u7406\u7684\u6700\u57fa\u672c\u5355\u4f4d\u3002\u6bd4\u5982\u8bf4\u6211\u6709\u4e00\u4e2a400M\u7684\u786c\u76d8\uff0c\u90a3\u4e48\u5728\u5c06\u5176\u683c\u5f0f\u5316\u6210PV\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u9645\u5c31\u662f\u5c06\u8fd9\u5757\u7269\u7406\u786c\u76d8\u5212\u5206\u6210\u4e86100\u4e2a\u7684PE\uff0c\u56e0\u4e3aPE\u9ed8\u8ba4\u7684\u5927\u5c0f\u5c31\u662f4M\u3002\u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u7684\u7b2c\u4e00\u6b65\u64cd\u4f5c\u3002","title":"1.\u5c06\u6211\u4eec\u7684\u7269\u7406\u786c\u76d8\u683c\u5f0f\u5316\u6210PV(Physical Volume)"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#2vgvolume-group","text":"\u5728\u5c06\u786c\u76d8\u683c\u5f0f\u5316\u6210PV\u4ee5\u540e\uff0c\u6211\u4eec\u7b2c\u4e8c\u6b65\u64cd\u4f5c\u5c31\u662f\u521b\u5efa\u4e00\u4e2a\u5377\u7ec4\uff0c\u4e5f\u5c31\u662fVG(Volume Group),\u5377\u7ec4\u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u62bd\u8c61\u5316\u6210\u4e00\u4e2a\u7a7a\u95f4\u6c60\uff0cVG\u7684\u4f5c\u7528\u5c31\u662f\u7528\u6765\u88c5PE\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u4e2a\u6216\u8005\u591a\u4e2aPV\u52a0\u5230VG\u5f53\u4e2d\uff0c\u56e0\u4e3a\u5728\u7b2c\u4e00\u6b65\u64cd\u4f5c\u65f6\u5c31\u5df2\u7ecf\u5c06\u8be5\u786c\u76d8\u5212\u5206\u6210\u4e86\u591a\u4e2aPE\uff0c\u6240\u4ee5\u5c06\u591a\u4e2aPV\u52a0\u5230VG\u91cc\u9762\u540e\uff0cVG\u91cc\u9762\u5c31\u5b58\u653e\u4e86\u8bb8\u8bb8\u591a\u591a\u6765\u81ea\u4e0d\u540cPV\u4e2d\u7684PE\uff0c\u6211\u4eec\u901a\u8fc7\u4e0a\u9762\u7684\u56fe\u7247\u5c31\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u683c\u5f0f\u5316\u4e86\u4e24\u5757\u786c\u76d8\uff0c\u6bcf\u4e2a\u786c\u76d8\u5206\u522b\u683c\u5f0f\u5316\u6210\u4e863\u4e2aPE\uff0c\u7136\u540e\u5c06\u4e24\u5757\u786c\u76d8\u7684PE\u90fd\u52a0\u5230\u4e86\u6211\u4eec\u7684VG\u5f53\u4e2d\uff0c\u90a3\u4e48\u6211\u4eec\u7684VG\u5f53\u4e2d\u5c31\u5305\u542b\u4e866\u4e2aPE\uff0c\u8fd96\u4e2aPE\u5c31\u662f\u4e24\u4e2a\u786c\u76d8\u7684PE\u4e4b\u548c\u3002\u901a\u5e38\u521b\u5efa\u4e00\u4e2a\u5377\u7ec4\u7684\u65f6\u5019\u6211\u4eec\u4f1a\u4e3a\u5176\u53d6\u4e00\u4e2a\u540d\u5b57\uff0c\u4e5f\u5c31\u662f\u8be5VG\u7684\u540d\u5b57\u3002","title":"2.\u521b\u5efa\u4e00\u4e2aVG(Volume Group)"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#3vglvlogical-volume","text":"\u3010\u6ce8\u610f\u3011PV\u4ee5\u53caVG\u521b\u5efa\u597d\u4ee5\u540e\u6211\u4eec\u662f\u4e0d\u80fd\u591f\u76f4\u63a5\u4f7f\u7528\u7684\uff0c\u56e0\u4e3aPV\u3001VG\u662f\u6211\u4eec\u903b\u8f91\u5377\u5e95\u5c42\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u5176\u5b9e\u6700\u540e\u4f7f\u7528\u7684\u662f\u5728VG\u57fa\u7840\u4e0a\u521b\u5efa\u7684LV(Logical Volume),\u6240\u4ee5\u7b2c\u4e09\u6b65\u64cd\u4f5c\u5c31\u662f\u57fa\u4e8eVG\u6765\u521b\u5efa\u6211\u4eec\u6700\u7ec8\u8981\u4f7f\u7528\u7684LV\u3002 \u5f53\u6211\u4eec\u521b\u5efa\u597d\u6211\u4eec\u7684VG\u4ee5\u540e\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u521b\u5efaLV\u5176\u5b9e\u5c31\u662f\u4eceVG\u4e2d\u62ff\u51fa\u6211\u4eec\u6307\u5b9a\u6570\u91cf\u7684PE\uff0c\u8fd8\u662f\u62ff\u4e0a\u56fe\u6765\u8bf4\uff0c\u6211\u4eec\u770b\u5230\u6211\u4eec\u6b64\u65f6\u7684VG\u91cc\u9762\u5df2\u7ecf\u62e5\u6709\u4e866\u4e2aPE\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u521b\u5efa\u4e86\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u903b\u8f91\u5377\uff0c\u5b83\u7684\u5927\u5c0f\u662f4\u4e2aPE\u7684\u5927\u5c0f\uff0c\u4e5f\u5c31\u662f16M( \u56e0\u4e3a\u4e00\u4e2aPE\u7684\u9ed8\u8ba4\u5927\u5c0f\u662f4M )\uff0c\u800c\u8fd94\u4e2aPE\u6709\u4e09\u4e2a\u662f\u6765\u81ea\u4e8e\u7b2c\u4e00\u5757\u786c\u76d8\uff0c\u800c\u53e6\u5916\u4e00\u4e2aPE\u5219\u662f\u6765\u81ea\u7b2c\u4e8c\u5757\u786c\u76d8\u3002\u5f53\u6211\u4eec\u521b\u5efa\u7b2c\u4e8c\u4e2a\u903b\u8f91\u5377\u65f6\uff0c\u5b83\u7684\u5927\u5c0f\u5c31\u6700\u591a\u53ea\u6709\u4e24\u4e2aPE\u7684\u5927\u5c0f\u4e86\uff0c\u56e0\u4e3a\u5176\u4e2d\u76844\u4e2aPE\u5df2\u7ecf\u5206\u914d\u7ed9\u4e86\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u903b\u8f91\u5377\u3002 \u6240\u4ee5\u521b\u5efa\u903b\u8f91\u5377\u5176\u5b9e\u5c31\u662f\u6211\u4eec\u4eceVG\u4e2d\u62ff\u51fa\u6211\u4eec\u6307\u5b9a\u6570\u91cf\u7684PE\uff0cVG\u4e2d\u7684PE\u53ef\u4ee5\u6765\u81ea\u4e0d\u540c\u7684PV\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u7684\u903b\u8f91\u5377\u7684\u5927\u5c0f\u53d6\u51b3\u4e8eVG\u5f53\u4e2dPE\u5b58\u5728\u7684\u6570\u91cf\uff0c\u5e76\u4e14\u6211\u4eec\u521b\u5efa\u7684\u903b\u8f91\u5377\u5176\u5927\u5c0f\u4e00\u5b9a\u662fPE\u7684\u6574\u6570\u500d(\u5373\u903b\u8f91\u5377\u7684\u5927\u5c0f\u4e00\u5b9a\u8981\u662f4M\u7684\u6574\u6570\u500d)\u3002","title":"3.\u57fa\u4e8eVG\u521b\u5efa\u6211\u4eec\u6700\u540e\u8981\u4f7f\u7528\u7684LV(Logical Volume)"},{"location":"LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/#4lv","text":"\u5728\u521b\u5efa\u597dLV\u4ee5\u540e\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u80fd\u591f\u5bf9\u5176\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\u4e86\uff0c\u6211\u4eec\u6700\u7ec8\u4f7f\u7528\u7684\u5c31\u662f\u6211\u4eec\u521a\u521b\u5efa\u597d\u7684LV\uff0c\u5176\u5c31\u76f8\u5f53\u4e8e\u4f20\u7edf\u7684\u6587\u4ef6\u7ba1\u7406\u7684\u5206\u533a\uff0c\u6211\u4eec\u9996\u5148\u8981\u5bf9\u5176\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\u64cd\u4f5c\uff0c\u7136\u540e\u901a\u8fc7mount\u547d\u4ee4\u5bf9\u5176\u8fdb\u884c\u6302\u8f7d\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u80fd\u591f\u50cf\u4f7f\u7528\u5e73\u5e38\u7684\u5206\u533a\u4e00\u6837\u6765\u4f7f\u7528\u6211\u4eec\u7684\u903b\u8f91\u5377\u4e86\u3002 \u6211\u4eec\u5728\u521b\u5efa\u597dLV\u4ee5\u540e\uff0c\u6211\u4eec\u4f1a\u5728 /dev \u76ee\u5f55\u4e0b\u770b\u5230\u6211\u4eec\u7684LV\u4fe1\u606f\uff0c\u4f8b\u5982 /dev/vgname/lvname \uff0c \u6211\u4eec\u6bcf\u521b\u5efa\u4e00\u4e2aVG\uff0c\u5176\u4f1a\u5728 /dev \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u4ee5\u8be5VG\u540d\u5b57\u547d\u540d\u7684\u6587\u4ef6\u5939\uff0c\u5728\u8be5VG\u7684\u57fa\u7840\u4e0a\u521b\u5efa\u597dLV\u4ee5\u540e\uff0c\u6211\u4eec\u4f1a\u5728\u8fd9\u4e2aVG\u76ee\u5f55\u4e0b\u591a\u51fa\u4e00\u4e2a\u4ee5LV\u540d\u5b57\u547d\u540d\u7684\u903b\u8f91\u5377\u3002 \u4e0b\u9762\u6211\u4eec\u6765\u5bf9\u6574\u4e2aLVM\u7684\u5de5\u4f5c\u539f\u7406\u8fdb\u884c\u4e00\u4e2a\u603b\u7ed3\uff1a (1)\u7269\u7406\u78c1\u76d8\u88ab\u683c\u5f0f\u5316\u4e3aPV\uff0c\u7a7a\u95f4\u88ab\u5212\u5206\u4e3a\u4e00\u4e2a\u4e2a\u7684PE (2)\u4e0d\u540c\u7684PV\u52a0\u5165\u5230\u540c\u4e00\u4e2aVG\u4e2d\uff0c\u4e0d\u540cPV\u7684PE\u5168\u90e8\u8fdb\u5165\u5230\u4e86VG\u7684PE\u6c60\u5185 (3)LV\u57fa\u4e8ePE\u521b\u5efa\uff0c\u5927\u5c0f\u4e3aPE\u7684\u6574\u6570\u500d\uff0c\u7ec4\u6210LV\u7684PE\u53ef\u80fd\u6765\u81ea\u4e0d\u540c\u7684\u7269\u7406\u78c1\u76d8 (4)LV\u73b0\u5728\u5c31\u76f4\u63a5\u53ef\u4ee5\u683c\u5f0f\u5316\u540e\u6302\u8f7d\u4f7f\u7528\u4e86 (5)LV\u7684\u6269\u5145\u7f29\u51cf\u5b9e\u9645\u4e0a\u5c31\u662f\u589e\u52a0\u6216\u51cf\u5c11\u7ec4\u6210\u8be5LV\u7684PE\u6570\u91cf\uff0c\u5176\u8fc7\u7a0b\u4e0d\u4f1a\u4e22\u5931\u539f\u59cb\u6570\u636e \u6211\u4eec\u770b\u5230\uff0c\u6211\u4eec\u8fd9\u91cc\u5982\u679c\u8981\u5bf9LV\u8fdb\u884c\u6269\u5145\uff0c\u76f4\u63a5\u52a0\u8fdb\u6765\u4e00\u5757sdc\u786c\u76d8\uff0c\u7136\u540e\u5c06\u5176\u683c\u5f0f\u5316\u6210PE\uff0c\u7136\u540e\u5c06\u8be5PV\u52a0\u5165\u5230\u4e86VG\u5f53\u4e2d\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0LV\u4e2dPE\u7684\u6570\u91cf\u6765\u52a8\u6001\u7684\u5bf9LV\u8fdb\u884c\u6269\u5145\u4e86\uff0c\u53ea\u8981\u6211\u4eec\u7684LV\u7684\u5927\u5c0f\u4e0d\u8981\u8d85\u8fc7\u6211\u4eecVG\u7a7a\u4f59\u7a7a\u95f4\u7684\u5927\u5c0f\u5c31\u884c\u4e86\uff01\uff01","title":"4.\u5c06\u6211\u4eec\u521b\u5efa\u597d\u7684LV\u8fdb\u884c\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u5316\uff0c\u7136\u540e\u6302\u8f7d\u4f7f\u7528"},{"location":"Linux-Performance/","text":"Linux Performance \u00b6 \u539f\u6587 linux_observability_tools \u00b6 linux_benchmarking_tools \u00b6 linux_tuning_tools \u00b6 linux_static_tools \u00b6 linux_observability_sar \u00b6 perf-tools_2016 \u00b6 bcc_tracing_tools \u00b6","title":"Linux Performance"},{"location":"Linux-Performance/#linux-performance","text":"\u539f\u6587","title":"Linux Performance"},{"location":"Linux-Performance/#linux_observability_tools","text":"","title":"linux_observability_tools"},{"location":"Linux-Performance/#linux_benchmarking_tools","text":"","title":"linux_benchmarking_tools"},{"location":"Linux-Performance/#linux_tuning_tools","text":"","title":"linux_tuning_tools"},{"location":"Linux-Performance/#linux_static_tools","text":"","title":"linux_static_tools"},{"location":"Linux-Performance/#linux_observability_sar","text":"","title":"linux_observability_sar"},{"location":"Linux-Performance/#perf-tools_2016","text":"","title":"perf-tools_2016"},{"location":"Linux-Performance/#bcc_tracing_tools","text":"","title":"bcc_tracing_tools"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/","text":"Linux shell \u903b\u8f91\u8fd0\u7b97\u7b26\u3001\u903b\u8f91\u8868\u8fbe\u5f0f\u8be6\u89e3 \u00b6 Google \u5f00\u6e90\u9879\u76ee\u98ce\u683c\u6307\u5357 https://zh-google-styleguide.readthedocs.io/en/latest/google-shell-styleguide/contents/ shell\u7684\u903b\u8f91\u8fd0\u7b97\u7b26 \u6d89\u53ca\u6709\u4ee5\u4e0b\u51e0\u79cd\u7c7b\u578b\uff0c\u56e0\u6b64\u53ea\u8981\u9002\u5f53\u9009\u62e9\uff0c\u53ef\u4ee5\u89e3\u51b3\u6211\u4eec\u5f88\u591a\u590d\u6742\u7684\u5224\u65ad\uff0c\u8fbe\u5230\u4e8b\u534a\u529f\u500d\u6548\u679c\u3002 \u00b6 \u4e00\u3001\u903b\u8f91\u8fd0\u7b97\u7b26 \u00b6 1\u3001\u903b\u8f91\u5377\u6807\u8868\u793a\u610f\u601d \u00b6 \u5173\u4e8e\u6863\u6848\u4e0e\u76ee\u5f55\u7684\u4fa6\u6d4b\u903b\u8f91\u5377\u6807 -f \u5e38\u7528\uff01\u4fa6\u6d4b\u300e\u6863\u6848\u300f\u662f\u5426\u5b58\u5728 eg: if [ -f filename ] -d \u5e38\u7528\uff01\u4fa6\u6d4b\u300e\u76ee\u5f55\u300f\u662f\u5426\u5b58\u5728 -b \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e block \u6863\u6848\u300f -c \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e character \u6863\u6848\u300f -S \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e socket \u6807\u7b7e\u6863\u6848\u300f -L \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e symbolic link \u7684\u6863\u6848\u300f -e \u4fa6\u6d4b\u300e\u67d0\u4e2a\u4e1c\u897f\u300f\u662f\u5426\u5b58\u5728\uff01 \u5173\u4e8e\u7a0b\u5e8f\u7684\u903b\u8f91\u5377\u6807 -G \u4fa6\u6d4b\u662f\u5426\u7531 GID \u6240\u6267\u884c\u7684\u7a0b\u5e8f\u6240\u62e5\u6709 -O \u4fa6\u6d4b\u662f\u5426\u7531 UID \u6240\u6267\u884c\u7684\u7a0b\u5e8f\u6240\u62e5\u6709 -p \u4fa6\u6d4b\u662f\u5426\u4e3a\u7a0b\u5e8f\u95f4\u4f20\u9001\u4fe1\u606f\u7684 name pipe \u6216\u662f FIFO \uff08\u8001\u5b9e\u8bf4\uff0c\u8fd9\u4e2a\u4e0d\u592a\u61c2\uff01\uff09 \u5173\u4e8e\u6863\u6848\u7684\u5c5e\u6027\u4fa6\u6d4b -r \u4fa6\u6d4b\u662f\u5426\u4e3a\u53ef\u8bfb\u7684\u5c5e\u6027 -w \u4fa6\u6d4b\u662f\u5426\u4e3a\u53ef\u4ee5\u5199\u5165\u7684\u5c5e\u6027 -x \u4fa6\u6d4b\u662f\u5426\u4e3a\u53ef\u6267\u884c\u7684\u5c5e\u6027 -s \u4fa6\u6d4b\u662f\u5426\u4e3a\u300e\u975e\u7a7a\u767d\u6863\u6848\u300f -u \u4fa6\u6d4b\u662f\u5426\u5177\u6709\u300e SUID \u300f\u7684\u5c5e\u6027 -g \u4fa6\u6d4b\u662f\u5426\u5177\u6709\u300e SGID \u300f\u7684\u5c5e\u6027 -k \u4fa6\u6d4b\u662f\u5426\u5177\u6709\u300e sticky bit \u300f\u7684\u5c5e\u6027 \u4e24\u4e2a\u6863\u6848\u4e4b\u95f4\u7684\u5224\u65ad\u4e0e\u6bd4\u8f83 \uff1b\u4f8b\u5982[ test file1 -nt file2 ] -nt \u7b2c\u4e00\u4e2a\u6863\u6848\u6bd4\u7b2c\u4e8c\u4e2a\u6863\u6848\u65b0 -ot \u7b2c\u4e00\u4e2a\u6863\u6848\u6bd4\u7b2c\u4e8c\u4e2a\u6863\u6848\u65e7 -ef \u7b2c\u4e00\u4e2a\u6863\u6848\u4e0e\u7b2c\u4e8c\u4e2a\u6863\u6848\u4e3a\u540c\u4e00\u4e2a\u6863\u6848\uff08 link \u4e4b\u7c7b\u7684\u6863\u6848\uff09 \u903b\u8f91\u7684\u300e\u548c(and)\u300f\u300e\u6216(or)\u300f && \u903b\u8f91\u7684 AND \u7684\u610f\u601d || \u903b\u8f91\u7684 OR \u7684\u610f\u601d 2\u3001\u8fd0\u7b97\u7b26\u53f7 \u4ee3\u8868\u610f\u4e49 \u00b6 = \u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6216\u5b57\u7b26\u4e32\u6bd4\u8f83 \u5982\u679c\u5728[] \u4e2d\uff0c\u53ea\u80fd\u662f\u5b57\u7b26\u4e32 != \u4e0d\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6216\u5b57\u7b26\u4e32\u6bd4\u8f83 \u5982\u679c\u5728[] \u4e2d\uff0c\u53ea\u80fd\u662f\u5b57\u7b26\u4e32 < \u5c0f\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 \u5728[] \u4e2d\uff0c\u4e0d\u80fd\u4f7f\u7528 \u8868\u793a\u5b57\u7b26\u4e32 > \u5927\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 \u5728[] \u4e2d\uff0c\u4e0d\u80fd\u4f7f\u7528 \u8868\u793a\u5b57\u7b26\u4e32 -eq \u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -ne \u4e0d\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -lt \u5c0f\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -gt \u5927\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -le \u5c0f\u4e8e\u6216\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -ge \u5927\u4e8e\u6216\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -a \u53cc\u65b9\u90fd\u6210\u7acb\uff08and\uff09 \u903b\u8f91\u8868\u8fbe\u5f0f \u2013a \u903b\u8f91\u8868\u8fbe\u5f0f -o \u5355\u65b9\u6210\u7acb\uff08or\uff09 \u903b\u8f91\u8868\u8fbe\u5f0f \u2013o \u903b\u8f91\u8868\u8fbe\u5f0f -z \u7a7a\u5b57\u7b26\u4e32 -n \u975e\u7a7a\u5b57\u7b26\u4e32 \u4e8c\u3001\u903b\u8f91\u8868\u8fbe\u5f0f \u00b6 1. test \u547d\u4ee4 \u00b6 \u4f7f\u7528\u65b9\u6cd5\uff1atest EXPRESSION [root@localhost ~]# test 1 = 1 && echo 'ok' ok [root@localhost ~]# test -d /etc/ && echo 'ok' ok [root@localhost ~]# test 1 -eq 1 && echo 'ok' ok [root@localhost ~]# if test 1 = 1 ; then echo 'ok'; fi ok \u6ce8\u610f\uff1a\u6240\u6709\u5b57\u7b26 \u4e0e\u903b\u8f91\u8fd0\u7b97\u7b26\u76f4\u63a5\u7528\u201c\u7a7a\u683c\u201d\u5206\u5f00\uff0c\u4e0d\u80fd\u8fde\u5230\u4e00\u8d77\u3002 \u00b6 2. \u7cbe\u7b80\u8868\u8fbe\u5f0f \u00b6 [] \u8868\u8fbe\u5f0f [root@localhost ~]# [ 1 -eq 1 ] && echo 'ok' ok [root@localhost ~]# [ 2 < 1 ] && echo 'ok' -bash: 2: No such file or directory [root@localhost ~]# [ 2 < 1 ] && echo 'ok' [root@localhost ~]# [ 2 -gt 1 -a 3 -lt 4 ] && echo 'ok' ok [root@localhost ~]# [ 2 -gt 1 && 3 -lt 4 ] && echo 'ok' -bash: [: missing `]' \u6ce8\u610f\uff1a\u5728 [] \u8868\u8fbe\u5f0f\u4e2d\uff0c\u5e38\u89c1\u7684 >,< \u9700\u8981\u52a0\u8f6c\u4e49\u5b57\u7b26\uff0c\u8868\u793a\u5b57\u7b26\u4e32\u5927\u5c0f\u6bd4\u8f83\uff0c\u4ee5acill\u7801 \u4f4d\u7f6e\u4f5c\u4e3a\u6bd4\u8f83\u3002 \u4e0d\u76f4\u63a5\u652f\u6301 <> \u8fd0\u7b97\u7b26\uff0c\u8fd8\u6709\u903b\u8f91\u8fd0\u7b97\u7b26 || && \u5b83\u9700\u8981\u7528 -a[and] \u2013o[or] \u8868\u793a \u00b6 [[]] \u8868\u8fbe\u5f0f [root@localhost ~]# [ 1 -eq 1 ] && echo 'ok' ok [root@localhost ~]$ [[ 2 < 3 ]] && echo 'ok' ok [root@localhost ~]$ [[ 2 < 3 && 4 > 5 ]] && echo 'ok' ok \u6ce8\u610f\uff1a [[]] \u8fd0\u7b97\u7b26\u53ea\u662f [] \u8fd0\u7b97\u7b26\u7684\u6269\u5145\u3002\u80fd\u591f\u652f\u6301 <,> \u7b26\u53f7\u8fd0\u7b97\u4e0d\u9700\u8981\u8f6c\u4e49\u7b26\uff0c\u5b83\u8fd8\u662f\u4ee5\u5b57\u7b26\u4e32\u6bd4\u8f83\u5927\u5c0f\u3002\u91cc\u9762\u652f\u6301\u903b\u8f91\u8fd0\u7b97\u7b26\uff1a || && \u00b6 3. \u6027\u80fd\u6bd4\u8f83 \u00b6 bash\u7684\u6761\u4ef6\u8868\u8fbe\u5f0f\u4e2d\u6709\u4e09\u4e2a\u51e0\u4e4e\u7b49\u6548\u7684\u7b26\u53f7\u548c\u547d\u4ee4\uff1a test \uff0c [] \u548c [[]] \u3002\u901a\u5e38\uff0c\u5927\u5bb6\u4e60\u60ef\u7528 if [];then \u8fd9\u6837\u7684\u5f62\u5f0f\u3002\u800c [[]] \u7684\u51fa\u73b0\uff0c\u6839\u636eABS\u6240\u8bf4\uff0c\u662f\u4e3a\u4e86\u517c\u5bb9 >< \u4e4b\u7c7b\u7684\u8fd0\u7b97\u7b26\u3002\u4ee5\u4e0b\u662f\u6bd4\u8f83\u5b83\u4eec\u6027\u80fd\uff0c\u53d1\u73b0 [[]] \u662f\u6700\u5feb\u7684\u3002 \u00b6 $ time (for m in {1..100000}; do test -d .;done;) real 0m0.658s user 0m0.558s sys 0m0.100s $ time (for m in {1..100000}; do [ -d . ];done;) real 0m0.609s user 0m0.524s sys 0m0.085s $ time (for m in {1..100000}; do [[ -d . ]];done;) real 0m0.311s user 0m0.275s sys 0m0.036s \u4e0d\u8003\u8651\u5bf9\u4f4e\u7248\u672cbash\u548c\u5bf9sh\u7684\u517c\u5bb9\u7684\u60c5\u51b5\u4e0b\uff0c\u7528 [[]] \u662f\u517c\u5bb9\u6027\u5f3a\uff0c\u800c\u4e14\u6027\u80fd\u6bd4\u8f83\u5feb\uff0c\u5728\u505a\u6761\u4ef6\u8fd0\u7b97\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u8fd0\u7b97\u7b26 \u00b6","title":"Linux-shell-\u903b\u8f91\u8fd0\u7b97\u7b26-\u903b\u8f91\u8868\u8fbe\u5f0f\u8be6\u89e3"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#linux-shell","text":"Google \u5f00\u6e90\u9879\u76ee\u98ce\u683c\u6307\u5357 https://zh-google-styleguide.readthedocs.io/en/latest/google-shell-styleguide/contents/","title":"Linux shell \u903b\u8f91\u8fd0\u7b97\u7b26\u3001\u903b\u8f91\u8868\u8fbe\u5f0f\u8be6\u89e3"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#shell","text":"","title":"shell\u7684\u903b\u8f91\u8fd0\u7b97\u7b26 \u6d89\u53ca\u6709\u4ee5\u4e0b\u51e0\u79cd\u7c7b\u578b\uff0c\u56e0\u6b64\u53ea\u8981\u9002\u5f53\u9009\u62e9\uff0c\u53ef\u4ee5\u89e3\u51b3\u6211\u4eec\u5f88\u591a\u590d\u6742\u7684\u5224\u65ad\uff0c\u8fbe\u5230\u4e8b\u534a\u529f\u500d\u6548\u679c\u3002"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#_1","text":"","title":"\u4e00\u3001\u903b\u8f91\u8fd0\u7b97\u7b26"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#1","text":"\u5173\u4e8e\u6863\u6848\u4e0e\u76ee\u5f55\u7684\u4fa6\u6d4b\u903b\u8f91\u5377\u6807 -f \u5e38\u7528\uff01\u4fa6\u6d4b\u300e\u6863\u6848\u300f\u662f\u5426\u5b58\u5728 eg: if [ -f filename ] -d \u5e38\u7528\uff01\u4fa6\u6d4b\u300e\u76ee\u5f55\u300f\u662f\u5426\u5b58\u5728 -b \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e block \u6863\u6848\u300f -c \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e character \u6863\u6848\u300f -S \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e socket \u6807\u7b7e\u6863\u6848\u300f -L \u4fa6\u6d4b\u662f\u5426\u4e3a\u4e00\u4e2a\u300e symbolic link \u7684\u6863\u6848\u300f -e \u4fa6\u6d4b\u300e\u67d0\u4e2a\u4e1c\u897f\u300f\u662f\u5426\u5b58\u5728\uff01 \u5173\u4e8e\u7a0b\u5e8f\u7684\u903b\u8f91\u5377\u6807 -G \u4fa6\u6d4b\u662f\u5426\u7531 GID \u6240\u6267\u884c\u7684\u7a0b\u5e8f\u6240\u62e5\u6709 -O \u4fa6\u6d4b\u662f\u5426\u7531 UID \u6240\u6267\u884c\u7684\u7a0b\u5e8f\u6240\u62e5\u6709 -p \u4fa6\u6d4b\u662f\u5426\u4e3a\u7a0b\u5e8f\u95f4\u4f20\u9001\u4fe1\u606f\u7684 name pipe \u6216\u662f FIFO \uff08\u8001\u5b9e\u8bf4\uff0c\u8fd9\u4e2a\u4e0d\u592a\u61c2\uff01\uff09 \u5173\u4e8e\u6863\u6848\u7684\u5c5e\u6027\u4fa6\u6d4b -r \u4fa6\u6d4b\u662f\u5426\u4e3a\u53ef\u8bfb\u7684\u5c5e\u6027 -w \u4fa6\u6d4b\u662f\u5426\u4e3a\u53ef\u4ee5\u5199\u5165\u7684\u5c5e\u6027 -x \u4fa6\u6d4b\u662f\u5426\u4e3a\u53ef\u6267\u884c\u7684\u5c5e\u6027 -s \u4fa6\u6d4b\u662f\u5426\u4e3a\u300e\u975e\u7a7a\u767d\u6863\u6848\u300f -u \u4fa6\u6d4b\u662f\u5426\u5177\u6709\u300e SUID \u300f\u7684\u5c5e\u6027 -g \u4fa6\u6d4b\u662f\u5426\u5177\u6709\u300e SGID \u300f\u7684\u5c5e\u6027 -k \u4fa6\u6d4b\u662f\u5426\u5177\u6709\u300e sticky bit \u300f\u7684\u5c5e\u6027 \u4e24\u4e2a\u6863\u6848\u4e4b\u95f4\u7684\u5224\u65ad\u4e0e\u6bd4\u8f83 \uff1b\u4f8b\u5982[ test file1 -nt file2 ] -nt \u7b2c\u4e00\u4e2a\u6863\u6848\u6bd4\u7b2c\u4e8c\u4e2a\u6863\u6848\u65b0 -ot \u7b2c\u4e00\u4e2a\u6863\u6848\u6bd4\u7b2c\u4e8c\u4e2a\u6863\u6848\u65e7 -ef \u7b2c\u4e00\u4e2a\u6863\u6848\u4e0e\u7b2c\u4e8c\u4e2a\u6863\u6848\u4e3a\u540c\u4e00\u4e2a\u6863\u6848\uff08 link \u4e4b\u7c7b\u7684\u6863\u6848\uff09 \u903b\u8f91\u7684\u300e\u548c(and)\u300f\u300e\u6216(or)\u300f && \u903b\u8f91\u7684 AND \u7684\u610f\u601d || \u903b\u8f91\u7684 OR \u7684\u610f\u601d","title":"1\u3001\u903b\u8f91\u5377\u6807\u8868\u793a\u610f\u601d"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#2","text":"= \u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6216\u5b57\u7b26\u4e32\u6bd4\u8f83 \u5982\u679c\u5728[] \u4e2d\uff0c\u53ea\u80fd\u662f\u5b57\u7b26\u4e32 != \u4e0d\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6216\u5b57\u7b26\u4e32\u6bd4\u8f83 \u5982\u679c\u5728[] \u4e2d\uff0c\u53ea\u80fd\u662f\u5b57\u7b26\u4e32 < \u5c0f\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 \u5728[] \u4e2d\uff0c\u4e0d\u80fd\u4f7f\u7528 \u8868\u793a\u5b57\u7b26\u4e32 > \u5927\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 \u5728[] \u4e2d\uff0c\u4e0d\u80fd\u4f7f\u7528 \u8868\u793a\u5b57\u7b26\u4e32 -eq \u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -ne \u4e0d\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -lt \u5c0f\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -gt \u5927\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -le \u5c0f\u4e8e\u6216\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -ge \u5927\u4e8e\u6216\u7b49\u4e8e \u5e94\u7528\u4e8e\uff1a\u6574\u578b\u6bd4\u8f83 -a \u53cc\u65b9\u90fd\u6210\u7acb\uff08and\uff09 \u903b\u8f91\u8868\u8fbe\u5f0f \u2013a \u903b\u8f91\u8868\u8fbe\u5f0f -o \u5355\u65b9\u6210\u7acb\uff08or\uff09 \u903b\u8f91\u8868\u8fbe\u5f0f \u2013o \u903b\u8f91\u8868\u8fbe\u5f0f -z \u7a7a\u5b57\u7b26\u4e32 -n \u975e\u7a7a\u5b57\u7b26\u4e32","title":"2\u3001\u8fd0\u7b97\u7b26\u53f7 \u4ee3\u8868\u610f\u4e49"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#_2","text":"","title":"\u4e8c\u3001\u903b\u8f91\u8868\u8fbe\u5f0f"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#1-test","text":"\u4f7f\u7528\u65b9\u6cd5\uff1atest EXPRESSION [root@localhost ~]# test 1 = 1 && echo 'ok' ok [root@localhost ~]# test -d /etc/ && echo 'ok' ok [root@localhost ~]# test 1 -eq 1 && echo 'ok' ok [root@localhost ~]# if test 1 = 1 ; then echo 'ok'; fi ok","title":"1. test \u547d\u4ee4"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#_3","text":"","title":"\u6ce8\u610f\uff1a\u6240\u6709\u5b57\u7b26 \u4e0e\u903b\u8f91\u8fd0\u7b97\u7b26\u76f4\u63a5\u7528\u201c\u7a7a\u683c\u201d\u5206\u5f00\uff0c\u4e0d\u80fd\u8fde\u5230\u4e00\u8d77\u3002"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#2_1","text":"[] \u8868\u8fbe\u5f0f [root@localhost ~]# [ 1 -eq 1 ] && echo 'ok' ok [root@localhost ~]# [ 2 < 1 ] && echo 'ok' -bash: 2: No such file or directory [root@localhost ~]# [ 2 < 1 ] && echo 'ok' [root@localhost ~]# [ 2 -gt 1 -a 3 -lt 4 ] && echo 'ok' ok [root@localhost ~]# [ 2 -gt 1 && 3 -lt 4 ] && echo 'ok' -bash: [: missing `]'","title":"2. \u7cbe\u7b80\u8868\u8fbe\u5f0f"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#acill-aand-oor","text":"[[]] \u8868\u8fbe\u5f0f [root@localhost ~]# [ 1 -eq 1 ] && echo 'ok' ok [root@localhost ~]$ [[ 2 < 3 ]] && echo 'ok' ok [root@localhost ~]$ [[ 2 < 3 && 4 > 5 ]] && echo 'ok' ok","title":"\u6ce8\u610f\uff1a\u5728[]\u8868\u8fbe\u5f0f\u4e2d\uff0c\u5e38\u89c1\u7684&gt;,&lt;\u9700\u8981\u52a0\u8f6c\u4e49\u5b57\u7b26\uff0c\u8868\u793a\u5b57\u7b26\u4e32\u5927\u5c0f\u6bd4\u8f83\uff0c\u4ee5acill\u7801 \u4f4d\u7f6e\u4f5c\u4e3a\u6bd4\u8f83\u3002 \u4e0d\u76f4\u63a5\u652f\u6301&lt;&gt;\u8fd0\u7b97\u7b26\uff0c\u8fd8\u6709\u903b\u8f91\u8fd0\u7b97\u7b26|| &amp;&amp; \u5b83\u9700\u8981\u7528-a[and] \u2013o[or]\u8868\u793a"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#_4","text":"","title":"\u6ce8\u610f\uff1a[[]] \u8fd0\u7b97\u7b26\u53ea\u662f[]\u8fd0\u7b97\u7b26\u7684\u6269\u5145\u3002\u80fd\u591f\u652f\u6301&lt;,&gt;\u7b26\u53f7\u8fd0\u7b97\u4e0d\u9700\u8981\u8f6c\u4e49\u7b26\uff0c\u5b83\u8fd8\u662f\u4ee5\u5b57\u7b26\u4e32\u6bd4\u8f83\u5927\u5c0f\u3002\u91cc\u9762\u652f\u6301\u903b\u8f91\u8fd0\u7b97\u7b26\uff1a|| &amp;&amp;"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#3","text":"","title":"3. \u6027\u80fd\u6bd4\u8f83"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#bashtestif-thenabs","text":"$ time (for m in {1..100000}; do test -d .;done;) real 0m0.658s user 0m0.558s sys 0m0.100s $ time (for m in {1..100000}; do [ -d . ];done;) real 0m0.609s user 0m0.524s sys 0m0.085s $ time (for m in {1..100000}; do [[ -d . ]];done;) real 0m0.311s user 0m0.275s sys 0m0.036s","title":"bash\u7684\u6761\u4ef6\u8868\u8fbe\u5f0f\u4e2d\u6709\u4e09\u4e2a\u51e0\u4e4e\u7b49\u6548\u7684\u7b26\u53f7\u548c\u547d\u4ee4\uff1atest\uff0c[]\u548c[[]]\u3002\u901a\u5e38\uff0c\u5927\u5bb6\u4e60\u60ef\u7528if [];then\u8fd9\u6837\u7684\u5f62\u5f0f\u3002\u800c[[]]\u7684\u51fa\u73b0\uff0c\u6839\u636eABS\u6240\u8bf4\uff0c\u662f\u4e3a\u4e86\u517c\u5bb9&gt;&lt;\u4e4b\u7c7b\u7684\u8fd0\u7b97\u7b26\u3002\u4ee5\u4e0b\u662f\u6bd4\u8f83\u5b83\u4eec\u6027\u80fd\uff0c\u53d1\u73b0[[]]\u662f\u6700\u5feb\u7684\u3002"},{"location":"Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/#bashsh","text":"","title":"\u4e0d\u8003\u8651\u5bf9\u4f4e\u7248\u672cbash\u548c\u5bf9sh\u7684\u517c\u5bb9\u7684\u60c5\u51b5\u4e0b\uff0c\u7528[[]]\u662f\u517c\u5bb9\u6027\u5f3a\uff0c\u800c\u4e14\u6027\u80fd\u6bd4\u8f83\u5feb\uff0c\u5728\u505a\u6761\u4ef6\u8fd0\u7b97\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u8be5\u8fd0\u7b97\u7b26"},{"location":"MB-MiB%E7%9A%84%E5%8C%BA%E5%88%AB/","text":"\u539f\u6587 \u8bf4\u5b9e\u8bdd\u8fd9\u51e0\u4e2a\u5355\u4f4d\u5f88\u591a\u4eba\u4f1a\u5f04\u6df7\uff0c\u5148\u653e\u4e0a\u76f4\u89c2\u7684\u5bf9\u5e94\u8868\uff1a 1KB = 1,000 Byte 1MB = 1,000 KB 1GB = 1,000,000 KB 1TB = 1,000,000,000 KB 1KiB = 1,024Byte 1MiB = 1,024KiB 1GiB = 1,024MiB = 1,048,576 KiB 1TiB = 1,024GiB = 1,073,741,824 KiB \u5176\u4e2d\uff0cKiB\u662f ki lo bi nary byte \u7684\u7f29\u5199\uff0c\u6307\u7684\u662f\u5343\u4f4d \u4e8c\u8fdb\u5236 \u5b57\u8282 \u800cKB\u662f kilobyte \u7684\u7f29\u5199\uff0c\u6307\u7684\u662f\u5343\u5b57\u8282 \u4e8c\u8005\u7684\u533a\u522b\u5c31\u5728\u4e8e\u5f53\u4e2d\u7684 \u4e8c\u8fdb\u5236 \u3002\u6211\u60f3\u8bf4\u9053\u8fd9\u91cc\u5927\u90e8\u5206\u4eba\u5e94\u8be5\u90fd\u660e\u767d\u4e3a\u5565KiB\u662f\u6309\u71671024\u6362\u7b97\u7684\u4e86\u3002\u8fd8\u8bb0\u5f97\u90a3\u4e2a\u7b11\u8bdd\u4e48\uff0cA\u95ee\u7a0b\u5e8f\u5458B\u501f\u94b1\uff1a A\uff1aB\uff0c\u501f\u6211\u70b9\u94b1\u5427\uff01 B\uff1a\u591a\u5c11\uff1f A\uff1a1000\u884c\u4e0d\uff1f B\uff1a\u51d1\u4e2a\u6574\uff0c\u7ed9\u4f601024\u5427\uff01 \u518d\u8bf4\u6df1\u5165\u4e00\u70b9\uff0c\u8fd9\u5176\u4e2d\u5176\u5b9e\u7275\u626f\u4e86\u4e24\u79cd\u6807\u51c6\uff1a \u56fd\u9645\u5355\u4f4d\u5236 SI \u5236\u5b9a\u7684\u5341\u8fdb\u5236\u6807\u51c6\u548c \u56fd\u9645\u7535\u5de5\u59d4\u5458\u4f1a \u5236\u5b9a\u7684\u4e8c\u8fdb\u5236\u6807\u51c6\uff0c\u4e5f\u5c31\u662f\u901a\u5e38\u6240\u8bf4\u7684SI\u548cIEC\u6807\u51c6\u3002 ============================================================= \u770b\u4e86\u533f\u540d\u7528\u6237\u7684\u56de\u590d\uff0c\u51b3\u5b9a\u6765\u8865\u5145\u4e00\u4e9b\u4e1c\u897f\u3002//\u8bdd\u8bf4\u8fd9\u79cd\u95ee\u9898\u4e3a\u5565\u8981\u533f\u540d\u5440\u6454\uff01 \u9996\u51481KB=1000B\u7edd\u5bf9\u4e0d\u662f\u786c\u76d8\u5382\u5546\u53d1\u660e\u7684\uff0c\u4ed6\u4eec\u53ea\u662f\u5229\u7528\u8005\uff0c\u55ef\u55ef\u3002 \u7136\u540e\uff0c\u5173\u4e8e\u5927B\u548c\u5c0fb\uff0c\u533f\u540d\u7528\u6237\u89e3\u91ca\u7684\u975e\u5e38\u597d\u3002\u987a\u4fbf\u4e00\u8bf4\u4e3a\u5565\u7f51\u7edc\u4f20\u8f93\u8981\u4f7f\u7528\u5c0fb\uff0c\u56e0\u4e3a\u5728\u7f51\u7edc\u4f20\u8f93\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f20\u8f93\u7684\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u4e2a\u4e8c\u8fdb\u5236\u6570\uff0c\u4f3c\u4e4e\u53ef\u4ee5\u4fd7\u79f0\u4e3a\u6bd4\u7279\u6d41\u3002\u90a3\u4e48\uff0c\u5728\u4f20\u8f93\u4e8c\u8fdb\u5236\u6570\u7684\u65f6\u5019\uff0c\u6211\u4eec\u663e\u7136\u662f\u4e0d\u7ba1\u4f60\u8fd9\u662f\u4ec0\u4e48\u5b57\uff0c\u7528\u7684\u4ec0\u4e48\u7f16\u7801\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8861\u91cf\u4f20\u8f93\u901f\u5ea6\u7684\u6700\u76f4\u63a5\u7684\u91cf\u5c31\u662f\u6bcf\u79d2\u949f\u4f20\u8f93\u4e86\u591a\u5c11\u4e86\u4e8c\u8fdb\u5236\u4f4d\uff0c\u6240\u4ee5\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\uff0c\u6211\u4eec\u666e\u904d\u4f7f\u7528\u5c0fb\u4f5c\u4e3a\u5355\u4f4d\u3002 \u7136\u540e\u5bf9\u4e8eta\u63d0\u51fa\u7684Windows\u7684Size\u7684\u95ee\u9898\uff0c\u8fd9\u4e2a\u5f88\u597d\u89e3\u91ca\u3002 \u9996\u5148\uff0c\u7b2c\u4e00\u4e2aSize\u663e\u7136\u662f\u7ecf\u8fc7\u820e\u5165\u7684\u3002\u8bf7\u4e0d\u8981\u7528115\u53bb\u505a\u4e58\u6cd5\uff0c\u76f4\u63a5\u7528118774\u53bb\u96641024\u5c31\u80fd\u5f97\u5230\u7ed3\u679c\uff1a115.990234375\u3002\u5173\u4e8e\u820d\u5165\u7a76\u7adf\u662f\u4ec0\u4e48\u89c4\u5219\uff0c\u6211\u8fd8\u5728\u5bfb\u627e\u76f8\u5173\u7684\u6587\u6863\uff0c\u5c31\u76ee\u524d\u6765\u770b\u4f3c\u4e4e\u662f\u76f4\u63a5\u820d\u53bb\u5c0f\u6570\u90e8\u5206\u3002 \u7136\u540e\uff0c\u7b2c\u4e8c\u4e2aSize on Disk\u5c31\u66f4\u597d\u89e3\u91ca\u4e86\u3002\u5982\u679c\u4f60\u7528118784\u96641024\u4f1a\u53d1\u73b0\u8bf6\uff0c\u6b63\u597d\u6574\u9664\uff01\u7ed3\u679c\u5c31\u662f116\uff01\u8fd9\u662f\u4e3a\u5565\u5462\uff1f\u663e\u7136\u8fd9\u8ddf\u6587\u4ef6\u5728\u78c1\u76d8\u4e0a\u5b58\u50a8\u7684\u6700\u5c0f\u5355\u4f4d\u6709\u5173\u3002\u5728NTFS\u5206\u533a\u4e0a\uff0c\u6587\u4ef6\u5b58\u50a8\u7684\u6700\u5c0f\u533a\u5757\u662f\u7c07\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u9ed8\u8ba4\u7684\u7c07\u5927\u5c0f\u4e3a4K\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0d\u8bba\u4f60\u7684\u6587\u4ef6\u6709\u591a\u5c0f\uff0c\u5c31\u7b97\u4f60\u7684\u6587\u4ef6\u53ea\u67091b\uff0c\u5bf9\u4e0d\u8d77\uff0c\u6211\u8fd8\u662f\u8981\u5360\u7528\u4e00\u4e2a4K\u5927\u5c0f\u7684\u7c07\u3002\u4ed4\u7ec6\u4e00\u7b97\u4f60\u662f\u4e0d\u662f\u53d1\u73b0116/4\u521a\u597d\u6574\u9664\uff0c\u7b49\u4e8e29\u5462\uff1f\u8bf4\u660e\u4f60\u7684\u7cfb\u7edf\u5f88\u53ef\u80fd\u4e5f\u662f4K\u4e3a\u4e00\u4e2a\u7c07\uff0c\u7136\u540e\u8be5\u6587\u4ef6\u5360\u7528\u4e86\u4f6029\u4e2a\u7c07\u3002 \u53c2\u8003[ \u77e5\u8b58] KB KiB MB MiB GB GiB TB TiB \u55ae\u4f4d\u50bb\u50bb\u5206\u4e0d\u6e05\u695a? \u5343\u5b57\u8282 Kibibyte KB, MB, GB\u4e2d\u7684K, M, G\u4ee3\u8868\u5b57\u8282\u7684\u6570\u91cf\uff0c\u81ea\u5df1\u4e5f\u5e38\u6df7\u6dc6\uff0c\u603b\u7ed3\u5982\u4e0b\uff1a K\u5355\u72ec\u51fa\u73b0\u65f6\uff0c\u4ee3\u88681000 \u6216 1024 K\u4e0eKi\u4e00\u8d77\u51fa\u73b0\u65f6\uff0cK\u4ee3\u88681000\uff0cKi\u4ee3\u88681024 K\u4e0ek\u4e00\u8d77\u51fa\u73b0\u65f6\uff0cK\u4ee3\u88681024\uff0ck\u4ee3\u88681000 K\u548cKi\u4e3a\u4f8b\uff1a 1K=10^3 1M=10^3K=10^6 1G=10^3M=10^9 Ki=2^10 Mi=2^10Ki=2^20 Gi=2^10Mi=2^30","title":"MB_MiB\u7684\u533a\u522b"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","text":"1000\u884c MySQL \u5b66\u4e60\u7b14\u8bb0\uff0c\u4e0d\u6015\u4f60\u4e0d\u4f1a\uff0c\u5c31\u6015\u4f60\u4e0d\u5b66\uff01 \u00b6 \u539f\u6587 \u8fde\u63a5\u4e0e\u65ad\u5f00\u670d\u52a1\u5668 \u00b6 mysql -h \u5730\u5740 -P \u7aef\u53e3 -u \u7528\u6237\u540d -p \u5bc6\u7801 SHOW PROCESSLIST -- \u663e\u793a\u54ea\u4e9b\u7ebf\u7a0b\u6b63\u5728\u8fd0\u884c SHOW VARIABLES -- \u663e\u793a\u7cfb\u7edf\u53d8\u91cf\u4fe1\u606f \u6570\u636e\u5e93\u64cd\u4f5c \u00b6 -- \u67e5\u770b\u5f53\u524d\u6570\u636e\u5e93 SELECT DATABASE(); -- \u663e\u793a\u5f53\u524d\u65f6\u95f4\u3001\u7528\u6237\u540d\u3001\u6570\u636e\u5e93\u7248\u672c SELECT now(), user(), version(); -- \u521b\u5efa\u5e93 CREATE DATABASE[ IF NOT EXISTS] \u6570\u636e\u5e93\u540d \u6570\u636e\u5e93\u9009\u9879 \u6570\u636e\u5e93\u9009\u9879\uff1a CHARACTER SET charset_name COLLATE collation_name -- \u67e5\u770b\u5df2\u6709\u5e93 SHOW DATABASES[ LIKE PATTERN ] -- \u67e5\u770b\u5f53\u524d\u5e93\u4fe1\u606f SHOW CREATE DATABASE \u6570\u636e\u5e93\u540d -- \u4fee\u6539\u5e93\u7684\u9009\u9879\u4fe1\u606f ALTER DATABASE \u5e93\u540d \u9009\u9879\u4fe1\u606f -- \u5220\u9664\u5e93 DROP DATABASE[ IF EXISTS] \u6570\u636e\u5e93\u540d \u540c\u65f6\u5220\u9664\u8be5\u6570\u636e\u5e93\u76f8\u5173\u7684\u76ee\u5f55\u53ca\u5176\u76ee\u5f55\u5185\u5bb9 \u8868\u7684\u64cd\u4f5c \u00b6 -- \u521b\u5efa\u8868 CREATE [TEMPORARY] TABLE[ IF NOT EXISTS] [\u5e93\u540d.]\u8868\u540d ( \u8868\u7684\u7ed3\u6784\u5b9a\u4e49 )[ \u8868\u9009\u9879] \u6bcf\u4e2a\u5b57\u6bb5\u5fc5\u987b\u6709\u6570\u636e\u7c7b\u578b \u6700\u540e\u4e00\u4e2a\u5b57\u6bb5\u540e\u4e0d\u80fd\u6709\u9017\u53f7 TEMPORARY \u4e34\u65f6\u8868\uff0c\u4f1a\u8bdd\u7ed3\u675f\u65f6\u8868\u81ea\u52a8\u6d88\u5931 \u5bf9\u4e8e\u5b57\u6bb5\u7684\u5b9a\u4e49\uff1a \u5b57\u6bb5\u540d \u6570\u636e\u7c7b\u578b [NOT NULL | NULL] [DEFAULT default_value] [AUTO_INCREMENT] [UNIQUE [KEY] | [PRIMARY] KEY] [COMMENT string ] -- \u8868\u9009\u9879 -- \u5b57\u7b26\u96c6 CHARSET = charset_name \u5982\u679c\u8868\u6ca1\u6709\u8bbe\u5b9a\uff0c\u5219\u4f7f\u7528\u6570\u636e\u5e93\u5b57\u7b26\u96c6 -- \u5b58\u50a8\u5f15\u64ce ENGINE = engine_name \u8868\u5728\u7ba1\u7406\u6570\u636e\u65f6\u91c7\u7528\u7684\u4e0d\u540c\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7ed3\u6784\u4e0d\u540c\u4f1a\u5bfc\u81f4\u5904\u7406\u65b9\u5f0f\u3001\u63d0\u4f9b\u7684\u7279\u6027\u64cd\u4f5c\u7b49\u4e0d\u540c \u5e38\u89c1\u7684\u5f15\u64ce\uff1aInnoDB MyISAM Memory/Heap BDB Merge Example CSV MaxDB Archive \u4e0d\u540c\u7684\u5f15\u64ce\u5728\u4fdd\u5b58\u8868\u7684\u7ed3\u6784\u548c\u6570\u636e\u65f6\u91c7\u7528\u4e0d\u540c\u7684\u65b9\u5f0f MyISAM\u8868\u6587\u4ef6\u542b\u4e49\uff1a.frm\u8868\u5b9a\u4e49\uff0c.MYD\u8868\u6570\u636e\uff0c.MYI\u8868\u7d22\u5f15 InnoDB\u8868\u6587\u4ef6\u542b\u4e49\uff1a.frm\u8868\u5b9a\u4e49\uff0c\u8868\u7a7a\u95f4\u6570\u636e\u548c\u65e5\u5fd7\u6587\u4ef6 SHOW ENGINES -- \u663e\u793a\u5b58\u50a8\u5f15\u64ce\u7684\u72b6\u6001\u4fe1\u606f SHOW ENGINE \u5f15\u64ce\u540d {LOGS|STATUS} -- \u663e\u793a\u5b58\u50a8\u5f15\u64ce\u7684\u65e5\u5fd7\u6216\u72b6\u6001\u4fe1\u606f -- \u81ea\u589e\u8d77\u59cb\u6570 AUTO_INCREMENT = \u884c\u6570 -- \u6570\u636e\u6587\u4ef6\u76ee\u5f55 DATA DIRECTORY = \u76ee\u5f55 -- \u7d22\u5f15\u6587\u4ef6\u76ee\u5f55 INDEX DIRECTORY = \u76ee\u5f55 -- \u8868\u6ce8\u91ca COMMENT = string -- \u5206\u533a\u9009\u9879 PARTITION BY ... (\u8be6\u7ec6\u89c1\u624b\u518c) -- \u67e5\u770b\u6240\u6709\u8868 SHOW TABLES[ LIKE pattern ] SHOW TABLES FROM \u8868\u540d -- \u67e5\u770b\u8868\u673a\u6784 SHOW CREATE TABLE \u8868\u540d \uff08\u4fe1\u606f\u66f4\u8be6\u7ec6\uff09 DESC \u8868\u540d / DESCRIBE \u8868\u540d / EXPLAIN \u8868\u540d / SHOW COLUMNS FROM \u8868\u540d [LIKE PATTERN ] SHOW TABLE STATUS [FROM db_name] [LIKE pattern ] -- \u4fee\u6539\u8868 -- \u4fee\u6539\u8868\u672c\u8eab\u7684\u9009\u9879 ALTER TABLE \u8868\u540d \u8868\u7684\u9009\u9879 eg: ALTER TABLE \u8868\u540d ENGINE=MYISAM; -- \u5bf9\u8868\u8fdb\u884c\u91cd\u547d\u540d RENAME TABLE \u539f\u8868\u540d TO \u65b0\u8868\u540d RENAME TABLE \u539f\u8868\u540d TO \u5e93\u540d.\u8868\u540d \uff08\u53ef\u5c06\u8868\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u6570\u636e\u5e93\uff09 -- RENAME\u53ef\u4ee5\u4ea4\u6362\u4e24\u4e2a\u8868\u540d -- \u4fee\u6539\u8868\u7684\u5b57\u6bb5\u673a\u6784\uff0813.1.2. ALTER TABLE\u8bed\u6cd5\uff09 ALTER TABLE \u8868\u540d \u64cd\u4f5c\u540d -- \u64cd\u4f5c\u540d ADD[ COLUMN] \u5b57\u6bb5\u5b9a\u4e49 -- \u589e\u52a0\u5b57\u6bb5 AFTER \u5b57\u6bb5\u540d -- \u8868\u793a\u589e\u52a0\u5728\u8be5\u5b57\u6bb5\u540d\u540e\u9762 FIRST -- \u8868\u793a\u589e\u52a0\u5728\u7b2c\u4e00\u4e2a ADD PRIMARY KEY(\u5b57\u6bb5\u540d) -- \u521b\u5efa\u4e3b\u952e ADD UNIQUE [\u7d22\u5f15\u540d] (\u5b57\u6bb5\u540d)-- \u521b\u5efa\u552f\u4e00\u7d22\u5f15 ADD INDEX [\u7d22\u5f15\u540d] (\u5b57\u6bb5\u540d) -- \u521b\u5efa\u666e\u901a\u7d22\u5f15 DROP[ COLUMN] \u5b57\u6bb5\u540d -- \u5220\u9664\u5b57\u6bb5 MODIFY[ COLUMN] \u5b57\u6bb5\u540d \u5b57\u6bb5\u5c5e\u6027 -- \u652f\u6301\u5bf9\u5b57\u6bb5\u5c5e\u6027\u8fdb\u884c\u4fee\u6539\uff0c\u4e0d\u80fd\u4fee\u6539\u5b57\u6bb5\u540d(\u6240\u6709\u539f\u6709\u5c5e\u6027\u4e5f\u9700\u5199\u4e0a) CHANGE[ COLUMN] \u539f\u5b57\u6bb5\u540d \u65b0\u5b57\u6bb5\u540d \u5b57\u6bb5\u5c5e\u6027 -- \u652f\u6301\u5bf9\u5b57\u6bb5\u540d\u4fee\u6539 DROP PRIMARY KEY -- \u5220\u9664\u4e3b\u952e(\u5220\u9664\u4e3b\u952e\u524d\u9700\u5220\u9664\u5176AUTO_INCREMENT\u5c5e\u6027) DROP INDEX \u7d22\u5f15\u540d -- \u5220\u9664\u7d22\u5f15 DROP FOREIGN KEY \u5916\u952e -- \u5220\u9664\u5916\u952e -- \u5220\u9664\u8868 DROP TABLE[ IF EXISTS] \u8868\u540d ... -- \u6e05\u7a7a\u8868\u6570\u636e TRUNCATE [TABLE] \u8868\u540d -- \u590d\u5236\u8868\u7ed3\u6784 CREATE TABLE \u8868\u540d LIKE \u8981\u590d\u5236\u7684\u8868\u540d -- \u590d\u5236\u8868\u7ed3\u6784\u548c\u6570\u636e CREATE TABLE \u8868\u540d [AS] SELECT * FROM \u8981\u590d\u5236\u7684\u8868\u540d -- \u68c0\u67e5\u8868\u662f\u5426\u6709\u9519\u8bef CHECK TABLE tbl_name [, tbl_name] ... [option] ... -- \u4f18\u5316\u8868 OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... -- \u4fee\u590d\u8868 REPAIR [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... [QUICK] [EXTENDED] [USE_FRM] -- \u5206\u6790\u8868 ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... \u6570\u636e\u64cd\u4f5c \u00b6 -- \u589e INSERT [INTO] \u8868\u540d [(\u5b57\u6bb5\u5217\u8868)] VALUES (\u503c\u5217\u8868)[, (\u503c\u5217\u8868), ...] -- \u5982\u679c\u8981\u63d2\u5165\u7684\u503c\u5217\u8868\u5305\u542b\u6240\u6709\u5b57\u6bb5\u5e76\u4e14\u987a\u5e8f\u4e00\u81f4\uff0c\u5219\u53ef\u4ee5\u7701\u7565\u5b57\u6bb5\u5217\u8868\u3002 -- \u53ef\u540c\u65f6\u63d2\u5165\u591a\u6761\u6570\u636e\u8bb0\u5f55\uff01 REPLACE \u4e0e INSERT \u5b8c\u5168\u4e00\u6837\uff0c\u53ef\u4e92\u6362\u3002 INSERT [INTO] \u8868\u540d SET \u5b57\u6bb5\u540d=\u503c[, \u5b57\u6bb5\u540d=\u503c, ...] -- \u67e5 SELECT \u5b57\u6bb5\u5217\u8868 FROM \u8868\u540d[ \u5176\u4ed6\u5b50\u53e5] -- \u53ef\u6765\u81ea\u591a\u4e2a\u8868\u7684\u591a\u4e2a\u5b57\u6bb5 -- \u5176\u4ed6\u5b50\u53e5\u53ef\u4ee5\u4e0d\u4f7f\u7528 -- \u5b57\u6bb5\u5217\u8868\u53ef\u4ee5\u7528*\u4ee3\u66ff\uff0c\u8868\u793a\u6240\u6709\u5b57\u6bb5 -- \u5220 DELETE FROM \u8868\u540d[ \u5220\u9664\u6761\u4ef6\u5b50\u53e5] \u6ca1\u6709\u6761\u4ef6\u5b50\u53e5\uff0c\u5219\u4f1a\u5220\u9664\u5168\u90e8 -- \u6539 UPDATE \u8868\u540d SET \u5b57\u6bb5\u540d=\u65b0\u503c[, \u5b57\u6bb5\u540d=\u65b0\u503c] [\u66f4\u65b0\u6761\u4ef6] \u5b57\u7b26\u96c6\u7f16\u7801 \u00b6 -- MySQL\u3001\u6570\u636e\u5e93\u3001\u8868\u3001\u5b57\u6bb5\u5747\u53ef\u8bbe\u7f6e\u7f16\u7801 -- \u6570\u636e\u7f16\u7801\u4e0e\u5ba2\u6237\u7aef\u7f16\u7801\u4e0d\u9700\u4e00\u81f4 SHOW VARIABLES LIKE character_set_% -- \u67e5\u770b\u6240\u6709\u5b57\u7b26\u96c6\u7f16\u7801\u9879 character_set_client \u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u9001\u6570\u636e\u65f6\u4f7f\u7528\u7684\u7f16\u7801 character_set_results \u670d\u52a1\u5668\u7aef\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u6240\u4f7f\u7528\u7684\u7f16\u7801 character_set_connection \u8fde\u63a5\u5c42\u7f16\u7801 SET \u53d8\u91cf\u540d = \u53d8\u91cf\u503c SET character_set_client = gbk; SET character_set_results = gbk; SET character_set_connection = gbk; SET NAMES GBK; -- \u76f8\u5f53\u4e8e\u5b8c\u6210\u4ee5\u4e0a\u4e09\u4e2a\u8bbe\u7f6e -- \u6821\u5bf9\u96c6 \u6821\u5bf9\u96c6\u7528\u4ee5\u6392\u5e8f SHOW CHARACTER SET [LIKE pattern ]/SHOW CHARSET [LIKE pattern ] \u67e5\u770b\u6240\u6709\u5b57\u7b26\u96c6 SHOW COLLATION [LIKE pattern ] \u67e5\u770b\u6240\u6709\u6821\u5bf9\u96c6 CHARSET \u5b57\u7b26\u96c6\u7f16\u7801 \u8bbe\u7f6e\u5b57\u7b26\u96c6\u7f16\u7801 COLLATE \u6821\u5bf9\u96c6\u7f16\u7801 \u8bbe\u7f6e\u6821\u5bf9\u96c6\u7f16\u7801 \u6570\u636e\u7c7b\u578b\uff08\u5217\u7c7b\u578b\uff09 \u00b6 \u6570\u503c\u7c7b\u578b -- a. \u6574\u578b ---------- \u7c7b\u578b \u5b57\u8282 \u8303\u56f4\uff08\u6709\u7b26\u53f7\u4f4d\uff09 tinyint 1\u5b57\u8282 -128 ~ 127 \u65e0\u7b26\u53f7\u4f4d\uff1a0 ~ 255 smallint 2\u5b57\u8282 -32768 ~ 32767 mediumint 3\u5b57\u8282 -8388608 ~ 8388607 int 4\u5b57\u8282 bigint 8\u5b57\u8282 int(M) M\u8868\u793a\u603b\u4f4d\u6570 - \u9ed8\u8ba4\u5b58\u5728\u7b26\u53f7\u4f4d\uff0cunsigned \u5c5e\u6027\u4fee\u6539 - \u663e\u793a\u5bbd\u5ea6\uff0c\u5982\u679c\u67d0\u4e2a\u6570\u4e0d\u591f\u5b9a\u4e49\u5b57\u6bb5\u65f6\u8bbe\u7f6e\u7684\u4f4d\u6570\uff0c\u5219\u524d\u9762\u4ee50\u8865\u586b\uff0czerofill \u5c5e\u6027\u4fee\u6539 \u4f8b\uff1aint(5) \u63d2\u5165\u4e00\u4e2a\u6570 123 \uff0c\u8865\u586b\u540e\u4e3a 00123 - \u5728\u6ee1\u8db3\u8981\u6c42\u7684\u60c5\u51b5\u4e0b\uff0c\u8d8a\u5c0f\u8d8a\u597d\u3002 - 1\u8868\u793abool\u503c\u771f\uff0c0\u8868\u793abool\u503c\u5047\u3002MySQL\u6ca1\u6709\u5e03\u5c14\u7c7b\u578b\uff0c\u901a\u8fc7\u6574\u578b0\u548c1\u8868\u793a\u3002\u5e38\u7528tinyint(1)\u8868\u793a\u5e03\u5c14\u578b\u3002 -- b. \u6d6e\u70b9\u578b ---------- \u7c7b\u578b \u5b57\u8282 \u8303\u56f4 float(\u5355\u7cbe\u5ea6) 4\u5b57\u8282 double(\u53cc\u7cbe\u5ea6) 8\u5b57\u8282 \u6d6e\u70b9\u578b\u65e2\u652f\u6301\u7b26\u53f7\u4f4d unsigned \u5c5e\u6027\uff0c\u4e5f\u652f\u6301\u663e\u793a\u5bbd\u5ea6 zerofill \u5c5e\u6027\u3002 \u4e0d\u540c\u4e8e\u6574\u578b\uff0c\u524d\u540e\u5747\u4f1a\u8865\u586b0. \u5b9a\u4e49\u6d6e\u70b9\u578b\u65f6\uff0c\u9700\u6307\u5b9a\u603b\u4f4d\u6570\u548c\u5c0f\u6570\u4f4d\u6570\u3002 float(M, D) double(M, D) M\u8868\u793a\u603b\u4f4d\u6570\uff0cD\u8868\u793a\u5c0f\u6570\u4f4d\u6570\u3002 M\u548cD\u7684\u5927\u5c0f\u4f1a\u51b3\u5b9a\u6d6e\u70b9\u6570\u7684\u8303\u56f4\u3002\u4e0d\u540c\u4e8e\u6574\u578b\u7684\u56fa\u5b9a\u8303\u56f4\u3002 M\u65e2\u8868\u793a\u603b\u4f4d\u6570\uff08\u4e0d\u5305\u62ec\u5c0f\u6570\u70b9\u548c\u6b63\u8d1f\u53f7\uff09\uff0c\u4e5f\u8868\u793a\u663e\u793a\u5bbd\u5ea6\uff08\u6240\u6709\u663e\u793a\u7b26\u53f7\u5747\u5305\u62ec\uff09\u3002 \u652f\u6301\u79d1\u5b66\u8ba1\u6570\u6cd5\u8868\u793a\u3002 \u6d6e\u70b9\u6570\u8868\u793a\u8fd1\u4f3c\u503c\u3002 -- c. \u5b9a\u70b9\u6570 ---------- decimal -- \u53ef\u53d8\u957f\u5ea6 decimal(M, D) M\u4e5f\u8868\u793a\u603b\u4f4d\u6570\uff0cD\u8868\u793a\u5c0f\u6570\u4f4d\u6570\u3002 \u4fdd\u5b58\u4e00\u4e2a\u7cbe\u786e\u7684\u6570\u503c\uff0c\u4e0d\u4f1a\u53d1\u751f\u6570\u636e\u7684\u6539\u53d8\uff0c\u4e0d\u540c\u4e8e\u6d6e\u70b9\u6570\u7684\u56db\u820d\u4e94\u5165\u3002 \u5c06\u6d6e\u70b9\u6570\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u6765\u4fdd\u5b58\uff0c\u6bcf9\u4f4d\u6570\u5b57\u4fdd\u5b58\u4e3a4\u4e2a\u5b57\u8282\u3002 \u5b57\u7b26\u4e32\u7c7b\u578b -- a. char, varchar ---------- char \u5b9a\u957f\u5b57\u7b26\u4e32\uff0c\u901f\u5ea6\u5feb\uff0c\u4f46\u6d6a\u8d39\u7a7a\u95f4 varchar \u53d8\u957f\u5b57\u7b26\u4e32\uff0c\u901f\u5ea6\u6162\uff0c\u4f46\u8282\u7701\u7a7a\u95f4 M\u8868\u793a\u80fd\u5b58\u50a8\u7684\u6700\u5927\u957f\u5ea6\uff0c\u6b64\u957f\u5ea6\u662f\u5b57\u7b26\u6570\uff0c\u975e\u5b57\u8282\u6570\u3002 \u4e0d\u540c\u7684\u7f16\u7801\uff0c\u6240\u5360\u7528\u7684\u7a7a\u95f4\u4e0d\u540c\u3002 char,\u6700\u591a255\u4e2a\u5b57\u7b26\uff0c\u4e0e\u7f16\u7801\u65e0\u5173\u3002 varchar,\u6700\u591a65535\u5b57\u7b26\uff0c\u4e0e\u7f16\u7801\u6709\u5173\u3002 \u4e00\u6761\u6709\u6548\u8bb0\u5f55\u6700\u5927\u4e0d\u80fd\u8d85\u8fc765535\u4e2a\u5b57\u8282\u3002 utf8 \u6700\u5927\u4e3a21844\u4e2a\u5b57\u7b26\uff0cgbk \u6700\u5927\u4e3a32766\u4e2a\u5b57\u7b26\uff0clatin1 \u6700\u5927\u4e3a65532\u4e2a\u5b57\u7b26 varchar \u662f\u53d8\u957f\u7684\uff0c\u9700\u8981\u5229\u7528\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58 varchar \u7684\u957f\u5ea6\uff0c\u5982\u679c\u6570\u636e\u5c0f\u4e8e255\u4e2a\u5b57\u8282\uff0c\u5219\u91c7\u7528\u4e00\u4e2a\u5b57\u8282\u6765\u4fdd\u5b58\u957f\u5ea6\uff0c\u53cd\u4e4b\u9700\u8981\u4e24\u4e2a\u5b57\u8282\u6765\u4fdd\u5b58\u3002 varchar \u7684\u6700\u5927\u6709\u6548\u957f\u5ea6\u7531\u6700\u5927\u884c\u5927\u5c0f\u548c\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u786e\u5b9a\u3002 \u6700\u5927\u6709\u6548\u957f\u5ea6\u662f65532\u5b57\u8282\uff0c\u56e0\u4e3a\u5728varchar\u5b58\u5b57\u7b26\u4e32\u65f6\uff0c\u7b2c\u4e00\u4e2a\u5b57\u8282\u662f\u7a7a\u7684\uff0c\u4e0d\u5b58\u5728\u4efb\u4f55\u6570\u636e\uff0c\u7136\u540e\u8fd8\u9700\u4e24\u4e2a\u5b57\u8282\u6765\u5b58\u653e\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u6240\u4ee5\u6709\u6548\u957f\u5ea6\u662f64432-1-2=65532\u5b57\u8282\u3002 \u4f8b\uff1a\u82e5\u4e00\u4e2a\u8868\u5b9a\u4e49\u4e3a CREATE TABLE tb(c1 int, c2 char(30), c3 varchar(N)) charset=utf8; \u95eeN\u7684\u6700\u5927\u503c\u662f\u591a\u5c11\uff1f \u7b54\uff1a(65535-1-2-4-30*3)/3 -- b. blob, text ---------- blob \u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff08\u5b57\u8282\u5b57\u7b26\u4e32\uff09 tinyblob, blob, mediumblob, longblob text \u975e\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff08\u5b57\u7b26\u5b57\u7b26\u4e32\uff09 tinytext, text, mediumtext, longtext text \u5728\u5b9a\u4e49\u65f6\uff0c\u4e0d\u9700\u8981\u5b9a\u4e49\u957f\u5ea6\uff0c\u4e5f\u4e0d\u4f1a\u8ba1\u7b97\u603b\u957f\u5ea6\u3002 text \u7c7b\u578b\u5728\u5b9a\u4e49\u65f6\uff0c\u4e0d\u53ef\u7ed9default\u503c -- c. binary, varbinary ---------- \u7c7b\u4f3c\u4e8echar\u548cvarchar\uff0c\u7528\u4e8e\u4fdd\u5b58\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff0c\u4e5f\u5c31\u662f\u4fdd\u5b58\u5b57\u8282\u5b57\u7b26\u4e32\u800c\u975e\u5b57\u7b26\u5b57\u7b26\u4e32\u3002 char, varchar, text \u5bf9\u5e94 binary, varbinary, blob. \u65e5\u671f\u65f6\u95f4\u7c7b\u578b \u4e00\u822c\u7528\u6574\u578b\u4fdd\u5b58\u65f6\u95f4\u6233\uff0c\u56e0\u4e3aPHP\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5c06\u65f6\u95f4\u6233\u8fdb\u884c\u683c\u5f0f\u5316\u3002 datetime 8\u5b57\u8282 \u65e5\u671f\u53ca\u65f6\u95f4 1000-01-01 00:00:00 \u5230 9999-12-31 23:59:59 date 3\u5b57\u8282 \u65e5\u671f 1000-01-01 \u5230 9999-12-31 timestamp 4\u5b57\u8282 \u65f6\u95f4\u6233 19700101000000 \u5230 2038-01-19 03:14:07 time 3\u5b57\u8282 \u65f6\u95f4 -838:59:59 \u5230 838:59:59 year 1\u5b57\u8282 \u5e74\u4efd 1901 - 2155 datetime YYYY-MM-DD hh:mm:ss timestamp YY-MM-DD hh:mm:ss YYYYMMDDhhmmss YYMMDDhhmmss YYYYMMDDhhmmss YYMMDDhhmmss date YYYY-MM-DD YY-MM-DD YYYYMMDD YYMMDD YYYYMMDD YYMMDD time hh:mm:ss hhmmss hhmmss year YYYY YY YYYY YY \u679a\u4e3e\u548c\u96c6\u5408 -- \u679a\u4e3e(enum) ---------- enum(val1, val2, val3...) \u5728\u5df2\u77e5\u7684\u503c\u4e2d\u8fdb\u884c\u5355\u9009\u3002\u6700\u5927\u6570\u91cf\u4e3a65535. \u679a\u4e3e\u503c\u5728\u4fdd\u5b58\u65f6\uff0c\u4ee52\u4e2a\u5b57\u8282\u7684\u6574\u578b(smallint)\u4fdd\u5b58\u3002\u6bcf\u4e2a\u679a\u4e3e\u503c\uff0c\u6309\u4fdd\u5b58\u7684\u4f4d\u7f6e\u987a\u5e8f\uff0c\u4ece1\u5f00\u59cb\u9010\u4e00\u9012\u589e\u3002 \u8868\u73b0\u4e3a\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u5b58\u50a8\u5374\u662f\u6574\u578b\u3002 NULL\u503c\u7684\u7d22\u5f15\u662fNULL\u3002 \u7a7a\u5b57\u7b26\u4e32\u9519\u8bef\u503c\u7684\u7d22\u5f15\u503c\u662f0\u3002 -- \u96c6\u5408\uff08set\uff09 ---------- set(val1, val2, val3...) create table tab ( gender set( \u7537 , \u5973 , \u65e0 ) ); insert into tab values ( \u7537, \u5973 ); \u6700\u591a\u53ef\u4ee5\u670964\u4e2a\u4e0d\u540c\u7684\u6210\u5458\u3002\u4ee5bigint\u5b58\u50a8\uff0c\u51718\u4e2a\u5b57\u8282\u3002\u91c7\u53d6\u4f4d\u8fd0\u7b97\u7684\u5f62\u5f0f\u3002 \u5f53\u521b\u5efa\u8868\u65f6\uff0cSET\u6210\u5458\u503c\u7684\u5c3e\u90e8\u7a7a\u683c\u5c06\u81ea\u52a8\u88ab\u5220\u9664\u3002 \u9009\u62e9\u7c7b\u578b \u00b6 -- PHP\u89d2\u5ea6 1. \u529f\u80fd\u6ee1\u8db3 2. \u5b58\u50a8\u7a7a\u95f4\u5c3d\u91cf\u5c0f\uff0c\u5904\u7406\u6548\u7387\u66f4\u9ad8 3. \u8003\u8651\u517c\u5bb9\u95ee\u9898 -- IP\u5b58\u50a8 ---------- 1. \u53ea\u9700\u5b58\u50a8\uff0c\u53ef\u7528\u5b57\u7b26\u4e32 2. \u5982\u679c\u9700\u8ba1\u7b97\uff0c\u67e5\u627e\u7b49\uff0c\u53ef\u5b58\u50a8\u4e3a4\u4e2a\u5b57\u8282\u7684\u65e0\u7b26\u53f7int\uff0c\u5373unsigned 1) PHP\u51fd\u6570\u8f6c\u6362 ip2long\u53ef\u8f6c\u6362\u4e3a\u6574\u578b\uff0c\u4f46\u4f1a\u51fa\u73b0\u643a\u5e26\u7b26\u53f7\u95ee\u9898\u3002\u9700\u683c\u5f0f\u5316\u4e3a\u65e0\u7b26\u53f7\u7684\u6574\u578b\u3002 \u5229\u7528sprintf\u51fd\u6570\u683c\u5f0f\u5316\u5b57\u7b26\u4e32 sprintf(\"%u\", ip2long( 192.168.3.134 )); \u7136\u540e\u7528long2ip\u5c06\u6574\u578b\u8f6c\u56deIP\u5b57\u7b26\u4e32 2) MySQL\u51fd\u6570\u8f6c\u6362(\u65e0\u7b26\u53f7\u6574\u578b\uff0cUNSIGNED) INET_ATON( 127.0.0.1 ) \u5c06IP\u8f6c\u4e3a\u6574\u578b INET_NTOA(2130706433) \u5c06\u6574\u578b\u8f6c\u4e3aIP \u5217\u5c5e\u6027\uff08\u5217\u7ea6\u675f\uff09 \u00b6 1. PRIMARY \u4e3b\u952e - \u80fd\u552f\u4e00\u6807\u8bc6\u8bb0\u5f55\u7684\u5b57\u6bb5\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e3b\u952e\u3002 - \u4e00\u4e2a\u8868\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u952e\u3002 - \u4e3b\u952e\u5177\u6709\u552f\u4e00\u6027\u3002 - \u58f0\u660e\u5b57\u6bb5\u65f6\uff0c\u7528 primary key \u6807\u8bc6\u3002 \u4e5f\u53ef\u4ee5\u5728\u5b57\u6bb5\u5217\u8868\u4e4b\u540e\u58f0\u660e \u4f8b\uff1acreate table tab ( id int, stu varchar(10), primary key (id)); - \u4e3b\u952e\u5b57\u6bb5\u7684\u503c\u4e0d\u80fd\u4e3anull\u3002 - \u4e3b\u952e\u53ef\u4ee5\u7531\u591a\u4e2a\u5b57\u6bb5\u5171\u540c\u7ec4\u6210\u3002\u6b64\u65f6\u9700\u8981\u5728\u5b57\u6bb5\u5217\u8868\u540e\u58f0\u660e\u7684\u65b9\u6cd5\u3002 \u4f8b\uff1acreate table tab ( id int, stu varchar(10), age int, primary key (stu, age)); 2. UNIQUE \u552f\u4e00\u7d22\u5f15\uff08\u552f\u4e00\u7ea6\u675f\uff09 \u4f7f\u5f97\u67d0\u5b57\u6bb5\u7684\u503c\u4e5f\u4e0d\u80fd\u91cd\u590d\u3002 3. NULL \u7ea6\u675f null\u4e0d\u662f\u6570\u636e\u7c7b\u578b\uff0c\u662f\u5217\u7684\u4e00\u4e2a\u5c5e\u6027\u3002 \u8868\u793a\u5f53\u524d\u5217\u662f\u5426\u53ef\u4ee5\u4e3anull\uff0c\u8868\u793a\u4ec0\u4e48\u90fd\u6ca1\u6709\u3002 null, \u5141\u8bb8\u4e3a\u7a7a\u3002\u9ed8\u8ba4\u3002 not null, \u4e0d\u5141\u8bb8\u4e3a\u7a7a\u3002 insert into tab values (null, val ); -- \u6b64\u65f6\u8868\u793a\u5c06\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u7684\u503c\u8bbe\u4e3anull, \u53d6\u51b3\u4e8e\u8be5\u5b57\u6bb5\u662f\u5426\u5141\u8bb8\u4e3anull 4. DEFAULT \u9ed8\u8ba4\u503c\u5c5e\u6027 \u5f53\u524d\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002 insert into tab values (default, val ); -- \u6b64\u65f6\u8868\u793a\u5f3a\u5236\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002 create table tab ( add_time timestamp default current_timestamp ); -- \u8868\u793a\u5c06\u5f53\u524d\u65f6\u95f4\u7684\u65f6\u95f4\u6233\u8bbe\u4e3a\u9ed8\u8ba4\u503c\u3002 current_date, current_time 5. AUTO_INCREMENT \u81ea\u52a8\u589e\u957f\u7ea6\u675f \u81ea\u52a8\u589e\u957f\u5fc5\u987b\u4e3a\u7d22\u5f15\uff08\u4e3b\u952e\u6216unique\uff09 \u53ea\u80fd\u5b58\u5728\u4e00\u4e2a\u5b57\u6bb5\u4e3a\u81ea\u52a8\u589e\u957f\u3002 \u9ed8\u8ba4\u4e3a1\u5f00\u59cb\u81ea\u52a8\u589e\u957f\u3002\u53ef\u4ee5\u901a\u8fc7\u8868\u5c5e\u6027 auto_increment = x\u8fdb\u884c\u8bbe\u7f6e\uff0c\u6216 alter table tbl auto_increment = x; 6. COMMENT \u6ce8\u91ca \u4f8b\uff1acreate table tab ( id int ) comment \u6ce8\u91ca\u5185\u5bb9 ; 7. FOREIGN KEY \u5916\u952e\u7ea6\u675f \u7528\u4e8e\u9650\u5236\u4e3b\u8868\u4e0e\u4ece\u8868\u6570\u636e\u5b8c\u6574\u6027\u3002 alter table t1 add constraint `t1_t2_fk` foreign key (t1_id) references t2(id); -- \u5c06\u8868t1\u7684t1_id\u5916\u952e\u5173\u8054\u5230\u8868t2\u7684id\u5b57\u6bb5\u3002 -- \u6bcf\u4e2a\u5916\u952e\u90fd\u6709\u4e00\u4e2a\u540d\u5b57\uff0c\u53ef\u4ee5\u901a\u8fc7 constraint \u6307\u5b9a \u5b58\u5728\u5916\u952e\u7684\u8868\uff0c\u79f0\u4e4b\u4e3a\u4ece\u8868\uff08\u5b50\u8868\uff09\uff0c\u5916\u952e\u6307\u5411\u7684\u8868\uff0c\u79f0\u4e4b\u4e3a\u4e3b\u8868\uff08\u7236\u8868\uff09\u3002 \u4f5c\u7528\uff1a\u4fdd\u6301\u6570\u636e\u4e00\u81f4\u6027\uff0c\u5b8c\u6574\u6027\uff0c\u4e3b\u8981\u76ee\u7684\u662f\u63a7\u5236\u5b58\u50a8\u5728\u5916\u952e\u8868\uff08\u4ece\u8868\uff09\u4e2d\u7684\u6570\u636e\u3002 MySQL\u4e2d\uff0c\u53ef\u4ee5\u5bf9InnoDB\u5f15\u64ce\u4f7f\u7528\u5916\u952e\u7ea6\u675f\uff1a \u8bed\u6cd5\uff1a foreign key (\u5916\u952e\u5b57\u6bb5\uff09 references \u4e3b\u8868\u540d (\u5173\u8054\u5b57\u6bb5) [\u4e3b\u8868\u8bb0\u5f55\u5220\u9664\u65f6\u7684\u52a8\u4f5c] [\u4e3b\u8868\u8bb0\u5f55\u66f4\u65b0\u65f6\u7684\u52a8\u4f5c] \u6b64\u65f6\u9700\u8981\u68c0\u6d4b\u4e00\u4e2a\u4ece\u8868\u7684\u5916\u952e\u9700\u8981\u7ea6\u675f\u4e3a\u4e3b\u8868\u7684\u5df2\u5b58\u5728\u7684\u503c\u3002\u5916\u952e\u5728\u6ca1\u6709\u5173\u8054\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3anull.\u524d\u63d0\u662f\u8be5\u5916\u952e\u5217\uff0c\u6ca1\u6709not null\u3002 \u53ef\u4ee5\u4e0d\u6307\u5b9a\u4e3b\u8868\u8bb0\u5f55\u66f4\u6539\u6216\u66f4\u65b0\u65f6\u7684\u52a8\u4f5c\uff0c\u90a3\u4e48\u6b64\u65f6\u4e3b\u8868\u7684\u64cd\u4f5c\u88ab\u62d2\u7edd\u3002 \u5982\u679c\u6307\u5b9a\u4e86 on update \u6216 on delete\uff1a\u5728\u5220\u9664\u6216\u66f4\u65b0\u65f6\uff0c\u6709\u5982\u4e0b\u51e0\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u9009\u62e9\uff1a 1. cascade\uff0c\u7ea7\u8054\u64cd\u4f5c\u3002\u4e3b\u8868\u6570\u636e\u88ab\u66f4\u65b0\uff08\u4e3b\u952e\u503c\u66f4\u65b0\uff09\uff0c\u4ece\u8868\u4e5f\u88ab\u66f4\u65b0\uff08\u5916\u952e\u503c\u66f4\u65b0\uff09\u3002\u4e3b\u8868\u8bb0\u5f55\u88ab\u5220\u9664\uff0c\u4ece\u8868\u76f8\u5173\u8bb0\u5f55\u4e5f\u88ab\u5220\u9664\u3002 2. set null\uff0c\u8bbe\u7f6e\u4e3anull\u3002\u4e3b\u8868\u6570\u636e\u88ab\u66f4\u65b0\uff08\u4e3b\u952e\u503c\u66f4\u65b0\uff09\uff0c\u4ece\u8868\u7684\u5916\u952e\u88ab\u8bbe\u7f6e\u4e3anull\u3002\u4e3b\u8868\u8bb0\u5f55\u88ab\u5220\u9664\uff0c\u4ece\u8868\u76f8\u5173\u8bb0\u5f55\u5916\u952e\u88ab\u8bbe\u7f6e\u6210null\u3002\u4f46\u6ce8\u610f\uff0c\u8981\u6c42\u8be5\u5916\u952e\u5217\uff0c\u6ca1\u6709not null\u5c5e\u6027\u7ea6\u675f\u3002 3. restrict\uff0c\u62d2\u7edd\u7236\u8868\u5220\u9664\u548c\u66f4\u65b0\u3002 \u6ce8\u610f\uff0c\u5916\u952e\u53ea\u88abInnoDB\u5b58\u50a8\u5f15\u64ce\u6240\u652f\u6301\u3002\u5176\u4ed6\u5f15\u64ce\u662f\u4e0d\u652f\u6301\u7684\u3002 \u5efa\u8868\u89c4\u8303 \u00b6 -- Normal Format, NF - \u6bcf\u4e2a\u8868\u4fdd\u5b58\u4e00\u4e2a\u5b9e\u4f53\u4fe1\u606f - \u6bcf\u4e2a\u5177\u6709\u4e00\u4e2aID\u5b57\u6bb5\u4f5c\u4e3a\u4e3b\u952e - ID\u4e3b\u952e + \u539f\u5b50\u8868 -- 1NF, \u7b2c\u4e00\u8303\u5f0f \u5b57\u6bb5\u4e0d\u80fd\u518d\u5206\uff0c\u5c31\u6ee1\u8db3\u7b2c\u4e00\u8303\u5f0f\u3002 -- 2NF, \u7b2c\u4e8c\u8303\u5f0f \u6ee1\u8db3\u7b2c\u4e00\u8303\u5f0f\u7684\u524d\u63d0\u4e0b\uff0c\u4e0d\u80fd\u51fa\u73b0\u90e8\u5206\u4f9d\u8d56\u3002 \u6d88\u9664\u7b26\u5408\u4e3b\u952e\u5c31\u53ef\u4ee5\u907f\u514d\u90e8\u5206\u4f9d\u8d56\u3002\u589e\u52a0\u5355\u5217\u5173\u952e\u5b57\u3002 -- 3NF, \u7b2c\u4e09\u8303\u5f0f \u6ee1\u8db3\u7b2c\u4e8c\u8303\u5f0f\u7684\u524d\u63d0\u4e0b\uff0c\u4e0d\u80fd\u51fa\u73b0\u4f20\u9012\u4f9d\u8d56\u3002 \u67d0\u4e2a\u5b57\u6bb5\u4f9d\u8d56\u4e8e\u4e3b\u952e\uff0c\u800c\u6709\u5176\u4ed6\u5b57\u6bb5\u4f9d\u8d56\u4e8e\u8be5\u5b57\u6bb5\u3002\u8fd9\u5c31\u662f\u4f20\u9012\u4f9d\u8d56\u3002 \u5c06\u4e00\u4e2a\u5b9e\u4f53\u4fe1\u606f\u7684\u6570\u636e\u653e\u5728\u4e00\u4e2a\u8868\u5185\u5b9e\u73b0\u3002 SELECT \u00b6 SELECT [ALL|DISTINCT] select_expr FROM -> WHERE -> GROUP BY [\u5408\u8ba1\u51fd\u6570] -> HAVING -> ORDER BY -> LIMIT a. select_expr -- \u53ef\u4ee5\u7528 * \u8868\u793a\u6240\u6709\u5b57\u6bb5\u3002 select * from tb; -- \u53ef\u4ee5\u4f7f\u7528\u8868\u8fbe\u5f0f\uff08\u8ba1\u7b97\u516c\u5f0f\u3001\u51fd\u6570\u8c03\u7528\u3001\u5b57\u6bb5\u4e5f\u662f\u4e2a\u8868\u8fbe\u5f0f\uff09 select stu, 29+25, now() from tb; -- \u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u5217\u4f7f\u7528\u522b\u540d\u3002\u9002\u7528\u4e8e\u7b80\u5316\u5217\u6807\u8bc6\uff0c\u907f\u514d\u591a\u4e2a\u5217\u6807\u8bc6\u7b26\u91cd\u590d\u3002 - \u4f7f\u7528 as \u5173\u952e\u5b57\uff0c\u4e5f\u53ef\u7701\u7565 as. select stu+10 as add10 from tb; b. FROM \u5b50\u53e5 \u7528\u4e8e\u6807\u8bc6\u67e5\u8be2\u6765\u6e90\u3002 -- \u53ef\u4ee5\u4e3a\u8868\u8d77\u522b\u540d\u3002\u4f7f\u7528as\u5173\u952e\u5b57\u3002 SELECT * FROM tb1 AS tt, tb2 AS bb; -- from\u5b50\u53e5\u540e\uff0c\u53ef\u4ee5\u540c\u65f6\u51fa\u73b0\u591a\u4e2a\u8868\u3002 -- \u591a\u4e2a\u8868\u4f1a\u6a2a\u5411\u53e0\u52a0\u5230\u4e00\u8d77\uff0c\u800c\u6570\u636e\u4f1a\u5f62\u6210\u4e00\u4e2a\u7b1b\u5361\u5c14\u79ef\u3002 SELECT * FROM tb1, tb2; -- \u5411\u4f18\u5316\u7b26\u63d0\u793a\u5982\u4f55\u9009\u62e9\u7d22\u5f15 USE INDEX\u3001IGNORE INDEX\u3001FORCE INDEX SELECT * FROM table1 USE INDEX (key1,key2) WHERE key1=1 AND key2=2 AND key3=3; SELECT * FROM table1 IGNORE INDEX (key3) WHERE key1=1 AND key2=2 AND key3=3; c. WHERE \u5b50\u53e5 -- \u4ecefrom\u83b7\u5f97\u7684\u6570\u636e\u6e90\u4e2d\u8fdb\u884c\u7b5b\u9009\u3002 -- \u6574\u578b1\u8868\u793a\u771f\uff0c0\u8868\u793a\u5047\u3002 -- \u8868\u8fbe\u5f0f\u7531\u8fd0\u7b97\u7b26\u548c\u8fd0\u7b97\u6570\u7ec4\u6210\u3002 -- \u8fd0\u7b97\u6570\uff1a\u53d8\u91cf\uff08\u5b57\u6bb5\uff09\u3001\u503c\u3001\u51fd\u6570\u8fd4\u56de\u503c -- \u8fd0\u7b97\u7b26\uff1a =, <=>, <>, !=, <=, <, >=, >, !, &&, ||, in (not) null, (not) like, (not) in, (not) between and, is (not), and, or, not, xor is/is not \u52a0\u4e0ature/false/unknown\uff0c\u68c0\u9a8c\u67d0\u4e2a\u503c\u7684\u771f\u5047 <=>\u4e0e<>\u529f\u80fd\u76f8\u540c\uff0c<=>\u53ef\u7528\u4e8enull\u6bd4\u8f83 d. GROUP BY \u5b50\u53e5, \u5206\u7ec4\u5b50\u53e5 GROUP BY \u5b57\u6bb5/\u522b\u540d [\u6392\u5e8f\u65b9\u5f0f] \u5206\u7ec4\u540e\u4f1a\u8fdb\u884c\u6392\u5e8f\u3002\u5347\u5e8f\uff1aASC\uff0c\u964d\u5e8f\uff1aDESC \u4ee5\u4e0b[\u5408\u8ba1\u51fd\u6570]\u9700\u914d\u5408 GROUP BY \u4f7f\u7528\uff1a count \u8fd4\u56de\u4e0d\u540c\u7684\u975eNULL\u503c\u6570\u76ee count(*)\u3001count(\u5b57\u6bb5) sum \u6c42\u548c max \u6c42\u6700\u5927\u503c min \u6c42\u6700\u5c0f\u503c avg \u6c42\u5e73\u5747\u503c group_concat \u8fd4\u56de\u5e26\u6709\u6765\u81ea\u4e00\u4e2a\u7ec4\u7684\u8fde\u63a5\u7684\u975eNULL\u503c\u7684\u5b57\u7b26\u4e32\u7ed3\u679c\u3002\u7ec4\u5185\u5b57\u7b26\u4e32\u8fde\u63a5\u3002 e. HAVING \u5b50\u53e5\uff0c\u6761\u4ef6\u5b50\u53e5 \u4e0e where \u529f\u80fd\u3001\u7528\u6cd5\u76f8\u540c\uff0c\u6267\u884c\u65f6\u673a\u4e0d\u540c\u3002 where \u5728\u5f00\u59cb\u65f6\u6267\u884c\u68c0\u6d4b\u6570\u636e\uff0c\u5bf9\u539f\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\u3002 having \u5bf9\u7b5b\u9009\u51fa\u7684\u7ed3\u679c\u518d\u6b21\u8fdb\u884c\u8fc7\u6ee4\u3002 having \u5b57\u6bb5\u5fc5\u987b\u662f\u67e5\u8be2\u51fa\u6765\u7684\uff0cwhere \u5b57\u6bb5\u5fc5\u987b\u662f\u6570\u636e\u8868\u5b58\u5728\u7684\u3002 where \u4e0d\u53ef\u4ee5\u4f7f\u7528\u5b57\u6bb5\u7684\u522b\u540d\uff0chaving \u53ef\u4ee5\u3002\u56e0\u4e3a\u6267\u884cWHERE\u4ee3\u7801\u65f6\uff0c\u53ef\u80fd\u5c1a\u672a\u786e\u5b9a\u5217\u503c\u3002 where \u4e0d\u53ef\u4ee5\u4f7f\u7528\u5408\u8ba1\u51fd\u6570\u3002\u4e00\u822c\u9700\u7528\u5408\u8ba1\u51fd\u6570\u624d\u4f1a\u7528 having SQL\u6807\u51c6\u8981\u6c42HAVING\u5fc5\u987b\u5f15\u7528GROUP BY\u5b50\u53e5\u4e2d\u7684\u5217\u6216\u7528\u4e8e\u5408\u8ba1\u51fd\u6570\u4e2d\u7684\u5217\u3002 f. ORDER BY \u5b50\u53e5\uff0c\u6392\u5e8f\u5b50\u53e5 order by \u6392\u5e8f\u5b57\u6bb5/\u522b\u540d \u6392\u5e8f\u65b9\u5f0f [,\u6392\u5e8f\u5b57\u6bb5/\u522b\u540d \u6392\u5e8f\u65b9\u5f0f]... \u5347\u5e8f\uff1aASC\uff0c\u964d\u5e8f\uff1aDESC \u652f\u6301\u591a\u4e2a\u5b57\u6bb5\u7684\u6392\u5e8f\u3002 g. LIMIT \u5b50\u53e5\uff0c\u9650\u5236\u7ed3\u679c\u6570\u91cf\u5b50\u53e5 \u4ec5\u5bf9\u5904\u7406\u597d\u7684\u7ed3\u679c\u8fdb\u884c\u6570\u91cf\u9650\u5236\u3002\u5c06\u5904\u7406\u597d\u7684\u7ed3\u679c\u7684\u770b\u4f5c\u662f\u4e00\u4e2a\u96c6\u5408\uff0c\u6309\u7167\u8bb0\u5f55\u51fa\u73b0\u7684\u987a\u5e8f\uff0c\u7d22\u5f15\u4ece0\u5f00\u59cb\u3002 limit \u8d77\u59cb\u4f4d\u7f6e, \u83b7\u53d6\u6761\u6570 \u7701\u7565\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u8868\u793a\u4ece\u7d22\u5f150\u5f00\u59cb\u3002limit \u83b7\u53d6\u6761\u6570 h. DISTINCT, ALL \u9009\u9879 distinct \u53bb\u9664\u91cd\u590d\u8bb0\u5f55 \u9ed8\u8ba4\u4e3a all, \u5168\u90e8\u8bb0\u5f55 UNION \u00b6 \u5c06\u591a\u4e2aselect\u67e5\u8be2\u7684\u7ed3\u679c\u7ec4\u5408\u6210\u4e00\u4e2a\u7ed3\u679c\u96c6\u5408\u3002 SELECT ... UNION [ALL|DISTINCT] SELECT ... \u9ed8\u8ba4 DISTINCT \u65b9\u5f0f\uff0c\u5373\u6240\u6709\u8fd4\u56de\u7684\u884c\u90fd\u662f\u552f\u4e00\u7684 \u5efa\u8bae\uff0c\u5bf9\u6bcf\u4e2aSELECT\u67e5\u8be2\u52a0\u4e0a\u5c0f\u62ec\u53f7\u5305\u88f9\u3002 ORDER BY \u6392\u5e8f\u65f6\uff0c\u9700\u52a0\u4e0a LIMIT \u8fdb\u884c\u7ed3\u5408\u3002 \u9700\u8981\u5404select\u67e5\u8be2\u7684\u5b57\u6bb5\u6570\u91cf\u4e00\u6837\u3002 \u6bcf\u4e2aselect\u67e5\u8be2\u7684\u5b57\u6bb5\u5217\u8868(\u6570\u91cf\u3001\u7c7b\u578b)\u5e94\u4e00\u81f4\uff0c\u56e0\u4e3a\u7ed3\u679c\u4e2d\u7684\u5b57\u6bb5\u540d\u4ee5\u7b2c\u4e00\u6761select\u8bed\u53e5\u4e3a\u51c6\u3002 \u5b50\u67e5\u8be2 \u00b6 - \u5b50\u67e5\u8be2\u9700\u7528\u62ec\u53f7\u5305\u88f9\u3002 -- from\u578b from\u540e\u8981\u6c42\u662f\u4e00\u4e2a\u8868\uff0c\u5fc5\u987b\u7ed9\u5b50\u67e5\u8be2\u7ed3\u679c\u53d6\u4e2a\u522b\u540d\u3002 - \u7b80\u5316\u6bcf\u4e2a\u67e5\u8be2\u5185\u7684\u6761\u4ef6\u3002 - from\u578b\u9700\u5c06\u7ed3\u679c\u751f\u6210\u4e00\u4e2a\u4e34\u65f6\u8868\u683c\uff0c\u53ef\u7528\u4ee5\u539f\u8868\u7684\u9501\u5b9a\u7684\u91ca\u653e\u3002 - \u5b50\u67e5\u8be2\u8fd4\u56de\u4e00\u4e2a\u8868\uff0c\u8868\u578b\u5b50\u67e5\u8be2\u3002 select * from (select * from tb where id>0) as subfrom where id>1; -- where\u578b - \u5b50\u67e5\u8be2\u8fd4\u56de\u4e00\u4e2a\u503c\uff0c\u6807\u91cf\u5b50\u67e5\u8be2\u3002 - \u4e0d\u9700\u8981\u7ed9\u5b50\u67e5\u8be2\u53d6\u522b\u540d\u3002 - where\u5b50\u67e5\u8be2\u5185\u7684\u8868\uff0c\u4e0d\u80fd\u76f4\u63a5\u7528\u4ee5\u66f4\u65b0\u3002 select * from tb where money = (select max(money) from tb); -- \u5217\u5b50\u67e5\u8be2 \u5982\u679c\u5b50\u67e5\u8be2\u7ed3\u679c\u8fd4\u56de\u7684\u662f\u4e00\u5217\u3002 \u4f7f\u7528 in \u6216 not in \u5b8c\u6210\u67e5\u8be2 exists \u548c not exists \u6761\u4ef6 \u5982\u679c\u5b50\u67e5\u8be2\u8fd4\u56de\u6570\u636e\uff0c\u5219\u8fd4\u56de1\u62160\u3002\u5e38\u7528\u4e8e\u5224\u65ad\u6761\u4ef6\u3002 select column1 from t1 where exists (select * from t2); -- \u884c\u5b50\u67e5\u8be2 \u67e5\u8be2\u6761\u4ef6\u662f\u4e00\u4e2a\u884c\u3002 select * from t1 where (id, gender) in (select id, gender from t2); \u884c\u6784\u9020\u7b26\uff1a(col1, col2, ...) \u6216 ROW(col1, col2, ...) \u884c\u6784\u9020\u7b26\u901a\u5e38\u7528\u4e8e\u4e0e\u5bf9\u80fd\u8fd4\u56de\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u5217\u7684\u5b50\u67e5\u8be2\u8fdb\u884c\u6bd4\u8f83\u3002 -- \u7279\u6b8a\u8fd0\u7b97\u7b26 != all() \u76f8\u5f53\u4e8e not in = some() \u76f8\u5f53\u4e8e in\u3002any \u662f some \u7684\u522b\u540d != some() \u4e0d\u7b49\u540c\u4e8e not in\uff0c\u4e0d\u7b49\u4e8e\u5176\u4e2d\u67d0\u4e00\u4e2a\u3002 all, some \u53ef\u4ee5\u914d\u5408\u5176\u4ed6\u8fd0\u7b97\u7b26\u4e00\u8d77\u4f7f\u7528\u3002 \u8fde\u63a5\u67e5\u8be2(join) \u00b6 \u5c06\u591a\u4e2a\u8868\u7684\u5b57\u6bb5\u8fdb\u884c\u8fde\u63a5\uff0c\u53ef\u4ee5\u6307\u5b9a\u8fde\u63a5\u6761\u4ef6\u3002 -- \u5185\u8fde\u63a5(inner join) - \u9ed8\u8ba4\u5c31\u662f\u5185\u8fde\u63a5\uff0c\u53ef\u7701\u7565inner\u3002 - \u53ea\u6709\u6570\u636e\u5b58\u5728\u65f6\u624d\u80fd\u53d1\u9001\u8fde\u63a5\u3002\u5373\u8fde\u63a5\u7ed3\u679c\u4e0d\u80fd\u51fa\u73b0\u7a7a\u884c\u3002 on \u8868\u793a\u8fde\u63a5\u6761\u4ef6\u3002\u5176\u6761\u4ef6\u8868\u8fbe\u5f0f\u4e0ewhere\u7c7b\u4f3c\u3002\u4e5f\u53ef\u4ee5\u7701\u7565\u6761\u4ef6\uff08\u8868\u793a\u6761\u4ef6\u6c38\u8fdc\u4e3a\u771f\uff09 \u4e5f\u53ef\u7528where\u8868\u793a\u8fde\u63a5\u6761\u4ef6\u3002 \u8fd8\u6709 using, \u4f46\u9700\u5b57\u6bb5\u540d\u76f8\u540c\u3002 using(\u5b57\u6bb5\u540d) -- \u4ea4\u53c9\u8fde\u63a5 cross join \u5373\uff0c\u6ca1\u6709\u6761\u4ef6\u7684\u5185\u8fde\u63a5\u3002 select * from tb1 cross join tb2; -- \u5916\u8fde\u63a5(outer join) - \u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u4e5f\u4f1a\u51fa\u73b0\u5728\u8fde\u63a5\u7ed3\u679c\u4e2d\u3002 -- \u5de6\u5916\u8fde\u63a5 left join \u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u5de6\u8868\u8bb0\u5f55\u4f1a\u51fa\u73b0\uff0c\u800c\u53f3\u8868\u4e3anull\u586b\u5145 -- \u53f3\u5916\u8fde\u63a5 right join \u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u53f3\u8868\u8bb0\u5f55\u4f1a\u51fa\u73b0\uff0c\u800c\u5de6\u8868\u4e3anull\u586b\u5145 -- \u81ea\u7136\u8fde\u63a5(natural join) \u81ea\u52a8\u5224\u65ad\u8fde\u63a5\u6761\u4ef6\u5b8c\u6210\u8fde\u63a5\u3002 \u76f8\u5f53\u4e8e\u7701\u7565\u4e86using\uff0c\u4f1a\u81ea\u52a8\u67e5\u627e\u76f8\u540c\u5b57\u6bb5\u540d\u3002 natural join natural left join natural right join select info.id, info.name, info.stu_num, extra_info.hobby, extra_info.sex from info, extra_info where info.stu_num = extra_info.stu_id; \u5bfc\u51fa \u00b6 select * into outfile \u6587\u4ef6\u5730\u5740 [\u63a7\u5236\u683c\u5f0f] from \u8868\u540d; -- \u5bfc\u51fa\u8868\u6570\u636e load data [local] infile \u6587\u4ef6\u5730\u5740 [replace|ignore] into table \u8868\u540d [\u63a7\u5236\u683c\u5f0f]; -- \u5bfc\u5165\u6570\u636e \u751f\u6210\u7684\u6570\u636e\u9ed8\u8ba4\u7684\u5206\u9694\u7b26\u662f\u5236\u8868\u7b26 local\u672a\u6307\u5b9a\uff0c\u5219\u6570\u636e\u6587\u4ef6\u5fc5\u987b\u5728\u670d\u52a1\u5668\u4e0a replace \u548c ignore \u5173\u952e\u8bcd\u63a7\u5236\u5bf9\u73b0\u6709\u7684\u552f\u4e00\u952e\u8bb0\u5f55\u7684\u91cd\u590d\u7684\u5904\u7406 -- \u63a7\u5236\u683c\u5f0f fields \u63a7\u5236\u5b57\u6bb5\u683c\u5f0f \u9ed8\u8ba4\uff1afields terminated by enclosed by escaped by terminated by string -- \u7ec8\u6b62 enclosed by char -- \u5305\u88f9 escaped by char -- \u8f6c\u4e49 -- \u793a\u4f8b\uff1a SELECT a,b,a+b INTO OUTFILE /tmp/result.text FIELDS TERMINATED BY , OPTIONALLY ENCLOSED BY \" LINES TERMINATED BY FROM test_table; lines \u63a7\u5236\u884c\u683c\u5f0f \u9ed8\u8ba4\uff1alines terminated by terminated by string -- \u7ec8\u6b62 INSERT \u00b6 select\u8bed\u53e5\u83b7\u5f97\u7684\u6570\u636e\u53ef\u4ee5\u7528insert\u63d2\u5165\u3002 \u53ef\u4ee5\u7701\u7565\u5bf9\u5217\u7684\u6307\u5b9a\uff0c\u8981\u6c42 values () \u62ec\u53f7\u5185\uff0c\u63d0\u4f9b\u7ed9\u4e86\u6309\u7167\u5217\u987a\u5e8f\u51fa\u73b0\u7684\u6240\u6709\u5b57\u6bb5\u7684\u503c\u3002 \u6216\u8005\u4f7f\u7528set\u8bed\u6cd5\u3002 INSERT INTO tbl_name SET field=value,...\uff1b \u53ef\u4ee5\u4e00\u6b21\u6027\u4f7f\u7528\u591a\u4e2a\u503c\uff0c\u91c7\u7528(), (), ();\u7684\u5f62\u5f0f\u3002 INSERT INTO tbl_name VALUES (), (), (); \u53ef\u4ee5\u5728\u5217\u503c\u6307\u5b9a\u65f6\uff0c\u4f7f\u7528\u8868\u8fbe\u5f0f\u3002 INSERT INTO tbl_name VALUES (field_value, 10+10, now()); \u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u7279\u6b8a\u503c DEFAULT\uff0c\u8868\u793a\u8be5\u5217\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002 INSERT INTO tbl_name VALUES (field_value, DEFAULT); \u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u4f5c\u4e3a\u9700\u8981\u63d2\u5165\u7684\u503c\u3002 INSERT INTO tbl_name SELECT ...; \u53ef\u4ee5\u6307\u5b9a\u5728\u63d2\u5165\u7684\u503c\u51fa\u73b0\u4e3b\u952e\uff08\u6216\u552f\u4e00\u7d22\u5f15\uff09\u51b2\u7a81\u65f6\uff0c\u66f4\u65b0\u5176\u4ed6\u975e\u4e3b\u952e\u5217\u7684\u4fe1\u606f\u3002 INSERT INTO tbl_name VALUES/SET/SELECT ON DUPLICATE KEY UPDATE \u5b57\u6bb5=\u503c, \u2026; DELETE \u00b6 DELETE FROM tbl_name [WHERE where_definition] [ORDER BY ...] [LIMIT row_count] \u6309\u7167\u6761\u4ef6\u5220\u9664\u3002where \u6307\u5b9a\u5220\u9664\u7684\u6700\u591a\u8bb0\u5f55\u6570\u3002limit \u53ef\u4ee5\u901a\u8fc7\u6392\u5e8f\u6761\u4ef6\u5220\u9664\u3002order by + limit \u652f\u6301\u591a\u8868\u5220\u9664\uff0c\u4f7f\u7528\u7c7b\u4f3c\u8fde\u63a5\u8bed\u6cd5\u3002 delete from \u9700\u8981\u5220\u9664\u6570\u636e\u591a\u88681\uff0c\u88682 using \u8868\u8fde\u63a5\u64cd\u4f5c \u6761\u4ef6\u3002 TRUNCATE \u00b6 TRUNCATE [TABLE] tbl_name \u6e05\u7a7a\u6570\u636e \u5220\u9664\u91cd\u5efa\u8868 \u533a\u522b\uff1a 1\uff0ctruncate \u662f\u5220\u9664\u8868\u518d\u521b\u5efa\uff0cdelete \u662f\u9010\u6761\u5220\u9664 2\uff0ctruncate \u91cd\u7f6eauto_increment\u7684\u503c\u3002\u800cdelete\u4e0d\u4f1a 3\uff0ctruncate \u4e0d\u77e5\u9053\u5220\u9664\u4e86\u51e0\u6761\uff0c\u800cdelete\u77e5\u9053\u3002 4\uff0c\u5f53\u88ab\u7528\u4e8e\u5e26\u5206\u533a\u7684\u8868\u65f6\uff0ctruncate \u4f1a\u4fdd\u7559\u5206\u533a \u5907\u4efd\u4e0e\u8fd8\u539f \u00b6 \u5907\u4efd\uff0c\u5c06\u6570\u636e\u7684\u7ed3\u6784\u4e0e\u8868\u5185\u6570\u636e\u4fdd\u5b58\u8d77\u6765\u3002 \u5229\u7528 mysqldump \u6307\u4ee4\u5b8c\u6210\u3002 -- \u5bfc\u51fa mysqldump [options] db_name [tables] mysqldump [options] ---database DB1 [DB2 DB3...] mysqldump [options] --all--database 1. \u5bfc\u51fa\u4e00\u5f20\u8868 mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d \u8868\u540d > \u6587\u4ef6\u540d(D:/a.sql) 2. \u5bfc\u51fa\u591a\u5f20\u8868 mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d \u88681 \u88682 \u88683 > \u6587\u4ef6\u540d(D:/a.sql) 3. \u5bfc\u51fa\u6240\u6709\u8868 mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d > \u6587\u4ef6\u540d(D:/a.sql) 4. \u5bfc\u51fa\u4e00\u4e2a\u5e93 mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 --lock-all-tables --database \u5e93\u540d > \u6587\u4ef6\u540d(D:/a.sql) \u53ef\u4ee5-w\u643a\u5e26WHERE\u6761\u4ef6 -- \u5bfc\u5165 1. \u5728\u767b\u5f55mysql\u7684\u60c5\u51b5\u4e0b\uff1a source \u5907\u4efd\u6587\u4ef6 2. \u5728\u4e0d\u767b\u5f55\u7684\u60c5\u51b5\u4e0b mysql -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d < \u5907\u4efd\u6587\u4ef6 \u89c6\u56fe \u00b6 \u4ec0\u4e48\u662f\u89c6\u56fe\uff1a \u89c6\u56fe\u662f\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u5176\u5185\u5bb9\u7531\u67e5\u8be2\u5b9a\u4e49\u3002\u540c\u771f\u5b9e\u7684\u8868\u4e00\u6837\uff0c\u89c6\u56fe\u5305\u542b\u4e00\u7cfb\u5217\u5e26\u6709\u540d\u79f0\u7684\u5217\u548c\u884c\u6570\u636e\u3002\u4f46\u662f\uff0c\u89c6\u56fe\u5e76\u4e0d\u5728\u6570\u636e\u5e93\u4e2d\u4ee5\u5b58\u50a8\u7684\u6570\u636e\u503c\u96c6\u5f62\u5f0f\u5b58\u5728\u3002\u884c\u548c\u5217\u6570\u636e\u6765\u81ea\u7531\u5b9a\u4e49\u89c6\u56fe\u7684\u67e5\u8be2\u6240\u5f15\u7528\u7684\u8868\uff0c\u5e76\u4e14\u5728\u5f15\u7528\u89c6\u56fe\u65f6\u52a8\u6001\u751f\u6210\u3002 \u89c6\u56fe\u5177\u6709\u8868\u7ed3\u6784\u6587\u4ef6\uff0c\u4f46\u4e0d\u5b58\u5728\u6570\u636e\u6587\u4ef6\u3002 \u5bf9\u5176\u4e2d\u6240\u5f15\u7528\u7684\u57fa\u7840\u8868\u6765\u8bf4\uff0c\u89c6\u56fe\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e\u7b5b\u9009\u3002\u5b9a\u4e49\u89c6\u56fe\u7684\u7b5b\u9009\u53ef\u4ee5\u6765\u81ea\u5f53\u524d\u6216\u5176\u5b83\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u8868\uff0c\u6216\u8005\u5176\u5b83\u89c6\u56fe\u3002\u901a\u8fc7\u89c6\u56fe\u8fdb\u884c\u67e5\u8be2\u6ca1\u6709\u4efb\u4f55\u9650\u5236\uff0c\u901a\u8fc7\u5b83\u4eec\u8fdb\u884c\u6570\u636e\u4fee\u6539\u65f6\u7684\u9650\u5236\u4e5f\u5f88\u5c11\u3002 \u89c6\u56fe\u662f\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u7684\u67e5\u8be2\u7684sql\u8bed\u53e5\uff0c\u5b83\u4e3b\u8981\u51fa\u4e8e\u4e24\u79cd\u539f\u56e0\uff1a\u5b89\u5168\u539f\u56e0\uff0c\u89c6\u56fe\u53ef\u4ee5\u9690\u85cf\u4e00\u4e9b\u6570\u636e\uff0c\u5982\uff1a\u793e\u4f1a\u4fdd\u9669\u57fa\u91d1\u8868\uff0c\u53ef\u4ee5\u7528\u89c6\u56fe\u53ea\u663e\u793a\u59d3\u540d\uff0c\u5730\u5740\uff0c\u800c\u4e0d\u663e\u793a\u793e\u4f1a\u4fdd\u9669\u53f7\u548c\u5de5\u8d44\u6570\u7b49\uff0c\u53e6\u4e00\u539f\u56e0\u662f\u53ef\u4f7f\u590d\u6742\u7684\u67e5\u8be2\u6613\u4e8e\u7406\u89e3\u548c\u4f7f\u7528\u3002 -- \u521b\u5efa\u89c6\u56fe CREATE [OR REPLACE] [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}] VIEW view_name [(column_list)] AS select_statement - \u89c6\u56fe\u540d\u5fc5\u987b\u552f\u4e00\uff0c\u540c\u65f6\u4e0d\u80fd\u4e0e\u8868\u91cd\u540d\u3002 - \u89c6\u56fe\u53ef\u4ee5\u4f7f\u7528select\u8bed\u53e5\u67e5\u8be2\u5230\u7684\u5217\u540d\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u6307\u5b9a\u76f8\u5e94\u7684\u5217\u540d\u3002 - \u53ef\u4ee5\u6307\u5b9a\u89c6\u56fe\u6267\u884c\u7684\u7b97\u6cd5\uff0c\u901a\u8fc7ALGORITHM\u6307\u5b9a\u3002 - column_list\u5982\u679c\u5b58\u5728\uff0c\u5219\u6570\u76ee\u5fc5\u987b\u7b49\u4e8eSELECT\u8bed\u53e5\u68c0\u7d22\u7684\u5217\u6570 -- \u67e5\u770b\u7ed3\u6784 SHOW CREATE VIEW view_name -- \u5220\u9664\u89c6\u56fe - \u5220\u9664\u89c6\u56fe\u540e\uff0c\u6570\u636e\u4f9d\u7136\u5b58\u5728\u3002 - \u53ef\u540c\u65f6\u5220\u9664\u591a\u4e2a\u89c6\u56fe\u3002 DROP VIEW [IF EXISTS] view_name ... -- \u4fee\u6539\u89c6\u56fe\u7ed3\u6784 - \u4e00\u822c\u4e0d\u4fee\u6539\u89c6\u56fe\uff0c\u56e0\u4e3a\u4e0d\u662f\u6240\u6709\u7684\u66f4\u65b0\u89c6\u56fe\u90fd\u4f1a\u6620\u5c04\u5230\u8868\u4e0a\u3002 ALTER VIEW view_name [(column_list)] AS select_statement -- \u89c6\u56fe\u4f5c\u7528 1. \u7b80\u5316\u4e1a\u52a1\u903b\u8f91 2. \u5bf9\u5ba2\u6237\u7aef\u9690\u85cf\u771f\u5b9e\u7684\u8868\u7ed3\u6784 -- \u89c6\u56fe\u7b97\u6cd5(ALGORITHM) MERGE \u5408\u5e76 \u5c06\u89c6\u56fe\u7684\u67e5\u8be2\u8bed\u53e5\uff0c\u4e0e\u5916\u90e8\u67e5\u8be2\u9700\u8981\u5148\u5408\u5e76\u518d\u6267\u884c\uff01 TEMPTABLE \u4e34\u65f6\u8868 \u5c06\u89c6\u56fe\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u5f62\u6210\u4e34\u65f6\u8868\uff0c\u518d\u505a\u5916\u5c42\u67e5\u8be2\uff01 UNDEFINED \u672a\u5b9a\u4e49(\u9ed8\u8ba4)\uff0c\u6307\u7684\u662fMySQL\u81ea\u4e3b\u53bb\u9009\u62e9\u76f8\u5e94\u7684\u7b97\u6cd5\u3002 \u4e8b\u52a1(transaction) \u00b6 \u4e8b\u52a1\u662f\u6307\u903b\u8f91\u4e0a\u7684\u4e00\u7ec4\u64cd\u4f5c\uff0c\u7ec4\u6210\u8fd9\u7ec4\u64cd\u4f5c\u7684\u5404\u4e2a\u5355\u5143\uff0c\u8981\u4e0d\u5168\u6210\u529f\u8981\u4e0d\u5168\u5931\u8d25\u3002 - \u652f\u6301\u8fde\u7eedSQL\u7684\u96c6\u4f53\u6210\u529f\u6216\u96c6\u4f53\u64a4\u9500\u3002 - \u4e8b\u52a1\u662f\u6570\u636e\u5e93\u5728\u6570\u636e\u665a\u81ea\u4e60\u65b9\u9762\u7684\u4e00\u4e2a\u529f\u80fd\u3002 - \u9700\u8981\u5229\u7528 InnoDB \u6216 BDB \u5b58\u50a8\u5f15\u64ce\uff0c\u5bf9\u81ea\u52a8\u63d0\u4ea4\u7684\u7279\u6027\u652f\u6301\u5b8c\u6210\u3002 - InnoDB\u88ab\u79f0\u4e3a\u4e8b\u52a1\u5b89\u5168\u578b\u5f15\u64ce\u3002 -- \u4e8b\u52a1\u5f00\u542f START TRANSACTION; \u6216\u8005 BEGIN; \u5f00\u542f\u4e8b\u52a1\u540e\uff0c\u6240\u6709\u88ab\u6267\u884c\u7684SQL\u8bed\u53e5\u5747\u88ab\u8ba4\u4f5c\u5f53\u524d\u4e8b\u52a1\u5185\u7684SQL\u8bed\u53e5\u3002 -- \u4e8b\u52a1\u63d0\u4ea4 COMMIT; -- \u4e8b\u52a1\u56de\u6eda ROLLBACK; \u5982\u679c\u90e8\u5206\u64cd\u4f5c\u53d1\u751f\u95ee\u9898\uff0c\u6620\u5c04\u5230\u4e8b\u52a1\u5f00\u542f\u524d\u3002 -- \u4e8b\u52a1\u7684\u7279\u6027 1. \u539f\u5b50\u6027\uff08Atomicity\uff09 \u4e8b\u52a1\u662f\u4e00\u4e2a\u4e0d\u53ef\u5206\u5272\u7684\u5de5\u4f5c\u5355\u4f4d\uff0c\u4e8b\u52a1\u4e2d\u7684\u64cd\u4f5c\u8981\u4e48\u90fd\u53d1\u751f\uff0c\u8981\u4e48\u90fd\u4e0d\u53d1\u751f\u3002 2. \u4e00\u81f4\u6027\uff08Consistency\uff09 \u4e8b\u52a1\u524d\u540e\u6570\u636e\u7684\u5b8c\u6574\u6027\u5fc5\u987b\u4fdd\u6301\u4e00\u81f4\u3002 - \u4e8b\u52a1\u5f00\u59cb\u548c\u7ed3\u675f\u65f6\uff0c\u5916\u90e8\u6570\u636e\u4e00\u81f4 - \u5728\u6574\u4e2a\u4e8b\u52a1\u8fc7\u7a0b\u4e2d\uff0c\u64cd\u4f5c\u662f\u8fde\u7eed\u7684 3. \u9694\u79bb\u6027\uff08Isolation\uff09 \u591a\u4e2a\u7528\u6237\u5e76\u53d1\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\uff0c\u4e00\u4e2a\u7528\u6237\u7684\u4e8b\u52a1\u4e0d\u80fd\u88ab\u5176\u5b83\u7528\u6237\u7684\u4e8b\u7269\u6240\u5e72\u6270\uff0c\u591a\u4e2a\u5e76\u53d1\u4e8b\u52a1\u4e4b\u95f4\u7684\u6570\u636e\u8981\u76f8\u4e92\u9694\u79bb\u3002 4. \u6301\u4e45\u6027\uff08Durability\uff09 \u4e00\u4e2a\u4e8b\u52a1\u4e00\u65e6\u88ab\u63d0\u4ea4\uff0c\u5b83\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u6539\u53d8\u5c31\u662f\u6c38\u4e45\u6027\u7684\u3002 -- \u4e8b\u52a1\u7684\u5b9e\u73b0 1. \u8981\u6c42\u662f\u4e8b\u52a1\u652f\u6301\u7684\u8868\u7c7b\u578b 2. \u6267\u884c\u4e00\u7ec4\u76f8\u5173\u7684\u64cd\u4f5c\u524d\u5f00\u542f\u4e8b\u52a1 3. \u6574\u7ec4\u64cd\u4f5c\u5b8c\u6210\u540e\uff0c\u90fd\u6210\u529f\uff0c\u5219\u63d0\u4ea4\uff1b\u5982\u679c\u5b58\u5728\u5931\u8d25\uff0c\u9009\u62e9\u56de\u6eda\uff0c\u5219\u4f1a\u56de\u5230\u4e8b\u52a1\u5f00\u59cb\u7684\u5907\u4efd\u70b9\u3002 -- \u4e8b\u52a1\u7684\u539f\u7406 \u5229\u7528InnoDB\u7684\u81ea\u52a8\u63d0\u4ea4(autocommit)\u7279\u6027\u5b8c\u6210\u3002 \u666e\u901a\u7684MySQL\u6267\u884c\u8bed\u53e5\u540e\uff0c\u5f53\u524d\u7684\u6570\u636e\u63d0\u4ea4\u64cd\u4f5c\u5747\u53ef\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u53ef\u89c1\u3002 \u800c\u4e8b\u52a1\u662f\u6682\u65f6\u5173\u95ed\u201c\u81ea\u52a8\u63d0\u4ea4\u201d\u673a\u5236\uff0c\u9700\u8981commit\u63d0\u4ea4\u6301\u4e45\u5316\u6570\u636e\u64cd\u4f5c\u3002 -- \u6ce8\u610f 1. \u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff08DDL\uff09\u8bed\u53e5\u4e0d\u80fd\u88ab\u56de\u6eda\uff0c\u6bd4\u5982\u521b\u5efa\u6216\u53d6\u6d88\u6570\u636e\u5e93\u7684\u8bed\u53e5\uff0c\u548c\u521b\u5efa\u3001\u53d6\u6d88\u6216\u66f4\u6539\u8868\u6216\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f\u7684\u8bed\u53e5\u3002 2. \u4e8b\u52a1\u4e0d\u80fd\u88ab\u5d4c\u5957 -- \u4fdd\u5b58\u70b9 SAVEPOINT \u4fdd\u5b58\u70b9\u540d\u79f0 -- \u8bbe\u7f6e\u4e00\u4e2a\u4e8b\u52a1\u4fdd\u5b58\u70b9 ROLLBACK TO SAVEPOINT \u4fdd\u5b58\u70b9\u540d\u79f0 -- \u56de\u6eda\u5230\u4fdd\u5b58\u70b9 RELEASE SAVEPOINT \u4fdd\u5b58\u70b9\u540d\u79f0 -- \u5220\u9664\u4fdd\u5b58\u70b9 -- InnoDB\u81ea\u52a8\u63d0\u4ea4\u7279\u6027\u8bbe\u7f6e SET autocommit = 0|1; 0\u8868\u793a\u5173\u95ed\u81ea\u52a8\u63d0\u4ea4\uff0c1\u8868\u793a\u5f00\u542f\u81ea\u52a8\u63d0\u4ea4\u3002 - \u5982\u679c\u5173\u95ed\u4e86\uff0c\u90a3\u666e\u901a\u64cd\u4f5c\u7684\u7ed3\u679c\u5bf9\u5176\u4ed6\u5ba2\u6237\u7aef\u4e5f\u4e0d\u53ef\u89c1\uff0c\u9700\u8981commit\u63d0\u4ea4\u540e\u624d\u80fd\u6301\u4e45\u5316\u6570\u636e\u64cd\u4f5c\u3002 - \u4e5f\u53ef\u4ee5\u5173\u95ed\u81ea\u52a8\u63d0\u4ea4\u6765\u5f00\u542f\u4e8b\u52a1\u3002\u4f46\u4e0eSTART TRANSACTION\u4e0d\u540c\u7684\u662f\uff0c SET autocommit\u662f\u6c38\u4e45\u6539\u53d8\u670d\u52a1\u5668\u7684\u8bbe\u7f6e\uff0c\u76f4\u5230\u4e0b\u6b21\u518d\u6b21\u4fee\u6539\u8be5\u8bbe\u7f6e\u3002(\u9488\u5bf9\u5f53\u524d\u8fde\u63a5) \u800cSTART TRANSACTION\u8bb0\u5f55\u5f00\u542f\u524d\u7684\u72b6\u6001\uff0c\u800c\u4e00\u65e6\u4e8b\u52a1\u63d0\u4ea4\u6216\u56de\u6eda\u540e\u5c31\u9700\u8981\u518d\u6b21\u5f00\u542f\u4e8b\u52a1\u3002(\u9488\u5bf9\u5f53\u524d\u4e8b\u52a1) \u9501\u8868 \u00b6 \u8868\u9501\u5b9a\u53ea\u7528\u4e8e\u9632\u6b62\u5176\u5b83\u5ba2\u6237\u7aef\u8fdb\u884c\u4e0d\u6b63\u5f53\u5730\u8bfb\u53d6\u548c\u5199\u5165 MyISAM \u652f\u6301\u8868\u9501\uff0cInnoDB \u652f\u6301\u884c\u9501 -- \u9501\u5b9a LOCK TABLES tbl_name [AS alias] -- \u89e3\u9501 UNLOCK TABLES \u89e6\u53d1\u5668 \u00b6 \u89e6\u53d1\u7a0b\u5e8f\u662f\u4e0e\u8868\u6709\u5173\u7684\u547d\u540d\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u5f53\u8be5\u8868\u51fa\u73b0\u7279\u5b9a\u4e8b\u4ef6\u65f6\uff0c\u5c06\u6fc0\u6d3b\u8be5\u5bf9\u8c61 \u76d1\u542c\uff1a\u8bb0\u5f55\u7684\u589e\u52a0\u3001\u4fee\u6539\u3001\u5220\u9664\u3002 -- \u521b\u5efa\u89e6\u53d1\u5668 CREATE TRIGGER trigger_name trigger_time trigger_event ON tbl_name FOR EACH ROW trigger_stmt \u53c2\u6570\uff1a trigger_time\u662f\u89e6\u53d1\u7a0b\u5e8f\u7684\u52a8\u4f5c\u65f6\u95f4\u3002\u5b83\u53ef\u4ee5\u662f before \u6216 after\uff0c\u4ee5\u6307\u660e\u89e6\u53d1\u7a0b\u5e8f\u662f\u5728\u6fc0\u6d3b\u5b83\u7684\u8bed\u53e5\u4e4b\u524d\u6216\u4e4b\u540e\u89e6\u53d1\u3002 trigger_event\u6307\u660e\u4e86\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f\u7684\u8bed\u53e5\u7684\u7c7b\u578b INSERT\uff1a\u5c06\u65b0\u884c\u63d2\u5165\u8868\u65f6\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f UPDATE\uff1a\u66f4\u6539\u67d0\u4e00\u884c\u65f6\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f DELETE\uff1a\u4ece\u8868\u4e2d\u5220\u9664\u67d0\u4e00\u884c\u65f6\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f tbl_name\uff1a\u76d1\u542c\u7684\u8868\uff0c\u5fc5\u987b\u662f\u6c38\u4e45\u6027\u7684\u8868\uff0c\u4e0d\u80fd\u5c06\u89e6\u53d1\u7a0b\u5e8f\u4e0eTEMPORARY\u8868\u6216\u89c6\u56fe\u5173\u8054\u8d77\u6765\u3002 trigger_stmt\uff1a\u5f53\u89e6\u53d1\u7a0b\u5e8f\u6fc0\u6d3b\u65f6\u6267\u884c\u7684\u8bed\u53e5\u3002\u6267\u884c\u591a\u4e2a\u8bed\u53e5\uff0c\u53ef\u4f7f\u7528BEGIN...END\u590d\u5408\u8bed\u53e5\u7ed3\u6784 -- \u5220\u9664 DROP TRIGGER [schema_name.]trigger_name \u53ef\u4ee5\u4f7f\u7528old\u548cnew\u4ee3\u66ff\u65e7\u7684\u548c\u65b0\u7684\u6570\u636e \u66f4\u65b0\u64cd\u4f5c\uff0c\u66f4\u65b0\u524d\u662fold\uff0c\u66f4\u65b0\u540e\u662fnew. \u5220\u9664\u64cd\u4f5c\uff0c\u53ea\u6709old. \u589e\u52a0\u64cd\u4f5c\uff0c\u53ea\u6709new. -- \u6ce8\u610f 1. \u5bf9\u4e8e\u5177\u6709\u76f8\u540c\u89e6\u53d1\u7a0b\u5e8f\u52a8\u4f5c\u65f6\u95f4\u548c\u4e8b\u4ef6\u7684\u7ed9\u5b9a\u8868\uff0c\u4e0d\u80fd\u6709\u4e24\u4e2a\u89e6\u53d1\u7a0b\u5e8f\u3002 -- \u5b57\u7b26\u8fde\u63a5\u51fd\u6570 concat(str1,str2,...]) concat_ws(separator,str1,str2,...) -- \u5206\u652f\u8bed\u53e5 if \u6761\u4ef6 then \u6267\u884c\u8bed\u53e5 elseif \u6761\u4ef6 then \u6267\u884c\u8bed\u53e5 else \u6267\u884c\u8bed\u53e5 end if; -- \u4fee\u6539\u6700\u5916\u5c42\u8bed\u53e5\u7ed3\u675f\u7b26 delimiter \u81ea\u5b9a\u4e49\u7ed3\u675f\u7b26\u53f7 SQL\u8bed\u53e5 \u81ea\u5b9a\u4e49\u7ed3\u675f\u7b26\u53f7 delimiter ; -- \u4fee\u6539\u56de\u539f\u6765\u7684\u5206\u53f7 -- \u8bed\u53e5\u5757\u5305\u88f9 begin \u8bed\u53e5\u5757 end -- \u7279\u6b8a\u7684\u6267\u884c 1. \u53ea\u8981\u6dfb\u52a0\u8bb0\u5f55\uff0c\u5c31\u4f1a\u89e6\u53d1\u7a0b\u5e8f\u3002 2. Insert into on duplicate key update \u8bed\u6cd5\u4f1a\u89e6\u53d1\uff1a \u5982\u679c\u6ca1\u6709\u91cd\u590d\u8bb0\u5f55\uff0c\u4f1a\u89e6\u53d1 before insert, after insert; \u5982\u679c\u6709\u91cd\u590d\u8bb0\u5f55\u5e76\u66f4\u65b0\uff0c\u4f1a\u89e6\u53d1 before insert, before update, after update; \u5982\u679c\u6709\u91cd\u590d\u8bb0\u5f55\u4f46\u662f\u6ca1\u6709\u53d1\u751f\u66f4\u65b0\uff0c\u5219\u89e6\u53d1 before insert, before update 3. Replace \u8bed\u6cd5 \u5982\u679c\u6709\u8bb0\u5f55\uff0c\u5219\u6267\u884c before insert, before delete, after delete, after insert SQL\u7f16\u7a0b \u00b6 --// \u5c40\u90e8\u53d8\u91cf ---------- -- \u53d8\u91cf\u58f0\u660e declare var_name[,...] type [default value] \u8fd9\u4e2a\u8bed\u53e5\u88ab\u7528\u6765\u58f0\u660e\u5c40\u90e8\u53d8\u91cf\u3002\u8981\u7ed9\u53d8\u91cf\u63d0\u4f9b\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u8bf7\u5305\u542b\u4e00\u4e2adefault\u5b50\u53e5\u3002\u503c\u53ef\u4ee5\u88ab\u6307\u5b9a\u4e3a\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u4e0d\u9700\u8981\u4e3a\u4e00\u4e2a\u5e38\u6570\u3002\u5982\u679c\u6ca1\u6709default\u5b50\u53e5\uff0c\u521d\u59cb\u503c\u4e3anull\u3002 -- \u8d4b\u503c \u4f7f\u7528 set \u548c select into \u8bed\u53e5\u4e3a\u53d8\u91cf\u8d4b\u503c\u3002 - \u6ce8\u610f\uff1a\u5728\u51fd\u6570\u5185\u662f\u53ef\u4ee5\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\uff08\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u53d8\u91cf\uff09 --// \u5168\u5c40\u53d8\u91cf ---------- -- \u5b9a\u4e49\u3001\u8d4b\u503c set \u8bed\u53e5\u53ef\u4ee5\u5b9a\u4e49\u5e76\u4e3a\u53d8\u91cf\u8d4b\u503c\u3002 set @var = value; \u4e5f\u53ef\u4ee5\u4f7f\u7528select into\u8bed\u53e5\u4e3a\u53d8\u91cf\u521d\u59cb\u5316\u5e76\u8d4b\u503c\u3002\u8fd9\u6837\u8981\u6c42select\u8bed\u53e5\u53ea\u80fd\u8fd4\u56de\u4e00\u884c\uff0c\u4f46\u662f\u53ef\u4ee5\u662f\u591a\u4e2a\u5b57\u6bb5\uff0c\u5c31\u610f\u5473\u7740\u540c\u65f6\u4e3a\u591a\u4e2a\u53d8\u91cf\u8fdb\u884c\u8d4b\u503c\uff0c\u53d8\u91cf\u7684\u6570\u91cf\u9700\u8981\u4e0e\u67e5\u8be2\u7684\u5217\u6570\u4e00\u81f4\u3002 \u8fd8\u53ef\u4ee5\u628a\u8d4b\u503c\u8bed\u53e5\u770b\u4f5c\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u901a\u8fc7select\u6267\u884c\u5b8c\u6210\u3002\u6b64\u65f6\u4e3a\u4e86\u907f\u514d=\u88ab\u5f53\u4f5c\u5173\u7cfb\u8fd0\u7b97\u7b26\u770b\u5f85\uff0c\u4f7f\u7528:=\u4ee3\u66ff\u3002\uff08set\u8bed\u53e5\u53ef\u4ee5\u4f7f\u7528= \u548c :=\uff09\u3002 select @var:=20; select @v1:=id, @v2=name from t1 limit 1; select * from tbl_name where @var:=30; select into \u53ef\u4ee5\u5c06\u8868\u4e2d\u67e5\u8be2\u83b7\u5f97\u7684\u6570\u636e\u8d4b\u7ed9\u53d8\u91cf\u3002 -| select max(height) into @max_height from tb; -- \u81ea\u5b9a\u4e49\u53d8\u91cf\u540d \u4e3a\u4e86\u907f\u514dselect\u8bed\u53e5\u4e2d\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u53d8\u91cf\u4e0e\u7cfb\u7edf\u6807\u8bc6\u7b26\uff08\u901a\u5e38\u662f\u5b57\u6bb5\u540d\uff09\u51b2\u7a81\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u53d8\u91cf\u5728\u53d8\u91cf\u540d\u524d\u4f7f\u7528@\u4f5c\u4e3a\u5f00\u59cb\u7b26\u53f7\u3002 @var=10; - \u53d8\u91cf\u88ab\u5b9a\u4e49\u540e\uff0c\u5728\u6574\u4e2a\u4f1a\u8bdd\u5468\u671f\u90fd\u6709\u6548\uff08\u767b\u5f55\u5230\u9000\u51fa\uff09 --// \u63a7\u5236\u7ed3\u6784 ---------- -- if\u8bed\u53e5 if search_condition then statement_list [elseif search_condition then statement_list] ... [else statement_list] end if; -- case\u8bed\u53e5 CASE value WHEN [compare-value] THEN result [WHEN [compare-value] THEN result ...] [ELSE result] END -- while\u5faa\u73af [begin_label:] while search_condition do statement_list end while [end_label]; - \u5982\u679c\u9700\u8981\u5728\u5faa\u73af\u5185\u63d0\u524d\u7ec8\u6b62 while\u5faa\u73af\uff0c\u5219\u9700\u8981\u4f7f\u7528\u6807\u7b7e\uff1b\u6807\u7b7e\u9700\u8981\u6210\u5bf9\u51fa\u73b0\u3002 -- \u9000\u51fa\u5faa\u73af \u9000\u51fa\u6574\u4e2a\u5faa\u73af leave \u9000\u51fa\u5f53\u524d\u5faa\u73af iterate \u901a\u8fc7\u9000\u51fa\u7684\u6807\u7b7e\u51b3\u5b9a\u9000\u51fa\u54ea\u4e2a\u5faa\u73af --// \u5185\u7f6e\u51fd\u6570 ---------- -- \u6570\u503c\u51fd\u6570 abs(x) -- \u7edd\u5bf9\u503c abs(-10.9) = 10 format(x, d) -- \u683c\u5f0f\u5316\u5343\u5206\u4f4d\u6570\u503c format(1234567.456, 2) = 1,234,567.46 ceil(x) -- \u5411\u4e0a\u53d6\u6574 ceil(10.1) = 11 floor(x) -- \u5411\u4e0b\u53d6\u6574 floor (10.1) = 10 round(x) -- \u56db\u820d\u4e94\u5165\u53bb\u6574 mod(m, n) -- m%n m mod n \u6c42\u4f59 10%3=1 pi() -- \u83b7\u5f97\u5706\u5468\u7387 pow(m, n) -- m^n sqrt(x) -- \u7b97\u672f\u5e73\u65b9\u6839 rand() -- \u968f\u673a\u6570 truncate(x, d) -- \u622a\u53d6d\u4f4d\u5c0f\u6570 -- \u65f6\u95f4\u65e5\u671f\u51fd\u6570 now(), current_timestamp(); -- \u5f53\u524d\u65e5\u671f\u65f6\u95f4 current_date(); -- \u5f53\u524d\u65e5\u671f current_time(); -- \u5f53\u524d\u65f6\u95f4 date( yyyy-mm-dd hh:ii:ss ); -- \u83b7\u53d6\u65e5\u671f\u90e8\u5206 time( yyyy-mm-dd hh:ii:ss ); -- \u83b7\u53d6\u65f6\u95f4\u90e8\u5206 date_format( yyyy-mm-dd hh:ii:ss , %d %y %a %d %m %b %j ); -- \u683c\u5f0f\u5316\u65f6\u95f4 unix_timestamp(); -- \u83b7\u5f97unix\u65f6\u95f4\u6233 from_unixtime(); -- \u4ece\u65f6\u95f4\u6233\u83b7\u5f97\u65f6\u95f4 -- \u5b57\u7b26\u4e32\u51fd\u6570 length(string) -- string\u957f\u5ea6\uff0c\u5b57\u8282 char_length(string) -- string\u7684\u5b57\u7b26\u4e2a\u6570 substring(str, position [,length]) -- \u4ecestr\u7684position\u5f00\u59cb,\u53d6length\u4e2a\u5b57\u7b26 replace(str ,search_str ,replace_str) -- \u5728str\u4e2d\u7528replace_str\u66ff\u6362search_str instr(string ,substring) -- \u8fd4\u56desubstring\u9996\u6b21\u5728string\u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e concat(string [,...]) -- \u8fde\u63a5\u5b57\u4e32 charset(str) -- \u8fd4\u56de\u5b57\u4e32\u5b57\u7b26\u96c6 lcase(string) -- \u8f6c\u6362\u6210\u5c0f\u5199 left(string, length) -- \u4ecestring2\u4e2d\u7684\u5de6\u8fb9\u8d77\u53d6length\u4e2a\u5b57\u7b26 load_file(file_name) -- \u4ece\u6587\u4ef6\u8bfb\u53d6\u5185\u5bb9 locate(substring, string [,start_position]) -- \u540cinstr,\u4f46\u53ef\u6307\u5b9a\u5f00\u59cb\u4f4d\u7f6e lpad(string, length, pad) -- \u91cd\u590d\u7528pad\u52a0\u5728string\u5f00\u5934,\u76f4\u5230\u5b57\u4e32\u957f\u5ea6\u4e3alength ltrim(string) -- \u53bb\u9664\u524d\u7aef\u7a7a\u683c repeat(string, count) -- \u91cd\u590dcount\u6b21 rpad(string, length, pad) --\u5728str\u540e\u7528pad\u8865\u5145,\u76f4\u5230\u957f\u5ea6\u4e3alength rtrim(string) -- \u53bb\u9664\u540e\u7aef\u7a7a\u683c strcmp(string1 ,string2) -- \u9010\u5b57\u7b26\u6bd4\u8f83\u4e24\u5b57\u4e32\u5927\u5c0f -- \u6d41\u7a0b\u51fd\u6570 case when [condition] then result [when [condition] then result ...] [else result] end \u591a\u5206\u652f if(expr1,expr2,expr3) \u53cc\u5206\u652f\u3002 -- \u805a\u5408\u51fd\u6570 count() sum(); max(); min(); avg(); group_concat() -- \u5176\u4ed6\u5e38\u7528\u51fd\u6570 md5(); default(); --// \u5b58\u50a8\u51fd\u6570\uff0c\u81ea\u5b9a\u4e49\u51fd\u6570 ---------- -- \u65b0\u5efa CREATE FUNCTION function_name (\u53c2\u6570\u5217\u8868) RETURNS \u8fd4\u56de\u503c\u7c7b\u578b \u51fd\u6570\u4f53 - \u51fd\u6570\u540d\uff0c\u5e94\u8be5\u5408\u6cd5\u7684\u6807\u8bc6\u7b26\uff0c\u5e76\u4e14\u4e0d\u5e94\u8be5\u4e0e\u5df2\u6709\u7684\u5173\u952e\u5b57\u51b2\u7a81\u3002 - \u4e00\u4e2a\u51fd\u6570\u5e94\u8be5\u5c5e\u4e8e\u67d0\u4e2a\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528db_name.funciton_name\u7684\u5f62\u5f0f\u6267\u884c\u5f53\u524d\u51fd\u6570\u6240\u5c5e\u6570\u636e\u5e93\uff0c\u5426\u5219\u4e3a\u5f53\u524d\u6570\u636e\u5e93\u3002 - \u53c2\u6570\u90e8\u5206\uff0c\u7531\"\u53c2\u6570\u540d\"\u548c\"\u53c2\u6570\u7c7b\u578b\"\u7ec4\u6210\u3002\u591a\u4e2a\u53c2\u6570\u7528\u9017\u53f7\u9694\u5f00\u3002 - \u51fd\u6570\u4f53\u7531\u591a\u6761\u53ef\u7528\u7684mysql\u8bed\u53e5\uff0c\u6d41\u7a0b\u63a7\u5236\uff0c\u53d8\u91cf\u58f0\u660e\u7b49\u8bed\u53e5\u6784\u6210\u3002 - \u591a\u6761\u8bed\u53e5\u5e94\u8be5\u4f7f\u7528 begin...end \u8bed\u53e5\u5757\u5305\u542b\u3002 - \u4e00\u5b9a\u8981\u6709 return \u8fd4\u56de\u503c\u8bed\u53e5\u3002 -- \u5220\u9664 DROP FUNCTION [IF EXISTS] function_name; -- \u67e5\u770b SHOW FUNCTION STATUS LIKE partten SHOW CREATE FUNCTION function_name; -- \u4fee\u6539 ALTER FUNCTION function_name \u51fd\u6570\u9009\u9879 --// \u5b58\u50a8\u8fc7\u7a0b\uff0c\u81ea\u5b9a\u4e49\u529f\u80fd ---------- -- \u5b9a\u4e49 \u5b58\u50a8\u5b58\u50a8\u8fc7\u7a0b \u662f\u4e00\u6bb5\u4ee3\u7801\uff08\u8fc7\u7a0b\uff09\uff0c\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u7684sql\u7ec4\u6210\u3002 \u4e00\u4e2a\u5b58\u50a8\u8fc7\u7a0b\u901a\u5e38\u7528\u4e8e\u5b8c\u6210\u4e00\u6bb5\u4e1a\u52a1\u903b\u8f91\uff0c\u4f8b\u5982\u62a5\u540d\uff0c\u4ea4\u73ed\u8d39\uff0c\u8ba2\u5355\u5165\u5e93\u7b49\u3002 \u800c\u4e00\u4e2a\u51fd\u6570\u901a\u5e38\u4e13\u6ce8\u4e0e\u67d0\u4e2a\u529f\u80fd\uff0c\u89c6\u4e3a\u5176\u4ed6\u7a0b\u5e8f\u670d\u52a1\u7684\uff0c\u9700\u8981\u5728\u5176\u4ed6\u8bed\u53e5\u4e2d\u8c03\u7528\u51fd\u6570\u624d\u53ef\u4ee5\uff0c\u800c\u5b58\u50a8\u8fc7\u7a0b\u4e0d\u80fd\u88ab\u5176\u4ed6\u8c03\u7528\uff0c\u662f\u81ea\u5df1\u6267\u884c \u901a\u8fc7call\u6267\u884c\u3002 -- \u521b\u5efa CREATE PROCEDURE sp_name (\u53c2\u6570\u5217\u8868) \u8fc7\u7a0b\u4f53 \u53c2\u6570\u5217\u8868\uff1a\u4e0d\u540c\u4e8e\u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\uff0c\u9700\u8981\u6307\u660e\u53c2\u6570\u7c7b\u578b IN\uff0c\u8868\u793a\u8f93\u5165\u578b OUT\uff0c\u8868\u793a\u8f93\u51fa\u578b INOUT\uff0c\u8868\u793a\u6df7\u5408\u578b \u6ce8\u610f\uff0c\u6ca1\u6709\u8fd4\u56de\u503c\u3002 /* \u5b58\u50a8\u8fc7\u7a0b */ ------------------ \u5b58\u50a8\u8fc7\u7a0b\u662f\u4e00\u6bb5\u53ef\u6267\u884c\u6027\u4ee3\u7801\u7684\u96c6\u5408\u3002\u76f8\u6bd4\u51fd\u6570\uff0c\u66f4\u504f\u5411\u4e8e\u4e1a\u52a1\u903b\u8f91\u3002 \u8c03\u7528\uff1aCALL \u8fc7\u7a0b\u540d -- \u6ce8\u610f - \u6ca1\u6709\u8fd4\u56de\u503c\u3002 - \u53ea\u80fd\u5355\u72ec\u8c03\u7528\uff0c\u4e0d\u53ef\u5939\u6742\u5728\u5176\u4ed6\u8bed\u53e5\u4e2d -- \u53c2\u6570 IN|OUT|INOUT \u53c2\u6570\u540d \u6570\u636e\u7c7b\u578b IN \u8f93\u5165\uff1a\u5728\u8c03\u7528\u8fc7\u7a0b\u4e2d\uff0c\u5c06\u6570\u636e\u8f93\u5165\u5230\u8fc7\u7a0b\u4f53\u5185\u90e8\u7684\u53c2\u6570 OUT \u8f93\u51fa\uff1a\u5728\u8c03\u7528\u8fc7\u7a0b\u4e2d\uff0c\u5c06\u8fc7\u7a0b\u4f53\u5904\u7406\u5b8c\u7684\u7ed3\u679c\u8fd4\u56de\u5230\u5ba2\u6237\u7aef INOUT \u8f93\u5165\u8f93\u51fa\uff1a\u65e2\u53ef\u8f93\u5165\uff0c\u4e5f\u53ef\u8f93\u51fa -- \u8bed\u6cd5 CREATE PROCEDURE \u8fc7\u7a0b\u540d (\u53c2\u6570\u5217\u8868) BEGIN \u8fc7\u7a0b\u4f53 END \u7528\u6237\u548c\u6743\u9650\u7ba1\u7406 \u00b6 -- root\u5bc6\u7801\u91cd\u7f6e 1. \u505c\u6b62MySQL\u670d\u52a1 2. [Linux] /usr/local/mysql/bin/safe_mysqld --skip-grant-tables & [Windows] mysqld --skip-grant-tables 3. use mysql; 4. UPDATE `user` SET PASSWORD=PASSWORD(\"\u5bc6\u7801\") WHERE `user` = \"root\"; 5. FLUSH PRIVILEGES; \u7528\u6237\u4fe1\u606f\u8868\uff1amysql.user -- \u5237\u65b0\u6743\u9650 FLUSH PRIVILEGES; -- \u589e\u52a0\u7528\u6237 CREATE USER \u7528\u6237\u540d IDENTIFIED BY [PASSWORD] \u5bc6\u7801(\u5b57\u7b26\u4e32) - \u5fc5\u987b\u62e5\u6709mysql\u6570\u636e\u5e93\u7684\u5168\u5c40CREATE USER\u6743\u9650\uff0c\u6216\u62e5\u6709INSERT\u6743\u9650\u3002 - \u53ea\u80fd\u521b\u5efa\u7528\u6237\uff0c\u4e0d\u80fd\u8d4b\u4e88\u6743\u9650\u3002 - \u7528\u6237\u540d\uff0c\u6ce8\u610f\u5f15\u53f7\uff1a\u5982 user_name @ 192.168.1.1 - \u5bc6\u7801\u4e5f\u9700\u5f15\u53f7\uff0c\u7eaf\u6570\u5b57\u5bc6\u7801\u4e5f\u8981\u52a0\u5f15\u53f7 - \u8981\u5728\u7eaf\u6587\u672c\u4e2d\u6307\u5b9a\u5bc6\u7801\uff0c\u9700\u5ffd\u7565PASSWORD\u5173\u952e\u8bcd\u3002\u8981\u628a\u5bc6\u7801\u6307\u5b9a\u4e3a\u7531PASSWORD()\u51fd\u6570\u8fd4\u56de\u7684\u6df7\u7f16\u503c\uff0c\u9700\u5305\u542b\u5173\u952e\u5b57PASSWORD -- \u91cd\u547d\u540d\u7528\u6237 RENAME USER old_user TO new_user -- \u8bbe\u7f6e\u5bc6\u7801 SET PASSWORD = PASSWORD( \u5bc6\u7801 ) -- \u4e3a\u5f53\u524d\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801 SET PASSWORD FOR \u7528\u6237\u540d = PASSWORD( \u5bc6\u7801 ) -- \u4e3a\u6307\u5b9a\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801 -- \u5220\u9664\u7528\u6237 DROP USER \u7528\u6237\u540d -- \u5206\u914d\u6743\u9650/\u6dfb\u52a0\u7528\u6237 GRANT \u6743\u9650\u5217\u8868 ON \u8868\u540d TO \u7528\u6237\u540d [IDENTIFIED BY [PASSWORD] password ] - all privileges \u8868\u793a\u6240\u6709\u6743\u9650 - *.* \u8868\u793a\u6240\u6709\u5e93\u7684\u6240\u6709\u8868 - \u5e93\u540d.\u8868\u540d \u8868\u793a\u67d0\u5e93\u4e0b\u9762\u7684\u67d0\u8868 GRANT ALL PRIVILEGES ON `pms`.* TO pms @ % IDENTIFIED BY pms0817 ; -- \u67e5\u770b\u6743\u9650 SHOW GRANTS FOR \u7528\u6237\u540d -- \u67e5\u770b\u5f53\u524d\u7528\u6237\u6743\u9650 SHOW GRANTS; \u6216 SHOW GRANTS FOR CURRENT_USER; \u6216 SHOW GRANTS FOR CURRENT_USER(); -- \u64a4\u6d88\u6743\u9650 REVOKE \u6743\u9650\u5217\u8868 ON \u8868\u540d FROM \u7528\u6237\u540d REVOKE ALL PRIVILEGES, GRANT OPTION FROM \u7528\u6237\u540d -- \u64a4\u9500\u6240\u6709\u6743\u9650 -- \u6743\u9650\u5c42\u7ea7 -- \u8981\u4f7f\u7528GRANT\u6216REVOKE\uff0c\u60a8\u5fc5\u987b\u62e5\u6709GRANT OPTION\u6743\u9650\uff0c\u5e76\u4e14\u60a8\u5fc5\u987b\u7528\u4e8e\u60a8\u6b63\u5728\u6388\u4e88\u6216\u64a4\u9500\u7684\u6743\u9650\u3002 \u5168\u5c40\u5c42\u7ea7\uff1a\u5168\u5c40\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u670d\u52a1\u5668\u4e2d\u7684\u6240\u6709\u6570\u636e\u5e93\uff0cmysql.user GRANT ALL ON *.*\u548c REVOKE ALL ON *.*\u53ea\u6388\u4e88\u548c\u64a4\u9500\u5168\u5c40\u6743\u9650\u3002 \u6570\u636e\u5e93\u5c42\u7ea7\uff1a\u6570\u636e\u5e93\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u76ee\u6807\uff0cmysql.db, mysql.host GRANT ALL ON db_name.*\u548cREVOKE ALL ON db_name.*\u53ea\u6388\u4e88\u548c\u64a4\u9500\u6570\u636e\u5e93\u6743\u9650\u3002 \u8868\u5c42\u7ea7\uff1a\u8868\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u8868\u4e2d\u7684\u6240\u6709\u5217\uff0cmysql.talbes_priv GRANT ALL ON db_name.tbl_name\u548cREVOKE ALL ON db_name.tbl_name\u53ea\u6388\u4e88\u548c\u64a4\u9500\u8868\u6743\u9650\u3002 \u5217\u5c42\u7ea7\uff1a\u5217\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u8868\u4e2d\u7684\u5355\u4e00\u5217\uff0cmysql.columns_priv \u5f53\u4f7f\u7528REVOKE\u65f6\uff0c\u60a8\u5fc5\u987b\u6307\u5b9a\u4e0e\u88ab\u6388\u6743\u5217\u76f8\u540c\u7684\u5217\u3002 -- \u6743\u9650\u5217\u8868 ALL [PRIVILEGES] -- \u8bbe\u7f6e\u9664GRANT OPTION\u4e4b\u5916\u7684\u6240\u6709\u7b80\u5355\u6743\u9650 ALTER -- \u5141\u8bb8\u4f7f\u7528ALTER TABLE ALTER ROUTINE -- \u66f4\u6539\u6216\u53d6\u6d88\u5df2\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f CREATE -- \u5141\u8bb8\u4f7f\u7528CREATE TABLE CREATE ROUTINE -- \u521b\u5efa\u5df2\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f CREATE TEMPORARY TABLES -- \u5141\u8bb8\u4f7f\u7528CREATE TEMPORARY TABLE CREATE USER -- \u5141\u8bb8\u4f7f\u7528CREATE USER, DROP USER, RENAME USER\u548cREVOKE ALL PRIVILEGES\u3002 CREATE VIEW -- \u5141\u8bb8\u4f7f\u7528CREATE VIEW DELETE -- \u5141\u8bb8\u4f7f\u7528DELETE DROP -- \u5141\u8bb8\u4f7f\u7528DROP TABLE EXECUTE -- \u5141\u8bb8\u7528\u6237\u8fd0\u884c\u5df2\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f FILE -- \u5141\u8bb8\u4f7f\u7528SELECT...INTO OUTFILE\u548cLOAD DATA INFILE INDEX -- \u5141\u8bb8\u4f7f\u7528CREATE INDEX\u548cDROP INDEX INSERT -- \u5141\u8bb8\u4f7f\u7528INSERT LOCK TABLES -- \u5141\u8bb8\u5bf9\u60a8\u62e5\u6709SELECT\u6743\u9650\u7684\u8868\u4f7f\u7528LOCK TABLES PROCESS -- \u5141\u8bb8\u4f7f\u7528SHOW FULL PROCESSLIST REFERENCES -- \u672a\u88ab\u5b9e\u65bd RELOAD -- \u5141\u8bb8\u4f7f\u7528FLUSH REPLICATION CLIENT -- \u5141\u8bb8\u7528\u6237\u8be2\u95ee\u4ece\u5c5e\u670d\u52a1\u5668\u6216\u4e3b\u670d\u52a1\u5668\u7684\u5730\u5740 REPLICATION SLAVE -- \u7528\u4e8e\u590d\u5236\u578b\u4ece\u5c5e\u670d\u52a1\u5668\uff08\u4ece\u4e3b\u670d\u52a1\u5668\u4e2d\u8bfb\u53d6\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e8b\u4ef6\uff09 SELECT -- \u5141\u8bb8\u4f7f\u7528SELECT SHOW DATABASES -- \u663e\u793a\u6240\u6709\u6570\u636e\u5e93 SHOW VIEW -- \u5141\u8bb8\u4f7f\u7528SHOW CREATE VIEW SHUTDOWN -- \u5141\u8bb8\u4f7f\u7528mysqladmin shutdown SUPER -- \u5141\u8bb8\u4f7f\u7528CHANGE MASTER, KILL, PURGE MASTER LOGS\u548cSET GLOBAL\u8bed\u53e5\uff0cmysqladmin debug\u547d\u4ee4\uff1b\u5141\u8bb8\u60a8\u8fde\u63a5\uff08\u4e00\u6b21\uff09\uff0c\u5373\u4f7f\u5df2\u8fbe\u5230max_connections\u3002 UPDATE -- \u5141\u8bb8\u4f7f\u7528UPDATE USAGE -- \u201c\u65e0\u6743\u9650\u201d\u7684\u540c\u4e49\u8bcd GRANT OPTION -- \u5141\u8bb8\u6388\u4e88\u6743\u9650 \u8868\u7ef4\u62a4 \u00b6 -- \u5206\u6790\u548c\u5b58\u50a8\u8868\u7684\u5173\u952e\u5b57\u5206\u5e03 ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE \u8868\u540d ... -- \u68c0\u67e5\u4e00\u4e2a\u6216\u591a\u4e2a\u8868\u662f\u5426\u6709\u9519\u8bef CHECK TABLE tbl_name [, tbl_name] ... [option] ... option = {QUICK | FAST | MEDIUM | EXTENDED | CHANGED} -- \u6574\u7406\u6570\u636e\u6587\u4ef6\u7684\u788e\u7247 OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... \u6742\u9879 \u00b6 1. \u53ef\u7528\u53cd\u5f15\u53f7\uff08`\uff09\u4e3a\u6807\u8bc6\u7b26\uff08\u5e93\u540d\u3001\u8868\u540d\u3001\u5b57\u6bb5\u540d\u3001\u7d22\u5f15\u3001\u522b\u540d\uff09\u5305\u88f9\uff0c\u4ee5\u907f\u514d\u4e0e\u5173\u952e\u5b57\u91cd\u540d\uff01\u4e2d\u6587\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u6807\u8bc6\u7b26\uff01 2. \u6bcf\u4e2a\u5e93\u76ee\u5f55\u5b58\u5728\u4e00\u4e2a\u4fdd\u5b58\u5f53\u524d\u6570\u636e\u5e93\u7684\u9009\u9879\u6587\u4ef6db.opt\u3002 3. \u6ce8\u91ca\uff1a \u5355\u884c\u6ce8\u91ca # \u6ce8\u91ca\u5185\u5bb9 \u591a\u884c\u6ce8\u91ca /* \u6ce8\u91ca\u5185\u5bb9 */ \u5355\u884c\u6ce8\u91ca -- \u6ce8\u91ca\u5185\u5bb9 (\u6807\u51c6SQL\u6ce8\u91ca\u98ce\u683c\uff0c\u8981\u6c42\u53cc\u7834\u6298\u53f7\u540e\u52a0\u4e00\u7a7a\u683c\u7b26\uff08\u7a7a\u683c\u3001TAB\u3001\u6362\u884c\u7b49\uff09) 4. \u6a21\u5f0f\u901a\u914d\u7b26\uff1a _ \u4efb\u610f\u5355\u4e2a\u5b57\u7b26 % \u4efb\u610f\u591a\u4e2a\u5b57\u7b26\uff0c\u751a\u81f3\u5305\u62ec\u96f6\u5b57\u7b26 \u5355\u5f15\u53f7\u9700\u8981\u8fdb\u884c\u8f6c\u4e49 5. CMD\u547d\u4ee4\u884c\u5185\u7684\u8bed\u53e5\u7ed3\u675f\u7b26\u53ef\u4ee5\u4e3a \";\", \"G\", \"g\"\uff0c\u4ec5\u5f71\u54cd\u663e\u793a\u7ed3\u679c\u3002\u5176\u4ed6\u5730\u65b9\u8fd8\u662f\u7528\u5206\u53f7\u7ed3\u675f\u3002delimiter \u53ef\u4fee\u6539\u5f53\u524d\u5bf9\u8bdd\u7684\u8bed\u53e5\u7ed3\u675f\u7b26\u3002 6. SQL\u5bf9\u5927\u5c0f\u5199\u4e0d\u654f\u611f 7. \u6e05\u9664\u5df2\u6709\u8bed\u53e5\uff1ac","title":"\u5b66\u4e60\u7b14\u8bb0"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#1000-mysql","text":"\u539f\u6587","title":"1000\u884c MySQL \u5b66\u4e60\u7b14\u8bb0\uff0c\u4e0d\u6015\u4f60\u4e0d\u4f1a\uff0c\u5c31\u6015\u4f60\u4e0d\u5b66\uff01"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_1","text":"mysql -h \u5730\u5740 -P \u7aef\u53e3 -u \u7528\u6237\u540d -p \u5bc6\u7801 SHOW PROCESSLIST -- \u663e\u793a\u54ea\u4e9b\u7ebf\u7a0b\u6b63\u5728\u8fd0\u884c SHOW VARIABLES -- \u663e\u793a\u7cfb\u7edf\u53d8\u91cf\u4fe1\u606f","title":"\u8fde\u63a5\u4e0e\u65ad\u5f00\u670d\u52a1\u5668"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_2","text":"-- \u67e5\u770b\u5f53\u524d\u6570\u636e\u5e93 SELECT DATABASE(); -- \u663e\u793a\u5f53\u524d\u65f6\u95f4\u3001\u7528\u6237\u540d\u3001\u6570\u636e\u5e93\u7248\u672c SELECT now(), user(), version(); -- \u521b\u5efa\u5e93 CREATE DATABASE[ IF NOT EXISTS] \u6570\u636e\u5e93\u540d \u6570\u636e\u5e93\u9009\u9879 \u6570\u636e\u5e93\u9009\u9879\uff1a CHARACTER SET charset_name COLLATE collation_name -- \u67e5\u770b\u5df2\u6709\u5e93 SHOW DATABASES[ LIKE PATTERN ] -- \u67e5\u770b\u5f53\u524d\u5e93\u4fe1\u606f SHOW CREATE DATABASE \u6570\u636e\u5e93\u540d -- \u4fee\u6539\u5e93\u7684\u9009\u9879\u4fe1\u606f ALTER DATABASE \u5e93\u540d \u9009\u9879\u4fe1\u606f -- \u5220\u9664\u5e93 DROP DATABASE[ IF EXISTS] \u6570\u636e\u5e93\u540d \u540c\u65f6\u5220\u9664\u8be5\u6570\u636e\u5e93\u76f8\u5173\u7684\u76ee\u5f55\u53ca\u5176\u76ee\u5f55\u5185\u5bb9","title":"\u6570\u636e\u5e93\u64cd\u4f5c"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_3","text":"-- \u521b\u5efa\u8868 CREATE [TEMPORARY] TABLE[ IF NOT EXISTS] [\u5e93\u540d.]\u8868\u540d ( \u8868\u7684\u7ed3\u6784\u5b9a\u4e49 )[ \u8868\u9009\u9879] \u6bcf\u4e2a\u5b57\u6bb5\u5fc5\u987b\u6709\u6570\u636e\u7c7b\u578b \u6700\u540e\u4e00\u4e2a\u5b57\u6bb5\u540e\u4e0d\u80fd\u6709\u9017\u53f7 TEMPORARY \u4e34\u65f6\u8868\uff0c\u4f1a\u8bdd\u7ed3\u675f\u65f6\u8868\u81ea\u52a8\u6d88\u5931 \u5bf9\u4e8e\u5b57\u6bb5\u7684\u5b9a\u4e49\uff1a \u5b57\u6bb5\u540d \u6570\u636e\u7c7b\u578b [NOT NULL | NULL] [DEFAULT default_value] [AUTO_INCREMENT] [UNIQUE [KEY] | [PRIMARY] KEY] [COMMENT string ] -- \u8868\u9009\u9879 -- \u5b57\u7b26\u96c6 CHARSET = charset_name \u5982\u679c\u8868\u6ca1\u6709\u8bbe\u5b9a\uff0c\u5219\u4f7f\u7528\u6570\u636e\u5e93\u5b57\u7b26\u96c6 -- \u5b58\u50a8\u5f15\u64ce ENGINE = engine_name \u8868\u5728\u7ba1\u7406\u6570\u636e\u65f6\u91c7\u7528\u7684\u4e0d\u540c\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7ed3\u6784\u4e0d\u540c\u4f1a\u5bfc\u81f4\u5904\u7406\u65b9\u5f0f\u3001\u63d0\u4f9b\u7684\u7279\u6027\u64cd\u4f5c\u7b49\u4e0d\u540c \u5e38\u89c1\u7684\u5f15\u64ce\uff1aInnoDB MyISAM Memory/Heap BDB Merge Example CSV MaxDB Archive \u4e0d\u540c\u7684\u5f15\u64ce\u5728\u4fdd\u5b58\u8868\u7684\u7ed3\u6784\u548c\u6570\u636e\u65f6\u91c7\u7528\u4e0d\u540c\u7684\u65b9\u5f0f MyISAM\u8868\u6587\u4ef6\u542b\u4e49\uff1a.frm\u8868\u5b9a\u4e49\uff0c.MYD\u8868\u6570\u636e\uff0c.MYI\u8868\u7d22\u5f15 InnoDB\u8868\u6587\u4ef6\u542b\u4e49\uff1a.frm\u8868\u5b9a\u4e49\uff0c\u8868\u7a7a\u95f4\u6570\u636e\u548c\u65e5\u5fd7\u6587\u4ef6 SHOW ENGINES -- \u663e\u793a\u5b58\u50a8\u5f15\u64ce\u7684\u72b6\u6001\u4fe1\u606f SHOW ENGINE \u5f15\u64ce\u540d {LOGS|STATUS} -- \u663e\u793a\u5b58\u50a8\u5f15\u64ce\u7684\u65e5\u5fd7\u6216\u72b6\u6001\u4fe1\u606f -- \u81ea\u589e\u8d77\u59cb\u6570 AUTO_INCREMENT = \u884c\u6570 -- \u6570\u636e\u6587\u4ef6\u76ee\u5f55 DATA DIRECTORY = \u76ee\u5f55 -- \u7d22\u5f15\u6587\u4ef6\u76ee\u5f55 INDEX DIRECTORY = \u76ee\u5f55 -- \u8868\u6ce8\u91ca COMMENT = string -- \u5206\u533a\u9009\u9879 PARTITION BY ... (\u8be6\u7ec6\u89c1\u624b\u518c) -- \u67e5\u770b\u6240\u6709\u8868 SHOW TABLES[ LIKE pattern ] SHOW TABLES FROM \u8868\u540d -- \u67e5\u770b\u8868\u673a\u6784 SHOW CREATE TABLE \u8868\u540d \uff08\u4fe1\u606f\u66f4\u8be6\u7ec6\uff09 DESC \u8868\u540d / DESCRIBE \u8868\u540d / EXPLAIN \u8868\u540d / SHOW COLUMNS FROM \u8868\u540d [LIKE PATTERN ] SHOW TABLE STATUS [FROM db_name] [LIKE pattern ] -- \u4fee\u6539\u8868 -- \u4fee\u6539\u8868\u672c\u8eab\u7684\u9009\u9879 ALTER TABLE \u8868\u540d \u8868\u7684\u9009\u9879 eg: ALTER TABLE \u8868\u540d ENGINE=MYISAM; -- \u5bf9\u8868\u8fdb\u884c\u91cd\u547d\u540d RENAME TABLE \u539f\u8868\u540d TO \u65b0\u8868\u540d RENAME TABLE \u539f\u8868\u540d TO \u5e93\u540d.\u8868\u540d \uff08\u53ef\u5c06\u8868\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u6570\u636e\u5e93\uff09 -- RENAME\u53ef\u4ee5\u4ea4\u6362\u4e24\u4e2a\u8868\u540d -- \u4fee\u6539\u8868\u7684\u5b57\u6bb5\u673a\u6784\uff0813.1.2. ALTER TABLE\u8bed\u6cd5\uff09 ALTER TABLE \u8868\u540d \u64cd\u4f5c\u540d -- \u64cd\u4f5c\u540d ADD[ COLUMN] \u5b57\u6bb5\u5b9a\u4e49 -- \u589e\u52a0\u5b57\u6bb5 AFTER \u5b57\u6bb5\u540d -- \u8868\u793a\u589e\u52a0\u5728\u8be5\u5b57\u6bb5\u540d\u540e\u9762 FIRST -- \u8868\u793a\u589e\u52a0\u5728\u7b2c\u4e00\u4e2a ADD PRIMARY KEY(\u5b57\u6bb5\u540d) -- \u521b\u5efa\u4e3b\u952e ADD UNIQUE [\u7d22\u5f15\u540d] (\u5b57\u6bb5\u540d)-- \u521b\u5efa\u552f\u4e00\u7d22\u5f15 ADD INDEX [\u7d22\u5f15\u540d] (\u5b57\u6bb5\u540d) -- \u521b\u5efa\u666e\u901a\u7d22\u5f15 DROP[ COLUMN] \u5b57\u6bb5\u540d -- \u5220\u9664\u5b57\u6bb5 MODIFY[ COLUMN] \u5b57\u6bb5\u540d \u5b57\u6bb5\u5c5e\u6027 -- \u652f\u6301\u5bf9\u5b57\u6bb5\u5c5e\u6027\u8fdb\u884c\u4fee\u6539\uff0c\u4e0d\u80fd\u4fee\u6539\u5b57\u6bb5\u540d(\u6240\u6709\u539f\u6709\u5c5e\u6027\u4e5f\u9700\u5199\u4e0a) CHANGE[ COLUMN] \u539f\u5b57\u6bb5\u540d \u65b0\u5b57\u6bb5\u540d \u5b57\u6bb5\u5c5e\u6027 -- \u652f\u6301\u5bf9\u5b57\u6bb5\u540d\u4fee\u6539 DROP PRIMARY KEY -- \u5220\u9664\u4e3b\u952e(\u5220\u9664\u4e3b\u952e\u524d\u9700\u5220\u9664\u5176AUTO_INCREMENT\u5c5e\u6027) DROP INDEX \u7d22\u5f15\u540d -- \u5220\u9664\u7d22\u5f15 DROP FOREIGN KEY \u5916\u952e -- \u5220\u9664\u5916\u952e -- \u5220\u9664\u8868 DROP TABLE[ IF EXISTS] \u8868\u540d ... -- \u6e05\u7a7a\u8868\u6570\u636e TRUNCATE [TABLE] \u8868\u540d -- \u590d\u5236\u8868\u7ed3\u6784 CREATE TABLE \u8868\u540d LIKE \u8981\u590d\u5236\u7684\u8868\u540d -- \u590d\u5236\u8868\u7ed3\u6784\u548c\u6570\u636e CREATE TABLE \u8868\u540d [AS] SELECT * FROM \u8981\u590d\u5236\u7684\u8868\u540d -- \u68c0\u67e5\u8868\u662f\u5426\u6709\u9519\u8bef CHECK TABLE tbl_name [, tbl_name] ... [option] ... -- \u4f18\u5316\u8868 OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... -- \u4fee\u590d\u8868 REPAIR [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... [QUICK] [EXTENDED] [USE_FRM] -- \u5206\u6790\u8868 ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...","title":"\u8868\u7684\u64cd\u4f5c"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_4","text":"-- \u589e INSERT [INTO] \u8868\u540d [(\u5b57\u6bb5\u5217\u8868)] VALUES (\u503c\u5217\u8868)[, (\u503c\u5217\u8868), ...] -- \u5982\u679c\u8981\u63d2\u5165\u7684\u503c\u5217\u8868\u5305\u542b\u6240\u6709\u5b57\u6bb5\u5e76\u4e14\u987a\u5e8f\u4e00\u81f4\uff0c\u5219\u53ef\u4ee5\u7701\u7565\u5b57\u6bb5\u5217\u8868\u3002 -- \u53ef\u540c\u65f6\u63d2\u5165\u591a\u6761\u6570\u636e\u8bb0\u5f55\uff01 REPLACE \u4e0e INSERT \u5b8c\u5168\u4e00\u6837\uff0c\u53ef\u4e92\u6362\u3002 INSERT [INTO] \u8868\u540d SET \u5b57\u6bb5\u540d=\u503c[, \u5b57\u6bb5\u540d=\u503c, ...] -- \u67e5 SELECT \u5b57\u6bb5\u5217\u8868 FROM \u8868\u540d[ \u5176\u4ed6\u5b50\u53e5] -- \u53ef\u6765\u81ea\u591a\u4e2a\u8868\u7684\u591a\u4e2a\u5b57\u6bb5 -- \u5176\u4ed6\u5b50\u53e5\u53ef\u4ee5\u4e0d\u4f7f\u7528 -- \u5b57\u6bb5\u5217\u8868\u53ef\u4ee5\u7528*\u4ee3\u66ff\uff0c\u8868\u793a\u6240\u6709\u5b57\u6bb5 -- \u5220 DELETE FROM \u8868\u540d[ \u5220\u9664\u6761\u4ef6\u5b50\u53e5] \u6ca1\u6709\u6761\u4ef6\u5b50\u53e5\uff0c\u5219\u4f1a\u5220\u9664\u5168\u90e8 -- \u6539 UPDATE \u8868\u540d SET \u5b57\u6bb5\u540d=\u65b0\u503c[, \u5b57\u6bb5\u540d=\u65b0\u503c] [\u66f4\u65b0\u6761\u4ef6]","title":"\u6570\u636e\u64cd\u4f5c"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_5","text":"-- MySQL\u3001\u6570\u636e\u5e93\u3001\u8868\u3001\u5b57\u6bb5\u5747\u53ef\u8bbe\u7f6e\u7f16\u7801 -- \u6570\u636e\u7f16\u7801\u4e0e\u5ba2\u6237\u7aef\u7f16\u7801\u4e0d\u9700\u4e00\u81f4 SHOW VARIABLES LIKE character_set_% -- \u67e5\u770b\u6240\u6709\u5b57\u7b26\u96c6\u7f16\u7801\u9879 character_set_client \u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u9001\u6570\u636e\u65f6\u4f7f\u7528\u7684\u7f16\u7801 character_set_results \u670d\u52a1\u5668\u7aef\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u6240\u4f7f\u7528\u7684\u7f16\u7801 character_set_connection \u8fde\u63a5\u5c42\u7f16\u7801 SET \u53d8\u91cf\u540d = \u53d8\u91cf\u503c SET character_set_client = gbk; SET character_set_results = gbk; SET character_set_connection = gbk; SET NAMES GBK; -- \u76f8\u5f53\u4e8e\u5b8c\u6210\u4ee5\u4e0a\u4e09\u4e2a\u8bbe\u7f6e -- \u6821\u5bf9\u96c6 \u6821\u5bf9\u96c6\u7528\u4ee5\u6392\u5e8f SHOW CHARACTER SET [LIKE pattern ]/SHOW CHARSET [LIKE pattern ] \u67e5\u770b\u6240\u6709\u5b57\u7b26\u96c6 SHOW COLLATION [LIKE pattern ] \u67e5\u770b\u6240\u6709\u6821\u5bf9\u96c6 CHARSET \u5b57\u7b26\u96c6\u7f16\u7801 \u8bbe\u7f6e\u5b57\u7b26\u96c6\u7f16\u7801 COLLATE \u6821\u5bf9\u96c6\u7f16\u7801 \u8bbe\u7f6e\u6821\u5bf9\u96c6\u7f16\u7801","title":"\u5b57\u7b26\u96c6\u7f16\u7801"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_6","text":"\u6570\u503c\u7c7b\u578b -- a. \u6574\u578b ---------- \u7c7b\u578b \u5b57\u8282 \u8303\u56f4\uff08\u6709\u7b26\u53f7\u4f4d\uff09 tinyint 1\u5b57\u8282 -128 ~ 127 \u65e0\u7b26\u53f7\u4f4d\uff1a0 ~ 255 smallint 2\u5b57\u8282 -32768 ~ 32767 mediumint 3\u5b57\u8282 -8388608 ~ 8388607 int 4\u5b57\u8282 bigint 8\u5b57\u8282 int(M) M\u8868\u793a\u603b\u4f4d\u6570 - \u9ed8\u8ba4\u5b58\u5728\u7b26\u53f7\u4f4d\uff0cunsigned \u5c5e\u6027\u4fee\u6539 - \u663e\u793a\u5bbd\u5ea6\uff0c\u5982\u679c\u67d0\u4e2a\u6570\u4e0d\u591f\u5b9a\u4e49\u5b57\u6bb5\u65f6\u8bbe\u7f6e\u7684\u4f4d\u6570\uff0c\u5219\u524d\u9762\u4ee50\u8865\u586b\uff0czerofill \u5c5e\u6027\u4fee\u6539 \u4f8b\uff1aint(5) \u63d2\u5165\u4e00\u4e2a\u6570 123 \uff0c\u8865\u586b\u540e\u4e3a 00123 - \u5728\u6ee1\u8db3\u8981\u6c42\u7684\u60c5\u51b5\u4e0b\uff0c\u8d8a\u5c0f\u8d8a\u597d\u3002 - 1\u8868\u793abool\u503c\u771f\uff0c0\u8868\u793abool\u503c\u5047\u3002MySQL\u6ca1\u6709\u5e03\u5c14\u7c7b\u578b\uff0c\u901a\u8fc7\u6574\u578b0\u548c1\u8868\u793a\u3002\u5e38\u7528tinyint(1)\u8868\u793a\u5e03\u5c14\u578b\u3002 -- b. \u6d6e\u70b9\u578b ---------- \u7c7b\u578b \u5b57\u8282 \u8303\u56f4 float(\u5355\u7cbe\u5ea6) 4\u5b57\u8282 double(\u53cc\u7cbe\u5ea6) 8\u5b57\u8282 \u6d6e\u70b9\u578b\u65e2\u652f\u6301\u7b26\u53f7\u4f4d unsigned \u5c5e\u6027\uff0c\u4e5f\u652f\u6301\u663e\u793a\u5bbd\u5ea6 zerofill \u5c5e\u6027\u3002 \u4e0d\u540c\u4e8e\u6574\u578b\uff0c\u524d\u540e\u5747\u4f1a\u8865\u586b0. \u5b9a\u4e49\u6d6e\u70b9\u578b\u65f6\uff0c\u9700\u6307\u5b9a\u603b\u4f4d\u6570\u548c\u5c0f\u6570\u4f4d\u6570\u3002 float(M, D) double(M, D) M\u8868\u793a\u603b\u4f4d\u6570\uff0cD\u8868\u793a\u5c0f\u6570\u4f4d\u6570\u3002 M\u548cD\u7684\u5927\u5c0f\u4f1a\u51b3\u5b9a\u6d6e\u70b9\u6570\u7684\u8303\u56f4\u3002\u4e0d\u540c\u4e8e\u6574\u578b\u7684\u56fa\u5b9a\u8303\u56f4\u3002 M\u65e2\u8868\u793a\u603b\u4f4d\u6570\uff08\u4e0d\u5305\u62ec\u5c0f\u6570\u70b9\u548c\u6b63\u8d1f\u53f7\uff09\uff0c\u4e5f\u8868\u793a\u663e\u793a\u5bbd\u5ea6\uff08\u6240\u6709\u663e\u793a\u7b26\u53f7\u5747\u5305\u62ec\uff09\u3002 \u652f\u6301\u79d1\u5b66\u8ba1\u6570\u6cd5\u8868\u793a\u3002 \u6d6e\u70b9\u6570\u8868\u793a\u8fd1\u4f3c\u503c\u3002 -- c. \u5b9a\u70b9\u6570 ---------- decimal -- \u53ef\u53d8\u957f\u5ea6 decimal(M, D) M\u4e5f\u8868\u793a\u603b\u4f4d\u6570\uff0cD\u8868\u793a\u5c0f\u6570\u4f4d\u6570\u3002 \u4fdd\u5b58\u4e00\u4e2a\u7cbe\u786e\u7684\u6570\u503c\uff0c\u4e0d\u4f1a\u53d1\u751f\u6570\u636e\u7684\u6539\u53d8\uff0c\u4e0d\u540c\u4e8e\u6d6e\u70b9\u6570\u7684\u56db\u820d\u4e94\u5165\u3002 \u5c06\u6d6e\u70b9\u6570\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u6765\u4fdd\u5b58\uff0c\u6bcf9\u4f4d\u6570\u5b57\u4fdd\u5b58\u4e3a4\u4e2a\u5b57\u8282\u3002 \u5b57\u7b26\u4e32\u7c7b\u578b -- a. char, varchar ---------- char \u5b9a\u957f\u5b57\u7b26\u4e32\uff0c\u901f\u5ea6\u5feb\uff0c\u4f46\u6d6a\u8d39\u7a7a\u95f4 varchar \u53d8\u957f\u5b57\u7b26\u4e32\uff0c\u901f\u5ea6\u6162\uff0c\u4f46\u8282\u7701\u7a7a\u95f4 M\u8868\u793a\u80fd\u5b58\u50a8\u7684\u6700\u5927\u957f\u5ea6\uff0c\u6b64\u957f\u5ea6\u662f\u5b57\u7b26\u6570\uff0c\u975e\u5b57\u8282\u6570\u3002 \u4e0d\u540c\u7684\u7f16\u7801\uff0c\u6240\u5360\u7528\u7684\u7a7a\u95f4\u4e0d\u540c\u3002 char,\u6700\u591a255\u4e2a\u5b57\u7b26\uff0c\u4e0e\u7f16\u7801\u65e0\u5173\u3002 varchar,\u6700\u591a65535\u5b57\u7b26\uff0c\u4e0e\u7f16\u7801\u6709\u5173\u3002 \u4e00\u6761\u6709\u6548\u8bb0\u5f55\u6700\u5927\u4e0d\u80fd\u8d85\u8fc765535\u4e2a\u5b57\u8282\u3002 utf8 \u6700\u5927\u4e3a21844\u4e2a\u5b57\u7b26\uff0cgbk \u6700\u5927\u4e3a32766\u4e2a\u5b57\u7b26\uff0clatin1 \u6700\u5927\u4e3a65532\u4e2a\u5b57\u7b26 varchar \u662f\u53d8\u957f\u7684\uff0c\u9700\u8981\u5229\u7528\u5b58\u50a8\u7a7a\u95f4\u4fdd\u5b58 varchar \u7684\u957f\u5ea6\uff0c\u5982\u679c\u6570\u636e\u5c0f\u4e8e255\u4e2a\u5b57\u8282\uff0c\u5219\u91c7\u7528\u4e00\u4e2a\u5b57\u8282\u6765\u4fdd\u5b58\u957f\u5ea6\uff0c\u53cd\u4e4b\u9700\u8981\u4e24\u4e2a\u5b57\u8282\u6765\u4fdd\u5b58\u3002 varchar \u7684\u6700\u5927\u6709\u6548\u957f\u5ea6\u7531\u6700\u5927\u884c\u5927\u5c0f\u548c\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u786e\u5b9a\u3002 \u6700\u5927\u6709\u6548\u957f\u5ea6\u662f65532\u5b57\u8282\uff0c\u56e0\u4e3a\u5728varchar\u5b58\u5b57\u7b26\u4e32\u65f6\uff0c\u7b2c\u4e00\u4e2a\u5b57\u8282\u662f\u7a7a\u7684\uff0c\u4e0d\u5b58\u5728\u4efb\u4f55\u6570\u636e\uff0c\u7136\u540e\u8fd8\u9700\u4e24\u4e2a\u5b57\u8282\u6765\u5b58\u653e\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u6240\u4ee5\u6709\u6548\u957f\u5ea6\u662f64432-1-2=65532\u5b57\u8282\u3002 \u4f8b\uff1a\u82e5\u4e00\u4e2a\u8868\u5b9a\u4e49\u4e3a CREATE TABLE tb(c1 int, c2 char(30), c3 varchar(N)) charset=utf8; \u95eeN\u7684\u6700\u5927\u503c\u662f\u591a\u5c11\uff1f \u7b54\uff1a(65535-1-2-4-30*3)/3 -- b. blob, text ---------- blob \u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff08\u5b57\u8282\u5b57\u7b26\u4e32\uff09 tinyblob, blob, mediumblob, longblob text \u975e\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff08\u5b57\u7b26\u5b57\u7b26\u4e32\uff09 tinytext, text, mediumtext, longtext text \u5728\u5b9a\u4e49\u65f6\uff0c\u4e0d\u9700\u8981\u5b9a\u4e49\u957f\u5ea6\uff0c\u4e5f\u4e0d\u4f1a\u8ba1\u7b97\u603b\u957f\u5ea6\u3002 text \u7c7b\u578b\u5728\u5b9a\u4e49\u65f6\uff0c\u4e0d\u53ef\u7ed9default\u503c -- c. binary, varbinary ---------- \u7c7b\u4f3c\u4e8echar\u548cvarchar\uff0c\u7528\u4e8e\u4fdd\u5b58\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff0c\u4e5f\u5c31\u662f\u4fdd\u5b58\u5b57\u8282\u5b57\u7b26\u4e32\u800c\u975e\u5b57\u7b26\u5b57\u7b26\u4e32\u3002 char, varchar, text \u5bf9\u5e94 binary, varbinary, blob. \u65e5\u671f\u65f6\u95f4\u7c7b\u578b \u4e00\u822c\u7528\u6574\u578b\u4fdd\u5b58\u65f6\u95f4\u6233\uff0c\u56e0\u4e3aPHP\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u5c06\u65f6\u95f4\u6233\u8fdb\u884c\u683c\u5f0f\u5316\u3002 datetime 8\u5b57\u8282 \u65e5\u671f\u53ca\u65f6\u95f4 1000-01-01 00:00:00 \u5230 9999-12-31 23:59:59 date 3\u5b57\u8282 \u65e5\u671f 1000-01-01 \u5230 9999-12-31 timestamp 4\u5b57\u8282 \u65f6\u95f4\u6233 19700101000000 \u5230 2038-01-19 03:14:07 time 3\u5b57\u8282 \u65f6\u95f4 -838:59:59 \u5230 838:59:59 year 1\u5b57\u8282 \u5e74\u4efd 1901 - 2155 datetime YYYY-MM-DD hh:mm:ss timestamp YY-MM-DD hh:mm:ss YYYYMMDDhhmmss YYMMDDhhmmss YYYYMMDDhhmmss YYMMDDhhmmss date YYYY-MM-DD YY-MM-DD YYYYMMDD YYMMDD YYYYMMDD YYMMDD time hh:mm:ss hhmmss hhmmss year YYYY YY YYYY YY \u679a\u4e3e\u548c\u96c6\u5408 -- \u679a\u4e3e(enum) ---------- enum(val1, val2, val3...) \u5728\u5df2\u77e5\u7684\u503c\u4e2d\u8fdb\u884c\u5355\u9009\u3002\u6700\u5927\u6570\u91cf\u4e3a65535. \u679a\u4e3e\u503c\u5728\u4fdd\u5b58\u65f6\uff0c\u4ee52\u4e2a\u5b57\u8282\u7684\u6574\u578b(smallint)\u4fdd\u5b58\u3002\u6bcf\u4e2a\u679a\u4e3e\u503c\uff0c\u6309\u4fdd\u5b58\u7684\u4f4d\u7f6e\u987a\u5e8f\uff0c\u4ece1\u5f00\u59cb\u9010\u4e00\u9012\u589e\u3002 \u8868\u73b0\u4e3a\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u5b58\u50a8\u5374\u662f\u6574\u578b\u3002 NULL\u503c\u7684\u7d22\u5f15\u662fNULL\u3002 \u7a7a\u5b57\u7b26\u4e32\u9519\u8bef\u503c\u7684\u7d22\u5f15\u503c\u662f0\u3002 -- \u96c6\u5408\uff08set\uff09 ---------- set(val1, val2, val3...) create table tab ( gender set( \u7537 , \u5973 , \u65e0 ) ); insert into tab values ( \u7537, \u5973 ); \u6700\u591a\u53ef\u4ee5\u670964\u4e2a\u4e0d\u540c\u7684\u6210\u5458\u3002\u4ee5bigint\u5b58\u50a8\uff0c\u51718\u4e2a\u5b57\u8282\u3002\u91c7\u53d6\u4f4d\u8fd0\u7b97\u7684\u5f62\u5f0f\u3002 \u5f53\u521b\u5efa\u8868\u65f6\uff0cSET\u6210\u5458\u503c\u7684\u5c3e\u90e8\u7a7a\u683c\u5c06\u81ea\u52a8\u88ab\u5220\u9664\u3002","title":"\u6570\u636e\u7c7b\u578b\uff08\u5217\u7c7b\u578b\uff09"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_7","text":"-- PHP\u89d2\u5ea6 1. \u529f\u80fd\u6ee1\u8db3 2. \u5b58\u50a8\u7a7a\u95f4\u5c3d\u91cf\u5c0f\uff0c\u5904\u7406\u6548\u7387\u66f4\u9ad8 3. \u8003\u8651\u517c\u5bb9\u95ee\u9898 -- IP\u5b58\u50a8 ---------- 1. \u53ea\u9700\u5b58\u50a8\uff0c\u53ef\u7528\u5b57\u7b26\u4e32 2. \u5982\u679c\u9700\u8ba1\u7b97\uff0c\u67e5\u627e\u7b49\uff0c\u53ef\u5b58\u50a8\u4e3a4\u4e2a\u5b57\u8282\u7684\u65e0\u7b26\u53f7int\uff0c\u5373unsigned 1) PHP\u51fd\u6570\u8f6c\u6362 ip2long\u53ef\u8f6c\u6362\u4e3a\u6574\u578b\uff0c\u4f46\u4f1a\u51fa\u73b0\u643a\u5e26\u7b26\u53f7\u95ee\u9898\u3002\u9700\u683c\u5f0f\u5316\u4e3a\u65e0\u7b26\u53f7\u7684\u6574\u578b\u3002 \u5229\u7528sprintf\u51fd\u6570\u683c\u5f0f\u5316\u5b57\u7b26\u4e32 sprintf(\"%u\", ip2long( 192.168.3.134 )); \u7136\u540e\u7528long2ip\u5c06\u6574\u578b\u8f6c\u56deIP\u5b57\u7b26\u4e32 2) MySQL\u51fd\u6570\u8f6c\u6362(\u65e0\u7b26\u53f7\u6574\u578b\uff0cUNSIGNED) INET_ATON( 127.0.0.1 ) \u5c06IP\u8f6c\u4e3a\u6574\u578b INET_NTOA(2130706433) \u5c06\u6574\u578b\u8f6c\u4e3aIP","title":"\u9009\u62e9\u7c7b\u578b"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_8","text":"1. PRIMARY \u4e3b\u952e - \u80fd\u552f\u4e00\u6807\u8bc6\u8bb0\u5f55\u7684\u5b57\u6bb5\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u4e3b\u952e\u3002 - \u4e00\u4e2a\u8868\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u952e\u3002 - \u4e3b\u952e\u5177\u6709\u552f\u4e00\u6027\u3002 - \u58f0\u660e\u5b57\u6bb5\u65f6\uff0c\u7528 primary key \u6807\u8bc6\u3002 \u4e5f\u53ef\u4ee5\u5728\u5b57\u6bb5\u5217\u8868\u4e4b\u540e\u58f0\u660e \u4f8b\uff1acreate table tab ( id int, stu varchar(10), primary key (id)); - \u4e3b\u952e\u5b57\u6bb5\u7684\u503c\u4e0d\u80fd\u4e3anull\u3002 - \u4e3b\u952e\u53ef\u4ee5\u7531\u591a\u4e2a\u5b57\u6bb5\u5171\u540c\u7ec4\u6210\u3002\u6b64\u65f6\u9700\u8981\u5728\u5b57\u6bb5\u5217\u8868\u540e\u58f0\u660e\u7684\u65b9\u6cd5\u3002 \u4f8b\uff1acreate table tab ( id int, stu varchar(10), age int, primary key (stu, age)); 2. UNIQUE \u552f\u4e00\u7d22\u5f15\uff08\u552f\u4e00\u7ea6\u675f\uff09 \u4f7f\u5f97\u67d0\u5b57\u6bb5\u7684\u503c\u4e5f\u4e0d\u80fd\u91cd\u590d\u3002 3. NULL \u7ea6\u675f null\u4e0d\u662f\u6570\u636e\u7c7b\u578b\uff0c\u662f\u5217\u7684\u4e00\u4e2a\u5c5e\u6027\u3002 \u8868\u793a\u5f53\u524d\u5217\u662f\u5426\u53ef\u4ee5\u4e3anull\uff0c\u8868\u793a\u4ec0\u4e48\u90fd\u6ca1\u6709\u3002 null, \u5141\u8bb8\u4e3a\u7a7a\u3002\u9ed8\u8ba4\u3002 not null, \u4e0d\u5141\u8bb8\u4e3a\u7a7a\u3002 insert into tab values (null, val ); -- \u6b64\u65f6\u8868\u793a\u5c06\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u7684\u503c\u8bbe\u4e3anull, \u53d6\u51b3\u4e8e\u8be5\u5b57\u6bb5\u662f\u5426\u5141\u8bb8\u4e3anull 4. DEFAULT \u9ed8\u8ba4\u503c\u5c5e\u6027 \u5f53\u524d\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002 insert into tab values (default, val ); -- \u6b64\u65f6\u8868\u793a\u5f3a\u5236\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002 create table tab ( add_time timestamp default current_timestamp ); -- \u8868\u793a\u5c06\u5f53\u524d\u65f6\u95f4\u7684\u65f6\u95f4\u6233\u8bbe\u4e3a\u9ed8\u8ba4\u503c\u3002 current_date, current_time 5. AUTO_INCREMENT \u81ea\u52a8\u589e\u957f\u7ea6\u675f \u81ea\u52a8\u589e\u957f\u5fc5\u987b\u4e3a\u7d22\u5f15\uff08\u4e3b\u952e\u6216unique\uff09 \u53ea\u80fd\u5b58\u5728\u4e00\u4e2a\u5b57\u6bb5\u4e3a\u81ea\u52a8\u589e\u957f\u3002 \u9ed8\u8ba4\u4e3a1\u5f00\u59cb\u81ea\u52a8\u589e\u957f\u3002\u53ef\u4ee5\u901a\u8fc7\u8868\u5c5e\u6027 auto_increment = x\u8fdb\u884c\u8bbe\u7f6e\uff0c\u6216 alter table tbl auto_increment = x; 6. COMMENT \u6ce8\u91ca \u4f8b\uff1acreate table tab ( id int ) comment \u6ce8\u91ca\u5185\u5bb9 ; 7. FOREIGN KEY \u5916\u952e\u7ea6\u675f \u7528\u4e8e\u9650\u5236\u4e3b\u8868\u4e0e\u4ece\u8868\u6570\u636e\u5b8c\u6574\u6027\u3002 alter table t1 add constraint `t1_t2_fk` foreign key (t1_id) references t2(id); -- \u5c06\u8868t1\u7684t1_id\u5916\u952e\u5173\u8054\u5230\u8868t2\u7684id\u5b57\u6bb5\u3002 -- \u6bcf\u4e2a\u5916\u952e\u90fd\u6709\u4e00\u4e2a\u540d\u5b57\uff0c\u53ef\u4ee5\u901a\u8fc7 constraint \u6307\u5b9a \u5b58\u5728\u5916\u952e\u7684\u8868\uff0c\u79f0\u4e4b\u4e3a\u4ece\u8868\uff08\u5b50\u8868\uff09\uff0c\u5916\u952e\u6307\u5411\u7684\u8868\uff0c\u79f0\u4e4b\u4e3a\u4e3b\u8868\uff08\u7236\u8868\uff09\u3002 \u4f5c\u7528\uff1a\u4fdd\u6301\u6570\u636e\u4e00\u81f4\u6027\uff0c\u5b8c\u6574\u6027\uff0c\u4e3b\u8981\u76ee\u7684\u662f\u63a7\u5236\u5b58\u50a8\u5728\u5916\u952e\u8868\uff08\u4ece\u8868\uff09\u4e2d\u7684\u6570\u636e\u3002 MySQL\u4e2d\uff0c\u53ef\u4ee5\u5bf9InnoDB\u5f15\u64ce\u4f7f\u7528\u5916\u952e\u7ea6\u675f\uff1a \u8bed\u6cd5\uff1a foreign key (\u5916\u952e\u5b57\u6bb5\uff09 references \u4e3b\u8868\u540d (\u5173\u8054\u5b57\u6bb5) [\u4e3b\u8868\u8bb0\u5f55\u5220\u9664\u65f6\u7684\u52a8\u4f5c] [\u4e3b\u8868\u8bb0\u5f55\u66f4\u65b0\u65f6\u7684\u52a8\u4f5c] \u6b64\u65f6\u9700\u8981\u68c0\u6d4b\u4e00\u4e2a\u4ece\u8868\u7684\u5916\u952e\u9700\u8981\u7ea6\u675f\u4e3a\u4e3b\u8868\u7684\u5df2\u5b58\u5728\u7684\u503c\u3002\u5916\u952e\u5728\u6ca1\u6709\u5173\u8054\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3anull.\u524d\u63d0\u662f\u8be5\u5916\u952e\u5217\uff0c\u6ca1\u6709not null\u3002 \u53ef\u4ee5\u4e0d\u6307\u5b9a\u4e3b\u8868\u8bb0\u5f55\u66f4\u6539\u6216\u66f4\u65b0\u65f6\u7684\u52a8\u4f5c\uff0c\u90a3\u4e48\u6b64\u65f6\u4e3b\u8868\u7684\u64cd\u4f5c\u88ab\u62d2\u7edd\u3002 \u5982\u679c\u6307\u5b9a\u4e86 on update \u6216 on delete\uff1a\u5728\u5220\u9664\u6216\u66f4\u65b0\u65f6\uff0c\u6709\u5982\u4e0b\u51e0\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u9009\u62e9\uff1a 1. cascade\uff0c\u7ea7\u8054\u64cd\u4f5c\u3002\u4e3b\u8868\u6570\u636e\u88ab\u66f4\u65b0\uff08\u4e3b\u952e\u503c\u66f4\u65b0\uff09\uff0c\u4ece\u8868\u4e5f\u88ab\u66f4\u65b0\uff08\u5916\u952e\u503c\u66f4\u65b0\uff09\u3002\u4e3b\u8868\u8bb0\u5f55\u88ab\u5220\u9664\uff0c\u4ece\u8868\u76f8\u5173\u8bb0\u5f55\u4e5f\u88ab\u5220\u9664\u3002 2. set null\uff0c\u8bbe\u7f6e\u4e3anull\u3002\u4e3b\u8868\u6570\u636e\u88ab\u66f4\u65b0\uff08\u4e3b\u952e\u503c\u66f4\u65b0\uff09\uff0c\u4ece\u8868\u7684\u5916\u952e\u88ab\u8bbe\u7f6e\u4e3anull\u3002\u4e3b\u8868\u8bb0\u5f55\u88ab\u5220\u9664\uff0c\u4ece\u8868\u76f8\u5173\u8bb0\u5f55\u5916\u952e\u88ab\u8bbe\u7f6e\u6210null\u3002\u4f46\u6ce8\u610f\uff0c\u8981\u6c42\u8be5\u5916\u952e\u5217\uff0c\u6ca1\u6709not null\u5c5e\u6027\u7ea6\u675f\u3002 3. restrict\uff0c\u62d2\u7edd\u7236\u8868\u5220\u9664\u548c\u66f4\u65b0\u3002 \u6ce8\u610f\uff0c\u5916\u952e\u53ea\u88abInnoDB\u5b58\u50a8\u5f15\u64ce\u6240\u652f\u6301\u3002\u5176\u4ed6\u5f15\u64ce\u662f\u4e0d\u652f\u6301\u7684\u3002","title":"\u5217\u5c5e\u6027\uff08\u5217\u7ea6\u675f\uff09"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_9","text":"-- Normal Format, NF - \u6bcf\u4e2a\u8868\u4fdd\u5b58\u4e00\u4e2a\u5b9e\u4f53\u4fe1\u606f - \u6bcf\u4e2a\u5177\u6709\u4e00\u4e2aID\u5b57\u6bb5\u4f5c\u4e3a\u4e3b\u952e - ID\u4e3b\u952e + \u539f\u5b50\u8868 -- 1NF, \u7b2c\u4e00\u8303\u5f0f \u5b57\u6bb5\u4e0d\u80fd\u518d\u5206\uff0c\u5c31\u6ee1\u8db3\u7b2c\u4e00\u8303\u5f0f\u3002 -- 2NF, \u7b2c\u4e8c\u8303\u5f0f \u6ee1\u8db3\u7b2c\u4e00\u8303\u5f0f\u7684\u524d\u63d0\u4e0b\uff0c\u4e0d\u80fd\u51fa\u73b0\u90e8\u5206\u4f9d\u8d56\u3002 \u6d88\u9664\u7b26\u5408\u4e3b\u952e\u5c31\u53ef\u4ee5\u907f\u514d\u90e8\u5206\u4f9d\u8d56\u3002\u589e\u52a0\u5355\u5217\u5173\u952e\u5b57\u3002 -- 3NF, \u7b2c\u4e09\u8303\u5f0f \u6ee1\u8db3\u7b2c\u4e8c\u8303\u5f0f\u7684\u524d\u63d0\u4e0b\uff0c\u4e0d\u80fd\u51fa\u73b0\u4f20\u9012\u4f9d\u8d56\u3002 \u67d0\u4e2a\u5b57\u6bb5\u4f9d\u8d56\u4e8e\u4e3b\u952e\uff0c\u800c\u6709\u5176\u4ed6\u5b57\u6bb5\u4f9d\u8d56\u4e8e\u8be5\u5b57\u6bb5\u3002\u8fd9\u5c31\u662f\u4f20\u9012\u4f9d\u8d56\u3002 \u5c06\u4e00\u4e2a\u5b9e\u4f53\u4fe1\u606f\u7684\u6570\u636e\u653e\u5728\u4e00\u4e2a\u8868\u5185\u5b9e\u73b0\u3002","title":"\u5efa\u8868\u89c4\u8303"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#select","text":"SELECT [ALL|DISTINCT] select_expr FROM -> WHERE -> GROUP BY [\u5408\u8ba1\u51fd\u6570] -> HAVING -> ORDER BY -> LIMIT a. select_expr -- \u53ef\u4ee5\u7528 * \u8868\u793a\u6240\u6709\u5b57\u6bb5\u3002 select * from tb; -- \u53ef\u4ee5\u4f7f\u7528\u8868\u8fbe\u5f0f\uff08\u8ba1\u7b97\u516c\u5f0f\u3001\u51fd\u6570\u8c03\u7528\u3001\u5b57\u6bb5\u4e5f\u662f\u4e2a\u8868\u8fbe\u5f0f\uff09 select stu, 29+25, now() from tb; -- \u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u5217\u4f7f\u7528\u522b\u540d\u3002\u9002\u7528\u4e8e\u7b80\u5316\u5217\u6807\u8bc6\uff0c\u907f\u514d\u591a\u4e2a\u5217\u6807\u8bc6\u7b26\u91cd\u590d\u3002 - \u4f7f\u7528 as \u5173\u952e\u5b57\uff0c\u4e5f\u53ef\u7701\u7565 as. select stu+10 as add10 from tb; b. FROM \u5b50\u53e5 \u7528\u4e8e\u6807\u8bc6\u67e5\u8be2\u6765\u6e90\u3002 -- \u53ef\u4ee5\u4e3a\u8868\u8d77\u522b\u540d\u3002\u4f7f\u7528as\u5173\u952e\u5b57\u3002 SELECT * FROM tb1 AS tt, tb2 AS bb; -- from\u5b50\u53e5\u540e\uff0c\u53ef\u4ee5\u540c\u65f6\u51fa\u73b0\u591a\u4e2a\u8868\u3002 -- \u591a\u4e2a\u8868\u4f1a\u6a2a\u5411\u53e0\u52a0\u5230\u4e00\u8d77\uff0c\u800c\u6570\u636e\u4f1a\u5f62\u6210\u4e00\u4e2a\u7b1b\u5361\u5c14\u79ef\u3002 SELECT * FROM tb1, tb2; -- \u5411\u4f18\u5316\u7b26\u63d0\u793a\u5982\u4f55\u9009\u62e9\u7d22\u5f15 USE INDEX\u3001IGNORE INDEX\u3001FORCE INDEX SELECT * FROM table1 USE INDEX (key1,key2) WHERE key1=1 AND key2=2 AND key3=3; SELECT * FROM table1 IGNORE INDEX (key3) WHERE key1=1 AND key2=2 AND key3=3; c. WHERE \u5b50\u53e5 -- \u4ecefrom\u83b7\u5f97\u7684\u6570\u636e\u6e90\u4e2d\u8fdb\u884c\u7b5b\u9009\u3002 -- \u6574\u578b1\u8868\u793a\u771f\uff0c0\u8868\u793a\u5047\u3002 -- \u8868\u8fbe\u5f0f\u7531\u8fd0\u7b97\u7b26\u548c\u8fd0\u7b97\u6570\u7ec4\u6210\u3002 -- \u8fd0\u7b97\u6570\uff1a\u53d8\u91cf\uff08\u5b57\u6bb5\uff09\u3001\u503c\u3001\u51fd\u6570\u8fd4\u56de\u503c -- \u8fd0\u7b97\u7b26\uff1a =, <=>, <>, !=, <=, <, >=, >, !, &&, ||, in (not) null, (not) like, (not) in, (not) between and, is (not), and, or, not, xor is/is not \u52a0\u4e0ature/false/unknown\uff0c\u68c0\u9a8c\u67d0\u4e2a\u503c\u7684\u771f\u5047 <=>\u4e0e<>\u529f\u80fd\u76f8\u540c\uff0c<=>\u53ef\u7528\u4e8enull\u6bd4\u8f83 d. GROUP BY \u5b50\u53e5, \u5206\u7ec4\u5b50\u53e5 GROUP BY \u5b57\u6bb5/\u522b\u540d [\u6392\u5e8f\u65b9\u5f0f] \u5206\u7ec4\u540e\u4f1a\u8fdb\u884c\u6392\u5e8f\u3002\u5347\u5e8f\uff1aASC\uff0c\u964d\u5e8f\uff1aDESC \u4ee5\u4e0b[\u5408\u8ba1\u51fd\u6570]\u9700\u914d\u5408 GROUP BY \u4f7f\u7528\uff1a count \u8fd4\u56de\u4e0d\u540c\u7684\u975eNULL\u503c\u6570\u76ee count(*)\u3001count(\u5b57\u6bb5) sum \u6c42\u548c max \u6c42\u6700\u5927\u503c min \u6c42\u6700\u5c0f\u503c avg \u6c42\u5e73\u5747\u503c group_concat \u8fd4\u56de\u5e26\u6709\u6765\u81ea\u4e00\u4e2a\u7ec4\u7684\u8fde\u63a5\u7684\u975eNULL\u503c\u7684\u5b57\u7b26\u4e32\u7ed3\u679c\u3002\u7ec4\u5185\u5b57\u7b26\u4e32\u8fde\u63a5\u3002 e. HAVING \u5b50\u53e5\uff0c\u6761\u4ef6\u5b50\u53e5 \u4e0e where \u529f\u80fd\u3001\u7528\u6cd5\u76f8\u540c\uff0c\u6267\u884c\u65f6\u673a\u4e0d\u540c\u3002 where \u5728\u5f00\u59cb\u65f6\u6267\u884c\u68c0\u6d4b\u6570\u636e\uff0c\u5bf9\u539f\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\u3002 having \u5bf9\u7b5b\u9009\u51fa\u7684\u7ed3\u679c\u518d\u6b21\u8fdb\u884c\u8fc7\u6ee4\u3002 having \u5b57\u6bb5\u5fc5\u987b\u662f\u67e5\u8be2\u51fa\u6765\u7684\uff0cwhere \u5b57\u6bb5\u5fc5\u987b\u662f\u6570\u636e\u8868\u5b58\u5728\u7684\u3002 where \u4e0d\u53ef\u4ee5\u4f7f\u7528\u5b57\u6bb5\u7684\u522b\u540d\uff0chaving \u53ef\u4ee5\u3002\u56e0\u4e3a\u6267\u884cWHERE\u4ee3\u7801\u65f6\uff0c\u53ef\u80fd\u5c1a\u672a\u786e\u5b9a\u5217\u503c\u3002 where \u4e0d\u53ef\u4ee5\u4f7f\u7528\u5408\u8ba1\u51fd\u6570\u3002\u4e00\u822c\u9700\u7528\u5408\u8ba1\u51fd\u6570\u624d\u4f1a\u7528 having SQL\u6807\u51c6\u8981\u6c42HAVING\u5fc5\u987b\u5f15\u7528GROUP BY\u5b50\u53e5\u4e2d\u7684\u5217\u6216\u7528\u4e8e\u5408\u8ba1\u51fd\u6570\u4e2d\u7684\u5217\u3002 f. ORDER BY \u5b50\u53e5\uff0c\u6392\u5e8f\u5b50\u53e5 order by \u6392\u5e8f\u5b57\u6bb5/\u522b\u540d \u6392\u5e8f\u65b9\u5f0f [,\u6392\u5e8f\u5b57\u6bb5/\u522b\u540d \u6392\u5e8f\u65b9\u5f0f]... \u5347\u5e8f\uff1aASC\uff0c\u964d\u5e8f\uff1aDESC \u652f\u6301\u591a\u4e2a\u5b57\u6bb5\u7684\u6392\u5e8f\u3002 g. LIMIT \u5b50\u53e5\uff0c\u9650\u5236\u7ed3\u679c\u6570\u91cf\u5b50\u53e5 \u4ec5\u5bf9\u5904\u7406\u597d\u7684\u7ed3\u679c\u8fdb\u884c\u6570\u91cf\u9650\u5236\u3002\u5c06\u5904\u7406\u597d\u7684\u7ed3\u679c\u7684\u770b\u4f5c\u662f\u4e00\u4e2a\u96c6\u5408\uff0c\u6309\u7167\u8bb0\u5f55\u51fa\u73b0\u7684\u987a\u5e8f\uff0c\u7d22\u5f15\u4ece0\u5f00\u59cb\u3002 limit \u8d77\u59cb\u4f4d\u7f6e, \u83b7\u53d6\u6761\u6570 \u7701\u7565\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u8868\u793a\u4ece\u7d22\u5f150\u5f00\u59cb\u3002limit \u83b7\u53d6\u6761\u6570 h. DISTINCT, ALL \u9009\u9879 distinct \u53bb\u9664\u91cd\u590d\u8bb0\u5f55 \u9ed8\u8ba4\u4e3a all, \u5168\u90e8\u8bb0\u5f55","title":"SELECT"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#union","text":"\u5c06\u591a\u4e2aselect\u67e5\u8be2\u7684\u7ed3\u679c\u7ec4\u5408\u6210\u4e00\u4e2a\u7ed3\u679c\u96c6\u5408\u3002 SELECT ... UNION [ALL|DISTINCT] SELECT ... \u9ed8\u8ba4 DISTINCT \u65b9\u5f0f\uff0c\u5373\u6240\u6709\u8fd4\u56de\u7684\u884c\u90fd\u662f\u552f\u4e00\u7684 \u5efa\u8bae\uff0c\u5bf9\u6bcf\u4e2aSELECT\u67e5\u8be2\u52a0\u4e0a\u5c0f\u62ec\u53f7\u5305\u88f9\u3002 ORDER BY \u6392\u5e8f\u65f6\uff0c\u9700\u52a0\u4e0a LIMIT \u8fdb\u884c\u7ed3\u5408\u3002 \u9700\u8981\u5404select\u67e5\u8be2\u7684\u5b57\u6bb5\u6570\u91cf\u4e00\u6837\u3002 \u6bcf\u4e2aselect\u67e5\u8be2\u7684\u5b57\u6bb5\u5217\u8868(\u6570\u91cf\u3001\u7c7b\u578b)\u5e94\u4e00\u81f4\uff0c\u56e0\u4e3a\u7ed3\u679c\u4e2d\u7684\u5b57\u6bb5\u540d\u4ee5\u7b2c\u4e00\u6761select\u8bed\u53e5\u4e3a\u51c6\u3002","title":"UNION"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_10","text":"- \u5b50\u67e5\u8be2\u9700\u7528\u62ec\u53f7\u5305\u88f9\u3002 -- from\u578b from\u540e\u8981\u6c42\u662f\u4e00\u4e2a\u8868\uff0c\u5fc5\u987b\u7ed9\u5b50\u67e5\u8be2\u7ed3\u679c\u53d6\u4e2a\u522b\u540d\u3002 - \u7b80\u5316\u6bcf\u4e2a\u67e5\u8be2\u5185\u7684\u6761\u4ef6\u3002 - from\u578b\u9700\u5c06\u7ed3\u679c\u751f\u6210\u4e00\u4e2a\u4e34\u65f6\u8868\u683c\uff0c\u53ef\u7528\u4ee5\u539f\u8868\u7684\u9501\u5b9a\u7684\u91ca\u653e\u3002 - \u5b50\u67e5\u8be2\u8fd4\u56de\u4e00\u4e2a\u8868\uff0c\u8868\u578b\u5b50\u67e5\u8be2\u3002 select * from (select * from tb where id>0) as subfrom where id>1; -- where\u578b - \u5b50\u67e5\u8be2\u8fd4\u56de\u4e00\u4e2a\u503c\uff0c\u6807\u91cf\u5b50\u67e5\u8be2\u3002 - \u4e0d\u9700\u8981\u7ed9\u5b50\u67e5\u8be2\u53d6\u522b\u540d\u3002 - where\u5b50\u67e5\u8be2\u5185\u7684\u8868\uff0c\u4e0d\u80fd\u76f4\u63a5\u7528\u4ee5\u66f4\u65b0\u3002 select * from tb where money = (select max(money) from tb); -- \u5217\u5b50\u67e5\u8be2 \u5982\u679c\u5b50\u67e5\u8be2\u7ed3\u679c\u8fd4\u56de\u7684\u662f\u4e00\u5217\u3002 \u4f7f\u7528 in \u6216 not in \u5b8c\u6210\u67e5\u8be2 exists \u548c not exists \u6761\u4ef6 \u5982\u679c\u5b50\u67e5\u8be2\u8fd4\u56de\u6570\u636e\uff0c\u5219\u8fd4\u56de1\u62160\u3002\u5e38\u7528\u4e8e\u5224\u65ad\u6761\u4ef6\u3002 select column1 from t1 where exists (select * from t2); -- \u884c\u5b50\u67e5\u8be2 \u67e5\u8be2\u6761\u4ef6\u662f\u4e00\u4e2a\u884c\u3002 select * from t1 where (id, gender) in (select id, gender from t2); \u884c\u6784\u9020\u7b26\uff1a(col1, col2, ...) \u6216 ROW(col1, col2, ...) \u884c\u6784\u9020\u7b26\u901a\u5e38\u7528\u4e8e\u4e0e\u5bf9\u80fd\u8fd4\u56de\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u5217\u7684\u5b50\u67e5\u8be2\u8fdb\u884c\u6bd4\u8f83\u3002 -- \u7279\u6b8a\u8fd0\u7b97\u7b26 != all() \u76f8\u5f53\u4e8e not in = some() \u76f8\u5f53\u4e8e in\u3002any \u662f some \u7684\u522b\u540d != some() \u4e0d\u7b49\u540c\u4e8e not in\uff0c\u4e0d\u7b49\u4e8e\u5176\u4e2d\u67d0\u4e00\u4e2a\u3002 all, some \u53ef\u4ee5\u914d\u5408\u5176\u4ed6\u8fd0\u7b97\u7b26\u4e00\u8d77\u4f7f\u7528\u3002","title":"\u5b50\u67e5\u8be2"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#join","text":"\u5c06\u591a\u4e2a\u8868\u7684\u5b57\u6bb5\u8fdb\u884c\u8fde\u63a5\uff0c\u53ef\u4ee5\u6307\u5b9a\u8fde\u63a5\u6761\u4ef6\u3002 -- \u5185\u8fde\u63a5(inner join) - \u9ed8\u8ba4\u5c31\u662f\u5185\u8fde\u63a5\uff0c\u53ef\u7701\u7565inner\u3002 - \u53ea\u6709\u6570\u636e\u5b58\u5728\u65f6\u624d\u80fd\u53d1\u9001\u8fde\u63a5\u3002\u5373\u8fde\u63a5\u7ed3\u679c\u4e0d\u80fd\u51fa\u73b0\u7a7a\u884c\u3002 on \u8868\u793a\u8fde\u63a5\u6761\u4ef6\u3002\u5176\u6761\u4ef6\u8868\u8fbe\u5f0f\u4e0ewhere\u7c7b\u4f3c\u3002\u4e5f\u53ef\u4ee5\u7701\u7565\u6761\u4ef6\uff08\u8868\u793a\u6761\u4ef6\u6c38\u8fdc\u4e3a\u771f\uff09 \u4e5f\u53ef\u7528where\u8868\u793a\u8fde\u63a5\u6761\u4ef6\u3002 \u8fd8\u6709 using, \u4f46\u9700\u5b57\u6bb5\u540d\u76f8\u540c\u3002 using(\u5b57\u6bb5\u540d) -- \u4ea4\u53c9\u8fde\u63a5 cross join \u5373\uff0c\u6ca1\u6709\u6761\u4ef6\u7684\u5185\u8fde\u63a5\u3002 select * from tb1 cross join tb2; -- \u5916\u8fde\u63a5(outer join) - \u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u4e5f\u4f1a\u51fa\u73b0\u5728\u8fde\u63a5\u7ed3\u679c\u4e2d\u3002 -- \u5de6\u5916\u8fde\u63a5 left join \u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u5de6\u8868\u8bb0\u5f55\u4f1a\u51fa\u73b0\uff0c\u800c\u53f3\u8868\u4e3anull\u586b\u5145 -- \u53f3\u5916\u8fde\u63a5 right join \u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\uff0c\u53f3\u8868\u8bb0\u5f55\u4f1a\u51fa\u73b0\uff0c\u800c\u5de6\u8868\u4e3anull\u586b\u5145 -- \u81ea\u7136\u8fde\u63a5(natural join) \u81ea\u52a8\u5224\u65ad\u8fde\u63a5\u6761\u4ef6\u5b8c\u6210\u8fde\u63a5\u3002 \u76f8\u5f53\u4e8e\u7701\u7565\u4e86using\uff0c\u4f1a\u81ea\u52a8\u67e5\u627e\u76f8\u540c\u5b57\u6bb5\u540d\u3002 natural join natural left join natural right join select info.id, info.name, info.stu_num, extra_info.hobby, extra_info.sex from info, extra_info where info.stu_num = extra_info.stu_id;","title":"\u8fde\u63a5\u67e5\u8be2(join)"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_11","text":"select * into outfile \u6587\u4ef6\u5730\u5740 [\u63a7\u5236\u683c\u5f0f] from \u8868\u540d; -- \u5bfc\u51fa\u8868\u6570\u636e load data [local] infile \u6587\u4ef6\u5730\u5740 [replace|ignore] into table \u8868\u540d [\u63a7\u5236\u683c\u5f0f]; -- \u5bfc\u5165\u6570\u636e \u751f\u6210\u7684\u6570\u636e\u9ed8\u8ba4\u7684\u5206\u9694\u7b26\u662f\u5236\u8868\u7b26 local\u672a\u6307\u5b9a\uff0c\u5219\u6570\u636e\u6587\u4ef6\u5fc5\u987b\u5728\u670d\u52a1\u5668\u4e0a replace \u548c ignore \u5173\u952e\u8bcd\u63a7\u5236\u5bf9\u73b0\u6709\u7684\u552f\u4e00\u952e\u8bb0\u5f55\u7684\u91cd\u590d\u7684\u5904\u7406 -- \u63a7\u5236\u683c\u5f0f fields \u63a7\u5236\u5b57\u6bb5\u683c\u5f0f \u9ed8\u8ba4\uff1afields terminated by enclosed by escaped by terminated by string -- \u7ec8\u6b62 enclosed by char -- \u5305\u88f9 escaped by char -- \u8f6c\u4e49 -- \u793a\u4f8b\uff1a SELECT a,b,a+b INTO OUTFILE /tmp/result.text FIELDS TERMINATED BY , OPTIONALLY ENCLOSED BY \" LINES TERMINATED BY FROM test_table; lines \u63a7\u5236\u884c\u683c\u5f0f \u9ed8\u8ba4\uff1alines terminated by terminated by string -- \u7ec8\u6b62","title":"\u5bfc\u51fa"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#insert","text":"select\u8bed\u53e5\u83b7\u5f97\u7684\u6570\u636e\u53ef\u4ee5\u7528insert\u63d2\u5165\u3002 \u53ef\u4ee5\u7701\u7565\u5bf9\u5217\u7684\u6307\u5b9a\uff0c\u8981\u6c42 values () \u62ec\u53f7\u5185\uff0c\u63d0\u4f9b\u7ed9\u4e86\u6309\u7167\u5217\u987a\u5e8f\u51fa\u73b0\u7684\u6240\u6709\u5b57\u6bb5\u7684\u503c\u3002 \u6216\u8005\u4f7f\u7528set\u8bed\u6cd5\u3002 INSERT INTO tbl_name SET field=value,...\uff1b \u53ef\u4ee5\u4e00\u6b21\u6027\u4f7f\u7528\u591a\u4e2a\u503c\uff0c\u91c7\u7528(), (), ();\u7684\u5f62\u5f0f\u3002 INSERT INTO tbl_name VALUES (), (), (); \u53ef\u4ee5\u5728\u5217\u503c\u6307\u5b9a\u65f6\uff0c\u4f7f\u7528\u8868\u8fbe\u5f0f\u3002 INSERT INTO tbl_name VALUES (field_value, 10+10, now()); \u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u7279\u6b8a\u503c DEFAULT\uff0c\u8868\u793a\u8be5\u5217\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002 INSERT INTO tbl_name VALUES (field_value, DEFAULT); \u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u4f5c\u4e3a\u9700\u8981\u63d2\u5165\u7684\u503c\u3002 INSERT INTO tbl_name SELECT ...; \u53ef\u4ee5\u6307\u5b9a\u5728\u63d2\u5165\u7684\u503c\u51fa\u73b0\u4e3b\u952e\uff08\u6216\u552f\u4e00\u7d22\u5f15\uff09\u51b2\u7a81\u65f6\uff0c\u66f4\u65b0\u5176\u4ed6\u975e\u4e3b\u952e\u5217\u7684\u4fe1\u606f\u3002 INSERT INTO tbl_name VALUES/SET/SELECT ON DUPLICATE KEY UPDATE \u5b57\u6bb5=\u503c, \u2026;","title":"INSERT"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#delete","text":"DELETE FROM tbl_name [WHERE where_definition] [ORDER BY ...] [LIMIT row_count] \u6309\u7167\u6761\u4ef6\u5220\u9664\u3002where \u6307\u5b9a\u5220\u9664\u7684\u6700\u591a\u8bb0\u5f55\u6570\u3002limit \u53ef\u4ee5\u901a\u8fc7\u6392\u5e8f\u6761\u4ef6\u5220\u9664\u3002order by + limit \u652f\u6301\u591a\u8868\u5220\u9664\uff0c\u4f7f\u7528\u7c7b\u4f3c\u8fde\u63a5\u8bed\u6cd5\u3002 delete from \u9700\u8981\u5220\u9664\u6570\u636e\u591a\u88681\uff0c\u88682 using \u8868\u8fde\u63a5\u64cd\u4f5c \u6761\u4ef6\u3002","title":"DELETE"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#truncate","text":"TRUNCATE [TABLE] tbl_name \u6e05\u7a7a\u6570\u636e \u5220\u9664\u91cd\u5efa\u8868 \u533a\u522b\uff1a 1\uff0ctruncate \u662f\u5220\u9664\u8868\u518d\u521b\u5efa\uff0cdelete \u662f\u9010\u6761\u5220\u9664 2\uff0ctruncate \u91cd\u7f6eauto_increment\u7684\u503c\u3002\u800cdelete\u4e0d\u4f1a 3\uff0ctruncate \u4e0d\u77e5\u9053\u5220\u9664\u4e86\u51e0\u6761\uff0c\u800cdelete\u77e5\u9053\u3002 4\uff0c\u5f53\u88ab\u7528\u4e8e\u5e26\u5206\u533a\u7684\u8868\u65f6\uff0ctruncate \u4f1a\u4fdd\u7559\u5206\u533a","title":"TRUNCATE"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_12","text":"\u5907\u4efd\uff0c\u5c06\u6570\u636e\u7684\u7ed3\u6784\u4e0e\u8868\u5185\u6570\u636e\u4fdd\u5b58\u8d77\u6765\u3002 \u5229\u7528 mysqldump \u6307\u4ee4\u5b8c\u6210\u3002 -- \u5bfc\u51fa mysqldump [options] db_name [tables] mysqldump [options] ---database DB1 [DB2 DB3...] mysqldump [options] --all--database 1. \u5bfc\u51fa\u4e00\u5f20\u8868 mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d \u8868\u540d > \u6587\u4ef6\u540d(D:/a.sql) 2. \u5bfc\u51fa\u591a\u5f20\u8868 mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d \u88681 \u88682 \u88683 > \u6587\u4ef6\u540d(D:/a.sql) 3. \u5bfc\u51fa\u6240\u6709\u8868 mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d > \u6587\u4ef6\u540d(D:/a.sql) 4. \u5bfc\u51fa\u4e00\u4e2a\u5e93 mysqldump -u\u7528\u6237\u540d -p\u5bc6\u7801 --lock-all-tables --database \u5e93\u540d > \u6587\u4ef6\u540d(D:/a.sql) \u53ef\u4ee5-w\u643a\u5e26WHERE\u6761\u4ef6 -- \u5bfc\u5165 1. \u5728\u767b\u5f55mysql\u7684\u60c5\u51b5\u4e0b\uff1a source \u5907\u4efd\u6587\u4ef6 2. \u5728\u4e0d\u767b\u5f55\u7684\u60c5\u51b5\u4e0b mysql -u\u7528\u6237\u540d -p\u5bc6\u7801 \u5e93\u540d < \u5907\u4efd\u6587\u4ef6","title":"\u5907\u4efd\u4e0e\u8fd8\u539f"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_13","text":"\u4ec0\u4e48\u662f\u89c6\u56fe\uff1a \u89c6\u56fe\u662f\u4e00\u4e2a\u865a\u62df\u8868\uff0c\u5176\u5185\u5bb9\u7531\u67e5\u8be2\u5b9a\u4e49\u3002\u540c\u771f\u5b9e\u7684\u8868\u4e00\u6837\uff0c\u89c6\u56fe\u5305\u542b\u4e00\u7cfb\u5217\u5e26\u6709\u540d\u79f0\u7684\u5217\u548c\u884c\u6570\u636e\u3002\u4f46\u662f\uff0c\u89c6\u56fe\u5e76\u4e0d\u5728\u6570\u636e\u5e93\u4e2d\u4ee5\u5b58\u50a8\u7684\u6570\u636e\u503c\u96c6\u5f62\u5f0f\u5b58\u5728\u3002\u884c\u548c\u5217\u6570\u636e\u6765\u81ea\u7531\u5b9a\u4e49\u89c6\u56fe\u7684\u67e5\u8be2\u6240\u5f15\u7528\u7684\u8868\uff0c\u5e76\u4e14\u5728\u5f15\u7528\u89c6\u56fe\u65f6\u52a8\u6001\u751f\u6210\u3002 \u89c6\u56fe\u5177\u6709\u8868\u7ed3\u6784\u6587\u4ef6\uff0c\u4f46\u4e0d\u5b58\u5728\u6570\u636e\u6587\u4ef6\u3002 \u5bf9\u5176\u4e2d\u6240\u5f15\u7528\u7684\u57fa\u7840\u8868\u6765\u8bf4\uff0c\u89c6\u56fe\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e\u7b5b\u9009\u3002\u5b9a\u4e49\u89c6\u56fe\u7684\u7b5b\u9009\u53ef\u4ee5\u6765\u81ea\u5f53\u524d\u6216\u5176\u5b83\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u8868\uff0c\u6216\u8005\u5176\u5b83\u89c6\u56fe\u3002\u901a\u8fc7\u89c6\u56fe\u8fdb\u884c\u67e5\u8be2\u6ca1\u6709\u4efb\u4f55\u9650\u5236\uff0c\u901a\u8fc7\u5b83\u4eec\u8fdb\u884c\u6570\u636e\u4fee\u6539\u65f6\u7684\u9650\u5236\u4e5f\u5f88\u5c11\u3002 \u89c6\u56fe\u662f\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u7684\u67e5\u8be2\u7684sql\u8bed\u53e5\uff0c\u5b83\u4e3b\u8981\u51fa\u4e8e\u4e24\u79cd\u539f\u56e0\uff1a\u5b89\u5168\u539f\u56e0\uff0c\u89c6\u56fe\u53ef\u4ee5\u9690\u85cf\u4e00\u4e9b\u6570\u636e\uff0c\u5982\uff1a\u793e\u4f1a\u4fdd\u9669\u57fa\u91d1\u8868\uff0c\u53ef\u4ee5\u7528\u89c6\u56fe\u53ea\u663e\u793a\u59d3\u540d\uff0c\u5730\u5740\uff0c\u800c\u4e0d\u663e\u793a\u793e\u4f1a\u4fdd\u9669\u53f7\u548c\u5de5\u8d44\u6570\u7b49\uff0c\u53e6\u4e00\u539f\u56e0\u662f\u53ef\u4f7f\u590d\u6742\u7684\u67e5\u8be2\u6613\u4e8e\u7406\u89e3\u548c\u4f7f\u7528\u3002 -- \u521b\u5efa\u89c6\u56fe CREATE [OR REPLACE] [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}] VIEW view_name [(column_list)] AS select_statement - \u89c6\u56fe\u540d\u5fc5\u987b\u552f\u4e00\uff0c\u540c\u65f6\u4e0d\u80fd\u4e0e\u8868\u91cd\u540d\u3002 - \u89c6\u56fe\u53ef\u4ee5\u4f7f\u7528select\u8bed\u53e5\u67e5\u8be2\u5230\u7684\u5217\u540d\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u6307\u5b9a\u76f8\u5e94\u7684\u5217\u540d\u3002 - \u53ef\u4ee5\u6307\u5b9a\u89c6\u56fe\u6267\u884c\u7684\u7b97\u6cd5\uff0c\u901a\u8fc7ALGORITHM\u6307\u5b9a\u3002 - column_list\u5982\u679c\u5b58\u5728\uff0c\u5219\u6570\u76ee\u5fc5\u987b\u7b49\u4e8eSELECT\u8bed\u53e5\u68c0\u7d22\u7684\u5217\u6570 -- \u67e5\u770b\u7ed3\u6784 SHOW CREATE VIEW view_name -- \u5220\u9664\u89c6\u56fe - \u5220\u9664\u89c6\u56fe\u540e\uff0c\u6570\u636e\u4f9d\u7136\u5b58\u5728\u3002 - \u53ef\u540c\u65f6\u5220\u9664\u591a\u4e2a\u89c6\u56fe\u3002 DROP VIEW [IF EXISTS] view_name ... -- \u4fee\u6539\u89c6\u56fe\u7ed3\u6784 - \u4e00\u822c\u4e0d\u4fee\u6539\u89c6\u56fe\uff0c\u56e0\u4e3a\u4e0d\u662f\u6240\u6709\u7684\u66f4\u65b0\u89c6\u56fe\u90fd\u4f1a\u6620\u5c04\u5230\u8868\u4e0a\u3002 ALTER VIEW view_name [(column_list)] AS select_statement -- \u89c6\u56fe\u4f5c\u7528 1. \u7b80\u5316\u4e1a\u52a1\u903b\u8f91 2. \u5bf9\u5ba2\u6237\u7aef\u9690\u85cf\u771f\u5b9e\u7684\u8868\u7ed3\u6784 -- \u89c6\u56fe\u7b97\u6cd5(ALGORITHM) MERGE \u5408\u5e76 \u5c06\u89c6\u56fe\u7684\u67e5\u8be2\u8bed\u53e5\uff0c\u4e0e\u5916\u90e8\u67e5\u8be2\u9700\u8981\u5148\u5408\u5e76\u518d\u6267\u884c\uff01 TEMPTABLE \u4e34\u65f6\u8868 \u5c06\u89c6\u56fe\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u5f62\u6210\u4e34\u65f6\u8868\uff0c\u518d\u505a\u5916\u5c42\u67e5\u8be2\uff01 UNDEFINED \u672a\u5b9a\u4e49(\u9ed8\u8ba4)\uff0c\u6307\u7684\u662fMySQL\u81ea\u4e3b\u53bb\u9009\u62e9\u76f8\u5e94\u7684\u7b97\u6cd5\u3002","title":"\u89c6\u56fe"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#transaction","text":"\u4e8b\u52a1\u662f\u6307\u903b\u8f91\u4e0a\u7684\u4e00\u7ec4\u64cd\u4f5c\uff0c\u7ec4\u6210\u8fd9\u7ec4\u64cd\u4f5c\u7684\u5404\u4e2a\u5355\u5143\uff0c\u8981\u4e0d\u5168\u6210\u529f\u8981\u4e0d\u5168\u5931\u8d25\u3002 - \u652f\u6301\u8fde\u7eedSQL\u7684\u96c6\u4f53\u6210\u529f\u6216\u96c6\u4f53\u64a4\u9500\u3002 - \u4e8b\u52a1\u662f\u6570\u636e\u5e93\u5728\u6570\u636e\u665a\u81ea\u4e60\u65b9\u9762\u7684\u4e00\u4e2a\u529f\u80fd\u3002 - \u9700\u8981\u5229\u7528 InnoDB \u6216 BDB \u5b58\u50a8\u5f15\u64ce\uff0c\u5bf9\u81ea\u52a8\u63d0\u4ea4\u7684\u7279\u6027\u652f\u6301\u5b8c\u6210\u3002 - InnoDB\u88ab\u79f0\u4e3a\u4e8b\u52a1\u5b89\u5168\u578b\u5f15\u64ce\u3002 -- \u4e8b\u52a1\u5f00\u542f START TRANSACTION; \u6216\u8005 BEGIN; \u5f00\u542f\u4e8b\u52a1\u540e\uff0c\u6240\u6709\u88ab\u6267\u884c\u7684SQL\u8bed\u53e5\u5747\u88ab\u8ba4\u4f5c\u5f53\u524d\u4e8b\u52a1\u5185\u7684SQL\u8bed\u53e5\u3002 -- \u4e8b\u52a1\u63d0\u4ea4 COMMIT; -- \u4e8b\u52a1\u56de\u6eda ROLLBACK; \u5982\u679c\u90e8\u5206\u64cd\u4f5c\u53d1\u751f\u95ee\u9898\uff0c\u6620\u5c04\u5230\u4e8b\u52a1\u5f00\u542f\u524d\u3002 -- \u4e8b\u52a1\u7684\u7279\u6027 1. \u539f\u5b50\u6027\uff08Atomicity\uff09 \u4e8b\u52a1\u662f\u4e00\u4e2a\u4e0d\u53ef\u5206\u5272\u7684\u5de5\u4f5c\u5355\u4f4d\uff0c\u4e8b\u52a1\u4e2d\u7684\u64cd\u4f5c\u8981\u4e48\u90fd\u53d1\u751f\uff0c\u8981\u4e48\u90fd\u4e0d\u53d1\u751f\u3002 2. \u4e00\u81f4\u6027\uff08Consistency\uff09 \u4e8b\u52a1\u524d\u540e\u6570\u636e\u7684\u5b8c\u6574\u6027\u5fc5\u987b\u4fdd\u6301\u4e00\u81f4\u3002 - \u4e8b\u52a1\u5f00\u59cb\u548c\u7ed3\u675f\u65f6\uff0c\u5916\u90e8\u6570\u636e\u4e00\u81f4 - \u5728\u6574\u4e2a\u4e8b\u52a1\u8fc7\u7a0b\u4e2d\uff0c\u64cd\u4f5c\u662f\u8fde\u7eed\u7684 3. \u9694\u79bb\u6027\uff08Isolation\uff09 \u591a\u4e2a\u7528\u6237\u5e76\u53d1\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\uff0c\u4e00\u4e2a\u7528\u6237\u7684\u4e8b\u52a1\u4e0d\u80fd\u88ab\u5176\u5b83\u7528\u6237\u7684\u4e8b\u7269\u6240\u5e72\u6270\uff0c\u591a\u4e2a\u5e76\u53d1\u4e8b\u52a1\u4e4b\u95f4\u7684\u6570\u636e\u8981\u76f8\u4e92\u9694\u79bb\u3002 4. \u6301\u4e45\u6027\uff08Durability\uff09 \u4e00\u4e2a\u4e8b\u52a1\u4e00\u65e6\u88ab\u63d0\u4ea4\uff0c\u5b83\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u6539\u53d8\u5c31\u662f\u6c38\u4e45\u6027\u7684\u3002 -- \u4e8b\u52a1\u7684\u5b9e\u73b0 1. \u8981\u6c42\u662f\u4e8b\u52a1\u652f\u6301\u7684\u8868\u7c7b\u578b 2. \u6267\u884c\u4e00\u7ec4\u76f8\u5173\u7684\u64cd\u4f5c\u524d\u5f00\u542f\u4e8b\u52a1 3. \u6574\u7ec4\u64cd\u4f5c\u5b8c\u6210\u540e\uff0c\u90fd\u6210\u529f\uff0c\u5219\u63d0\u4ea4\uff1b\u5982\u679c\u5b58\u5728\u5931\u8d25\uff0c\u9009\u62e9\u56de\u6eda\uff0c\u5219\u4f1a\u56de\u5230\u4e8b\u52a1\u5f00\u59cb\u7684\u5907\u4efd\u70b9\u3002 -- \u4e8b\u52a1\u7684\u539f\u7406 \u5229\u7528InnoDB\u7684\u81ea\u52a8\u63d0\u4ea4(autocommit)\u7279\u6027\u5b8c\u6210\u3002 \u666e\u901a\u7684MySQL\u6267\u884c\u8bed\u53e5\u540e\uff0c\u5f53\u524d\u7684\u6570\u636e\u63d0\u4ea4\u64cd\u4f5c\u5747\u53ef\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u53ef\u89c1\u3002 \u800c\u4e8b\u52a1\u662f\u6682\u65f6\u5173\u95ed\u201c\u81ea\u52a8\u63d0\u4ea4\u201d\u673a\u5236\uff0c\u9700\u8981commit\u63d0\u4ea4\u6301\u4e45\u5316\u6570\u636e\u64cd\u4f5c\u3002 -- \u6ce8\u610f 1. \u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff08DDL\uff09\u8bed\u53e5\u4e0d\u80fd\u88ab\u56de\u6eda\uff0c\u6bd4\u5982\u521b\u5efa\u6216\u53d6\u6d88\u6570\u636e\u5e93\u7684\u8bed\u53e5\uff0c\u548c\u521b\u5efa\u3001\u53d6\u6d88\u6216\u66f4\u6539\u8868\u6216\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f\u7684\u8bed\u53e5\u3002 2. \u4e8b\u52a1\u4e0d\u80fd\u88ab\u5d4c\u5957 -- \u4fdd\u5b58\u70b9 SAVEPOINT \u4fdd\u5b58\u70b9\u540d\u79f0 -- \u8bbe\u7f6e\u4e00\u4e2a\u4e8b\u52a1\u4fdd\u5b58\u70b9 ROLLBACK TO SAVEPOINT \u4fdd\u5b58\u70b9\u540d\u79f0 -- \u56de\u6eda\u5230\u4fdd\u5b58\u70b9 RELEASE SAVEPOINT \u4fdd\u5b58\u70b9\u540d\u79f0 -- \u5220\u9664\u4fdd\u5b58\u70b9 -- InnoDB\u81ea\u52a8\u63d0\u4ea4\u7279\u6027\u8bbe\u7f6e SET autocommit = 0|1; 0\u8868\u793a\u5173\u95ed\u81ea\u52a8\u63d0\u4ea4\uff0c1\u8868\u793a\u5f00\u542f\u81ea\u52a8\u63d0\u4ea4\u3002 - \u5982\u679c\u5173\u95ed\u4e86\uff0c\u90a3\u666e\u901a\u64cd\u4f5c\u7684\u7ed3\u679c\u5bf9\u5176\u4ed6\u5ba2\u6237\u7aef\u4e5f\u4e0d\u53ef\u89c1\uff0c\u9700\u8981commit\u63d0\u4ea4\u540e\u624d\u80fd\u6301\u4e45\u5316\u6570\u636e\u64cd\u4f5c\u3002 - \u4e5f\u53ef\u4ee5\u5173\u95ed\u81ea\u52a8\u63d0\u4ea4\u6765\u5f00\u542f\u4e8b\u52a1\u3002\u4f46\u4e0eSTART TRANSACTION\u4e0d\u540c\u7684\u662f\uff0c SET autocommit\u662f\u6c38\u4e45\u6539\u53d8\u670d\u52a1\u5668\u7684\u8bbe\u7f6e\uff0c\u76f4\u5230\u4e0b\u6b21\u518d\u6b21\u4fee\u6539\u8be5\u8bbe\u7f6e\u3002(\u9488\u5bf9\u5f53\u524d\u8fde\u63a5) \u800cSTART TRANSACTION\u8bb0\u5f55\u5f00\u542f\u524d\u7684\u72b6\u6001\uff0c\u800c\u4e00\u65e6\u4e8b\u52a1\u63d0\u4ea4\u6216\u56de\u6eda\u540e\u5c31\u9700\u8981\u518d\u6b21\u5f00\u542f\u4e8b\u52a1\u3002(\u9488\u5bf9\u5f53\u524d\u4e8b\u52a1)","title":"\u4e8b\u52a1(transaction)"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_14","text":"\u8868\u9501\u5b9a\u53ea\u7528\u4e8e\u9632\u6b62\u5176\u5b83\u5ba2\u6237\u7aef\u8fdb\u884c\u4e0d\u6b63\u5f53\u5730\u8bfb\u53d6\u548c\u5199\u5165 MyISAM \u652f\u6301\u8868\u9501\uff0cInnoDB \u652f\u6301\u884c\u9501 -- \u9501\u5b9a LOCK TABLES tbl_name [AS alias] -- \u89e3\u9501 UNLOCK TABLES","title":"\u9501\u8868"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_15","text":"\u89e6\u53d1\u7a0b\u5e8f\u662f\u4e0e\u8868\u6709\u5173\u7684\u547d\u540d\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u5f53\u8be5\u8868\u51fa\u73b0\u7279\u5b9a\u4e8b\u4ef6\u65f6\uff0c\u5c06\u6fc0\u6d3b\u8be5\u5bf9\u8c61 \u76d1\u542c\uff1a\u8bb0\u5f55\u7684\u589e\u52a0\u3001\u4fee\u6539\u3001\u5220\u9664\u3002 -- \u521b\u5efa\u89e6\u53d1\u5668 CREATE TRIGGER trigger_name trigger_time trigger_event ON tbl_name FOR EACH ROW trigger_stmt \u53c2\u6570\uff1a trigger_time\u662f\u89e6\u53d1\u7a0b\u5e8f\u7684\u52a8\u4f5c\u65f6\u95f4\u3002\u5b83\u53ef\u4ee5\u662f before \u6216 after\uff0c\u4ee5\u6307\u660e\u89e6\u53d1\u7a0b\u5e8f\u662f\u5728\u6fc0\u6d3b\u5b83\u7684\u8bed\u53e5\u4e4b\u524d\u6216\u4e4b\u540e\u89e6\u53d1\u3002 trigger_event\u6307\u660e\u4e86\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f\u7684\u8bed\u53e5\u7684\u7c7b\u578b INSERT\uff1a\u5c06\u65b0\u884c\u63d2\u5165\u8868\u65f6\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f UPDATE\uff1a\u66f4\u6539\u67d0\u4e00\u884c\u65f6\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f DELETE\uff1a\u4ece\u8868\u4e2d\u5220\u9664\u67d0\u4e00\u884c\u65f6\u6fc0\u6d3b\u89e6\u53d1\u7a0b\u5e8f tbl_name\uff1a\u76d1\u542c\u7684\u8868\uff0c\u5fc5\u987b\u662f\u6c38\u4e45\u6027\u7684\u8868\uff0c\u4e0d\u80fd\u5c06\u89e6\u53d1\u7a0b\u5e8f\u4e0eTEMPORARY\u8868\u6216\u89c6\u56fe\u5173\u8054\u8d77\u6765\u3002 trigger_stmt\uff1a\u5f53\u89e6\u53d1\u7a0b\u5e8f\u6fc0\u6d3b\u65f6\u6267\u884c\u7684\u8bed\u53e5\u3002\u6267\u884c\u591a\u4e2a\u8bed\u53e5\uff0c\u53ef\u4f7f\u7528BEGIN...END\u590d\u5408\u8bed\u53e5\u7ed3\u6784 -- \u5220\u9664 DROP TRIGGER [schema_name.]trigger_name \u53ef\u4ee5\u4f7f\u7528old\u548cnew\u4ee3\u66ff\u65e7\u7684\u548c\u65b0\u7684\u6570\u636e \u66f4\u65b0\u64cd\u4f5c\uff0c\u66f4\u65b0\u524d\u662fold\uff0c\u66f4\u65b0\u540e\u662fnew. \u5220\u9664\u64cd\u4f5c\uff0c\u53ea\u6709old. \u589e\u52a0\u64cd\u4f5c\uff0c\u53ea\u6709new. -- \u6ce8\u610f 1. \u5bf9\u4e8e\u5177\u6709\u76f8\u540c\u89e6\u53d1\u7a0b\u5e8f\u52a8\u4f5c\u65f6\u95f4\u548c\u4e8b\u4ef6\u7684\u7ed9\u5b9a\u8868\uff0c\u4e0d\u80fd\u6709\u4e24\u4e2a\u89e6\u53d1\u7a0b\u5e8f\u3002 -- \u5b57\u7b26\u8fde\u63a5\u51fd\u6570 concat(str1,str2,...]) concat_ws(separator,str1,str2,...) -- \u5206\u652f\u8bed\u53e5 if \u6761\u4ef6 then \u6267\u884c\u8bed\u53e5 elseif \u6761\u4ef6 then \u6267\u884c\u8bed\u53e5 else \u6267\u884c\u8bed\u53e5 end if; -- \u4fee\u6539\u6700\u5916\u5c42\u8bed\u53e5\u7ed3\u675f\u7b26 delimiter \u81ea\u5b9a\u4e49\u7ed3\u675f\u7b26\u53f7 SQL\u8bed\u53e5 \u81ea\u5b9a\u4e49\u7ed3\u675f\u7b26\u53f7 delimiter ; -- \u4fee\u6539\u56de\u539f\u6765\u7684\u5206\u53f7 -- \u8bed\u53e5\u5757\u5305\u88f9 begin \u8bed\u53e5\u5757 end -- \u7279\u6b8a\u7684\u6267\u884c 1. \u53ea\u8981\u6dfb\u52a0\u8bb0\u5f55\uff0c\u5c31\u4f1a\u89e6\u53d1\u7a0b\u5e8f\u3002 2. Insert into on duplicate key update \u8bed\u6cd5\u4f1a\u89e6\u53d1\uff1a \u5982\u679c\u6ca1\u6709\u91cd\u590d\u8bb0\u5f55\uff0c\u4f1a\u89e6\u53d1 before insert, after insert; \u5982\u679c\u6709\u91cd\u590d\u8bb0\u5f55\u5e76\u66f4\u65b0\uff0c\u4f1a\u89e6\u53d1 before insert, before update, after update; \u5982\u679c\u6709\u91cd\u590d\u8bb0\u5f55\u4f46\u662f\u6ca1\u6709\u53d1\u751f\u66f4\u65b0\uff0c\u5219\u89e6\u53d1 before insert, before update 3. Replace \u8bed\u6cd5 \u5982\u679c\u6709\u8bb0\u5f55\uff0c\u5219\u6267\u884c before insert, before delete, after delete, after insert","title":"\u89e6\u53d1\u5668"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#sql","text":"--// \u5c40\u90e8\u53d8\u91cf ---------- -- \u53d8\u91cf\u58f0\u660e declare var_name[,...] type [default value] \u8fd9\u4e2a\u8bed\u53e5\u88ab\u7528\u6765\u58f0\u660e\u5c40\u90e8\u53d8\u91cf\u3002\u8981\u7ed9\u53d8\u91cf\u63d0\u4f9b\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u8bf7\u5305\u542b\u4e00\u4e2adefault\u5b50\u53e5\u3002\u503c\u53ef\u4ee5\u88ab\u6307\u5b9a\u4e3a\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u4e0d\u9700\u8981\u4e3a\u4e00\u4e2a\u5e38\u6570\u3002\u5982\u679c\u6ca1\u6709default\u5b50\u53e5\uff0c\u521d\u59cb\u503c\u4e3anull\u3002 -- \u8d4b\u503c \u4f7f\u7528 set \u548c select into \u8bed\u53e5\u4e3a\u53d8\u91cf\u8d4b\u503c\u3002 - \u6ce8\u610f\uff1a\u5728\u51fd\u6570\u5185\u662f\u53ef\u4ee5\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\uff08\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u53d8\u91cf\uff09 --// \u5168\u5c40\u53d8\u91cf ---------- -- \u5b9a\u4e49\u3001\u8d4b\u503c set \u8bed\u53e5\u53ef\u4ee5\u5b9a\u4e49\u5e76\u4e3a\u53d8\u91cf\u8d4b\u503c\u3002 set @var = value; \u4e5f\u53ef\u4ee5\u4f7f\u7528select into\u8bed\u53e5\u4e3a\u53d8\u91cf\u521d\u59cb\u5316\u5e76\u8d4b\u503c\u3002\u8fd9\u6837\u8981\u6c42select\u8bed\u53e5\u53ea\u80fd\u8fd4\u56de\u4e00\u884c\uff0c\u4f46\u662f\u53ef\u4ee5\u662f\u591a\u4e2a\u5b57\u6bb5\uff0c\u5c31\u610f\u5473\u7740\u540c\u65f6\u4e3a\u591a\u4e2a\u53d8\u91cf\u8fdb\u884c\u8d4b\u503c\uff0c\u53d8\u91cf\u7684\u6570\u91cf\u9700\u8981\u4e0e\u67e5\u8be2\u7684\u5217\u6570\u4e00\u81f4\u3002 \u8fd8\u53ef\u4ee5\u628a\u8d4b\u503c\u8bed\u53e5\u770b\u4f5c\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u901a\u8fc7select\u6267\u884c\u5b8c\u6210\u3002\u6b64\u65f6\u4e3a\u4e86\u907f\u514d=\u88ab\u5f53\u4f5c\u5173\u7cfb\u8fd0\u7b97\u7b26\u770b\u5f85\uff0c\u4f7f\u7528:=\u4ee3\u66ff\u3002\uff08set\u8bed\u53e5\u53ef\u4ee5\u4f7f\u7528= \u548c :=\uff09\u3002 select @var:=20; select @v1:=id, @v2=name from t1 limit 1; select * from tbl_name where @var:=30; select into \u53ef\u4ee5\u5c06\u8868\u4e2d\u67e5\u8be2\u83b7\u5f97\u7684\u6570\u636e\u8d4b\u7ed9\u53d8\u91cf\u3002 -| select max(height) into @max_height from tb; -- \u81ea\u5b9a\u4e49\u53d8\u91cf\u540d \u4e3a\u4e86\u907f\u514dselect\u8bed\u53e5\u4e2d\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u53d8\u91cf\u4e0e\u7cfb\u7edf\u6807\u8bc6\u7b26\uff08\u901a\u5e38\u662f\u5b57\u6bb5\u540d\uff09\u51b2\u7a81\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u53d8\u91cf\u5728\u53d8\u91cf\u540d\u524d\u4f7f\u7528@\u4f5c\u4e3a\u5f00\u59cb\u7b26\u53f7\u3002 @var=10; - \u53d8\u91cf\u88ab\u5b9a\u4e49\u540e\uff0c\u5728\u6574\u4e2a\u4f1a\u8bdd\u5468\u671f\u90fd\u6709\u6548\uff08\u767b\u5f55\u5230\u9000\u51fa\uff09 --// \u63a7\u5236\u7ed3\u6784 ---------- -- if\u8bed\u53e5 if search_condition then statement_list [elseif search_condition then statement_list] ... [else statement_list] end if; -- case\u8bed\u53e5 CASE value WHEN [compare-value] THEN result [WHEN [compare-value] THEN result ...] [ELSE result] END -- while\u5faa\u73af [begin_label:] while search_condition do statement_list end while [end_label]; - \u5982\u679c\u9700\u8981\u5728\u5faa\u73af\u5185\u63d0\u524d\u7ec8\u6b62 while\u5faa\u73af\uff0c\u5219\u9700\u8981\u4f7f\u7528\u6807\u7b7e\uff1b\u6807\u7b7e\u9700\u8981\u6210\u5bf9\u51fa\u73b0\u3002 -- \u9000\u51fa\u5faa\u73af \u9000\u51fa\u6574\u4e2a\u5faa\u73af leave \u9000\u51fa\u5f53\u524d\u5faa\u73af iterate \u901a\u8fc7\u9000\u51fa\u7684\u6807\u7b7e\u51b3\u5b9a\u9000\u51fa\u54ea\u4e2a\u5faa\u73af --// \u5185\u7f6e\u51fd\u6570 ---------- -- \u6570\u503c\u51fd\u6570 abs(x) -- \u7edd\u5bf9\u503c abs(-10.9) = 10 format(x, d) -- \u683c\u5f0f\u5316\u5343\u5206\u4f4d\u6570\u503c format(1234567.456, 2) = 1,234,567.46 ceil(x) -- \u5411\u4e0a\u53d6\u6574 ceil(10.1) = 11 floor(x) -- \u5411\u4e0b\u53d6\u6574 floor (10.1) = 10 round(x) -- \u56db\u820d\u4e94\u5165\u53bb\u6574 mod(m, n) -- m%n m mod n \u6c42\u4f59 10%3=1 pi() -- \u83b7\u5f97\u5706\u5468\u7387 pow(m, n) -- m^n sqrt(x) -- \u7b97\u672f\u5e73\u65b9\u6839 rand() -- \u968f\u673a\u6570 truncate(x, d) -- \u622a\u53d6d\u4f4d\u5c0f\u6570 -- \u65f6\u95f4\u65e5\u671f\u51fd\u6570 now(), current_timestamp(); -- \u5f53\u524d\u65e5\u671f\u65f6\u95f4 current_date(); -- \u5f53\u524d\u65e5\u671f current_time(); -- \u5f53\u524d\u65f6\u95f4 date( yyyy-mm-dd hh:ii:ss ); -- \u83b7\u53d6\u65e5\u671f\u90e8\u5206 time( yyyy-mm-dd hh:ii:ss ); -- \u83b7\u53d6\u65f6\u95f4\u90e8\u5206 date_format( yyyy-mm-dd hh:ii:ss , %d %y %a %d %m %b %j ); -- \u683c\u5f0f\u5316\u65f6\u95f4 unix_timestamp(); -- \u83b7\u5f97unix\u65f6\u95f4\u6233 from_unixtime(); -- \u4ece\u65f6\u95f4\u6233\u83b7\u5f97\u65f6\u95f4 -- \u5b57\u7b26\u4e32\u51fd\u6570 length(string) -- string\u957f\u5ea6\uff0c\u5b57\u8282 char_length(string) -- string\u7684\u5b57\u7b26\u4e2a\u6570 substring(str, position [,length]) -- \u4ecestr\u7684position\u5f00\u59cb,\u53d6length\u4e2a\u5b57\u7b26 replace(str ,search_str ,replace_str) -- \u5728str\u4e2d\u7528replace_str\u66ff\u6362search_str instr(string ,substring) -- \u8fd4\u56desubstring\u9996\u6b21\u5728string\u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e concat(string [,...]) -- \u8fde\u63a5\u5b57\u4e32 charset(str) -- \u8fd4\u56de\u5b57\u4e32\u5b57\u7b26\u96c6 lcase(string) -- \u8f6c\u6362\u6210\u5c0f\u5199 left(string, length) -- \u4ecestring2\u4e2d\u7684\u5de6\u8fb9\u8d77\u53d6length\u4e2a\u5b57\u7b26 load_file(file_name) -- \u4ece\u6587\u4ef6\u8bfb\u53d6\u5185\u5bb9 locate(substring, string [,start_position]) -- \u540cinstr,\u4f46\u53ef\u6307\u5b9a\u5f00\u59cb\u4f4d\u7f6e lpad(string, length, pad) -- \u91cd\u590d\u7528pad\u52a0\u5728string\u5f00\u5934,\u76f4\u5230\u5b57\u4e32\u957f\u5ea6\u4e3alength ltrim(string) -- \u53bb\u9664\u524d\u7aef\u7a7a\u683c repeat(string, count) -- \u91cd\u590dcount\u6b21 rpad(string, length, pad) --\u5728str\u540e\u7528pad\u8865\u5145,\u76f4\u5230\u957f\u5ea6\u4e3alength rtrim(string) -- \u53bb\u9664\u540e\u7aef\u7a7a\u683c strcmp(string1 ,string2) -- \u9010\u5b57\u7b26\u6bd4\u8f83\u4e24\u5b57\u4e32\u5927\u5c0f -- \u6d41\u7a0b\u51fd\u6570 case when [condition] then result [when [condition] then result ...] [else result] end \u591a\u5206\u652f if(expr1,expr2,expr3) \u53cc\u5206\u652f\u3002 -- \u805a\u5408\u51fd\u6570 count() sum(); max(); min(); avg(); group_concat() -- \u5176\u4ed6\u5e38\u7528\u51fd\u6570 md5(); default(); --// \u5b58\u50a8\u51fd\u6570\uff0c\u81ea\u5b9a\u4e49\u51fd\u6570 ---------- -- \u65b0\u5efa CREATE FUNCTION function_name (\u53c2\u6570\u5217\u8868) RETURNS \u8fd4\u56de\u503c\u7c7b\u578b \u51fd\u6570\u4f53 - \u51fd\u6570\u540d\uff0c\u5e94\u8be5\u5408\u6cd5\u7684\u6807\u8bc6\u7b26\uff0c\u5e76\u4e14\u4e0d\u5e94\u8be5\u4e0e\u5df2\u6709\u7684\u5173\u952e\u5b57\u51b2\u7a81\u3002 - \u4e00\u4e2a\u51fd\u6570\u5e94\u8be5\u5c5e\u4e8e\u67d0\u4e2a\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528db_name.funciton_name\u7684\u5f62\u5f0f\u6267\u884c\u5f53\u524d\u51fd\u6570\u6240\u5c5e\u6570\u636e\u5e93\uff0c\u5426\u5219\u4e3a\u5f53\u524d\u6570\u636e\u5e93\u3002 - \u53c2\u6570\u90e8\u5206\uff0c\u7531\"\u53c2\u6570\u540d\"\u548c\"\u53c2\u6570\u7c7b\u578b\"\u7ec4\u6210\u3002\u591a\u4e2a\u53c2\u6570\u7528\u9017\u53f7\u9694\u5f00\u3002 - \u51fd\u6570\u4f53\u7531\u591a\u6761\u53ef\u7528\u7684mysql\u8bed\u53e5\uff0c\u6d41\u7a0b\u63a7\u5236\uff0c\u53d8\u91cf\u58f0\u660e\u7b49\u8bed\u53e5\u6784\u6210\u3002 - \u591a\u6761\u8bed\u53e5\u5e94\u8be5\u4f7f\u7528 begin...end \u8bed\u53e5\u5757\u5305\u542b\u3002 - \u4e00\u5b9a\u8981\u6709 return \u8fd4\u56de\u503c\u8bed\u53e5\u3002 -- \u5220\u9664 DROP FUNCTION [IF EXISTS] function_name; -- \u67e5\u770b SHOW FUNCTION STATUS LIKE partten SHOW CREATE FUNCTION function_name; -- \u4fee\u6539 ALTER FUNCTION function_name \u51fd\u6570\u9009\u9879 --// \u5b58\u50a8\u8fc7\u7a0b\uff0c\u81ea\u5b9a\u4e49\u529f\u80fd ---------- -- \u5b9a\u4e49 \u5b58\u50a8\u5b58\u50a8\u8fc7\u7a0b \u662f\u4e00\u6bb5\u4ee3\u7801\uff08\u8fc7\u7a0b\uff09\uff0c\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u7684sql\u7ec4\u6210\u3002 \u4e00\u4e2a\u5b58\u50a8\u8fc7\u7a0b\u901a\u5e38\u7528\u4e8e\u5b8c\u6210\u4e00\u6bb5\u4e1a\u52a1\u903b\u8f91\uff0c\u4f8b\u5982\u62a5\u540d\uff0c\u4ea4\u73ed\u8d39\uff0c\u8ba2\u5355\u5165\u5e93\u7b49\u3002 \u800c\u4e00\u4e2a\u51fd\u6570\u901a\u5e38\u4e13\u6ce8\u4e0e\u67d0\u4e2a\u529f\u80fd\uff0c\u89c6\u4e3a\u5176\u4ed6\u7a0b\u5e8f\u670d\u52a1\u7684\uff0c\u9700\u8981\u5728\u5176\u4ed6\u8bed\u53e5\u4e2d\u8c03\u7528\u51fd\u6570\u624d\u53ef\u4ee5\uff0c\u800c\u5b58\u50a8\u8fc7\u7a0b\u4e0d\u80fd\u88ab\u5176\u4ed6\u8c03\u7528\uff0c\u662f\u81ea\u5df1\u6267\u884c \u901a\u8fc7call\u6267\u884c\u3002 -- \u521b\u5efa CREATE PROCEDURE sp_name (\u53c2\u6570\u5217\u8868) \u8fc7\u7a0b\u4f53 \u53c2\u6570\u5217\u8868\uff1a\u4e0d\u540c\u4e8e\u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\uff0c\u9700\u8981\u6307\u660e\u53c2\u6570\u7c7b\u578b IN\uff0c\u8868\u793a\u8f93\u5165\u578b OUT\uff0c\u8868\u793a\u8f93\u51fa\u578b INOUT\uff0c\u8868\u793a\u6df7\u5408\u578b \u6ce8\u610f\uff0c\u6ca1\u6709\u8fd4\u56de\u503c\u3002 /* \u5b58\u50a8\u8fc7\u7a0b */ ------------------ \u5b58\u50a8\u8fc7\u7a0b\u662f\u4e00\u6bb5\u53ef\u6267\u884c\u6027\u4ee3\u7801\u7684\u96c6\u5408\u3002\u76f8\u6bd4\u51fd\u6570\uff0c\u66f4\u504f\u5411\u4e8e\u4e1a\u52a1\u903b\u8f91\u3002 \u8c03\u7528\uff1aCALL \u8fc7\u7a0b\u540d -- \u6ce8\u610f - \u6ca1\u6709\u8fd4\u56de\u503c\u3002 - \u53ea\u80fd\u5355\u72ec\u8c03\u7528\uff0c\u4e0d\u53ef\u5939\u6742\u5728\u5176\u4ed6\u8bed\u53e5\u4e2d -- \u53c2\u6570 IN|OUT|INOUT \u53c2\u6570\u540d \u6570\u636e\u7c7b\u578b IN \u8f93\u5165\uff1a\u5728\u8c03\u7528\u8fc7\u7a0b\u4e2d\uff0c\u5c06\u6570\u636e\u8f93\u5165\u5230\u8fc7\u7a0b\u4f53\u5185\u90e8\u7684\u53c2\u6570 OUT \u8f93\u51fa\uff1a\u5728\u8c03\u7528\u8fc7\u7a0b\u4e2d\uff0c\u5c06\u8fc7\u7a0b\u4f53\u5904\u7406\u5b8c\u7684\u7ed3\u679c\u8fd4\u56de\u5230\u5ba2\u6237\u7aef INOUT \u8f93\u5165\u8f93\u51fa\uff1a\u65e2\u53ef\u8f93\u5165\uff0c\u4e5f\u53ef\u8f93\u51fa -- \u8bed\u6cd5 CREATE PROCEDURE \u8fc7\u7a0b\u540d (\u53c2\u6570\u5217\u8868) BEGIN \u8fc7\u7a0b\u4f53 END","title":"SQL\u7f16\u7a0b"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_16","text":"-- root\u5bc6\u7801\u91cd\u7f6e 1. \u505c\u6b62MySQL\u670d\u52a1 2. [Linux] /usr/local/mysql/bin/safe_mysqld --skip-grant-tables & [Windows] mysqld --skip-grant-tables 3. use mysql; 4. UPDATE `user` SET PASSWORD=PASSWORD(\"\u5bc6\u7801\") WHERE `user` = \"root\"; 5. FLUSH PRIVILEGES; \u7528\u6237\u4fe1\u606f\u8868\uff1amysql.user -- \u5237\u65b0\u6743\u9650 FLUSH PRIVILEGES; -- \u589e\u52a0\u7528\u6237 CREATE USER \u7528\u6237\u540d IDENTIFIED BY [PASSWORD] \u5bc6\u7801(\u5b57\u7b26\u4e32) - \u5fc5\u987b\u62e5\u6709mysql\u6570\u636e\u5e93\u7684\u5168\u5c40CREATE USER\u6743\u9650\uff0c\u6216\u62e5\u6709INSERT\u6743\u9650\u3002 - \u53ea\u80fd\u521b\u5efa\u7528\u6237\uff0c\u4e0d\u80fd\u8d4b\u4e88\u6743\u9650\u3002 - \u7528\u6237\u540d\uff0c\u6ce8\u610f\u5f15\u53f7\uff1a\u5982 user_name @ 192.168.1.1 - \u5bc6\u7801\u4e5f\u9700\u5f15\u53f7\uff0c\u7eaf\u6570\u5b57\u5bc6\u7801\u4e5f\u8981\u52a0\u5f15\u53f7 - \u8981\u5728\u7eaf\u6587\u672c\u4e2d\u6307\u5b9a\u5bc6\u7801\uff0c\u9700\u5ffd\u7565PASSWORD\u5173\u952e\u8bcd\u3002\u8981\u628a\u5bc6\u7801\u6307\u5b9a\u4e3a\u7531PASSWORD()\u51fd\u6570\u8fd4\u56de\u7684\u6df7\u7f16\u503c\uff0c\u9700\u5305\u542b\u5173\u952e\u5b57PASSWORD -- \u91cd\u547d\u540d\u7528\u6237 RENAME USER old_user TO new_user -- \u8bbe\u7f6e\u5bc6\u7801 SET PASSWORD = PASSWORD( \u5bc6\u7801 ) -- \u4e3a\u5f53\u524d\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801 SET PASSWORD FOR \u7528\u6237\u540d = PASSWORD( \u5bc6\u7801 ) -- \u4e3a\u6307\u5b9a\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801 -- \u5220\u9664\u7528\u6237 DROP USER \u7528\u6237\u540d -- \u5206\u914d\u6743\u9650/\u6dfb\u52a0\u7528\u6237 GRANT \u6743\u9650\u5217\u8868 ON \u8868\u540d TO \u7528\u6237\u540d [IDENTIFIED BY [PASSWORD] password ] - all privileges \u8868\u793a\u6240\u6709\u6743\u9650 - *.* \u8868\u793a\u6240\u6709\u5e93\u7684\u6240\u6709\u8868 - \u5e93\u540d.\u8868\u540d \u8868\u793a\u67d0\u5e93\u4e0b\u9762\u7684\u67d0\u8868 GRANT ALL PRIVILEGES ON `pms`.* TO pms @ % IDENTIFIED BY pms0817 ; -- \u67e5\u770b\u6743\u9650 SHOW GRANTS FOR \u7528\u6237\u540d -- \u67e5\u770b\u5f53\u524d\u7528\u6237\u6743\u9650 SHOW GRANTS; \u6216 SHOW GRANTS FOR CURRENT_USER; \u6216 SHOW GRANTS FOR CURRENT_USER(); -- \u64a4\u6d88\u6743\u9650 REVOKE \u6743\u9650\u5217\u8868 ON \u8868\u540d FROM \u7528\u6237\u540d REVOKE ALL PRIVILEGES, GRANT OPTION FROM \u7528\u6237\u540d -- \u64a4\u9500\u6240\u6709\u6743\u9650 -- \u6743\u9650\u5c42\u7ea7 -- \u8981\u4f7f\u7528GRANT\u6216REVOKE\uff0c\u60a8\u5fc5\u987b\u62e5\u6709GRANT OPTION\u6743\u9650\uff0c\u5e76\u4e14\u60a8\u5fc5\u987b\u7528\u4e8e\u60a8\u6b63\u5728\u6388\u4e88\u6216\u64a4\u9500\u7684\u6743\u9650\u3002 \u5168\u5c40\u5c42\u7ea7\uff1a\u5168\u5c40\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u670d\u52a1\u5668\u4e2d\u7684\u6240\u6709\u6570\u636e\u5e93\uff0cmysql.user GRANT ALL ON *.*\u548c REVOKE ALL ON *.*\u53ea\u6388\u4e88\u548c\u64a4\u9500\u5168\u5c40\u6743\u9650\u3002 \u6570\u636e\u5e93\u5c42\u7ea7\uff1a\u6570\u636e\u5e93\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u76ee\u6807\uff0cmysql.db, mysql.host GRANT ALL ON db_name.*\u548cREVOKE ALL ON db_name.*\u53ea\u6388\u4e88\u548c\u64a4\u9500\u6570\u636e\u5e93\u6743\u9650\u3002 \u8868\u5c42\u7ea7\uff1a\u8868\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u8868\u4e2d\u7684\u6240\u6709\u5217\uff0cmysql.talbes_priv GRANT ALL ON db_name.tbl_name\u548cREVOKE ALL ON db_name.tbl_name\u53ea\u6388\u4e88\u548c\u64a4\u9500\u8868\u6743\u9650\u3002 \u5217\u5c42\u7ea7\uff1a\u5217\u6743\u9650\u9002\u7528\u4e8e\u4e00\u4e2a\u7ed9\u5b9a\u8868\u4e2d\u7684\u5355\u4e00\u5217\uff0cmysql.columns_priv \u5f53\u4f7f\u7528REVOKE\u65f6\uff0c\u60a8\u5fc5\u987b\u6307\u5b9a\u4e0e\u88ab\u6388\u6743\u5217\u76f8\u540c\u7684\u5217\u3002 -- \u6743\u9650\u5217\u8868 ALL [PRIVILEGES] -- \u8bbe\u7f6e\u9664GRANT OPTION\u4e4b\u5916\u7684\u6240\u6709\u7b80\u5355\u6743\u9650 ALTER -- \u5141\u8bb8\u4f7f\u7528ALTER TABLE ALTER ROUTINE -- \u66f4\u6539\u6216\u53d6\u6d88\u5df2\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f CREATE -- \u5141\u8bb8\u4f7f\u7528CREATE TABLE CREATE ROUTINE -- \u521b\u5efa\u5df2\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f CREATE TEMPORARY TABLES -- \u5141\u8bb8\u4f7f\u7528CREATE TEMPORARY TABLE CREATE USER -- \u5141\u8bb8\u4f7f\u7528CREATE USER, DROP USER, RENAME USER\u548cREVOKE ALL PRIVILEGES\u3002 CREATE VIEW -- \u5141\u8bb8\u4f7f\u7528CREATE VIEW DELETE -- \u5141\u8bb8\u4f7f\u7528DELETE DROP -- \u5141\u8bb8\u4f7f\u7528DROP TABLE EXECUTE -- \u5141\u8bb8\u7528\u6237\u8fd0\u884c\u5df2\u5b58\u50a8\u7684\u5b50\u7a0b\u5e8f FILE -- \u5141\u8bb8\u4f7f\u7528SELECT...INTO OUTFILE\u548cLOAD DATA INFILE INDEX -- \u5141\u8bb8\u4f7f\u7528CREATE INDEX\u548cDROP INDEX INSERT -- \u5141\u8bb8\u4f7f\u7528INSERT LOCK TABLES -- \u5141\u8bb8\u5bf9\u60a8\u62e5\u6709SELECT\u6743\u9650\u7684\u8868\u4f7f\u7528LOCK TABLES PROCESS -- \u5141\u8bb8\u4f7f\u7528SHOW FULL PROCESSLIST REFERENCES -- \u672a\u88ab\u5b9e\u65bd RELOAD -- \u5141\u8bb8\u4f7f\u7528FLUSH REPLICATION CLIENT -- \u5141\u8bb8\u7528\u6237\u8be2\u95ee\u4ece\u5c5e\u670d\u52a1\u5668\u6216\u4e3b\u670d\u52a1\u5668\u7684\u5730\u5740 REPLICATION SLAVE -- \u7528\u4e8e\u590d\u5236\u578b\u4ece\u5c5e\u670d\u52a1\u5668\uff08\u4ece\u4e3b\u670d\u52a1\u5668\u4e2d\u8bfb\u53d6\u4e8c\u8fdb\u5236\u65e5\u5fd7\u4e8b\u4ef6\uff09 SELECT -- \u5141\u8bb8\u4f7f\u7528SELECT SHOW DATABASES -- \u663e\u793a\u6240\u6709\u6570\u636e\u5e93 SHOW VIEW -- \u5141\u8bb8\u4f7f\u7528SHOW CREATE VIEW SHUTDOWN -- \u5141\u8bb8\u4f7f\u7528mysqladmin shutdown SUPER -- \u5141\u8bb8\u4f7f\u7528CHANGE MASTER, KILL, PURGE MASTER LOGS\u548cSET GLOBAL\u8bed\u53e5\uff0cmysqladmin debug\u547d\u4ee4\uff1b\u5141\u8bb8\u60a8\u8fde\u63a5\uff08\u4e00\u6b21\uff09\uff0c\u5373\u4f7f\u5df2\u8fbe\u5230max_connections\u3002 UPDATE -- \u5141\u8bb8\u4f7f\u7528UPDATE USAGE -- \u201c\u65e0\u6743\u9650\u201d\u7684\u540c\u4e49\u8bcd GRANT OPTION -- \u5141\u8bb8\u6388\u4e88\u6743\u9650","title":"\u7528\u6237\u548c\u6743\u9650\u7ba1\u7406"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_17","text":"-- \u5206\u6790\u548c\u5b58\u50a8\u8868\u7684\u5173\u952e\u5b57\u5206\u5e03 ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE \u8868\u540d ... -- \u68c0\u67e5\u4e00\u4e2a\u6216\u591a\u4e2a\u8868\u662f\u5426\u6709\u9519\u8bef CHECK TABLE tbl_name [, tbl_name] ... [option] ... option = {QUICK | FAST | MEDIUM | EXTENDED | CHANGED} -- \u6574\u7406\u6570\u636e\u6587\u4ef6\u7684\u788e\u7247 OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...","title":"\u8868\u7ef4\u62a4"},{"location":"MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#_18","text":"1. \u53ef\u7528\u53cd\u5f15\u53f7\uff08`\uff09\u4e3a\u6807\u8bc6\u7b26\uff08\u5e93\u540d\u3001\u8868\u540d\u3001\u5b57\u6bb5\u540d\u3001\u7d22\u5f15\u3001\u522b\u540d\uff09\u5305\u88f9\uff0c\u4ee5\u907f\u514d\u4e0e\u5173\u952e\u5b57\u91cd\u540d\uff01\u4e2d\u6587\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u6807\u8bc6\u7b26\uff01 2. \u6bcf\u4e2a\u5e93\u76ee\u5f55\u5b58\u5728\u4e00\u4e2a\u4fdd\u5b58\u5f53\u524d\u6570\u636e\u5e93\u7684\u9009\u9879\u6587\u4ef6db.opt\u3002 3. \u6ce8\u91ca\uff1a \u5355\u884c\u6ce8\u91ca # \u6ce8\u91ca\u5185\u5bb9 \u591a\u884c\u6ce8\u91ca /* \u6ce8\u91ca\u5185\u5bb9 */ \u5355\u884c\u6ce8\u91ca -- \u6ce8\u91ca\u5185\u5bb9 (\u6807\u51c6SQL\u6ce8\u91ca\u98ce\u683c\uff0c\u8981\u6c42\u53cc\u7834\u6298\u53f7\u540e\u52a0\u4e00\u7a7a\u683c\u7b26\uff08\u7a7a\u683c\u3001TAB\u3001\u6362\u884c\u7b49\uff09) 4. \u6a21\u5f0f\u901a\u914d\u7b26\uff1a _ \u4efb\u610f\u5355\u4e2a\u5b57\u7b26 % \u4efb\u610f\u591a\u4e2a\u5b57\u7b26\uff0c\u751a\u81f3\u5305\u62ec\u96f6\u5b57\u7b26 \u5355\u5f15\u53f7\u9700\u8981\u8fdb\u884c\u8f6c\u4e49 5. CMD\u547d\u4ee4\u884c\u5185\u7684\u8bed\u53e5\u7ed3\u675f\u7b26\u53ef\u4ee5\u4e3a \";\", \"G\", \"g\"\uff0c\u4ec5\u5f71\u54cd\u663e\u793a\u7ed3\u679c\u3002\u5176\u4ed6\u5730\u65b9\u8fd8\u662f\u7528\u5206\u53f7\u7ed3\u675f\u3002delimiter \u53ef\u4fee\u6539\u5f53\u524d\u5bf9\u8bdd\u7684\u8bed\u53e5\u7ed3\u675f\u7b26\u3002 6. SQL\u5bf9\u5927\u5c0f\u5199\u4e0d\u654f\u611f 7. \u6e05\u9664\u5df2\u6709\u8bed\u53e5\uff1ac","title":"\u6742\u9879"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/","text":"re\u6a21\u5757\u4e0b\u7684\u51fd\u6570 \u00b6 compile(pattern)\uff1a\u521b\u5efa\u6a21\u5f0f\u5bf9\u8c61 \u00b6 import re pat=re.compile('A') m=pat.search('CBA') #\u7b49\u4ef7\u4e8e re.search('A','CBA') print m <_sre.SRE_Match object at 0x9d690c8> #\u5339\u914d\u5230\u4e86\uff0c\u8fd4\u56deMatchObject\uff08True\uff09 m=pat.search('CBD') print m None #\u6ca1\u6709\u5339\u914d\u5230\uff0c\u8fd4\u56deNone\uff08False\uff09 search(pattern,string)\uff1a\u5728\u5b57\u7b26\u4e32\u4e2d\u5bfb\u627e\u6a21\u5f0f \u00b6 m = re.search('asd','ASDasd') print m <_sre.SRE_Match object at 0xb72cd6e8> #\u5339\u914d\u5230\u4e86\uff0c\u8fd4\u56deMatchObject\uff08True\uff09 m = re.search('asd','ASDASD') print m None #\u6ca1\u6709\u5339\u914d\u5230\uff0c\u8fd4\u56deNone\uff08False\uff09 match(pattern,string)\uff1a\u5728\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u5339\u914d\u6a21\u5f0f \u00b6 m = re.search('asd','ASDasd') print m <_sre.SRE_Match object at 0xb72cd6e8> #\u5339\u914d\u5230\u4e86\uff0c\u8fd4\u56deMatchObject\uff08True\uff09 m = re.search('asd','ASDASD') print m None #\u6ca1\u6709\u5339\u914d\u5230\uff0c\u8fd4\u56deNone\uff08False\uff09 \u7b49\u4ef7\u4e8e \u00b6 pat=re.compile('a') print pat.match('Aasd') None printpat.match('aASD') <_sre.SRE_Match object at 0xb72cd6e8> \u4e0a\u9762\u7684\u51fd\u6570\u8fd4\u56de\u90fd\u53ef\u4ee5\u5728if\u6761\u4ef6\u8bed\u53e5\u4e2d\u8fdb\u884c\u5224\u65ad\uff1a \u00b6 if pat.search('asd'): ... print 'OK' ... OK #\u627e\u5230\u8fd4\u56de if re.search('a','ASD'): ... print \"OK\" ... #\u6ca1\u6709\u627e\u5230 split(pattern,string)\uff1a\u6839\u636e\u6a21\u5f0f\u5206\u5272\u5b57\u7b26\u4e32,\u8fd4\u56de\u5217\u8868 \u00b6 re.split(',','a,s,d,asd') ['a', 's', 'd', 'asd'] #\u8fd4\u56de\u5217\u8868 pat = re.compile(',') pat.split('a,s,d,asd') ['a', 's', 'd', 'asd'] #\u8fd4\u56de\u5217\u8868 re.split('[, ]+','a , s ,d ,,,,,asd') #\u6b63\u5219\u5339\u914d\uff1a[, ]+\uff0c\u540e\u9762\u8bf4\u660e ['a', 's', 'd', 'asd'] re.split('[, ]+','a , s ,d ,,,,,asd',maxsplit=2) # maxsplit \u6700\u591a\u5206\u5272\u6b21\u6570 ['a', 's', 'd ,,,,,asd'] pat = re.compile('[, ]+') #\u6b63\u5219\u5339\u914d\uff1a[, ]+\uff0c\u540e\u9762\u8bf4\u660e pat.split('a , s ,d ,,,,,asd',maxsplit=2) # maxsplit \u6700\u591a\u5206\u5272\u6b21\u6570 ['a', 's', 'd ,,,,,asd'] findall(pattern,string)\uff1a\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\u5339\u914d\u9879 \u00b6 re.findall('a','ASDaDFGAa') ['a', 'a'] #\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 pat = re.compile('a') pat.findall('ASDaDFGAa') ['a', 'a'] #\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 pat = re.compile('[A-Z]+') #\u6b63\u5219\u5339\u914d\uff1a'[A-Z]+' \u540e\u9762\u6709\u8bf4\u660e pat.findall('ASDcDFGAa') ['ASD', 'DFGA'] #\u627e\u5230\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 pat = re.compile('[A-Z]') pat.findall('ASDcDFGAa') #\u6b63\u5219\u5339\u914d\uff1a'[A-Z]+' \u540e\u9762\u6709\u8bf4\u660e ['A', 'S', 'D', 'D', 'F', 'G', 'A'] #\u627e\u5230\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 pat = re.compile('[A-Za-z]') #\u6b63\u5219\u5339\u914d\uff1a'[A-Za-z]+' \u5339\u914d\u6240\u6709\u5355\u8bcd\uff0c\u540e\u9762\u6709\u8bf4\u660e pat.findall('ASDcDFGAa') ['A', 'S', 'D', 'c', 'D', 'F', 'G', 'A', 'a'] sub(pat,repl,string) \uff1a\u7528repl\u66ff\u6362 pat\u5339\u914d\u9879 \u00b6 (\u7559\u7684\u662f\u4e2d\u95f4\u7684\uff0c\u56e0\u4e3a\u4e2d\u95f4\u5728\u4e2d\u5fc3) re.sub('a','A','abcasd') #\u627e\u5230a\u7528A\u66ff\u6362\uff0c\u540e\u9762\u89c1\u548cgroup\u7684\u914d\u5408\u4f7f\u7528 'AbcAsd' pat = re.compile('a') pat.sub('A','abcasd') 'AbcAsd' pat=re.compile(r'www\\.(.*)\\..{3}') #\u6b63\u5219\u8868\u8fbe\u5f0f #\u5728Python\u7684string\u524d\u9762\u52a0\u4e0a\u2018r\u2019\uff0c \u662f\u4e3a\u4e86\u544a\u8bc9\u7f16\u8bd1\u5668\u8fd9\u4e2astring\u662f\u4e2araw string\uff0c\u4e0d\u8981\u8f6c\u8bd1\u53cd\u659c\u6760 '\\' \u3002 #\u4f8b\u5982\uff0c\\n \u5728raw string\u4e2d\uff0c\u662f\u4e24\u4e2a\u5b57\u7b26\uff0c\\\u548cn\uff0c \u800c\u4e0d\u4f1a\u8f6c\u8bd1\u4e3a\u6362\u884c\u7b26\u3002 #\u7531\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u548c \\ \u4f1a\u6709\u51b2\u7a81\uff0c\u56e0\u6b64\uff0c\u5f53\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f7f\u7528\u4e86\u6b63\u5219\u8868\u8fbe\u5f0f\u540e\uff0c\u6700\u597d\u5728\u524d\u9762\u52a0\u4e0a'r'\u3002 #\u4e0e\u5927\u591a\u6570\u7f16\u7a0b\u8bed\u8a00\u76f8\u540c\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u91cc\u4f7f\u7528\"\\\"\u4f5c\u4e3a\u8f6c\u4e49\u5b57\u7b26\uff0c\u8fd9\u5c31\u53ef\u80fd\u9020\u6210\u53cd\u659c\u6760\u56f0\u6270\u3002 #\u5047\u5982\u4f60\u9700\u8981\u5339\u914d\u6587\u672c\u4e2d\u7684\u5b57\u7b26\"\\\"\uff0c\u90a3\u4e48\u4f7f\u7528\u7f16\u7a0b\u8bed\u8a00\u8868\u793a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u91cc\u5c06\u9700\u89814\u4e2a\u53cd\u659c\u6760\"\\\\\\\\\"\uff1a #\u524d\u4e24\u4e2a\u548c\u540e\u4e24\u4e2a\u5206\u522b\u7528\u4e8e\u5728\u7f16\u7a0b\u8bed\u8a00\u91cc\u8f6c\u4e49\u6210\u53cd\u659c\u6760\uff0c\u8f6c\u6362\u6210\u4e24\u4e2a\u53cd\u659c\u6760\u540e\u518d\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u91cc\u8f6c\u4e49\u6210\u4e00\u4e2a\u53cd\u659c\u6760\u3002 #Python\u91cc\u7684\u539f\u751f\u5b57\u7b26\u4e32\u5f88\u597d\u5730\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u53ef\u4ee5\u4f7f\u7528r\"\\\\\"\u8868\u793a\u3002 #\u540c\u6837\uff0c\u5339\u914d\u4e00\u4e2a\u6570\u5b57\u7684\"\\\\d\"\u53ef\u4ee5\u5199\u6210r\"\\d\"\u3002 #\u6709\u4e86\u539f\u751f\u5b57\u7b26\u4e32\uff0c\u4f60\u518d\u4e5f\u4e0d\u7528\u62c5\u5fc3\u662f\u4e0d\u662f\u6f0f\u5199\u4e86\u53cd\u659c\u6760\uff0c\u5199\u51fa\u6765\u7684\u8868\u8fbe\u5f0f\u4e5f\u66f4\u76f4\u89c2\u3002 #\u4e0d\u662f\u8bf4 \u52a0\u4e86r \\\u5c31\u6ca1\u6709\u8f6c\u8bd1\u529f\u80fd\uff0c\u597d\u4e71\uff0c\u5c31\u76f4\u63a5\u8bb0\u4f4f1\u53e5\u8bdd\uff1a #\u5f53\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f7f\u7528\u4e86\u6b63\u5219\u8868\u8fbe\u5f0f\u540e\uff0c\u6700\u597d\u5728\u524d\u9762\u52a0\u4e0a'r'\uff0c\u8fd9\u6837\u4f60\u518d\u4e5f\u4e0d\u7528\u62c5\u5fc3\u662f\u4e0d\u662f\u6f0f\u5199\u4e86\u53cd\u659c\u6760\uff0c\u5199\u51fa\u6765\u7684\u8868\u8fbe\u5f0f\u4e5f\u66f4\u76f4\u89c2 pat.match('www.dxy.com').group(1) 'dxy' re.sub(r'www\\.(.*)\\..{3}',r'\\1','hello,www.dxy.com') pat.sub(r'\\1','hello,www.dxy.com') 'hello,dxy' # r'1' \u662f\u7b2c\u4e00\u7ec4\u7684\u610f\u601d #\u901a\u8fc7\u6b63\u5219\u5339\u914d\u627e\u5230\u7b26\u5408\u89c4\u5219\u7684\"www.dxy.com\" \uff0c\u53d6\u5f97 \u7ec41\u5b57\u7b26\u4e32 \u53bb\u66ff\u6362 \u6574\u4e2a\u5339\u914d\u3002 pat=re.compile(r'(\\w+) (\\w+)') #\u6b63\u5219\u8868\u8fbe\u5f0f s='hello world ! hello hz !' pat.findall('hello world ! hello hz !') [('hello', 'world'), ('hello', 'hz')] pat.sub(r'\\2 \\1',s) #\u901a\u8fc7\u6b63\u5219\u5f97\u5230\u7ec41(hello)\uff0c\u7ec42(world)\uff0c\u518d\u901a\u8fc7sub\u53bb\u66ff\u6362\u3002\u5373\u7ec41\u66ff\u6362\u7ec42\uff0c\u7ec42\u66ff\u6362\u7ec41\uff0c\u8c03\u6362\u4f4d\u7f6e\u3002 'world hello!hz hello!' escape(string) \uff1a\u5bf9\u5b57\u7b26\u4e32\u91cc\u9762\u7684\u7279\u6b8a\u5b57\u7b26\u4e32\u8fdb\u884c\u8f6c\u4e49 \u00b6 re.escape('www.dxy.cn') 'www\\\\.dxy\\\\.cn' #\u8f6c\u4e49 \u4e0a\u9762\u7684\u51fd\u6570\u4e2d\uff0c\u53ea\u6709match\u3001search\u6709group\u65b9\u6cd5\uff0c\u5176\u4ed6\u7684\u51fd\u6570\u6ca1\u6709\u3002 \u51fd\u6570\u7684\u65b9\u6cd5 \u00b6 group\uff1a\u83b7\u53d6\u5b50\u6a21\u5f0f(\u7ec4)\u7684\u5339\u914d\u9879 \u00b6 pat = re.compile(r'www\\.(.*)\\.(.*)') #\u7528()\u8868\u793a1\u4e2a\u7ec4\uff0c2\u4e2a\u7ec4 m = pat.match('www.dxy.com') m.group() #\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u793a\u5339\u914d\u6574\u4e2a\u5b57\u7b26\u4e32 'www.dxy.com' m.group(1) #\u8fd4\u56de\u7ed9\u5b9a\u7ec41\u5339\u914d\u7684\u5b50\u5b57\u7b26\u4e32 'dxy' m.group(2) 'com' start\uff1a\u7ed9\u5b9a\u7ec4\u5339\u914d\u9879\u7684\u5f00\u59cb\u4f4d\u7f6e \u00b6 m.start(2) #\u7ec42\u5f00\u59cb\u7684\u7d22\u5f15 8 end\uff1a\u7ed9\u5b9a\u7ec4\u5339\u914d\u9879\u7684\u7ed3\u675f\u4f4d\u7f6e \u00b6 m.end(2) #\u7ec42\u7ed3\u675f\u7684\u7d22\u5f15 11 span\uff1a \u7ed9\u5b9a\u7ec4\u5339\u914d\u9879\u7684\u5f00\u59cb\u7ed3\u675f\u4f4d\u7f6e \u00b6 m.span(2) #\u7ec42\u5f00\u59cb\u3001\u7ed3\u675f\u7684\u7d22\u5f15 (8, 11) \u6b63\u5219\u8868\u8fbe\u5f0f \u00b6 \u5143\u5b57\u7b26 \u00b6 \u201c.\u201d \uff1a\u901a\u914d\u7b26,\u9664\u6362\u884c\u7b26\u5916\u7684\u4efb\u610f\u76841\u4e2a\u5b57\u7b26 \u00b6 pat=re.compile('.') pat.match('abc') <_sre.SRE_Match object at 0xb72b6170> pat.match('abc').group() 'a' #\u5339\u914d\u5230\u4e86\u9996\u4e2a\u5b57\u7b26 pat.search('abc').group() 'a' pat.match('\\n').group() #\u6362\u884c\u7b26\u5339\u914d\u51fa\u9519 Traceback (most recent call last): File \"<stdin>\", line 1, in <module> AttributeError: 'NoneType' object has no attribute 'group' \u201c\\\u201d : \u8f6c\u4e49\u7b26 \u00b6 pat=re.compile('\\.') pat.search('abc.efg').group() #\u5339\u914d\u5230. '.' pat.findall('abc.efg') #\u4e0d\u7528group,\u8fd4\u56de\u5217\u8868 ['.'] \u201c[\u2026]\u201d : \u5b57\u7b26\u96c6\u5408\uff0c\u5339\u914d\u91cc\u9762\u7684\u4efb\u610f\u4e00\u4e2a\u5143\u7d20 \u00b6 >>> pat=re.compile('[abc]') >>> pat.match('axbycz').group() 'a' >>> pat.search('axbycz').group() 'a' >>> pat.findall('axbycz') ['a', 'b', 'c'] \u201c\\d\u201d : \u6570\u5b57 \u00b6 >>> pat=re.compile('\\d') >>> pat.search('ax1by2cz3').group() #\u5339\u914d\u5230\u7b2c\u4e00\u4e2a\u6570\u5b57:1\uff0c\u8fd4\u56de '1' >>> pat.match('ax1by2cz3').group() #\u5339\u914d\u4e0d\u5230\uff08\u9996\u4e2a\u4e0d\u662f\uff09\u8fd4\u56deNone\uff0c\u62a5\u9519\uff0cmatch\u5339\u914d\u5b57\u7b26\u4e32\u5934 Traceback (most recent call last): File \"<stdin>\", line 1, in <module> AttributeError: 'NoneType' object has no attribute 'group' >>> pat.findall('ax1by2cz3') #\u5339\u914d\u6240\u6709\u7684\u6570\u5b57\uff0c\u5217\u8868\u8fd4\u56de ['1', '2', '3'] \u201c\\D\u201d : \u975e\u6570\u5b57 \u00b6 >>> pat=re.compile('\\D') >>> pat.match('ax1by2cz3').group() 'a' >>> pat.search('ax1by2cz3').group() 'a' >>> pat.findall('ax1by2cz3') ['a', 'x', 'b', 'y', 'c', 'z'] \u201c\\s\u201d \uff1a\u7a7a\u767d\u5b57\u7b26 \u3001 \\t\u3001\\r\u3001\\n\u3001\u7a7a\u683c \u00b6 >>> pat=re.compile('\\s') >>> pat.findall('\\rax1 \\nby2 \\tcz3') ['\\r', ' ', '\\n', ' ', '\\t'] >>> pat.search('\\rax1 \\nby2 \\tcz3').group() '\\r' >>> pat.match('\\rax1 \\nby2 \\tcz3').group() '\\r' \u201cS\u201d :\u975e\u7a7a\u767d\u5b57\u7b26 \u00b6 >>> pat=re.compile('\\S') >>> pat.search('\\rax1 \\nby2 \\tcz3').group() 'a' >>> pat.findall('\\rax1 \\nby2 \\tcz3') ['a', 'x', '1', 'b', 'y', '2', 'c', 'z', '3'] \u201c\\w\u201d \uff1a\u5355\u4e2a\u7684 \u6570\u5b57\u548c\u5b57\u6bcd\uff0c[A-Za-z0-9] \u00b6 >>> pat=re.compile('\\w') >>> pat.search('1a2b3c').group() '1' >>> pat.findall('1a2b3c') ['1', 'a', '2', 'b', '3', 'c'] >>> pat.match('1a2b3c').group() '1' \u201c\\W\u201d:\u975e\u5355\u8bcd\u5b57\u7b26,\u9664\u6570\u5b57\u548c\u5b57\u6bcd\u5916 \u00b6 >>> pat=re.compile('\\W') >>> pat.findall('1a2\u6211b3c') #python\u662f\u7528\u4e09\u5b57\u8282\u8868\u793a\u4e00\u4e2a\u6c49\u5b57 ['\\xe6', '\\x88', '\\x91'] >>> pat.search('1a2\u6211b3c').group() '\\xe6' \u6570\u91cf\u8bcd \u00b6 \u201c*\u201d \uff1a0\u6b21\u6216\u591a\u6b21 \u00b6 \uff08 \u4e580\u4f1a\u53d8\u62100\uff09 >>> pat = re.compile('[abc]*') >>> pat.match('abcabcdefabc').group() 'abcabc' #2\u6b21 >>> pat.search('abcabcdefabc').group() 'abcabc' #2\u6b21 >>> pat.findall('abcabcdefabc') ['abcabc', '', '', '', 'abc', ''] #2\u6b21\u548c1\u6b21,\u56e0\u4e3a\u67090\u6b21\uff0c\u6240\u4ee5\u5339\u914d\u4e86'' \u201c+\u201d \uff1a1\u6b21\u6216\u591a\u6b21 \u00b6 \uff08 \u52a00\u4e0d\u4f1a\u53d8\u62100\uff09 >>> pat = re.compile('[abc]+') >>> pat.match('abcdefabcabc').group() 'abc' >>> pat.search('abcdefabcabc').group() 'abc' >>> pat.findall('abcdefabcabc') ['abc', 'abcabc'] \u201c?\u201d \uff1a0\u6b21\u62161\u6b21\uff0cmatch,search \u4e0d\u4f1a\u51fa\u73b0none\uff0c\u4f1a\u51fa\u73b0\u2019 \u2018 \uff08\u56e0\u4e3a0\u6b21\u4e5f\u662f\u7b26\u5408\u7684\uff09 \u00b6 0\u6b21\u62161\u6b21\u4e0d\u662f\u6307 [xxx] \u8fd9\u4e2a\u96c6\u5408\uff0c\u800c\u662f\u5176\u4e2d\u7684\u4efb\u4f55\u7684\u4e00\u4e2a\u5b57\u7b26 >>> pat = re.compile('[abc]?') >>> pat.match('defabc').group() #0\u6b21 '' >>> pat.match('abcdefabc').group() 'a' >>> pat.search('defabc').group() #0\u6b21 '' >>> pat.findall('defabc') #0\u6b21\u548c1\u6b21 ['', '', '', 'a', 'b', 'c', ''] #\u540e\u9762\u603b\u518d\u52a0\u4e2a'' \u201c\u6570\u91cf\u8bcd?\u201d \uff1a\u975e\u8d2a\u5a6a\u6a21\u5f0f\uff1a\u53ea\u5339\u914d\u6700\u5c11\u7684\uff08\u5c3d\u53ef\u80fd\u5c11\uff09\uff1b\u9ed8\u8ba4\u8d2a\u5a6a\u6a21\u5f0f\uff1a\u5339\u914d\u6700\u591a\u7684\uff08\u5c3d\u53ef\u80fd\u591a\uff09 \u00b6 >>> pat = re.compile('[abc]+') #\u8d2a\u5a6a\u6a21\u5f0f >>> pat.match('abcdefabcabc').group() #\u5339\u914d\u5c3d\u53ef\u80fd\u591a\u7684\uff1aabc 'abc' >>> pat.match('bbabcdefabcabc').group() 'bbabc' >>> pat.search('dbbabcdefabcabc').group() 'bbabc' >>> pat.findall('abcdefabcabc') ['abc', 'abcabc'] >>> pat = re.compile('[abc]+?') #\u975e\u8d2a\u5a6a\u6a21\u5f0f\uff1a+? >>> pat.match('abcdefabcabc').group() #\u5339\u914d\u5c3d\u53ef\u80fd\u5c11\u7684\uff1aa\u3001b\u3001c 'a' >>> pat.search('dbbabcdefabcabc').group() 'b' >>> pat.findall('abcdefabcabc') ['a', 'b', 'c', 'a', 'b', 'c', 'a', 'b', 'c'] \u201c{m}\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u51fa\u73b0m\u6b21 \u00b6 >>> pat = re.compile('[op]{2}') #o\u6216p\u51fa\u73b02\u6b21 >>> pat.search('abcooapp').group() #\u5339\u914d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u5b57\u7b26\u4e32,o\u6bd4p\u5148\u51fa\u73b0 'oo' >>> pat.findall('abcooapp') #\u5339\u914d\u51fa\u73b0\u7684\u6240\u6709\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u5f62\u5f0f\u8fd4\u56de ['oo', 'pp'] \u201c{m,n}\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u51fa\u73b0m\u5230n\u6b21 \u00b6 >>> pat = re.compile('[op]{2,4}') #o\u6216\u5219p\u51fa\u73b02\u52304\u6b21 >>> pat.match('pppabcooapp').group() #\u5339\u914d\u5f00\u5934 'ppp' >>> pat.search('pppabcooapp').group() #\u5339\u914d\u7b2c\u4e00\u6b21\u51fa\u73b0 'ppp' >>> pat.findall('pppabcooapp') #\u5339\u914d\u6240\u6709 ['ppp', 'oo', 'pp'] .group() #\u5339\u914d\u7b2c\u4e00\u6b21\u51fa\u73b0 \u00b6 \u8fb9\u754c \u00b6 \u201c^\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u5f00\u5934\u6216\u884c\u5934 \u00b6 >>> pat = re.compile('^[abc]') #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a >>> pat.search('defabc').group() >>> pat.match('defabc').group() #\u5747\u627e\u4e0d\u5230 >>> pat.findall('defabc') [] >>> pat.search('adefabc').group() 'a' >>> pat.match('adefabc').group() #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a 'a' >>> pat.findall('adefabc') ['a'] >>> pat = re.compile('^[abc]+') #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u7684\u4e00\u6b21\u6216\u5219\u591a\u6b21\uff0c\u8d2a\u5a6a\uff1a\u5339\u914d\u591a\u4e2a >>> pat.findall('cbadefab') ['cba'] >>> pat = re.compile(r'^[abc]+?') #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u7684\u4e00\u6b21\u6216\u5219\u591a\u6b21\uff0c\u975e\u8d2a\u5a6a\uff1a\u5339\u914d\u4e00\u4e2a >>> pat.findall('cbadefab') ['c'] \u201c$\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u7ed3\u5c3e\u6216\u5219\u884c\u5c3e \u00b6 >>> pat = re.compile('[abc]$') >>> pat.match('adefAbc').group() #match\u5339\u914d\u7684\u662f\u5b57\u7b26\u4e32\u5f00\u5934\uff0c\u6240\u4ee5\u67e5\u627e$\u7684\u65f6\uff0c\u603b\u662f\u8fd4\u56deNone >>> pat.search('adefAbc').group() #\u7ed3\u5c3e\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a 'c' >>> pat.findall('adefAbc') ['c'] >>> pat = re.compile('[abc]+$') >>> pat.search('adefAbc').group() #\u7ed3\u5c3e\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u7684\u4e00\u6b21\u6216\u5219\u591a\u6b21\uff0c\u8d2a\u5a6a\uff1a\u5339\u914d\u591a\u4e2a 'bc' >>> pat.findall('adefAbc') ['bc'] \u201c\\A\u201d\uff1a\u5339\u914d\u5b57\u7b26\u4e32\u5f00\u5934 \u00b6 >>> pat = re.compile('\\A[abc]+') >>> pat.findall('cbadefab') ['cba'] >>> pat.search('cbadefab').group() 'cba' \u201c\\Z\u201d\uff1a\u5339\u914d\u5b57\u7b26\u4e32\u7ed3\u5c3e \u00b6 >>> pat = re.compile('[abc]+\\Z') >>> pat.search('cbadefab').group() 'ab' >>> pat.findall('cbadefab') ['ab'] \u5206\u7ec4 \u00b6 (\u2026)\uff1a\u5206\u7ec4\u5339\u914d,\u4ece\u5de6\u5230\u53f3,\u6bcf\u9047\u5230\u4e00\u4e2a ( \u7f16\u53f7+1\uff0c\u5206\u7ec4\u540e\u9762\u53ef\u52a0\u6570\u91cf\u8bcd \u00b6 >>> pat=re.compile(r'(a)\\w(c)') #\\w:\u5355\u4e2a\u7684\u6570\u5b57\u6216\u5b57\u6bcd [A-Za-z0-9] >>> pat.match('abcdef').group() 'abc' >>> pat=re.compile('(a)b(c)') #\u52062\u7ec4\uff0c\u533f\u540d\u5206\u7ec4 >>> pat.match('abcdef').group() #\u9ed8\u8ba4\u8fd4\u56de\u5339\u914d\u7684\u5b57\u7b26\u4e32 'abc' >>> pat.match('abcdef').group(1) #\u53d6\u5206\u7ec41\uff0c\u9002\u7528\u4e8esearch 'a' >>> pat.match('abcdef').group(2) #\u53d6\u5206\u7ec42\uff0c\u9002\u7528\u4e8esearch 'c' >>> pat.match('abcdef').groups() #\u53d6\u6240\u6709\u5206\u7ec4\uff0c\u5143\u7ec4\u5f62\u5f0f\u8fd4\u56de ('a', 'c') \uff1a\u5f15\u7528\u7f16\u53f7\u4e3a \u7684\u5206\u7ec4\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 \u00b6 >>> pat=re.compile(r'www\\.(.*)\\..{3}') >>> pat.match('www.dxy.com').group(1) 'dxy' \u201c(?P \u2026)\u201d \uff1a\u5728\u6a21\u5f0f\u91cc\u9762\u7528()\u6765\u8868\u793a\u5206\u7ec4\uff08\u547d\u540d\u5206\u7ec4\uff09,\u9002\u7528\u4e8e\u63d0\u53d6\u76ee\u6807\u5b57\u7b26\u4e32\u4e2d\u7684\u67d0\u4e00\u4e9b\u90e8\u4f4d\u3002 \u00b6 >>> pat=re.compile(r'(?P<K>a)\\w(c)') #\u52062\u7ec4\uff1a\u547d\u540d\u5206\u7ec4+\u533f\u540d\u5206\u7ec4 >>> pat.search('abcdef').groups() #\u53d6\u6240\u6709\u5206\u7ec4\uff0c\u5143\u7ec4\u5f62\u5f0f\u8fd4\u56de ('a', 'c') >>> pat.search('abcdef').group(1) #\u53d6\u5206\u7ec41\uff0c\u9002\u7528\u4e8ematch 'a' >>> pat.search('abcdef').group(2) #\u53d6\u5206\u7ec42\uff0c\u9002\u7528\u4e8ematch 'c' >>> pat.search('abcdef').group() #\u9ed8\u8ba4\u8fd4\u56de\u5339\u914d\u7684\u5b57\u7b26\u4e32 'abc' >>> pat.search('abcdef').groupdict() #\u547d\u540d\u5206\u7ec4\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u5b57\u5178\u3010\u4e13\u6709\u3011\uff0c\u533f\u540d\u5206\u7ec4\u4e5f\u6ca1\u6709 {'K': 'a'} \u201c(?P=name)\u201d\uff1a\u5f15\u7528\u522b\u540d\u4e3a \u7684\u5206\u7ec4\u5339\u914d\u5230\u7684\u4e32 \u00b6 >>> pat=re.compile(r'(?P<K>a)\\w(c)(?P=K)') #(?P=K)\u5f15\u7528\u5206\u7ec41\u7684\u503c\uff0c\u5c31\u662fa >>> pat.search('abcdef').group() #\u5339\u914d\u4e0d\u5230\uff0c\u56e0\u4e3a\u5b8c\u6574'a\\wca',\u6a21\u5f0f\u7684\u7b2c4\u4f4d\u662fa Traceback (most recent call last): File \"<stdin>\", line 1, in <module> AttributeError: 'NoneType' object has no attribute 'group' >>> pat.search('abcadef').group() #\u5339\u914d\u5230\uff0c\u6a21\u5f0f\u7684\u7b2c4\u4f4d\u548c\u7ec41\u4e00\u6837,\u503c\u662fc 'abca' >>> pat.search('abcadef').groups() ('a', 'c') >>> pat.search('abcadef').group(1) 'a' >>> pat.search('abcadef').group(2) 'c \u201c \u201d \uff1a\u5f15\u7528\u5206\u7ec4\u7f16\u53f7\u5339\u914d\uff1a \u00b6 >>> pat=re.compile(r'(?P<K>a)\\w(c)(?P=K)\\2') #\\2\u5f15\u7528\u5206\u7ec42\u7684\u503c\uff0c\u5c31\u662fc >>> pat.findall('Aabcadef') #\u5339\u914d\u4e0d\u5230\uff0c\u56e0\u4e3a\u5b8c\u6574'a\\wcac',\u6a21\u5f0f\u7684\u7b2c5\u4f4d\u662fc [] >>> pat.findall('Aabcacdef') #\u5339\u914d\u5230\uff0c\u6a21\u5f0f\u7684\u7b2c5\u4f4d\u548c\u7ec42\u4e00\u6837,\u503c\u662fc [('a', 'c')] >>> pat.search('Aabcacdef').groups() ('a', 'c') >>> pat.search('Aabcacdef').group() 'abcac' >>> pat.search('Aabcacdef').group(1) 'a' >>> pat.search('Aabcacdef').group(2) 'c' \u7279\u6b8a\u6784\u9020 \u00b6 (?:\u2026) (\u2026) \u4e0d\u5206\u7ec4\u7248\u672c,\u7528\u4e8e\u4f7f\u7528 | \u6216\u8005\u540e\u63a5\u6570\u91cf\u8bcd (?iLmsux) iLmsux\u7684\u6bcf\u4e2a\u5b57\u7b26\u4ee3\u8868\u4e00\u4e2a\u5339\u914d\u6a21\u5f0f,\u53ea\u80fd\u7528\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5f00\u5934,\u53ef\u9009\u591a\u4e2a (?#\u2026) #\u53f7\u540e\u7684\u5185\u5bb9\u5c06\u4f5c\u4e3a\u6ce8\u91ca (?=\u2026) \u4e4b\u540e\u7684\u5b57\u7b26\u4e32\u5185\u5bb9\u9700\u8981\u5339\u914d\u8868\u8fbe\u5f0f\u624d\u80fd\u6210\u529f\u5339\u914d (?!\u2026) \u4e4b\u540e\u7684\u5b57\u7b26\u4e32\u4e0d\u5339\u914d\u8868\u8fbe\u5f0f\u624d\u80fd\u6210\u529f (?(?(?(id/name) yes |no) \u5982\u679c\u7f16\u53f7\u4e3aid/\u540d\u5b57\u4e3aname\u7684\u7ec4\u5339\u914d\u5230\u5b57\u7b26\u4e32,\u5219\u9700\u8981\u5339\u914dyes,\u5426\u5219\u5339\u914dno,no\u53ef\u4ee5\u7701\u7565 \u201c(?:\u2026)\u201d \uff1a()\u91cc\u9762\u6709?:\u8868\u793a\u8be5()\u4e0d\u662f\u5206\u7ec4 \u00b6 >>> pat=re.compile(r'a(?:bc)') >>> pat.findall('abc') ['abc'] >>> pat.match('abc').groups() #\u663e\u793a\u4e0d\u51fa\u5206\u7ec4 \u201c(?=\u2026)\u201d\uff1a\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u540e\u8fdb\u884c\u5339\u914d\uff0c\u603b\u662f\u5bf9\u540e\u9762\u8fdb\u884c\u5339\u914d \u00b6 >>> pat=re.compile(r'\\w(?=\\d)') #\u5339\u914d\u8868\u8fbe\u5f0f\\d\uff0c\u8fd4\u56de\u6570\u5b57\u7684\u524d\u4e00\u4f4d\uff0c\\w\uff1a\u5355\u8bcd\u5b57\u7b26[A-Za-z0-9] >>> pat.findall('abc1 def1 xyz1') ['c', 'f', 'z'] >>> pat.findall('zhoujy20130628hangzhou') #\u5339\u914d\u6570\u5b57\u7684\u524d\u4e00\u4f4d\uff0c\u5217\u8868\u8fd4\u56de ['y', '2', '0', '1', '3', '0', '6', '2'] >>> pat=re.compile(r'\\w+(?=\\d)') >>> pat.findall('abc1,def1,xyz1') #\u5339\u914d\u6700\u672b\u6570\u5b57\u7684\u524d\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u8fd4\u56de ['abc', 'def', 'xyz'] >>> pat.findall('abc21,def31,xyz41') ['abc2', 'def3', 'xyz4'] >>> pat.findall('zhoujy20130628hangzhou') ['zhoujy2013062'] >>> pat=re.compile(r'[A-Za-z]+(?=\\d)') #[A-Za-z],\u5339\u914d\u5b57\u6bcd,\u53ef\u4ee5\u7528\u5176\u4ed6\u7684\u6b63\u5219\u65b9\u6cd5 >>> pat.findall('zhoujy20130628hangzhou123') #\u5339\u914d\u540e\u9762\u5e26\u6709\u6570\u5b57\u7684\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u8fd4\u56de ['zhoujy', 'hangzhou'] >>> pat.findall('abc21,def31,xyz41') ['abc', 'def', 'xyz'] \u201c(?!\u2026)\u201d \u4e0d\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u540e\u8fdb\u884c\u5339\u914d \u00b6 >>> pat=re.compile(r'[A-Za-z]+(?!\\d)') #[A-Za-z],\u5339\u914d\u5b57\u6bcd,\u53ef\u4ee5\u7528\u5176\u4ed6\u7684\u6b63\u5219\u65b9\u6cd5 >>> pat.findall('zhoujy20130628hangzhou123,12,binjiang310') #\u5339\u914d\u540e\u9762\u4e0d\u662f\u6570\u5b57\u7684\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u8fd4\u56de ['zhouj', 'hangzho', 'binjian'] >>> pat.findall('abc21,def31,xyz41') ['ab', 'de', 'xy'] \u201c(?<=\u2026)\u201d\uff1a\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u524d\u8fdb\u884c\u5339\u914d,\u603b\u662f\u5bf9\u524d\u9762\u8fdb\u884c\u5339\u914d \u00b6 >>> pat=re.compile(r'(?<=\\d)[A-Za-z]+') #\u5339\u914d\u524d\u9762\u662f\u6570\u5b57\u7684\u5b57\u6bcd >>> pat.findall('abc21,def31,xyz41') [] >>> pat.findall('1abc21,2def31,3xyz41') ['abc', 'def', 'xyz'] >>> pat.findall('zhoujy20130628hangzhou123,12,binjiang310') ['hangzhou'] \u201c(?<!\u2026)\u201d\uff1a\u4e0d\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u524d\u8fdb\u884c\u5339\u914d,\u603b\u662f\u5bf9\u524d\u9762\u8fdb\u884c\u5339\u914d \u00b6 >>> pat=re.compile(r'(?<!\\d)[A-Za-z]+') #\u5339\u914d\u524d\u9762\u4e0d\u662f\u6570\u5b57\u7684\u5b57\u6bcd >>> pat.findall('abc21,def31,xyz41') ['abc', 'def', 'xyz'] >>> pat.findall('zhoujy20130628hangzhou123,12,binjiang310') ['zhoujy', 'angzhou', 'binjiang'] \u201c(?(id/name) yes |no)\u201d: \u7ec4\u662f\u5426\u5339\u914d\uff0c\u5339\u914d\u8fd4\u56de \u00b6 >>> pat=re.compile(r'a(\\d)?bc(?(1)\\d)') #no\u7701\u7565\u4e86\uff0c\u5b8c\u6574\u7684\u662fa\\dbc\\d ==> a2bc3,\u603b\u51715\u4f4d\uff0c\u7b2c2\u4f4d\u662f\u53ef\u6709\u53ef\u65e0\u7684\u6570\u5b57\uff0c\u7b2c5\u4e3a\u662f\u6570\u5b57 >>> pat.findall('abc9') #\u8fd4\u56de\u7ec41\uff0c\u4f46\u7b2c2\u4f4d\uff08\u7ec41\uff09\u6ca1\u6709\uff0c\u5373\u8fd4\u56de\u4e86'' [''] >>> pat.findall('a8bc9') #\u5b8c\u6574\u7684\u6a21\u5f0f\uff0c\u8fd4\u56de\u7ec41 ['8'] >>> pat.match('a8bc9').group() 'a8bc9' >>> pat.match('a8bc9').group(1) '8' >>> pat.findall('a8bc') #\u7b2c5\u4f4d\u4e0d\u5b58\u5728\uff0c\u5219\u6ca1\u6709\u5339\u914d\u5230 [] \u201c(?iLmsux)\u201d:\u8fd9\u91cc\u5c31\u4ecb\u7ecd\u4e0bi\u53c2\u6570\uff1a\u5927\u5c0f\u5199\u533a\u5206\u5339\u914d \u00b6 >>> pat=re.compile(r'abc') >>> pat.findall('abc') ['abc'] >>> pat.findall('ABC') [] >>> pat=re.compile(r'(?i)abc') #(?i) \u4e0d\u533a\u5206\u5927\u5c0f\u5199 >>> pat.findall('ABC') ['ABC'] >>> pat.findall('abc') ['abc'] >>> pat.findall('aBc') ['aBc'] >>> pat.findall('aBC') ['aBC'] >>> pat=re.compile(r'abc',re.I) #re.I \u4f5c\u4e3a\u53c2\u6570\u4f7f\u7528\uff0c\u63a8\u8350 >>> pat.findall('aBC') ['aBC'] >>> pat.findall('abc') ['abc'] >>> pat.findall('ABC') ['ABC']","title":"Re \u6a21\u5757"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#re","text":"","title":"re\u6a21\u5757\u4e0b\u7684\u51fd\u6570"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#compilepattern","text":"import re pat=re.compile('A') m=pat.search('CBA') #\u7b49\u4ef7\u4e8e re.search('A','CBA') print m <_sre.SRE_Match object at 0x9d690c8> #\u5339\u914d\u5230\u4e86\uff0c\u8fd4\u56deMatchObject\uff08True\uff09 m=pat.search('CBD') print m None #\u6ca1\u6709\u5339\u914d\u5230\uff0c\u8fd4\u56deNone\uff08False\uff09","title":"compile(pattern)\uff1a\u521b\u5efa\u6a21\u5f0f\u5bf9\u8c61"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#searchpatternstring","text":"m = re.search('asd','ASDasd') print m <_sre.SRE_Match object at 0xb72cd6e8> #\u5339\u914d\u5230\u4e86\uff0c\u8fd4\u56deMatchObject\uff08True\uff09 m = re.search('asd','ASDASD') print m None #\u6ca1\u6709\u5339\u914d\u5230\uff0c\u8fd4\u56deNone\uff08False\uff09","title":"search(pattern,string)\uff1a\u5728\u5b57\u7b26\u4e32\u4e2d\u5bfb\u627e\u6a21\u5f0f"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#matchpatternstring","text":"m = re.search('asd','ASDasd') print m <_sre.SRE_Match object at 0xb72cd6e8> #\u5339\u914d\u5230\u4e86\uff0c\u8fd4\u56deMatchObject\uff08True\uff09 m = re.search('asd','ASDASD') print m None #\u6ca1\u6709\u5339\u914d\u5230\uff0c\u8fd4\u56deNone\uff08False\uff09","title":"match(pattern,string)\uff1a\u5728\u5b57\u7b26\u4e32\u5f00\u59cb\u5904\u5339\u914d\u6a21\u5f0f"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_1","text":"pat=re.compile('a') print pat.match('Aasd') None printpat.match('aASD') <_sre.SRE_Match object at 0xb72cd6e8>","title":"\u7b49\u4ef7\u4e8e"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#if","text":"if pat.search('asd'): ... print 'OK' ... OK #\u627e\u5230\u8fd4\u56de if re.search('a','ASD'): ... print \"OK\" ... #\u6ca1\u6709\u627e\u5230","title":"\u4e0a\u9762\u7684\u51fd\u6570\u8fd4\u56de\u90fd\u53ef\u4ee5\u5728if\u6761\u4ef6\u8bed\u53e5\u4e2d\u8fdb\u884c\u5224\u65ad\uff1a"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#splitpatternstring","text":"re.split(',','a,s,d,asd') ['a', 's', 'd', 'asd'] #\u8fd4\u56de\u5217\u8868 pat = re.compile(',') pat.split('a,s,d,asd') ['a', 's', 'd', 'asd'] #\u8fd4\u56de\u5217\u8868 re.split('[, ]+','a , s ,d ,,,,,asd') #\u6b63\u5219\u5339\u914d\uff1a[, ]+\uff0c\u540e\u9762\u8bf4\u660e ['a', 's', 'd', 'asd'] re.split('[, ]+','a , s ,d ,,,,,asd',maxsplit=2) # maxsplit \u6700\u591a\u5206\u5272\u6b21\u6570 ['a', 's', 'd ,,,,,asd'] pat = re.compile('[, ]+') #\u6b63\u5219\u5339\u914d\uff1a[, ]+\uff0c\u540e\u9762\u8bf4\u660e pat.split('a , s ,d ,,,,,asd',maxsplit=2) # maxsplit \u6700\u591a\u5206\u5272\u6b21\u6570 ['a', 's', 'd ,,,,,asd']","title":"split(pattern,string)\uff1a\u6839\u636e\u6a21\u5f0f\u5206\u5272\u5b57\u7b26\u4e32,\u8fd4\u56de\u5217\u8868"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#findallpatternstring","text":"re.findall('a','ASDaDFGAa') ['a', 'a'] #\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 pat = re.compile('a') pat.findall('ASDaDFGAa') ['a', 'a'] #\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 pat = re.compile('[A-Z]+') #\u6b63\u5219\u5339\u914d\uff1a'[A-Z]+' \u540e\u9762\u6709\u8bf4\u660e pat.findall('ASDcDFGAa') ['ASD', 'DFGA'] #\u627e\u5230\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 pat = re.compile('[A-Z]') pat.findall('ASDcDFGAa') #\u6b63\u5219\u5339\u914d\uff1a'[A-Z]+' \u540e\u9762\u6709\u8bf4\u660e ['A', 'S', 'D', 'D', 'F', 'G', 'A'] #\u627e\u5230\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 pat = re.compile('[A-Za-z]') #\u6b63\u5219\u5339\u914d\uff1a'[A-Za-z]+' \u5339\u914d\u6240\u6709\u5355\u8bcd\uff0c\u540e\u9762\u6709\u8bf4\u660e pat.findall('ASDcDFGAa') ['A', 'S', 'D', 'c', 'D', 'F', 'G', 'A', 'a']","title":"findall(pattern,string)\uff1a\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\u5339\u914d\u9879"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#subpatreplstring-repl-pat","text":"(\u7559\u7684\u662f\u4e2d\u95f4\u7684\uff0c\u56e0\u4e3a\u4e2d\u95f4\u5728\u4e2d\u5fc3) re.sub('a','A','abcasd') #\u627e\u5230a\u7528A\u66ff\u6362\uff0c\u540e\u9762\u89c1\u548cgroup\u7684\u914d\u5408\u4f7f\u7528 'AbcAsd' pat = re.compile('a') pat.sub('A','abcasd') 'AbcAsd' pat=re.compile(r'www\\.(.*)\\..{3}') #\u6b63\u5219\u8868\u8fbe\u5f0f #\u5728Python\u7684string\u524d\u9762\u52a0\u4e0a\u2018r\u2019\uff0c \u662f\u4e3a\u4e86\u544a\u8bc9\u7f16\u8bd1\u5668\u8fd9\u4e2astring\u662f\u4e2araw string\uff0c\u4e0d\u8981\u8f6c\u8bd1\u53cd\u659c\u6760 '\\' \u3002 #\u4f8b\u5982\uff0c\\n \u5728raw string\u4e2d\uff0c\u662f\u4e24\u4e2a\u5b57\u7b26\uff0c\\\u548cn\uff0c \u800c\u4e0d\u4f1a\u8f6c\u8bd1\u4e3a\u6362\u884c\u7b26\u3002 #\u7531\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u548c \\ \u4f1a\u6709\u51b2\u7a81\uff0c\u56e0\u6b64\uff0c\u5f53\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f7f\u7528\u4e86\u6b63\u5219\u8868\u8fbe\u5f0f\u540e\uff0c\u6700\u597d\u5728\u524d\u9762\u52a0\u4e0a'r'\u3002 #\u4e0e\u5927\u591a\u6570\u7f16\u7a0b\u8bed\u8a00\u76f8\u540c\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u91cc\u4f7f\u7528\"\\\"\u4f5c\u4e3a\u8f6c\u4e49\u5b57\u7b26\uff0c\u8fd9\u5c31\u53ef\u80fd\u9020\u6210\u53cd\u659c\u6760\u56f0\u6270\u3002 #\u5047\u5982\u4f60\u9700\u8981\u5339\u914d\u6587\u672c\u4e2d\u7684\u5b57\u7b26\"\\\"\uff0c\u90a3\u4e48\u4f7f\u7528\u7f16\u7a0b\u8bed\u8a00\u8868\u793a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u91cc\u5c06\u9700\u89814\u4e2a\u53cd\u659c\u6760\"\\\\\\\\\"\uff1a #\u524d\u4e24\u4e2a\u548c\u540e\u4e24\u4e2a\u5206\u522b\u7528\u4e8e\u5728\u7f16\u7a0b\u8bed\u8a00\u91cc\u8f6c\u4e49\u6210\u53cd\u659c\u6760\uff0c\u8f6c\u6362\u6210\u4e24\u4e2a\u53cd\u659c\u6760\u540e\u518d\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u91cc\u8f6c\u4e49\u6210\u4e00\u4e2a\u53cd\u659c\u6760\u3002 #Python\u91cc\u7684\u539f\u751f\u5b57\u7b26\u4e32\u5f88\u597d\u5730\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u53ef\u4ee5\u4f7f\u7528r\"\\\\\"\u8868\u793a\u3002 #\u540c\u6837\uff0c\u5339\u914d\u4e00\u4e2a\u6570\u5b57\u7684\"\\\\d\"\u53ef\u4ee5\u5199\u6210r\"\\d\"\u3002 #\u6709\u4e86\u539f\u751f\u5b57\u7b26\u4e32\uff0c\u4f60\u518d\u4e5f\u4e0d\u7528\u62c5\u5fc3\u662f\u4e0d\u662f\u6f0f\u5199\u4e86\u53cd\u659c\u6760\uff0c\u5199\u51fa\u6765\u7684\u8868\u8fbe\u5f0f\u4e5f\u66f4\u76f4\u89c2\u3002 #\u4e0d\u662f\u8bf4 \u52a0\u4e86r \\\u5c31\u6ca1\u6709\u8f6c\u8bd1\u529f\u80fd\uff0c\u597d\u4e71\uff0c\u5c31\u76f4\u63a5\u8bb0\u4f4f1\u53e5\u8bdd\uff1a #\u5f53\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f7f\u7528\u4e86\u6b63\u5219\u8868\u8fbe\u5f0f\u540e\uff0c\u6700\u597d\u5728\u524d\u9762\u52a0\u4e0a'r'\uff0c\u8fd9\u6837\u4f60\u518d\u4e5f\u4e0d\u7528\u62c5\u5fc3\u662f\u4e0d\u662f\u6f0f\u5199\u4e86\u53cd\u659c\u6760\uff0c\u5199\u51fa\u6765\u7684\u8868\u8fbe\u5f0f\u4e5f\u66f4\u76f4\u89c2 pat.match('www.dxy.com').group(1) 'dxy' re.sub(r'www\\.(.*)\\..{3}',r'\\1','hello,www.dxy.com') pat.sub(r'\\1','hello,www.dxy.com') 'hello,dxy' # r'1' \u662f\u7b2c\u4e00\u7ec4\u7684\u610f\u601d #\u901a\u8fc7\u6b63\u5219\u5339\u914d\u627e\u5230\u7b26\u5408\u89c4\u5219\u7684\"www.dxy.com\" \uff0c\u53d6\u5f97 \u7ec41\u5b57\u7b26\u4e32 \u53bb\u66ff\u6362 \u6574\u4e2a\u5339\u914d\u3002 pat=re.compile(r'(\\w+) (\\w+)') #\u6b63\u5219\u8868\u8fbe\u5f0f s='hello world ! hello hz !' pat.findall('hello world ! hello hz !') [('hello', 'world'), ('hello', 'hz')] pat.sub(r'\\2 \\1',s) #\u901a\u8fc7\u6b63\u5219\u5f97\u5230\u7ec41(hello)\uff0c\u7ec42(world)\uff0c\u518d\u901a\u8fc7sub\u53bb\u66ff\u6362\u3002\u5373\u7ec41\u66ff\u6362\u7ec42\uff0c\u7ec42\u66ff\u6362\u7ec41\uff0c\u8c03\u6362\u4f4d\u7f6e\u3002 'world hello!hz hello!'","title":"sub(pat,repl,string) \uff1a\u7528repl\u66ff\u6362 pat\u5339\u914d\u9879"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#escapestring","text":"re.escape('www.dxy.cn') 'www\\\\.dxy\\\\.cn' #\u8f6c\u4e49 \u4e0a\u9762\u7684\u51fd\u6570\u4e2d\uff0c\u53ea\u6709match\u3001search\u6709group\u65b9\u6cd5\uff0c\u5176\u4ed6\u7684\u51fd\u6570\u6ca1\u6709\u3002","title":"escape(string) \uff1a\u5bf9\u5b57\u7b26\u4e32\u91cc\u9762\u7684\u7279\u6b8a\u5b57\u7b26\u4e32\u8fdb\u884c\u8f6c\u4e49"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_2","text":"","title":"\u51fd\u6570\u7684\u65b9\u6cd5"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#group","text":"pat = re.compile(r'www\\.(.*)\\.(.*)') #\u7528()\u8868\u793a1\u4e2a\u7ec4\uff0c2\u4e2a\u7ec4 m = pat.match('www.dxy.com') m.group() #\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u793a\u5339\u914d\u6574\u4e2a\u5b57\u7b26\u4e32 'www.dxy.com' m.group(1) #\u8fd4\u56de\u7ed9\u5b9a\u7ec41\u5339\u914d\u7684\u5b50\u5b57\u7b26\u4e32 'dxy' m.group(2) 'com'","title":"group\uff1a\u83b7\u53d6\u5b50\u6a21\u5f0f(\u7ec4)\u7684\u5339\u914d\u9879"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#start","text":"m.start(2) #\u7ec42\u5f00\u59cb\u7684\u7d22\u5f15 8","title":"start\uff1a\u7ed9\u5b9a\u7ec4\u5339\u914d\u9879\u7684\u5f00\u59cb\u4f4d\u7f6e"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#end","text":"m.end(2) #\u7ec42\u7ed3\u675f\u7684\u7d22\u5f15 11","title":"end\uff1a\u7ed9\u5b9a\u7ec4\u5339\u914d\u9879\u7684\u7ed3\u675f\u4f4d\u7f6e"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#span","text":"m.span(2) #\u7ec42\u5f00\u59cb\u3001\u7ed3\u675f\u7684\u7d22\u5f15 (8, 11)","title":"span\uff1a \u7ed9\u5b9a\u7ec4\u5339\u914d\u9879\u7684\u5f00\u59cb\u7ed3\u675f\u4f4d\u7f6e"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_3","text":"","title":"\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_4","text":"","title":"\u5143\u5b57\u7b26"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#1","text":"pat=re.compile('.') pat.match('abc') <_sre.SRE_Match object at 0xb72b6170> pat.match('abc').group() 'a' #\u5339\u914d\u5230\u4e86\u9996\u4e2a\u5b57\u7b26 pat.search('abc').group() 'a' pat.match('\\n').group() #\u6362\u884c\u7b26\u5339\u914d\u51fa\u9519 Traceback (most recent call last): File \"<stdin>\", line 1, in <module> AttributeError: 'NoneType' object has no attribute 'group'","title":"\u201c.\u201d \uff1a\u901a\u914d\u7b26,\u9664\u6362\u884c\u7b26\u5916\u7684\u4efb\u610f\u76841\u4e2a\u5b57\u7b26"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_5","text":"pat=re.compile('\\.') pat.search('abc.efg').group() #\u5339\u914d\u5230. '.' pat.findall('abc.efg') #\u4e0d\u7528group,\u8fd4\u56de\u5217\u8868 ['.']","title":"\u201c\\\u201d : \u8f6c\u4e49\u7b26"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_6","text":">>> pat=re.compile('[abc]') >>> pat.match('axbycz').group() 'a' >>> pat.search('axbycz').group() 'a' >>> pat.findall('axbycz') ['a', 'b', 'c']","title":"\u201c[\u2026]\u201d : \u5b57\u7b26\u96c6\u5408\uff0c\u5339\u914d\u91cc\u9762\u7684\u4efb\u610f\u4e00\u4e2a\u5143\u7d20"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#d","text":">>> pat=re.compile('\\d') >>> pat.search('ax1by2cz3').group() #\u5339\u914d\u5230\u7b2c\u4e00\u4e2a\u6570\u5b57:1\uff0c\u8fd4\u56de '1' >>> pat.match('ax1by2cz3').group() #\u5339\u914d\u4e0d\u5230\uff08\u9996\u4e2a\u4e0d\u662f\uff09\u8fd4\u56deNone\uff0c\u62a5\u9519\uff0cmatch\u5339\u914d\u5b57\u7b26\u4e32\u5934 Traceback (most recent call last): File \"<stdin>\", line 1, in <module> AttributeError: 'NoneType' object has no attribute 'group' >>> pat.findall('ax1by2cz3') #\u5339\u914d\u6240\u6709\u7684\u6570\u5b57\uff0c\u5217\u8868\u8fd4\u56de ['1', '2', '3']","title":"\u201c\\d\u201d : \u6570\u5b57"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#d_1","text":">>> pat=re.compile('\\D') >>> pat.match('ax1by2cz3').group() 'a' >>> pat.search('ax1by2cz3').group() 'a' >>> pat.findall('ax1by2cz3') ['a', 'x', 'b', 'y', 'c', 'z']","title":"\u201c\\D\u201d : \u975e\u6570\u5b57"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#s-trn","text":">>> pat=re.compile('\\s') >>> pat.findall('\\rax1 \\nby2 \\tcz3') ['\\r', ' ', '\\n', ' ', '\\t'] >>> pat.search('\\rax1 \\nby2 \\tcz3').group() '\\r' >>> pat.match('\\rax1 \\nby2 \\tcz3').group() '\\r'","title":"\u201c\\s\u201d \uff1a\u7a7a\u767d\u5b57\u7b26 \u3001 \\t\u3001\\r\u3001\\n\u3001\u7a7a\u683c"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#s","text":">>> pat=re.compile('\\S') >>> pat.search('\\rax1 \\nby2 \\tcz3').group() 'a' >>> pat.findall('\\rax1 \\nby2 \\tcz3') ['a', 'x', '1', 'b', 'y', '2', 'c', 'z', '3']","title":"\u201cS\u201d :\u975e\u7a7a\u767d\u5b57\u7b26"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#w-a-za-z0-9","text":">>> pat=re.compile('\\w') >>> pat.search('1a2b3c').group() '1' >>> pat.findall('1a2b3c') ['1', 'a', '2', 'b', '3', 'c'] >>> pat.match('1a2b3c').group() '1'","title":"\u201c\\w\u201d \uff1a\u5355\u4e2a\u7684 \u6570\u5b57\u548c\u5b57\u6bcd\uff0c[A-Za-z0-9]"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#w","text":">>> pat=re.compile('\\W') >>> pat.findall('1a2\u6211b3c') #python\u662f\u7528\u4e09\u5b57\u8282\u8868\u793a\u4e00\u4e2a\u6c49\u5b57 ['\\xe6', '\\x88', '\\x91'] >>> pat.search('1a2\u6211b3c').group() '\\xe6'","title":"\u201c\\W\u201d:\u975e\u5355\u8bcd\u5b57\u7b26,\u9664\u6570\u5b57\u548c\u5b57\u6bcd\u5916"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_7","text":"","title":"\u6570\u91cf\u8bcd"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#0","text":"\uff08 \u4e580\u4f1a\u53d8\u62100\uff09 >>> pat = re.compile('[abc]*') >>> pat.match('abcabcdefabc').group() 'abcabc' #2\u6b21 >>> pat.search('abcabcdefabc').group() 'abcabc' #2\u6b21 >>> pat.findall('abcabcdefabc') ['abcabc', '', '', '', 'abc', ''] #2\u6b21\u548c1\u6b21,\u56e0\u4e3a\u67090\u6b21\uff0c\u6240\u4ee5\u5339\u914d\u4e86''","title":"\u201c*\u201d \uff1a0\u6b21\u6216\u591a\u6b21"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#1_1","text":"\uff08 \u52a00\u4e0d\u4f1a\u53d8\u62100\uff09 >>> pat = re.compile('[abc]+') >>> pat.match('abcdefabcabc').group() 'abc' >>> pat.search('abcdefabcabc').group() 'abc' >>> pat.findall('abcdefabcabc') ['abc', 'abcabc']","title":"\u201c+\u201d \uff1a1\u6b21\u6216\u591a\u6b21"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#01matchsearch-none-0","text":"0\u6b21\u62161\u6b21\u4e0d\u662f\u6307 [xxx] \u8fd9\u4e2a\u96c6\u5408\uff0c\u800c\u662f\u5176\u4e2d\u7684\u4efb\u4f55\u7684\u4e00\u4e2a\u5b57\u7b26 >>> pat = re.compile('[abc]?') >>> pat.match('defabc').group() #0\u6b21 '' >>> pat.match('abcdefabc').group() 'a' >>> pat.search('defabc').group() #0\u6b21 '' >>> pat.findall('defabc') #0\u6b21\u548c1\u6b21 ['', '', '', 'a', 'b', 'c', ''] #\u540e\u9762\u603b\u518d\u52a0\u4e2a''","title":"\u201c?\u201d \uff1a0\u6b21\u62161\u6b21\uff0cmatch,search \u4e0d\u4f1a\u51fa\u73b0none\uff0c\u4f1a\u51fa\u73b0\u2019 \u2018 \uff08\u56e0\u4e3a0\u6b21\u4e5f\u662f\u7b26\u5408\u7684\uff09"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_8","text":">>> pat = re.compile('[abc]+') #\u8d2a\u5a6a\u6a21\u5f0f >>> pat.match('abcdefabcabc').group() #\u5339\u914d\u5c3d\u53ef\u80fd\u591a\u7684\uff1aabc 'abc' >>> pat.match('bbabcdefabcabc').group() 'bbabc' >>> pat.search('dbbabcdefabcabc').group() 'bbabc' >>> pat.findall('abcdefabcabc') ['abc', 'abcabc'] >>> pat = re.compile('[abc]+?') #\u975e\u8d2a\u5a6a\u6a21\u5f0f\uff1a+? >>> pat.match('abcdefabcabc').group() #\u5339\u914d\u5c3d\u53ef\u80fd\u5c11\u7684\uff1aa\u3001b\u3001c 'a' >>> pat.search('dbbabcdefabcabc').group() 'b' >>> pat.findall('abcdefabcabc') ['a', 'b', 'c', 'a', 'b', 'c', 'a', 'b', 'c']","title":"\u201c\u6570\u91cf\u8bcd?\u201d \uff1a\u975e\u8d2a\u5a6a\u6a21\u5f0f\uff1a\u53ea\u5339\u914d\u6700\u5c11\u7684\uff08\u5c3d\u53ef\u80fd\u5c11\uff09\uff1b\u9ed8\u8ba4\u8d2a\u5a6a\u6a21\u5f0f\uff1a\u5339\u914d\u6700\u591a\u7684\uff08\u5c3d\u53ef\u80fd\u591a\uff09"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#m-m","text":">>> pat = re.compile('[op]{2}') #o\u6216p\u51fa\u73b02\u6b21 >>> pat.search('abcooapp').group() #\u5339\u914d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u5b57\u7b26\u4e32,o\u6bd4p\u5148\u51fa\u73b0 'oo' >>> pat.findall('abcooapp') #\u5339\u914d\u51fa\u73b0\u7684\u6240\u6709\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u5f62\u5f0f\u8fd4\u56de ['oo', 'pp']","title":"\u201c{m}\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u51fa\u73b0m\u6b21"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#mn-mn","text":">>> pat = re.compile('[op]{2,4}') #o\u6216\u5219p\u51fa\u73b02\u52304\u6b21 >>> pat.match('pppabcooapp').group() #\u5339\u914d\u5f00\u5934 'ppp' >>> pat.search('pppabcooapp').group() #\u5339\u914d\u7b2c\u4e00\u6b21\u51fa\u73b0 'ppp' >>> pat.findall('pppabcooapp') #\u5339\u914d\u6240\u6709 ['ppp', 'oo', 'pp']","title":"\u201c{m,n}\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u51fa\u73b0m\u5230n\u6b21"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#group_1","text":"","title":".group() #\u5339\u914d\u7b2c\u4e00\u6b21\u51fa\u73b0"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_9","text":"","title":"\u8fb9\u754c"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_10","text":">>> pat = re.compile('^[abc]') #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a >>> pat.search('defabc').group() >>> pat.match('defabc').group() #\u5747\u627e\u4e0d\u5230 >>> pat.findall('defabc') [] >>> pat.search('adefabc').group() 'a' >>> pat.match('adefabc').group() #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a 'a' >>> pat.findall('adefabc') ['a'] >>> pat = re.compile('^[abc]+') #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u7684\u4e00\u6b21\u6216\u5219\u591a\u6b21\uff0c\u8d2a\u5a6a\uff1a\u5339\u914d\u591a\u4e2a >>> pat.findall('cbadefab') ['cba'] >>> pat = re.compile(r'^[abc]+?') #\u5f00\u5934\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u7684\u4e00\u6b21\u6216\u5219\u591a\u6b21\uff0c\u975e\u8d2a\u5a6a\uff1a\u5339\u914d\u4e00\u4e2a >>> pat.findall('cbadefab') ['c']","title":"\u201c^\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u5f00\u5934\u6216\u884c\u5934"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_11","text":">>> pat = re.compile('[abc]$') >>> pat.match('adefAbc').group() #match\u5339\u914d\u7684\u662f\u5b57\u7b26\u4e32\u5f00\u5934\uff0c\u6240\u4ee5\u67e5\u627e$\u7684\u65f6\uff0c\u603b\u662f\u8fd4\u56deNone >>> pat.search('adefAbc').group() #\u7ed3\u5c3e\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a 'c' >>> pat.findall('adefAbc') ['c'] >>> pat = re.compile('[abc]+$') >>> pat.search('adefAbc').group() #\u7ed3\u5c3e\u662fa\u3001b\u3001c\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u7684\u4e00\u6b21\u6216\u5219\u591a\u6b21\uff0c\u8d2a\u5a6a\uff1a\u5339\u914d\u591a\u4e2a 'bc' >>> pat.findall('adefAbc') ['bc']","title":"\u201c$\u201d \uff1a\u5339\u914d\u5b57\u7b26\u4e32\u7ed3\u5c3e\u6216\u5219\u884c\u5c3e"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#a","text":">>> pat = re.compile('\\A[abc]+') >>> pat.findall('cbadefab') ['cba'] >>> pat.search('cbadefab').group() 'cba'","title":"\u201c\\A\u201d\uff1a\u5339\u914d\u5b57\u7b26\u4e32\u5f00\u5934"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#z","text":">>> pat = re.compile('[abc]+\\Z') >>> pat.search('cbadefab').group() 'ab' >>> pat.findall('cbadefab') ['ab']","title":"\u201c\\Z\u201d\uff1a\u5339\u914d\u5b57\u7b26\u4e32\u7ed3\u5c3e"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_12","text":"","title":"\u5206\u7ec4"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#1_2","text":">>> pat=re.compile(r'(a)\\w(c)') #\\w:\u5355\u4e2a\u7684\u6570\u5b57\u6216\u5b57\u6bcd [A-Za-z0-9] >>> pat.match('abcdef').group() 'abc' >>> pat=re.compile('(a)b(c)') #\u52062\u7ec4\uff0c\u533f\u540d\u5206\u7ec4 >>> pat.match('abcdef').group() #\u9ed8\u8ba4\u8fd4\u56de\u5339\u914d\u7684\u5b57\u7b26\u4e32 'abc' >>> pat.match('abcdef').group(1) #\u53d6\u5206\u7ec41\uff0c\u9002\u7528\u4e8esearch 'a' >>> pat.match('abcdef').group(2) #\u53d6\u5206\u7ec42\uff0c\u9002\u7528\u4e8esearch 'c' >>> pat.match('abcdef').groups() #\u53d6\u6240\u6709\u5206\u7ec4\uff0c\u5143\u7ec4\u5f62\u5f0f\u8fd4\u56de ('a', 'c')","title":"(\u2026)\uff1a\u5206\u7ec4\u5339\u914d,\u4ece\u5de6\u5230\u53f3,\u6bcf\u9047\u5230\u4e00\u4e2a ( \u7f16\u53f7+1\uff0c\u5206\u7ec4\u540e\u9762\u53ef\u52a0\u6570\u91cf\u8bcd"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_13","text":">>> pat=re.compile(r'www\\.(.*)\\..{3}') >>> pat.match('www.dxy.com').group(1) 'dxy'","title":"\uff1a\u5f15\u7528\u7f16\u53f7\u4e3a\u7684\u5206\u7ec4\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#p","text":">>> pat=re.compile(r'(?P<K>a)\\w(c)') #\u52062\u7ec4\uff1a\u547d\u540d\u5206\u7ec4+\u533f\u540d\u5206\u7ec4 >>> pat.search('abcdef').groups() #\u53d6\u6240\u6709\u5206\u7ec4\uff0c\u5143\u7ec4\u5f62\u5f0f\u8fd4\u56de ('a', 'c') >>> pat.search('abcdef').group(1) #\u53d6\u5206\u7ec41\uff0c\u9002\u7528\u4e8ematch 'a' >>> pat.search('abcdef').group(2) #\u53d6\u5206\u7ec42\uff0c\u9002\u7528\u4e8ematch 'c' >>> pat.search('abcdef').group() #\u9ed8\u8ba4\u8fd4\u56de\u5339\u914d\u7684\u5b57\u7b26\u4e32 'abc' >>> pat.search('abcdef').groupdict() #\u547d\u540d\u5206\u7ec4\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u5b57\u5178\u3010\u4e13\u6709\u3011\uff0c\u533f\u540d\u5206\u7ec4\u4e5f\u6ca1\u6709 {'K': 'a'}","title":"\u201c(?P\u2026)\u201d \uff1a\u5728\u6a21\u5f0f\u91cc\u9762\u7528()\u6765\u8868\u793a\u5206\u7ec4\uff08\u547d\u540d\u5206\u7ec4\uff09,\u9002\u7528\u4e8e\u63d0\u53d6\u76ee\u6807\u5b57\u7b26\u4e32\u4e2d\u7684\u67d0\u4e00\u4e9b\u90e8\u4f4d\u3002"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#pname","text":">>> pat=re.compile(r'(?P<K>a)\\w(c)(?P=K)') #(?P=K)\u5f15\u7528\u5206\u7ec41\u7684\u503c\uff0c\u5c31\u662fa >>> pat.search('abcdef').group() #\u5339\u914d\u4e0d\u5230\uff0c\u56e0\u4e3a\u5b8c\u6574'a\\wca',\u6a21\u5f0f\u7684\u7b2c4\u4f4d\u662fa Traceback (most recent call last): File \"<stdin>\", line 1, in <module> AttributeError: 'NoneType' object has no attribute 'group' >>> pat.search('abcadef').group() #\u5339\u914d\u5230\uff0c\u6a21\u5f0f\u7684\u7b2c4\u4f4d\u548c\u7ec41\u4e00\u6837,\u503c\u662fc 'abca' >>> pat.search('abcadef').groups() ('a', 'c') >>> pat.search('abcadef').group(1) 'a' >>> pat.search('abcadef').group(2) 'c","title":"\u201c(?P=name)\u201d\uff1a\u5f15\u7528\u522b\u540d\u4e3a\u7684\u5206\u7ec4\u5339\u914d\u5230\u7684\u4e32"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_14","text":">>> pat=re.compile(r'(?P<K>a)\\w(c)(?P=K)\\2') #\\2\u5f15\u7528\u5206\u7ec42\u7684\u503c\uff0c\u5c31\u662fc >>> pat.findall('Aabcadef') #\u5339\u914d\u4e0d\u5230\uff0c\u56e0\u4e3a\u5b8c\u6574'a\\wcac',\u6a21\u5f0f\u7684\u7b2c5\u4f4d\u662fc [] >>> pat.findall('Aabcacdef') #\u5339\u914d\u5230\uff0c\u6a21\u5f0f\u7684\u7b2c5\u4f4d\u548c\u7ec42\u4e00\u6837,\u503c\u662fc [('a', 'c')] >>> pat.search('Aabcacdef').groups() ('a', 'c') >>> pat.search('Aabcacdef').group() 'abcac' >>> pat.search('Aabcacdef').group(1) 'a' >>> pat.search('Aabcacdef').group(2) 'c'","title":"\u201c\u201d \uff1a\u5f15\u7528\u5206\u7ec4\u7f16\u53f7\u5339\u914d\uff1a"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_15","text":"(?:\u2026) (\u2026) \u4e0d\u5206\u7ec4\u7248\u672c,\u7528\u4e8e\u4f7f\u7528 | \u6216\u8005\u540e\u63a5\u6570\u91cf\u8bcd (?iLmsux) iLmsux\u7684\u6bcf\u4e2a\u5b57\u7b26\u4ee3\u8868\u4e00\u4e2a\u5339\u914d\u6a21\u5f0f,\u53ea\u80fd\u7528\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5f00\u5934,\u53ef\u9009\u591a\u4e2a (?#\u2026) #\u53f7\u540e\u7684\u5185\u5bb9\u5c06\u4f5c\u4e3a\u6ce8\u91ca (?=\u2026) \u4e4b\u540e\u7684\u5b57\u7b26\u4e32\u5185\u5bb9\u9700\u8981\u5339\u914d\u8868\u8fbe\u5f0f\u624d\u80fd\u6210\u529f\u5339\u914d (?!\u2026) \u4e4b\u540e\u7684\u5b57\u7b26\u4e32\u4e0d\u5339\u914d\u8868\u8fbe\u5f0f\u624d\u80fd\u6210\u529f (?(?(?(id/name) yes |no) \u5982\u679c\u7f16\u53f7\u4e3aid/\u540d\u5b57\u4e3aname\u7684\u7ec4\u5339\u914d\u5230\u5b57\u7b26\u4e32,\u5219\u9700\u8981\u5339\u914dyes,\u5426\u5219\u5339\u914dno,no\u53ef\u4ee5\u7701\u7565","title":"\u7279\u6b8a\u6784\u9020"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_16","text":">>> pat=re.compile(r'a(?:bc)') >>> pat.findall('abc') ['abc'] >>> pat.match('abc').groups() #\u663e\u793a\u4e0d\u51fa\u5206\u7ec4","title":"\u201c(?:\u2026)\u201d \uff1a()\u91cc\u9762\u6709?:\u8868\u793a\u8be5()\u4e0d\u662f\u5206\u7ec4"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_17","text":">>> pat=re.compile(r'\\w(?=\\d)') #\u5339\u914d\u8868\u8fbe\u5f0f\\d\uff0c\u8fd4\u56de\u6570\u5b57\u7684\u524d\u4e00\u4f4d\uff0c\\w\uff1a\u5355\u8bcd\u5b57\u7b26[A-Za-z0-9] >>> pat.findall('abc1 def1 xyz1') ['c', 'f', 'z'] >>> pat.findall('zhoujy20130628hangzhou') #\u5339\u914d\u6570\u5b57\u7684\u524d\u4e00\u4f4d\uff0c\u5217\u8868\u8fd4\u56de ['y', '2', '0', '1', '3', '0', '6', '2'] >>> pat=re.compile(r'\\w+(?=\\d)') >>> pat.findall('abc1,def1,xyz1') #\u5339\u914d\u6700\u672b\u6570\u5b57\u7684\u524d\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u8fd4\u56de ['abc', 'def', 'xyz'] >>> pat.findall('abc21,def31,xyz41') ['abc2', 'def3', 'xyz4'] >>> pat.findall('zhoujy20130628hangzhou') ['zhoujy2013062'] >>> pat=re.compile(r'[A-Za-z]+(?=\\d)') #[A-Za-z],\u5339\u914d\u5b57\u6bcd,\u53ef\u4ee5\u7528\u5176\u4ed6\u7684\u6b63\u5219\u65b9\u6cd5 >>> pat.findall('zhoujy20130628hangzhou123') #\u5339\u914d\u540e\u9762\u5e26\u6709\u6570\u5b57\u7684\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u8fd4\u56de ['zhoujy', 'hangzhou'] >>> pat.findall('abc21,def31,xyz41') ['abc', 'def', 'xyz']","title":"\u201c(?=\u2026)\u201d\uff1a\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u540e\u8fdb\u884c\u5339\u914d\uff0c\u603b\u662f\u5bf9\u540e\u9762\u8fdb\u884c\u5339\u914d"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_18","text":">>> pat=re.compile(r'[A-Za-z]+(?!\\d)') #[A-Za-z],\u5339\u914d\u5b57\u6bcd,\u53ef\u4ee5\u7528\u5176\u4ed6\u7684\u6b63\u5219\u65b9\u6cd5 >>> pat.findall('zhoujy20130628hangzhou123,12,binjiang310') #\u5339\u914d\u540e\u9762\u4e0d\u662f\u6570\u5b57\u7684\u5b57\u7b26\u4e32\uff0c\u5217\u8868\u8fd4\u56de ['zhouj', 'hangzho', 'binjian'] >>> pat.findall('abc21,def31,xyz41') ['ab', 'de', 'xy']","title":"\u201c(?!\u2026)\u201d \u4e0d\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u540e\u8fdb\u884c\u5339\u914d"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_19","text":">>> pat=re.compile(r'(?<=\\d)[A-Za-z]+') #\u5339\u914d\u524d\u9762\u662f\u6570\u5b57\u7684\u5b57\u6bcd >>> pat.findall('abc21,def31,xyz41') [] >>> pat.findall('1abc21,2def31,3xyz41') ['abc', 'def', 'xyz'] >>> pat.findall('zhoujy20130628hangzhou123,12,binjiang310') ['hangzhou']","title":"\u201c(?&lt;=\u2026)\u201d\uff1a\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u524d\u8fdb\u884c\u5339\u914d,\u603b\u662f\u5bf9\u524d\u9762\u8fdb\u884c\u5339\u914d"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#_20","text":">>> pat=re.compile(r'(?<!\\d)[A-Za-z]+') #\u5339\u914d\u524d\u9762\u4e0d\u662f\u6570\u5b57\u7684\u5b57\u6bcd >>> pat.findall('abc21,def31,xyz41') ['abc', 'def', 'xyz'] >>> pat.findall('zhoujy20130628hangzhou123,12,binjiang310') ['zhoujy', 'angzhou', 'binjiang']","title":"\u201c(?&lt;!\u2026)\u201d\uff1a\u4e0d\u5339\u914d\u2026\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u3002\u5bf9\u524d\u8fdb\u884c\u5339\u914d,\u603b\u662f\u5bf9\u524d\u9762\u8fdb\u884c\u5339\u914d"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#idname-yes-no","text":">>> pat=re.compile(r'a(\\d)?bc(?(1)\\d)') #no\u7701\u7565\u4e86\uff0c\u5b8c\u6574\u7684\u662fa\\dbc\\d ==> a2bc3,\u603b\u51715\u4f4d\uff0c\u7b2c2\u4f4d\u662f\u53ef\u6709\u53ef\u65e0\u7684\u6570\u5b57\uff0c\u7b2c5\u4e3a\u662f\u6570\u5b57 >>> pat.findall('abc9') #\u8fd4\u56de\u7ec41\uff0c\u4f46\u7b2c2\u4f4d\uff08\u7ec41\uff09\u6ca1\u6709\uff0c\u5373\u8fd4\u56de\u4e86'' [''] >>> pat.findall('a8bc9') #\u5b8c\u6574\u7684\u6a21\u5f0f\uff0c\u8fd4\u56de\u7ec41 ['8'] >>> pat.match('a8bc9').group() 'a8bc9' >>> pat.match('a8bc9').group(1) '8' >>> pat.findall('a8bc') #\u7b2c5\u4f4d\u4e0d\u5b58\u5728\uff0c\u5219\u6ca1\u6709\u5339\u914d\u5230 []","title":"\u201c(?(id/name) yes |no)\u201d: \u7ec4\u662f\u5426\u5339\u914d\uff0c\u5339\u914d\u8fd4\u56de"},{"location":"Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/#ilmsuxi","text":">>> pat=re.compile(r'abc') >>> pat.findall('abc') ['abc'] >>> pat.findall('ABC') [] >>> pat=re.compile(r'(?i)abc') #(?i) \u4e0d\u533a\u5206\u5927\u5c0f\u5199 >>> pat.findall('ABC') ['ABC'] >>> pat.findall('abc') ['abc'] >>> pat.findall('aBc') ['aBc'] >>> pat.findall('aBC') ['aBC'] >>> pat=re.compile(r'abc',re.I) #re.I \u4f5c\u4e3a\u53c2\u6570\u4f7f\u7528\uff0c\u63a8\u8350 >>> pat.findall('aBC') ['aBC'] >>> pat.findall('abc') ['abc'] >>> pat.findall('ABC') ['ABC']","title":"\u201c(?iLmsux)\u201d:\u8fd9\u91cc\u5c31\u4ecb\u7ecd\u4e0bi\u53c2\u6570\uff1a\u5927\u5c0f\u5199\u533a\u5206\u5339\u914d"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/","text":"\u539f\u6587 \u65b9\u6cd51\uff1a\u52a0\u53f7\u8fde\u63a5 \u00b6 \u5f88\u591a\u8bed\u8a00\u90fd\u652f\u6301\u4f7f\u7528\u52a0\u53f7\u8fde\u63a5\u5b57\u7b26\u4e32\uff0cPython\u4e5f\u4e0d\u4f8b\u5916\uff0c\u53ea\u9700\u8981\u7b80\u5355\u7684\u5c062\u4e2a\u6216\u591a\u4e2a\u5b57\u7b26\u4e32\u76f8\u52a0\u5c31\u53ef\u4ee5\u5b8c\u6210\u62fc\u63a5\u3002 a = 'Python' b = '\u79c1\u623f\u83dc' r = a + b # \u8f93\u51fa'Python\u79c1\u623f\u83dc' \u65b9\u6cd52\uff1a\u4f7f\u7528 % \u64cd\u4f5c\u7b26 \u00b6 \u5728Python 2.6\u4ee5\u524d\uff0c % \u64cd\u4f5c\u7b26\u662f\u552f\u4e00\u4e00\u79cd\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5\uff0c\u5b83\u4e5f\u53ef\u4ee5\u7528\u4e8e\u8fde\u63a5\u5b57\u7b26\u4e32\u3002 a = 'Python' b = '\u79c1\u623f\u83dc' r = '%s%s' % (a, b) # \u8f93\u51fa'Python\u79c1\u623f\u83dc' \u65b9\u6cd53\uff1a\u4f7f\u7528 format \u65b9\u6cd5 \u00b6 format\u65b9\u6cd5\u662fPython 2.6\u4e2d\u51fa\u73b0\u7684\u4e00\u79cd\u4ee3\u66ff % \u64cd\u4f5c\u7b26\u7684\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u65b9\u6cd5\uff0c\u540c\u6837\u53ef\u4ee5\u7528\u6765\u8fde\u63a5\u5b57\u7b26\u4e32\u3002 a = 'Python' b = '\u79c1\u623f\u83dc' r = '{}{}'.format(a, b) \u65b9\u6cd54\uff1a\u4f7f\u7528 f-string \u00b6 Python 3.6\u4e2d\u5f15\u5165\u4e86Formatted String Literals\uff08\u5b57\u9762\u91cf\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff09\uff0c\u7b80\u79f0f-string\uff0c f-string \u662f % \u64cd\u4f5c\u7b26\u548c format \u65b9\u6cd5\u7684\u8fdb\u5316\u7248\uff0c\u4f7f\u7528 f-string \u8fde\u63a5\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5\u548c\u4f7f\u7528 % \u64cd\u4f5c\u7b26\u3001 format \u65b9\u6cd5\u7c7b\u4f3c\u3002 a = 'Python' b = '\u79c1\u623f\u83dc' r = f'{a}{b}' \u65b9\u6cd55\uff1a\u4f7f\u7528 str.join() \u65b9\u6cd5 \u00b6 \u5b57\u7b26\u4e32\u6709\u4e00\u4e2a\u5185\u7f6e\u65b9\u6cd5 join \uff0c\u5176\u53c2\u6570\u662f\u4e00\u4e2a\u5e8f\u5217\u7c7b\u578b\uff0c\u4f8b\u5982\u6570\u7ec4\u6216\u8005\u5143\u7ec4\u7b49\u3002 a = 'Python' b = '\u79c1\u623f\u83dc' r = ''.join([a, b]) \u603b\u7ed3 \u00b6 \u8fde\u63a5\u5c11\u91cf\u5b57\u7b26\u4e32\u65f6 \u4f7f\u7528\u52a0\u53f7\u8fde\u63a5\u7b26\u5728\u6027\u80fd\u548c\u53ef\u8bfb\u6027\u4e0a\u90fd\u662f\u660e\u667a\u7684\uff0c\u5982\u679c\u5bf9\u53ef\u8bfb\u6027\u6709\u66f4\u9ad8\u7684\u8981\u6c42\uff0c\u5e76\u4e14\u4f7f\u7528\u7684Python 3.6\u4ee5\u4e0a\u7248\u672c\uff0c f-string \u4e5f\u662f\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u9009\u62e9\uff0c\u4f8b\u5982\u4e0b\u9762\u8fd9\u79cd\u60c5\u51b5\uff0c f-string \u7684\u53ef\u8bfb\u6027\u663e\u7136\u6bd4\u52a0\u53f7\u8fde\u63a5\u597d\u5f97\u591a\u3002 a = f'\u59d3\u540d\uff1a{name} \u5e74\u9f84\uff1a{age} \u6027\u522b\uff1a{gender}' b = '\u59d3\u540d\uff1a' + name + '\u5e74\u9f84\uff1a' + age + '\u6027\u522b\uff1a' + gender \u8fde\u63a5\u5927\u91cf\u5b57\u7b26\u4e32\u65f6 join \u548c f-string \u90fd\u662f\u6027\u80fd\u6700\u597d\u7684\u9009\u62e9\uff0c\u9009\u62e9\u65f6\u4f9d\u7136\u53d6\u51b3\u4e8e\u4f60\u4f7f\u7528\u7684Python\u7248\u672c\u4ee5\u53ca\u5bf9\u53ef\u8bfb\u6027\u7684\u8981\u6c42\uff0c f-string \u5728\u8fde\u63a5\u5927\u91cf\u5b57\u7b26\u4e32\u65f6\u53ef\u8bfb\u6027\u5e76\u4e0d\u4e00\u5b9a\u597d\u3002 \u5207\u8bb0\u4e0d\u8981\u4f7f\u7528\u52a0\u53f7\u8fde\u63a5\uff0c\u5c24\u5176\u662f\u5728for\u5faa\u73af\u4e2d\u3002","title":"\u5b57\u7b26\u4e32\u62fc\u63a5\u603b\u7ed3"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#1","text":"\u5f88\u591a\u8bed\u8a00\u90fd\u652f\u6301\u4f7f\u7528\u52a0\u53f7\u8fde\u63a5\u5b57\u7b26\u4e32\uff0cPython\u4e5f\u4e0d\u4f8b\u5916\uff0c\u53ea\u9700\u8981\u7b80\u5355\u7684\u5c062\u4e2a\u6216\u591a\u4e2a\u5b57\u7b26\u4e32\u76f8\u52a0\u5c31\u53ef\u4ee5\u5b8c\u6210\u62fc\u63a5\u3002 a = 'Python' b = '\u79c1\u623f\u83dc' r = a + b # \u8f93\u51fa'Python\u79c1\u623f\u83dc'","title":"\u65b9\u6cd51\uff1a\u52a0\u53f7\u8fde\u63a5"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#2","text":"\u5728Python 2.6\u4ee5\u524d\uff0c % \u64cd\u4f5c\u7b26\u662f\u552f\u4e00\u4e00\u79cd\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5\uff0c\u5b83\u4e5f\u53ef\u4ee5\u7528\u4e8e\u8fde\u63a5\u5b57\u7b26\u4e32\u3002 a = 'Python' b = '\u79c1\u623f\u83dc' r = '%s%s' % (a, b) # \u8f93\u51fa'Python\u79c1\u623f\u83dc'","title":"\u65b9\u6cd52\uff1a\u4f7f\u7528%\u64cd\u4f5c\u7b26"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#3format","text":"format\u65b9\u6cd5\u662fPython 2.6\u4e2d\u51fa\u73b0\u7684\u4e00\u79cd\u4ee3\u66ff % \u64cd\u4f5c\u7b26\u7684\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u65b9\u6cd5\uff0c\u540c\u6837\u53ef\u4ee5\u7528\u6765\u8fde\u63a5\u5b57\u7b26\u4e32\u3002 a = 'Python' b = '\u79c1\u623f\u83dc' r = '{}{}'.format(a, b)","title":"\u65b9\u6cd53\uff1a\u4f7f\u7528format\u65b9\u6cd5"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#4f-string","text":"Python 3.6\u4e2d\u5f15\u5165\u4e86Formatted String Literals\uff08\u5b57\u9762\u91cf\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff09\uff0c\u7b80\u79f0f-string\uff0c f-string \u662f % \u64cd\u4f5c\u7b26\u548c format \u65b9\u6cd5\u7684\u8fdb\u5316\u7248\uff0c\u4f7f\u7528 f-string \u8fde\u63a5\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5\u548c\u4f7f\u7528 % \u64cd\u4f5c\u7b26\u3001 format \u65b9\u6cd5\u7c7b\u4f3c\u3002 a = 'Python' b = '\u79c1\u623f\u83dc' r = f'{a}{b}'","title":"\u65b9\u6cd54\uff1a\u4f7f\u7528f-string"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#5strjoin","text":"\u5b57\u7b26\u4e32\u6709\u4e00\u4e2a\u5185\u7f6e\u65b9\u6cd5 join \uff0c\u5176\u53c2\u6570\u662f\u4e00\u4e2a\u5e8f\u5217\u7c7b\u578b\uff0c\u4f8b\u5982\u6570\u7ec4\u6216\u8005\u5143\u7ec4\u7b49\u3002 a = 'Python' b = '\u79c1\u623f\u83dc' r = ''.join([a, b])","title":"\u65b9\u6cd55\uff1a\u4f7f\u7528str.join()\u65b9\u6cd5"},{"location":"Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/#_1","text":"\u8fde\u63a5\u5c11\u91cf\u5b57\u7b26\u4e32\u65f6 \u4f7f\u7528\u52a0\u53f7\u8fde\u63a5\u7b26\u5728\u6027\u80fd\u548c\u53ef\u8bfb\u6027\u4e0a\u90fd\u662f\u660e\u667a\u7684\uff0c\u5982\u679c\u5bf9\u53ef\u8bfb\u6027\u6709\u66f4\u9ad8\u7684\u8981\u6c42\uff0c\u5e76\u4e14\u4f7f\u7528\u7684Python 3.6\u4ee5\u4e0a\u7248\u672c\uff0c f-string \u4e5f\u662f\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u9009\u62e9\uff0c\u4f8b\u5982\u4e0b\u9762\u8fd9\u79cd\u60c5\u51b5\uff0c f-string \u7684\u53ef\u8bfb\u6027\u663e\u7136\u6bd4\u52a0\u53f7\u8fde\u63a5\u597d\u5f97\u591a\u3002 a = f'\u59d3\u540d\uff1a{name} \u5e74\u9f84\uff1a{age} \u6027\u522b\uff1a{gender}' b = '\u59d3\u540d\uff1a' + name + '\u5e74\u9f84\uff1a' + age + '\u6027\u522b\uff1a' + gender \u8fde\u63a5\u5927\u91cf\u5b57\u7b26\u4e32\u65f6 join \u548c f-string \u90fd\u662f\u6027\u80fd\u6700\u597d\u7684\u9009\u62e9\uff0c\u9009\u62e9\u65f6\u4f9d\u7136\u53d6\u51b3\u4e8e\u4f60\u4f7f\u7528\u7684Python\u7248\u672c\u4ee5\u53ca\u5bf9\u53ef\u8bfb\u6027\u7684\u8981\u6c42\uff0c f-string \u5728\u8fde\u63a5\u5927\u91cf\u5b57\u7b26\u4e32\u65f6\u53ef\u8bfb\u6027\u5e76\u4e0d\u4e00\u5b9a\u597d\u3002 \u5207\u8bb0\u4e0d\u8981\u4f7f\u7528\u52a0\u53f7\u8fde\u63a5\uff0c\u5c24\u5176\u662f\u5728for\u5faa\u73af\u4e2d\u3002","title":"\u603b\u7ed3"},{"location":"Regular-Expression/","text":"\u5143URL \u6b63\u898f\u8868\u73fe\uff08Regular Expression\uff09\u3068\u306f\uff1f \u00b6 \u6587\u5b57\u5217\u3092\u30d1\u30bf\u30fc\u30f3\u5316\u3057\u3001\u7279\u6b8a\u306a\u6587\u5b57\uff08\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u3001\u30e1\u30bf\u6587\u5b57\uff09\u3067\u8868\u73fe\u3057\u305f\u3082\u306e \u4f8b\u3048\u3070\u3001\u90f5\u4fbf\u756a\u53f7\u3092\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u3063\u3066\u8868\u3059\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u73fe\u3067\u304d\u308b\u3002 \u90f5\u4fbf\u756a\u53f7\u306e\u6b63\u898f\u8868\u73fe \\d{3}-?\\d{4} # 3\u6841\u306e\u6570\u5b57 + \u30cf\u30a4\u30d5\u30f3\u6709\u308aor\u7121\u3057 + 4\u6841\u306e\u6570\u5b57 \u3053\u306e \u300c\\d\u300d\u300c{}\u300d\u300c?\u300d \u306e\u3088\u3046\u306a\u6587\u5b57\u306e\u3053\u3068\u3092 \u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff08\u30e1\u30bf\u6587\u5b57\uff09 \u3068\u3044\u3046\u3002 \u6b63\u898f\u8868\u73fe\u306e\u7531\u6765 \u00b6 1940\u5e74\u4ee3\u306b\u3055\u307e\u3056\u307e\u306a\u795e\u7d4c\u751f\u7406\u5b66\u8005\u305f\u3061\u304c\u3001\u795e\u7d4c\u56de\u8def\u3092\u6570\u5b66\u7684\u306b\u8aac\u660e\u3059\u308b\u305f\u3081\u306b\u958b\u767a\u3057\u305f\u3002 1956\u5e74\u3001\u6570\u5b66\u8005 Stephen Kleene\uff08\u30b9\u30c6\u30a3\u30fc\u30d6\u30f3\u30fb\u30af\u30ea\u30fc\u30cd\uff09 \u304c\u3001\u305d\u306e\u8003\u3048\u65b9\u306b\u57fa\u3065\u304d\u8ad6\u6587\u3092\u8457\u8ff0\u3057\u3001\u521d\u3081\u3066\u6b63\u898f\u8868\u73fe\u306e\u6982\u5ff5\u304c\u7d39\u4ecb\u3055\u308c\u305f\u3002 \u3053\u3053\u3067\u300c\u6b63\u5247\u96c6\u5408\u306e\u4ee3\u6570\u300d\u3092\u8aac\u660e\u3059\u308b\u305f\u3081\u306b\u300c\u6b63\u5247\u8868\u73fe\u30fb\u6b63\u898f\u8868\u73fe(regular expression)\u300d\u304c\u4f7f\u7528\u3055\u308c\u305f\u3002 \u4f55\u304c\u8a00\u3044\u305f\u304b\u3063\u305f\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u5143\u3005\u306f\u795e\u7d4c\u56de\u8def\u306e\u7814\u7a76\u3067\u958b\u767a\u3055\u308c\u305f\u6570\u5b66\u7684\u306a\u6982\u5ff5\u3060\u3063\u305f\u3068\u3044\u3046\u3053\u3068\u3002 \u6b63\u898f\u8868\u73fe\u3068\u3044\u3046\u82e5\u5e72\u5206\u304b\u308a\u306b\u304f\u3044\u30cd\u30fc\u30df\u30f3\u30b0\u306f\u3053\u306e\u305b\u3044 \u53c2\u8003\uff1a \u6b63\u898f\u8868\u73fe\u306e\u7531\u6765 \u4f55\u306e\u5f79\u306b\u7acb\u3064\uff1f \u00b6 \u6587\u5b57\u5217\u691c\u7d22\u306b\u5f79\u7acb\u3064 grep\u691c\u7d22\u3001\u30a8\u30c7\u30a3\u30bf\u3084Excel\u306e\u691c\u7d22\u6a5f\u80fd \u2192 \u8abf\u67fb\u3001\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u304c\u6357\u308b \u6587\u5b57\u5217\u7f6e\u63db\u306b\u5f79\u7acb\u3064 sed\u3001\u30a8\u30c7\u30a3\u30bf\u3084Excel\u306e\u7f6e\u63db\u6a5f\u80fd \u2192 \u6587\u5b57\u5217\u306e\u4e00\u62ec\u4fee\u6b63\u3001\u4e00\u62ec\u633f\u5165\u3001\u4e00\u62ec\u524a\u9664\u304c\u697d\u306b\u306a\u308b \u5165\u529b\u3055\u308c\u305f\u6587\u5b57\u5217\u304c\u3001\u898f\u5b9a\u3055\u308c\u305f\u30d1\u30bf\u30fc\u30f3\u901a\u308a\u306b\u5165\u529b\u3055\u308c\u3066\u3044\u308b\u304b\u306e\u78ba\u8a8d\uff08\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\uff09\u306b\u5f79\u7acb\u3064 \u90f5\u4fbf\u756a\u53f7\u3001\u96fb\u8a71\u756a\u53f7\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306a\u3069\u306e\u5165\u529b\u5f62\u5f0f\u306e\u30c1\u30a7\u30c3\u30af\u306a\u3069 \u6b63\u898f\u8868\u73fe\u3068\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306e\u9055\u3044 \u00b6 \u6700\u521d\u306e\u9803\u306b\u6b63\u898f\u8868\u73fe\u3068\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u52d8\u9055\u3044\u3057\u3066\u3044\u305f\u306e\u3067\u78ba\u8a8d\u3002 \u305d\u3082\u305d\u3082\u3001\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08Wild Card\uff09\u3068\u306f\u4f55\u304b\uff1f \u30c8\u30e9\u30f3\u30d7\u7528\u8a9e\u3067\uff0c\u3069\u306e\u30ab\u30fc\u30c9\u306e\u4ee3\u7528\u306b\u3082\u3067\u304d\u308b\u30ab\u30fc\u30c9\u306e\u3053\u3068\uff08\u30dd\u30fc\u30ab\u30fc\u306b\u304a\u3051\u308b\u30b8\u30e7\u30fc\u30ab\u30fc\u306a\u3069\uff09 \u8ee2\u3058\u3066IT\u306b\u304a\u3051\u308b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3068\u306f\u3001 \u4efb\u610f\u306e\u6587\u5b57\u5217 \u306b\u30de\u30c3\u30c1\u3059\u308b\u7279\u6b8a\u6587\u5b57 OS\u3084\u8a00\u8a9e\u306b\u3088\u3063\u3066\u89e3\u91c8\u304c\u7570\u306a\u308b \u30d5\u30a1\u30a4\u30eb\u691c\u7d22\u306b\u304a\u3051\u308b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 \u00b6 windows\u3084Unix/Linux\u306e\u30b7\u30a7\u30eb\u3067\u306e\u30d5\u30a1\u30a4\u30eb\u691c\u7d22\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u304c\u4f7f\u3048\u308b \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 \u5185\u5bb9 ? \u4efb\u610f\u306e1\u6587\u5b57\u306b\u30de\u30c3\u30c1 * 0\u6587\u5b57\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1 music.mp? \u2192 \u300cmusic.mp3\u300d\u300cmusic.mp4\u300d\u306a\u3069\u306b\u30de\u30c3\u30c1 *.txt \u2192 \u62e1\u5f35\u5b50\u304c.txt\u3067\u3042\u308b\u3082\u306e\u5168\u3066\u306b\u30de\u30c3\u30c1 SQL\u306b\u304a\u3051\u308b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 \u00b6 SQL\u306eWHERE\u53e5\u306b\u304a\u3051\u308bLIKE\u6f14\u7b97\u5b50\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u304c\u4f7f\u3048\u308b \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 \u5185\u5bb9 % 0\u6587\u5b57\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1 _ \u4efb\u610f\u306e\uff11\u6587\u5b57\u306b\u30de\u30c3\u30c1 \u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u3068\u306f\uff1f \u00b6 \u305d\u306e\u6587\u5b57\u81ea\u8eab\u3068\u306f\u7570\u306a\u308b\u3001\u7279\u5225\u306a\u610f\u5473\u3084\u5f79\u5272\u3092\u6301\u3064\u6587\u5b57\u306e\u3053\u3068 \u3056\u3063\u304f\u308a\u5206\u985e\u3059\u308b\u3068\u3001 \u6587\u5b57\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a .\uff08\u30c9\u30c3\u30c8\uff09, \\w, \\W, \\s, \\S, \\d, \\D \u306a\u3069 \u7e70\u308a\u8fd4\u3057\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a +, *, ?, {n}, {n,m}, {n,} \u4f4d\u7f6e\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a ^, $, \\b, \\B \u6587\u5b57\u96c6\u5408\u3084\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a [], [^], |, (), (?:) \u305d\u306e\u4ed6\uff08\u5f8c\u65b9\u53c2\u7167\u306a\u3069\uff09\uff1a \\1, \\2, \\3, ... \u203b\u6b63\u898f\u8868\u73fe\u306e\u5b9f\u88c5\u306b\u3088\u3063\u3066\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u304c\u7570\u306a\u308b\u306e\u3067\u6ce8\u610f \u6587\u5b57\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u00b6 \u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 \u5099\u8003 .\uff08\u30c9\u30c3\u30c8\uff09 \u4efb\u610f\u306e\uff11\u6587\u5b57\u306b\u30de\u30c3\u30c1 \u6539\u884c\u306b\u306f\u30de\u30c3\u30c1\u3057\u306a\u3044 \\w \u5358\u8a9e\u3092\u69cb\u6210\u3059\u308b\u6587\u5b57\u306b\u30de\u30c3\u30c1 w\u306fword\u306e\u982d\u6587\u5b57 \\W \u5358\u8a9e\u3092\u69cb\u6210\u3059\u308b\u6587\u5b57 \u4ee5\u5916\u306e\u6587\u5b57 \u306b\u30de\u30c3\u30c1 \\d \u6570\u5b57\uff080~9\uff09\u306b\u30de\u30c3\u30c1 d\u306fdigit\u306e\u982d\u6587\u5b57 \\D \u6570\u5b57 \u4ee5\u5916\u306e\u6587\u5b57 \u306b\u30de\u30c3\u30c1 \\s \u7a7a\u767d\u6587\u5b57\uff08\u534a\u89d2\u30b9\u30da\u30fc\u30b9\u3001\u30bf\u30d6\u6587\u5b57\u4ed6\uff09\u306b\u30de\u30c3\u30c1 s\u306fspace\u306e\u982d\u6587\u5b57 \\S \u7a7a\u767d\u6587\u5b57 \u4ee5\u5916\u306e\u6587\u5b57 \u306b\u30de\u30c3\u30c1 \u5236\u5fa1\u6587\u5b57\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u00b6 \u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 \\t \u30bf\u30d6\u6587\u5b57 \\v \u5782\u76f4\u30bf\u30d6 \\n \u6539\u884c\u6587\u5b57 \\r \u6539\u884c\u6587\u5b57\uff08\u30ad\u30e3\u30ec\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\uff09 \\f \u7528\u7d19\u9001\u308a\u6587\u5b57 \\a \u8b66\u544a\u6587\u5b57 \\e \u30a8\u30b9\u30b1\u30fc\u30d7\u6587\u5b57 \u7e70\u308a\u8fd4\u3057\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff08\u91cf\u6307\u5b9a\u5b50\uff09 \u00b6 \u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 \u5099\u8003 {n} n\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {n,m} n\u56de\u4ee5\u4e0am\u56de\u4ee5\u4e0b\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {n,} n\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 * 0\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {0,}\u3068\u540c\u7fa9 + 1\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {1,}\u3068\u540c\u7fa9 ? 0\u56de\u307e\u305f\u306f1\u56de\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {0,1}\u3068\u540c\u7fa9 \u4f4d\u7f6e\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff08\u30a2\u30f3\u30ab\u30fc\uff09 \u00b6 \u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 $ \u884c\u672b ^ \u884c\u982d \\b \u5358\u8a9e\u5883\u754c \\B \u5358\u8a9e\u5883\u754c\u4ee5\u5916 \u6587\u5b57\u96c6\u5408\u3084\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u00b6 \u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 [abc] a\u304bb\u304bc\u306e\u3069\u308c\u304b1\u6587\u5b57\u306b\u30de\u30c3\u30c1 [a-z] a\u304b\u3089z\u306e\u3069\u308c\u304b1\u6587\u5b57\u306b\u30de\u30c3\u30c1 [^abc] abc\u4ee5\u5916\u306e\u3069\u308c\u304b1\u6587\u5b57\u306b\u30de\u30c3\u30c1 abc|def abc\u307e\u305f\u306fdef\u306e\u30d1\u30bf\u30fc\u30f3\u306b\u30de\u30c3\u30c1 (abc) \u30b0\u30eb\u30fc\u30d7\u5316\u3068\u30ad\u30e3\u30d7\u30c1\u30e3\u3092\u884c\u3046 (?:abc) \u30b0\u30eb\u30fc\u30d7\u5316\u3092\u884c\u3046 [a-z]\u306b\u3064\u3044\u3066 \u00b6 [a-z]\u306ea-z\u306e\u7bc4\u56f2\u306f\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u7bc4\u56f2 Unicode\u306e\u6587\u5b57\u30b3\u30fc\u30c9\u756a\u53f7\u3092\u4f7f\u7528\u3057\u3066[\\u0061-\\u007A]\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u3082\u3067\u304d\u308b \u305d\u306e\u4ed6\u306e\u6b63\u898f\u8868\u73fe\u306e\u6a5f\u80fd \u00b6 \u4ee5\u4e0b\u306e\u6a5f\u80fd\u306f\u3001\u51e6\u7406\u7cfb\u306b\u3088\u3063\u3066\u306f\u4f7f\u7528\u3067\u304d\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f\u3059\u308b\u3053\u3068\u3002 \u30b0\u30eb\u30fc\u30d7\u5316 \u00b6 (abc)\u306e\u3088\u3046\u306b\u62ec\u5f27\u5185\u306e\u6587\u5b57\u5217\u3092\u3072\u3068\u307e\u3068\u3081\u306b\u6271\u3046\u3053\u3068 \u4f8b1) hogehoge....\u3068\u300choge\u300d\u3092\u7e70\u308a\u8fd4\u3059\u6587\u5b57\u5217\u3092\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044\u5834\u5408\u3001\u4ee5\u4e0b\u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b\u3002 \u30b0\u30eb\u30fc\u30d7\u5316\u306e\u4f8b1 (hoge)+ \u4f8b2) https://www.yahoo.co.jp/ \u3068 https://www.google.co.jp/ \u306e\u4e21\u65b9\u306b\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044\u5834\u5408\u3001\u4ee5\u4e0b\u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b \u30b0\u30eb\u30fc\u30d7\u5316\u306e\u4f8b2 https://www\\.(google|yahoo)\\.co\\.jp/ \u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b\u3002 \u30ad\u30e3\u30d7\u30c1\u30e3 \u00b6 (abc)\u62ec\u5f27\u5185\u306e\u6587\u5b57\u5217\u3092\u8a18\u61b6\u3057\u3001\u53c2\u7167\u51fa\u6765\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068 \\1 ,\\2 ,\\3...\u3067\u524d\u65b9\u3067\u8a18\u61b6\u3057\u305f\u6587\u5b57\u5217\u3092\u30de\u30c3\u30c1\u3055\u305b\u308b\u3053\u3068\u304c\u51fa\u6765\u308b $1 ,$2 ,$3...\u3067\u8a18\u61b6\u3057\u305f\u6587\u5b57\u5217\u3092\u5909\u6570\u3068\u3057\u3066\u53c2\u7167\u3067\u304d\u308b\uff08\u7f6e\u63db\u306b\u3082\u4f7f\u3048\u308b\uff09 \u203b\u4f7f\u7528\u51fa\u6765\u308b\u304b\u3069\u3046\u304b\u304c\u8a00\u8a9e\u306b\u3088\u3063\u3066\u7570\u306a\u308b\u306e\u3067\u6ce8\u610f \u4f8b1) hoge_hoge \u306e\u3088\u3046\u306b\u3001\u524d\u5f8c\u304c\u540c\u3058\u3082\u306e\u3092\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044 \u30ad\u30e3\u30d7\u30c1\u30e3\u306e\u306e\u4f8b1 # \u691c\u7d22\u6587\u5b57\u5217 (.+)_\\1 \u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b\u3002\u3053\u306e\u3088\u3046\u306b\u524d\u65b9\u3067\u30de\u30c3\u30c1\u3057\u305f\u3082\u306e\u3092\u53c2\u7167\u3059\u308b\u3053\u3068\u3092 \u5f8c\u65b9\u53c2\u7167 \u3068\u3044\u3046\u3002 \u4f8b2) https://www.google.co.jp/ \u306ea\u30bf\u30b0\u5185\u306e\u5024\u3092href\u5c5e\u6027\u306b\u8a2d\u5b9a\u3057\u305f\u3044\u5834\u5408\u3001 \u30ad\u30e3\u30d7\u30c1\u30e3\u306e\u4f8b2 # \u691c\u7d22\u6587\u5b57\u5217 <a>(.+?)</a> # \u7f6e\u63db\u6587\u5b57\u5217 <a href=\"$1\">$1</a> \u3067\u7f6e\u63db\u3067\u304d\u308b\u3002 \u4f8b3) hoge@fuga.com\u304b\u3089\u306e\u30ed\u30fc\u30ab\u30eb\u90e8\u3001\u30c9\u30e1\u30a4\u30f3\u90e8\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u5168\u4f53\u3092\u53d6\u308a\u51fa\u3057\u305f\u3044\u5834\u5408\u3001 \u30ad\u30e3\u30d7\u30c1\u30e3\u306e\u4f8b3 # \u691c\u7d22\u6587\u5b57\u5217 ((.+)@(.+)) # \u7f6e\u63db\u6587\u5b57\u5217 \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9=$1\\n\u30ed\u30fc\u30ab\u30eb\u90e8=$2\\n\u30c9\u30e1\u30a4\u30f3\u90e8=$3 \u3067\u7f6e\u63db\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u7d50\u679c\u306b\u306a\u308b\u3002 \u4f8b3\u306e\u7d50\u679c \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9=hoge@fuga.com \u30ed\u30fc\u30ab\u30eb\u90e8=hoge \u30c9\u30e1\u30a4\u30f3\u90e8=fuga.com \u30ad\u30e3\u30d7\u30c1\u30e3\u3059\u308b\u9806\u756a\u306f\u300c(\u300d\u304c\u73fe\u308c\u305f\u9806\u306b\u306a\u3063\u3066\u3044\u308b\u3002 \u30ad\u30e3\u30d7\u30c1\u30e3\u3057\u306a\u3044\u62ec\u5f27 \u00b6 (?:)\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u30b0\u30eb\u30fc\u30d7\u5316\u306e\u307f\u3092\u884c\u3044\u30ad\u30e3\u30d7\u30c1\u30e3\u3092\u884c\u308f\u306a\u3044 \u30b0\u30eb\u30fc\u30d7\u5316\u306e\u307f\u304c\u76ee\u7684\u3067\u3042\u308b\u3053\u3068\u3092\u660e\u793a\u3057\u305f\u3044\u5834\u5408\u3053\u306e\u3088\u3046\u306b\u66f8\u304f \u82e5\u5e72\u8aad\u307f\u306b\u304f\u304f\u306a\u308b\uff08\u53ef\u8aad\u6027\u304c\u4e0b\u304c\u308b\uff09\u306e\u3067\u3001\u3069\u3061\u3089\u3067\u66f8\u3044\u305f\u65b9\u304c\u3044\u3044\u304b\u306f\u72b6\u6cc1\u306b\u3088\u308b \u30ad\u30e3\u30d7\u30c1\u30e3\u3057\u306a\u3044\u62ec\u5f27\u306e\u4f8b https://www\\.(?:google|yahoo)\\.co\\.jp/ \u5148\u8aad\u307f\u3068\u5f8c\u8aad\u307f \u00b6 \u5148\u8aad\u307f\u30fb\u5f8c\u8aad\u307f \u6b63\u898f\u8868\u73fe \u610f\u5473 \u80af\u5b9a\u5148\u8aad\u307f(positive look forward) (?=abc) \u524d\u65b9\u3092\u898b\u3066abc\u304c\u3042\u308b\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u5426\u5b9a\u5148\u8aad\u307f(negative look forward) (?!abc) \u524d\u65b9\u3092\u898b\u3066abc\u304c\u306a\u3044\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u80af\u5b9a\u5f8c\u8aad\u307f(positive look behind) (?<=abc) \u5f8c\u65b9\u3092\u898b\u3066abc\u304c\u3042\u308b\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u5426\u5b9a\u5f8c\u8aad\u307f(negative look behind) (?<!abc) \u5f8c\u65b9\u3092\u898b\u3066abc\u304c\u306a\u3044\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u203bJavaScript\u7cfb\u3067\u306f\u5f8c\u8aad\u307f\u306f\u5b9f\u88c5\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u6ce8\u610f \u4f8b customer.fullname customer.firstName customer.lastName employee.firstName employee.lastName officer.firstName officer.lastName customer(?=.firstName) \u2192\u5f8c\u308d\u306bfirstName\u304c\u7d9a\u304fcustomer\u306b\u30de\u30c3\u30c1 customer(?!.firstName) \u2192\u5f8c\u308d\u306bfullName\u304c\u6765\u306a\u3044customer\u306b\u30de\u30c3\u30c1 (?<=customer.)firstName \u2192customer\u306e\u5f8c\u308d\u306efirstName\u306b\u30de\u30c3\u30c1 (?<!customer.)firstName \u2192customer\u4ee5\u5916\u306e\u5f8c\u308d\u306efirstName\u306b\u30de\u30c3\u30c1 \uff5e\u3092\u542b\u3080\u30fb\u542b\u307e\u306a\u3044 \u00b6 \u5148\u8aad\u307f\u30fb\u5f8c\u8aad\u307f\u3092\u5fdc\u7528\u3059\u308b\u3068\u3001\uff5e\u3092\u542b\u3080\u30fb\u542b\u307e\u306a\u3044\u884c\u306f\u4ee5\u4e0b\u306e\u6b63\u898f\u8868\u73fe\u306e\u3088\u3046\u306b\u8868\u305b\u308b abc\u3092\u542b\u3080\u884c\u30fb\u542b\u307e\u306a\u3044\u884c # abc\u3092\u542b\u3080\u884c ^(?=.*abc).* # def\u3092\u542b\u307e\u306a\u3044\u884c ^(?!.*def).* \u4f8b) \u30b9\u30da\u30fc\u30b9\u3092\u542b\u3080\u884c\u3092\u524a\u9664\u3057\u305f\u3044 \u30b9\u30da\u30fc\u30b9\u3092\u542b\u3080\u884c\u306e\u524a\u9664 # \u691c\u7d22\u6587\u5b57\u5217 ^(?=.* ).*\\n # \u7f6e\u63db\u6587\u5b57\u5217\u306f\u7a7a\u6587\u5b57 \u4fee\u98fe\u5b50 \u00b6 \u591a\u304f\u306e\u51e6\u7406\u7cfb\u306b\u306f\u30de\u30c3\u30c1\u30f3\u30b0\u306e\u51e6\u7406\u65b9\u6cd5\u3092\u5909\u66f4\u3059\u308b\u6307\u5b9a\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b \u672b\u5c3e\u306b\u4ed8\u3051\u308b\u4fee\u98fe\u5b50\u3092\u30d5\u30e9\u30b0\uff08flag\uff09\u3068\u547c\u3076 JavaScript // \u4fee\u98fe\u5b50i\u306f\u5927\u6587\u5b57\u3068\u5c0f\u6587\u5b57\u3092\u533a\u5225\u3057\u306a\u3044\uff08ignoreCase\uff09 // \u4fee\u98fe\u5b50g\u306f\u5168\u3066\u306e\u30de\u30c3\u30c1\u30f3\u30b0\u7b87\u6240\u3092\u691c\u7d22\u3059\u308b\uff08global\uff09 var regex = /hoge/ig; \u6b63\u898f\u8868\u73fe\u306b\u304a\u3051\u308b\u6ce8\u610f\u70b9 \u00b6 \u6700\u9577\u30de\u30c3\u30c1\u3068\u6700\u77ed\u30de\u30c3\u30c1 \u00b6 \u601d\u3063\u305f\u3088\u308a\u3082\u9577\u3044\u7bc4\u56f2\u306b\u30de\u30c3\u30c1\u3057\u3066\u3057\u307e\u3046\u30fb\u30fb\u30fb\u3068\u3044\u3046\u6642\u306b\u78ba\u8a8d \u7e70\u308a\u8fd4\u3057\u6587\u5b57\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30de\u30c3\u30c1\u3057\u3046\u308b\u6700\u5927\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1\u3059\u308b \u7e70\u308a\u8fd4\u3057\u306e\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u306e\u5f8c\u308d\u306b \u300c?\u300d \u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u3057\u3046\u308b\u6700\u5c0f\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1\u3059\u308b \u4f8b\u3048\u3070\u3001\u300choge@hoge.com\u300d\u304b\u3089hoge\u3092\u5225\u3005\u306b2\u3064\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044\u3068\u3059\u308b\u3002 \u6b63\u898f\u8868\u73fe\uff1a h.*e \u3068\u3059\u308b\u3068\u3001\u300choge@hoge\u300d\u306b\u30de\u30c3\u30c1\u3057\u3066\u3057\u307e\u3046\u306e\u3067NG\u3001 \u6b63\u898f\u8868\u73fe\uff1a h.*?e \u306e\u3088\u3046\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002 \u57fa\u672c\u6b63\u898f\u8868\u73fe\u3068\u62e1\u5f35\u6b63\u898f\u8868\u73fe \u00b6 \u3042\u308c\uff1f\u6b63\u898f\u8868\u73fe\u306f\u5408\u3063\u3066\u308b\u306e\u306b\u30de\u30c3\u30c1\u3057\u306a\u3044\u30fb\u30fb\u30fb\u3068\u3044\u3046\u5834\u5408\u306f\u305d\u3082\u305d\u3082\u6a5f\u80fd\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044\u53ef\u80fd\u6027\u304c\u3042\u308b POSIX\u6b63\u898f\u8868\u73fe\u306b\u306f2\u7a2e\u985e\u3042\u308a\u3001\u5229\u7528\u3067\u304d\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u3084\u6a5f\u80fd\u304c\u7570\u306a\u308b \u7a2e\u985e \u7279\u5fb4 \u5bfe\u5fdc \u57fa\u672c\u6b63\u898f\u8868\u73fe(basic regular expression:BRE) grep, sed \u306a\u3069 \u300c | \u300d\u300c+\u300d\u300c?\u300d\u306f\u4f7f\u7528\u4e0d\u53ef\u300c()\u300d\u300c{}\u300d\u306f\u30a8\u30b9\u30b1\u30fc\u30d7\u304c\u5fc5\u8981 \u62e1\u5f35\u6b63\u898f\u8868\u73fe(extended regular expression:ERE) egrep\uff08grep -E\uff09, sed -E \u306a\u3069 \u300c+\u300d\u300c?\u300d\u306f\u4f7f\u7528\u3067\u304d\u308b\u300c()\u300d\u300c{}\u300d\u306f\u30a8\u30b9\u30b1\u30fc\u30d7\u4e0d\u8981 \u3055\u3089\u306b\u3053\u308c\u306b\u6a5f\u80fd\u3092\u52a0\u3048\u305f\u6b63\u898f\u8868\u73fe\u304c\u3042\u308a\u3001\u8ffd\u52a0\u6a5f\u80fd\u304c\u4f7f\u3048\u308b\u304b\u3069\u3046\u304b\u306f\u5b9f\u88c5\u6bce\u306b\u78ba\u8a8d\u3059\u308b\u3057\u304b\u306a\u3044\u3002 \u53c2\u8003\uff1a 3\u3064\u306e\u6b63\u898f\u8868\u73fe\u3092\u77e5\u3089\u306a\u3044\u3068\u30cf\u30de\u308b\u30e8 \u30a8\u30b9\u30b1\u30fc\u30d7\u306e\u5fc5\u8981\u6027 \u00b6 \u30b3\u30fc\u30c9\u5185\u3067\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306b\u306f\u3001\u30a8\u30b9\u30b1\u30fc\u30d7\u304c\uff12\u91cd\u306b\u5fc5\u8981\u306a\u5834\u5408\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f java // \u6587\u5b57\u5217\u30ea\u30c6\u30e9\u30eb String regex = \"hoge\\\\.com\"; // \u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5\u306e\u6b63\u898f\u8868\u73fe\u306f\\\\\\\\\u3068\u66f8\u304f\u3002\u3053\u308c\u3067\u300c\\\u300d\u306e\u307f\u306b\u30de\u30c3\u30c1 String backslashRegex = \"\\\\\\\\\"; \u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb \u00b6 \u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb\u306b\u306f\u305d\u306e\u307e\u307e\u6b63\u898f\u8868\u73fe\u3092\u66f8\u3051\u308b\uff08\u6b63\u898f\u8868\u73fe\u306e\u307f\u306e\u30a8\u30b9\u30b1\u30fc\u30d7\u3067\u826f\u3044\uff09\u3002 JavaScript\u3084Ruby\u306a\u3069\u306f\u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u304c\u3001Java\u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044 JavaScript // \u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb var regex = /hoge\\.com/; \u6b63\u898f\u8868\u73fe\u306e\u30c1\u30a7\u30c3\u30af\u306b\u5f79\u7acb\u3064\u30b5\u30a4\u30c8 \u00b6 Regexper\uff1a\u6b63\u898f\u8868\u73fe\u3092\u53ef\u8996\u5316\u3057\u3066\u78ba\u8a8d\u3067\u304d\u308b regex-testdrive\uff1aJava\u306e\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af okumocchi\uff1aPHP\u53ca\u3073JavaScript\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af Regexr\uff1aJavaScript\u306e\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af Rubular\uff1aRuby\u306e\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af\u3001\u30ad\u30e3\u30d7\u30c1\u30e3\u5185\u5bb9\u304c\u308f\u304b\u308b \u88dc\u8db3\u30fb\u53c2\u8003 \u00b6 \u300c\\\u300d\uff08\u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5\uff09\u3068\u300c\u00a5\u300d\uff08\u5186\u30de\u30fc\u30af\u306b\u3064\u3044\u3066\uff09 \u00b6 Unicode\u304c\u5e83\u307e\u308b\u4ee5\u524d\u3001\u548c\u6587\u30d5\u30a9\u30f3\u30c8\u3067\u306f\u300c/\u300d\u306e\u6587\u5b57\u30b3\u30fc\u30c9\uff080x5c\uff09\u306b\u300c\u00a5\u300d\u306e\u8868\u8a18\u3092\u5272\u308a\u5f53\u3066\u3066\u3044\u305f\u305f\u3081\u3001\u300c\\\u300d\u3092\u5165\u529b\u3059\u308b\u3068\u300c\u00a5\u300d\u304c\u8868\u793a\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002 \u305d\u306e\u540d\u6b8b\u3067\u300c\\\u300d\u6587\u5b57\u30b3\u30fc\u30c9\uff080x5c\uff09\u3092\u5165\u529b\u3057\u305f\u5834\u5408\u3001\u300c\u00a5\u300d\u304c\u8868\u793a\u3055\u308c\u308b\u5834\u5408\u304c\u3042\u308b\u3002 Unicode\u3067\u306f\u300c\\\u300d\u306e\u6587\u5b57\u30b3\u30fc\u30c9\uff08U+005c\uff09\u3068\u306f\u5225\u306b\u3001\u300c\u00a5\u300d\u306b\u6587\u5b57\u30b3\u30fc\u30c9\uff08U+00A5\uff09\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u308b\u3002 \u6539\u884c\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066 \u00b6 \u6b63\u898f\u8868\u73fe\u3068\u306f\u95a2\u4fc2\u306a\u3044\u3051\u3069\u30ad\u30e3\u30ec\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\u3063\u3066\u306a\u3093\u305e\uff1f\u3068\u601d\u3063\u305f\u306e\u3067\u8abf\u3079\u3066\u307f\u305f \u300cCR\u300d\u300cLF\u300d\u300cCRLF\u300d\u306e3\u7a2e\u985e\u3042\u308b \u6614\u306eMac\u3067\u306fCR,\u73fe\u5728\u306eMac\u3084Linux\u306a\u3069\u306eUnix\u7cfb\u3067\u306fLF,windows\u3067\u306fCRLF\u3092\u63a1\u7528\u3057\u3066\u3044\u308b \u30bf\u30a4\u30d7\u30e9\u30a4\u30bf\u30fc\u306b\u306f\u30ad\u30e3\u30ea\u30c3\u30b8\u3068\u3044\u3046\u30ed\u30fc\u30eb\u306b\u7d19\u3092\u631f\u3080\u5f79\u76ee\u3092\u6301\u3064\u90e8\u54c1\u304c\u3042\u308a\u3001\u305d\u306e\u4f4d\u7f6e\u3092\u8abf\u7bc0\u3059\u308b\u300c\u30ad\u30e3\u30ea\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\u30ec\u30d0\u30fc\u300d\u3068\u30011\u884c\u5206\u30ed\u30fc\u30eb\u3092\u56de\u3057\u7d19\u3092\u9001\u308b\u3053\u3068\uff08\u30e9\u30a4\u30f3\u30d5\u30a3\u30fc\u30c9\uff09\u304c\u51fa\u6765\u308b\u30ec\u30d0\u30fc\u3092\u9806\u306b\u64cd\u4f5c\u3059\u308b\u3053\u3068\u3067\u6539\u884c\u3092\u884c\u3063\u3066\u3044\u305f\u3002 \u30ad\u30e3\u30ea\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\uff08carriage return:CR\u3001\u5fa9\u5e30\uff09 \u00b6 \u30ab\u30fc\u30bd\u30eb\u3092\u884c\u306e\u5148\u982d\u306b\u623b\u3059\u6307\u793a\uff08\u5de6\u306b\u79fb\u52d5\uff09 \u30e9\u30a4\u30f3\u30d5\u30a3\u30fc\u30c9\uff08line feed:LF, newline, end-of-line\u3001\u72ed\u7fa9\u306e\u6539\u884c\uff09 \u00b6 \u30ab\u30fc\u30bd\u30eb\u3092\u4e00\u3064\u4e0b\u306e\u884c\u306b\u79fb\u3059\u6307\u793a\uff08\u4e0b\u306b\u79fb\u52d5\uff09 \u4ee5\u524d\u306f\u30ab\u30fc\u30bd\u30eb\u3092\u4e0b\u306b\u79fb\u3059\u3060\u3051\u3067\u884c\u982d\u306b\u306f\u623b\u3089\u306a\u304b\u3063\u305f\uff08\u73fe\u5728\u306f\u884c\u982d\u306b\u623b\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\uff09 grep \u00b6 grep\u3068\u306fed\u3068\u3044\u3046\u30e9\u30a4\u30f3\u30a8\u30c7\u30a3\u30bf\u306e\u30b3\u30de\u30f3\u30c9 g/re/p\u306e\u30b3\u30de\u30f3\u30c9\u304b\u3089\u304d\u3066\u3044\u308b global Regular Expression print\u306e\u7565 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\uff08validation\uff09\u3068\u306f\uff1f \u00b6 validate\uff1a\u691c\u8a3c\u3059\u308b\u30fb\uff08\u59a5\u5f53\u6027\u3092\uff09\u78ba\u8a8d\u3059\u308b\u3001\u6709\u52b9\u6027\u3092\u78ba\u304b\u3081\u308b IT\u5206\u91ce\u3067\u306f\u300c\u898f\u5b9a\u3055\u308c\u305f\u6587\u6cd5\u30fb\u4ed5\u69d8\u901a\u308a\u306b\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u3092\u691c\u8a3c\u3059\u308b\u3053\u3068\u300d \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3001\u96fb\u8a71\u756a\u53f7\u3001\u90f5\u4fbf\u756a\u53f7\u306a\u3069\u6587\u6cd5\u306e\u30c1\u30a7\u30c3\u30af\u306e\u610f\u5473\u3067\u4f7f\u308f\u308c\u308b","title":"\u6b63\u898f\u8868\u73fe"},{"location":"Regular-Expression/#regular-expression","text":"\u6587\u5b57\u5217\u3092\u30d1\u30bf\u30fc\u30f3\u5316\u3057\u3001\u7279\u6b8a\u306a\u6587\u5b57\uff08\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u3001\u30e1\u30bf\u6587\u5b57\uff09\u3067\u8868\u73fe\u3057\u305f\u3082\u306e \u4f8b\u3048\u3070\u3001\u90f5\u4fbf\u756a\u53f7\u3092\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u3063\u3066\u8868\u3059\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u73fe\u3067\u304d\u308b\u3002 \u90f5\u4fbf\u756a\u53f7\u306e\u6b63\u898f\u8868\u73fe \\d{3}-?\\d{4} # 3\u6841\u306e\u6570\u5b57 + \u30cf\u30a4\u30d5\u30f3\u6709\u308aor\u7121\u3057 + 4\u6841\u306e\u6570\u5b57 \u3053\u306e \u300c\\d\u300d\u300c{}\u300d\u300c?\u300d \u306e\u3088\u3046\u306a\u6587\u5b57\u306e\u3053\u3068\u3092 \u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff08\u30e1\u30bf\u6587\u5b57\uff09 \u3068\u3044\u3046\u3002","title":"\u6b63\u898f\u8868\u73fe\uff08Regular Expression\uff09\u3068\u306f\uff1f"},{"location":"Regular-Expression/#_1","text":"1940\u5e74\u4ee3\u306b\u3055\u307e\u3056\u307e\u306a\u795e\u7d4c\u751f\u7406\u5b66\u8005\u305f\u3061\u304c\u3001\u795e\u7d4c\u56de\u8def\u3092\u6570\u5b66\u7684\u306b\u8aac\u660e\u3059\u308b\u305f\u3081\u306b\u958b\u767a\u3057\u305f\u3002 1956\u5e74\u3001\u6570\u5b66\u8005 Stephen Kleene\uff08\u30b9\u30c6\u30a3\u30fc\u30d6\u30f3\u30fb\u30af\u30ea\u30fc\u30cd\uff09 \u304c\u3001\u305d\u306e\u8003\u3048\u65b9\u306b\u57fa\u3065\u304d\u8ad6\u6587\u3092\u8457\u8ff0\u3057\u3001\u521d\u3081\u3066\u6b63\u898f\u8868\u73fe\u306e\u6982\u5ff5\u304c\u7d39\u4ecb\u3055\u308c\u305f\u3002 \u3053\u3053\u3067\u300c\u6b63\u5247\u96c6\u5408\u306e\u4ee3\u6570\u300d\u3092\u8aac\u660e\u3059\u308b\u305f\u3081\u306b\u300c\u6b63\u5247\u8868\u73fe\u30fb\u6b63\u898f\u8868\u73fe(regular expression)\u300d\u304c\u4f7f\u7528\u3055\u308c\u305f\u3002 \u4f55\u304c\u8a00\u3044\u305f\u304b\u3063\u305f\u306e\u304b\u3068\u3044\u3046\u3068\u3001\u5143\u3005\u306f\u795e\u7d4c\u56de\u8def\u306e\u7814\u7a76\u3067\u958b\u767a\u3055\u308c\u305f\u6570\u5b66\u7684\u306a\u6982\u5ff5\u3060\u3063\u305f\u3068\u3044\u3046\u3053\u3068\u3002 \u6b63\u898f\u8868\u73fe\u3068\u3044\u3046\u82e5\u5e72\u5206\u304b\u308a\u306b\u304f\u3044\u30cd\u30fc\u30df\u30f3\u30b0\u306f\u3053\u306e\u305b\u3044 \u53c2\u8003\uff1a \u6b63\u898f\u8868\u73fe\u306e\u7531\u6765","title":"\u6b63\u898f\u8868\u73fe\u306e\u7531\u6765"},{"location":"Regular-Expression/#_2","text":"\u6587\u5b57\u5217\u691c\u7d22\u306b\u5f79\u7acb\u3064 grep\u691c\u7d22\u3001\u30a8\u30c7\u30a3\u30bf\u3084Excel\u306e\u691c\u7d22\u6a5f\u80fd \u2192 \u8abf\u67fb\u3001\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u304c\u6357\u308b \u6587\u5b57\u5217\u7f6e\u63db\u306b\u5f79\u7acb\u3064 sed\u3001\u30a8\u30c7\u30a3\u30bf\u3084Excel\u306e\u7f6e\u63db\u6a5f\u80fd \u2192 \u6587\u5b57\u5217\u306e\u4e00\u62ec\u4fee\u6b63\u3001\u4e00\u62ec\u633f\u5165\u3001\u4e00\u62ec\u524a\u9664\u304c\u697d\u306b\u306a\u308b \u5165\u529b\u3055\u308c\u305f\u6587\u5b57\u5217\u304c\u3001\u898f\u5b9a\u3055\u308c\u305f\u30d1\u30bf\u30fc\u30f3\u901a\u308a\u306b\u5165\u529b\u3055\u308c\u3066\u3044\u308b\u304b\u306e\u78ba\u8a8d\uff08\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\uff09\u306b\u5f79\u7acb\u3064 \u90f5\u4fbf\u756a\u53f7\u3001\u96fb\u8a71\u756a\u53f7\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306a\u3069\u306e\u5165\u529b\u5f62\u5f0f\u306e\u30c1\u30a7\u30c3\u30af\u306a\u3069","title":"\u4f55\u306e\u5f79\u306b\u7acb\u3064\uff1f"},{"location":"Regular-Expression/#_3","text":"\u6700\u521d\u306e\u9803\u306b\u6b63\u898f\u8868\u73fe\u3068\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3092\u52d8\u9055\u3044\u3057\u3066\u3044\u305f\u306e\u3067\u78ba\u8a8d\u3002 \u305d\u3082\u305d\u3082\u3001\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08Wild Card\uff09\u3068\u306f\u4f55\u304b\uff1f \u30c8\u30e9\u30f3\u30d7\u7528\u8a9e\u3067\uff0c\u3069\u306e\u30ab\u30fc\u30c9\u306e\u4ee3\u7528\u306b\u3082\u3067\u304d\u308b\u30ab\u30fc\u30c9\u306e\u3053\u3068\uff08\u30dd\u30fc\u30ab\u30fc\u306b\u304a\u3051\u308b\u30b8\u30e7\u30fc\u30ab\u30fc\u306a\u3069\uff09 \u8ee2\u3058\u3066IT\u306b\u304a\u3051\u308b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u3068\u306f\u3001 \u4efb\u610f\u306e\u6587\u5b57\u5217 \u306b\u30de\u30c3\u30c1\u3059\u308b\u7279\u6b8a\u6587\u5b57 OS\u3084\u8a00\u8a9e\u306b\u3088\u3063\u3066\u89e3\u91c8\u304c\u7570\u306a\u308b","title":"\u6b63\u898f\u8868\u73fe\u3068\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u306e\u9055\u3044"},{"location":"Regular-Expression/#_4","text":"windows\u3084Unix/Linux\u306e\u30b7\u30a7\u30eb\u3067\u306e\u30d5\u30a1\u30a4\u30eb\u691c\u7d22\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u304c\u4f7f\u3048\u308b \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 \u5185\u5bb9 ? \u4efb\u610f\u306e1\u6587\u5b57\u306b\u30de\u30c3\u30c1 * 0\u6587\u5b57\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1 music.mp? \u2192 \u300cmusic.mp3\u300d\u300cmusic.mp4\u300d\u306a\u3069\u306b\u30de\u30c3\u30c1 *.txt \u2192 \u62e1\u5f35\u5b50\u304c.txt\u3067\u3042\u308b\u3082\u306e\u5168\u3066\u306b\u30de\u30c3\u30c1","title":"\u30d5\u30a1\u30a4\u30eb\u691c\u7d22\u306b\u304a\u3051\u308b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9"},{"location":"Regular-Expression/#sql","text":"SQL\u306eWHERE\u53e5\u306b\u304a\u3051\u308bLIKE\u6f14\u7b97\u5b50\u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\u304c\u4f7f\u3048\u308b \u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 \u5185\u5bb9 % 0\u6587\u5b57\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1 _ \u4efb\u610f\u306e\uff11\u6587\u5b57\u306b\u30de\u30c3\u30c1","title":"SQL\u306b\u304a\u3051\u308b\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9"},{"location":"Regular-Expression/#_5","text":"\u305d\u306e\u6587\u5b57\u81ea\u8eab\u3068\u306f\u7570\u306a\u308b\u3001\u7279\u5225\u306a\u610f\u5473\u3084\u5f79\u5272\u3092\u6301\u3064\u6587\u5b57\u306e\u3053\u3068 \u3056\u3063\u304f\u308a\u5206\u985e\u3059\u308b\u3068\u3001 \u6587\u5b57\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a .\uff08\u30c9\u30c3\u30c8\uff09, \\w, \\W, \\s, \\S, \\d, \\D \u306a\u3069 \u7e70\u308a\u8fd4\u3057\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a +, *, ?, {n}, {n,m}, {n,} \u4f4d\u7f6e\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a ^, $, \\b, \\B \u6587\u5b57\u96c6\u5408\u3084\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff1a [], [^], |, (), (?:) \u305d\u306e\u4ed6\uff08\u5f8c\u65b9\u53c2\u7167\u306a\u3069\uff09\uff1a \\1, \\2, \\3, ... \u203b\u6b63\u898f\u8868\u73fe\u306e\u5b9f\u88c5\u306b\u3088\u3063\u3066\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u304c\u7570\u306a\u308b\u306e\u3067\u6ce8\u610f","title":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u3068\u306f\uff1f"},{"location":"Regular-Expression/#_6","text":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 \u5099\u8003 .\uff08\u30c9\u30c3\u30c8\uff09 \u4efb\u610f\u306e\uff11\u6587\u5b57\u306b\u30de\u30c3\u30c1 \u6539\u884c\u306b\u306f\u30de\u30c3\u30c1\u3057\u306a\u3044 \\w \u5358\u8a9e\u3092\u69cb\u6210\u3059\u308b\u6587\u5b57\u306b\u30de\u30c3\u30c1 w\u306fword\u306e\u982d\u6587\u5b57 \\W \u5358\u8a9e\u3092\u69cb\u6210\u3059\u308b\u6587\u5b57 \u4ee5\u5916\u306e\u6587\u5b57 \u306b\u30de\u30c3\u30c1 \\d \u6570\u5b57\uff080~9\uff09\u306b\u30de\u30c3\u30c1 d\u306fdigit\u306e\u982d\u6587\u5b57 \\D \u6570\u5b57 \u4ee5\u5916\u306e\u6587\u5b57 \u306b\u30de\u30c3\u30c1 \\s \u7a7a\u767d\u6587\u5b57\uff08\u534a\u89d2\u30b9\u30da\u30fc\u30b9\u3001\u30bf\u30d6\u6587\u5b57\u4ed6\uff09\u306b\u30de\u30c3\u30c1 s\u306fspace\u306e\u982d\u6587\u5b57 \\S \u7a7a\u767d\u6587\u5b57 \u4ee5\u5916\u306e\u6587\u5b57 \u306b\u30de\u30c3\u30c1","title":"\u6587\u5b57\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf"},{"location":"Regular-Expression/#_7","text":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 \\t \u30bf\u30d6\u6587\u5b57 \\v \u5782\u76f4\u30bf\u30d6 \\n \u6539\u884c\u6587\u5b57 \\r \u6539\u884c\u6587\u5b57\uff08\u30ad\u30e3\u30ec\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\uff09 \\f \u7528\u7d19\u9001\u308a\u6587\u5b57 \\a \u8b66\u544a\u6587\u5b57 \\e \u30a8\u30b9\u30b1\u30fc\u30d7\u6587\u5b57","title":"\u5236\u5fa1\u6587\u5b57\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf"},{"location":"Regular-Expression/#_8","text":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 \u5099\u8003 {n} n\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {n,m} n\u56de\u4ee5\u4e0am\u56de\u4ee5\u4e0b\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {n,} n\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 * 0\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {0,}\u3068\u540c\u7fa9 + 1\u56de\u4ee5\u4e0a\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {1,}\u3068\u540c\u7fa9 ? 0\u56de\u307e\u305f\u306f1\u56de\u306e\u7e70\u308a\u8fd4\u3057\u306b\u30de\u30c3\u30c1 {0,1}\u3068\u540c\u7fa9","title":"\u7e70\u308a\u8fd4\u3057\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff08\u91cf\u6307\u5b9a\u5b50\uff09"},{"location":"Regular-Expression/#_9","text":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 $ \u884c\u672b ^ \u884c\u982d \\b \u5358\u8a9e\u5883\u754c \\B \u5358\u8a9e\u5883\u754c\u4ee5\u5916","title":"\u4f4d\u7f6e\u3092\u8868\u3059\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\uff08\u30a2\u30f3\u30ab\u30fc\uff09"},{"location":"Regular-Expression/#_10","text":"\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf \u610f\u5473 [abc] a\u304bb\u304bc\u306e\u3069\u308c\u304b1\u6587\u5b57\u306b\u30de\u30c3\u30c1 [a-z] a\u304b\u3089z\u306e\u3069\u308c\u304b1\u6587\u5b57\u306b\u30de\u30c3\u30c1 [^abc] abc\u4ee5\u5916\u306e\u3069\u308c\u304b1\u6587\u5b57\u306b\u30de\u30c3\u30c1 abc|def abc\u307e\u305f\u306fdef\u306e\u30d1\u30bf\u30fc\u30f3\u306b\u30de\u30c3\u30c1 (abc) \u30b0\u30eb\u30fc\u30d7\u5316\u3068\u30ad\u30e3\u30d7\u30c1\u30e3\u3092\u884c\u3046 (?:abc) \u30b0\u30eb\u30fc\u30d7\u5316\u3092\u884c\u3046","title":"\u6587\u5b57\u96c6\u5408\u3084\u30b0\u30eb\u30fc\u30d7\u3092\u4f5c\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf"},{"location":"Regular-Expression/#a-z","text":"[a-z]\u306ea-z\u306e\u7bc4\u56f2\u306f\u6587\u5b57\u30b3\u30fc\u30c9\u306e\u7bc4\u56f2 Unicode\u306e\u6587\u5b57\u30b3\u30fc\u30c9\u756a\u53f7\u3092\u4f7f\u7528\u3057\u3066[\\u0061-\\u007A]\u306e\u3088\u3046\u306b\u8868\u3059\u3053\u3068\u3082\u3067\u304d\u308b","title":"[a-z]\u306b\u3064\u3044\u3066"},{"location":"Regular-Expression/#_11","text":"\u4ee5\u4e0b\u306e\u6a5f\u80fd\u306f\u3001\u51e6\u7406\u7cfb\u306b\u3088\u3063\u3066\u306f\u4f7f\u7528\u3067\u304d\u306a\u3044\u5834\u5408\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f\u3059\u308b\u3053\u3068\u3002","title":"\u305d\u306e\u4ed6\u306e\u6b63\u898f\u8868\u73fe\u306e\u6a5f\u80fd"},{"location":"Regular-Expression/#_12","text":"(abc)\u306e\u3088\u3046\u306b\u62ec\u5f27\u5185\u306e\u6587\u5b57\u5217\u3092\u3072\u3068\u307e\u3068\u3081\u306b\u6271\u3046\u3053\u3068 \u4f8b1) hogehoge....\u3068\u300choge\u300d\u3092\u7e70\u308a\u8fd4\u3059\u6587\u5b57\u5217\u3092\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044\u5834\u5408\u3001\u4ee5\u4e0b\u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b\u3002 \u30b0\u30eb\u30fc\u30d7\u5316\u306e\u4f8b1 (hoge)+ \u4f8b2) https://www.yahoo.co.jp/ \u3068 https://www.google.co.jp/ \u306e\u4e21\u65b9\u306b\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044\u5834\u5408\u3001\u4ee5\u4e0b\u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b \u30b0\u30eb\u30fc\u30d7\u5316\u306e\u4f8b2 https://www\\.(google|yahoo)\\.co\\.jp/ \u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b\u3002","title":"\u30b0\u30eb\u30fc\u30d7\u5316"},{"location":"Regular-Expression/#_13","text":"(abc)\u62ec\u5f27\u5185\u306e\u6587\u5b57\u5217\u3092\u8a18\u61b6\u3057\u3001\u53c2\u7167\u51fa\u6765\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068 \\1 ,\\2 ,\\3...\u3067\u524d\u65b9\u3067\u8a18\u61b6\u3057\u305f\u6587\u5b57\u5217\u3092\u30de\u30c3\u30c1\u3055\u305b\u308b\u3053\u3068\u304c\u51fa\u6765\u308b $1 ,$2 ,$3...\u3067\u8a18\u61b6\u3057\u305f\u6587\u5b57\u5217\u3092\u5909\u6570\u3068\u3057\u3066\u53c2\u7167\u3067\u304d\u308b\uff08\u7f6e\u63db\u306b\u3082\u4f7f\u3048\u308b\uff09 \u203b\u4f7f\u7528\u51fa\u6765\u308b\u304b\u3069\u3046\u304b\u304c\u8a00\u8a9e\u306b\u3088\u3063\u3066\u7570\u306a\u308b\u306e\u3067\u6ce8\u610f \u4f8b1) hoge_hoge \u306e\u3088\u3046\u306b\u3001\u524d\u5f8c\u304c\u540c\u3058\u3082\u306e\u3092\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044 \u30ad\u30e3\u30d7\u30c1\u30e3\u306e\u306e\u4f8b1 # \u691c\u7d22\u6587\u5b57\u5217 (.+)_\\1 \u3067\u691c\u7d22\u3059\u308b\u3068\u30de\u30c3\u30c1\u3059\u308b\u3002\u3053\u306e\u3088\u3046\u306b\u524d\u65b9\u3067\u30de\u30c3\u30c1\u3057\u305f\u3082\u306e\u3092\u53c2\u7167\u3059\u308b\u3053\u3068\u3092 \u5f8c\u65b9\u53c2\u7167 \u3068\u3044\u3046\u3002 \u4f8b2) https://www.google.co.jp/ \u306ea\u30bf\u30b0\u5185\u306e\u5024\u3092href\u5c5e\u6027\u306b\u8a2d\u5b9a\u3057\u305f\u3044\u5834\u5408\u3001 \u30ad\u30e3\u30d7\u30c1\u30e3\u306e\u4f8b2 # \u691c\u7d22\u6587\u5b57\u5217 <a>(.+?)</a> # \u7f6e\u63db\u6587\u5b57\u5217 <a href=\"$1\">$1</a> \u3067\u7f6e\u63db\u3067\u304d\u308b\u3002 \u4f8b3) hoge@fuga.com\u304b\u3089\u306e\u30ed\u30fc\u30ab\u30eb\u90e8\u3001\u30c9\u30e1\u30a4\u30f3\u90e8\u3001\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u5168\u4f53\u3092\u53d6\u308a\u51fa\u3057\u305f\u3044\u5834\u5408\u3001 \u30ad\u30e3\u30d7\u30c1\u30e3\u306e\u4f8b3 # \u691c\u7d22\u6587\u5b57\u5217 ((.+)@(.+)) # \u7f6e\u63db\u6587\u5b57\u5217 \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9=$1\\n\u30ed\u30fc\u30ab\u30eb\u90e8=$2\\n\u30c9\u30e1\u30a4\u30f3\u90e8=$3 \u3067\u7f6e\u63db\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u7d50\u679c\u306b\u306a\u308b\u3002 \u4f8b3\u306e\u7d50\u679c \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9=hoge@fuga.com \u30ed\u30fc\u30ab\u30eb\u90e8=hoge \u30c9\u30e1\u30a4\u30f3\u90e8=fuga.com \u30ad\u30e3\u30d7\u30c1\u30e3\u3059\u308b\u9806\u756a\u306f\u300c(\u300d\u304c\u73fe\u308c\u305f\u9806\u306b\u306a\u3063\u3066\u3044\u308b\u3002","title":"\u30ad\u30e3\u30d7\u30c1\u30e3"},{"location":"Regular-Expression/#_14","text":"(?:)\u3092\u4f7f\u7528\u3059\u308b\u3068\u3001\u30b0\u30eb\u30fc\u30d7\u5316\u306e\u307f\u3092\u884c\u3044\u30ad\u30e3\u30d7\u30c1\u30e3\u3092\u884c\u308f\u306a\u3044 \u30b0\u30eb\u30fc\u30d7\u5316\u306e\u307f\u304c\u76ee\u7684\u3067\u3042\u308b\u3053\u3068\u3092\u660e\u793a\u3057\u305f\u3044\u5834\u5408\u3053\u306e\u3088\u3046\u306b\u66f8\u304f \u82e5\u5e72\u8aad\u307f\u306b\u304f\u304f\u306a\u308b\uff08\u53ef\u8aad\u6027\u304c\u4e0b\u304c\u308b\uff09\u306e\u3067\u3001\u3069\u3061\u3089\u3067\u66f8\u3044\u305f\u65b9\u304c\u3044\u3044\u304b\u306f\u72b6\u6cc1\u306b\u3088\u308b \u30ad\u30e3\u30d7\u30c1\u30e3\u3057\u306a\u3044\u62ec\u5f27\u306e\u4f8b https://www\\.(?:google|yahoo)\\.co\\.jp/","title":"\u30ad\u30e3\u30d7\u30c1\u30e3\u3057\u306a\u3044\u62ec\u5f27"},{"location":"Regular-Expression/#_15","text":"\u5148\u8aad\u307f\u30fb\u5f8c\u8aad\u307f \u6b63\u898f\u8868\u73fe \u610f\u5473 \u80af\u5b9a\u5148\u8aad\u307f(positive look forward) (?=abc) \u524d\u65b9\u3092\u898b\u3066abc\u304c\u3042\u308b\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u5426\u5b9a\u5148\u8aad\u307f(negative look forward) (?!abc) \u524d\u65b9\u3092\u898b\u3066abc\u304c\u306a\u3044\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u80af\u5b9a\u5f8c\u8aad\u307f(positive look behind) (?<=abc) \u5f8c\u65b9\u3092\u898b\u3066abc\u304c\u3042\u308b\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u5426\u5b9a\u5f8c\u8aad\u307f(negative look behind) (?<!abc) \u5f8c\u65b9\u3092\u898b\u3066abc\u304c\u306a\u3044\u4f4d\u7f6e\u306b\u30de\u30c3\u30c1 \u203bJavaScript\u7cfb\u3067\u306f\u5f8c\u8aad\u307f\u306f\u5b9f\u88c5\u3055\u308c\u3066\u3044\u306a\u3044\u306e\u3067\u6ce8\u610f \u4f8b customer.fullname customer.firstName customer.lastName employee.firstName employee.lastName officer.firstName officer.lastName customer(?=.firstName) \u2192\u5f8c\u308d\u306bfirstName\u304c\u7d9a\u304fcustomer\u306b\u30de\u30c3\u30c1 customer(?!.firstName) \u2192\u5f8c\u308d\u306bfullName\u304c\u6765\u306a\u3044customer\u306b\u30de\u30c3\u30c1 (?<=customer.)firstName \u2192customer\u306e\u5f8c\u308d\u306efirstName\u306b\u30de\u30c3\u30c1 (?<!customer.)firstName \u2192customer\u4ee5\u5916\u306e\u5f8c\u308d\u306efirstName\u306b\u30de\u30c3\u30c1","title":"\u5148\u8aad\u307f\u3068\u5f8c\u8aad\u307f"},{"location":"Regular-Expression/#_16","text":"\u5148\u8aad\u307f\u30fb\u5f8c\u8aad\u307f\u3092\u5fdc\u7528\u3059\u308b\u3068\u3001\uff5e\u3092\u542b\u3080\u30fb\u542b\u307e\u306a\u3044\u884c\u306f\u4ee5\u4e0b\u306e\u6b63\u898f\u8868\u73fe\u306e\u3088\u3046\u306b\u8868\u305b\u308b abc\u3092\u542b\u3080\u884c\u30fb\u542b\u307e\u306a\u3044\u884c # abc\u3092\u542b\u3080\u884c ^(?=.*abc).* # def\u3092\u542b\u307e\u306a\u3044\u884c ^(?!.*def).* \u4f8b) \u30b9\u30da\u30fc\u30b9\u3092\u542b\u3080\u884c\u3092\u524a\u9664\u3057\u305f\u3044 \u30b9\u30da\u30fc\u30b9\u3092\u542b\u3080\u884c\u306e\u524a\u9664 # \u691c\u7d22\u6587\u5b57\u5217 ^(?=.* ).*\\n # \u7f6e\u63db\u6587\u5b57\u5217\u306f\u7a7a\u6587\u5b57","title":"\uff5e\u3092\u542b\u3080\u30fb\u542b\u307e\u306a\u3044"},{"location":"Regular-Expression/#_17","text":"\u591a\u304f\u306e\u51e6\u7406\u7cfb\u306b\u306f\u30de\u30c3\u30c1\u30f3\u30b0\u306e\u51e6\u7406\u65b9\u6cd5\u3092\u5909\u66f4\u3059\u308b\u6307\u5b9a\u30aa\u30d7\u30b7\u30e7\u30f3\u304c\u7528\u610f\u3055\u308c\u3066\u3044\u308b \u672b\u5c3e\u306b\u4ed8\u3051\u308b\u4fee\u98fe\u5b50\u3092\u30d5\u30e9\u30b0\uff08flag\uff09\u3068\u547c\u3076 JavaScript // \u4fee\u98fe\u5b50i\u306f\u5927\u6587\u5b57\u3068\u5c0f\u6587\u5b57\u3092\u533a\u5225\u3057\u306a\u3044\uff08ignoreCase\uff09 // \u4fee\u98fe\u5b50g\u306f\u5168\u3066\u306e\u30de\u30c3\u30c1\u30f3\u30b0\u7b87\u6240\u3092\u691c\u7d22\u3059\u308b\uff08global\uff09 var regex = /hoge/ig;","title":"\u4fee\u98fe\u5b50"},{"location":"Regular-Expression/#_18","text":"","title":"\u6b63\u898f\u8868\u73fe\u306b\u304a\u3051\u308b\u6ce8\u610f\u70b9"},{"location":"Regular-Expression/#_19","text":"\u601d\u3063\u305f\u3088\u308a\u3082\u9577\u3044\u7bc4\u56f2\u306b\u30de\u30c3\u30c1\u3057\u3066\u3057\u307e\u3046\u30fb\u30fb\u30fb\u3068\u3044\u3046\u6642\u306b\u78ba\u8a8d \u7e70\u308a\u8fd4\u3057\u6587\u5b57\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u30de\u30c3\u30c1\u3057\u3046\u308b\u6700\u5927\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1\u3059\u308b \u7e70\u308a\u8fd4\u3057\u306e\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u306e\u5f8c\u308d\u306b \u300c?\u300d \u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u3057\u3046\u308b\u6700\u5c0f\u306e\u6587\u5b57\u5217\u306b\u30de\u30c3\u30c1\u3059\u308b \u4f8b\u3048\u3070\u3001\u300choge@hoge.com\u300d\u304b\u3089hoge\u3092\u5225\u3005\u306b2\u3064\u30de\u30c3\u30c1\u3055\u305b\u305f\u3044\u3068\u3059\u308b\u3002 \u6b63\u898f\u8868\u73fe\uff1a h.*e \u3068\u3059\u308b\u3068\u3001\u300choge@hoge\u300d\u306b\u30de\u30c3\u30c1\u3057\u3066\u3057\u307e\u3046\u306e\u3067NG\u3001 \u6b63\u898f\u8868\u73fe\uff1a h.*?e \u306e\u3088\u3046\u306b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002","title":"\u6700\u9577\u30de\u30c3\u30c1\u3068\u6700\u77ed\u30de\u30c3\u30c1"},{"location":"Regular-Expression/#_20","text":"\u3042\u308c\uff1f\u6b63\u898f\u8868\u73fe\u306f\u5408\u3063\u3066\u308b\u306e\u306b\u30de\u30c3\u30c1\u3057\u306a\u3044\u30fb\u30fb\u30fb\u3068\u3044\u3046\u5834\u5408\u306f\u305d\u3082\u305d\u3082\u6a5f\u80fd\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044\u53ef\u80fd\u6027\u304c\u3042\u308b POSIX\u6b63\u898f\u8868\u73fe\u306b\u306f2\u7a2e\u985e\u3042\u308a\u3001\u5229\u7528\u3067\u304d\u308b\u30e1\u30bf\u30ad\u30e3\u30e9\u30af\u30bf\u3084\u6a5f\u80fd\u304c\u7570\u306a\u308b \u7a2e\u985e \u7279\u5fb4 \u5bfe\u5fdc \u57fa\u672c\u6b63\u898f\u8868\u73fe(basic regular expression:BRE) grep, sed \u306a\u3069 \u300c | \u300d\u300c+\u300d\u300c?\u300d\u306f\u4f7f\u7528\u4e0d\u53ef\u300c()\u300d\u300c{}\u300d\u306f\u30a8\u30b9\u30b1\u30fc\u30d7\u304c\u5fc5\u8981 \u62e1\u5f35\u6b63\u898f\u8868\u73fe(extended regular expression:ERE) egrep\uff08grep -E\uff09, sed -E \u306a\u3069 \u300c+\u300d\u300c?\u300d\u306f\u4f7f\u7528\u3067\u304d\u308b\u300c()\u300d\u300c{}\u300d\u306f\u30a8\u30b9\u30b1\u30fc\u30d7\u4e0d\u8981 \u3055\u3089\u306b\u3053\u308c\u306b\u6a5f\u80fd\u3092\u52a0\u3048\u305f\u6b63\u898f\u8868\u73fe\u304c\u3042\u308a\u3001\u8ffd\u52a0\u6a5f\u80fd\u304c\u4f7f\u3048\u308b\u304b\u3069\u3046\u304b\u306f\u5b9f\u88c5\u6bce\u306b\u78ba\u8a8d\u3059\u308b\u3057\u304b\u306a\u3044\u3002 \u53c2\u8003\uff1a 3\u3064\u306e\u6b63\u898f\u8868\u73fe\u3092\u77e5\u3089\u306a\u3044\u3068\u30cf\u30de\u308b\u30e8","title":"\u57fa\u672c\u6b63\u898f\u8868\u73fe\u3068\u62e1\u5f35\u6b63\u898f\u8868\u73fe"},{"location":"Regular-Expression/#_21","text":"\u30b3\u30fc\u30c9\u5185\u3067\u6b63\u898f\u8868\u73fe\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306b\u306f\u3001\u30a8\u30b9\u30b1\u30fc\u30d7\u304c\uff12\u91cd\u306b\u5fc5\u8981\u306a\u5834\u5408\u304c\u3042\u308b\u306e\u3067\u6ce8\u610f java // \u6587\u5b57\u5217\u30ea\u30c6\u30e9\u30eb String regex = \"hoge\\\\.com\"; // \u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5\u306e\u6b63\u898f\u8868\u73fe\u306f\\\\\\\\\u3068\u66f8\u304f\u3002\u3053\u308c\u3067\u300c\\\u300d\u306e\u307f\u306b\u30de\u30c3\u30c1 String backslashRegex = \"\\\\\\\\\";","title":"\u30a8\u30b9\u30b1\u30fc\u30d7\u306e\u5fc5\u8981\u6027"},{"location":"Regular-Expression/#_22","text":"\u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb\u306b\u306f\u305d\u306e\u307e\u307e\u6b63\u898f\u8868\u73fe\u3092\u66f8\u3051\u308b\uff08\u6b63\u898f\u8868\u73fe\u306e\u307f\u306e\u30a8\u30b9\u30b1\u30fc\u30d7\u3067\u826f\u3044\uff09\u3002 JavaScript\u3084Ruby\u306a\u3069\u306f\u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb\u304c\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u308b\u304c\u3001Java\u306f\u30b5\u30dd\u30fc\u30c8\u3055\u308c\u3066\u3044\u306a\u3044 JavaScript // \u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb var regex = /hoge\\.com/;","title":"\u6b63\u898f\u8868\u73fe\u30ea\u30c6\u30e9\u30eb"},{"location":"Regular-Expression/#_23","text":"Regexper\uff1a\u6b63\u898f\u8868\u73fe\u3092\u53ef\u8996\u5316\u3057\u3066\u78ba\u8a8d\u3067\u304d\u308b regex-testdrive\uff1aJava\u306e\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af okumocchi\uff1aPHP\u53ca\u3073JavaScript\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af Regexr\uff1aJavaScript\u306e\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af Rubular\uff1aRuby\u306e\u6b63\u898f\u8868\u73fe\u30c1\u30a7\u30c3\u30af\u3001\u30ad\u30e3\u30d7\u30c1\u30e3\u5185\u5bb9\u304c\u308f\u304b\u308b","title":"\u6b63\u898f\u8868\u73fe\u306e\u30c1\u30a7\u30c3\u30af\u306b\u5f79\u7acb\u3064\u30b5\u30a4\u30c8"},{"location":"Regular-Expression/#_24","text":"","title":"\u88dc\u8db3\u30fb\u53c2\u8003"},{"location":"Regular-Expression/#_25","text":"Unicode\u304c\u5e83\u307e\u308b\u4ee5\u524d\u3001\u548c\u6587\u30d5\u30a9\u30f3\u30c8\u3067\u306f\u300c/\u300d\u306e\u6587\u5b57\u30b3\u30fc\u30c9\uff080x5c\uff09\u306b\u300c\u00a5\u300d\u306e\u8868\u8a18\u3092\u5272\u308a\u5f53\u3066\u3066\u3044\u305f\u305f\u3081\u3001\u300c\\\u300d\u3092\u5165\u529b\u3059\u308b\u3068\u300c\u00a5\u300d\u304c\u8868\u793a\u3055\u308c\u308b\u3088\u3046\u306b\u306a\u3063\u305f\u3002 \u305d\u306e\u540d\u6b8b\u3067\u300c\\\u300d\u6587\u5b57\u30b3\u30fc\u30c9\uff080x5c\uff09\u3092\u5165\u529b\u3057\u305f\u5834\u5408\u3001\u300c\u00a5\u300d\u304c\u8868\u793a\u3055\u308c\u308b\u5834\u5408\u304c\u3042\u308b\u3002 Unicode\u3067\u306f\u300c\\\u300d\u306e\u6587\u5b57\u30b3\u30fc\u30c9\uff08U+005c\uff09\u3068\u306f\u5225\u306b\u3001\u300c\u00a5\u300d\u306b\u6587\u5b57\u30b3\u30fc\u30c9\uff08U+00A5\uff09\u304c\u5272\u308a\u5f53\u3066\u3089\u308c\u3066\u3044\u308b\u3002","title":"\u300c\\\u300d\uff08\u30d0\u30c3\u30af\u30b9\u30e9\u30c3\u30b7\u30e5\uff09\u3068\u300c\u00a5\u300d\uff08\u5186\u30de\u30fc\u30af\u306b\u3064\u3044\u3066\uff09"},{"location":"Regular-Expression/#_26","text":"\u6b63\u898f\u8868\u73fe\u3068\u306f\u95a2\u4fc2\u306a\u3044\u3051\u3069\u30ad\u30e3\u30ec\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\u3063\u3066\u306a\u3093\u305e\uff1f\u3068\u601d\u3063\u305f\u306e\u3067\u8abf\u3079\u3066\u307f\u305f \u300cCR\u300d\u300cLF\u300d\u300cCRLF\u300d\u306e3\u7a2e\u985e\u3042\u308b \u6614\u306eMac\u3067\u306fCR,\u73fe\u5728\u306eMac\u3084Linux\u306a\u3069\u306eUnix\u7cfb\u3067\u306fLF,windows\u3067\u306fCRLF\u3092\u63a1\u7528\u3057\u3066\u3044\u308b \u30bf\u30a4\u30d7\u30e9\u30a4\u30bf\u30fc\u306b\u306f\u30ad\u30e3\u30ea\u30c3\u30b8\u3068\u3044\u3046\u30ed\u30fc\u30eb\u306b\u7d19\u3092\u631f\u3080\u5f79\u76ee\u3092\u6301\u3064\u90e8\u54c1\u304c\u3042\u308a\u3001\u305d\u306e\u4f4d\u7f6e\u3092\u8abf\u7bc0\u3059\u308b\u300c\u30ad\u30e3\u30ea\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\u30ec\u30d0\u30fc\u300d\u3068\u30011\u884c\u5206\u30ed\u30fc\u30eb\u3092\u56de\u3057\u7d19\u3092\u9001\u308b\u3053\u3068\uff08\u30e9\u30a4\u30f3\u30d5\u30a3\u30fc\u30c9\uff09\u304c\u51fa\u6765\u308b\u30ec\u30d0\u30fc\u3092\u9806\u306b\u64cd\u4f5c\u3059\u308b\u3053\u3068\u3067\u6539\u884c\u3092\u884c\u3063\u3066\u3044\u305f\u3002","title":"\u6539\u884c\u30b3\u30fc\u30c9\u306b\u3064\u3044\u3066"},{"location":"Regular-Expression/#carriage-returncr","text":"\u30ab\u30fc\u30bd\u30eb\u3092\u884c\u306e\u5148\u982d\u306b\u623b\u3059\u6307\u793a\uff08\u5de6\u306b\u79fb\u52d5\uff09","title":"\u30ad\u30e3\u30ea\u30c3\u30b8\u30ea\u30bf\u30fc\u30f3\uff08carriage return:CR\u3001\u5fa9\u5e30\uff09"},{"location":"Regular-Expression/#line-feedlf-newline-end-of-line","text":"\u30ab\u30fc\u30bd\u30eb\u3092\u4e00\u3064\u4e0b\u306e\u884c\u306b\u79fb\u3059\u6307\u793a\uff08\u4e0b\u306b\u79fb\u52d5\uff09 \u4ee5\u524d\u306f\u30ab\u30fc\u30bd\u30eb\u3092\u4e0b\u306b\u79fb\u3059\u3060\u3051\u3067\u884c\u982d\u306b\u306f\u623b\u3089\u306a\u304b\u3063\u305f\uff08\u73fe\u5728\u306f\u884c\u982d\u306b\u623b\u308b\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u308b\uff09","title":"\u30e9\u30a4\u30f3\u30d5\u30a3\u30fc\u30c9\uff08line feed:LF, newline, end-of-line\u3001\u72ed\u7fa9\u306e\u6539\u884c\uff09"},{"location":"Regular-Expression/#grep","text":"grep\u3068\u306fed\u3068\u3044\u3046\u30e9\u30a4\u30f3\u30a8\u30c7\u30a3\u30bf\u306e\u30b3\u30de\u30f3\u30c9 g/re/p\u306e\u30b3\u30de\u30f3\u30c9\u304b\u3089\u304d\u3066\u3044\u308b global Regular Expression print\u306e\u7565","title":"grep"},{"location":"Regular-Expression/#validation","text":"validate\uff1a\u691c\u8a3c\u3059\u308b\u30fb\uff08\u59a5\u5f53\u6027\u3092\uff09\u78ba\u8a8d\u3059\u308b\u3001\u6709\u52b9\u6027\u3092\u78ba\u304b\u3081\u308b IT\u5206\u91ce\u3067\u306f\u300c\u898f\u5b9a\u3055\u308c\u305f\u6587\u6cd5\u30fb\u4ed5\u69d8\u901a\u308a\u306b\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u3092\u691c\u8a3c\u3059\u308b\u3053\u3068\u300d \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u3001\u96fb\u8a71\u756a\u53f7\u3001\u90f5\u4fbf\u756a\u53f7\u306a\u3069\u6587\u6cd5\u306e\u30c1\u30a7\u30c3\u30af\u306e\u610f\u5473\u3067\u4f7f\u308f\u308c\u308b","title":"\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\uff08validation\uff09\u3068\u306f\uff1f"},{"location":"about/","text":"Welcome to MkDocs \u00b6 For full documentation visit mkdocs.org . Commands \u00b6 mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit. Project layout \u00b6 mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"About"},{"location":"about/#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"about/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs -h - Print help message and exit.","title":"Commands"},{"location":"about/#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"ansbile/","text":"\u30aa\u30d7\u30b7\u30e7\u30f3 \u00b6 -k, --ask-pass SSH \u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5c0b\u306d\u308b(\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u51fa\u308b) -K, --ask-sudo-pass sudo \u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5c0b\u306d\u308b(\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u51fa\u308b) -C, --check \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306a\u3069\u306e\u5909\u66f4\u306f\u884c\u308f\u306a\u3044\u304c\u3001\u6761\u4ef6\u306e\u78ba\u8a8d\u306a\u3069\u306f\u5b9f\u884c\u3059\u308b -c CONNECTION, --connection=CONNECTION local, ssh, paramiko \u304b\u3089\u9078\u629e\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306f paramiko\u3002\u53e4\u3044 OpenSSH \u3067 ssh \u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f ANSIBLE_SSH_ARGS=\"\" \u3068\u74b0\u5883\u5909\u6570\u3092\u7a7a\u3067\u4e0a\u66f8\u304d\u3059 \u308b\u5fc5\u8981\u304c\u3042\u308b -D, --diff file \u3084 template \u306e\u5dee\u5206(diff)\u3092\u8868\u793a\u3059\u308b\u3002--check \u3068\u4e00\u7dd2\u306b\u4f7f\u3046\u3068\u4fbf\u5229 -e EXTRA_VARS, --extra-vars=EXTRA_VARS \u8ffd\u52a0\u306e\u5909\u6570\u3092 key=value \u3067\u6307\u5b9a\u3059\u308b\u3002playbook \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u5909\u6570\u306e\u4e0a\u66f8\u304d\u306f\u3055\u308c\u306a\u3044 -f FORKS, --forks=FORKS \u4e26\u5217\u5b9f\u884c\u3059\u308b\u6570(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f5) -h, --help \u3053\u306e\u30d8\u30eb\u30d7\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b -i INVENTORY, --inventory-file=INVENTORY \u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f /etc/ansible/hosts) -l SUBNET, --limit=SUBNET \u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u3092\u6307\u5b9a\u306e\u3082\u306e\u3060\u3051\u306b\u5236\u9650\u3059\u308b --list-hosts \u305d\u308c\u305e\u308c\u306e playbook \u306e\u5bfe\u8c61\u30db\u30b9\u30c8\u4e00\u89a7\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b\u3002playbook \u306e\u5b9f\u884c\u306f\u3055\u308c\u306a\u3044 --list-tasks \u5404 playbook \u306e\u30bf\u30b9\u30af\u4e00\u89a7\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b -M MODULE_PATH, --module-path=MODULE_PATH \u30e2\u30b8\u30e5\u30fc\u30eb\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f /usr/share/ansible) --private-key=PRIVATE_KEY_FILE SSH \u306e\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b --start-at-task=START_AT \u6307\u5b9a\u306e task \u304b\u3089\u958b\u59cb\u3059\u308b --step \u3072\u3068\u3064\u306e task \u3054\u3068\u306b \"Perform task: \u30bf\u30b9\u30af\u540d (y/n/c):\" \u3068\u78ba\u8a8d\u3055\u308c\u308b\u3002y: (yes) \u5b9f\u884c\u3059\u308b\u3001n: (no) \u5b9f\u884c\u3057\u306a\u3044\u3001c: (continue) \u4ee5\u964d\u3092\u78ba\u8a8d\u306a \u3057\u3067\u5b9f\u884c\u3059\u308b -s, --sudo \u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u3067\u306e task \u3092 sudo \u3067\u5b9f\u884c\u3059\u308b -U SUDO_USER, --sudo-user=SUDO_USER sudo \u3067\u306e\u5b9f\u884c\u30e6\u30fc\u30b6\u30fc\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f root) --syntax-check playbook \u306e\u6587\u6cd5\u30c1\u30a7\u30c3\u30af\u3060\u3051\u3092\u884c\u3046 -t TAGS, --tags=TAGS \u6307\u5b9a\u306e tag \u304c\u4ed8\u3051\u3089\u308c\u305f task \u306e\u307f\u3092\u5b9f\u884c\u3059\u308b -T TIMEOUT, --timeout=TIMEOUT SSH \u306e\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f10\u79d2) -u REMOTE_USER, --user=REMOTE_USER SSH \u3067\u63a5\u7d9a\u3059\u308b\u30e6\u30fc\u30b6\u30fc\u540d\u3092\u6307\u5b9a\u3059\u308b -v, --verbose \u5197\u9577\u30e2\u30fc\u30c9 (-vvv \u3067\u3088\u308a\u5197\u9577\u306a\u51fa\u529b\u306b\u306a\u308b) --version \u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b","title":"ansbile\u30aa\u30d7\u30b7\u30e7\u30f3"},{"location":"ansbile/#_1","text":"-k, --ask-pass SSH \u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5c0b\u306d\u308b(\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u51fa\u308b) -K, --ask-sudo-pass sudo \u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5c0b\u306d\u308b(\u30d7\u30ed\u30f3\u30d7\u30c8\u304c\u51fa\u308b) -C, --check \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u306a\u3069\u306e\u5909\u66f4\u306f\u884c\u308f\u306a\u3044\u304c\u3001\u6761\u4ef6\u306e\u78ba\u8a8d\u306a\u3069\u306f\u5b9f\u884c\u3059\u308b -c CONNECTION, --connection=CONNECTION local, ssh, paramiko \u304b\u3089\u9078\u629e\u3002\u30c7\u30d5\u30a9\u30eb\u30c8\u306f paramiko\u3002\u53e4\u3044 OpenSSH \u3067 ssh \u3092\u6307\u5b9a\u3059\u308b\u5834\u5408\u306f ANSIBLE_SSH_ARGS=\"\" \u3068\u74b0\u5883\u5909\u6570\u3092\u7a7a\u3067\u4e0a\u66f8\u304d\u3059 \u308b\u5fc5\u8981\u304c\u3042\u308b -D, --diff file \u3084 template \u306e\u5dee\u5206(diff)\u3092\u8868\u793a\u3059\u308b\u3002--check \u3068\u4e00\u7dd2\u306b\u4f7f\u3046\u3068\u4fbf\u5229 -e EXTRA_VARS, --extra-vars=EXTRA_VARS \u8ffd\u52a0\u306e\u5909\u6570\u3092 key=value \u3067\u6307\u5b9a\u3059\u308b\u3002playbook \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u5909\u6570\u306e\u4e0a\u66f8\u304d\u306f\u3055\u308c\u306a\u3044 -f FORKS, --forks=FORKS \u4e26\u5217\u5b9f\u884c\u3059\u308b\u6570(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f5) -h, --help \u3053\u306e\u30d8\u30eb\u30d7\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b -i INVENTORY, --inventory-file=INVENTORY \u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f /etc/ansible/hosts) -l SUBNET, --limit=SUBNET \u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u3092\u6307\u5b9a\u306e\u3082\u306e\u3060\u3051\u306b\u5236\u9650\u3059\u308b --list-hosts \u305d\u308c\u305e\u308c\u306e playbook \u306e\u5bfe\u8c61\u30db\u30b9\u30c8\u4e00\u89a7\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b\u3002playbook \u306e\u5b9f\u884c\u306f\u3055\u308c\u306a\u3044 --list-tasks \u5404 playbook \u306e\u30bf\u30b9\u30af\u4e00\u89a7\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b -M MODULE_PATH, --module-path=MODULE_PATH \u30e2\u30b8\u30e5\u30fc\u30eb\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f /usr/share/ansible) --private-key=PRIVATE_KEY_FILE SSH \u306e\u79d8\u5bc6\u9375\u30d5\u30a1\u30a4\u30eb\u3092\u6307\u5b9a\u3059\u308b --start-at-task=START_AT \u6307\u5b9a\u306e task \u304b\u3089\u958b\u59cb\u3059\u308b --step \u3072\u3068\u3064\u306e task \u3054\u3068\u306b \"Perform task: \u30bf\u30b9\u30af\u540d (y/n/c):\" \u3068\u78ba\u8a8d\u3055\u308c\u308b\u3002y: (yes) \u5b9f\u884c\u3059\u308b\u3001n: (no) \u5b9f\u884c\u3057\u306a\u3044\u3001c: (continue) \u4ee5\u964d\u3092\u78ba\u8a8d\u306a \u3057\u3067\u5b9f\u884c\u3059\u308b -s, --sudo \u5bfe\u8c61\u30b5\u30fc\u30d0\u30fc\u3067\u306e task \u3092 sudo \u3067\u5b9f\u884c\u3059\u308b -U SUDO_USER, --sudo-user=SUDO_USER sudo \u3067\u306e\u5b9f\u884c\u30e6\u30fc\u30b6\u30fc\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f root) --syntax-check playbook \u306e\u6587\u6cd5\u30c1\u30a7\u30c3\u30af\u3060\u3051\u3092\u884c\u3046 -t TAGS, --tags=TAGS \u6307\u5b9a\u306e tag \u304c\u4ed8\u3051\u3089\u308c\u305f task \u306e\u307f\u3092\u5b9f\u884c\u3059\u308b -T TIMEOUT, --timeout=TIMEOUT SSH \u306e\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3092\u6307\u5b9a\u3059\u308b(\u30c7\u30d5\u30a9\u30eb\u30c8\u306f10\u79d2) -u REMOTE_USER, --user=REMOTE_USER SSH \u3067\u63a5\u7d9a\u3059\u308b\u30e6\u30fc\u30b6\u30fc\u540d\u3092\u6307\u5b9a\u3059\u308b -v, --verbose \u5197\u9577\u30e2\u30fc\u30c9 (-vvv \u3067\u3088\u308a\u5197\u9577\u306a\u51fa\u529b\u306b\u306a\u308b) --version \u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u8868\u793a\u3057\u3066\u7d42\u4e86\u3059\u308b","title":"\u30aa\u30d7\u30b7\u30e7\u30f3"},{"location":"ansbile_async/","text":"Ansible\u5e38\u7528\u529f\u80fd\u8bf4\u660e [\u5f02\u6b65\u3001\u5e76\u53d1\u3001\u59d4\u6258\u7b49] \u00b6 \u539f\u6587 Ansible\u7684\u540c\u6b65\u6a21\u5f0f\u4e0e\u5f02\u6b65\u6a21\u5f0f \u00b6 \u540c\u6b65\u6a21\u5f0f\uff1a \u00b6 \u5982\u679c\u8282\u70b9\u6570\u592a\u591a\uff0cansible\u65e0\u6cd5\u4e00\u6b21\u5728\u6240\u6709\u8fdc\u7a0b\u8282\u70b9\u4e0a\u6267\u884c\u4efb\u52a1\uff0c\u90a3\u4e48\u5c06\u5148\u5728\u4e00\u90e8\u5206\u8282\u70b9\u4e0a\u6267\u884c\u4e00\u4e2a\u4efb\u52a1(\u6bcf\u4e00\u6279\u8282\u70b9\u7684\u6570\u91cf\u53d6\u51b3\u4e8efork\u8fdb\u7a0b\u6570\u91cf\uff0c\u9ed8\u8ba4\u4e3a5\u4e2a\uff0c\u53ef\u8bbe\u7f6e)\uff0c\u76f4\u5230\u8fd9\u4e00\u6279\u6240\u6709\u8282\u70b9\u4e0a\u8be5\u4efb\u52a1\u5b8c\u5168\u6267\u884c\u5b8c\u6bd5\u624d\u4f1a\u63a5\u5165\u4e0b\u4e00\u4e2a\u6279\u8282\u70b9\uff0c\u76f4\u5230\u6240\u6709\u8282\u70b9\u5c06\u8be5\u4efb\u52a1\u90fd\u6267\u884c\u5b8c\u6bd5\uff0c\u7136\u540e\u91cd\u65b0\u56de\u5230\u7b2c\u4e00\u6279\u8282\u70b9\u5f00\u59cb\u6267\u884c\u7b2c\u4e8c\u4e2a\u4efb\u52a1\u3002\u4f9d\u6b21\u7c7b\u63a8\uff0c\u76f4\u5230\u6240\u6709\u8282\u70b9\u6267\u884c\u5b8c\u6240\u6709\u4efb\u52a1\uff0cansible\u7aef\u624d\u4f1a\u91ca\u653eshell\u3002\u8fd9\u662f\u9ed8\u8ba4\u540c\u6b65\u6a21\u5f0f\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u672a\u6267\u884c\u5b8c\u6bd5\u65f6\uff0cansible\u662f\u5360\u7528\u5f53\u524dshell\u7684\uff0c\u4efb\u52a1\u6267\u884c\u5b8c\u540e\uff0c\u91ca\u653eshell\u4e86\u624d\u53ef\u4ee5\u8f93\u5165\u5176\u4ed6\u547d\u4ee4\u505a\u5176\u4ed6\u52a8\u4f5c\u3002 \u5f02\u6b65\u6a21\u5f0f\uff1a \u00b6 \u5047\u5982fork\u63a7\u5236\u7684\u5e76\u53d1\u8fdb\u7a0b\u6570\u4e3a5\uff0c\u8fdc\u7a0b\u63a7\u5236\u8282\u70b9\u4e3a24\u4e2a\uff0c\u5219ansible\u4e00\u5f00\u59cb\u4f1a\u5c065\u4e2a\u8282\u70b9\u7684\u4efb\u52a1\u6254\u5728\u540e\u53f0\uff0c\u5e76\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53bb\u68c0\u67e5\u8fd9\u4e9b\u8282\u70b9\u7684\u4efb\u52a1\u5b8c\u6210\u60c5\u51b5\uff0c\u5f53\u67d0\u8282\u70b9\u5b8c\u6210\u4e0d\u4f1a\u7acb\u5373\u8fd4\u56de\uff0c\u800c\u662f\u7ee7\u7eed\u7b49\u5f85\u76f4\u52305\u4e2a\u8fdb\u7a0b\u90fd\u7a7a\u95f2\u4e86\uff0c\u624d\u4f1a\u5c06\u8fd95\u4e2a\u8282\u70b9\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9ansible\u7aef\uff0cansible\u4f1a\u7ee7\u7eed\u5c06\u4e0b\u4e00\u62795\u4e2a\u8282\u70b9\u7684\u4efb\u52a1\u6254\u5728\u540e\u53f0\u5e76\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u8fdb\u884c\u68c0\u67e5\uff0c\u4f9d\u6b21\u7c7b\u63a8\uff0c\u76f4\u5230\u5b8c\u6210\u6240\u6709\u4efb\u52a1\u3002 \u5728\u5f02\u6b65\u6a21\u5f0f\u4e0b\uff0c\u5982\u679c\u8bbe\u7f6e\u7684\u68c0\u67e5\u65f6\u95f4\u95f4\u9694\u4e3a0\uff0c\u5728\u5c06\u6bcf\u4e00\u6279\u8282\u70b9\u7684\u4efb\u52a1\u4e22\u5230\u540e\u53f0\u540e\u90fd\u4f1a\u7acb\u5373\u8fd4\u56deansible\uff0c\u5e76\u7acb\u5373\u5c06\u4e0b\u4e00\u6279\u8282\u70b9\u7684\u4efb\u52a1\u4e22\u5230\u540e\u53f0\uff0c\u76f4\u5230\u6240\u6709\u4efb\u52a1\u90fd\u4e22\u5230\u540e\u53f0\u5b8c\u540e\uff0c\u624d\u8fd4\u56deansible\u7aef\uff0cansible\u624d\u4f1a\u7acb\u5373\u91ca\u653e\u5360\u7528\u7684shell\u3002\u5373\u6b64\u65f6ansible\u662f\u4e0d\u4f1a\u7ba1\u5404\u4e2a\u8282\u70b9\u4efb\u52a1\u6267\u884c\u60c5\u51b5\u7684\uff0c\u4e0d\u7ba1\u6267\u884c\u6210\u529f\u6216\u5931\u8d25\u3002\u56e0\u6b64\u5728\u8f6e\u8bad\u68c0\u67e5\u65f6\u95f4\u5185\uff0cansible\u4ecd\u7136\u6b63\u5728\u8fd0\u884c(\u5c3d\u7ba1\u67d0\u6279\u4efb\u52a1\u5df2\u7ecf\u88ab\u653e\u5230\u540e\u53f0\u6267\u884c\u4e86)\uff0c\u5f53\u524dshell\u8fdb\u7a0b\u4ecd\u88ab\u5360\u7528\u5904\u4e8e\u7761\u7720\u72b6\u6001\uff0c\u53ea\u6709\u6307\u5b9a\u7684\u68c0\u67e5\u65f6\u95f4\u95f4\u9694\u4e3a0\uff0c\u624d\u4f1a\u5c3d\u5feb\u5c06\u6240\u6709\u4efb\u52a1\u653e\u5230\u540e\u53f0\u5e76\u91ca\u653eshell\u3002 \u4e00\u3001Ansible\u7684\u5f02\u6b65\u548c\u8f6e\u8be2 [async\u3001poll] \u00b6 Ansible\u6709\u65f6\u5019\u8981\u6267\u884c\u7b49\u5f85\u65f6\u95f4\u5f88\u957f\u7684\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u53ef\u80fd\u8981\u6301\u7eed\u5f88\u957f\u65f6\u95f4\uff0c\u8bbe\u7f6e\u8d85\u8fc7ssh\u7684timeout\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u53ef\u4ee5\u9009\u62e9\u5728step\u4e2d\u6307\u5b9aasync\u548cpoll\u6765\u5b9e\u73b0\u5f02\u6b65\u64cd\u4f5c\u3002\u5176\u4e2d\uff1a async\uff1a\u8868\u793a\u8fd9\u4e2astep\u7684\u6700\u957f\u7b49\u5f85\u65f6\u957f, \u5982\u679c\u8bbe\u7f6e\u4e3a0, \u8868\u793a\u4e00\u76f4\u7b49\u5f85\u4e0b\u53bb\u76f4\u5230\u52a8\u4f5c\u5b8c\u6210\uff1b poll\uff1a\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f\u3002 ansible\u9ed8\u8ba4\u7684\u6e05\u5355\u6587\u4ef6\u662f/etc/ansible/hosts\uff0c\u4e5f\u5c31\u662fansible\u548cansible-ploybook\u6267\u884c\u65f6\u9ed8\u8ba4\u8bfb\u7684\u6e05\u5355\u6587\u4ef6\u3002\u8fd9\u4e2a\u53ef\u4ee5\u81ea\u884c\u5b9a\u4e49\u3002 [root@hostname ~]# cat /etc/ansible/ansible.cfg|grep inventory #inventory = /etc/ansible/hosts [root@hostname ~]# cat /etc/ansible/hosts|tail -2 [test_server] #\u7ec4\u540d\u6700\u597d\u4e0d\u8981\u4f7f\u7528\"-\"\uff0c\u53ef\u4ee5\u4f7f\u7528\"_\" 172.16.60.241 1\uff09\u5148\u6765\u770b\u4e0b\u9762\u521d\u59cb\u914d\u7f6e [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server tasks : - name : ansible-test shell : sleep 10 #async\u8868\u793a\u4e0a\u8ff0shell\u547d\u4ee4\u7684\u7b49\u5f85\u65f6\u95f4,\u8bbe\u7f6e\u4e3a0\u65f6\u4f1a\u4e00\u76f4\u7b49\u5f85\u547d\u4ee4\u7ed3\u675f async : 5 #poll\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f,\u8bbe\u7f6e\u4e3a0\u8868\u793a \u4e0d\u7528\u7b49\u5f85\u7ed3\u679c,\u7ee7\u7eed\u505a\u4e0b\u9762\u7684\u64cd\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u9762\u7684step\u4e2d\u6765\u9a8c\u8bc1\u8fd9\u4e2a\u547d\u4ee4\u662f\u5426\u6210\u529f\u6267\u884c. poll : 2 \u6267\u884c\u4e0b\u770b\u770b\u662f\u5426\u6210\u529f\uff1a [root@hostname ~]# ansible-playbook /etc/ansible/test.yml PLAY [test_server] ******************************************************************************************************************************* TASK [Gathering Facts] *************************************************************************************************************************** ok: [172.16.60.241] TASK [ansible-test] ****************************************************************************************************************************** fatal: [172.16.60.241]: FAILED! => {\"changed\": false, \"msg\": \"async task did not complete within the requested time - 5s\"} PLAY RECAP *************************************************************************************************************************************** 172.16.60.241 : ok=1 changed=0 unreachable=0 failed=1 skipped=0 rescued=0 ignored=0 \u5982\u4e0a\uff0c\u8fd9\u4e2astep\u5931\u8d25, \u56e0\u4e3aansible\u7684\u4efb\u52a1(\u5c31\u662f\u4e0a\u9762\u914d\u7f6e\u4e2d\u7684shell\u52a8\u4f5c)\u64cd\u4f5c\u65f6\u95f4(10s)\u8d85\u8fc7\u4e86\u6700\u5927\u7b49\u5f85\u65f6\u957f(5s) 2\uff09\u5982\u679c\u5c06\u4e0a\u9762\u7684async\u5f02\u6b65\u7b49\u5f85\u65f6\u95f4\u8bbe\u7f6e\u4e3a\u5927\u4e8e10s\uff0c\u6bd4\u598212s\uff0c\u5219\u6267\u884c\u5c31\u6210\u529f\u4e86\uff01 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server tasks : - name : ansible-test shell : sleep 10 #async\u8868\u793a\u4e0a\u8ff0shell\u547d\u4ee4\u7684\u7b49\u5f85\u65f6\u95f4,\u8bbe\u7f6e\u4e3a0\u65f6\u4f1a\u4e00\u76f4\u7b49\u5f85\u547d\u4ee4\u7ed3\u675f async : 12 #poll\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f,\u8bbe\u7f6e\u4e3a0\u8868\u793a \u4e0d\u7528\u7b49\u5f85\u7ed3\u679c,\u7ee7\u7eed\u505a\u4e0b\u9762\u7684\u64cd\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u9762\u7684step\u4e2d\u6765\u9a8c\u8bc1\u8fd9\u4e2a\u547d\u4ee4\u662f\u5426\u6210\u529f\u6267\u884c. poll : 2 [root@hostname ~]# ansible-playbook /etc/ansible/test.yml PLAY [test_server] ******************************************************************************************************************************* TASK [Gathering Facts] *************************************************************************************************************************** ok: [172.16.60.241] TASK [ansible-test] ****************************************************************************************************************************** changed: [172.16.60.241] PLAY RECAP *************************************************************************************************************************************** 172.16.60.241 : ok=2 changed=1 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 \u8fd9\u65f6\u5019\u5c31\u4e0d\u6015\u4efb\u52a1\u8d85\u65f6\u4e86\u3002\u53ef\u4ee5\u6267\u884c\u4e00\u4e2a12s\u7684\u4efb\u52a1\uff08\u5927\u4e8e\u4e0a\u9762shell\u6267\u884c\u7684\u65f6\u95f4\uff09\u3002\u53e6\u5916\uff0c\u5982\u679cpoll\u4e3a0\uff0c\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e0d\u5173\u5fc3\u7ed3\u679c\u7684\u4efb\u52a1\u3002 3\uff09\u6216\u8005\u5c06\u4e0a\u9762\u7684poll\u6570\u503c\u8bbe\u7f6e\u4e3a0\uff0c\u5373\u4e0d\u7528\u7b49\u5f85ansible\u4efb\u52a1\u6267\u884c\u7684\u7ed3\u679c\uff0c\u7acb\u5373\u6267\u884c\u4e0b\u4e00\u4e2astep\u3002 \u5373\u53ea\u9700\u8981\u5c06\u4efb\u52a1\u547d\u4ee4\u63a8\u9001\u5230ansible\u5ba2\u6237\u673a\u4e0a\uff0c\u4e0d\u9700\u8981\u7b49\u5f85\u4efb\u52a1\u6267\u884c\u5b8c\u6210\u5c31\u7acb\u5373\u6267\u884c\u4e0b\u4e00\u4e2astep\u3002 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server tasks : - name : ansible-test shell : sleep 10 #async\u8868\u793a\u4e0a\u8ff0shell\u547d\u4ee4\u7684\u7b49\u5f85\u65f6\u95f4,\u8bbe\u7f6e\u4e3a0\u65f6\u4f1a\u4e00\u76f4\u7b49\u5f85\u547d\u4ee4\u7ed3\u675f async : 5 #poll\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f,\u8bbe\u7f6e\u4e3a0\u8868\u793a \u4e0d\u7528\u7b49\u5f85\u7ed3\u679c,\u7ee7\u7eed\u505a\u4e0b\u9762\u7684\u64cd\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u9762\u7684step\u4e2d\u6765\u9a8c\u8bc1\u8fd9\u4e2a\u547d\u4ee4\u662f\u5426\u6210\u529f\u6267\u884c. poll : 0 [root@hostname ~]# ansible-playbook /etc/ansible/test.yml PLAY [test_server] ******************************************************************************************************************************* TASK [Gathering Facts] *************************************************************************************************************************** ok: [172.16.60.241] TASK [ansible-test] ****************************************************************************************************************************** changed: [172.16.60.241] PLAY RECAP *************************************************************************************************************************************** 172.16.60.241 : ok=2 changed=1 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 4\uff09\u5982\u679c\u8fd8\u60f3\u8981\u66f4\u65b9\u4fbf\u5730\u770b\u8f6e\u8be2\u7ed3\u679c\uff0cansible\u8fd8\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u6a21\u5757async_status\u3002 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server tasks : - name : ansible-test shell : sleep 3 async : 8 poll : 2 register: kevin_result - name: 'check ansible-test task polling results ' async_status: jid={{ kevin_result.ansible_job_id }} register: job_result until: job_result.finished retries: 10 [root@hostname ~]# ansible-playbook /etc/ansible/test.yml PLAY [test_server] ******************************************************************************************************************************* TASK [Gathering Facts] *************************************************************************************************************************** ok: [172.16.60.241] TASK [ansible-test] ****************************************************************************************************************************** changed: [172.16.60.241] TASK [check ansible-test task polling results] *************************************************************************************************** changed: [172.16.60.241] PLAY RECAP *************************************************************************************************************************************** 172.16.60.241 : ok=3 changed=2 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 \u7b2c\u4e00\u4e2ajob\u6267\u884c\u5f02\u6b65\u4efb\u52a1sleep\uff0c\u5e76\u4e14\u6ce8\u518c\u4e86\u4e00\u4e2a\u540d\u5b57\u53ebkevin-result\u7684register\u53d8\u91cf\uff0c\u7528\u4e8e\u63d0\u4f9b\u7ed9\u7b2c\u4e8c\u4e2ajob\u4f5c\u4e3a\u8f6e\u8be2\u5bf9\u8c61\uff0c\u5e76\u4e14\u5b83\u81ea\u5df1poll\u8bbe\u4e3a2 (\u5373\u81ea\u5df1\u8f6e\u8be22\u6b21)\u3002 register\u7528\u4e8e\u5728ansible\u7684playbook\u4e2dtask\u4e4b\u95f4\u7684\u76f8\u4e92\u4f20\u9012\u53d8\u91cf\uff0c register \u8fd9\u4e2a\u529f\u80fd\u975e\u5e38\u6709\u7528\u3002\u5f53\u6211\u4eec\u9700\u8981\u5224\u65ad\u5bf9\u6267\u884c\u4e86\u67d0\u4e2a\u64cd\u4f5c\u6216\u8005\u67d0\u4e2a\u547d\u4ee4\u540e\uff0c\u5982\u4f55\u505a\u76f8\u5e94\u7684\u54cd\u5e94\u5904\u7406\uff08\u6267\u884c\u5176\u4ed6 ansible \u8bed\u53e5\uff09\uff0c\u5219\u4e00\u822c\u4f1a\u7528\u5230register \u3002 until\u8868\u793a\u5faa\u73af\u3002 \u7b2c\u4e8c\u4e2ajob\u4f7f\u7528async_status\u6a21\u5757\uff0c\u8fdb\u884c\u8f6e\u8be2\u5e76\u8fd4\u56de\u8f6e\u8be2\u7ed3\u679c\u3002\u51c6\u5907\u68c0\u67e510\u6b21\u3002 async \u53c2\u6570\u503c\uff1a\u4ee3\u8868\u4e86\u8fd9\u4e2a\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u7684\u4e0a\u9650\u503c\u3002\u5373\u4efb\u52a1\u6267\u884c\u6240\u7528\u65f6\u95f4\u5982\u679c\u8d85\u51fa\u8fd9\u4e2a\u65f6\u95f4\uff0c\u5219\u8ba4\u4e3a\u4efb\u52a1\u5931\u8d25\u3002\u6b64\u53c2\u6570\u82e5\u672a\u8bbe\u7f6e\uff0c\u5219\u4e3a\u540c\u6b65\u6267\u884c\u3002 poll \u53c2\u6570\u503c\uff1a\u4ee3\u8868\u4e86\u4efb\u52a1\u5f02\u6b65\u6267\u884c\u65f6\u8f6e\u8be2\u7684\u65f6\u95f4\u95f4\u9694\u3002 \u4e8c\u3001Ansible\u7684\u5e76\u53d1\u9650\u5236 [serial\u3001max_fail_percentage] \u00b6 \u5f53ansible\u6e05\u5355\u6587\u4ef6\u91cc\u8bbe\u7f6e\u7684\u7ec4\u91cc\u6709\u5f88\u591a\u673a\u5668\uff0c\u53ef\u4ee5\u9650\u5236\u4e00\u4e0bansible\u4efb\u52a1\u7684\u5e76\u53d1\u3002ansible\u7684\u5e76\u53d1\u529f\u80fd\u53ef\u4ee5\u5728ansible.cfg\u91cc\u4fee\u6539\u914d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u5728playbook\u4e2d\u9650\u5236\u670d\u52a1\u7aef\u7684\u5e76\u53d1\u6570\u91cf\uff0c\u8fd9\u662fansible\u7ecf\u5e38\u7528\u5230\u7684\u4e00\u4e2a\u5173\u952e\u529f\u80fd\u3002ansible\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ea\u4f1a\u521b\u5efa5\u4e2a\u8fdb\u7a0b\uff0c\u6240\u4ee5\u4e00\u6b21\u4efb\u52a1\u53ea\u80fd\u540c\u65f6\u63a7\u52365\u53f0\u673a\u5668\u6267\u884c\u3002\u5982\u679c\u6709\u5927\u91cf\u7684\u673a\u5668\u9700\u8981\u63a7\u5236\uff0c\u6216\u8005\u5e0c\u671b\u51cf\u5c11\u8fdb\u7a0b\u6570\uff0c\u90a3\u5c31\u53ef\u4ee5\u91c7\u53d6\u5f02\u6b65\u6267\u884c\uff08async\uff09\uff0cansible\u7684\u6a21\u5757\u53ef\u4ee5\u628atask\u653e\u8fdb\u540e\u53f0\uff0c\u7136\u540e\u8f6e\u8be2\u5b83\uff08poll\uff09\u3002 \u4f7f\u7528async\u548cpoll\u8fd9\u4e24\u4e2a\u5173\u952e\u5b57\u4fbf\u53ef\u4ee5\u5e76\u884c\u8fd0\u884c\u4e00\u4e2a\u4efb\u52a1\uff0c\u5373\u5728\u6240\u6709\u673a\u5668\u4e0a\u4e00\u6b21\u6027\u8fd0\u884c\u3002async\u8fd9\u4e2a\u5173\u952e\u5b57\u4f1a\u89e6\u53d1ansible\u5e76\u884c\u8fd0\u4f5c\u4efb\u52a1\uff0casync\u7684\u503c\u662fansible\u7b49\u5f85\u8fd0\u884c\u8fd9\u4e2a\u4efb\u52a1\u7684\u6700\u5927\u8d85\u65f6\u503c(\u5982\u679c\u6267\u884c\u8d85\u65f6\u4efb\u52a1\u4f1a\u5f3a\u5236\u4e2d\u65ad\u5bfc\u81f4\u5931\u8d25)\uff0c\u800cpoll\u5c31\u662fansible\u68c0\u67e5\u8fd9\u4e2a\u4efb\u52a1\u662f\u5426\u5b8c\u6210\u7684\u9891\u7387\u65f6\u95f4\u3002 1) serial\u53c2\u6570\u8bbe\u7f6e\u5e76\u53d1\u6570 ===================================================================== \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c ansible\u4f1a\u540c\u65f6\u5728\u6240\u6709\u670d\u52a1\u5668\u4e0a\u6267\u884c\u7528\u6237\u5b9a\u4e49\u7684\u64cd\u4f5c\uff0c \u4f46\u662f\u7528\u6237\u53ef\u4ee5\u901a\u8fc7serial\u53c2\u6570\u6765\u5b9a\u4e49\u540c\u65f6\u53ef\u4ee5\u5728\u591a\u5c11\u592a\u673a\u5668\u4e0a\u6267\u884c\u64cd\u4f5c\u3002 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server serial: 3 tasks : - name: Install telnet yum: name=telnet state=installed \u5373test_server\u7ec4\u5185\u76843\u53f0\u673a\u5668\u5b8c\u5168\u6267\u884c\u5b8c\u6210play\u540e\uff0c \u5176\u4ed6\u673a\u5668\u624d\u80fd\u5f00\u59cb\u6267\u884c\u3002 \u63a5\u7740\u770b\u4e0b\u9762\u7684\u914d\u7f6e [root@hostname ~]# cat /etc/ansible/test.yml - hosts : all serial: 7 tasks : - name: Install telnet yum: name=telnet state=installed - name : Run Serverstart.sh command : /bin/bash /opt/scripts/Serverstart.sh async : 300 poll : 10 register: kevin_result \u5982\u4e0a\u914d\u7f6e\uff0c\u53d1\u73b0\u5f53ansible\u914d\u7f6e\u63a7\u5236\u8d85\u8fc75\u53f0\u673a\u5668\u65f6\uff0c\u4e0a\u9762ansible\u4e2d\uff1a a\uff09yum\u6a21\u5757\u4f1a\u5148\u57285\u53f0\u673a\u5668\u4e0a\u8dd1\uff0c\u5b8c\u6210\u540e\u518d\u7ee7\u7eed\u5269\u4f592\u53f0\u7684\u673a\u5668\uff1b b\uff09command\u6a21\u5757\u7684\u4efb\u52a1\u4f1a\u4e00\u6b21\u6027\u5728\u6240\u6709\u673a\u5668\u4e0a\u90fd\u6267\u884c\u4e86\uff0c\u7136\u540e\u76d1\u542c\u5b83\u7684\u56de\u8c03\u7ed3\u679c\uff1b \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u4e0b\u9762\u4e24\u79cd\u60c5\u51b5 a\uff09\u60c5\u51b5\u4e00\uff1a \u8bbe\u7f6epoll=0 \u5982\u679c\u4e0a\u9762command\u6a21\u5757\u662f\u63a7\u5236\u673a\u5668\u5f00\u542f\u4e00\u4e2a\u8fdb\u7a0b\u653e\u5230\u540e\u53f0,\u90a3\u5c31\u4e0d\u9700\u8981\u68c0\u67e5\u8fd9\u4e2a\u4efb\u52a1\u662f\u5426\u5b8c\u6210\u4e86\uff0c\u53ea\u9700\u8981\u7ee7\u7eed\u5176\u4ed6\u7684\u52a8\u4f5c, \u6700\u540e\u518d\u4f7f\u7528wait_for\u8fd9\u4e2a\u6a21\u5757\u53bb\u68c0\u67e5\u4e4b\u524d\u7684\u8fdb\u7a0b\u662f\u5426\u6309\u9884\u671f\u4e2d\u5f00\u542f\u4e86\u4fbf\u53ef\u3002 \u8fd9\u65f6\u53ea\u9700\u8981\u628apoll\u8fd9\u4e2a\u503c\u8bbe\u7f6e\u4e3a0, \u4fbf\u53ef\u4ee5\u6309\u4e0a\u9762\u7684\u8981\u6c42\u914d\u7f6eansible\u4e0d\u7b49\u5f85job\u7684\u5b8c\u6210\u3002 b\uff09\u60c5\u51b5\u4e8c\uff1a \u8bbe\u7f6easync=0 \u5982\u679c\u6709\u4e00\u79cd\u9700\u6c42\u662f\u6709\u4e00\u4e2atask\u5b83\u662f\u9700\u8981\u8fd0\u884c\u5f88\u957f\u7684\u65f6\u95f4,\u90a3\u5c31\u9700\u8981\u8bbe\u7f6e\u4e00\u76f4\u7b49\u5f85\u8fd9\u4e2ajob\u5b8c\u6210\u3002 \u8fd9\u4e2a\u65f6\u5019\u53ea\u9700\u8981\u628aasync\u7684\u503c\u8bbe\u62100\u4fbf\u53ef\u3002 \u7b80\u5355\u603b\u7ed3\u4e0b\uff0c\u9002\u5408\u4f7f\u7528\u5230ansible\u7684polling\u7279\u6027\u7684\u573a\u666f - \u6709\u4e00\u4e2atask\u9700\u8981\u8fd0\u884c\u5f88\u957f\u7684\u65f6\u95f4,\u8fd9\u4e2atask\u5f88\u53ef\u80fd\u4f1a\u8fbe\u5230timeout\uff1b - \u6709\u4e00\u4e2a\u4efb\u52a1\u9700\u8981\u5728\u5927\u91cf\u7684\u673a\u5668\u4e0a\u9762\u8fd0\u884c\uff1b - \u6709\u4e00\u4e2a\u4efb\u52a1\u662f\u4e0d\u9700\u8981\u7b49\u5f85\u5b83\u5b8c\u6210\u7684\uff1b \u4e0d\u9002\u5408\u4f7f\u7528polling\u7279\u6027\u7684\u573a\u666f - task\u4efb\u52a1\u662f\u9700\u8981\u8fd0\u884c\u5b8c\u540e\u624d\u80fd\u7ee7\u7eed\u53e6\u5916\u7684\u4efb\u52a1\u7684\uff1b - task\u4efb\u52a1\u80fd\u5f88\u5feb\u7684\u5b8c\u6210\uff1b 2) max_fail_percentage\uff1a\u6700\u5927\u5931\u8d25\u767e\u5206\u6bd4 ===================================================================== \u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u53ea\u8981ansible\u7684group\u4e2d\u8fd8\u6709server\u6ca1\u6709\u5931\u8d25, ansible\u5c31\u662f\u7ee7\u7eed\u6267\u884ctasks\u3002\u5b9e\u9645\u4e0a, \u7528\u6237\u53ef\u4ee5\u901a\u8fc7max_fail_percentage\uff08\u6700\u5927\u5931\u8d25\u767e\u5206\u6bd4\uff09\u6765\u9650\u5236ansible\u7684\u5e76\u53d1\u6267\u884c\u3002 \u53ea\u8981\u8d85\u8fc7max_fail_percentage\u7684server\u5931\u8d25, ansible\u5c31\u53ef\u4ee5\u4e2d\u6b62tasks\u7684\u6267\u884c\u3002serial\u53c2\u6570\u5728ansible-1.8\u4ee5\u540e\u5c31\u5f00\u59cb\u652f\u6301\u767e\u5206\u6bd4\u529f\u80fd\u4e86\uff01\uff01 \u8bd5\u60f3\u4e00\u4e0b\u5982\u679cgroup\u7ec4\u91cc\u6709200\u53f0\u673a\u5668\uff0c\u90a3\u4e48\u5982\u679c\u4f7f\u7528serial\u6765\u9650\u5236\u5e76\u53d1\u6570\u91cf\uff0c\u6bd4\u5982\u8bbe\u7f6eserial=10\uff0c\u610f\u601d\u5c31\u662f\u4e00\u6b21\u53ea\u6267\u884c10\u53f0\uff0c\u4e00\u76f4\u5230200\u53f0\u5b8c\u6210\u3002 \u53ea\u8981\u7ec4\u5185\u8fd8\u6709server\u6ca1\u6709\u5931\u8d25, ansible\u5c31\u662f\u7ee7\u7eed\u6267\u884ctasks\u3002\u8fd9\u6837\u5c31\u663e\u5f97\u6548\u7387\u5f88\u4f4e\u4e86\uff0c\u5f88\u4e0d\u65b9\u4fbf\uff01\u8fd9\u65f6\u5c31\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u63a7\u5236\u6d41\u7684max_fail_percentage\u529f\u80fd\u4e86\uff01\uff01 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : all max_fail_percentage: 30 serial: 10 tasks : - name: Install telnet yum: name=telnet state=installed - name : Run Serverstart.sh command : /bin/bash /opt/scripts/Serverstart.sh async : 300 poll : 10 register: kevin_result \u5982\u4e0a\u914d\u7f6e\uff0c\u537310\u53f0\u673a\u5668\u91cc\u670930%\u7684\u673a\u5668\u6267\u884cyum\u6a21\u5757\u7684task\u4efb\u52a1\u5931\u8d25\uff0c\u90a3\u4e48\u5c31\u7ec8\u6b62\u8fd9\u4e2a10\u53f0\u673a\u5668\u7684task\u4efb\u52a1\u7684\u6267\u884c\uff0c\u63a5\u7740\u6267\u884c\u4e0b\u4e00\u7ec410\u53f0\u673a\u5668\u7684task\u4efb\u52a1\uff0c\u8fd9\u6837\u6548\u679c\u5c31\u5f88\u68d2\u4e86\u3002 \u6e29\u99a8\u63d0\u793a\uff1a \u5b9e\u9645\u5931\u8d25\u673a\u5668\u5fc5\u987b\u5927\u4e8e\u8fd9\u4e2a\u767e\u5206\u6bd4\u65f6, tasks\u4efb\u52a1\u624d\u4f1a\u88ab\u4e2d\u6b62\uff1b\u5982\u679c\u7b49\u4e8e\u8fd9\u4e2a\u767e\u5206\u6bd4\u65f6\uff0ctask\u4efb\u52a1\u662f\u4e0d\u4f1a\u88ab\u7ec8\u6b62\u7684\uff01 \u8e29\u5751\u7ecf\u9a8c\uff1aAnsible\u5e76\u53d1\u5931\u8d25\uff08fork=100. \u4f46\u662f\u771f\u6b63\u6267\u884cplaybook\u65f6\u5e76\u6ca1\u6709\u5b9e\u73b0\u5e76\u53d1\uff09 [root@hostname ~]# cd /usr/lib/python2.7/site-packages/ansible/ [root@hostname ansible]# find . -name ssh.py ./plugins/connection/ssh.py [root@hostname ansible]# vim plugins/connection/ssh.py ......... ......... if C.HOST_KEY_CHECKING and not_in_host_file: # lock around the initial SSH connectivity so the user prompt about whether to add # the host to known hosts is not intermingled with multiprocess output. fcntl.lockf(self.runner.process_lockfile, fcntl.LOCK_EX) fcntl.lockf(self.runner.output_lockfile, fcntl.LOCK_EX) # create process (p, stdin) = self._run(ssh_cmd, in_data) ......... ......... \u901a\u8fc7\u4ee5\u4e0a\u6587\u4ef6\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff1a \u5982\u679cansible\u914d\u7f6e\"HOST_KEY_CHECKING=True\", \u5e76\u4e14ansible\u5ba2\u6237\u673a\u4fe1\u606f\u6ca1\u6709\u5728ansible\u670d\u52a1\u7aef\u7684~/.ssh/known_hosts\u91cc\u9762, \u4e00\u4e2a\u8fdb\u7a0b\u5c31\u4f1a\u9501\u6b7b~/.ssh/known_hosts\u6587\u4ef6\u3002 \u8fd9\u6837ansible\u5c31\u4e0d\u80fd\u5b9e\u73b0\u5e76\u53d1\uff01 \u89e3\u51b3\u65b9\u6848: \u5728ansible\u670d\u52a1\u7aef\u7684/etc/ansible/ansible.cfg\u6587\u4ef6\u91cc\u914d\u7f6e\"host_key_checking = False\" [\u5176\u5b9eansible.cfg\u6587\u4ef6\u91cc\u8be5\u9879\u9ed8\u8ba4\u914d\u7f6e\u7684\u5c31\u662fFalse] \u4e09\u3001Ansible\u7684\u4efb\u52a1\u59d4\u6258 [delegate_to\u3001delegate_facts\u3001run_once] \u00b6 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cansible\u7684\u6240\u6709\u4efb\u52a1\u90fd\u662f\u5728\u6307\u5b9a\u7684\u673a\u5668\u4e0a\u8fd0\u884c\u7684\u3002\u5f53\u5728\u4e00\u4e2a\u72ec\u7acb\u7684\u7fa4\u96c6\u73af\u5883\u4e2d\u914d\u7f6e\u65f6\uff0c\u53ea\u662f\u60f3\u64cd\u4f5c\u5176\u4e2d\u7684\u67d0\u4e00\u53f0\u4e3b\u673a\uff0c\u6216\u8005\u5728\u7279\u5b9a\u7684\u4e3b\u673a\u4e0a\u8fd0\u884ctask\u4efb\u52a1\uff0c\u6b64\u65f6\u5c31\u9700\u8981\u7528\u5230ansible\u7684\u4efb\u52a1\u59d4\u6258\u529f\u80fd\u3002\u4f7f\u7528delegate_to\u5173\u952e\u5b57\u53ef\u4ee5\u914d\u7f6etask\u4efb\u52a1\u5728\u6307\u5b9a\u7684\u673a\u5668\u4e0a\u6267\u884c\uff0c\u5c31\u662f\u8bf4\u5176\u4ed6\u7684task\u4efb\u52a1\u8fd8\u662f\u5728hosts\u5173\u952e\u5b57\u914d\u7f6e\u7684\u673a\u5668\u4e0a\u8fd0\u884c\uff0c\u5230\u4e86\u8fd9\u4e2a\u5173\u952e\u5b57\u6240\u5728\u7684\u4efb\u52a1\u65f6\uff0c\u5c31\u4f7f\u7528\u59d4\u6258\u7684\u673a\u5668\u8fd0\u884c\u3002 1\uff09\u59d4\u6258 ===================================================================== \u901a\u8fc7\"delegate_to\", ansible\u53ef\u4ee5\u628a\u67d0\u4e00\u4e2atask\u4efb\u52a1\u653e\u5728\u59d4\u6258\u7684\u673a\u5668\u4e0a\u6267\u884c\u3002\u5373\u5728\u6307\u5b9a\u7684\u7ec4\u5185\u7684\u67d0\u4e00\u53f0\u6216\u591a\u53f0\u673a\u5668\u4e0a\u6267\u884ctask\u4efb\u52a1\u3002 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server serial: 10 tasks : - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: 172.16.60.245 \u5219\u4e0a\u9762\u7684shell\u6a21\u5757\u7684task\u4efb\u52a1\u53ea\u4f1a\u5728172.16.60.245\u8fd9\u53f0\u8282\u70b9\u4e0a\u6267\u884c\uff0ctest_server\u7ec4\u5185\u5176\u4ed6\u7684\u673a\u5668\u4e0d\u4f1a\u6267\u884cshell\u4efb\u52a1\u3002 --------------------- \u5982\u679c \"delegate_to: 127.0.0.1\" \u5219\u53ef\u4ee5\u7528local_action\u6765\u4ee3\u66ff\u3002\u5373\u4e0b\u9762\u4e24\u4e2a\u914d\u7f6e\u6548\u679c\u662f\u4e00\u6837\u7684\uff01\uff01 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server serial: 10 tasks : - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: 127.0.0.1 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server serial: 10 tasks : - name: test-haha local_action: shell echo \"test\" > /root/test.list ------------------- \u5982\u679c\u8bbe\u7f6e\u4e86\u591a\u4e2adelegate_to\uff0c\u5219\u6267\u884c\u65f6\u53ea\u4f1a\u5339\u914d\u6700\u4e0b\u9762\u90a3\u4e2a\u3002 \u4f8b\u5982\u4e0b\u9762\u914d\u7f6e\u4e2d\uff0c\u53ea\u4f1a\u6267\u884c\"delegate_to: 172.16.60.245\", \u4e0a\u9762\u90a3\u4e2a\"delegate_to: 172.16.60.241\"\u5c31\u4f1a\u88ab\u5ffd\u7565\u4e86\u3002 [root@hostname ansible]# cat /etc/ansible/test.yml - hosts : all serial: 10 tasks : - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: 172.16.60.241 delegate_to: 172.16.60.245 ------------------- delegate_to\u9ed8\u8ba4\u540e\u9762\u53ea\u80fd\u8ddf\u4e00\u4e2a\u4e3b\u673aip\uff0c\u4e0d\u80fd\u8ddf\u591a\u4e2a\u4e3b\u673aip\u3002\u5373\u9ed8\u8ba4\u59d4\u6258\u5230\u5355\u4e2a\u4e3b\u673a\u3002 \u5982\u679c\u6709\u591a\u4e2aip\u9700\u8981\u59d4\u6258\uff0c\u5219\u53ef\u4ee5\u5c06\u8fd9\u4e9bip\u91cd\u65b0\u653e\u4e00\u4e2agroup\uff0c\u7136\u540edelegate_to\u59d4\u6258\u7ed9group\u7ec4\u3002 delegate_to\u59d4\u6258\u5230\u7ec4\u7684\u65b9\u5f0f\uff1a\u901a\u8fc7items\u53d8\u91cf\u65b9\u5f0f\uff01\uff01\uff01 [root@hostname ansible]# cat /etc/ansible/hosts |tail -8 [test_server] 172.16.60.241 172.16.60.245 172.16.60.246 127.0.0.1 [kevin_server] 172.16.60.246 127.0.0.1 [root@hostname ansible]# cat /etc/ansible/test.yml - hosts: all tasks: - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: \"{{item}}\" with_items: \"{{groups['kevin_server']}}\" \u5373\u5c06shell\u8fd9\u4e2atask\u4efb\u52a1\u59d4\u6258\u7ed9kevin_server\u7ec4\u5185\u7684\u673a\u5668\u6267\u884c\u3002 2\uff09\u59d4\u6258\u8005\u7684facts ===================================================================== \u9ed8\u8ba4\u60c5\u51b5\u4e0b, ansible\u59d4\u6258\u4efb\u52a1\u7684facts\u662finventory_hostname\u4e2d\u4e3b\u673a\u7684facts, \u800c\u4e0d\u662f\u88ab\u59d4\u6258\u673a\u5668\u7684facts\u3002 a) delegate_facts \u5728ansible 2.0 \u4e2d, \u901a\u8fc7\u8bbe\u7f6e\"delegate_facts: True\"\u53ef\u4ee5\u8ba9task\u4efb\u52a1\u53bb\u6536\u96c6\u88ab\u59d4\u6258\u673a\u5668\u7684facts\u3002 [root@hostname ~]# cat /etc/ansible/test.yml - hosts: test_server tasks: - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: \"{{item}}\" delegate_facts: True with_items: \"{{groups['kevin_server']}}\" \u5982\u4e0a\u914d\u7f6e\uff0c\u8868\u793a\u4f1a\u6536\u96c6kevin_server\u7684facts\u5e76\u5206\u914d\u7ed9\u8fd9\u4e9b\u673a\u5668, \u800c\u4e0d\u4f1a\u53bb\u6536\u96c6test_server\u7684facts b\uff09RUN ONCE \u901a\u8fc7\u8bbe\u7f6e\"run_once: true\"\u6765\u6307\u5b9a\u8be5task\u53ea\u80fd\u5728\u59d4\u6258\u7684\u67d0\u4e00\u53f0\u673a\u5668\u6216\u59d4\u6258\u7684\u7ec4\u5185\u673a\u5668\u4e0a\u6267\u884c\u4e00\u6b21\uff01\uff01\u53ef\u4ee5\u548cdelegate_to \u7ed3\u5408\u4f7f\u7528\u3002 \u5982\u679c\u6ca1\u6709delegate_to, \u90a3\u4e48\u8fd9\u4e2atask\u9ed8\u8ba4\u5c31\u4f1a\u5728\u7b2c\u4e00\u53f0\u673a\u5668\u4e0a\u6267\u884c\uff01\uff01\uff01 [root@hostname ~]# cat /etc/ansible/test.yml - hosts: test_server tasks: - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: \"{{item}}\" run_once: true delegate_facts: True with_items: \"{{groups['kevin_server']}}\"","title":"ansbile_async"},{"location":"ansbile_async/#ansible","text":"\u539f\u6587","title":"Ansible\u5e38\u7528\u529f\u80fd\u8bf4\u660e [\u5f02\u6b65\u3001\u5e76\u53d1\u3001\u59d4\u6258\u7b49]"},{"location":"ansbile_async/#ansible_1","text":"","title":"Ansible\u7684\u540c\u6b65\u6a21\u5f0f\u4e0e\u5f02\u6b65\u6a21\u5f0f"},{"location":"ansbile_async/#_1","text":"\u5982\u679c\u8282\u70b9\u6570\u592a\u591a\uff0cansible\u65e0\u6cd5\u4e00\u6b21\u5728\u6240\u6709\u8fdc\u7a0b\u8282\u70b9\u4e0a\u6267\u884c\u4efb\u52a1\uff0c\u90a3\u4e48\u5c06\u5148\u5728\u4e00\u90e8\u5206\u8282\u70b9\u4e0a\u6267\u884c\u4e00\u4e2a\u4efb\u52a1(\u6bcf\u4e00\u6279\u8282\u70b9\u7684\u6570\u91cf\u53d6\u51b3\u4e8efork\u8fdb\u7a0b\u6570\u91cf\uff0c\u9ed8\u8ba4\u4e3a5\u4e2a\uff0c\u53ef\u8bbe\u7f6e)\uff0c\u76f4\u5230\u8fd9\u4e00\u6279\u6240\u6709\u8282\u70b9\u4e0a\u8be5\u4efb\u52a1\u5b8c\u5168\u6267\u884c\u5b8c\u6bd5\u624d\u4f1a\u63a5\u5165\u4e0b\u4e00\u4e2a\u6279\u8282\u70b9\uff0c\u76f4\u5230\u6240\u6709\u8282\u70b9\u5c06\u8be5\u4efb\u52a1\u90fd\u6267\u884c\u5b8c\u6bd5\uff0c\u7136\u540e\u91cd\u65b0\u56de\u5230\u7b2c\u4e00\u6279\u8282\u70b9\u5f00\u59cb\u6267\u884c\u7b2c\u4e8c\u4e2a\u4efb\u52a1\u3002\u4f9d\u6b21\u7c7b\u63a8\uff0c\u76f4\u5230\u6240\u6709\u8282\u70b9\u6267\u884c\u5b8c\u6240\u6709\u4efb\u52a1\uff0cansible\u7aef\u624d\u4f1a\u91ca\u653eshell\u3002\u8fd9\u662f\u9ed8\u8ba4\u540c\u6b65\u6a21\u5f0f\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u672a\u6267\u884c\u5b8c\u6bd5\u65f6\uff0cansible\u662f\u5360\u7528\u5f53\u524dshell\u7684\uff0c\u4efb\u52a1\u6267\u884c\u5b8c\u540e\uff0c\u91ca\u653eshell\u4e86\u624d\u53ef\u4ee5\u8f93\u5165\u5176\u4ed6\u547d\u4ee4\u505a\u5176\u4ed6\u52a8\u4f5c\u3002","title":"\u540c\u6b65\u6a21\u5f0f\uff1a"},{"location":"ansbile_async/#_2","text":"\u5047\u5982fork\u63a7\u5236\u7684\u5e76\u53d1\u8fdb\u7a0b\u6570\u4e3a5\uff0c\u8fdc\u7a0b\u63a7\u5236\u8282\u70b9\u4e3a24\u4e2a\uff0c\u5219ansible\u4e00\u5f00\u59cb\u4f1a\u5c065\u4e2a\u8282\u70b9\u7684\u4efb\u52a1\u6254\u5728\u540e\u53f0\uff0c\u5e76\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53bb\u68c0\u67e5\u8fd9\u4e9b\u8282\u70b9\u7684\u4efb\u52a1\u5b8c\u6210\u60c5\u51b5\uff0c\u5f53\u67d0\u8282\u70b9\u5b8c\u6210\u4e0d\u4f1a\u7acb\u5373\u8fd4\u56de\uff0c\u800c\u662f\u7ee7\u7eed\u7b49\u5f85\u76f4\u52305\u4e2a\u8fdb\u7a0b\u90fd\u7a7a\u95f2\u4e86\uff0c\u624d\u4f1a\u5c06\u8fd95\u4e2a\u8282\u70b9\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9ansible\u7aef\uff0cansible\u4f1a\u7ee7\u7eed\u5c06\u4e0b\u4e00\u62795\u4e2a\u8282\u70b9\u7684\u4efb\u52a1\u6254\u5728\u540e\u53f0\u5e76\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u8fdb\u884c\u68c0\u67e5\uff0c\u4f9d\u6b21\u7c7b\u63a8\uff0c\u76f4\u5230\u5b8c\u6210\u6240\u6709\u4efb\u52a1\u3002 \u5728\u5f02\u6b65\u6a21\u5f0f\u4e0b\uff0c\u5982\u679c\u8bbe\u7f6e\u7684\u68c0\u67e5\u65f6\u95f4\u95f4\u9694\u4e3a0\uff0c\u5728\u5c06\u6bcf\u4e00\u6279\u8282\u70b9\u7684\u4efb\u52a1\u4e22\u5230\u540e\u53f0\u540e\u90fd\u4f1a\u7acb\u5373\u8fd4\u56deansible\uff0c\u5e76\u7acb\u5373\u5c06\u4e0b\u4e00\u6279\u8282\u70b9\u7684\u4efb\u52a1\u4e22\u5230\u540e\u53f0\uff0c\u76f4\u5230\u6240\u6709\u4efb\u52a1\u90fd\u4e22\u5230\u540e\u53f0\u5b8c\u540e\uff0c\u624d\u8fd4\u56deansible\u7aef\uff0cansible\u624d\u4f1a\u7acb\u5373\u91ca\u653e\u5360\u7528\u7684shell\u3002\u5373\u6b64\u65f6ansible\u662f\u4e0d\u4f1a\u7ba1\u5404\u4e2a\u8282\u70b9\u4efb\u52a1\u6267\u884c\u60c5\u51b5\u7684\uff0c\u4e0d\u7ba1\u6267\u884c\u6210\u529f\u6216\u5931\u8d25\u3002\u56e0\u6b64\u5728\u8f6e\u8bad\u68c0\u67e5\u65f6\u95f4\u5185\uff0cansible\u4ecd\u7136\u6b63\u5728\u8fd0\u884c(\u5c3d\u7ba1\u67d0\u6279\u4efb\u52a1\u5df2\u7ecf\u88ab\u653e\u5230\u540e\u53f0\u6267\u884c\u4e86)\uff0c\u5f53\u524dshell\u8fdb\u7a0b\u4ecd\u88ab\u5360\u7528\u5904\u4e8e\u7761\u7720\u72b6\u6001\uff0c\u53ea\u6709\u6307\u5b9a\u7684\u68c0\u67e5\u65f6\u95f4\u95f4\u9694\u4e3a0\uff0c\u624d\u4f1a\u5c3d\u5feb\u5c06\u6240\u6709\u4efb\u52a1\u653e\u5230\u540e\u53f0\u5e76\u91ca\u653eshell\u3002","title":"\u5f02\u6b65\u6a21\u5f0f\uff1a"},{"location":"ansbile_async/#ansible-asyncpoll","text":"Ansible\u6709\u65f6\u5019\u8981\u6267\u884c\u7b49\u5f85\u65f6\u95f4\u5f88\u957f\u7684\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u53ef\u80fd\u8981\u6301\u7eed\u5f88\u957f\u65f6\u95f4\uff0c\u8bbe\u7f6e\u8d85\u8fc7ssh\u7684timeout\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u53ef\u4ee5\u9009\u62e9\u5728step\u4e2d\u6307\u5b9aasync\u548cpoll\u6765\u5b9e\u73b0\u5f02\u6b65\u64cd\u4f5c\u3002\u5176\u4e2d\uff1a async\uff1a\u8868\u793a\u8fd9\u4e2astep\u7684\u6700\u957f\u7b49\u5f85\u65f6\u957f, \u5982\u679c\u8bbe\u7f6e\u4e3a0, \u8868\u793a\u4e00\u76f4\u7b49\u5f85\u4e0b\u53bb\u76f4\u5230\u52a8\u4f5c\u5b8c\u6210\uff1b poll\uff1a\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f\u3002 ansible\u9ed8\u8ba4\u7684\u6e05\u5355\u6587\u4ef6\u662f/etc/ansible/hosts\uff0c\u4e5f\u5c31\u662fansible\u548cansible-ploybook\u6267\u884c\u65f6\u9ed8\u8ba4\u8bfb\u7684\u6e05\u5355\u6587\u4ef6\u3002\u8fd9\u4e2a\u53ef\u4ee5\u81ea\u884c\u5b9a\u4e49\u3002 [root@hostname ~]# cat /etc/ansible/ansible.cfg|grep inventory #inventory = /etc/ansible/hosts [root@hostname ~]# cat /etc/ansible/hosts|tail -2 [test_server] #\u7ec4\u540d\u6700\u597d\u4e0d\u8981\u4f7f\u7528\"-\"\uff0c\u53ef\u4ee5\u4f7f\u7528\"_\" 172.16.60.241 1\uff09\u5148\u6765\u770b\u4e0b\u9762\u521d\u59cb\u914d\u7f6e [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server tasks : - name : ansible-test shell : sleep 10 #async\u8868\u793a\u4e0a\u8ff0shell\u547d\u4ee4\u7684\u7b49\u5f85\u65f6\u95f4,\u8bbe\u7f6e\u4e3a0\u65f6\u4f1a\u4e00\u76f4\u7b49\u5f85\u547d\u4ee4\u7ed3\u675f async : 5 #poll\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f,\u8bbe\u7f6e\u4e3a0\u8868\u793a \u4e0d\u7528\u7b49\u5f85\u7ed3\u679c,\u7ee7\u7eed\u505a\u4e0b\u9762\u7684\u64cd\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u9762\u7684step\u4e2d\u6765\u9a8c\u8bc1\u8fd9\u4e2a\u547d\u4ee4\u662f\u5426\u6210\u529f\u6267\u884c. poll : 2 \u6267\u884c\u4e0b\u770b\u770b\u662f\u5426\u6210\u529f\uff1a [root@hostname ~]# ansible-playbook /etc/ansible/test.yml PLAY [test_server] ******************************************************************************************************************************* TASK [Gathering Facts] *************************************************************************************************************************** ok: [172.16.60.241] TASK [ansible-test] ****************************************************************************************************************************** fatal: [172.16.60.241]: FAILED! => {\"changed\": false, \"msg\": \"async task did not complete within the requested time - 5s\"} PLAY RECAP *************************************************************************************************************************************** 172.16.60.241 : ok=1 changed=0 unreachable=0 failed=1 skipped=0 rescued=0 ignored=0 \u5982\u4e0a\uff0c\u8fd9\u4e2astep\u5931\u8d25, \u56e0\u4e3aansible\u7684\u4efb\u52a1(\u5c31\u662f\u4e0a\u9762\u914d\u7f6e\u4e2d\u7684shell\u52a8\u4f5c)\u64cd\u4f5c\u65f6\u95f4(10s)\u8d85\u8fc7\u4e86\u6700\u5927\u7b49\u5f85\u65f6\u957f(5s) 2\uff09\u5982\u679c\u5c06\u4e0a\u9762\u7684async\u5f02\u6b65\u7b49\u5f85\u65f6\u95f4\u8bbe\u7f6e\u4e3a\u5927\u4e8e10s\uff0c\u6bd4\u598212s\uff0c\u5219\u6267\u884c\u5c31\u6210\u529f\u4e86\uff01 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server tasks : - name : ansible-test shell : sleep 10 #async\u8868\u793a\u4e0a\u8ff0shell\u547d\u4ee4\u7684\u7b49\u5f85\u65f6\u95f4,\u8bbe\u7f6e\u4e3a0\u65f6\u4f1a\u4e00\u76f4\u7b49\u5f85\u547d\u4ee4\u7ed3\u675f async : 12 #poll\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f,\u8bbe\u7f6e\u4e3a0\u8868\u793a \u4e0d\u7528\u7b49\u5f85\u7ed3\u679c,\u7ee7\u7eed\u505a\u4e0b\u9762\u7684\u64cd\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u9762\u7684step\u4e2d\u6765\u9a8c\u8bc1\u8fd9\u4e2a\u547d\u4ee4\u662f\u5426\u6210\u529f\u6267\u884c. poll : 2 [root@hostname ~]# ansible-playbook /etc/ansible/test.yml PLAY [test_server] ******************************************************************************************************************************* TASK [Gathering Facts] *************************************************************************************************************************** ok: [172.16.60.241] TASK [ansible-test] ****************************************************************************************************************************** changed: [172.16.60.241] PLAY RECAP *************************************************************************************************************************************** 172.16.60.241 : ok=2 changed=1 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 \u8fd9\u65f6\u5019\u5c31\u4e0d\u6015\u4efb\u52a1\u8d85\u65f6\u4e86\u3002\u53ef\u4ee5\u6267\u884c\u4e00\u4e2a12s\u7684\u4efb\u52a1\uff08\u5927\u4e8e\u4e0a\u9762shell\u6267\u884c\u7684\u65f6\u95f4\uff09\u3002\u53e6\u5916\uff0c\u5982\u679cpoll\u4e3a0\uff0c\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e0d\u5173\u5fc3\u7ed3\u679c\u7684\u4efb\u52a1\u3002 3\uff09\u6216\u8005\u5c06\u4e0a\u9762\u7684poll\u6570\u503c\u8bbe\u7f6e\u4e3a0\uff0c\u5373\u4e0d\u7528\u7b49\u5f85ansible\u4efb\u52a1\u6267\u884c\u7684\u7ed3\u679c\uff0c\u7acb\u5373\u6267\u884c\u4e0b\u4e00\u4e2astep\u3002 \u5373\u53ea\u9700\u8981\u5c06\u4efb\u52a1\u547d\u4ee4\u63a8\u9001\u5230ansible\u5ba2\u6237\u673a\u4e0a\uff0c\u4e0d\u9700\u8981\u7b49\u5f85\u4efb\u52a1\u6267\u884c\u5b8c\u6210\u5c31\u7acb\u5373\u6267\u884c\u4e0b\u4e00\u4e2astep\u3002 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server tasks : - name : ansible-test shell : sleep 10 #async\u8868\u793a\u4e0a\u8ff0shell\u547d\u4ee4\u7684\u7b49\u5f85\u65f6\u95f4,\u8bbe\u7f6e\u4e3a0\u65f6\u4f1a\u4e00\u76f4\u7b49\u5f85\u547d\u4ee4\u7ed3\u675f async : 5 #poll\u8868\u793a\u68c0\u67e5step\u64cd\u4f5c\u7ed3\u679c\u7684\u95f4\u9694\u65f6\u957f,\u8bbe\u7f6e\u4e3a0\u8868\u793a \u4e0d\u7528\u7b49\u5f85\u7ed3\u679c,\u7ee7\u7eed\u505a\u4e0b\u9762\u7684\u64cd\u4f5c,\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u9762\u7684step\u4e2d\u6765\u9a8c\u8bc1\u8fd9\u4e2a\u547d\u4ee4\u662f\u5426\u6210\u529f\u6267\u884c. poll : 0 [root@hostname ~]# ansible-playbook /etc/ansible/test.yml PLAY [test_server] ******************************************************************************************************************************* TASK [Gathering Facts] *************************************************************************************************************************** ok: [172.16.60.241] TASK [ansible-test] ****************************************************************************************************************************** changed: [172.16.60.241] PLAY RECAP *************************************************************************************************************************************** 172.16.60.241 : ok=2 changed=1 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 4\uff09\u5982\u679c\u8fd8\u60f3\u8981\u66f4\u65b9\u4fbf\u5730\u770b\u8f6e\u8be2\u7ed3\u679c\uff0cansible\u8fd8\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u6a21\u5757async_status\u3002 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server tasks : - name : ansible-test shell : sleep 3 async : 8 poll : 2 register: kevin_result - name: 'check ansible-test task polling results ' async_status: jid={{ kevin_result.ansible_job_id }} register: job_result until: job_result.finished retries: 10 [root@hostname ~]# ansible-playbook /etc/ansible/test.yml PLAY [test_server] ******************************************************************************************************************************* TASK [Gathering Facts] *************************************************************************************************************************** ok: [172.16.60.241] TASK [ansible-test] ****************************************************************************************************************************** changed: [172.16.60.241] TASK [check ansible-test task polling results] *************************************************************************************************** changed: [172.16.60.241] PLAY RECAP *************************************************************************************************************************************** 172.16.60.241 : ok=3 changed=2 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 \u7b2c\u4e00\u4e2ajob\u6267\u884c\u5f02\u6b65\u4efb\u52a1sleep\uff0c\u5e76\u4e14\u6ce8\u518c\u4e86\u4e00\u4e2a\u540d\u5b57\u53ebkevin-result\u7684register\u53d8\u91cf\uff0c\u7528\u4e8e\u63d0\u4f9b\u7ed9\u7b2c\u4e8c\u4e2ajob\u4f5c\u4e3a\u8f6e\u8be2\u5bf9\u8c61\uff0c\u5e76\u4e14\u5b83\u81ea\u5df1poll\u8bbe\u4e3a2 (\u5373\u81ea\u5df1\u8f6e\u8be22\u6b21)\u3002 register\u7528\u4e8e\u5728ansible\u7684playbook\u4e2dtask\u4e4b\u95f4\u7684\u76f8\u4e92\u4f20\u9012\u53d8\u91cf\uff0c register \u8fd9\u4e2a\u529f\u80fd\u975e\u5e38\u6709\u7528\u3002\u5f53\u6211\u4eec\u9700\u8981\u5224\u65ad\u5bf9\u6267\u884c\u4e86\u67d0\u4e2a\u64cd\u4f5c\u6216\u8005\u67d0\u4e2a\u547d\u4ee4\u540e\uff0c\u5982\u4f55\u505a\u76f8\u5e94\u7684\u54cd\u5e94\u5904\u7406\uff08\u6267\u884c\u5176\u4ed6 ansible \u8bed\u53e5\uff09\uff0c\u5219\u4e00\u822c\u4f1a\u7528\u5230register \u3002 until\u8868\u793a\u5faa\u73af\u3002 \u7b2c\u4e8c\u4e2ajob\u4f7f\u7528async_status\u6a21\u5757\uff0c\u8fdb\u884c\u8f6e\u8be2\u5e76\u8fd4\u56de\u8f6e\u8be2\u7ed3\u679c\u3002\u51c6\u5907\u68c0\u67e510\u6b21\u3002 async \u53c2\u6570\u503c\uff1a\u4ee3\u8868\u4e86\u8fd9\u4e2a\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u7684\u4e0a\u9650\u503c\u3002\u5373\u4efb\u52a1\u6267\u884c\u6240\u7528\u65f6\u95f4\u5982\u679c\u8d85\u51fa\u8fd9\u4e2a\u65f6\u95f4\uff0c\u5219\u8ba4\u4e3a\u4efb\u52a1\u5931\u8d25\u3002\u6b64\u53c2\u6570\u82e5\u672a\u8bbe\u7f6e\uff0c\u5219\u4e3a\u540c\u6b65\u6267\u884c\u3002 poll \u53c2\u6570\u503c\uff1a\u4ee3\u8868\u4e86\u4efb\u52a1\u5f02\u6b65\u6267\u884c\u65f6\u8f6e\u8be2\u7684\u65f6\u95f4\u95f4\u9694\u3002","title":"\u4e00\u3001Ansible\u7684\u5f02\u6b65\u548c\u8f6e\u8be2  [async\u3001poll]"},{"location":"ansbile_async/#ansible-serialmax_fail_percentage","text":"\u5f53ansible\u6e05\u5355\u6587\u4ef6\u91cc\u8bbe\u7f6e\u7684\u7ec4\u91cc\u6709\u5f88\u591a\u673a\u5668\uff0c\u53ef\u4ee5\u9650\u5236\u4e00\u4e0bansible\u4efb\u52a1\u7684\u5e76\u53d1\u3002ansible\u7684\u5e76\u53d1\u529f\u80fd\u53ef\u4ee5\u5728ansible.cfg\u91cc\u4fee\u6539\u914d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u5728playbook\u4e2d\u9650\u5236\u670d\u52a1\u7aef\u7684\u5e76\u53d1\u6570\u91cf\uff0c\u8fd9\u662fansible\u7ecf\u5e38\u7528\u5230\u7684\u4e00\u4e2a\u5173\u952e\u529f\u80fd\u3002ansible\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ea\u4f1a\u521b\u5efa5\u4e2a\u8fdb\u7a0b\uff0c\u6240\u4ee5\u4e00\u6b21\u4efb\u52a1\u53ea\u80fd\u540c\u65f6\u63a7\u52365\u53f0\u673a\u5668\u6267\u884c\u3002\u5982\u679c\u6709\u5927\u91cf\u7684\u673a\u5668\u9700\u8981\u63a7\u5236\uff0c\u6216\u8005\u5e0c\u671b\u51cf\u5c11\u8fdb\u7a0b\u6570\uff0c\u90a3\u5c31\u53ef\u4ee5\u91c7\u53d6\u5f02\u6b65\u6267\u884c\uff08async\uff09\uff0cansible\u7684\u6a21\u5757\u53ef\u4ee5\u628atask\u653e\u8fdb\u540e\u53f0\uff0c\u7136\u540e\u8f6e\u8be2\u5b83\uff08poll\uff09\u3002 \u4f7f\u7528async\u548cpoll\u8fd9\u4e24\u4e2a\u5173\u952e\u5b57\u4fbf\u53ef\u4ee5\u5e76\u884c\u8fd0\u884c\u4e00\u4e2a\u4efb\u52a1\uff0c\u5373\u5728\u6240\u6709\u673a\u5668\u4e0a\u4e00\u6b21\u6027\u8fd0\u884c\u3002async\u8fd9\u4e2a\u5173\u952e\u5b57\u4f1a\u89e6\u53d1ansible\u5e76\u884c\u8fd0\u4f5c\u4efb\u52a1\uff0casync\u7684\u503c\u662fansible\u7b49\u5f85\u8fd0\u884c\u8fd9\u4e2a\u4efb\u52a1\u7684\u6700\u5927\u8d85\u65f6\u503c(\u5982\u679c\u6267\u884c\u8d85\u65f6\u4efb\u52a1\u4f1a\u5f3a\u5236\u4e2d\u65ad\u5bfc\u81f4\u5931\u8d25)\uff0c\u800cpoll\u5c31\u662fansible\u68c0\u67e5\u8fd9\u4e2a\u4efb\u52a1\u662f\u5426\u5b8c\u6210\u7684\u9891\u7387\u65f6\u95f4\u3002 1) serial\u53c2\u6570\u8bbe\u7f6e\u5e76\u53d1\u6570 ===================================================================== \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c ansible\u4f1a\u540c\u65f6\u5728\u6240\u6709\u670d\u52a1\u5668\u4e0a\u6267\u884c\u7528\u6237\u5b9a\u4e49\u7684\u64cd\u4f5c\uff0c \u4f46\u662f\u7528\u6237\u53ef\u4ee5\u901a\u8fc7serial\u53c2\u6570\u6765\u5b9a\u4e49\u540c\u65f6\u53ef\u4ee5\u5728\u591a\u5c11\u592a\u673a\u5668\u4e0a\u6267\u884c\u64cd\u4f5c\u3002 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server serial: 3 tasks : - name: Install telnet yum: name=telnet state=installed \u5373test_server\u7ec4\u5185\u76843\u53f0\u673a\u5668\u5b8c\u5168\u6267\u884c\u5b8c\u6210play\u540e\uff0c \u5176\u4ed6\u673a\u5668\u624d\u80fd\u5f00\u59cb\u6267\u884c\u3002 \u63a5\u7740\u770b\u4e0b\u9762\u7684\u914d\u7f6e [root@hostname ~]# cat /etc/ansible/test.yml - hosts : all serial: 7 tasks : - name: Install telnet yum: name=telnet state=installed - name : Run Serverstart.sh command : /bin/bash /opt/scripts/Serverstart.sh async : 300 poll : 10 register: kevin_result \u5982\u4e0a\u914d\u7f6e\uff0c\u53d1\u73b0\u5f53ansible\u914d\u7f6e\u63a7\u5236\u8d85\u8fc75\u53f0\u673a\u5668\u65f6\uff0c\u4e0a\u9762ansible\u4e2d\uff1a a\uff09yum\u6a21\u5757\u4f1a\u5148\u57285\u53f0\u673a\u5668\u4e0a\u8dd1\uff0c\u5b8c\u6210\u540e\u518d\u7ee7\u7eed\u5269\u4f592\u53f0\u7684\u673a\u5668\uff1b b\uff09command\u6a21\u5757\u7684\u4efb\u52a1\u4f1a\u4e00\u6b21\u6027\u5728\u6240\u6709\u673a\u5668\u4e0a\u90fd\u6267\u884c\u4e86\uff0c\u7136\u540e\u76d1\u542c\u5b83\u7684\u56de\u8c03\u7ed3\u679c\uff1b \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u4e0b\u9762\u4e24\u79cd\u60c5\u51b5 a\uff09\u60c5\u51b5\u4e00\uff1a \u8bbe\u7f6epoll=0 \u5982\u679c\u4e0a\u9762command\u6a21\u5757\u662f\u63a7\u5236\u673a\u5668\u5f00\u542f\u4e00\u4e2a\u8fdb\u7a0b\u653e\u5230\u540e\u53f0,\u90a3\u5c31\u4e0d\u9700\u8981\u68c0\u67e5\u8fd9\u4e2a\u4efb\u52a1\u662f\u5426\u5b8c\u6210\u4e86\uff0c\u53ea\u9700\u8981\u7ee7\u7eed\u5176\u4ed6\u7684\u52a8\u4f5c, \u6700\u540e\u518d\u4f7f\u7528wait_for\u8fd9\u4e2a\u6a21\u5757\u53bb\u68c0\u67e5\u4e4b\u524d\u7684\u8fdb\u7a0b\u662f\u5426\u6309\u9884\u671f\u4e2d\u5f00\u542f\u4e86\u4fbf\u53ef\u3002 \u8fd9\u65f6\u53ea\u9700\u8981\u628apoll\u8fd9\u4e2a\u503c\u8bbe\u7f6e\u4e3a0, \u4fbf\u53ef\u4ee5\u6309\u4e0a\u9762\u7684\u8981\u6c42\u914d\u7f6eansible\u4e0d\u7b49\u5f85job\u7684\u5b8c\u6210\u3002 b\uff09\u60c5\u51b5\u4e8c\uff1a \u8bbe\u7f6easync=0 \u5982\u679c\u6709\u4e00\u79cd\u9700\u6c42\u662f\u6709\u4e00\u4e2atask\u5b83\u662f\u9700\u8981\u8fd0\u884c\u5f88\u957f\u7684\u65f6\u95f4,\u90a3\u5c31\u9700\u8981\u8bbe\u7f6e\u4e00\u76f4\u7b49\u5f85\u8fd9\u4e2ajob\u5b8c\u6210\u3002 \u8fd9\u4e2a\u65f6\u5019\u53ea\u9700\u8981\u628aasync\u7684\u503c\u8bbe\u62100\u4fbf\u53ef\u3002 \u7b80\u5355\u603b\u7ed3\u4e0b\uff0c\u9002\u5408\u4f7f\u7528\u5230ansible\u7684polling\u7279\u6027\u7684\u573a\u666f - \u6709\u4e00\u4e2atask\u9700\u8981\u8fd0\u884c\u5f88\u957f\u7684\u65f6\u95f4,\u8fd9\u4e2atask\u5f88\u53ef\u80fd\u4f1a\u8fbe\u5230timeout\uff1b - \u6709\u4e00\u4e2a\u4efb\u52a1\u9700\u8981\u5728\u5927\u91cf\u7684\u673a\u5668\u4e0a\u9762\u8fd0\u884c\uff1b - \u6709\u4e00\u4e2a\u4efb\u52a1\u662f\u4e0d\u9700\u8981\u7b49\u5f85\u5b83\u5b8c\u6210\u7684\uff1b \u4e0d\u9002\u5408\u4f7f\u7528polling\u7279\u6027\u7684\u573a\u666f - task\u4efb\u52a1\u662f\u9700\u8981\u8fd0\u884c\u5b8c\u540e\u624d\u80fd\u7ee7\u7eed\u53e6\u5916\u7684\u4efb\u52a1\u7684\uff1b - task\u4efb\u52a1\u80fd\u5f88\u5feb\u7684\u5b8c\u6210\uff1b 2) max_fail_percentage\uff1a\u6700\u5927\u5931\u8d25\u767e\u5206\u6bd4 ===================================================================== \u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u53ea\u8981ansible\u7684group\u4e2d\u8fd8\u6709server\u6ca1\u6709\u5931\u8d25, ansible\u5c31\u662f\u7ee7\u7eed\u6267\u884ctasks\u3002\u5b9e\u9645\u4e0a, \u7528\u6237\u53ef\u4ee5\u901a\u8fc7max_fail_percentage\uff08\u6700\u5927\u5931\u8d25\u767e\u5206\u6bd4\uff09\u6765\u9650\u5236ansible\u7684\u5e76\u53d1\u6267\u884c\u3002 \u53ea\u8981\u8d85\u8fc7max_fail_percentage\u7684server\u5931\u8d25, ansible\u5c31\u53ef\u4ee5\u4e2d\u6b62tasks\u7684\u6267\u884c\u3002serial\u53c2\u6570\u5728ansible-1.8\u4ee5\u540e\u5c31\u5f00\u59cb\u652f\u6301\u767e\u5206\u6bd4\u529f\u80fd\u4e86\uff01\uff01 \u8bd5\u60f3\u4e00\u4e0b\u5982\u679cgroup\u7ec4\u91cc\u6709200\u53f0\u673a\u5668\uff0c\u90a3\u4e48\u5982\u679c\u4f7f\u7528serial\u6765\u9650\u5236\u5e76\u53d1\u6570\u91cf\uff0c\u6bd4\u5982\u8bbe\u7f6eserial=10\uff0c\u610f\u601d\u5c31\u662f\u4e00\u6b21\u53ea\u6267\u884c10\u53f0\uff0c\u4e00\u76f4\u5230200\u53f0\u5b8c\u6210\u3002 \u53ea\u8981\u7ec4\u5185\u8fd8\u6709server\u6ca1\u6709\u5931\u8d25, ansible\u5c31\u662f\u7ee7\u7eed\u6267\u884ctasks\u3002\u8fd9\u6837\u5c31\u663e\u5f97\u6548\u7387\u5f88\u4f4e\u4e86\uff0c\u5f88\u4e0d\u65b9\u4fbf\uff01\u8fd9\u65f6\u5c31\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u63a7\u5236\u6d41\u7684max_fail_percentage\u529f\u80fd\u4e86\uff01\uff01 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : all max_fail_percentage: 30 serial: 10 tasks : - name: Install telnet yum: name=telnet state=installed - name : Run Serverstart.sh command : /bin/bash /opt/scripts/Serverstart.sh async : 300 poll : 10 register: kevin_result \u5982\u4e0a\u914d\u7f6e\uff0c\u537310\u53f0\u673a\u5668\u91cc\u670930%\u7684\u673a\u5668\u6267\u884cyum\u6a21\u5757\u7684task\u4efb\u52a1\u5931\u8d25\uff0c\u90a3\u4e48\u5c31\u7ec8\u6b62\u8fd9\u4e2a10\u53f0\u673a\u5668\u7684task\u4efb\u52a1\u7684\u6267\u884c\uff0c\u63a5\u7740\u6267\u884c\u4e0b\u4e00\u7ec410\u53f0\u673a\u5668\u7684task\u4efb\u52a1\uff0c\u8fd9\u6837\u6548\u679c\u5c31\u5f88\u68d2\u4e86\u3002 \u6e29\u99a8\u63d0\u793a\uff1a \u5b9e\u9645\u5931\u8d25\u673a\u5668\u5fc5\u987b\u5927\u4e8e\u8fd9\u4e2a\u767e\u5206\u6bd4\u65f6, tasks\u4efb\u52a1\u624d\u4f1a\u88ab\u4e2d\u6b62\uff1b\u5982\u679c\u7b49\u4e8e\u8fd9\u4e2a\u767e\u5206\u6bd4\u65f6\uff0ctask\u4efb\u52a1\u662f\u4e0d\u4f1a\u88ab\u7ec8\u6b62\u7684\uff01 \u8e29\u5751\u7ecf\u9a8c\uff1aAnsible\u5e76\u53d1\u5931\u8d25\uff08fork=100. \u4f46\u662f\u771f\u6b63\u6267\u884cplaybook\u65f6\u5e76\u6ca1\u6709\u5b9e\u73b0\u5e76\u53d1\uff09 [root@hostname ~]# cd /usr/lib/python2.7/site-packages/ansible/ [root@hostname ansible]# find . -name ssh.py ./plugins/connection/ssh.py [root@hostname ansible]# vim plugins/connection/ssh.py ......... ......... if C.HOST_KEY_CHECKING and not_in_host_file: # lock around the initial SSH connectivity so the user prompt about whether to add # the host to known hosts is not intermingled with multiprocess output. fcntl.lockf(self.runner.process_lockfile, fcntl.LOCK_EX) fcntl.lockf(self.runner.output_lockfile, fcntl.LOCK_EX) # create process (p, stdin) = self._run(ssh_cmd, in_data) ......... ......... \u901a\u8fc7\u4ee5\u4e0a\u6587\u4ef6\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\uff1a \u5982\u679cansible\u914d\u7f6e\"HOST_KEY_CHECKING=True\", \u5e76\u4e14ansible\u5ba2\u6237\u673a\u4fe1\u606f\u6ca1\u6709\u5728ansible\u670d\u52a1\u7aef\u7684~/.ssh/known_hosts\u91cc\u9762, \u4e00\u4e2a\u8fdb\u7a0b\u5c31\u4f1a\u9501\u6b7b~/.ssh/known_hosts\u6587\u4ef6\u3002 \u8fd9\u6837ansible\u5c31\u4e0d\u80fd\u5b9e\u73b0\u5e76\u53d1\uff01 \u89e3\u51b3\u65b9\u6848: \u5728ansible\u670d\u52a1\u7aef\u7684/etc/ansible/ansible.cfg\u6587\u4ef6\u91cc\u914d\u7f6e\"host_key_checking = False\" [\u5176\u5b9eansible.cfg\u6587\u4ef6\u91cc\u8be5\u9879\u9ed8\u8ba4\u914d\u7f6e\u7684\u5c31\u662fFalse]","title":"\u4e8c\u3001Ansible\u7684\u5e76\u53d1\u9650\u5236  [serial\u3001max_fail_percentage]"},{"location":"ansbile_async/#ansible-delegate_todelegate_factsrun_once","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cansible\u7684\u6240\u6709\u4efb\u52a1\u90fd\u662f\u5728\u6307\u5b9a\u7684\u673a\u5668\u4e0a\u8fd0\u884c\u7684\u3002\u5f53\u5728\u4e00\u4e2a\u72ec\u7acb\u7684\u7fa4\u96c6\u73af\u5883\u4e2d\u914d\u7f6e\u65f6\uff0c\u53ea\u662f\u60f3\u64cd\u4f5c\u5176\u4e2d\u7684\u67d0\u4e00\u53f0\u4e3b\u673a\uff0c\u6216\u8005\u5728\u7279\u5b9a\u7684\u4e3b\u673a\u4e0a\u8fd0\u884ctask\u4efb\u52a1\uff0c\u6b64\u65f6\u5c31\u9700\u8981\u7528\u5230ansible\u7684\u4efb\u52a1\u59d4\u6258\u529f\u80fd\u3002\u4f7f\u7528delegate_to\u5173\u952e\u5b57\u53ef\u4ee5\u914d\u7f6etask\u4efb\u52a1\u5728\u6307\u5b9a\u7684\u673a\u5668\u4e0a\u6267\u884c\uff0c\u5c31\u662f\u8bf4\u5176\u4ed6\u7684task\u4efb\u52a1\u8fd8\u662f\u5728hosts\u5173\u952e\u5b57\u914d\u7f6e\u7684\u673a\u5668\u4e0a\u8fd0\u884c\uff0c\u5230\u4e86\u8fd9\u4e2a\u5173\u952e\u5b57\u6240\u5728\u7684\u4efb\u52a1\u65f6\uff0c\u5c31\u4f7f\u7528\u59d4\u6258\u7684\u673a\u5668\u8fd0\u884c\u3002 1\uff09\u59d4\u6258 ===================================================================== \u901a\u8fc7\"delegate_to\", ansible\u53ef\u4ee5\u628a\u67d0\u4e00\u4e2atask\u4efb\u52a1\u653e\u5728\u59d4\u6258\u7684\u673a\u5668\u4e0a\u6267\u884c\u3002\u5373\u5728\u6307\u5b9a\u7684\u7ec4\u5185\u7684\u67d0\u4e00\u53f0\u6216\u591a\u53f0\u673a\u5668\u4e0a\u6267\u884ctask\u4efb\u52a1\u3002 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server serial: 10 tasks : - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: 172.16.60.245 \u5219\u4e0a\u9762\u7684shell\u6a21\u5757\u7684task\u4efb\u52a1\u53ea\u4f1a\u5728172.16.60.245\u8fd9\u53f0\u8282\u70b9\u4e0a\u6267\u884c\uff0ctest_server\u7ec4\u5185\u5176\u4ed6\u7684\u673a\u5668\u4e0d\u4f1a\u6267\u884cshell\u4efb\u52a1\u3002 --------------------- \u5982\u679c \"delegate_to: 127.0.0.1\" \u5219\u53ef\u4ee5\u7528local_action\u6765\u4ee3\u66ff\u3002\u5373\u4e0b\u9762\u4e24\u4e2a\u914d\u7f6e\u6548\u679c\u662f\u4e00\u6837\u7684\uff01\uff01 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server serial: 10 tasks : - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: 127.0.0.1 [root@hostname ~]# cat /etc/ansible/test.yml - hosts : test_server serial: 10 tasks : - name: test-haha local_action: shell echo \"test\" > /root/test.list ------------------- \u5982\u679c\u8bbe\u7f6e\u4e86\u591a\u4e2adelegate_to\uff0c\u5219\u6267\u884c\u65f6\u53ea\u4f1a\u5339\u914d\u6700\u4e0b\u9762\u90a3\u4e2a\u3002 \u4f8b\u5982\u4e0b\u9762\u914d\u7f6e\u4e2d\uff0c\u53ea\u4f1a\u6267\u884c\"delegate_to: 172.16.60.245\", \u4e0a\u9762\u90a3\u4e2a\"delegate_to: 172.16.60.241\"\u5c31\u4f1a\u88ab\u5ffd\u7565\u4e86\u3002 [root@hostname ansible]# cat /etc/ansible/test.yml - hosts : all serial: 10 tasks : - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: 172.16.60.241 delegate_to: 172.16.60.245 ------------------- delegate_to\u9ed8\u8ba4\u540e\u9762\u53ea\u80fd\u8ddf\u4e00\u4e2a\u4e3b\u673aip\uff0c\u4e0d\u80fd\u8ddf\u591a\u4e2a\u4e3b\u673aip\u3002\u5373\u9ed8\u8ba4\u59d4\u6258\u5230\u5355\u4e2a\u4e3b\u673a\u3002 \u5982\u679c\u6709\u591a\u4e2aip\u9700\u8981\u59d4\u6258\uff0c\u5219\u53ef\u4ee5\u5c06\u8fd9\u4e9bip\u91cd\u65b0\u653e\u4e00\u4e2agroup\uff0c\u7136\u540edelegate_to\u59d4\u6258\u7ed9group\u7ec4\u3002 delegate_to\u59d4\u6258\u5230\u7ec4\u7684\u65b9\u5f0f\uff1a\u901a\u8fc7items\u53d8\u91cf\u65b9\u5f0f\uff01\uff01\uff01 [root@hostname ansible]# cat /etc/ansible/hosts |tail -8 [test_server] 172.16.60.241 172.16.60.245 172.16.60.246 127.0.0.1 [kevin_server] 172.16.60.246 127.0.0.1 [root@hostname ansible]# cat /etc/ansible/test.yml - hosts: all tasks: - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: \"{{item}}\" with_items: \"{{groups['kevin_server']}}\" \u5373\u5c06shell\u8fd9\u4e2atask\u4efb\u52a1\u59d4\u6258\u7ed9kevin_server\u7ec4\u5185\u7684\u673a\u5668\u6267\u884c\u3002 2\uff09\u59d4\u6258\u8005\u7684facts ===================================================================== \u9ed8\u8ba4\u60c5\u51b5\u4e0b, ansible\u59d4\u6258\u4efb\u52a1\u7684facts\u662finventory_hostname\u4e2d\u4e3b\u673a\u7684facts, \u800c\u4e0d\u662f\u88ab\u59d4\u6258\u673a\u5668\u7684facts\u3002 a) delegate_facts \u5728ansible 2.0 \u4e2d, \u901a\u8fc7\u8bbe\u7f6e\"delegate_facts: True\"\u53ef\u4ee5\u8ba9task\u4efb\u52a1\u53bb\u6536\u96c6\u88ab\u59d4\u6258\u673a\u5668\u7684facts\u3002 [root@hostname ~]# cat /etc/ansible/test.yml - hosts: test_server tasks: - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: \"{{item}}\" delegate_facts: True with_items: \"{{groups['kevin_server']}}\" \u5982\u4e0a\u914d\u7f6e\uff0c\u8868\u793a\u4f1a\u6536\u96c6kevin_server\u7684facts\u5e76\u5206\u914d\u7ed9\u8fd9\u4e9b\u673a\u5668, \u800c\u4e0d\u4f1a\u53bb\u6536\u96c6test_server\u7684facts b\uff09RUN ONCE \u901a\u8fc7\u8bbe\u7f6e\"run_once: true\"\u6765\u6307\u5b9a\u8be5task\u53ea\u80fd\u5728\u59d4\u6258\u7684\u67d0\u4e00\u53f0\u673a\u5668\u6216\u59d4\u6258\u7684\u7ec4\u5185\u673a\u5668\u4e0a\u6267\u884c\u4e00\u6b21\uff01\uff01\u53ef\u4ee5\u548cdelegate_to \u7ed3\u5408\u4f7f\u7528\u3002 \u5982\u679c\u6ca1\u6709delegate_to, \u90a3\u4e48\u8fd9\u4e2atask\u9ed8\u8ba4\u5c31\u4f1a\u5728\u7b2c\u4e00\u53f0\u673a\u5668\u4e0a\u6267\u884c\uff01\uff01\uff01 [root@hostname ~]# cat /etc/ansible/test.yml - hosts: test_server tasks: - name: test-haha shell: echo \"test\" > /root/test.list delegate_to: \"{{item}}\" run_once: true delegate_facts: True with_items: \"{{groups['kevin_server']}}\"","title":"\u4e09\u3001Ansible\u7684\u4efb\u52a1\u59d4\u6258  [delegate_to\u3001delegate_facts\u3001run_once]"},{"location":"awk/","text":"\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK \u00b6 \u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK \u539f\u6587GITHUB mylxsw\u7684 GITHUB \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u6a21\u5f0f \u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a \u6761\u4ef6 awk [option] 'pattern[action]' file... awk [option] '\u6a21\u5f0f {\u52a8\u4f5c}' \u6587\u4ef6 BEGIN\u6a21\u5f0f\u662f\u5904\u7406\u6587\u672c\u4e4b\u524d\u9700\u8981\u6267\u884c\u7684\u64cd\u4f5c END\u6a21\u5f0f\u662f\u5904\u7406\u5b8c\u6240\u6709\u884c\u4e4b\u540e\u6267\u884c\u7684\u64cd\u4f5c awk\u53c2\u6570 \u00b6 \u53c2\u6570 \u89e3\u91ca -F \u6307\u5b9a\u5206\u5272\u5b57\u6bb5 -v \u5b9a\u4e49\u6216\u4fee\u6539awk\u5185\u90e8\u7684\u53d8\u91cf -f \u4ece\u811a\u672c\u6587\u4ef6\u4e2d\u8bfb\u53d6awk\u547d\u4ee4 \u5bf9\u4e8eawk\u800c\u8a00,\u53d8\u91cf\u5206\u4e3a \u5185\u7f6e\u53d8\u91cf \u81ea\u5b9a\u4e49\u53d8\u91cf \u5185\u7f6e\u53d8\u91cf \u89e3\u91ca FS FS: field separator, \u8f93\u5165 \u5b57\u6bb5\u5206\u9694\u7b26,\u9ed8\u8ba4\u4e3a\u7a7a\u767d\u5b57\u7b26 OFS OFS: OFS is an output equivalent of awk FS variable, \u8f93\u51fa \u5b57\u6bb5\u5206\u9694\u7b26,\u9ed8\u8ba4\u4e3a\u7a7a\u767d\u5b57\u7b26 RS RS: record separator, \u8f93\u5165 \u8bb0\u5f55\u5206\u9694\u7b26(\u8f93\u5165\u6362\u884c\u7b26),\u6307\u5b9a\u8f93\u5165\u65f6\u7684\u6362\u884c\u7b26 ORS ORS: ORS is an Output equivalent of RS \u8f93\u51fa \u8bb0\u5f55\u5206\u9694\u7b26(\u8f93\u51fa\u6362\u884c\u7b26),\u8f93\u51fa\u65f6\u7528\u6307\u5b9a\u7b26\u53f7\u4ee3\u66ff\u6362\u884c\u7b26 NF NF: number of Field, \u5f53\u524d\u884c\u7684\u5b57\u6bb5\u7684\u4e2a\u6570(\u5373\u5f53\u524d\u884c\u88ab\u5206\u5272\u4e86\u51e0\u5217),\u5b57\u6bb5\u6570\u91cf NR NR: number of records(\u884c\u53f7), \u5f53\u524d\u5904\u7406\u7684\u6587\u672c\u884c\u7684\u884c\u53f7. FNR FNR: Number of Records relative to the current input file \u5404\u6587\u4ef6\u5206\u522b\u8ba1\u6570\u7684\u884c\u53f7 FILENAME FILENAME: \u5f53\u524d\u6587\u4ef6\u540d ARGC ARGC: \u547d\u4ee4\u884c\u53c2\u6570\u7684\u4e2a\u6570 ARGV ARGV:\u6570\u7ec4,\u4fdd\u5b58\u7684\u662f\u547d\u4ee4\u884c\u6240\u7ed9\u5b9a\u7684\u5404\u53c2\u6570 \u5185\u7f6e\u53d8\u91cf \u00b6 NR,NF,FNR \u00b6 awk\u7684\u5185\u7f6e\u53d8\u91cfNR,NF\u662f\u4e0d\u8981\u6dfb\u52a0$\u7b26\u53f7\u7684 \u800c $0 $1 $2... \u662f\u9700\u8981\u6dfb\u52a0$\u7b26\u53f7\u7684 \u6a21\u5f0f \u00b6 \u5173\u7cfb\u8fd0\u7b97\u7b26 \u89e3\u91ca \u793a\u4f8b < \u5c0f\u4e8e x<y <= \u5c0f\u4e8e\u7b49\u4e8e x<=y == \u7b49\u4e8e x==y != \u4e0d\u7b49\u4e8e x!=y >= \u5927\u4e8e\u7b49\u4e8e x>=y > \u5927\u4e8e x>y ~ \u5339\u914d\u6b63\u5219 x~/\u6b63\u5219/ !~ \u4e0d\u5339\u914d\u6b63\u5219 x!~/\u6b63\u5219/ $ awk -F \":\" 'BEGIN{print \"===\"} NR==3,NR==5 {printf \"%s %s\\n\", NR,$1} END{print \"@@@\"}' xxx_list === 3 1-1 4 1-8 5 1000th @@@ $ $ awk -v FS=\".\" 'BEGIN{print \"###\"} {print NR,NF,$1,$2,$3 }' xxx_list | head ### 1 5 xxx:mysql db xxx 2 5 ttt:maria db ttt $ awk -v FS=\".\" 'BEGIN{print \"###\"} {print ARGV[1], NR,NF,$1,$2,$3 }' xxx_list | head ### xxx_list 1 5 xxx:mysql db xxx xxx_list 2 5 ttt:maria db ttt \u81ea\u5b9a\u4e49\u53d8\u91cf \u00b6 \u65b9\u6cd5\u4e00: -v varName=value \u65b9\u6cd5\u4e8c: \u5728\u7a0b\u5e8f\u4e2d\u76f4\u63a5\u5b9a\u4e49 awk\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f \u00b6 \u6b63\u5219\u8868\u8fbe\u5f0f \u00b6 awk '/\u6b63\u5219\u8868\u8fbe\u5f0f/ {\u52a8\u4f5c}' file \u884c\u8bbf\u95ee\u6a21\u5f0f \u00b6 awk '/\u6b63\u52191/,/\u6b63\u52192/ {\u52a8\u4f5c}' file $ awk -F \":\" '/^5may/ {print $1,$NF}' osn_mysql40_acc_list 5may mysql31.db.sakura.ne.jp www2323# cat /home/.logs/users/xxx/access_log.20230502 | awk '$1 ~ \"xxx.sa|xxx.org|xxx.xxx.ne.jp\" {print $3}' | uniq -n awk\u547d\u4ee4\u6267\u884c\u6d41\u7a0b \u00b6 \u89e3\u8bfb\u9700\u6c42: \u4ece\u6587\u4ef6\u4e2d\u5bfb\u627e\u60f3\u8981\u7684\u4fe1\u606f,\u6309\u7167\u4ee5\u4e0b\u987a\u5e8f\u6267\u884c awk 'BEGIN {commands} pattern{commands} END{commands}' file... \u4f18\u5148\u6267\u884c BEGIN{} \u6a21\u5f0f\u4e2d\u7684\u8bed\u53e5 \u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7b2c\u4e00\u884c,\u7136\u540e\u6267\u884c pattern{commads} ,\u8fdb\u884c\u6b63\u5219\u5339\u914d /^n/ \u5bfb\u627en\u5f00\u5934\u7684\u884c,\u627e\u5230\u4e4b\u540e\u6267\u884c {print} \u8fdb\u884c\u6253\u5370 \u5f53awk\u8bfb\u53d6\u6587\u4ef6\u6570\u636e\u6d41\u7684\u7ed3\u5c3e\u65f6, \u4f1a\u6267\u884c END{commads} \u6982\u8ff0 \u00b6 AWK\u662f\u4e00\u95e8\u89e3\u91ca\u578b\u7684\u7f16\u7a0b\u8bed\u8a00\u3002\u5728\u6587\u672c\u5904\u7406\u9886\u57df\u5b83\u662f\u975e\u5e38\u5f3a\u5927\u7684\uff0c\u5b83\u7684\u540d\u5b57\u6765\u6e90\u4e8e\u5b83\u7684\u4e09\u4f4d\u4f5c\u8005\u7684\u59d3\u6c0f\uff1a Alfred Aho \uff0c Peter Weinberger \u548c Brian Kernighan \u3002 GNU/Linux\u53d1\u5e03\u7684AWK\u76ee\u524d\u7531\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a\uff08FSF\uff09\u8fdb\u884c\u5f00\u53d1\u548c\u7ef4\u62a4\uff0c\u901a\u5e38\u4e5f\u79f0\u5b83\u4e3a GNU AWK \u3002 AWK\u7684\u7c7b\u578b \u00b6 \u4e0b\u9762\u662f\u51e0\u4e2aAWK\u7684\u53d8\u4f53\uff1a AWK - \u539f\u5148\u6765\u6e90\u4e8e AT & T \u5b9e\u9a8c\u5ba4\u7684\u7684AWK NAWK - AT & T \u5b9e\u9a8c\u5ba4\u7684AWK\u7684\u5347\u7ea7\u7248 GAWK - \u8fd9\u5c31\u662fGNU AWK\u3002\u6240\u6709\u7684GNU/Linux\u53d1\u5e03\u7248\u90fd\u81ea\u5e26GAWK\uff0c\u5b83\u4e0eAWK\u548cNAWK\u5b8c\u5168\u517c\u5bb9 AWK\u7684\u5178\u578b\u7528\u9014 \u00b6 \u4f7f\u7528AWK\u53ef\u4ee5\u505a\u5f88\u591a\u4efb\u52a1\uff0c\u4e0b\u9762\u662f\u5176\u4e2d\u4e00\u4e9b \u6587\u672c\u5904\u7406 \u8f93\u51fa\u683c\u5f0f\u5316\u7684\u6587\u672c\u62a5\u8868 \u6267\u884c\u7b97\u6570\u8fd0\u7b97 \u6267\u884c\u5b57\u7b26\u4e32\u64cd\u4f5c\u7b49\u7b49 \u5de5\u4f5c\u6d41 \u00b6 \u8981\u6210\u4e3aAWK\u7f16\u7a0b\u4e13\u5bb6\uff0c\u4f60\u9700\u8981\u5148\u77e5\u9053\u5b83\u7684\u5185\u90e8\u5b9e\u73b0\u673a\u5236\uff0cAWK\u9075\u5faa\u4e86\u975e\u5e38\u7b80\u5355\u7684\u5de5\u4f5c\u6d41 - \u8bfb\u53d6 \uff0c \u6267\u884c \u548c \u91cd\u590d \uff0c\u4e0b\u56fe\u63cf\u8ff0\u4e86AWK\u7684\u5de5\u4f5c\u6d41\u3002 Read AWK\u4ece\u8f93\u5165\u6d41\uff08\u6587\u4ef6\uff0c\u7ba1\u9053\u6216\u8005\u6807\u51c6\u8f93\u5165\uff09\u4e2d\u8bfb\u53d6\u4e00\u884c\uff0c\u7136\u540e\u5b58\u50a8\u5230\u5185\u5b58\u4e2d\u3002 Execute \u6240\u6709\u7684AWK\u547d\u4ee4\u90fd\u4f9d\u6b21\u5728\u8f93\u5165\u4e0a\u6267\u884c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cAWK\u4f1a\u5bf9\u6bcf\u4e00\u884c\u6267\u884c\u547d\u4ee4\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u6a21\u5f0f\u9650\u5236\u8fd9\u79cd\u884c\u4e3a\u3002 Repeat \u5904\u7406\u8fc7\u7a0b\u4e0d\u65ad\u91cd\u590d\uff0c\u76f4\u5230\u5230\u8fbe\u6587\u4ef6\u7ed3\u5c3e\u3002 \u7a0b\u5e8f\u7ed3\u6784 \u00b6 \u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u5148\u5b66\u4e60\u4e00\u4e0bAWK\u7684\u7a0b\u5e8f\u7ed3\u6784\u3002 BEGIN \u8bed\u53e5\u5757 \u00b6 BEGIN\u8bed\u53e5\u5757\u7684\u8bed\u6cd5 BEGIN {awk-commands} BEGIN\u8bed\u53e5\u5757\u5728\u7a0b\u5e8f\u5f00\u59cb\u7684\u4f7f\u7528\u6267\u884c\uff0c\u5b83\u53ea\u6267\u884c\u4e00\u6b21\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u521d\u59cb\u5316\u53d8\u91cf\u3002BEGIN\u662fAWK\u7684\u5173\u952e\u5b57\uff0c\u56e0\u6b64\u5b83\u5fc5\u987b\u4e3a\u5927\u5199\uff0c\u6ce8\u610f\uff0c\u8fd9\u4e2a\u8bed\u53e5\u5757\u662f\u53ef\u9009\u7684\u3002 BODY \u8bed\u53e5\u5757 \u00b6 BODY\u8bed\u53e5\u5757\u7684\u8bed\u6cd5 /pattern/ {awk-commands} BODY\u8bed\u53e5\u5757\u4e2d\u7684\u547d\u4ee4\u4f1a\u5bf9\u8f93\u5165\u7684\u6bcf\u4e00\u884c\u6267\u884c\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u6a21\u5f0f\u6765\u63a7\u5236\u8fd9\u79cd\u884c\u4e3a\u3002\u6ce8\u610f\uff0cBODY\u8bed\u53e5\u5757\u6ca1\u6709\u5173\u952e\u5b57\u3002 END \u8bed\u53e5\u5757 \u00b6 END\u8bed\u53e5\u5757\u7684\u8bed\u6cd5 END {awk-commands} END\u8bed\u53e5\u5757\u5728\u7a0b\u5e8f\u7684\u6700\u540e\u6267\u884c\uff0cEND\u662fAWK\u7684\u5173\u952e\u5b57\uff0c\u56e0\u6b64\u5fc5\u987b\u4e3a\u5927\u5199\uff0c\u5b83\u4e5f\u662f\u53ef\u9009\u7684\u3002 \u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5e8f\u53f7\uff0c\u5b66\u751f\u59d3\u540d\uff0c\u79d1\u76ee\u540d\u79f0\u548c\u5f97\u5206\u7684\u6587\u4ef6 marks.txt \u3002 1) Amit Physics 80 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89 \u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\u6211\u4eec\u5c06\u4f1a\u663e\u793a\u6587\u4ef6\u5185\u5bb9\uff0c\u5e76\u4e14\u6dfb\u52a0\u6bcf\u4e00\u5217\u7684\u6807\u9898 $ awk 'BEGIN{printf \"Sr No\\tName\\tSub\\tMarks\\n\"} {print}' marks.txt \u4e0a\u8ff0\u4ee3\u7801\u6267\u884c\u540e\uff0c\u8f93\u51fa\u4ee5\u4e0b\u5185\u5bb9 Sr No Name Sub Marks 1) Amit Physics 80 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89 \u5728\u7a0b\u5e8f\u7684\u5f00\u59cb\uff0cAWK\u5728BEGIN\u8bed\u53e5\u4e2d\u6253\u5370\u51fa\u6807\u9898\u3002\u7136\u540e\u518dBODY\u8bed\u53e5\u4e2d\uff0c\u5b83\u4f1a\u8bfb\u53d6\u6587\u4ef6\u7684\u6bcf\u4e00\u884c\u7136\u540e\u6267\u884cAWK\u7684print\u547d\u4ee4\u5c06\u6bcf\u4e00\u884c\u7684\u5185\u5bb9\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u4f1a\u4e00\u76f4\u91cd\u590d\u76f4\u5230\u6587\u4ef6\u7684\u7ed3\u5c3e\u3002 \u57fa\u7840\u8bed\u6cd5 \u00b6 AWK\u7684\u4f7f\u7528\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884cAWK\u7684\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u4ece\u5305\u542bAWK\u547d\u4ee4\u7684\u6587\u672c\u6587\u4ef6\u4e2d\u6267\u884c\u3002 AWK\u547d\u4ee4\u884c \u00b6 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5355\u5f15\u53f7\u5728\u547d\u4ee4\u884c\u4e2d\u6307\u5b9aAWK\u547d\u4ee4 awk [options] file ... \u6bd4\u5982\u6211\u4eec\u6709\u4e00\u4e2a\u5305\u542b\u4e0b\u9762\u5185\u5bb9\u7684\u6587\u672c\u6587\u4ef6 marks.txt : 1) Amit Physics 80 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u663e\u793a\u8be5\u6587\u4ef6\u7684\u5b8c\u6574\u5185\u5bb9 $ awk '{print}' marks.txt AWK\u7a0b\u5e8f\u6587\u4ef6 \u00b6 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u811a\u672c\u6587\u4ef6\u63d0\u4f9bAWK\u547d\u4ee4 awk [options] -f file .... \u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u4e0b\u9762\u5185\u5bb9\u7684\u6587\u672c\u6587\u4ef6 command.awk {print} \u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9AWK\u6267\u884c\u8be5\u6587\u4ef6\u4e2d\u7684\u547d\u4ee4\uff0c\u8fd9\u91cc\u6211\u4eec\u5b9e\u73b0\u4e86\u548c\u4e0a\u4f8b\u540c\u6837\u7684\u7ed3\u679c $ awk -f command.awk marks.txt AWK\u6807\u51c6\u9009\u9879 \u00b6 AWK\u652f\u6301\u4e0b\u5217\u547d\u4ee4\u884c\u6807\u51c6\u9009\u9879 -v \u53d8\u91cf\u8d4b\u503c\u9009\u9879 \u00b6 \u8be5\u9009\u9879\u5c06\u4e00\u4e2a\u503c\u8d4b\u4e88\u4e00\u4e2a\u53d8\u91cf\uff0c\u5b83\u4f1a\u5728\u7a0b\u5e8f\u5f00\u59cb\u4e4b\u524d\u8fdb\u884c\u8d4b\u503c\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u63cf\u8ff0\u4e86\u8be5\u9009\u9879\u7684\u4f7f\u7528 $ awk -v name=Jerry 'BEGIN{printf \"Name = %s\\n\", name}' Name = Jerry --dump-variables[=file] \u9009\u9879 \u00b6 \u8be5\u9009\u9879\u4f1a\u8f93\u51fa\u6392\u597d\u5e8f\u7684\u5168\u5c40\u53d8\u91cf\u5217\u8868\u548c\u5b83\u4eec\u6700\u7ec8\u7684\u503c\u5230\u6587\u4ef6\u4e2d\uff0c\u9ed8\u8ba4\u7684\u6587\u4ef6\u662f awkvars.out \u3002 $ awk --dump-variables '' $ cat awkvars.out ARGC: 1 ARGIND: 0 ARGV: array, 1 elements BINMODE: 0 CONVFMT: \"%.6g\" ERRNO: \"\" FIELDWIDTHS: \"\" FILENAME: \"\" FNR: 0 FPAT: \"[^[:space:]]+\" FS: \" \" IGNORECASE: 0 LINT: 0 NF: 0 NR: 0 OFMT: \"%.6g\" OFS: \" \" ORS: \"\\n\" RLENGTH: 0 RS: \"\\n\" RSTART: 0 RT: \"\" SUBSEP: \"\\034\" TEXTDOMAIN: \"messages\" --help \u9009\u9879 \u00b6 \u6253\u5370\u5e2e\u52a9\u4fe1\u606f\u3002 $ awk --help Usage: awk [POSIX or GNU style options] -f progfile [--] file ... Usage: awk [POSIX or GNU style options] [--] 'program' file ... POSIX options : GNU long options: (standard) -f progfile --file=progfile -F fs --field-separator=fs -v var=val --assign=var=val Short options : GNU long options: (extensions) -b --characters-as-bytes -c --traditional -C --copyright -d[file] --dump-variables[=file] -e 'program-text' --source='program-text' -E file --exec=file -g --gen-pot -h --help -L [fatal] --lint[=fatal] -n --non-decimal-data -N --use-lc-numeric -O --optimize -p[file] --profile[=file] -P --posix -r --re-interval -S --sandbox -t --lint-old -V --version --lint[=fatal] \u9009\u9879 \u00b6 \u8be5\u9009\u9879\u5141\u8bb8\u68c0\u67e5\u7a0b\u5e8f\u7684\u4e0d\u517c\u5bb9\u6027\u6216\u8005\u6a21\u68f1\u4e24\u53ef\u7684\u4ee3\u7801\uff0c\u5f53\u63d0\u4f9b\u53c2\u6570 fatal \u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u5bf9\u5f85Warning\u6d88\u606f\u4f5c\u4e3aError\u3002 $ awk --lint '' /bin/ls awk: cmd. line:1: warning: empty program text on command line awk: cmd. line:1: warning: source file does not end in newline awk: warning: no program text at all! --posix \u9009\u9879 \u00b6 \u8be5\u9009\u9879\u5f00\u542f\u4e25\u683c\u7684POSIX\u517c\u5bb9\u3002 --profile[=file] \u9009\u9879 \u00b6 \u8be5\u9009\u9879\u4f1a\u8f93\u51fa\u4e00\u4efd\u683c\u5f0f\u5316\u4e4b\u540e\u7684\u7a0b\u5e8f\u5230\u6587\u4ef6\u4e2d\uff0c\u9ed8\u8ba4\u6587\u4ef6\u662f awkprof.out \u3002 $ awk --profile 'BEGIN{printf\"---|Header|--\\n\"} {print} END{printf\"---|Footer|---\\n\"}' marks.txt > /dev/null $ cat awkprof.out # gawk \u914d\u7f6e, \u521b\u5efa Wed Oct 26 15:05:49 2016 # BEGIN \u5757 BEGIN { printf \"---|Header|--\\n\" } # \u89c4\u5219 { print $0 } # END \u5757 END { printf \"---|Footer|---\\n\" } --traditional \u9009\u9879 \u00b6 \u8be5\u9009\u9879\u4f1a\u7981\u6b62\u6240\u6709\u7684gawk\u89c4\u8303\u7684\u6269\u5c55\u3002 --version \u9009\u9879 \u00b6 \u8f93\u51fa\u7248\u672c\u53f7 $ awk --version GNU Awk 3.1.7 \u7248\u6743\u6240\u6709 \u00a9 1989, 1991-2009 \u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a(FSF)\u3002 \u8be5\u7a0b\u5e8f\u4e3a\u81ea\u7531\u8f6f\u4ef6\uff0c\u4f60\u53ef\u4ee5\u5728\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u53d1\u5e03\u7684 GNU \u901a\u7528\u516c\u5171\u8bb8\u53ef\u8bc1(GPL)\u7b2c 3\u7248\u6216\u4ee5\u540e\u7248\u672c\u4e0b\u4fee\u6539\u6216\u91cd\u65b0\u53d1\u5e03\u3002 \u8be5\u7a0b\u5e8f\u4e4b\u6240\u4ee5\u88ab\u53d1\u5e03\u662f\u56e0\u4e3a\u5e0c\u671b\u4ed6\u80fd\u5bf9\u4f60\u6709\u6240\u7528\u5904\uff0c\u4f46\u6211\u4eec\u4e0d\u4f5c\u4efb\u4f55\u62c5\u4fdd\u3002\u8fd9\u5305\u542b \u4f46\u4e0d\u9650\u4e8e\u4efb\u4f55\u5546\u4e1a\u9002\u552e\u6027\u4ee5\u53ca\u9488\u5bf9\u7279\u5b9a\u76ee\u7684\u7684\u9002\u7528\u6027\u7684\u62c5\u4fdd\u3002\u8be6\u60c5\u53c2\u89c1 GNU \u901a\u7528\u516c \u5171\u8bb8\u53ef\u8bc1(GPL)\u3002 \u4f60\u5e94\u8be5\u6536\u5230\u7a0b\u5e8f\u9644\u5e26\u7684\u4e00\u4efd GNU \u901a\u7528\u516c\u5171\u8bb8\u53ef\u8bc1(GPL)\u3002\u5982\u679c\u6ca1\u6709\u6536\u5230\uff0c\u8bf7\u53c2\u770b http://www.gnu.org/licenses/ \u3002 You have new mail in /var/spool/mail/root \u57fa\u672c\u4f7f\u7528\u793a\u4f8b \u00b6 \u672c\u90e8\u5206\u4f1a\u8bb2\u8ff0\u4e00\u4e9b\u6709\u7528\u7684AWK\u547d\u4ee4\u548c\u5b83\u4eec\u7684\u4f7f\u7528\u793a\u4f8b\uff0c\u6240\u6709\u7684\u4f8b\u5b50\u90fd\u662f\u4ee5\u4e0b\u9762\u7684\u6587\u672c\u6587\u4ef6 marks.txt \u4e3a\u57fa\u7840\u7684 1) Amit Physics 80 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89 \u6253\u5370\u67d0\u5217\u6216\u8005\u5b57\u6bb5 \u00b6 AWK\u53ef\u4ee5\u53ea\u6253\u5370\u8f93\u5165\u5b57\u6bb5\u4e2d\u7684\u67d0\u4e9b\u5217\u3002 $ awk '{print $3 \"\\t\" $4}' marks.txt Physics 80 Maths 90 Biology 87 English 85 History 89 \u5728\u6587\u4ef6 marks.txt \u4e2d\uff0c\u7b2c\u4e09\u5217\u5305\u542b\u4e86\u79d1\u76ee\u540d\uff0c\u7b2c\u56db\u5217\u5219\u662f\u5f97\u5206\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u53ea\u6253\u5370\u51fa\u4e86\u8fd9\u4e24\u5217\uff0c $3 \u548c $4 \u4ee3\u8868\u4e86\u8f93\u5165\u8bb0\u5f55\u4e2d\u7684\u7b2c\u4e09\u548c\u7b2c\u56db\u4e2a\u5b57\u6bb5\u3002 \u6253\u5370\u6240\u6709\u7684\u884c \u00b6 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cAWK\u4f1a\u6253\u5370\u51fa\u6240\u6709\u5339\u914d\u6a21\u5f0f\u7684\u884c $ awk '/a/ {print $0}' marks.txt 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89 \u4e0a\u8ff0\u547d\u4ee4\u4f1a\u5224\u65ad\u6bcf\u4e00\u884c\u4e2d\u662f\u5426\u5305\u542b a \uff0c\u5982\u679c\u5305\u542b\u5219\u6253\u5370\u8be5\u884c\uff0c\u5982\u679cBODY\u90e8\u5206\u7f3a\u5931\u5219\u9ed8\u8ba4\u4f1a\u6267\u884c\u6253\u5370\uff0c\u56e0\u6b64\uff0c\u4e0a\u8ff0\u547d\u4ee4\u548c\u4e0b\u9762\u8fd9\u4e2a\u662f\u7b49\u4ef7\u7684 $ awk '/a/' marks.txt \u6253\u5370\u5339\u914d\u6a21\u5f0f\u7684\u5217 \u00b6 \u5f53\u6a21\u5f0f\u5339\u914d\u6210\u529f\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bAWK\u4f1a\u6253\u5370\u8be5\u884c\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u8ba9\u5b83\u53ea\u6253\u5370\u6307\u5b9a\u7684\u5b57\u6bb5\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u53ea\u4f1a\u6253\u5370\u51fa\u5339\u914d\u6a21\u5f0f\u7684\u7b2c\u4e09\u548c\u7b2c\u56db\u4e2a\u5b57\u6bb5\u3002 $ awk '/a/ {print $3 \"\\t\" $4}' marks.txt Maths 90 Biology 87 English 85 History 89 \u4efb\u610f\u987a\u5e8f\u6253\u5370\u5217 \u00b6 $ awk '/a/ {print $4 \"\\t\" $3}' marks.txt 90 Maths 87 Biology 85 English 89 History \u7edf\u8ba1\u5339\u914d\u6a21\u5f0f\u7684\u884c\u6570 \u00b6 $ awk '/a/{++cnt} END {print \"Count = \", cnt}' marks.txt Count = 4 \u6253\u5370\u8d85\u8fc718\u4e2a\u5b57\u7b26\u7684\u884c \u00b6 $ awk 'length($0) > 18' marks.txt 3) Shyam Biology 87 4) Kedar English 85 \u5185\u5efa\u53d8\u91cf \u00b6 AWK\u63d0\u4f9b\u4e86\u5f88\u591a\u5185\u7f6e\u7684\u53d8\u91cf\uff0c\u5b83\u4eec\u5728\u5f00\u53d1AWK\u811a\u672c\u7684\u8fc7\u7a0b\u4e2d\u8d77\u7740\u975e\u5e38\u91cd\u8981\u7684\u89d2\u8272\u3002 \u6807\u51c6AWK\u53d8\u91cf \u00b6 ARGC \u547d\u4ee4\u884c\u53c2\u6570\u4e2a\u6570 \u00b6 \u547d\u4ee4\u884c\u4e2d\u63d0\u4f9b\u7684\u53c2\u6570\u4e2a\u6570 $ awk 'BEGIN {print \"Arguments =\", ARGC}' One Two Three Four Arguments = 5 ARGV \u547d\u4ee4\u884c\u53c2\u6570\u6570\u7ec4 \u00b6 \u5b58\u50a8\u547d\u4ee4\u884c\u53c2\u6570\u7684\u6570\u7ec4\uff0c\u7d22\u5f15\u8303\u56f4\u4ece 0 - ARGC - 1 \u3002 $ awk 'BEGIN { for (i = 0; i < ARGC - 1; ++i) { printf \"ARGV[%d] = %s\\n\", i, ARGV[i] } }' one two three four ARGV[0] = awk ARGV[1] = one ARGV[2] = two ARGV[3] = three CONVFMT \u6570\u5b57\u7684\u7ea6\u5b9a\u683c\u5f0f \u00b6 \u4ee3\u8868\u4e86\u6570\u5b57\u7684\u7ea6\u5b9a\u683c\u5f0f\uff0c\u9ed8\u8ba4\u503c\u662f %.6g $ awk 'BEGIN { print \"Conversion Format =\", CONVFMT }' Conversion Format = %.6g ENVIRON \u73af\u5883\u53d8\u91cf \u00b6 \u73af\u5883\u53d8\u91cf\u7684\u5173\u8054\u6570\u7ec4 $ awk 'BEGIN { print ENVIRON[\"USER\"] }' mylxsw FILENAME \u5f53\u524d\u6587\u4ef6\u540d \u00b6 $ awk 'END {print FILENAME}' marks.txt marks.txt FS \u8f93\u5165\u5b57\u6bb5\u7684\u5206\u9694\u7b26 \u00b6 \u4ee3\u8868\u4e86\u8f93\u5165\u5b57\u6bb5\u7684\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u503c\u4e3a \u7a7a\u683c \uff0c\u53ef\u4ee5\u901a\u8fc7 -F \u9009\u9879\u5728\u547d\u4ee4\u884c\u9009\u9879\u4e2d\u4fee\u6539\u5b83\u3002 $ awk 'BEGIN {print \"FS = \" FS}' | cat -vte FS = $ $ awk -F , 'BEGIN {print \"FS = \" FS}' | cat -vte FS = ,$ NF \u5b57\u6bb5\u6570\u76ee \u00b6 \u4ee3\u8868\u4e86\u5f53\u524d\u884c\u4e2d\u7684\u5b57\u6bb5\u6570\u76ee\uff0c\u4f8b\u5982\u4e0b\u9762\u4f8b\u5b50\u6253\u5370\u51fa\u4e86\u5305\u542b\u5927\u4e8e\u4e24\u4e2a\u5b57\u6bb5\u7684\u884c $ echo -e \"One Two\\nOne Two Three\\nOne Two Three Four\" | awk 'NF > 2' One Two Three One Two Three Four NR \u884c\u53f7 \u00b6 $ echo -e \"One Two\\nOne Two Three\\nOne Two Three Four\" | awk 'NR < 3' One Two One Two Three FNR \u884c\u53f7\uff08\u76f8\u5bf9\u5f53\u524d\u6587\u4ef6\uff09 \u00b6 \u4e0eNR\u76f8\u4f3c\uff0c\u4e0d\u8fc7\u5728\u5904\u7406\u591a\u6587\u4ef6\u65f6\u66f4\u6709\u7528\uff0c\u83b7\u53d6\u7684\u884c\u53f7\u76f8\u5bf9\u4e8e\u5f53\u524d\u6587\u4ef6\u3002 OFMT \u8f93\u51fa\u683c\u5f0f\u6570\u5b57 \u00b6 \u9ed8\u8ba4\u503c\u4e3a %.6g $ awk 'BEGIN {print \"OFMT = \" OFMT}' OFMT = %.6g OFS \u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26 \u00b6 \u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u683c $ awk 'BEGIN {print \"OFS = \" OFS}' | cat -vte OFS = $ ORS \u8f93\u51fa\u884c\u5206\u9694\u7b26 \u00b6 \u9ed8\u8ba4\u503c\u4e3a\u6362\u884c\u7b26 $ awk 'BEGIN {print \"ORS = \" ORS}' | cat -vte ORS = $ $ RLENGTH \u00b6 \u4ee3\u8868\u4e86 match \u51fd\u6570\u5339\u914d\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u3002 $ awk 'BEGIN { if (match(\"One Two Three\", \"re\")) { print RLENGTH } }' 2 RS \u8f93\u5165\u8bb0\u5f55\u5206\u9694\u7b26 \u00b6 $ awk 'BEGIN {print \"RS = \" RS}' | cat -vte RS = $ $ RSTART \u00b6 match \u51fd\u6570\u5339\u914d\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u4f4d\u7f6e $ awk 'BEGIN { if (match(\"One Two Three\", \"Thre\")) { print RSTART } } 9 SUBSEP \u6570\u7ec4\u5b50\u811a\u672c\u7684\u5206\u9694\u7b26 \u00b6 \u6570\u7ec4\u5b50\u811a\u672c\u7684\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a \\034 $ awk 'BEGIN { print \"SUBSEP = \" SUBSEP }' | cat -vte SUBSEP = ^\\$ $ 0 \u4ee3\u8868\u4e86\u5f53\u524d\u884c \u00b6 \u4ee3\u8868\u4e86\u5f53\u524d\u884c $ awk '{print $0}' marks.txt 1) Amit Physics 80 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89 $n \u00b6 \u5f53\u524d\u884c\u4e2d\u7684\u7b2cn\u4e2a\u5b57\u6bb5 $ awk '{print $3 \"\\t\" $4}' marks.txt Physics 80 Maths 90 Biology 87 English 85 History 89 GNU AWK\u7684\u53d8\u91cf \u00b6 ARGIND \u00b6 \u5f53\u524d\u88ab\u5904\u7406\u7684ARGV\u7684\u7d22\u5f15 $ awk '{ print \"ARGIND = \", ARGIND; print \"Filename = \", ARGV[ARGIND] }' junk1 junk2 junk3 ARGIND = 1 Filename = junk1 ARGIND = 2 Filename = junk2 ARGIND = 3 Filename = junk3 BINMODE \u00b6 \u5728\u975ePOSIX\u7cfb\u7edf\u4e0a\u6307\u5b9a\u5bf9\u6240\u6709\u7684\u6587\u4ef6I/O\u91c7\u7528\u4e8c\u8fdb\u5236\u6a21\u5f0f\u3002 ERRORNO \u00b6 \u4e00\u4e2a\u4ee3\u8868\u4e86 getline \u8df3\u8f6c\u5931\u8d25\u6216\u8005\u662f close \u8c03\u7528\u5931\u8d25\u7684\u9519\u8bef\u7684\u5b57\u7b26\u4e32\u3002 $ awk 'BEGIN { ret = getline < \"junk.txt\"; if (ret == -1) print \"Error:\", ERRNO }' Error: No such file or directory FIELDWIDTHS \u00b6 \u8bbe\u7f6e\u4e86\u7a7a\u683c\u5206\u9694\u7684\u5b57\u6bb5\u5bbd\u5ea6\u53d8\u91cf\u5217\u8868\u7684\u8bdd\uff0cGAWK\u4f1a\u5c06\u8f93\u5165\u89e3\u6790\u4e3a\u56fa\u5b9a\u5bbd\u5ea6\u7684\u5b57\u6bb5\uff0c\u800c\u4e0d\u662f\u4f7f\u7528 FS \u8fdb\u884c\u5206\u9694\u3002 IGNORECASE \u00b6 \u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u53d8\u91cf\u7684\u8bdd\uff0cAWK\u4f1a\u5ffd\u7565\u5927\u5c0f\u5199\u3002 $ awk 'BEGIN{IGNORECASE = 1} /amit/' marks.txt 1) Amit Physics 80 LINT \u00b6 \u63d0\u4f9b\u4e86\u5bf9 --lint \u9009\u9879\u7684\u52a8\u6001\u63a7\u5236\u3002 $ awk 'BEGIN {LINT = 1; a}' awk: cmd. line:1: warning: reference to uninitialized variable `a' awk: cmd. line:1: warning: statement has no effect PROCINFO \u00b6 \u5305\u542b\u8fdb\u7a0b\u4fe1\u606f\u7684\u5173\u8054\u6570\u7ec4\uff0c\u4f8b\u5982UID\uff0c\u8fdb\u7a0bID\u7b49 $ awk 'BEGIN { print PROCINFO[\"pid\"] }' 4316 TEXTDOMAIN \u00b6 \u4ee3\u8868\u4e86AWK\u7684\u6587\u672c\u57df\uff0c\u7528\u4e8e\u67e5\u627e\u5b57\u7b26\u4e32\u7684\u672c\u5730\u5316\u7ffb\u8bd1\u3002 $ awk 'BEGIN { print TEXTDOMAIN }' messages \u64cd\u4f5c\u7b26 \u00b6 \u4e0e\u5176\u5b83\u7f16\u7a0b\u8bed\u8a00\u4e00\u6837\uff0cAWK\u4e5f\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u64cd\u4f5c\u7b26\u3002 \u7b97\u6570\u64cd\u4f5c\u7b26 \u00b6 \u7b97\u6570\u64cd\u4f5c\u7b26\u4e0d\u591a\u8bf4\uff0c\u76f4\u63a5\u770b\u4f8b\u5b50\uff0c\u65e0\u975e\u5c31\u662f +-*/% $ awk 'BEGIN { a = 50; b = 20; print \"(a + b) = \", (a + b) }' (a + b) = 70 $ awk 'BEGIN { a = 50; b = 20; print \"(a - b) = \", (a - b) }' (a - b) = 30 $ awk 'BEGIN { a = 50; b = 20; print \"(a * b) = \", (a * b) }' (a * b) = 1000 $ awk 'BEGIN { a = 50; b = 20; print \"(a / b) = \", (a / b) }' (a / b) = 2.5 $ awk 'BEGIN { a = 50; b = 20; print \"(a % b) = \", (a % b) }' (a % b) = 10 \u589e\u51cf\u8fd0\u7b97\u7b26 \u00b6 \u81ea\u589e\u81ea\u51cf\u4e0eC\u8bed\u8a00\u4e00\u81f4\u3002 $ awk 'BEGIN { a = 10; b = ++a; printf \"a = %d, b = %d\\n\", a, b }' a = 11, b = 11 $ awk 'BEGIN { a = 10; b = --a; printf \"a = %d, b = %d\\n\", a, b }' a = 9, b = 9 $ awk 'BEGIN { a = 10; b = a++; printf \"a = %d, b = %d\\n\", a, b }' a = 11, b = 10 $ awk 'BEGIN { a = 10; b = a--; printf \"a = %d, b = %d\\n\", a, b }' a = 9, b = 10 \u8d4b\u503c\u64cd\u4f5c\u7b26 \u00b6 $ awk 'BEGIN { name = \"Jerry\"; print \"My name is\", name }' My name is Jerry $ awk 'BEGIN { cnt = 10; cnt += 10; print \"Counter =\", cnt }' Counter = 20 $ awk 'BEGIN { cnt = 100; cnt -= 10; print \"Counter =\", cnt }' Counter = 90 $ awk 'BEGIN { cnt = 10; cnt *= 10; print \"Counter =\", cnt }' Counter = 100 $ awk 'BEGIN { cnt = 100; cnt /= 5; print \"Counter =\", cnt }' Counter = 20 $ awk 'BEGIN { cnt = 100; cnt %= 8; print \"Counter =\", cnt }' Counter = 4 $ awk 'BEGIN { cnt = 2; cnt ^= 4; print \"Counter =\", cnt }' Counter = 16 $ awk 'BEGIN { cnt = 2; cnt **= 4; print \"Counter =\", cnt }' Counter = 16 \u5173\u7cfb\u64cd\u4f5c\u7b26 \u00b6 $ awk 'BEGIN { a = 10; b = 10; if (a == b) print \"a == b\" }' a == b $ awk 'BEGIN { a = 10; b = 20; if (a != b) print \"a != b\" }' a != b $ awk 'BEGIN { a = 10; b = 20; if (a < b) print \"a < b\" }' a < b $ awk 'BEGIN { a = 10; b = 10; if (a <= b) print \"a <= b\" }' a <= b $ awk 'BEGIN { a = 10; b = 20; if (b > a ) print \"b > a\" }' b > a \u903b\u8f91\u64cd\u4f5c\u7b26 \u00b6 $ awk 'BEGIN { num = 5; if (num >= 0 && num <= 7) printf \"%d is in octal format\\n\", num }' 5 is in octal format $ awk 'BEGIN { ch = \"\\n\"; if (ch == \" \" || ch == \"\\t\" || ch == \"\\n\") print \"Current character is whitespace.\" }' Current character is whitespace. $ awk 'BEGIN { name = \"\"; if (! length(name)) print \"name is empty string.\" }' name is empty string. \u4e09\u5143\u64cd\u4f5c\u7b26 \u00b6 $ awk 'BEGIN { a = 10; b = 20; (a > b) ? max = a : max = b; print \"Max =\", max}' Max = 20 \u4e00\u5143\u64cd\u4f5c\u7b26 \u00b6 $ awk 'BEGIN { a = -10; a = +a; print \"a =\", a }' a = -10 $ awk 'BEGIN { a = -10; a = -a; print \"a =\", a }' a = 10 \u6307\u6570\u64cd\u4f5c\u7b26 \u00b6 $ awk 'BEGIN { a = 10; a = a ^ 2; print \"a =\", a }' a = 100 $ awk 'BEGIN { a = 10; a ^= 2; print \"a =\", a }' a = 100 \u5b57\u7b26\u4e32\u8fde\u63a5\u64cd\u4f5c\u7b26 \u00b6 $ awk 'BEGIN { str1 = \"Hello, \"; str2 = \"World\"; str3 = str1 str2; print str3 }' Hello, World \u6570\u7ec4\u6210\u5458\u64cd\u4f5c\u7b26 \u00b6 $ awk 'BEGIN { arr[0] = 1; arr[1] = 2; arr[2] = 3; for (i in arr) printf \"arr[%d] = %d\\n\", i, arr[i] }' arr[2] = 3 arr[0] = 1 arr[1] = 2 \u6b63\u5219\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26 \u00b6 \u6b63\u5219\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26\u4f7f\u7528 ~ \u548c !~ \u5206\u522b\u4ee3\u8868\u5339\u914d\u548c\u4e0d\u5339\u914d\u3002 $ awk '$0 ~ 9' marks.txt 2) Rahul Maths 90 5) Hari History 89 $ awk '$0 !~ 9' marks.txt 1) Amit Physics 80 3) Shyam Biology 87 4) Kedar English 85 # \u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u9700\u8981\u5728\u8868\u8fbe\u5f0f\u524d\u540e\u6dfb\u52a0\u53cd\u659c\u7ebf\uff0c\u4e0ejs\u7c7b\u4f3c\u5427 $ tail -n 40 /var/log/nginx/access.log | awk '$0 ~ /ip\\[127\\.0\\.0\\.1\\]/' \u66f4\u591a\u5173\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u8bf7\u770b\u540e\u9762\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u90e8\u5206 \u6b63\u5219\u8868\u8fbe\u5f0f \u00b6 AWK\u5728\u5904\u7406\u6b63\u5219\u8868\u8fbe\u5f0f\u65b9\u9762\u662f\u975e\u5e38\u5f3a\u5927\u7684\uff0c\u4f7f\u7528\u7b80\u5355\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5904\u7406\u975e\u5e38\u590d\u6742\u7684\u95ee\u9898\u3002 $ echo -e \"cat\\nbat\\nfun\\nfin\\nfan\" | awk '/f.n/' fun fin fan $ echo -e \"This\\nThat\\nThere\\nTheir\\nthese\" | awk '/^The/' There Their $ echo -e \"knife\\nknow\\nfun\\nfin\\nfan\\nnine\" | awk '/n$/' fun fin fan $ echo -e \"Call\\nTall\\nBall\" | awk '/[CT]all/' Call Tall $ echo -e \"Call\\nTall\\nBall\" | awk '/[^CT]all/' Ball $ echo -e \"Call\\nTall\\nBall\\nSmall\\nShall\" | awk '/Call|Ball/' Call Ball $ echo -e \"Colour\\nColor\" | awk '/Colou?r/' Colour Color $ echo -e \"ca\\ncat\\ncatt\" | awk '/cat*/' ca cat catt $ echo -e \"111\\n22\\n123\\n234\\n456\\n222\" | awk '/2+/' 22 123 234 222 $ echo -e \"Apple Juice\\nApple Pie\\nApple Tart\\nApple Cake\" | awk '/Apple (Juice|Cake)/' Apple Juice Apple Cake \u6570\u7ec4 \u00b6 AWK\u652f\u6301\u5173\u8054\u6570\u7ec4\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u4f7f\u7528\u6570\u5b57\u7d22\u5f15\u7684\u6570\u7ec4\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5b57\u7b26\u4e32\u4f5c\u4e3a\u7d22\u5f15\uff0c\u800c\u4e14\u6570\u5b57\u7d22\u5f15\u4e5f\u4e0d\u8981\u6c42\u662f\u8fde\u7eed\u7684\u3002\u6570\u7ec4\u4e0d\u9700\u8981\u58f0\u660e\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u8bed\u6cd5\u5982\u4e0b\uff1a array_name[index] = value \u521b\u5efa\u6570\u7ec4\u7684\u65b9\u5f0f\u975e\u5e38\u7b80\u5355\uff0c\u76f4\u63a5\u4e3a\u53d8\u91cf\u8d4b\u503c\u5373\u53ef $ awk 'BEGIN { fruits[\"mango\"] = \"yellow\"; fruits[\"orange\"] = \"orange\" print fruits[\"orange\"] \"\\n\" fruits[\"mango\"] }' orange yellow \u5220\u9664\u6570\u7ec4\u5143\u7d20\u4f7f\u7528 delete \u8bed\u53e5 $ awk 'BEGIN { fruits[\"mango\"] = \"yellow\"; fruits[\"orange\"] = \"orange\"; delete fruits[\"orange\"]; print fruits[\"orange\"] }' \u5728AWK\u4e2d\uff0c\u53ea\u652f\u6301\u4e00\u7ef4\u6570\u7ec4\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u4e00\u7ef4\u6570\u7ec4\u6a21\u62df\u591a\u7ef4\uff0c\u4f8b\u5982\u6211\u4eec\u6709\u4e00\u4e2a3x3\u7684\u4e09\u7ef4\u6570\u7ec4 100 200 300 400 500 600 700 800 900 \u53ef\u4ee5\u8fd9\u6837\u64cd\u4f5c $ awk 'BEGIN { array[\"0,0\"] = 100; array[\"0,1\"] = 200; array[\"0,2\"] = 300; array[\"1,0\"] = 400; array[\"1,1\"] = 500; array[\"1,2\"] = 600; # print array elements print \"array[0,0] = \" array[\"0,0\"]; print \"array[0,1] = \" array[\"0,1\"]; print \"array[0,2] = \" array[\"0,2\"]; print \"array[1,0] = \" array[\"1,0\"]; print \"array[1,1] = \" array[\"1,1\"]; print \"array[1,2] = \" array[\"1,2\"]; }' array[0,0] = 100 array[0,1] = 200 array[0,2] = 300 array[1,0] = 400 array[1,1] = 500 array[1,2] = 600 \u6d41\u7a0b\u63a7\u5236 \u00b6 \u6d41\u7a0b\u63a7\u5236\u8bed\u53e5\u4e0e\u5927\u591a\u6570\u8bed\u8a00\u4e00\u6837\uff0c\u57fa\u672c\u683c\u5f0f\u5982\u4e0b if (condition) action if (condition) { action-1 action-1 . . action-n } if (condition) action-1 else if (condition2) action-2 else action-3 \u4f8b\u5982\uff1a $ awk 'BEGIN { num = 11; if (num % 2 == 0) printf \"%d is even number.\\n\", num; else printf \"%d is odd number.\\n\", num }' $ awk 'BEGIN { a = 30; if (a==10) print \"a = 10\"; else if (a == 20) print \"a = 20\"; else if (a == 30) print \"a = 30\"; }' \u5faa\u73af \u00b6 \u5faa\u73af\u64cd\u4f5c\u4e0e\u5176\u4ed6C\u7cfb\u8bed\u8a00\u4e00\u6837\uff0c\u4e3b\u8981\u5305\u62ec for \uff0c while \uff0c do...while \uff0c break \uff0c continue \u8bed\u53e5\uff0c\u5f53\u7136\uff0c\u8fd8\u6709\u4e00\u4e2a exit \u8bed\u53e5\u7528\u4e8e\u9000\u51fa\u811a\u672c\u6267\u884c\u3002 for (initialisation; condition; increment/decrement) action while (condition) action do action while (condition) \u4f8b\u5b50\uff1a $ awk 'BEGIN { for (i = 1; i <= 5; ++i) print i }' $ awk 'BEGIN {i = 1; while (i < 6) { print i; ++i } }' $ awk 'BEGIN {i = 1; do { print i; ++i } while (i < 6) }' $ awk 'BEGIN { sum = 0; for (i = 0; i < 20; ++i) { sum += i; if (sum > 50) break; else print \"Sum =\", sum } }' $ awk 'BEGIN { for (i = 1; i <= 20; ++i) { if (i % 2 == 0) print i ; else continue } }' $ awk 'BEGIN { sum = 0; for (i = 0; i < 20; ++i) { sum += i; if (sum > 50) exit(10); else print \"Sum =\", sum } }' exit \u7528\u4e8e\u9000\u51fa\u811a\u672c\uff0c\u53c2\u6570\u4e3a\u9000\u51fa\u7684\u72b6\u6001\u7801\uff0c\u53ef\u4ee5\u901a\u8fc7shell\u4e2d\u7684 $? \u83b7\u53d6 \u51fd\u6570 \u00b6 \u5185\u5efa\u51fd\u6570 \u00b6 AWK\u63d0\u4f9b\u4e86\u5f88\u591a\u65b9\u4fbf\u7684\u5185\u5efa\u51fd\u6570\u4f9b\u7f16\u7a0b\u4eba\u5458\u4f7f\u7528\u3002\u7531\u4e8e\u51fd\u6570\u6bd4\u8f83\u591a\uff0c\u4e2a\u4eba\u89c9\u5f97\u5355\u7eaf\u770b\u6bcf\u4e2a\u51fd\u6570\u7684\u4f7f\u7528\u4e5f\u6ca1\u6709\u4ec0\u4e48\u5b9e\u9645\u610f\u4e49\uff0c\u6bd4\u8f83\u5bb9\u6613\u9057\u5fd8\uff0c\u56e0\u6b64\uff0c\u8fd9\u91cc\u53ea\u7b80\u5355\u7684\u5217\u51fa\u5e38\u7528\u7684\u4e00\u4e9b\u51fd\u6570\uff0c\u53ea\u9700\u8981\u5bf9\u5176\u6709\u4e2a\u5370\u8c61\u5373\u53ef\uff0c\u4f7f\u7528\u7684\u65f6\u5019\u518d\u53bb \u67e5\u624b\u518c \u6548\u679c\u4f1a\u66f4\u597d\u4e00\u4e9b\u5427\u3002 \u6570\u5b66\u51fd\u6570 \u00b6 atan2(y, x) cos(expr) exp(expr) int(expr) log(expr) rand sin(expr) sqrt(expr) srand([expr]) \u5b57\u7b26\u4e32\u51fd\u6570 \u00b6 asort(arr [, d [, how] ]) asorti(arr [, d [, how] ]) gsub(regex, sub, string) index(str, sub) length(str) match(str, regex) split(str, arr, regex) sprintf(format, expr-list) strtonum(str) sub(regex, sub, string) substr(str, start, l) tolower(str) toupper(str) \u65f6\u95f4\u51fd\u6570 \u00b6 systime mktime(datespec) strftime([format [, timestamp[, utc-flag]]]) \u5b57\u8282\u64cd\u4f5c\u51fd\u6570 \u00b6 and compl lshift rshift or xor \u5176\u5b83 \u00b6 close(expr) \u5173\u95ed\u7ba1\u9053\u6587\u4ef6 \u8bf7\u770b\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801 $ awk 'BEGIN { cmd = \"tr [a-z] [A-Z]\" print \"hello, world !!!\" |& cmd close(cmd, \"to\") cmd |& getline out print out; close(cmd); }' HELLO, WORLD !!! \u662f\u4e0d\u662f\u611f\u89c9\u5f88\u96be\u61c2\uff1f\u8ba9\u6211\u6765\u89e3\u91ca\u4e00\u4e0b \u7b2c\u4e00\u4e2a\u8bed\u53e5 cmd = \"tr [a-z] [A-Z]\" \u662f\u6211\u4eec\u5728AWK\u4e2d\u8981\u7528\u6765\u5efa\u7acb\u53cc\u5411\u8fde\u63a5\u7684\u547d\u4ee4\u3002 \u7b2c\u4e8c\u4e2a\u8bed\u53e5 print \u63d0\u4f9b\u4e86 tr \u547d\u4ee4\u7684\u8f93\u5165\uff0c\u4f7f\u7528 &| \u8868\u540d\u5efa\u7acb\u53cc\u5411\u8fde\u63a5\u3002 \u7b2c\u4e09\u4e2a\u8bed\u53e5 close(cmd, \"to\") \u7528\u4e8e\u6267\u884c\u5b8c\u6210\u540e\u5173\u95ed to \u8fdb\u7a0b \u7b2c\u56db\u4e2a\u8bed\u53e5 cmd |& getline out \u4f7f\u7528 getline \u51fd\u6570\u5b58\u50a8\u8f93\u51fa\u5230 out \u53d8\u91cf \u63a5\u4e0b\u6765\u6253\u5370\u53d8\u91cfout\u7684\u5185\u5bb9\uff0c\u7136\u540e\u5173\u95edcmd delete \u7528\u4e8e\u5220\u9664\u6570\u7ec4\u5143\u7d20 exit \u9000\u51fa\u811a\u672c\u6267\u884c\uff0c\u5e76\u8fd4\u56de\u72b6\u6001\u7801\u53c2\u6570 fflush getline \u8be5\u547d\u4ee4\u8ba9awk\u8bfb\u53d6\u4e0b\u4e00\u884c\u5185\u5bb9 \u8be5\u547d\u4ee4\u8ba9awk\u8bfb\u53d6\u4e0b\u4e00\u884c\u5185\u5bb9\uff0c\u6bd4\u5982 $ awk '{getline; print $0}' marks.txt 2) Rahul Maths 90 4) Kedar English 85 5) Hari History 89 \u4f7f\u7528 getline var < file \u53ef\u4ee5\u4ecefile\u4e2d\u8bfb\u53d6\u8f93\u5165\uff0c\u5b58\u50a8\u5230\u53d8\u91cfvar\u4e2d { if (NF == 2 && $1 == \"@include\") { while ((getline line < $2) > 0) print line # \u8fd9\u91cc\u7684close\u786e\u4fdd\u5982\u679c\u6587\u4ef6\u4e2d\u4e24\u4e2a@include\uff0c\u53ef\u4ee5\u8ba9\u5176\u8bfb\u53d6\u4e24\u6b21 close($2) } else print } \u547d\u4ee4\u7684\u8f93\u51fa\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7ba1\u9053\u8f93\u5165\u5230 getline \uff0c\u4f7f\u7528 command | getline \u8fd9\u79cd\u65b9\u5f0f\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b57\u7b26\u4e32\u547d\u4ee4\u4f1a\u4f5c\u4e3ashell\u547d\u4ee4\u6267\u884c\uff0c\u5176\u6807\u51c6\u8f93\u51fa\u4f1a\u901a\u8fc7\u7ba1\u9053\u4f20\u9012\u4e2aawk\u4f5c\u4e3a\u5176\u8f93\u5165\uff0c\u8fd9\u79cd\u5f62\u5f0f\u7684getline\u4f1a\u4ece\u7ba1\u9053\u4e2d\u4e00\u6b21\u8bfb\u53d6\u4e00\u6761\u8bb0\u5f55\u3002\u4f8b\u5982\u4e0b\u9762\u7684\u547d\u4ee4\u4f1a\u4ece\u8f93\u5165\u4e2d\u9010\u884c\u8bfb\u53d6\uff0c\u5982\u679c\u9047\u5230 @execute \uff0c\u5219\u5c06\u8be5\u884c\u4f5c\u4e3a\u547d\u4ee4\u6267\u884c\uff0c\u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u4f5c\u4e3a\u6700\u7ec8\u7684\u8f93\u51fa\u5185\u5bb9 { if ($1 == \"@execute\") { tmp = substr($0, 10) # Remove \"@execute\" while ((tmp | getline) > 0) # \u8fd9\u91cc\u5b9e\u9645\u4e0a\u8bbe\u7f6e\u4e86$0\u4e3a\u8fd9\u4e00\u884c\u7684\u5185\u5bb9 print close(tmp) } else print } \u5982\u679c\u6587\u4ef6\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9 foo bar baz @execute who bletch \u5219\u4f1a\u8f93\u51fa foo bar baz arnold ttyv0 Jul 13 14:22 miriam ttyp0 Jul 13 14:23 (murphy:0) bill ttyp1 Jul 13 14:23 (murphy:0) bletch \u4f7f\u7528 command | getline var \u53ef\u4ee5\u5b9e\u73b0\u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u5199\u5165\u5230\u53d8\u91cfvar\u3002 BEGIN { \"date\" | getline current_time close(\"date\") print \"Report printed on \" current_time } getline \u4f7f\u7528\u7ba1\u9053\u8bfb\u53d6\u8f93\u5165\u662f\u4e00\u79cd\u5355\u5411\u7684\u64cd\u4f5c\uff0c\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4f60\u53ef\u80fd\u5e0c\u671b\u53d1\u9001\u6570\u636e\u5230\u53e6\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u7136\u540e\u4ece\u8fd9\u4e2a\u8fdb\u7a0b\u4e2d\u8bfb\u53d6\u5904\u7406\u540e\u7684\u7ed3\u679c\uff0c \u8fd9\u5c31\u7528\u5230\u4e86\u534f\u540c\u8fdb\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 |& \u6253\u5f00\u4e00\u4e2a\u53cc\u5411\u7ba1\u9053\u3002 print \"some query\" |& \"db_server\" \"db_server\" |& getline \u540c\u6837\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528 command |& getline var \u5c06\u534f\u540c\u8fdb\u7a0b\u7684\u8f93\u51fa\u5199\u5165\u5230\u53d8\u91cfvar\u3002 next nextfile return \u7528\u4e8e\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u8fd4\u56de\u503c\u3002 \u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a functions.awk \u6587\u4ef6\uff0c\u5305\u542b\u4e0b\u9762\u7684awk\u547d\u4ee4 function addition(num1, num2) { result = num1 + num2 return result } BEGIN { res = addition(10, 20) print \"10 + 20 = \" res } \u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\uff0c\u8f93\u51fa 10 + 20 = 30 system \u8be5\u51fd\u6570\u7528\u4e8e\u6267\u884c\u6307\u5b9a\u7684\u547d\u4ee4\u5e76\u4e14\u8fd4\u56de\u5b83\u7684\u9000\u51fa\u72b6\u6001\uff0c\u8fd4\u56de\u72b6\u6001\u78010\u8868\u793a\u547d\u4ee4\u6210\u529f\u6267\u884c\u3002 $ awk 'BEGIN { ret = system(\"date\"); print \"Return value = \" ret }' 2016\u5e74 10\u6708 27\u65e5 \u661f\u671f\u56db 22:08:36 CST Return value = 0 \u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570 \u00b6 \u51fd\u6570\u662f\u7a0b\u5e8f\u57fa\u672c\u7684\u7ec4\u6210\u90e8\u5206\uff0cAWK\u5141\u8bb8\u6211\u4eec\u81ea\u5df1\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u3002\u4e00\u4e2a\u5927\u578b\u7684\u7a0b\u5e8f\u53ef\u4ee5\u88ab\u5212\u5206\u4e3a\u591a\u4e2a\u51fd\u6570\uff0c\u6bcf\u4e2a\u51fd\u6570\u4e4b\u95f4\u53ef\u4ee5\u72ec\u7acb\u7684\u5f00\u53d1\u548c\u6d4b\u8bd5\uff0c\u63d0\u4f9b\u53ef\u91cd\u7528\u7684\u4ee3\u7801\u3002 \u4e0b\u9762\u662f\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u57fa\u672c\u8bed\u6cd5 function function_name(argument1, argument2, ...) { function body } \u4f8b\u5982\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3afunctions.awk\u7684\u6587\u4ef6\uff0c\u5305\u542b\u4e0b\u9762\u7684\u4ee3\u7801 # Returns minimum number function find_min(num1, num2){ if (num1 < num2) return num1 return num2 } # Returns maximum number function find_max(num1, num2){ if (num1 > num2) return num1 return num2 } # Main function function main(num1, num2){ # Find minimum number result = find_min(10, 20) print \"Minimum =\", result # Find maximum number result = find_max(10, 20) print \"Maximum =\", result } # Script execution starts here BEGIN { main(10, 20) } \u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\uff0c\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u8f93\u51fa Minimum = 10 Maximum = 20 \u8f93\u51fa\u91cd\u5b9a\u5411 \u00b6 \u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26 \u00b6 \u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u6240\u6709\u7684\u7a0b\u5e8f\u90fd\u662f\u76f4\u63a5\u663e\u793a\u6570\u636e\u5230\u4e86\u6807\u51c6\u8f93\u51fa\u6d41\uff0c\u5176\u5b9e\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u3002\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\u8ddf\u5728 print \u548c printf \u51fd\u6570\u7684\u540e\u9762\uff0c\u4e0eshell\u4e2d\u7684\u7528\u6cd5\u57fa\u672c\u4e00\u81f4\u3002 print DATA > output-file print DATA >> output-file \u4f8b\u5982\uff0c\u4e0b\u9762\u4e24\u6761\u547d\u4ee4\u8f93\u51fa\u662f\u4e00\u81f4\u7684 $ echo \"Hello, World !!!\" > /tmp/message.txt $ awk 'BEGIN { print \"Hello, World !!!\" > \"/tmp/message.txt\" }' \u4e0eshell\u4e2d\u4e00\u6837\uff0c > \u7528\u4e8e\u5c06\u8f93\u51fa\u5199\u5165\u5230\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\uff0c\u5982\u679c\u6587\u4ef6\u4e2d\u6709\u5185\u5bb9\u5219\u8986\u76d6\uff0c\u800c >> \u5219\u4e3a\u8ffd\u52a0\u6a21\u5f0f\u5199\u5165\u3002 $ awk 'BEGIN { print \"Hello, World !!!\" >> \"/tmp/message.txt\" }' $ cat /tmp/message.txt \u7ba1\u9053 \u00b6 \u9664\u4e86\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u4e4b\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u5176\u5b83\u7a0b\u5e8f\uff0c\u4e0eshell\u4e2d\u4e00\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7ba1\u9053\u64cd\u4f5c\u7b26 | \u3002 $ awk 'BEGIN { print \"hello, world !!!\" | \"tr [a-z] [A-Z]\" }' HELLO, WORLD !!! AWK\u4e2d\u53ef\u4ee5\u4f7f\u7528 |& \u8fdb\u884c \u53cc\u5411\u8fde\u63a5 \uff0c\u90a3\u4e48\u4ec0\u4e48\u662f\u53cc\u5411\u8fde\u63a5\u5462\uff1f\u4e00\u79cd\u5e38\u89c1\u7684\u573a\u666f\u662f\u6211\u4eec\u53d1\u9001\u6570\u636e\u5230\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u5904\u7406\uff0c\u7136\u540e\u8bfb\u53d6\u5904\u7406\u7ed3\u679c\uff0c\u8fd9\u79cd\u573a\u666f\u4e0b\u5c31\u9700\u8981\u6253\u5f00\u4e00\u4e2a\u5230\u53e6\u5916\u4e00\u4e2a\u8fdb\u7a0b\u7684\u53cc\u5411\u7ba1\u9053\u4e86\u3002\u7b2c\u4e8c\u4e2a\u8fdb\u7a0b\u4f1a\u4e0e gawk \u7a0b\u5e8f\u5e76\u884c\u6267\u884c\uff0c\u8fd9\u91cc\u79f0\u5176\u4e3a \u534f\u4f5c\u8fdb\u7a0b \u3002\u4e0e\u5355\u5411\u8fde\u63a5\u4f7f\u7528 | \u64cd\u4f5c\u7b26\u4e0d\u540c\u7684\u662f\uff0c\u53cc\u5411\u8fde\u63a5\u4f7f\u7528 |& \u64cd\u4f5c\u7b26\u3002 do { print data |& \"subprogram\" \"subprogram\" |& getline results } while (data left to process) close(\"subprogram\") \u7b2c\u4e00\u6b21I/O\u64cd\u4f5c\u4f7f\u7528\u4e86 |& \u64cd\u4f5c\u7b26\uff0cgawk\u4f1a\u521b\u5efa\u4e00\u4e2a\u5230\u8fd0\u884c\u5176\u5b83\u7a0b\u5e8f\u7684\u5b50\u8fdb\u7a0b\u7684\u53cc\u5411\u7ba1\u9053\uff0c print \u7684\u8f93\u51fa\u88ab\u5199\u5165\u5230\u4e86 subprogram \u7684\u6807\u51c6\u8f93\u5165\uff0c\u800c\u8fd9\u4e2a subprogram \u7684\u6807\u51c6\u8f93\u51fa\u5728gawk\u4e2d\u4f7f\u7528 getline \u51fd\u6570\u8fdb\u884c\u8bfb\u53d6\u3002 \u6ce8\u610f\uff1a\u76ee\u524d\u534f\u540c\u8fdb\u7a0b\u7684\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u5c06\u4f1a\u548cgawk\u7684\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u6df7\u6742\u5728\u4e00\u8d77\uff0c\u65e0\u6cd5\u5355\u72ec\u83b7\u53d6\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002\u53e6\u5916\uff0cI/O\u7f13\u51b2\u53ef\u80fd\u5b58\u5728\u95ee\u9898\uff0cgawk\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u7684\u5237\u65b0\u6240\u6709\u8f93\u51fa\u5230\u4e0b\u6e38\u7684\u534f\u540c\u8fdb\u7a0b\u7684\u7ba1\u9053\u3002\u4f46\u662f\uff0c\u5982\u679c\u534f\u540c\u8fdb\u7a0b\u6ca1\u6709\u5237\u65b0\u5176\u6807\u51c6\u8f93\u51fa\u7684\u8bdd\uff0cgawk\u5c06\u53ef\u80fd\u4f1a\u5728\u4f7f\u7528 getline \u51fd\u6570\u4ece\u534f\u540c\u8fdb\u7a0b\u8bfb\u53d6\u8f93\u51fa\u7684\u65f6\u5019\u6302\u8d77\uff0c\u8fd9\u5c31\u53ef\u80fd\u5f15\u8d77\u6b7b\u9501\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 close \u51fd\u6570\u5173\u95ed\u53cc\u5411\u7ba1\u9053\u7684 to \u6216\u8005 from \u4e00\u7aef\uff0c\u8fd9\u4e24\u4e2a\u5b57\u7b26\u4e32\u503c\u544a\u8bc9gawk\u53d1\u9001\u6570\u636e\u5230\u534f\u540c\u8fdb\u7a0b\u5b8c\u6210\u65f6\u6216\u8005\u4ece\u534f\u540c\u8fdb\u7a0b\u8bfb\u53d6\u5b8c\u6bd5\u65f6\u5173\u95ed\u7ba1\u9053\u3002\u5728\u4f7f\u7528\u7cfb\u7edf\u547d\u4ee4 sort \u7684\u65f6\u5019\u662f\u8fd9\u6837\u505a\u662f\u975e\u5e38\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a\u5b83\u5fc5\u987b\u7b49\u6240\u6709\u8f93\u51fa\u90fd\u8bfb\u53d6\u5b8c\u6bd5\u65f6\u624d\u80fd\u8fdb\u884c\u6392\u5e8f\u3002 BEGIN { command = \"LC_ALL=C sort\" n = split(\"abcdefghijklmnopqrstuvwxyz\", a, \"\") for (i = n; i > 0; i--) print a[i] |& command close(command, \"to\") while ((command |& getline line) > 0) print \"got\", line close(command) } \u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\u4f7f\u7528 tr \u547d\u4ee4\u8f6c\u6362\u5c0f\u5199\u4e3a\u5927\u5199\u3002\u6211\u4eec\u7684 command.awk \u6587\u4ef6\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9 BEGIN { cmd = \"tr [a-z] [A-Z]\" print \"hello, world !!!\" |& cmd close(cmd, \"to\") cmd |& getline out print out; close(cmd); } \u8f93\u51fa HELLO, WORLD !!! \u4e0a\u4f8b\u770b\u8d77\u6765\u6709\u4e9b\u590d\u6742\uff0c\u6211\u4eec\u9010\u884c\u5206\u6790\u4e00\u4e0b \u9996\u5148\uff0c\u7b2c\u4e00\u884c cmd = \"tr [a-z] [A-Z]\" \u662f\u5728AWK\u4e2d\u8981\u5efa\u7acb\u53cc\u5411\u8fde\u63a5\u7684\u547d\u4ee4 \u7b2c\u4e8c\u884c\u7684 print \u547d\u4ee4\u7528\u4e8e\u4e3a tr \u547d\u4ee4\u63d0\u4f9b\u8f93\u5165\uff0c\u800c |& \u7528\u4e8e\u6307\u51fa\u8981\u5efa\u7acb\u53cc\u5411\u8fde\u63a5 \u7b2c\u4e09\u884c\u7528\u4e8e\u5728\u4e0a\u9762\u7684\u8bed\u53e5 close(cmd, \"to\"), \u5728\u6267\u884c\u5b8c\u6210\u540e\u5173\u95ed\u5176 to \u8fdb\u7a0b \u7b2c\u56db\u884c cmd |& getline out \u4f7f\u7528getline\u51fd\u6570\u5b58\u50a8\u8f93\u51fa\u5230\u53d8\u91cfout\u4e2d \u6700\u540e\u4e00\u884c\u4f7f\u7528 close \u51fd\u6570\u5173\u95ed\u547d\u4ee4 \u7f8e\u5316\u8f93\u51fa \u00b6 \u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u4f7f\u7528\u8fc7 print \u548c printf \u51fd\u6570\u663e\u793a\u6570\u636e\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u4f46\u662f printf \u51fd\u6570\u5b9e\u9645\u4e0a\u8981\u6bd4\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684\u60c5\u51b5\u66f4\u52a0\u5f3a\u5927\u5f97\u591a\u3002\u8be5\u51fd\u6570\u662f\u4eceC\u8bed\u8a00\u4e2d\u501f\u9274\u6765\u7684\uff0c\u5728\u5904\u7406\u683c\u5f0f\u5316\u7684\u8f93\u51fa\u65f6\u975e\u5e38\u6709\u7528\u3002 $ awk 'BEGIN { printf \"Hello\\nWorld\\n\" }' Hello World $ awk 'BEGIN { printf \"ASCII value 65 = character %c\\n\", 65 }' ASCII value 65 = character A \u683c\u5f0f\u5316\u8f93\u51fa\u6807\u8bc6\u6709 %c \uff0c %d \uff0c %s \u7b49\uff0c\u57fa\u672c\u4e0eC\u8bed\u8a00\u4e00\u81f4\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8d58\u8ff0\u4e86\u3002 \u6267\u884cshell\u547d\u4ee4 \u00b6 \u5728AWK\u4e2d\u6267\u884cshell\u547d\u4ee4\u6709\u4e24\u79cd\u65b9\u5f0f \u4f7f\u7528 system \u51fd\u6570 \u4f7f\u7528\u7ba1\u9053 \u4f7f\u7528system\u51fd\u6570 \u00b6 system \u51fd\u6570\u7528\u4e8e\u6267\u884c\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u5e76\u4e14\u8fd4\u56de\u547d\u4ee4\u7684\u9000\u51fa\u7801\u5230awk\u3002 END { system(\"date | mail -s 'awk run done' root\") } \u4f7f\u7528\u7ba1\u9053 \u00b6 \u5982\u679c\u8981\u6267\u884c\u7684\u547d\u4ee4\u5f88\u591a\uff0c\u53ef\u4ee5\u5c06\u8f93\u51fa\u7684\u547d\u4ee4\u76f4\u63a5\u7528\u7ba1\u9053\u4f20\u9012\u7ed9 \"/bin/sh\" \u6267\u884c while (more stuff to do) print command | \"/bin/sh\" close(\"/bin/sh\") \u53c2\u8003 \u00b6 AWK Tutorial The GNU Awk User's Guide \u672c\u6587\u5c06\u4f1a\u6301\u7eed\u4fee\u6b63\u548c\u66f4\u65b0\uff0c\u6700\u65b0\u5185\u5bb9\u8bf7\u53c2\u8003\u6211\u7684 GITHUB \u4e0a\u7684 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6b22\u8fce Star\u3002","title":"awk"},{"location":"awk/#awk","text":"\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK \u539f\u6587GITHUB mylxsw\u7684 GITHUB \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u6a21\u5f0f \u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a \u6761\u4ef6 awk [option] 'pattern[action]' file... awk [option] '\u6a21\u5f0f {\u52a8\u4f5c}' \u6587\u4ef6 BEGIN\u6a21\u5f0f\u662f\u5904\u7406\u6587\u672c\u4e4b\u524d\u9700\u8981\u6267\u884c\u7684\u64cd\u4f5c END\u6a21\u5f0f\u662f\u5904\u7406\u5b8c\u6240\u6709\u884c\u4e4b\u540e\u6267\u884c\u7684\u64cd\u4f5c","title":"\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK"},{"location":"awk/#awk_1","text":"\u53c2\u6570 \u89e3\u91ca -F \u6307\u5b9a\u5206\u5272\u5b57\u6bb5 -v \u5b9a\u4e49\u6216\u4fee\u6539awk\u5185\u90e8\u7684\u53d8\u91cf -f \u4ece\u811a\u672c\u6587\u4ef6\u4e2d\u8bfb\u53d6awk\u547d\u4ee4 \u5bf9\u4e8eawk\u800c\u8a00,\u53d8\u91cf\u5206\u4e3a \u5185\u7f6e\u53d8\u91cf \u81ea\u5b9a\u4e49\u53d8\u91cf \u5185\u7f6e\u53d8\u91cf \u89e3\u91ca FS FS: field separator, \u8f93\u5165 \u5b57\u6bb5\u5206\u9694\u7b26,\u9ed8\u8ba4\u4e3a\u7a7a\u767d\u5b57\u7b26 OFS OFS: OFS is an output equivalent of awk FS variable, \u8f93\u51fa \u5b57\u6bb5\u5206\u9694\u7b26,\u9ed8\u8ba4\u4e3a\u7a7a\u767d\u5b57\u7b26 RS RS: record separator, \u8f93\u5165 \u8bb0\u5f55\u5206\u9694\u7b26(\u8f93\u5165\u6362\u884c\u7b26),\u6307\u5b9a\u8f93\u5165\u65f6\u7684\u6362\u884c\u7b26 ORS ORS: ORS is an Output equivalent of RS \u8f93\u51fa \u8bb0\u5f55\u5206\u9694\u7b26(\u8f93\u51fa\u6362\u884c\u7b26),\u8f93\u51fa\u65f6\u7528\u6307\u5b9a\u7b26\u53f7\u4ee3\u66ff\u6362\u884c\u7b26 NF NF: number of Field, \u5f53\u524d\u884c\u7684\u5b57\u6bb5\u7684\u4e2a\u6570(\u5373\u5f53\u524d\u884c\u88ab\u5206\u5272\u4e86\u51e0\u5217),\u5b57\u6bb5\u6570\u91cf NR NR: number of records(\u884c\u53f7), \u5f53\u524d\u5904\u7406\u7684\u6587\u672c\u884c\u7684\u884c\u53f7. FNR FNR: Number of Records relative to the current input file \u5404\u6587\u4ef6\u5206\u522b\u8ba1\u6570\u7684\u884c\u53f7 FILENAME FILENAME: \u5f53\u524d\u6587\u4ef6\u540d ARGC ARGC: \u547d\u4ee4\u884c\u53c2\u6570\u7684\u4e2a\u6570 ARGV ARGV:\u6570\u7ec4,\u4fdd\u5b58\u7684\u662f\u547d\u4ee4\u884c\u6240\u7ed9\u5b9a\u7684\u5404\u53c2\u6570","title":"awk\u53c2\u6570"},{"location":"awk/#_1","text":"","title":"\u5185\u7f6e\u53d8\u91cf"},{"location":"awk/#nrnffnr","text":"awk\u7684\u5185\u7f6e\u53d8\u91cfNR,NF\u662f\u4e0d\u8981\u6dfb\u52a0$\u7b26\u53f7\u7684 \u800c $0 $1 $2... \u662f\u9700\u8981\u6dfb\u52a0$\u7b26\u53f7\u7684","title":"NR,NF,FNR"},{"location":"awk/#_2","text":"\u5173\u7cfb\u8fd0\u7b97\u7b26 \u89e3\u91ca \u793a\u4f8b < \u5c0f\u4e8e x<y <= \u5c0f\u4e8e\u7b49\u4e8e x<=y == \u7b49\u4e8e x==y != \u4e0d\u7b49\u4e8e x!=y >= \u5927\u4e8e\u7b49\u4e8e x>=y > \u5927\u4e8e x>y ~ \u5339\u914d\u6b63\u5219 x~/\u6b63\u5219/ !~ \u4e0d\u5339\u914d\u6b63\u5219 x!~/\u6b63\u5219/ $ awk -F \":\" 'BEGIN{print \"===\"} NR==3,NR==5 {printf \"%s %s\\n\", NR,$1} END{print \"@@@\"}' xxx_list === 3 1-1 4 1-8 5 1000th @@@ $ $ awk -v FS=\".\" 'BEGIN{print \"###\"} {print NR,NF,$1,$2,$3 }' xxx_list | head ### 1 5 xxx:mysql db xxx 2 5 ttt:maria db ttt $ awk -v FS=\".\" 'BEGIN{print \"###\"} {print ARGV[1], NR,NF,$1,$2,$3 }' xxx_list | head ### xxx_list 1 5 xxx:mysql db xxx xxx_list 2 5 ttt:maria db ttt","title":"\u6a21\u5f0f"},{"location":"awk/#_3","text":"\u65b9\u6cd5\u4e00: -v varName=value \u65b9\u6cd5\u4e8c: \u5728\u7a0b\u5e8f\u4e2d\u76f4\u63a5\u5b9a\u4e49","title":"\u81ea\u5b9a\u4e49\u53d8\u91cf"},{"location":"awk/#awk_2","text":"","title":"awk\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"awk/#_4","text":"awk '/\u6b63\u5219\u8868\u8fbe\u5f0f/ {\u52a8\u4f5c}' file","title":"\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"awk/#_5","text":"awk '/\u6b63\u52191/,/\u6b63\u52192/ {\u52a8\u4f5c}' file $ awk -F \":\" '/^5may/ {print $1,$NF}' osn_mysql40_acc_list 5may mysql31.db.sakura.ne.jp www2323# cat /home/.logs/users/xxx/access_log.20230502 | awk '$1 ~ \"xxx.sa|xxx.org|xxx.xxx.ne.jp\" {print $3}' | uniq -n","title":"\u884c\u8bbf\u95ee\u6a21\u5f0f"},{"location":"awk/#awk_3","text":"\u89e3\u8bfb\u9700\u6c42: \u4ece\u6587\u4ef6\u4e2d\u5bfb\u627e\u60f3\u8981\u7684\u4fe1\u606f,\u6309\u7167\u4ee5\u4e0b\u987a\u5e8f\u6267\u884c awk 'BEGIN {commands} pattern{commands} END{commands}' file... \u4f18\u5148\u6267\u884c BEGIN{} \u6a21\u5f0f\u4e2d\u7684\u8bed\u53e5 \u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7b2c\u4e00\u884c,\u7136\u540e\u6267\u884c pattern{commads} ,\u8fdb\u884c\u6b63\u5219\u5339\u914d /^n/ \u5bfb\u627en\u5f00\u5934\u7684\u884c,\u627e\u5230\u4e4b\u540e\u6267\u884c {print} \u8fdb\u884c\u6253\u5370 \u5f53awk\u8bfb\u53d6\u6587\u4ef6\u6570\u636e\u6d41\u7684\u7ed3\u5c3e\u65f6, \u4f1a\u6267\u884c END{commads}","title":"awk\u547d\u4ee4\u6267\u884c\u6d41\u7a0b"},{"location":"awk/#_6","text":"AWK\u662f\u4e00\u95e8\u89e3\u91ca\u578b\u7684\u7f16\u7a0b\u8bed\u8a00\u3002\u5728\u6587\u672c\u5904\u7406\u9886\u57df\u5b83\u662f\u975e\u5e38\u5f3a\u5927\u7684\uff0c\u5b83\u7684\u540d\u5b57\u6765\u6e90\u4e8e\u5b83\u7684\u4e09\u4f4d\u4f5c\u8005\u7684\u59d3\u6c0f\uff1a Alfred Aho \uff0c Peter Weinberger \u548c Brian Kernighan \u3002 GNU/Linux\u53d1\u5e03\u7684AWK\u76ee\u524d\u7531\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a\uff08FSF\uff09\u8fdb\u884c\u5f00\u53d1\u548c\u7ef4\u62a4\uff0c\u901a\u5e38\u4e5f\u79f0\u5b83\u4e3a GNU AWK \u3002","title":"\u6982\u8ff0"},{"location":"awk/#awk_4","text":"\u4e0b\u9762\u662f\u51e0\u4e2aAWK\u7684\u53d8\u4f53\uff1a AWK - \u539f\u5148\u6765\u6e90\u4e8e AT & T \u5b9e\u9a8c\u5ba4\u7684\u7684AWK NAWK - AT & T \u5b9e\u9a8c\u5ba4\u7684AWK\u7684\u5347\u7ea7\u7248 GAWK - \u8fd9\u5c31\u662fGNU AWK\u3002\u6240\u6709\u7684GNU/Linux\u53d1\u5e03\u7248\u90fd\u81ea\u5e26GAWK\uff0c\u5b83\u4e0eAWK\u548cNAWK\u5b8c\u5168\u517c\u5bb9","title":"AWK\u7684\u7c7b\u578b"},{"location":"awk/#awk_5","text":"\u4f7f\u7528AWK\u53ef\u4ee5\u505a\u5f88\u591a\u4efb\u52a1\uff0c\u4e0b\u9762\u662f\u5176\u4e2d\u4e00\u4e9b \u6587\u672c\u5904\u7406 \u8f93\u51fa\u683c\u5f0f\u5316\u7684\u6587\u672c\u62a5\u8868 \u6267\u884c\u7b97\u6570\u8fd0\u7b97 \u6267\u884c\u5b57\u7b26\u4e32\u64cd\u4f5c\u7b49\u7b49","title":"AWK\u7684\u5178\u578b\u7528\u9014"},{"location":"awk/#_7","text":"\u8981\u6210\u4e3aAWK\u7f16\u7a0b\u4e13\u5bb6\uff0c\u4f60\u9700\u8981\u5148\u77e5\u9053\u5b83\u7684\u5185\u90e8\u5b9e\u73b0\u673a\u5236\uff0cAWK\u9075\u5faa\u4e86\u975e\u5e38\u7b80\u5355\u7684\u5de5\u4f5c\u6d41 - \u8bfb\u53d6 \uff0c \u6267\u884c \u548c \u91cd\u590d \uff0c\u4e0b\u56fe\u63cf\u8ff0\u4e86AWK\u7684\u5de5\u4f5c\u6d41\u3002 Read AWK\u4ece\u8f93\u5165\u6d41\uff08\u6587\u4ef6\uff0c\u7ba1\u9053\u6216\u8005\u6807\u51c6\u8f93\u5165\uff09\u4e2d\u8bfb\u53d6\u4e00\u884c\uff0c\u7136\u540e\u5b58\u50a8\u5230\u5185\u5b58\u4e2d\u3002 Execute \u6240\u6709\u7684AWK\u547d\u4ee4\u90fd\u4f9d\u6b21\u5728\u8f93\u5165\u4e0a\u6267\u884c\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cAWK\u4f1a\u5bf9\u6bcf\u4e00\u884c\u6267\u884c\u547d\u4ee4\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u6a21\u5f0f\u9650\u5236\u8fd9\u79cd\u884c\u4e3a\u3002 Repeat \u5904\u7406\u8fc7\u7a0b\u4e0d\u65ad\u91cd\u590d\uff0c\u76f4\u5230\u5230\u8fbe\u6587\u4ef6\u7ed3\u5c3e\u3002","title":"\u5de5\u4f5c\u6d41"},{"location":"awk/#_8","text":"\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u5148\u5b66\u4e60\u4e00\u4e0bAWK\u7684\u7a0b\u5e8f\u7ed3\u6784\u3002","title":"\u7a0b\u5e8f\u7ed3\u6784"},{"location":"awk/#begin","text":"BEGIN\u8bed\u53e5\u5757\u7684\u8bed\u6cd5 BEGIN {awk-commands} BEGIN\u8bed\u53e5\u5757\u5728\u7a0b\u5e8f\u5f00\u59cb\u7684\u4f7f\u7528\u6267\u884c\uff0c\u5b83\u53ea\u6267\u884c\u4e00\u6b21\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u521d\u59cb\u5316\u53d8\u91cf\u3002BEGIN\u662fAWK\u7684\u5173\u952e\u5b57\uff0c\u56e0\u6b64\u5b83\u5fc5\u987b\u4e3a\u5927\u5199\uff0c\u6ce8\u610f\uff0c\u8fd9\u4e2a\u8bed\u53e5\u5757\u662f\u53ef\u9009\u7684\u3002","title":"BEGIN \u8bed\u53e5\u5757"},{"location":"awk/#body","text":"BODY\u8bed\u53e5\u5757\u7684\u8bed\u6cd5 /pattern/ {awk-commands} BODY\u8bed\u53e5\u5757\u4e2d\u7684\u547d\u4ee4\u4f1a\u5bf9\u8f93\u5165\u7684\u6bcf\u4e00\u884c\u6267\u884c\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u6a21\u5f0f\u6765\u63a7\u5236\u8fd9\u79cd\u884c\u4e3a\u3002\u6ce8\u610f\uff0cBODY\u8bed\u53e5\u5757\u6ca1\u6709\u5173\u952e\u5b57\u3002","title":"BODY \u8bed\u53e5\u5757"},{"location":"awk/#end","text":"END\u8bed\u53e5\u5757\u7684\u8bed\u6cd5 END {awk-commands} END\u8bed\u53e5\u5757\u5728\u7a0b\u5e8f\u7684\u6700\u540e\u6267\u884c\uff0cEND\u662fAWK\u7684\u5173\u952e\u5b57\uff0c\u56e0\u6b64\u5fc5\u987b\u4e3a\u5927\u5199\uff0c\u5b83\u4e5f\u662f\u53ef\u9009\u7684\u3002 \u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5e8f\u53f7\uff0c\u5b66\u751f\u59d3\u540d\uff0c\u79d1\u76ee\u540d\u79f0\u548c\u5f97\u5206\u7684\u6587\u4ef6 marks.txt \u3002 1) Amit Physics 80 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89 \u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\u6211\u4eec\u5c06\u4f1a\u663e\u793a\u6587\u4ef6\u5185\u5bb9\uff0c\u5e76\u4e14\u6dfb\u52a0\u6bcf\u4e00\u5217\u7684\u6807\u9898 $ awk 'BEGIN{printf \"Sr No\\tName\\tSub\\tMarks\\n\"} {print}' marks.txt \u4e0a\u8ff0\u4ee3\u7801\u6267\u884c\u540e\uff0c\u8f93\u51fa\u4ee5\u4e0b\u5185\u5bb9 Sr No Name Sub Marks 1) Amit Physics 80 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89 \u5728\u7a0b\u5e8f\u7684\u5f00\u59cb\uff0cAWK\u5728BEGIN\u8bed\u53e5\u4e2d\u6253\u5370\u51fa\u6807\u9898\u3002\u7136\u540e\u518dBODY\u8bed\u53e5\u4e2d\uff0c\u5b83\u4f1a\u8bfb\u53d6\u6587\u4ef6\u7684\u6bcf\u4e00\u884c\u7136\u540e\u6267\u884cAWK\u7684print\u547d\u4ee4\u5c06\u6bcf\u4e00\u884c\u7684\u5185\u5bb9\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u4f1a\u4e00\u76f4\u91cd\u590d\u76f4\u5230\u6587\u4ef6\u7684\u7ed3\u5c3e\u3002","title":"END \u8bed\u53e5\u5757"},{"location":"awk/#_9","text":"AWK\u7684\u4f7f\u7528\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884cAWK\u7684\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u4ece\u5305\u542bAWK\u547d\u4ee4\u7684\u6587\u672c\u6587\u4ef6\u4e2d\u6267\u884c\u3002","title":"\u57fa\u7840\u8bed\u6cd5"},{"location":"awk/#awk_6","text":"\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5355\u5f15\u53f7\u5728\u547d\u4ee4\u884c\u4e2d\u6307\u5b9aAWK\u547d\u4ee4 awk [options] file ... \u6bd4\u5982\u6211\u4eec\u6709\u4e00\u4e2a\u5305\u542b\u4e0b\u9762\u5185\u5bb9\u7684\u6587\u672c\u6587\u4ef6 marks.txt : 1) Amit Physics 80 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u663e\u793a\u8be5\u6587\u4ef6\u7684\u5b8c\u6574\u5185\u5bb9 $ awk '{print}' marks.txt","title":"AWK\u547d\u4ee4\u884c"},{"location":"awk/#awk_7","text":"\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u811a\u672c\u6587\u4ef6\u63d0\u4f9bAWK\u547d\u4ee4 awk [options] -f file .... \u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u4e0b\u9762\u5185\u5bb9\u7684\u6587\u672c\u6587\u4ef6 command.awk {print} \u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9AWK\u6267\u884c\u8be5\u6587\u4ef6\u4e2d\u7684\u547d\u4ee4\uff0c\u8fd9\u91cc\u6211\u4eec\u5b9e\u73b0\u4e86\u548c\u4e0a\u4f8b\u540c\u6837\u7684\u7ed3\u679c $ awk -f command.awk marks.txt","title":"AWK\u7a0b\u5e8f\u6587\u4ef6"},{"location":"awk/#awk_8","text":"AWK\u652f\u6301\u4e0b\u5217\u547d\u4ee4\u884c\u6807\u51c6\u9009\u9879","title":"AWK\u6807\u51c6\u9009\u9879"},{"location":"awk/#-v","text":"\u8be5\u9009\u9879\u5c06\u4e00\u4e2a\u503c\u8d4b\u4e88\u4e00\u4e2a\u53d8\u91cf\uff0c\u5b83\u4f1a\u5728\u7a0b\u5e8f\u5f00\u59cb\u4e4b\u524d\u8fdb\u884c\u8d4b\u503c\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u63cf\u8ff0\u4e86\u8be5\u9009\u9879\u7684\u4f7f\u7528 $ awk -v name=Jerry 'BEGIN{printf \"Name = %s\\n\", name}' Name = Jerry","title":"-v \u53d8\u91cf\u8d4b\u503c\u9009\u9879"},{"location":"awk/#-dump-variablesfile","text":"\u8be5\u9009\u9879\u4f1a\u8f93\u51fa\u6392\u597d\u5e8f\u7684\u5168\u5c40\u53d8\u91cf\u5217\u8868\u548c\u5b83\u4eec\u6700\u7ec8\u7684\u503c\u5230\u6587\u4ef6\u4e2d\uff0c\u9ed8\u8ba4\u7684\u6587\u4ef6\u662f awkvars.out \u3002 $ awk --dump-variables '' $ cat awkvars.out ARGC: 1 ARGIND: 0 ARGV: array, 1 elements BINMODE: 0 CONVFMT: \"%.6g\" ERRNO: \"\" FIELDWIDTHS: \"\" FILENAME: \"\" FNR: 0 FPAT: \"[^[:space:]]+\" FS: \" \" IGNORECASE: 0 LINT: 0 NF: 0 NR: 0 OFMT: \"%.6g\" OFS: \" \" ORS: \"\\n\" RLENGTH: 0 RS: \"\\n\" RSTART: 0 RT: \"\" SUBSEP: \"\\034\" TEXTDOMAIN: \"messages\"","title":"--dump-variables[=file] \u9009\u9879"},{"location":"awk/#-help","text":"\u6253\u5370\u5e2e\u52a9\u4fe1\u606f\u3002 $ awk --help Usage: awk [POSIX or GNU style options] -f progfile [--] file ... Usage: awk [POSIX or GNU style options] [--] 'program' file ... POSIX options : GNU long options: (standard) -f progfile --file=progfile -F fs --field-separator=fs -v var=val --assign=var=val Short options : GNU long options: (extensions) -b --characters-as-bytes -c --traditional -C --copyright -d[file] --dump-variables[=file] -e 'program-text' --source='program-text' -E file --exec=file -g --gen-pot -h --help -L [fatal] --lint[=fatal] -n --non-decimal-data -N --use-lc-numeric -O --optimize -p[file] --profile[=file] -P --posix -r --re-interval -S --sandbox -t --lint-old -V --version","title":"--help \u9009\u9879"},{"location":"awk/#-lintfatal","text":"\u8be5\u9009\u9879\u5141\u8bb8\u68c0\u67e5\u7a0b\u5e8f\u7684\u4e0d\u517c\u5bb9\u6027\u6216\u8005\u6a21\u68f1\u4e24\u53ef\u7684\u4ee3\u7801\uff0c\u5f53\u63d0\u4f9b\u53c2\u6570 fatal \u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u5bf9\u5f85Warning\u6d88\u606f\u4f5c\u4e3aError\u3002 $ awk --lint '' /bin/ls awk: cmd. line:1: warning: empty program text on command line awk: cmd. line:1: warning: source file does not end in newline awk: warning: no program text at all!","title":"--lint[=fatal] \u9009\u9879"},{"location":"awk/#-posix","text":"\u8be5\u9009\u9879\u5f00\u542f\u4e25\u683c\u7684POSIX\u517c\u5bb9\u3002","title":"--posix \u9009\u9879"},{"location":"awk/#-profilefile","text":"\u8be5\u9009\u9879\u4f1a\u8f93\u51fa\u4e00\u4efd\u683c\u5f0f\u5316\u4e4b\u540e\u7684\u7a0b\u5e8f\u5230\u6587\u4ef6\u4e2d\uff0c\u9ed8\u8ba4\u6587\u4ef6\u662f awkprof.out \u3002 $ awk --profile 'BEGIN{printf\"---|Header|--\\n\"} {print} END{printf\"---|Footer|---\\n\"}' marks.txt > /dev/null $ cat awkprof.out # gawk \u914d\u7f6e, \u521b\u5efa Wed Oct 26 15:05:49 2016 # BEGIN \u5757 BEGIN { printf \"---|Header|--\\n\" } # \u89c4\u5219 { print $0 } # END \u5757 END { printf \"---|Footer|---\\n\" }","title":"--profile[=file]\u9009\u9879"},{"location":"awk/#-traditional","text":"\u8be5\u9009\u9879\u4f1a\u7981\u6b62\u6240\u6709\u7684gawk\u89c4\u8303\u7684\u6269\u5c55\u3002","title":"--traditional \u9009\u9879"},{"location":"awk/#-version","text":"\u8f93\u51fa\u7248\u672c\u53f7 $ awk --version GNU Awk 3.1.7 \u7248\u6743\u6240\u6709 \u00a9 1989, 1991-2009 \u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a(FSF)\u3002 \u8be5\u7a0b\u5e8f\u4e3a\u81ea\u7531\u8f6f\u4ef6\uff0c\u4f60\u53ef\u4ee5\u5728\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u53d1\u5e03\u7684 GNU \u901a\u7528\u516c\u5171\u8bb8\u53ef\u8bc1(GPL)\u7b2c 3\u7248\u6216\u4ee5\u540e\u7248\u672c\u4e0b\u4fee\u6539\u6216\u91cd\u65b0\u53d1\u5e03\u3002 \u8be5\u7a0b\u5e8f\u4e4b\u6240\u4ee5\u88ab\u53d1\u5e03\u662f\u56e0\u4e3a\u5e0c\u671b\u4ed6\u80fd\u5bf9\u4f60\u6709\u6240\u7528\u5904\uff0c\u4f46\u6211\u4eec\u4e0d\u4f5c\u4efb\u4f55\u62c5\u4fdd\u3002\u8fd9\u5305\u542b \u4f46\u4e0d\u9650\u4e8e\u4efb\u4f55\u5546\u4e1a\u9002\u552e\u6027\u4ee5\u53ca\u9488\u5bf9\u7279\u5b9a\u76ee\u7684\u7684\u9002\u7528\u6027\u7684\u62c5\u4fdd\u3002\u8be6\u60c5\u53c2\u89c1 GNU \u901a\u7528\u516c \u5171\u8bb8\u53ef\u8bc1(GPL)\u3002 \u4f60\u5e94\u8be5\u6536\u5230\u7a0b\u5e8f\u9644\u5e26\u7684\u4e00\u4efd GNU \u901a\u7528\u516c\u5171\u8bb8\u53ef\u8bc1(GPL)\u3002\u5982\u679c\u6ca1\u6709\u6536\u5230\uff0c\u8bf7\u53c2\u770b http://www.gnu.org/licenses/ \u3002 You have new mail in /var/spool/mail/root","title":"--version \u9009\u9879"},{"location":"awk/#_10","text":"\u672c\u90e8\u5206\u4f1a\u8bb2\u8ff0\u4e00\u4e9b\u6709\u7528\u7684AWK\u547d\u4ee4\u548c\u5b83\u4eec\u7684\u4f7f\u7528\u793a\u4f8b\uff0c\u6240\u6709\u7684\u4f8b\u5b50\u90fd\u662f\u4ee5\u4e0b\u9762\u7684\u6587\u672c\u6587\u4ef6 marks.txt \u4e3a\u57fa\u7840\u7684 1) Amit Physics 80 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89","title":"\u57fa\u672c\u4f7f\u7528\u793a\u4f8b"},{"location":"awk/#_11","text":"AWK\u53ef\u4ee5\u53ea\u6253\u5370\u8f93\u5165\u5b57\u6bb5\u4e2d\u7684\u67d0\u4e9b\u5217\u3002 $ awk '{print $3 \"\\t\" $4}' marks.txt Physics 80 Maths 90 Biology 87 English 85 History 89 \u5728\u6587\u4ef6 marks.txt \u4e2d\uff0c\u7b2c\u4e09\u5217\u5305\u542b\u4e86\u79d1\u76ee\u540d\uff0c\u7b2c\u56db\u5217\u5219\u662f\u5f97\u5206\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u53ea\u6253\u5370\u51fa\u4e86\u8fd9\u4e24\u5217\uff0c $3 \u548c $4 \u4ee3\u8868\u4e86\u8f93\u5165\u8bb0\u5f55\u4e2d\u7684\u7b2c\u4e09\u548c\u7b2c\u56db\u4e2a\u5b57\u6bb5\u3002","title":"\u6253\u5370\u67d0\u5217\u6216\u8005\u5b57\u6bb5"},{"location":"awk/#_12","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cAWK\u4f1a\u6253\u5370\u51fa\u6240\u6709\u5339\u914d\u6a21\u5f0f\u7684\u884c $ awk '/a/ {print $0}' marks.txt 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89 \u4e0a\u8ff0\u547d\u4ee4\u4f1a\u5224\u65ad\u6bcf\u4e00\u884c\u4e2d\u662f\u5426\u5305\u542b a \uff0c\u5982\u679c\u5305\u542b\u5219\u6253\u5370\u8be5\u884c\uff0c\u5982\u679cBODY\u90e8\u5206\u7f3a\u5931\u5219\u9ed8\u8ba4\u4f1a\u6267\u884c\u6253\u5370\uff0c\u56e0\u6b64\uff0c\u4e0a\u8ff0\u547d\u4ee4\u548c\u4e0b\u9762\u8fd9\u4e2a\u662f\u7b49\u4ef7\u7684 $ awk '/a/' marks.txt","title":"\u6253\u5370\u6240\u6709\u7684\u884c"},{"location":"awk/#_13","text":"\u5f53\u6a21\u5f0f\u5339\u914d\u6210\u529f\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bAWK\u4f1a\u6253\u5370\u8be5\u884c\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u8ba9\u5b83\u53ea\u6253\u5370\u6307\u5b9a\u7684\u5b57\u6bb5\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u53ea\u4f1a\u6253\u5370\u51fa\u5339\u914d\u6a21\u5f0f\u7684\u7b2c\u4e09\u548c\u7b2c\u56db\u4e2a\u5b57\u6bb5\u3002 $ awk '/a/ {print $3 \"\\t\" $4}' marks.txt Maths 90 Biology 87 English 85 History 89","title":"\u6253\u5370\u5339\u914d\u6a21\u5f0f\u7684\u5217"},{"location":"awk/#_14","text":"$ awk '/a/ {print $4 \"\\t\" $3}' marks.txt 90 Maths 87 Biology 85 English 89 History","title":"\u4efb\u610f\u987a\u5e8f\u6253\u5370\u5217"},{"location":"awk/#_15","text":"$ awk '/a/{++cnt} END {print \"Count = \", cnt}' marks.txt Count = 4","title":"\u7edf\u8ba1\u5339\u914d\u6a21\u5f0f\u7684\u884c\u6570"},{"location":"awk/#18","text":"$ awk 'length($0) > 18' marks.txt 3) Shyam Biology 87 4) Kedar English 85","title":"\u6253\u5370\u8d85\u8fc718\u4e2a\u5b57\u7b26\u7684\u884c"},{"location":"awk/#_16","text":"AWK\u63d0\u4f9b\u4e86\u5f88\u591a\u5185\u7f6e\u7684\u53d8\u91cf\uff0c\u5b83\u4eec\u5728\u5f00\u53d1AWK\u811a\u672c\u7684\u8fc7\u7a0b\u4e2d\u8d77\u7740\u975e\u5e38\u91cd\u8981\u7684\u89d2\u8272\u3002","title":"\u5185\u5efa\u53d8\u91cf"},{"location":"awk/#awk_9","text":"","title":"\u6807\u51c6AWK\u53d8\u91cf"},{"location":"awk/#argc","text":"\u547d\u4ee4\u884c\u4e2d\u63d0\u4f9b\u7684\u53c2\u6570\u4e2a\u6570 $ awk 'BEGIN {print \"Arguments =\", ARGC}' One Two Three Four Arguments = 5","title":"ARGC \u547d\u4ee4\u884c\u53c2\u6570\u4e2a\u6570"},{"location":"awk/#argv","text":"\u5b58\u50a8\u547d\u4ee4\u884c\u53c2\u6570\u7684\u6570\u7ec4\uff0c\u7d22\u5f15\u8303\u56f4\u4ece 0 - ARGC - 1 \u3002 $ awk 'BEGIN { for (i = 0; i < ARGC - 1; ++i) { printf \"ARGV[%d] = %s\\n\", i, ARGV[i] } }' one two three four ARGV[0] = awk ARGV[1] = one ARGV[2] = two ARGV[3] = three","title":"ARGV \u547d\u4ee4\u884c\u53c2\u6570\u6570\u7ec4"},{"location":"awk/#convfmt","text":"\u4ee3\u8868\u4e86\u6570\u5b57\u7684\u7ea6\u5b9a\u683c\u5f0f\uff0c\u9ed8\u8ba4\u503c\u662f %.6g $ awk 'BEGIN { print \"Conversion Format =\", CONVFMT }' Conversion Format = %.6g","title":"CONVFMT \u6570\u5b57\u7684\u7ea6\u5b9a\u683c\u5f0f"},{"location":"awk/#environ","text":"\u73af\u5883\u53d8\u91cf\u7684\u5173\u8054\u6570\u7ec4 $ awk 'BEGIN { print ENVIRON[\"USER\"] }' mylxsw","title":"ENVIRON \u73af\u5883\u53d8\u91cf"},{"location":"awk/#filename","text":"$ awk 'END {print FILENAME}' marks.txt marks.txt","title":"FILENAME \u5f53\u524d\u6587\u4ef6\u540d"},{"location":"awk/#fs","text":"\u4ee3\u8868\u4e86\u8f93\u5165\u5b57\u6bb5\u7684\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u503c\u4e3a \u7a7a\u683c \uff0c\u53ef\u4ee5\u901a\u8fc7 -F \u9009\u9879\u5728\u547d\u4ee4\u884c\u9009\u9879\u4e2d\u4fee\u6539\u5b83\u3002 $ awk 'BEGIN {print \"FS = \" FS}' | cat -vte FS = $ $ awk -F , 'BEGIN {print \"FS = \" FS}' | cat -vte FS = ,$","title":"FS \u8f93\u5165\u5b57\u6bb5\u7684\u5206\u9694\u7b26"},{"location":"awk/#nf","text":"\u4ee3\u8868\u4e86\u5f53\u524d\u884c\u4e2d\u7684\u5b57\u6bb5\u6570\u76ee\uff0c\u4f8b\u5982\u4e0b\u9762\u4f8b\u5b50\u6253\u5370\u51fa\u4e86\u5305\u542b\u5927\u4e8e\u4e24\u4e2a\u5b57\u6bb5\u7684\u884c $ echo -e \"One Two\\nOne Two Three\\nOne Two Three Four\" | awk 'NF > 2' One Two Three One Two Three Four","title":"NF \u5b57\u6bb5\u6570\u76ee"},{"location":"awk/#nr","text":"$ echo -e \"One Two\\nOne Two Three\\nOne Two Three Four\" | awk 'NR < 3' One Two One Two Three","title":"NR \u884c\u53f7"},{"location":"awk/#fnr","text":"\u4e0eNR\u76f8\u4f3c\uff0c\u4e0d\u8fc7\u5728\u5904\u7406\u591a\u6587\u4ef6\u65f6\u66f4\u6709\u7528\uff0c\u83b7\u53d6\u7684\u884c\u53f7\u76f8\u5bf9\u4e8e\u5f53\u524d\u6587\u4ef6\u3002","title":"FNR \u884c\u53f7\uff08\u76f8\u5bf9\u5f53\u524d\u6587\u4ef6\uff09"},{"location":"awk/#ofmt","text":"\u9ed8\u8ba4\u503c\u4e3a %.6g $ awk 'BEGIN {print \"OFMT = \" OFMT}' OFMT = %.6g","title":"OFMT \u8f93\u51fa\u683c\u5f0f\u6570\u5b57"},{"location":"awk/#ofs","text":"\u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u683c $ awk 'BEGIN {print \"OFS = \" OFS}' | cat -vte OFS = $","title":"OFS \u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26"},{"location":"awk/#ors","text":"\u9ed8\u8ba4\u503c\u4e3a\u6362\u884c\u7b26 $ awk 'BEGIN {print \"ORS = \" ORS}' | cat -vte ORS = $ $","title":"ORS \u8f93\u51fa\u884c\u5206\u9694\u7b26"},{"location":"awk/#rlength","text":"\u4ee3\u8868\u4e86 match \u51fd\u6570\u5339\u914d\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u3002 $ awk 'BEGIN { if (match(\"One Two Three\", \"re\")) { print RLENGTH } }' 2","title":"RLENGTH"},{"location":"awk/#rs","text":"$ awk 'BEGIN {print \"RS = \" RS}' | cat -vte RS = $ $","title":"RS \u8f93\u5165\u8bb0\u5f55\u5206\u9694\u7b26"},{"location":"awk/#rstart","text":"match \u51fd\u6570\u5339\u914d\u7684\u7b2c\u4e00\u6b21\u51fa\u73b0\u4f4d\u7f6e $ awk 'BEGIN { if (match(\"One Two Three\", \"Thre\")) { print RSTART } } 9","title":"RSTART"},{"location":"awk/#subsep","text":"\u6570\u7ec4\u5b50\u811a\u672c\u7684\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a \\034 $ awk 'BEGIN { print \"SUBSEP = \" SUBSEP }' | cat -vte SUBSEP = ^\\$","title":"SUBSEP \u6570\u7ec4\u5b50\u811a\u672c\u7684\u5206\u9694\u7b26"},{"location":"awk/#0","text":"\u4ee3\u8868\u4e86\u5f53\u524d\u884c $ awk '{print $0}' marks.txt 1) Amit Physics 80 2) Rahul Maths 90 3) Shyam Biology 87 4) Kedar English 85 5) Hari History 89","title":"$ 0 \u4ee3\u8868\u4e86\u5f53\u524d\u884c"},{"location":"awk/#n","text":"\u5f53\u524d\u884c\u4e2d\u7684\u7b2cn\u4e2a\u5b57\u6bb5 $ awk '{print $3 \"\\t\" $4}' marks.txt Physics 80 Maths 90 Biology 87 English 85 History 89","title":"$n"},{"location":"awk/#gnu-awk","text":"","title":"GNU AWK\u7684\u53d8\u91cf"},{"location":"awk/#argind","text":"\u5f53\u524d\u88ab\u5904\u7406\u7684ARGV\u7684\u7d22\u5f15 $ awk '{ print \"ARGIND = \", ARGIND; print \"Filename = \", ARGV[ARGIND] }' junk1 junk2 junk3 ARGIND = 1 Filename = junk1 ARGIND = 2 Filename = junk2 ARGIND = 3 Filename = junk3","title":"ARGIND"},{"location":"awk/#binmode","text":"\u5728\u975ePOSIX\u7cfb\u7edf\u4e0a\u6307\u5b9a\u5bf9\u6240\u6709\u7684\u6587\u4ef6I/O\u91c7\u7528\u4e8c\u8fdb\u5236\u6a21\u5f0f\u3002","title":"BINMODE"},{"location":"awk/#errorno","text":"\u4e00\u4e2a\u4ee3\u8868\u4e86 getline \u8df3\u8f6c\u5931\u8d25\u6216\u8005\u662f close \u8c03\u7528\u5931\u8d25\u7684\u9519\u8bef\u7684\u5b57\u7b26\u4e32\u3002 $ awk 'BEGIN { ret = getline < \"junk.txt\"; if (ret == -1) print \"Error:\", ERRNO }' Error: No such file or directory","title":"ERRORNO"},{"location":"awk/#fieldwidths","text":"\u8bbe\u7f6e\u4e86\u7a7a\u683c\u5206\u9694\u7684\u5b57\u6bb5\u5bbd\u5ea6\u53d8\u91cf\u5217\u8868\u7684\u8bdd\uff0cGAWK\u4f1a\u5c06\u8f93\u5165\u89e3\u6790\u4e3a\u56fa\u5b9a\u5bbd\u5ea6\u7684\u5b57\u6bb5\uff0c\u800c\u4e0d\u662f\u4f7f\u7528 FS \u8fdb\u884c\u5206\u9694\u3002","title":"FIELDWIDTHS"},{"location":"awk/#ignorecase","text":"\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u53d8\u91cf\u7684\u8bdd\uff0cAWK\u4f1a\u5ffd\u7565\u5927\u5c0f\u5199\u3002 $ awk 'BEGIN{IGNORECASE = 1} /amit/' marks.txt 1) Amit Physics 80","title":"IGNORECASE"},{"location":"awk/#lint","text":"\u63d0\u4f9b\u4e86\u5bf9 --lint \u9009\u9879\u7684\u52a8\u6001\u63a7\u5236\u3002 $ awk 'BEGIN {LINT = 1; a}' awk: cmd. line:1: warning: reference to uninitialized variable `a' awk: cmd. line:1: warning: statement has no effect","title":"LINT"},{"location":"awk/#procinfo","text":"\u5305\u542b\u8fdb\u7a0b\u4fe1\u606f\u7684\u5173\u8054\u6570\u7ec4\uff0c\u4f8b\u5982UID\uff0c\u8fdb\u7a0bID\u7b49 $ awk 'BEGIN { print PROCINFO[\"pid\"] }' 4316","title":"PROCINFO"},{"location":"awk/#textdomain","text":"\u4ee3\u8868\u4e86AWK\u7684\u6587\u672c\u57df\uff0c\u7528\u4e8e\u67e5\u627e\u5b57\u7b26\u4e32\u7684\u672c\u5730\u5316\u7ffb\u8bd1\u3002 $ awk 'BEGIN { print TEXTDOMAIN }' messages","title":"TEXTDOMAIN"},{"location":"awk/#_17","text":"\u4e0e\u5176\u5b83\u7f16\u7a0b\u8bed\u8a00\u4e00\u6837\uff0cAWK\u4e5f\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u64cd\u4f5c\u7b26\u3002","title":"\u64cd\u4f5c\u7b26"},{"location":"awk/#_18","text":"\u7b97\u6570\u64cd\u4f5c\u7b26\u4e0d\u591a\u8bf4\uff0c\u76f4\u63a5\u770b\u4f8b\u5b50\uff0c\u65e0\u975e\u5c31\u662f +-*/% $ awk 'BEGIN { a = 50; b = 20; print \"(a + b) = \", (a + b) }' (a + b) = 70 $ awk 'BEGIN { a = 50; b = 20; print \"(a - b) = \", (a - b) }' (a - b) = 30 $ awk 'BEGIN { a = 50; b = 20; print \"(a * b) = \", (a * b) }' (a * b) = 1000 $ awk 'BEGIN { a = 50; b = 20; print \"(a / b) = \", (a / b) }' (a / b) = 2.5 $ awk 'BEGIN { a = 50; b = 20; print \"(a % b) = \", (a % b) }' (a % b) = 10","title":"\u7b97\u6570\u64cd\u4f5c\u7b26"},{"location":"awk/#_19","text":"\u81ea\u589e\u81ea\u51cf\u4e0eC\u8bed\u8a00\u4e00\u81f4\u3002 $ awk 'BEGIN { a = 10; b = ++a; printf \"a = %d, b = %d\\n\", a, b }' a = 11, b = 11 $ awk 'BEGIN { a = 10; b = --a; printf \"a = %d, b = %d\\n\", a, b }' a = 9, b = 9 $ awk 'BEGIN { a = 10; b = a++; printf \"a = %d, b = %d\\n\", a, b }' a = 11, b = 10 $ awk 'BEGIN { a = 10; b = a--; printf \"a = %d, b = %d\\n\", a, b }' a = 9, b = 10","title":"\u589e\u51cf\u8fd0\u7b97\u7b26"},{"location":"awk/#_20","text":"$ awk 'BEGIN { name = \"Jerry\"; print \"My name is\", name }' My name is Jerry $ awk 'BEGIN { cnt = 10; cnt += 10; print \"Counter =\", cnt }' Counter = 20 $ awk 'BEGIN { cnt = 100; cnt -= 10; print \"Counter =\", cnt }' Counter = 90 $ awk 'BEGIN { cnt = 10; cnt *= 10; print \"Counter =\", cnt }' Counter = 100 $ awk 'BEGIN { cnt = 100; cnt /= 5; print \"Counter =\", cnt }' Counter = 20 $ awk 'BEGIN { cnt = 100; cnt %= 8; print \"Counter =\", cnt }' Counter = 4 $ awk 'BEGIN { cnt = 2; cnt ^= 4; print \"Counter =\", cnt }' Counter = 16 $ awk 'BEGIN { cnt = 2; cnt **= 4; print \"Counter =\", cnt }' Counter = 16","title":"\u8d4b\u503c\u64cd\u4f5c\u7b26"},{"location":"awk/#_21","text":"$ awk 'BEGIN { a = 10; b = 10; if (a == b) print \"a == b\" }' a == b $ awk 'BEGIN { a = 10; b = 20; if (a != b) print \"a != b\" }' a != b $ awk 'BEGIN { a = 10; b = 20; if (a < b) print \"a < b\" }' a < b $ awk 'BEGIN { a = 10; b = 10; if (a <= b) print \"a <= b\" }' a <= b $ awk 'BEGIN { a = 10; b = 20; if (b > a ) print \"b > a\" }' b > a","title":"\u5173\u7cfb\u64cd\u4f5c\u7b26"},{"location":"awk/#_22","text":"$ awk 'BEGIN { num = 5; if (num >= 0 && num <= 7) printf \"%d is in octal format\\n\", num }' 5 is in octal format $ awk 'BEGIN { ch = \"\\n\"; if (ch == \" \" || ch == \"\\t\" || ch == \"\\n\") print \"Current character is whitespace.\" }' Current character is whitespace. $ awk 'BEGIN { name = \"\"; if (! length(name)) print \"name is empty string.\" }' name is empty string.","title":"\u903b\u8f91\u64cd\u4f5c\u7b26"},{"location":"awk/#_23","text":"$ awk 'BEGIN { a = 10; b = 20; (a > b) ? max = a : max = b; print \"Max =\", max}' Max = 20","title":"\u4e09\u5143\u64cd\u4f5c\u7b26"},{"location":"awk/#_24","text":"$ awk 'BEGIN { a = -10; a = +a; print \"a =\", a }' a = -10 $ awk 'BEGIN { a = -10; a = -a; print \"a =\", a }' a = 10","title":"\u4e00\u5143\u64cd\u4f5c\u7b26"},{"location":"awk/#_25","text":"$ awk 'BEGIN { a = 10; a = a ^ 2; print \"a =\", a }' a = 100 $ awk 'BEGIN { a = 10; a ^= 2; print \"a =\", a }' a = 100","title":"\u6307\u6570\u64cd\u4f5c\u7b26"},{"location":"awk/#_26","text":"$ awk 'BEGIN { str1 = \"Hello, \"; str2 = \"World\"; str3 = str1 str2; print str3 }' Hello, World","title":"\u5b57\u7b26\u4e32\u8fde\u63a5\u64cd\u4f5c\u7b26"},{"location":"awk/#_27","text":"$ awk 'BEGIN { arr[0] = 1; arr[1] = 2; arr[2] = 3; for (i in arr) printf \"arr[%d] = %d\\n\", i, arr[i] }' arr[2] = 3 arr[0] = 1 arr[1] = 2","title":"\u6570\u7ec4\u6210\u5458\u64cd\u4f5c\u7b26"},{"location":"awk/#_28","text":"\u6b63\u5219\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26\u4f7f\u7528 ~ \u548c !~ \u5206\u522b\u4ee3\u8868\u5339\u914d\u548c\u4e0d\u5339\u914d\u3002 $ awk '$0 ~ 9' marks.txt 2) Rahul Maths 90 5) Hari History 89 $ awk '$0 !~ 9' marks.txt 1) Amit Physics 80 3) Shyam Biology 87 4) Kedar English 85 # \u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u9700\u8981\u5728\u8868\u8fbe\u5f0f\u524d\u540e\u6dfb\u52a0\u53cd\u659c\u7ebf\uff0c\u4e0ejs\u7c7b\u4f3c\u5427 $ tail -n 40 /var/log/nginx/access.log | awk '$0 ~ /ip\\[127\\.0\\.0\\.1\\]/' \u66f4\u591a\u5173\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u8bf7\u770b\u540e\u9762\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u90e8\u5206","title":"\u6b63\u5219\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26"},{"location":"awk/#_29","text":"AWK\u5728\u5904\u7406\u6b63\u5219\u8868\u8fbe\u5f0f\u65b9\u9762\u662f\u975e\u5e38\u5f3a\u5927\u7684\uff0c\u4f7f\u7528\u7b80\u5355\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5904\u7406\u975e\u5e38\u590d\u6742\u7684\u95ee\u9898\u3002 $ echo -e \"cat\\nbat\\nfun\\nfin\\nfan\" | awk '/f.n/' fun fin fan $ echo -e \"This\\nThat\\nThere\\nTheir\\nthese\" | awk '/^The/' There Their $ echo -e \"knife\\nknow\\nfun\\nfin\\nfan\\nnine\" | awk '/n$/' fun fin fan $ echo -e \"Call\\nTall\\nBall\" | awk '/[CT]all/' Call Tall $ echo -e \"Call\\nTall\\nBall\" | awk '/[^CT]all/' Ball $ echo -e \"Call\\nTall\\nBall\\nSmall\\nShall\" | awk '/Call|Ball/' Call Ball $ echo -e \"Colour\\nColor\" | awk '/Colou?r/' Colour Color $ echo -e \"ca\\ncat\\ncatt\" | awk '/cat*/' ca cat catt $ echo -e \"111\\n22\\n123\\n234\\n456\\n222\" | awk '/2+/' 22 123 234 222 $ echo -e \"Apple Juice\\nApple Pie\\nApple Tart\\nApple Cake\" | awk '/Apple (Juice|Cake)/' Apple Juice Apple Cake","title":"\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"awk/#_30","text":"AWK\u652f\u6301\u5173\u8054\u6570\u7ec4\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u4f7f\u7528\u6570\u5b57\u7d22\u5f15\u7684\u6570\u7ec4\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5b57\u7b26\u4e32\u4f5c\u4e3a\u7d22\u5f15\uff0c\u800c\u4e14\u6570\u5b57\u7d22\u5f15\u4e5f\u4e0d\u8981\u6c42\u662f\u8fde\u7eed\u7684\u3002\u6570\u7ec4\u4e0d\u9700\u8981\u58f0\u660e\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u8bed\u6cd5\u5982\u4e0b\uff1a array_name[index] = value \u521b\u5efa\u6570\u7ec4\u7684\u65b9\u5f0f\u975e\u5e38\u7b80\u5355\uff0c\u76f4\u63a5\u4e3a\u53d8\u91cf\u8d4b\u503c\u5373\u53ef $ awk 'BEGIN { fruits[\"mango\"] = \"yellow\"; fruits[\"orange\"] = \"orange\" print fruits[\"orange\"] \"\\n\" fruits[\"mango\"] }' orange yellow \u5220\u9664\u6570\u7ec4\u5143\u7d20\u4f7f\u7528 delete \u8bed\u53e5 $ awk 'BEGIN { fruits[\"mango\"] = \"yellow\"; fruits[\"orange\"] = \"orange\"; delete fruits[\"orange\"]; print fruits[\"orange\"] }' \u5728AWK\u4e2d\uff0c\u53ea\u652f\u6301\u4e00\u7ef4\u6570\u7ec4\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u4e00\u7ef4\u6570\u7ec4\u6a21\u62df\u591a\u7ef4\uff0c\u4f8b\u5982\u6211\u4eec\u6709\u4e00\u4e2a3x3\u7684\u4e09\u7ef4\u6570\u7ec4 100 200 300 400 500 600 700 800 900 \u53ef\u4ee5\u8fd9\u6837\u64cd\u4f5c $ awk 'BEGIN { array[\"0,0\"] = 100; array[\"0,1\"] = 200; array[\"0,2\"] = 300; array[\"1,0\"] = 400; array[\"1,1\"] = 500; array[\"1,2\"] = 600; # print array elements print \"array[0,0] = \" array[\"0,0\"]; print \"array[0,1] = \" array[\"0,1\"]; print \"array[0,2] = \" array[\"0,2\"]; print \"array[1,0] = \" array[\"1,0\"]; print \"array[1,1] = \" array[\"1,1\"]; print \"array[1,2] = \" array[\"1,2\"]; }' array[0,0] = 100 array[0,1] = 200 array[0,2] = 300 array[1,0] = 400 array[1,1] = 500 array[1,2] = 600","title":"\u6570\u7ec4"},{"location":"awk/#_31","text":"\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5\u4e0e\u5927\u591a\u6570\u8bed\u8a00\u4e00\u6837\uff0c\u57fa\u672c\u683c\u5f0f\u5982\u4e0b if (condition) action if (condition) { action-1 action-1 . . action-n } if (condition) action-1 else if (condition2) action-2 else action-3 \u4f8b\u5982\uff1a $ awk 'BEGIN { num = 11; if (num % 2 == 0) printf \"%d is even number.\\n\", num; else printf \"%d is odd number.\\n\", num }' $ awk 'BEGIN { a = 30; if (a==10) print \"a = 10\"; else if (a == 20) print \"a = 20\"; else if (a == 30) print \"a = 30\"; }'","title":"\u6d41\u7a0b\u63a7\u5236"},{"location":"awk/#_32","text":"\u5faa\u73af\u64cd\u4f5c\u4e0e\u5176\u4ed6C\u7cfb\u8bed\u8a00\u4e00\u6837\uff0c\u4e3b\u8981\u5305\u62ec for \uff0c while \uff0c do...while \uff0c break \uff0c continue \u8bed\u53e5\uff0c\u5f53\u7136\uff0c\u8fd8\u6709\u4e00\u4e2a exit \u8bed\u53e5\u7528\u4e8e\u9000\u51fa\u811a\u672c\u6267\u884c\u3002 for (initialisation; condition; increment/decrement) action while (condition) action do action while (condition) \u4f8b\u5b50\uff1a $ awk 'BEGIN { for (i = 1; i <= 5; ++i) print i }' $ awk 'BEGIN {i = 1; while (i < 6) { print i; ++i } }' $ awk 'BEGIN {i = 1; do { print i; ++i } while (i < 6) }' $ awk 'BEGIN { sum = 0; for (i = 0; i < 20; ++i) { sum += i; if (sum > 50) break; else print \"Sum =\", sum } }' $ awk 'BEGIN { for (i = 1; i <= 20; ++i) { if (i % 2 == 0) print i ; else continue } }' $ awk 'BEGIN { sum = 0; for (i = 0; i < 20; ++i) { sum += i; if (sum > 50) exit(10); else print \"Sum =\", sum } }' exit \u7528\u4e8e\u9000\u51fa\u811a\u672c\uff0c\u53c2\u6570\u4e3a\u9000\u51fa\u7684\u72b6\u6001\u7801\uff0c\u53ef\u4ee5\u901a\u8fc7shell\u4e2d\u7684 $? \u83b7\u53d6","title":"\u5faa\u73af"},{"location":"awk/#_33","text":"","title":"\u51fd\u6570"},{"location":"awk/#_34","text":"AWK\u63d0\u4f9b\u4e86\u5f88\u591a\u65b9\u4fbf\u7684\u5185\u5efa\u51fd\u6570\u4f9b\u7f16\u7a0b\u4eba\u5458\u4f7f\u7528\u3002\u7531\u4e8e\u51fd\u6570\u6bd4\u8f83\u591a\uff0c\u4e2a\u4eba\u89c9\u5f97\u5355\u7eaf\u770b\u6bcf\u4e2a\u51fd\u6570\u7684\u4f7f\u7528\u4e5f\u6ca1\u6709\u4ec0\u4e48\u5b9e\u9645\u610f\u4e49\uff0c\u6bd4\u8f83\u5bb9\u6613\u9057\u5fd8\uff0c\u56e0\u6b64\uff0c\u8fd9\u91cc\u53ea\u7b80\u5355\u7684\u5217\u51fa\u5e38\u7528\u7684\u4e00\u4e9b\u51fd\u6570\uff0c\u53ea\u9700\u8981\u5bf9\u5176\u6709\u4e2a\u5370\u8c61\u5373\u53ef\uff0c\u4f7f\u7528\u7684\u65f6\u5019\u518d\u53bb \u67e5\u624b\u518c \u6548\u679c\u4f1a\u66f4\u597d\u4e00\u4e9b\u5427\u3002","title":"\u5185\u5efa\u51fd\u6570"},{"location":"awk/#_35","text":"atan2(y, x) cos(expr) exp(expr) int(expr) log(expr) rand sin(expr) sqrt(expr) srand([expr])","title":"\u6570\u5b66\u51fd\u6570"},{"location":"awk/#_36","text":"asort(arr [, d [, how] ]) asorti(arr [, d [, how] ]) gsub(regex, sub, string) index(str, sub) length(str) match(str, regex) split(str, arr, regex) sprintf(format, expr-list) strtonum(str) sub(regex, sub, string) substr(str, start, l) tolower(str) toupper(str)","title":"\u5b57\u7b26\u4e32\u51fd\u6570"},{"location":"awk/#_37","text":"systime mktime(datespec) strftime([format [, timestamp[, utc-flag]]])","title":"\u65f6\u95f4\u51fd\u6570"},{"location":"awk/#_38","text":"and compl lshift rshift or xor","title":"\u5b57\u8282\u64cd\u4f5c\u51fd\u6570"},{"location":"awk/#_39","text":"close(expr) \u5173\u95ed\u7ba1\u9053\u6587\u4ef6 \u8bf7\u770b\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801 $ awk 'BEGIN { cmd = \"tr [a-z] [A-Z]\" print \"hello, world !!!\" |& cmd close(cmd, \"to\") cmd |& getline out print out; close(cmd); }' HELLO, WORLD !!! \u662f\u4e0d\u662f\u611f\u89c9\u5f88\u96be\u61c2\uff1f\u8ba9\u6211\u6765\u89e3\u91ca\u4e00\u4e0b \u7b2c\u4e00\u4e2a\u8bed\u53e5 cmd = \"tr [a-z] [A-Z]\" \u662f\u6211\u4eec\u5728AWK\u4e2d\u8981\u7528\u6765\u5efa\u7acb\u53cc\u5411\u8fde\u63a5\u7684\u547d\u4ee4\u3002 \u7b2c\u4e8c\u4e2a\u8bed\u53e5 print \u63d0\u4f9b\u4e86 tr \u547d\u4ee4\u7684\u8f93\u5165\uff0c\u4f7f\u7528 &| \u8868\u540d\u5efa\u7acb\u53cc\u5411\u8fde\u63a5\u3002 \u7b2c\u4e09\u4e2a\u8bed\u53e5 close(cmd, \"to\") \u7528\u4e8e\u6267\u884c\u5b8c\u6210\u540e\u5173\u95ed to \u8fdb\u7a0b \u7b2c\u56db\u4e2a\u8bed\u53e5 cmd |& getline out \u4f7f\u7528 getline \u51fd\u6570\u5b58\u50a8\u8f93\u51fa\u5230 out \u53d8\u91cf \u63a5\u4e0b\u6765\u6253\u5370\u53d8\u91cfout\u7684\u5185\u5bb9\uff0c\u7136\u540e\u5173\u95edcmd delete \u7528\u4e8e\u5220\u9664\u6570\u7ec4\u5143\u7d20 exit \u9000\u51fa\u811a\u672c\u6267\u884c\uff0c\u5e76\u8fd4\u56de\u72b6\u6001\u7801\u53c2\u6570 fflush getline \u8be5\u547d\u4ee4\u8ba9awk\u8bfb\u53d6\u4e0b\u4e00\u884c\u5185\u5bb9 \u8be5\u547d\u4ee4\u8ba9awk\u8bfb\u53d6\u4e0b\u4e00\u884c\u5185\u5bb9\uff0c\u6bd4\u5982 $ awk '{getline; print $0}' marks.txt 2) Rahul Maths 90 4) Kedar English 85 5) Hari History 89 \u4f7f\u7528 getline var < file \u53ef\u4ee5\u4ecefile\u4e2d\u8bfb\u53d6\u8f93\u5165\uff0c\u5b58\u50a8\u5230\u53d8\u91cfvar\u4e2d { if (NF == 2 && $1 == \"@include\") { while ((getline line < $2) > 0) print line # \u8fd9\u91cc\u7684close\u786e\u4fdd\u5982\u679c\u6587\u4ef6\u4e2d\u4e24\u4e2a@include\uff0c\u53ef\u4ee5\u8ba9\u5176\u8bfb\u53d6\u4e24\u6b21 close($2) } else print } \u547d\u4ee4\u7684\u8f93\u51fa\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7ba1\u9053\u8f93\u5165\u5230 getline \uff0c\u4f7f\u7528 command | getline \u8fd9\u79cd\u65b9\u5f0f\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5b57\u7b26\u4e32\u547d\u4ee4\u4f1a\u4f5c\u4e3ashell\u547d\u4ee4\u6267\u884c\uff0c\u5176\u6807\u51c6\u8f93\u51fa\u4f1a\u901a\u8fc7\u7ba1\u9053\u4f20\u9012\u4e2aawk\u4f5c\u4e3a\u5176\u8f93\u5165\uff0c\u8fd9\u79cd\u5f62\u5f0f\u7684getline\u4f1a\u4ece\u7ba1\u9053\u4e2d\u4e00\u6b21\u8bfb\u53d6\u4e00\u6761\u8bb0\u5f55\u3002\u4f8b\u5982\u4e0b\u9762\u7684\u547d\u4ee4\u4f1a\u4ece\u8f93\u5165\u4e2d\u9010\u884c\u8bfb\u53d6\uff0c\u5982\u679c\u9047\u5230 @execute \uff0c\u5219\u5c06\u8be5\u884c\u4f5c\u4e3a\u547d\u4ee4\u6267\u884c\uff0c\u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u4f5c\u4e3a\u6700\u7ec8\u7684\u8f93\u51fa\u5185\u5bb9 { if ($1 == \"@execute\") { tmp = substr($0, 10) # Remove \"@execute\" while ((tmp | getline) > 0) # \u8fd9\u91cc\u5b9e\u9645\u4e0a\u8bbe\u7f6e\u4e86$0\u4e3a\u8fd9\u4e00\u884c\u7684\u5185\u5bb9 print close(tmp) } else print } \u5982\u679c\u6587\u4ef6\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9 foo bar baz @execute who bletch \u5219\u4f1a\u8f93\u51fa foo bar baz arnold ttyv0 Jul 13 14:22 miriam ttyp0 Jul 13 14:23 (murphy:0) bill ttyp1 Jul 13 14:23 (murphy:0) bletch \u4f7f\u7528 command | getline var \u53ef\u4ee5\u5b9e\u73b0\u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u5199\u5165\u5230\u53d8\u91cfvar\u3002 BEGIN { \"date\" | getline current_time close(\"date\") print \"Report printed on \" current_time } getline \u4f7f\u7528\u7ba1\u9053\u8bfb\u53d6\u8f93\u5165\u662f\u4e00\u79cd\u5355\u5411\u7684\u64cd\u4f5c\uff0c\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\uff0c\u4f60\u53ef\u80fd\u5e0c\u671b\u53d1\u9001\u6570\u636e\u5230\u53e6\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u7136\u540e\u4ece\u8fd9\u4e2a\u8fdb\u7a0b\u4e2d\u8bfb\u53d6\u5904\u7406\u540e\u7684\u7ed3\u679c\uff0c \u8fd9\u5c31\u7528\u5230\u4e86\u534f\u540c\u8fdb\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 |& \u6253\u5f00\u4e00\u4e2a\u53cc\u5411\u7ba1\u9053\u3002 print \"some query\" |& \"db_server\" \"db_server\" |& getline \u540c\u6837\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528 command |& getline var \u5c06\u534f\u540c\u8fdb\u7a0b\u7684\u8f93\u51fa\u5199\u5165\u5230\u53d8\u91cfvar\u3002 next nextfile return \u7528\u4e8e\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u8fd4\u56de\u503c\u3002 \u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a functions.awk \u6587\u4ef6\uff0c\u5305\u542b\u4e0b\u9762\u7684awk\u547d\u4ee4 function addition(num1, num2) { result = num1 + num2 return result } BEGIN { res = addition(10, 20) print \"10 + 20 = \" res } \u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\uff0c\u8f93\u51fa 10 + 20 = 30 system \u8be5\u51fd\u6570\u7528\u4e8e\u6267\u884c\u6307\u5b9a\u7684\u547d\u4ee4\u5e76\u4e14\u8fd4\u56de\u5b83\u7684\u9000\u51fa\u72b6\u6001\uff0c\u8fd4\u56de\u72b6\u6001\u78010\u8868\u793a\u547d\u4ee4\u6210\u529f\u6267\u884c\u3002 $ awk 'BEGIN { ret = system(\"date\"); print \"Return value = \" ret }' 2016\u5e74 10\u6708 27\u65e5 \u661f\u671f\u56db 22:08:36 CST Return value = 0","title":"\u5176\u5b83"},{"location":"awk/#_40","text":"\u51fd\u6570\u662f\u7a0b\u5e8f\u57fa\u672c\u7684\u7ec4\u6210\u90e8\u5206\uff0cAWK\u5141\u8bb8\u6211\u4eec\u81ea\u5df1\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u3002\u4e00\u4e2a\u5927\u578b\u7684\u7a0b\u5e8f\u53ef\u4ee5\u88ab\u5212\u5206\u4e3a\u591a\u4e2a\u51fd\u6570\uff0c\u6bcf\u4e2a\u51fd\u6570\u4e4b\u95f4\u53ef\u4ee5\u72ec\u7acb\u7684\u5f00\u53d1\u548c\u6d4b\u8bd5\uff0c\u63d0\u4f9b\u53ef\u91cd\u7528\u7684\u4ee3\u7801\u3002 \u4e0b\u9762\u662f\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u57fa\u672c\u8bed\u6cd5 function function_name(argument1, argument2, ...) { function body } \u4f8b\u5982\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3afunctions.awk\u7684\u6587\u4ef6\uff0c\u5305\u542b\u4e0b\u9762\u7684\u4ee3\u7801 # Returns minimum number function find_min(num1, num2){ if (num1 < num2) return num1 return num2 } # Returns maximum number function find_max(num1, num2){ if (num1 > num2) return num1 return num2 } # Main function function main(num1, num2){ # Find minimum number result = find_min(10, 20) print \"Minimum =\", result # Find maximum number result = find_max(10, 20) print \"Maximum =\", result } # Script execution starts here BEGIN { main(10, 20) } \u6267\u884c\u4e0a\u8ff0\u4ee3\u7801\uff0c\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u8f93\u51fa Minimum = 10 Maximum = 20","title":"\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570"},{"location":"awk/#_41","text":"","title":"\u8f93\u51fa\u91cd\u5b9a\u5411"},{"location":"awk/#_42","text":"\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u6240\u6709\u7684\u7a0b\u5e8f\u90fd\u662f\u76f4\u63a5\u663e\u793a\u6570\u636e\u5230\u4e86\u6807\u51c6\u8f93\u51fa\u6d41\uff0c\u5176\u5b9e\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u3002\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\u8ddf\u5728 print \u548c printf \u51fd\u6570\u7684\u540e\u9762\uff0c\u4e0eshell\u4e2d\u7684\u7528\u6cd5\u57fa\u672c\u4e00\u81f4\u3002 print DATA > output-file print DATA >> output-file \u4f8b\u5982\uff0c\u4e0b\u9762\u4e24\u6761\u547d\u4ee4\u8f93\u51fa\u662f\u4e00\u81f4\u7684 $ echo \"Hello, World !!!\" > /tmp/message.txt $ awk 'BEGIN { print \"Hello, World !!!\" > \"/tmp/message.txt\" }' \u4e0eshell\u4e2d\u4e00\u6837\uff0c > \u7528\u4e8e\u5c06\u8f93\u51fa\u5199\u5165\u5230\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\uff0c\u5982\u679c\u6587\u4ef6\u4e2d\u6709\u5185\u5bb9\u5219\u8986\u76d6\uff0c\u800c >> \u5219\u4e3a\u8ffd\u52a0\u6a21\u5f0f\u5199\u5165\u3002 $ awk 'BEGIN { print \"Hello, World !!!\" >> \"/tmp/message.txt\" }' $ cat /tmp/message.txt","title":"\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26"},{"location":"awk/#_43","text":"\u9664\u4e86\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u4e4b\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u5176\u5b83\u7a0b\u5e8f\uff0c\u4e0eshell\u4e2d\u4e00\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7ba1\u9053\u64cd\u4f5c\u7b26 | \u3002 $ awk 'BEGIN { print \"hello, world !!!\" | \"tr [a-z] [A-Z]\" }' HELLO, WORLD !!! AWK\u4e2d\u53ef\u4ee5\u4f7f\u7528 |& \u8fdb\u884c \u53cc\u5411\u8fde\u63a5 \uff0c\u90a3\u4e48\u4ec0\u4e48\u662f\u53cc\u5411\u8fde\u63a5\u5462\uff1f\u4e00\u79cd\u5e38\u89c1\u7684\u573a\u666f\u662f\u6211\u4eec\u53d1\u9001\u6570\u636e\u5230\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u5904\u7406\uff0c\u7136\u540e\u8bfb\u53d6\u5904\u7406\u7ed3\u679c\uff0c\u8fd9\u79cd\u573a\u666f\u4e0b\u5c31\u9700\u8981\u6253\u5f00\u4e00\u4e2a\u5230\u53e6\u5916\u4e00\u4e2a\u8fdb\u7a0b\u7684\u53cc\u5411\u7ba1\u9053\u4e86\u3002\u7b2c\u4e8c\u4e2a\u8fdb\u7a0b\u4f1a\u4e0e gawk \u7a0b\u5e8f\u5e76\u884c\u6267\u884c\uff0c\u8fd9\u91cc\u79f0\u5176\u4e3a \u534f\u4f5c\u8fdb\u7a0b \u3002\u4e0e\u5355\u5411\u8fde\u63a5\u4f7f\u7528 | \u64cd\u4f5c\u7b26\u4e0d\u540c\u7684\u662f\uff0c\u53cc\u5411\u8fde\u63a5\u4f7f\u7528 |& \u64cd\u4f5c\u7b26\u3002 do { print data |& \"subprogram\" \"subprogram\" |& getline results } while (data left to process) close(\"subprogram\") \u7b2c\u4e00\u6b21I/O\u64cd\u4f5c\u4f7f\u7528\u4e86 |& \u64cd\u4f5c\u7b26\uff0cgawk\u4f1a\u521b\u5efa\u4e00\u4e2a\u5230\u8fd0\u884c\u5176\u5b83\u7a0b\u5e8f\u7684\u5b50\u8fdb\u7a0b\u7684\u53cc\u5411\u7ba1\u9053\uff0c print \u7684\u8f93\u51fa\u88ab\u5199\u5165\u5230\u4e86 subprogram \u7684\u6807\u51c6\u8f93\u5165\uff0c\u800c\u8fd9\u4e2a subprogram \u7684\u6807\u51c6\u8f93\u51fa\u5728gawk\u4e2d\u4f7f\u7528 getline \u51fd\u6570\u8fdb\u884c\u8bfb\u53d6\u3002 \u6ce8\u610f\uff1a\u76ee\u524d\u534f\u540c\u8fdb\u7a0b\u7684\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u5c06\u4f1a\u548cgawk\u7684\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u6df7\u6742\u5728\u4e00\u8d77\uff0c\u65e0\u6cd5\u5355\u72ec\u83b7\u53d6\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002\u53e6\u5916\uff0cI/O\u7f13\u51b2\u53ef\u80fd\u5b58\u5728\u95ee\u9898\uff0cgawk\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u7684\u5237\u65b0\u6240\u6709\u8f93\u51fa\u5230\u4e0b\u6e38\u7684\u534f\u540c\u8fdb\u7a0b\u7684\u7ba1\u9053\u3002\u4f46\u662f\uff0c\u5982\u679c\u534f\u540c\u8fdb\u7a0b\u6ca1\u6709\u5237\u65b0\u5176\u6807\u51c6\u8f93\u51fa\u7684\u8bdd\uff0cgawk\u5c06\u53ef\u80fd\u4f1a\u5728\u4f7f\u7528 getline \u51fd\u6570\u4ece\u534f\u540c\u8fdb\u7a0b\u8bfb\u53d6\u8f93\u51fa\u7684\u65f6\u5019\u6302\u8d77\uff0c\u8fd9\u5c31\u53ef\u80fd\u5f15\u8d77\u6b7b\u9501\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 close \u51fd\u6570\u5173\u95ed\u53cc\u5411\u7ba1\u9053\u7684 to \u6216\u8005 from \u4e00\u7aef\uff0c\u8fd9\u4e24\u4e2a\u5b57\u7b26\u4e32\u503c\u544a\u8bc9gawk\u53d1\u9001\u6570\u636e\u5230\u534f\u540c\u8fdb\u7a0b\u5b8c\u6210\u65f6\u6216\u8005\u4ece\u534f\u540c\u8fdb\u7a0b\u8bfb\u53d6\u5b8c\u6bd5\u65f6\u5173\u95ed\u7ba1\u9053\u3002\u5728\u4f7f\u7528\u7cfb\u7edf\u547d\u4ee4 sort \u7684\u65f6\u5019\u662f\u8fd9\u6837\u505a\u662f\u975e\u5e38\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a\u5b83\u5fc5\u987b\u7b49\u6240\u6709\u8f93\u51fa\u90fd\u8bfb\u53d6\u5b8c\u6bd5\u65f6\u624d\u80fd\u8fdb\u884c\u6392\u5e8f\u3002 BEGIN { command = \"LC_ALL=C sort\" n = split(\"abcdefghijklmnopqrstuvwxyz\", a, \"\") for (i = n; i > 0; i--) print a[i] |& command close(command, \"to\") while ((command |& getline line) > 0) print \"got\", line close(command) } \u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\u4f7f\u7528 tr \u547d\u4ee4\u8f6c\u6362\u5c0f\u5199\u4e3a\u5927\u5199\u3002\u6211\u4eec\u7684 command.awk \u6587\u4ef6\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9 BEGIN { cmd = \"tr [a-z] [A-Z]\" print \"hello, world !!!\" |& cmd close(cmd, \"to\") cmd |& getline out print out; close(cmd); } \u8f93\u51fa HELLO, WORLD !!! \u4e0a\u4f8b\u770b\u8d77\u6765\u6709\u4e9b\u590d\u6742\uff0c\u6211\u4eec\u9010\u884c\u5206\u6790\u4e00\u4e0b \u9996\u5148\uff0c\u7b2c\u4e00\u884c cmd = \"tr [a-z] [A-Z]\" \u662f\u5728AWK\u4e2d\u8981\u5efa\u7acb\u53cc\u5411\u8fde\u63a5\u7684\u547d\u4ee4 \u7b2c\u4e8c\u884c\u7684 print \u547d\u4ee4\u7528\u4e8e\u4e3a tr \u547d\u4ee4\u63d0\u4f9b\u8f93\u5165\uff0c\u800c |& \u7528\u4e8e\u6307\u51fa\u8981\u5efa\u7acb\u53cc\u5411\u8fde\u63a5 \u7b2c\u4e09\u884c\u7528\u4e8e\u5728\u4e0a\u9762\u7684\u8bed\u53e5 close(cmd, \"to\"), \u5728\u6267\u884c\u5b8c\u6210\u540e\u5173\u95ed\u5176 to \u8fdb\u7a0b \u7b2c\u56db\u884c cmd |& getline out \u4f7f\u7528getline\u51fd\u6570\u5b58\u50a8\u8f93\u51fa\u5230\u53d8\u91cfout\u4e2d \u6700\u540e\u4e00\u884c\u4f7f\u7528 close \u51fd\u6570\u5173\u95ed\u547d\u4ee4","title":"\u7ba1\u9053"},{"location":"awk/#_44","text":"\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u4f7f\u7528\u8fc7 print \u548c printf \u51fd\u6570\u663e\u793a\u6570\u636e\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u4f46\u662f printf \u51fd\u6570\u5b9e\u9645\u4e0a\u8981\u6bd4\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684\u60c5\u51b5\u66f4\u52a0\u5f3a\u5927\u5f97\u591a\u3002\u8be5\u51fd\u6570\u662f\u4eceC\u8bed\u8a00\u4e2d\u501f\u9274\u6765\u7684\uff0c\u5728\u5904\u7406\u683c\u5f0f\u5316\u7684\u8f93\u51fa\u65f6\u975e\u5e38\u6709\u7528\u3002 $ awk 'BEGIN { printf \"Hello\\nWorld\\n\" }' Hello World $ awk 'BEGIN { printf \"ASCII value 65 = character %c\\n\", 65 }' ASCII value 65 = character A \u683c\u5f0f\u5316\u8f93\u51fa\u6807\u8bc6\u6709 %c \uff0c %d \uff0c %s \u7b49\uff0c\u57fa\u672c\u4e0eC\u8bed\u8a00\u4e00\u81f4\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8d58\u8ff0\u4e86\u3002","title":"\u7f8e\u5316\u8f93\u51fa"},{"location":"awk/#shell","text":"\u5728AWK\u4e2d\u6267\u884cshell\u547d\u4ee4\u6709\u4e24\u79cd\u65b9\u5f0f \u4f7f\u7528 system \u51fd\u6570 \u4f7f\u7528\u7ba1\u9053","title":"\u6267\u884cshell\u547d\u4ee4"},{"location":"awk/#system","text":"system \u51fd\u6570\u7528\u4e8e\u6267\u884c\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u5e76\u4e14\u8fd4\u56de\u547d\u4ee4\u7684\u9000\u51fa\u7801\u5230awk\u3002 END { system(\"date | mail -s 'awk run done' root\") }","title":"\u4f7f\u7528system\u51fd\u6570"},{"location":"awk/#_45","text":"\u5982\u679c\u8981\u6267\u884c\u7684\u547d\u4ee4\u5f88\u591a\uff0c\u53ef\u4ee5\u5c06\u8f93\u51fa\u7684\u547d\u4ee4\u76f4\u63a5\u7528\u7ba1\u9053\u4f20\u9012\u7ed9 \"/bin/sh\" \u6267\u884c while (more stuff to do) print command | \"/bin/sh\" close(\"/bin/sh\")","title":"\u4f7f\u7528\u7ba1\u9053"},{"location":"awk/#_46","text":"AWK Tutorial The GNU Awk User's Guide \u672c\u6587\u5c06\u4f1a\u6301\u7eed\u4fee\u6b63\u548c\u66f4\u65b0\uff0c\u6700\u65b0\u5185\u5bb9\u8bf7\u53c2\u8003\u6211\u7684 GITHUB \u4e0a\u7684 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6b22\u8fce Star\u3002","title":"\u53c2\u8003"},{"location":"centos-network-device-naming/","text":"\u8f6c\u81ea: https://www.cnblogs.com/zyd112/p/8143464.html centos7\u4e2d\u7684\u7f51\u5361\u4e00\u81f4\u6027\u547d\u540d\u89c4\u5219\u3001\u7f51\u5361\u91cd\u547d\u540d\u65b9\u6cd5 \u00b6 \u4e00\u81f4\u6027\u7f51\u7edc\u8bbe\u5907\u547d\u540d(Consistent Network Device Naming) \u80cc\u666f\u4ecb\u7ecd\uff1a \u5728centos5\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4e60\u60ef\u4e86eth0\u8fd9\u6837\u7684\u7f51\u7edc\u8bbe\u5907\u547d\u540d\uff0c\u5728centos6\u53d1\u73b0\u7f51\u7edc\u8bbe\u5907\u53d8\u6210\u4e86em1\u8fd9\u6837\u7684\u547d\u540d\u3002 \u90a3\u65f6\u6211\u4eec\u5728\u5b89\u88c5\u7684\u65f6\u5019\uff0c\u7ed9\u542f\u52a8\u53c2\u6570\u52a0\u4e0a biosdevname=0\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528eth0\u8fd9\u6837\u7684\u547d\u540d\u3002 \u5347\u7ea7\u5230centos7\u540e\uff0c\u53d1\u73b0\u539f\u6709\u7684\u53c2\u6570biosdevname=0\u4e0d\u8d77\u4f5c\u7528\u4e86\uff0c\u7f51\u7edc\u8bbe\u5907\u53d8\u6210\u4e86eno1\u8fd9\u6837\u7684\u540d\u79f0\u3002 centos7\u8fd9\u79cd\u53d8\u5316\u7684\u539f\u56e0\u662f\u7531\u4e8esystemd\u548cudev\u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u7f51\u7edc\u8bbe\u5907\u547d\u540d\u65b9\u5f0f\uff1a\u4e00\u81f4\u7f51\u7edc\u8bbe\u5907\u547d\u540d\uff08CONSISTENT NETWORK DEVICE NAMING\uff09\u3002 \u4e00\u3001\u4e3a\u4ec0\u4e48\u9700\u8981\u8fd9\u4e2a \u00b6 \u670d\u52a1\u5668\u901a\u5e38\u6709\u591a\u5757\u7f51\u5361\uff0c\u6709\u677f\u8f7d\u96c6\u6210\u7684\uff0c\u540c\u65f6\u4e5f\u6709\u63d2\u5728PCIe\u63d2\u69fd\u7684\u3002 Linux\u7cfb\u7edf\u7684\u547d\u540d\u539f\u6765\u662feth0,eth1\u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u4f46\u662f\u8fd9\u4e2a\u7f16\u53f7\u5f80\u5f80\u4e0d\u4e00\u5b9a\u51c6\u786e\u5bf9\u5e94\u7f51\u5361\u63a5\u53e3\u7684\u7269\u7406\u987a\u5e8f\u3002 \u4e3a\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898,dell\u5f00\u53d1\u4e86biosdevname\u65b9\u6848(systemd v197\u7248\u672c\u4e2d\u5c06dell\u7684\u65b9\u6848\u4f5c\u4e86\u8fdb\u4e00\u6b65\u7684\u4e00\u822c\u5316\u62d3\u5c55)\u3002 \u76ee\u524d\u7684Centos\u65e2\u652f\u6301dell\u7684biosdevname\uff0c\u4e5f\u652f\u6301systemd\u7684\u65b9\u6848\u3002 \u4e8c\u3001Centos7\u4e2d\u7684\u547d\u540d\u7b56\u7565 \u00b6 Scheme 1: \u5982\u679c\u4eceBIOS\u4e2d\u80fd\u591f\u53d6\u5230\u53ef\u7528\u7684\uff0c\u677f\u8f7d\u7f51\u5361\u7684\u7d22\u5f15\u53f7\uff0c\u5219\u4f7f\u7528\u8fd9\u4e2a\u7d22\u5f15\u53f7\u547d\u540d\uff0c\u4f8b\u5982: eno1\uff0c\u5982\u4e0d\u80fd\u5219\u5c1d\u8bd5Scheme 2 Scheme 2: \u5982\u679c\u4eceBIOS\u4e2d\u80fd\u591f\u53d6\u5230\u53ef\u4ee5\u7528\u7684\uff0c\u7f51\u5361\u6240\u5728\u7684PCI-E\u70ed\u63d2\u62d4\u63d2\u69fd\u7684\u7d22\u5f15\u53f7\uff0c\u5219\u4f7f\u7528\u8fd9\u4e2a\u7d22\u5f15\u53f7\u547d\u540d\uff0c\u4f8b\u5982: ens1\uff0c\u5982\u4e0d\u80fd\u5219\u5c1d\u8bd5Scheme 3 Scheme 3: \u5982\u679c\u80fd\u62ff\u5230\u8bbe\u5907\u6240\u8fde\u63a5\u7684\u7269\u7406\u4f4d\u7f6e\u4fe1\u606f\uff0c\u5219\u4f7f\u7528\u8fd9\u4e2a\u4fe1\u606f\u547d\u540d\uff0c\u4f8b\u5982:enp2s0\uff0c\u5982\u4e0d\u80fd\u5219\u5c1d\u8bd5Scheme 5 Scheme 4: \u4f7f\u7528\u7f51\u5361\u7684MAC\u5730\u5740\u6765\u547d\u540d\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e00\u822c\u4e0d\u4f7f\u7528\u3002 Scheme 5\uff1a\u4f20\u7edf\u7684kernel\u547d\u540d\u65b9\u6cd5\uff0c\u4f8b\u5982: eth0\uff0c\u8fd9\u79cd\u547d\u540d\u65b9\u6cd5\u7684\u7ed3\u679c\u4e0d\u53ef\u9884\u77e5\u7684\uff0c\u5373\u53ef\u80fd\u7b2c\u4e8c\u5757\u7f51\u5361\u5bf9\u5e94eth0\uff0c\u7b2c\u4e00\u5757\u7f51\u5361\u5bf9\u5e94eth1\u3002 \u4e09\u3001biosdevname\u548cnet.ifnames\u4e24\u79cd\u547d\u540d\u89c4\u8303 \u00b6 net.ifnames\u547d\u540d\u89c4\u8303\u4e3a:\u8bbe\u5907\u7c7b\u578b+\u8bbe\u5907\u4f4d\u7f6e+\u6570\u5b57 \u8bbe\u5907\u7c7b\u578b\uff1a - en \u8868\u793aEthernet - wl \u8868\u793aWLAN - ww \u8868\u793a\u65e0\u7ebf\u5e7f\u57df\u7f51WWAN \u5b9e\u9645\u7684\u4f8b\u5b50: - eno1 \u677f\u8f7d\u7f51\u5361 - enp0s2 pci\u7f51\u5361 - ens33 pci\u7f51\u5361 - wlp3s0 PCI\u65e0\u7ebf\u7f51\u5361 - wwp0s29f7u2i2 4G modem - wlp0s2f1u4u1 \u8fde\u63a5\u5728USB Hub\u4e0a\u7684\u65e0\u7ebf\u7f51\u5361 - enx78e7d1ea46da pci\u7f51\u5361 biosdevname\u7684\u547d\u540d\u89c4\u8303\u4e3a: \u5b9e\u9645\u7684\u4f8b\u5b50: - em1 \u677f\u8f7d\u7f51\u5361 - p3p4 pci\u7f51\u5361 - p3p4_1 \u865a\u62df\u7f51\u5361 \u56db\u3001systemd\u4e2d\u7684\u5b9e\u9645\u6267\u884c\u987a\u5e8f \u00b6 \u6309\u7167\u5982\u4e0b\u987a\u5e8f\u6267\u884cudev\u7684rule /usr/lib/udev/rules.d/60-net.rules /usr/lib/udev/rules.d/71-biosdevname.rules /lib/udev/rules.d/75-net-description.rules /usr/lib/udev/rules.d/80-net-name-slot.rules 60-net.rules \u4f7f\u7528/lib/udev/rename_device\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u53bb\u67e5\u8be2/etc/sysconfig/network-scripts/\u4e0b\u6240\u6709\u4ee5ifcfg-\u5f00\u5934\u7684\u6587\u4ef6 \u5982\u679c\u5728ifcfg-xx\u4e2d\u5339\u914d\u5230HWADDR=xx:xx:xx:xx:xx:xx\u53c2\u6570\u7684\u7f51\u5361\u63a5\u53e3 \u5219\u9009\u53d6DEVICE=yyyy\u4e2d\u8bbe\u7f6e\u7684\u540d\u5b57\u4f5c\u4e3a\u7f51\u5361\u540d\u79f0\u3002 71-biosdevname.rules \u5982\u679c\u7cfb\u7edf\u4e2d\u5b89\u88c5\u4e86biosdevname\uff0c\u4e14\u5185\u6838\u53c2\u6570\u672a\u6307\u5b9abiosdevname=0\uff0c\u4e14\u4e0a\u4e00\u6b65\u6ca1\u6709\u91cd\u547d\u540d\u7f51\u5361\uff0c\u5219\u6309\u7167biosdevname\u7684\u547d\u540d\u89c4\u8303\uff0c\u4eceBIOS\u4e2d\u53d6\u76f8\u5173\u4fe1\u606f\u6765\u547d\u540d\u7f51\u5361\u3002 \u4e3b\u8981\u662f\u53d6SMBIOS\u4e2d\u7684type 9 (System Slot) \u548c type 41 (Onboard Devices Extended Information) \u4e0d\u8fc7\u8981\u6c42SMBIOS\u7684\u7248\u672c\u8981\u9ad8\u4e8e2.6\uff0c\u4e14\u7cfb\u7edf\u4e2d\u8981\u5b89\u88c5biosdevname\u7a0b\u5e8f\u3002 75-net-description.rules udev\u901a\u8fc7\u68c0\u67e5\u7f51\u5361\u4fe1\u606f\uff0c\u586b\u5199\u5982\u4e0b\u8fd9\u4e9budev\u7684\u5c5e\u6027\u503c ID_NET_NAME_ONBOARD ID_NET_NAME_SLOT ID_NET_NAME_PATH ID_NET_NAME_MAC 80-net-name-slot.rules \u5982\u679c\u572860-net.rules \uff0c71-biosdevname.rules\u8fd9\u4e24\u6761\u89c4\u5219\u4e2d\u6ca1\u6709\u91cd\u547d\u540d\u7f51\u5361\uff0c\u4e14\u5185\u6838\u672a\u6307\u5b9anet.ifnames=0\u53c2\u6570 \u5219udev\u4f9d\u6b21\u5c1d\u8bd5\u4f7f\u7528\u4ee5\u4e0b\u5c5e\u6027\u503c\u6765\u547d\u540d\u7f51\u5361\uff0c\u5982\u679c\u8fd9\u4e9b\u5c5e\u6027\u503c\u90fd\u6ca1\u6709\uff0c\u5219\u7f51\u5361\u4e0d\u4f1a\u88ab\u91cd\u547d\u540d\u3002 ID_NET_NAME_ONBOARD ID_NET_NAME_SLOT ID_NET_NAME_PATH \u4e0a\u8fb9\u768471-biosdevname.rules \u662f\u5b9e\u9645\u6267\u884cbiosdevname\u7684policy 75-net-description.rules\u548c80-net-name-slot.rules\u5b9e\u9645\u6267\u884cScheme 1,2,3 \u6839\u636e\u4e0a\u8ff0\u7684\u8fc7\u7a0b\uff0c\u53ef\u89c1\u7f51\u5361\u547d\u540d\u53d7 biosdevname\u548cnet.ifnames\u8fd9\u4e24\u4e2a\u5185\u6838\u53c2\u6570\u5f71\u54cd\u3002 \u4e94\u3001biosdevname/net.ifnames\u5e94\u7528 \u00b6 \u8fd9\u4e24\u4e2a\u53c2\u6570\u90fd\u53ef\u4ee5\u5728grub\u914d\u7f6e\u4e2d\u63d0\u4f9b\uff0cbiosdevname=0\u662f\u7cfb\u7edf\u9ed8\u8ba4\u503c\uff08dell\u670d\u52a1\u5668\u9ed8\u8ba4\u662f1\uff09\uff0cnet.ifnames=1\u662f\u7cfb\u7edf\u9ed8\u8ba4\u503c\u3002 #vi /boot/grub/grub.conf kernel /boot/vmlinuz biosdevname=1 initrd /boot/initrd.img \u7b2c\u4e8c\u8282\u6240\u8bf4\u7684Scheme\u7684\u7b56\u7565\u987a\u5e8f\u662f\u7cfb\u7edf\u9ed8\u8ba4\u7684\u3002 \u5982\u7cfb\u7edfBIOS\u7b26\u5408\u8981\u6c42\uff0c\u4e14\u7cfb\u7edf\u4e2d\u5b89\u88c5\u4e86biosdevname\uff0c\u4e14biosdevname=1\u542f\u7528\uff0c\u5219biosdevname\u4f18\u5148\uff1b \u5982\u679cBIOS\u4e0d\u7b26\u5408biosdevname\u8981\u6c42\u6216biosdevname=0\uff0c\u5219\u4ecd\u7136\u662fsystemd\u7684\u89c4\u5219\u4f18\u5148\u3002 \u5982\u679c\u7528\u6237\u81ea\u5df1\u5b9a\u4e49\u4e86udev rule\u6765\u4fee\u6539\u5185\u6838\u8bbe\u5907\u540d\u5b57\uff0c\u5219\u7528\u6237\u89c4\u5219\u4f18\u5148\u3002 \u5185\u6838\u53c2\u6570\u7ec4\u5408\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u5176\u7ed3\u679c\u5982\u4e0b\uff1a \u9ed8\u8ba4\u5185\u6838\u53c2\u6570(biosdevname=0\uff0cnet.ifnames=1): \u7f51\u5361\u540d \"enp5s2\" biosdevname=1\uff0cnet.ifnames=0\uff1a\u7f51\u5361\u540d \"em1\" biosdevname=0\uff0cnet.ifnames=0\uff1a\u7f51\u5361\u540d \"eth0\" (\u6700\u4f20\u7edf\u7684\u65b9\u5f0f,eth0 eth1 \u50bb\u50bb\u5206\u4e0d\u6e05) \u516d\u3001centos7\u7f51\u5361\u91cd\u547d\u540d\u4e3aethx\u683c\u5f0f \u00b6 \u5982\u679c\u4f60\u5e0c\u671b\u7ee7\u7eed\u4f7f\u7528 eth0 \u8fd9\u6837\u7684\u4f20\u7edf\u540d\u79f0\uff0c\u90a3\u4e48\u5728\u5b89\u88c5\u542f\u52a8\uff08pxe\uff09\u65f6\u52a0\u4e0a\u53c2\u6570\uff1a net.ifnames=0 biosdevname=0 cobbler profile \u4fee\u6539\u65b9\u6cd5\uff1a cobbler profile edit --name=Centos-7.3-x86_64 --kopts='net.ifnames=0 biosdevname=0' \u5982\u679c\u4f60\u5df2\u7ecf\u5b89\u88c5\u5b8c\u4e86\uff0c\u5e0c\u671b\u6539\u6210eth0\u8fd9\u6837\u7684\u540d\u79f0\uff0c\u90a3\u4e48\u6267\u884c\u5982\u4e0b\u64cd\u4f5c\u9700\u8981\uff1a 1.\u4fee\u6539grub2\u542f\u52a8\u53c2\u6570\uff0c\u5728GRUB_CMDLINE_LINUX\u7684\u4e2d\u52a0\u4e0a\"net.ifnames=0 biosdevname=0\"\u7684\u53c2\u6570 vi /etc/sysconfig/grub GRUB_CMDLINE_LINUX=\u201drd.lvm.lv=vg0/swap vconsole.keymap=us crashkernel=auto vconsole.font=latarcyrheb-sun16 net.ifnames=0 biosdevname=0 rd.lvm.lv=vg0/usr rhgb quiet\u201d 2.\u91cd\u65b0\u52a0\u8f7d\u5230\u542f\u52a8\u4e2d grub2-mkconfig -o /boot/grub2/grub.cfg 3.\u91cd\u65b0\u5bf9\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u547d\u540d\uff08\u7f51\u5361\u6587\u4ef6\u5168\u90e8\u91cd\u547d\u540d\uff0c\u987a\u4fbf\u4fee\u6539\u914d\u7f6e\u6587\u4ef6NAME\u3001DEVICE\u7684\u540d\u79f0\uff09 mv /etc/sysconfig/network-scripts/ifcfg-enp0s3 /etc/sysconfig/network-scripts/ifcfg-eth0 4.reboot\u91cd\u542f\u751f\u6548 \u53c2\u8003\u6587\u6863\uff1a - https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Networking_Guide/ch-Consistent_Network_Device_Naming.html - https://bugzilla.redhat.com/show_bug.cgi?id=965718 \u6709\u4ec0\u4e48\u95ee\u9898\u5c3d\u7ba1\u8bf4\uff0c\u53cd\u6b63\u6211\u4e5f\u4e0d\u4f1a\u5e2e\u4f60\u7684 \u8f6c\u81ea: https://blog.csdn.net/maomao5945/article/details/79354204 \u4ececentos7\u5f00\u59cb\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u7f51\u5361\u547d\u540d\u6709\u5df2\u7ecf\u4e0d\u662f\u6211\u4eec\u719f\u6089\u7684ethX\u65b9\u5f0f\u4e86\uff0c\u7ec6\u5fc3\u7684\u540c\u5b66\u4f1a\u7559\u610f\u5230\u4e00\u4e9b\u6bd4\u5982ens enp\u7b49\u5f00\u5934\u7684\u7f51\u5361\u540d\u79f0\uff0c\u7b80\u5355\u4e86\u89e3\uff0c\u53ef\u4ee5\u89e3\u91ca\u4e3acentos7\u5f00\u59cb\uff0c\u7f51\u5361\u547d\u540d\u4f1a\u6839\u636e\u7f51\u5361\u7684\u786c\u4ef6\u4fe1\u606f\uff0c\u63d2\u69fd\u4f4d\u7f6e\u7b49\u6709\u5173\uff1b \u800c\u7f51\u4e0a\u4e5f\u6709\u4e3a\u90a3\u4e9b\u4f9d\u7136\u60f3\u4f7f\u7528ethX\u65b9\u5f0f\u547d\u540d\u7684\u63d0\u4f9b\u4e86\u7b56\u7565\u3002\u6bd4\u5982\u5728\u5185\u6838\u542f\u52a8\u53c2\u6570\u91cc\u589e\u52a0biosdevname=0 net.ifnames=0\uff1b \u4f46\u662f\u8fd9\u91cc\u5ffd\u7565\u4e86 \u4e00\u4e2a\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u4e3a\u4ec0\u4e48centos7\u4e0d\u518d\u4f7f\u7528\u4ee5\u524d\u7684ethX\u65b9\u5f0f\uff1f\u6839\u672c\u662f\u56e0\u4e3a\u4e4b\u524dethX\u65b9\u5f0f\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u6bcf\u6b21\u542f\u52a8\u53ef\u80fd\u90fd\u4e0d\u540c\uff08\u5982\u679c\u6ca1\u6709\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u5361\u540d\u79f0\u7684\u524d\u63d0\u4e0b\uff09\uff1b \u6240\u4ee5\u5927\u5bb6\u63d0\u4f9b\u7684\u8fd9\u79cd\u529e\u6cd5\u5176\u5b9e\u662f\u4e0d\u597d\u7684\uff1b \u89e3\u91ca\u5b8c\u4e0a\u9762\u5185\u5bb9\u4e4b\u540e\uff0c\u54b1\u4eec\u6765\u770b\u4e0b\u5230\u5e95\u7f51\u5361\u540d\u79f0\u662f\u5982\u4f55\u547d\u540d\u7684\u3002 \u6838\u5fc3\u6d41\u7a0b\uff1a\u660e\u786e\u4e00\u70b9\u662f\uff0clinux\u5185\u6838\u542f\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u9ed8\u8ba4\u7ed9\u7f51\u5361\u4ee5ethX\u65b9\u5f0f\u968f\u673a\u547d\u540d\uff0c\u7136\u540e\u518d\u901a\u8fc7systemd\u53bbrename\u6210\u5176\u4ed6\u540d\u79f0\u3002\u5173\u952e\u5b57\uff0crename! \u4e00\u3001\u5982\u4f55rename\uff1f \u00b6 \u9ed8\u8ba4rename\u6d41\u7a0b\uff1a \u00b6 step1 \u4f9d\u636e/usr/lib/udev/rules.d/60-net.rules\uff0c \u67e5\u770b\u662f\u5426\u6709ifcfg-xx\u914d\u7f6e\u6587\u4ef6\uff08\u8def\u5f84\u5728/etc/sysconfig/network-scripts/),\u662f\u5426\u6709\u5b9a\u4e49\u4e86\u6307\u5b9aMAC\u5730\u5740\u7684\u914d\u7f6e\u6587\u4ef6\uff08ifcfg-xx \uff0cxx\u5fc5\u987b\u548c\u914d\u7f6e\u6587\u4ef6\u7684\u5185\u5bb9DEVICE\u4e00\u81f4\uff09\uff0c\u5982\u679c\u6709\uff0c\u5219\u547d\u540d\u6539\u7f51\u5361\uff1b step2 \u4f9d\u636e/usr/lib/udev/rules.d/71-biosdevname.rules\uff0c\u5982\u679cbiosdevname\u4f7f\u80fd\u4e86\uff08\u5b89\u88c5\u4e86biosdevname\u8fd9\u4e2a\u5305\uff0c\u4e14\u5185\u6838\u542f\u52a8\u53c2\u6570\u663e\u5f0f\u8bbe\u7f6e\u4e3a1\uff09\uff0c\u4e14\u7f51\u5361\u6ca1\u6709\u5728step1\u4e2d\u5b9a\u4e49\uff0c\u5219\u6309\u7167biosdevname\u547d\u540d\u89c4\u5219rename\u7f51\u5361\uff1b\uff08\u6ce8\u610f\uff0c\u5982\u679c\u6ca1\u6709\u5b89\u88c5biosdevname\u8fd9\u4e2a\u5305\uff0c\u5c31\u6ca1\u6709\u8fd9\u4e2a\u6587\u4ef6\uff09 step3, \u4f9d\u636e/lib/udev/rules.d/75-net-description.rules\uff0c\u5c06udev\u5de5\u5177\u4f1a\u6839\u636edevice\u5c5e\u6027\u5c06\u586b\u5199\u7f51\u5361\u7684\u5c5e\u6027\u547d\u540d\uff0c\u53ef\u80fd\u4e00\u4e2a\u7f51\u5361\u4f1a\u6709\u591a\u4e2a\u7ef4\u5ea6\u7684\u540d\u79f0\u54e6\uff1b step4\uff0cudev \u6839\u636estep3\u4e2d\u7684\u8d4b\u503c\uff0c\u6309\u7167\u6307\u5b9a\u7684scheme\u89c4\u5219\uff0c\u53bb\u7ed9\u5728step1 step2\u4e2d\u6ca1\u6709\u547d\u540d\u7684\u7f51\u5361\u547d\u540d\uff1b \u5f3a\u8c03\uff1a\u8fd9\u4e2astep\u987a\u5e8f\u662f\u5728\u6211\u4eec\u6ca1\u6709\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684rules\u7684\u524d\u63d0\u4e0b\uff0c\u5982\u679c\u7528\u6237\u81ea\u5b9a\u4e49\u4e86\u81ea\u5df1\u7684rules\uff0c\u5219\u7528\u6237\u81ea\u5b9a\u4e49\u4e3a\u4f18\u5148\u7ea7\u6700\u9ad8\uff1b \u4e8c\u3001scheme\u6b21\u5e8f \u00b6 \u4e0a\u9762step4\u4e2d\u63d0\u5230\uff0c\u6309\u7167\u6307\u5b9a\u7684scheme\u89c4\u5219\uff0c\u8fd9\u4e2a\u89c4\u5219\u662f\u4ec0\u4e48\u5462\uff1f \u00b6 \u9996\u5148\u8bf4step3\u4e2d\uff0c\u63d0\u5230\u6309\u7167\u7f51\u5361\u7684\u4e0d\u540c\u5c5e\u6027\u547d\u540d\uff0c\u7cfb\u7edf\u8bc6\u522b\u7f51\u5361\u6709\u597d\u51e0\u79cd\u7ef4\u5ea6\uff1a \u6bd4\u5982 BIOS provided index numbers for on-board devices (example: eno1), \u6bd4\u5982\uff1aBIOS provided PCI Express hotplug slot index numbers (example: ens1) \u6bd4\u5982\uff1aphysical location of the connector of the hardware (example: enp2s0), \u6bd4\u5982\uff1amac\u5730\u5740 \u540c\u4e00\u4e2a\u7f51\u5361\u901a\u5e38\u540c\u65f6\u5177\u6709\u591a\u4e2a\u7ef4\u5ea6\u7684\u540d\u79f0\uff0csystemd\u5728\u9009\u53d6\u7684\u65f6\u5019\uff0c\u6309\u7167\u6709\u5148\u540e\u6b21\u5e8f\uff0c\u4f7f\u7528\u5148\u547d\u4e2d\u7684\uff1b \u987a\u5e8f\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\uff08eno1-ens1-enp1\uff09 eth2\u8fd9\u4e2a\u7f51\u5361\uff0cscheme\u540d\u79f0\u67093\u4e2a\uff0c\u5982\u679csystemd\u81ea\u9009\uff0c\u4f1a\u4f7f\u7528\u54ea\u4e2a\uff1fens5f0.(\u90a3\u8fd9\u4e2a\u4e3a\u4ec0\u4e48\u662f/sys/class/net/eth2 \u800c\u4e0d\u662f/sys/class/net/ens5f0 \uff0c\u90a3\u662f\u56e0\u4e3a\u81ea\u5b9a\u4e49\u7684\u7f18\u6545\uff1b) \u4e09\u3001\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u5361\u540d\u79f0 \u00b6 1\u3001\u5728\u7528\u6237\u6ca1\u6709\u81ea\u5b9a\u4e49rules\u6587\u4ef6\u524d\u63d0\u4e0b\uff0cstep1\u4e2d\u7684\u7f51\u5361\u547d\u540d\u65b9\u5f0f\u4e5f\u53ef\u8ba4\u4e3a\u662f \u4e00\u79cd\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u7f51\u5361\u547d\u540d\uff0c\u5373\u5728/etc/sysconfig/network-scripts/ifcfg-xx \u6587\u4ef6\uff0cxx\u5c31\u662f\u8fd9\u4e2a\u7f51\u5361\u540d\u79f0\uff0c\u6587\u4ef6\u5185\u5bb9\u4e2d\u4f53\u73b0MAC_ADDRESS\u3001NAME\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5219\u4f1a\u6309\u7167\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u540d\u79f0\u6765\u547d\u540d\u7f51\u5361\uff1b 2\u3001\u5982\u679c\u7528\u6237\u81ea\u5b9a\u4e49\u4e86rules\u6587\u4ef6\uff0c\u653e\u5728/etc/udev/rules.d/\u76ee\u5f55\u4e0b\uff0c\u5219\u8fd9\u4e2a\u4f18\u5148\u7ea7\u662f\u6700\u9ad8\u7684\uff1b\u6bd41\u4e2difcfg-xx\u65b9\u5f0f\u4f18\u5148\u7ea7\u66f4\u9ad8\uff0c\u4f46\u662f\u5982\u679c\u4e24\u8005\u4e0d\u4e00\u81f4\uff0c\u5219\u5728\u91cd\u542fnetwork\u670d\u52a1\u65f6\uff0c\u4f1a\u4f9d\u636eifcfg-xx\uff0c\u6240\u4ee5\u7528\u6237\u4e0d\u5e94\u8be5\u540c\u65f6\u91c7\u7528\u91cc\u4e24\u79cd\u65b9\u5f0f\u7ed9\u540c\u4e00\u4e2a\u7f51\u5361\u547d\u4e0d\u540c\u7684\u540d\u79f0\uff1b \u56db\u3001\u5185\u6838\u542f\u52a8\u53c2\u6570biosdevnane\u3001net.ifnames \u00b6 \u9ed8\u8ba4\u5c31\u662f\u5185\u6838\u542f\u52a8\u53c2\u6570\u6ca1\u6709biosdevname \u4e5f\u6ca1\u6709net.ifnames \u53c2\u6570\uff08\u5176\u5b9e\u9ed8\u8ba4\u662fnet.ifnames=1,biosdevname=0\uff09\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5c31\u6309\u7167\u4e00 \u4e2d\u8fdb\u884c\u7f51\u5361\u547d\u540d\uff1beno-ens-enp\u7684\u65b9\u5f0f\u9010\u4e2a\u5339\u914d\u3002\u4f46\u662f\u5982\u679c\u4f7f\u80fd\u4e86biosdevname.\u5219\u4f1a\u4f7f\u7528biosdevname\u7684\u547d\u540d step1\u6ca1\u6709\u547d\u540d\u7684\u7f51\u5361\uff1b bios\u547d\u540d\u89c4\u5219\uff1a \u00b6 \u8981\u4e48\u662fem\u5f00\u5934\uff0c\u8981\u4e48\u662fp\u5f00\u5934\uff1b \u600e\u4e48\u6837\u4f7f\u80fdbiosdevname\u5462\uff1f2\u4e2a\u6761\u4ef6\uff0c\u5b89\u88c5biosdevname\u5305\uff0c\u4e14\u5728\u5185\u6838\u542f\u52a8\u53c2\u6570\u4e2d\u660e\u786e biosdevname=1. \u5426\u5219\u4f7f\u80fd\u4e0d\u4e86\uff1b \u4f46\u662f\u4e0d\u7ba1\u600e\u4e48\u6837\uff0c\u5982\u679c\u7528\u6237\u81ea\u5b9a\u4e49\u4e86udev rules\uff0c\u5219\u7528\u6237\u81ea\u5b9a\u4e49\u7684rules\u4f18\u5148\uff01 \u8fd9\u662f\u603b\u8ff0\uff0c\u4f46\u51e1\u7528\u6237\u81ea\u5b9a\u4e49rules\uff0c\u4f18\u5148\u7ea7\u6700\u9ad8\uff1b \u5185\u6838\u542f\u52a8\u53c2\u6570net.ifname, \u00b6 \u5982\u679c\u5728\u542f\u52a8\u53c2\u6570\u4e2d\u589e\u52a0net.ifname=0\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5728/lib/udev/rule.d/80-net-name-slot.rules\u4f53\u73b0\u4f7f\u7528\u4ef7\u503c\uff0c\u5219\u544a\u8bc9\u7cfb\u7edf\u4e0d\u7528scheme\u7684\u65b9\u5f0f\u6765\u547d\u540d\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u4f1a\u6062\u590dethx\u8fd9\u79cd\u4e0d\u786e\u5b9a\u6027\u7684\u547d\u540d\u65b9\u5f0f\uff1b \u4e94\u3001 \u4e0d\u8981\u7528ethX\u53bb\u547d\u540d \u00b6 \u5185\u6838\u5728boot \u8fc7\u7a0b\u662f\u9ed8\u8ba4\u4f7f\u7528ethX\u65b9\u5f0f\u6765\u547d\u540d\u7684\uff0c\u6bcf\u6b21\u542f\u52a8\u7684\u65f6\u5019\u90fd\u4e0d\u786e\u5b9a\uff0c\u542f\u52a8\u4f1a\u540e\u518d\u901a\u8fc7udev\u7b49\u65b9\u5f0f\u53bbrename, \u53c2\u8003\u6587\u6863\uff1a https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/sec-troubleshooting_network_device_naming","title":"centos-network-device-naming"},{"location":"centos-network-device-naming/#centos7","text":"\u4e00\u81f4\u6027\u7f51\u7edc\u8bbe\u5907\u547d\u540d(Consistent Network Device Naming) \u80cc\u666f\u4ecb\u7ecd\uff1a \u5728centos5\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4e60\u60ef\u4e86eth0\u8fd9\u6837\u7684\u7f51\u7edc\u8bbe\u5907\u547d\u540d\uff0c\u5728centos6\u53d1\u73b0\u7f51\u7edc\u8bbe\u5907\u53d8\u6210\u4e86em1\u8fd9\u6837\u7684\u547d\u540d\u3002 \u90a3\u65f6\u6211\u4eec\u5728\u5b89\u88c5\u7684\u65f6\u5019\uff0c\u7ed9\u542f\u52a8\u53c2\u6570\u52a0\u4e0a biosdevname=0\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528eth0\u8fd9\u6837\u7684\u547d\u540d\u3002 \u5347\u7ea7\u5230centos7\u540e\uff0c\u53d1\u73b0\u539f\u6709\u7684\u53c2\u6570biosdevname=0\u4e0d\u8d77\u4f5c\u7528\u4e86\uff0c\u7f51\u7edc\u8bbe\u5907\u53d8\u6210\u4e86eno1\u8fd9\u6837\u7684\u540d\u79f0\u3002 centos7\u8fd9\u79cd\u53d8\u5316\u7684\u539f\u56e0\u662f\u7531\u4e8esystemd\u548cudev\u5f15\u5165\u4e86\u4e00\u79cd\u65b0\u7684\u7f51\u7edc\u8bbe\u5907\u547d\u540d\u65b9\u5f0f\uff1a\u4e00\u81f4\u7f51\u7edc\u8bbe\u5907\u547d\u540d\uff08CONSISTENT NETWORK DEVICE NAMING\uff09\u3002","title":"centos7\u4e2d\u7684\u7f51\u5361\u4e00\u81f4\u6027\u547d\u540d\u89c4\u5219\u3001\u7f51\u5361\u91cd\u547d\u540d\u65b9\u6cd5"},{"location":"centos-network-device-naming/#_1","text":"\u670d\u52a1\u5668\u901a\u5e38\u6709\u591a\u5757\u7f51\u5361\uff0c\u6709\u677f\u8f7d\u96c6\u6210\u7684\uff0c\u540c\u65f6\u4e5f\u6709\u63d2\u5728PCIe\u63d2\u69fd\u7684\u3002 Linux\u7cfb\u7edf\u7684\u547d\u540d\u539f\u6765\u662feth0,eth1\u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u4f46\u662f\u8fd9\u4e2a\u7f16\u53f7\u5f80\u5f80\u4e0d\u4e00\u5b9a\u51c6\u786e\u5bf9\u5e94\u7f51\u5361\u63a5\u53e3\u7684\u7269\u7406\u987a\u5e8f\u3002 \u4e3a\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898,dell\u5f00\u53d1\u4e86biosdevname\u65b9\u6848(systemd v197\u7248\u672c\u4e2d\u5c06dell\u7684\u65b9\u6848\u4f5c\u4e86\u8fdb\u4e00\u6b65\u7684\u4e00\u822c\u5316\u62d3\u5c55)\u3002 \u76ee\u524d\u7684Centos\u65e2\u652f\u6301dell\u7684biosdevname\uff0c\u4e5f\u652f\u6301systemd\u7684\u65b9\u6848\u3002","title":"\u4e00\u3001\u4e3a\u4ec0\u4e48\u9700\u8981\u8fd9\u4e2a"},{"location":"centos-network-device-naming/#centos7_1","text":"Scheme 1: \u5982\u679c\u4eceBIOS\u4e2d\u80fd\u591f\u53d6\u5230\u53ef\u7528\u7684\uff0c\u677f\u8f7d\u7f51\u5361\u7684\u7d22\u5f15\u53f7\uff0c\u5219\u4f7f\u7528\u8fd9\u4e2a\u7d22\u5f15\u53f7\u547d\u540d\uff0c\u4f8b\u5982: eno1\uff0c\u5982\u4e0d\u80fd\u5219\u5c1d\u8bd5Scheme 2 Scheme 2: \u5982\u679c\u4eceBIOS\u4e2d\u80fd\u591f\u53d6\u5230\u53ef\u4ee5\u7528\u7684\uff0c\u7f51\u5361\u6240\u5728\u7684PCI-E\u70ed\u63d2\u62d4\u63d2\u69fd\u7684\u7d22\u5f15\u53f7\uff0c\u5219\u4f7f\u7528\u8fd9\u4e2a\u7d22\u5f15\u53f7\u547d\u540d\uff0c\u4f8b\u5982: ens1\uff0c\u5982\u4e0d\u80fd\u5219\u5c1d\u8bd5Scheme 3 Scheme 3: \u5982\u679c\u80fd\u62ff\u5230\u8bbe\u5907\u6240\u8fde\u63a5\u7684\u7269\u7406\u4f4d\u7f6e\u4fe1\u606f\uff0c\u5219\u4f7f\u7528\u8fd9\u4e2a\u4fe1\u606f\u547d\u540d\uff0c\u4f8b\u5982:enp2s0\uff0c\u5982\u4e0d\u80fd\u5219\u5c1d\u8bd5Scheme 5 Scheme 4: \u4f7f\u7528\u7f51\u5361\u7684MAC\u5730\u5740\u6765\u547d\u540d\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e00\u822c\u4e0d\u4f7f\u7528\u3002 Scheme 5\uff1a\u4f20\u7edf\u7684kernel\u547d\u540d\u65b9\u6cd5\uff0c\u4f8b\u5982: eth0\uff0c\u8fd9\u79cd\u547d\u540d\u65b9\u6cd5\u7684\u7ed3\u679c\u4e0d\u53ef\u9884\u77e5\u7684\uff0c\u5373\u53ef\u80fd\u7b2c\u4e8c\u5757\u7f51\u5361\u5bf9\u5e94eth0\uff0c\u7b2c\u4e00\u5757\u7f51\u5361\u5bf9\u5e94eth1\u3002","title":"\u4e8c\u3001Centos7\u4e2d\u7684\u547d\u540d\u7b56\u7565"},{"location":"centos-network-device-naming/#biosdevnamenetifnames","text":"net.ifnames\u547d\u540d\u89c4\u8303\u4e3a:\u8bbe\u5907\u7c7b\u578b+\u8bbe\u5907\u4f4d\u7f6e+\u6570\u5b57 \u8bbe\u5907\u7c7b\u578b\uff1a - en \u8868\u793aEthernet - wl \u8868\u793aWLAN - ww \u8868\u793a\u65e0\u7ebf\u5e7f\u57df\u7f51WWAN \u5b9e\u9645\u7684\u4f8b\u5b50: - eno1 \u677f\u8f7d\u7f51\u5361 - enp0s2 pci\u7f51\u5361 - ens33 pci\u7f51\u5361 - wlp3s0 PCI\u65e0\u7ebf\u7f51\u5361 - wwp0s29f7u2i2 4G modem - wlp0s2f1u4u1 \u8fde\u63a5\u5728USB Hub\u4e0a\u7684\u65e0\u7ebf\u7f51\u5361 - enx78e7d1ea46da pci\u7f51\u5361 biosdevname\u7684\u547d\u540d\u89c4\u8303\u4e3a: \u5b9e\u9645\u7684\u4f8b\u5b50: - em1 \u677f\u8f7d\u7f51\u5361 - p3p4 pci\u7f51\u5361 - p3p4_1 \u865a\u62df\u7f51\u5361","title":"\u4e09\u3001biosdevname\u548cnet.ifnames\u4e24\u79cd\u547d\u540d\u89c4\u8303"},{"location":"centos-network-device-naming/#systemd","text":"\u6309\u7167\u5982\u4e0b\u987a\u5e8f\u6267\u884cudev\u7684rule /usr/lib/udev/rules.d/60-net.rules /usr/lib/udev/rules.d/71-biosdevname.rules /lib/udev/rules.d/75-net-description.rules /usr/lib/udev/rules.d/80-net-name-slot.rules 60-net.rules \u4f7f\u7528/lib/udev/rename_device\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u53bb\u67e5\u8be2/etc/sysconfig/network-scripts/\u4e0b\u6240\u6709\u4ee5ifcfg-\u5f00\u5934\u7684\u6587\u4ef6 \u5982\u679c\u5728ifcfg-xx\u4e2d\u5339\u914d\u5230HWADDR=xx:xx:xx:xx:xx:xx\u53c2\u6570\u7684\u7f51\u5361\u63a5\u53e3 \u5219\u9009\u53d6DEVICE=yyyy\u4e2d\u8bbe\u7f6e\u7684\u540d\u5b57\u4f5c\u4e3a\u7f51\u5361\u540d\u79f0\u3002 71-biosdevname.rules \u5982\u679c\u7cfb\u7edf\u4e2d\u5b89\u88c5\u4e86biosdevname\uff0c\u4e14\u5185\u6838\u53c2\u6570\u672a\u6307\u5b9abiosdevname=0\uff0c\u4e14\u4e0a\u4e00\u6b65\u6ca1\u6709\u91cd\u547d\u540d\u7f51\u5361\uff0c\u5219\u6309\u7167biosdevname\u7684\u547d\u540d\u89c4\u8303\uff0c\u4eceBIOS\u4e2d\u53d6\u76f8\u5173\u4fe1\u606f\u6765\u547d\u540d\u7f51\u5361\u3002 \u4e3b\u8981\u662f\u53d6SMBIOS\u4e2d\u7684type 9 (System Slot) \u548c type 41 (Onboard Devices Extended Information) \u4e0d\u8fc7\u8981\u6c42SMBIOS\u7684\u7248\u672c\u8981\u9ad8\u4e8e2.6\uff0c\u4e14\u7cfb\u7edf\u4e2d\u8981\u5b89\u88c5biosdevname\u7a0b\u5e8f\u3002 75-net-description.rules udev\u901a\u8fc7\u68c0\u67e5\u7f51\u5361\u4fe1\u606f\uff0c\u586b\u5199\u5982\u4e0b\u8fd9\u4e9budev\u7684\u5c5e\u6027\u503c ID_NET_NAME_ONBOARD ID_NET_NAME_SLOT ID_NET_NAME_PATH ID_NET_NAME_MAC 80-net-name-slot.rules \u5982\u679c\u572860-net.rules \uff0c71-biosdevname.rules\u8fd9\u4e24\u6761\u89c4\u5219\u4e2d\u6ca1\u6709\u91cd\u547d\u540d\u7f51\u5361\uff0c\u4e14\u5185\u6838\u672a\u6307\u5b9anet.ifnames=0\u53c2\u6570 \u5219udev\u4f9d\u6b21\u5c1d\u8bd5\u4f7f\u7528\u4ee5\u4e0b\u5c5e\u6027\u503c\u6765\u547d\u540d\u7f51\u5361\uff0c\u5982\u679c\u8fd9\u4e9b\u5c5e\u6027\u503c\u90fd\u6ca1\u6709\uff0c\u5219\u7f51\u5361\u4e0d\u4f1a\u88ab\u91cd\u547d\u540d\u3002 ID_NET_NAME_ONBOARD ID_NET_NAME_SLOT ID_NET_NAME_PATH \u4e0a\u8fb9\u768471-biosdevname.rules \u662f\u5b9e\u9645\u6267\u884cbiosdevname\u7684policy 75-net-description.rules\u548c80-net-name-slot.rules\u5b9e\u9645\u6267\u884cScheme 1,2,3 \u6839\u636e\u4e0a\u8ff0\u7684\u8fc7\u7a0b\uff0c\u53ef\u89c1\u7f51\u5361\u547d\u540d\u53d7 biosdevname\u548cnet.ifnames\u8fd9\u4e24\u4e2a\u5185\u6838\u53c2\u6570\u5f71\u54cd\u3002","title":"\u56db\u3001systemd\u4e2d\u7684\u5b9e\u9645\u6267\u884c\u987a\u5e8f"},{"location":"centos-network-device-naming/#biosdevnamenetifnames_1","text":"\u8fd9\u4e24\u4e2a\u53c2\u6570\u90fd\u53ef\u4ee5\u5728grub\u914d\u7f6e\u4e2d\u63d0\u4f9b\uff0cbiosdevname=0\u662f\u7cfb\u7edf\u9ed8\u8ba4\u503c\uff08dell\u670d\u52a1\u5668\u9ed8\u8ba4\u662f1\uff09\uff0cnet.ifnames=1\u662f\u7cfb\u7edf\u9ed8\u8ba4\u503c\u3002 #vi /boot/grub/grub.conf kernel /boot/vmlinuz biosdevname=1 initrd /boot/initrd.img \u7b2c\u4e8c\u8282\u6240\u8bf4\u7684Scheme\u7684\u7b56\u7565\u987a\u5e8f\u662f\u7cfb\u7edf\u9ed8\u8ba4\u7684\u3002 \u5982\u7cfb\u7edfBIOS\u7b26\u5408\u8981\u6c42\uff0c\u4e14\u7cfb\u7edf\u4e2d\u5b89\u88c5\u4e86biosdevname\uff0c\u4e14biosdevname=1\u542f\u7528\uff0c\u5219biosdevname\u4f18\u5148\uff1b \u5982\u679cBIOS\u4e0d\u7b26\u5408biosdevname\u8981\u6c42\u6216biosdevname=0\uff0c\u5219\u4ecd\u7136\u662fsystemd\u7684\u89c4\u5219\u4f18\u5148\u3002 \u5982\u679c\u7528\u6237\u81ea\u5df1\u5b9a\u4e49\u4e86udev rule\u6765\u4fee\u6539\u5185\u6838\u8bbe\u5907\u540d\u5b57\uff0c\u5219\u7528\u6237\u89c4\u5219\u4f18\u5148\u3002 \u5185\u6838\u53c2\u6570\u7ec4\u5408\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u5176\u7ed3\u679c\u5982\u4e0b\uff1a \u9ed8\u8ba4\u5185\u6838\u53c2\u6570(biosdevname=0\uff0cnet.ifnames=1): \u7f51\u5361\u540d \"enp5s2\" biosdevname=1\uff0cnet.ifnames=0\uff1a\u7f51\u5361\u540d \"em1\" biosdevname=0\uff0cnet.ifnames=0\uff1a\u7f51\u5361\u540d \"eth0\" (\u6700\u4f20\u7edf\u7684\u65b9\u5f0f,eth0 eth1 \u50bb\u50bb\u5206\u4e0d\u6e05)","title":"\u4e94\u3001biosdevname/net.ifnames\u5e94\u7528"},{"location":"centos-network-device-naming/#centos7ethx","text":"\u5982\u679c\u4f60\u5e0c\u671b\u7ee7\u7eed\u4f7f\u7528 eth0 \u8fd9\u6837\u7684\u4f20\u7edf\u540d\u79f0\uff0c\u90a3\u4e48\u5728\u5b89\u88c5\u542f\u52a8\uff08pxe\uff09\u65f6\u52a0\u4e0a\u53c2\u6570\uff1a net.ifnames=0 biosdevname=0 cobbler profile \u4fee\u6539\u65b9\u6cd5\uff1a cobbler profile edit --name=Centos-7.3-x86_64 --kopts='net.ifnames=0 biosdevname=0' \u5982\u679c\u4f60\u5df2\u7ecf\u5b89\u88c5\u5b8c\u4e86\uff0c\u5e0c\u671b\u6539\u6210eth0\u8fd9\u6837\u7684\u540d\u79f0\uff0c\u90a3\u4e48\u6267\u884c\u5982\u4e0b\u64cd\u4f5c\u9700\u8981\uff1a 1.\u4fee\u6539grub2\u542f\u52a8\u53c2\u6570\uff0c\u5728GRUB_CMDLINE_LINUX\u7684\u4e2d\u52a0\u4e0a\"net.ifnames=0 biosdevname=0\"\u7684\u53c2\u6570 vi /etc/sysconfig/grub GRUB_CMDLINE_LINUX=\u201drd.lvm.lv=vg0/swap vconsole.keymap=us crashkernel=auto vconsole.font=latarcyrheb-sun16 net.ifnames=0 biosdevname=0 rd.lvm.lv=vg0/usr rhgb quiet\u201d 2.\u91cd\u65b0\u52a0\u8f7d\u5230\u542f\u52a8\u4e2d grub2-mkconfig -o /boot/grub2/grub.cfg 3.\u91cd\u65b0\u5bf9\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u547d\u540d\uff08\u7f51\u5361\u6587\u4ef6\u5168\u90e8\u91cd\u547d\u540d\uff0c\u987a\u4fbf\u4fee\u6539\u914d\u7f6e\u6587\u4ef6NAME\u3001DEVICE\u7684\u540d\u79f0\uff09 mv /etc/sysconfig/network-scripts/ifcfg-enp0s3 /etc/sysconfig/network-scripts/ifcfg-eth0 4.reboot\u91cd\u542f\u751f\u6548 \u53c2\u8003\u6587\u6863\uff1a - https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Networking_Guide/ch-Consistent_Network_Device_Naming.html - https://bugzilla.redhat.com/show_bug.cgi?id=965718 \u6709\u4ec0\u4e48\u95ee\u9898\u5c3d\u7ba1\u8bf4\uff0c\u53cd\u6b63\u6211\u4e5f\u4e0d\u4f1a\u5e2e\u4f60\u7684 \u8f6c\u81ea: https://blog.csdn.net/maomao5945/article/details/79354204 \u4ececentos7\u5f00\u59cb\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u7684\u7f51\u5361\u547d\u540d\u6709\u5df2\u7ecf\u4e0d\u662f\u6211\u4eec\u719f\u6089\u7684ethX\u65b9\u5f0f\u4e86\uff0c\u7ec6\u5fc3\u7684\u540c\u5b66\u4f1a\u7559\u610f\u5230\u4e00\u4e9b\u6bd4\u5982ens enp\u7b49\u5f00\u5934\u7684\u7f51\u5361\u540d\u79f0\uff0c\u7b80\u5355\u4e86\u89e3\uff0c\u53ef\u4ee5\u89e3\u91ca\u4e3acentos7\u5f00\u59cb\uff0c\u7f51\u5361\u547d\u540d\u4f1a\u6839\u636e\u7f51\u5361\u7684\u786c\u4ef6\u4fe1\u606f\uff0c\u63d2\u69fd\u4f4d\u7f6e\u7b49\u6709\u5173\uff1b \u800c\u7f51\u4e0a\u4e5f\u6709\u4e3a\u90a3\u4e9b\u4f9d\u7136\u60f3\u4f7f\u7528ethX\u65b9\u5f0f\u547d\u540d\u7684\u63d0\u4f9b\u4e86\u7b56\u7565\u3002\u6bd4\u5982\u5728\u5185\u6838\u542f\u52a8\u53c2\u6570\u91cc\u589e\u52a0biosdevname=0 net.ifnames=0\uff1b \u4f46\u662f\u8fd9\u91cc\u5ffd\u7565\u4e86 \u4e00\u4e2a\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u4e3a\u4ec0\u4e48centos7\u4e0d\u518d\u4f7f\u7528\u4ee5\u524d\u7684ethX\u65b9\u5f0f\uff1f\u6839\u672c\u662f\u56e0\u4e3a\u4e4b\u524dethX\u65b9\u5f0f\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u6bcf\u6b21\u542f\u52a8\u53ef\u80fd\u90fd\u4e0d\u540c\uff08\u5982\u679c\u6ca1\u6709\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u5361\u540d\u79f0\u7684\u524d\u63d0\u4e0b\uff09\uff1b \u6240\u4ee5\u5927\u5bb6\u63d0\u4f9b\u7684\u8fd9\u79cd\u529e\u6cd5\u5176\u5b9e\u662f\u4e0d\u597d\u7684\uff1b \u89e3\u91ca\u5b8c\u4e0a\u9762\u5185\u5bb9\u4e4b\u540e\uff0c\u54b1\u4eec\u6765\u770b\u4e0b\u5230\u5e95\u7f51\u5361\u540d\u79f0\u662f\u5982\u4f55\u547d\u540d\u7684\u3002 \u6838\u5fc3\u6d41\u7a0b\uff1a\u660e\u786e\u4e00\u70b9\u662f\uff0clinux\u5185\u6838\u542f\u52a8\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u9ed8\u8ba4\u7ed9\u7f51\u5361\u4ee5ethX\u65b9\u5f0f\u968f\u673a\u547d\u540d\uff0c\u7136\u540e\u518d\u901a\u8fc7systemd\u53bbrename\u6210\u5176\u4ed6\u540d\u79f0\u3002\u5173\u952e\u5b57\uff0crename!","title":"\u516d\u3001centos7\u7f51\u5361\u91cd\u547d\u540d\u4e3aethx\u683c\u5f0f"},{"location":"centos-network-device-naming/#rename","text":"","title":"\u4e00\u3001\u5982\u4f55rename\uff1f"},{"location":"centos-network-device-naming/#rename_1","text":"step1 \u4f9d\u636e/usr/lib/udev/rules.d/60-net.rules\uff0c \u67e5\u770b\u662f\u5426\u6709ifcfg-xx\u914d\u7f6e\u6587\u4ef6\uff08\u8def\u5f84\u5728/etc/sysconfig/network-scripts/),\u662f\u5426\u6709\u5b9a\u4e49\u4e86\u6307\u5b9aMAC\u5730\u5740\u7684\u914d\u7f6e\u6587\u4ef6\uff08ifcfg-xx \uff0cxx\u5fc5\u987b\u548c\u914d\u7f6e\u6587\u4ef6\u7684\u5185\u5bb9DEVICE\u4e00\u81f4\uff09\uff0c\u5982\u679c\u6709\uff0c\u5219\u547d\u540d\u6539\u7f51\u5361\uff1b step2 \u4f9d\u636e/usr/lib/udev/rules.d/71-biosdevname.rules\uff0c\u5982\u679cbiosdevname\u4f7f\u80fd\u4e86\uff08\u5b89\u88c5\u4e86biosdevname\u8fd9\u4e2a\u5305\uff0c\u4e14\u5185\u6838\u542f\u52a8\u53c2\u6570\u663e\u5f0f\u8bbe\u7f6e\u4e3a1\uff09\uff0c\u4e14\u7f51\u5361\u6ca1\u6709\u5728step1\u4e2d\u5b9a\u4e49\uff0c\u5219\u6309\u7167biosdevname\u547d\u540d\u89c4\u5219rename\u7f51\u5361\uff1b\uff08\u6ce8\u610f\uff0c\u5982\u679c\u6ca1\u6709\u5b89\u88c5biosdevname\u8fd9\u4e2a\u5305\uff0c\u5c31\u6ca1\u6709\u8fd9\u4e2a\u6587\u4ef6\uff09 step3, \u4f9d\u636e/lib/udev/rules.d/75-net-description.rules\uff0c\u5c06udev\u5de5\u5177\u4f1a\u6839\u636edevice\u5c5e\u6027\u5c06\u586b\u5199\u7f51\u5361\u7684\u5c5e\u6027\u547d\u540d\uff0c\u53ef\u80fd\u4e00\u4e2a\u7f51\u5361\u4f1a\u6709\u591a\u4e2a\u7ef4\u5ea6\u7684\u540d\u79f0\u54e6\uff1b step4\uff0cudev \u6839\u636estep3\u4e2d\u7684\u8d4b\u503c\uff0c\u6309\u7167\u6307\u5b9a\u7684scheme\u89c4\u5219\uff0c\u53bb\u7ed9\u5728step1 step2\u4e2d\u6ca1\u6709\u547d\u540d\u7684\u7f51\u5361\u547d\u540d\uff1b \u5f3a\u8c03\uff1a\u8fd9\u4e2astep\u987a\u5e8f\u662f\u5728\u6211\u4eec\u6ca1\u6709\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684rules\u7684\u524d\u63d0\u4e0b\uff0c\u5982\u679c\u7528\u6237\u81ea\u5b9a\u4e49\u4e86\u81ea\u5df1\u7684rules\uff0c\u5219\u7528\u6237\u81ea\u5b9a\u4e49\u4e3a\u4f18\u5148\u7ea7\u6700\u9ad8\uff1b","title":"\u9ed8\u8ba4rename\u6d41\u7a0b\uff1a"},{"location":"centos-network-device-naming/#scheme","text":"","title":"\u4e8c\u3001scheme\u6b21\u5e8f"},{"location":"centos-network-device-naming/#step4scheme","text":"\u9996\u5148\u8bf4step3\u4e2d\uff0c\u63d0\u5230\u6309\u7167\u7f51\u5361\u7684\u4e0d\u540c\u5c5e\u6027\u547d\u540d\uff0c\u7cfb\u7edf\u8bc6\u522b\u7f51\u5361\u6709\u597d\u51e0\u79cd\u7ef4\u5ea6\uff1a \u6bd4\u5982 BIOS provided index numbers for on-board devices (example: eno1), \u6bd4\u5982\uff1aBIOS provided PCI Express hotplug slot index numbers (example: ens1) \u6bd4\u5982\uff1aphysical location of the connector of the hardware (example: enp2s0), \u6bd4\u5982\uff1amac\u5730\u5740 \u540c\u4e00\u4e2a\u7f51\u5361\u901a\u5e38\u540c\u65f6\u5177\u6709\u591a\u4e2a\u7ef4\u5ea6\u7684\u540d\u79f0\uff0csystemd\u5728\u9009\u53d6\u7684\u65f6\u5019\uff0c\u6309\u7167\u6709\u5148\u540e\u6b21\u5e8f\uff0c\u4f7f\u7528\u5148\u547d\u4e2d\u7684\uff1b \u987a\u5e8f\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\uff08eno1-ens1-enp1\uff09 eth2\u8fd9\u4e2a\u7f51\u5361\uff0cscheme\u540d\u79f0\u67093\u4e2a\uff0c\u5982\u679csystemd\u81ea\u9009\uff0c\u4f1a\u4f7f\u7528\u54ea\u4e2a\uff1fens5f0.(\u90a3\u8fd9\u4e2a\u4e3a\u4ec0\u4e48\u662f/sys/class/net/eth2 \u800c\u4e0d\u662f/sys/class/net/ens5f0 \uff0c\u90a3\u662f\u56e0\u4e3a\u81ea\u5b9a\u4e49\u7684\u7f18\u6545\uff1b)","title":"\u4e0a\u9762step4\u4e2d\u63d0\u5230\uff0c\u6309\u7167\u6307\u5b9a\u7684scheme\u89c4\u5219\uff0c\u8fd9\u4e2a\u89c4\u5219\u662f\u4ec0\u4e48\u5462\uff1f"},{"location":"centos-network-device-naming/#_2","text":"1\u3001\u5728\u7528\u6237\u6ca1\u6709\u81ea\u5b9a\u4e49rules\u6587\u4ef6\u524d\u63d0\u4e0b\uff0cstep1\u4e2d\u7684\u7f51\u5361\u547d\u540d\u65b9\u5f0f\u4e5f\u53ef\u8ba4\u4e3a\u662f \u4e00\u79cd\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u7f51\u5361\u547d\u540d\uff0c\u5373\u5728/etc/sysconfig/network-scripts/ifcfg-xx \u6587\u4ef6\uff0cxx\u5c31\u662f\u8fd9\u4e2a\u7f51\u5361\u540d\u79f0\uff0c\u6587\u4ef6\u5185\u5bb9\u4e2d\u4f53\u73b0MAC_ADDRESS\u3001NAME\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5219\u4f1a\u6309\u7167\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u540d\u79f0\u6765\u547d\u540d\u7f51\u5361\uff1b 2\u3001\u5982\u679c\u7528\u6237\u81ea\u5b9a\u4e49\u4e86rules\u6587\u4ef6\uff0c\u653e\u5728/etc/udev/rules.d/\u76ee\u5f55\u4e0b\uff0c\u5219\u8fd9\u4e2a\u4f18\u5148\u7ea7\u662f\u6700\u9ad8\u7684\uff1b\u6bd41\u4e2difcfg-xx\u65b9\u5f0f\u4f18\u5148\u7ea7\u66f4\u9ad8\uff0c\u4f46\u662f\u5982\u679c\u4e24\u8005\u4e0d\u4e00\u81f4\uff0c\u5219\u5728\u91cd\u542fnetwork\u670d\u52a1\u65f6\uff0c\u4f1a\u4f9d\u636eifcfg-xx\uff0c\u6240\u4ee5\u7528\u6237\u4e0d\u5e94\u8be5\u540c\u65f6\u91c7\u7528\u91cc\u4e24\u79cd\u65b9\u5f0f\u7ed9\u540c\u4e00\u4e2a\u7f51\u5361\u547d\u4e0d\u540c\u7684\u540d\u79f0\uff1b","title":"\u4e09\u3001\u7528\u6237\u81ea\u5b9a\u4e49\u7f51\u5361\u540d\u79f0"},{"location":"centos-network-device-naming/#biosdevnanenetifnames","text":"\u9ed8\u8ba4\u5c31\u662f\u5185\u6838\u542f\u52a8\u53c2\u6570\u6ca1\u6709biosdevname \u4e5f\u6ca1\u6709net.ifnames \u53c2\u6570\uff08\u5176\u5b9e\u9ed8\u8ba4\u662fnet.ifnames=1,biosdevname=0\uff09\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5c31\u6309\u7167\u4e00 \u4e2d\u8fdb\u884c\u7f51\u5361\u547d\u540d\uff1beno-ens-enp\u7684\u65b9\u5f0f\u9010\u4e2a\u5339\u914d\u3002\u4f46\u662f\u5982\u679c\u4f7f\u80fd\u4e86biosdevname.\u5219\u4f1a\u4f7f\u7528biosdevname\u7684\u547d\u540d step1\u6ca1\u6709\u547d\u540d\u7684\u7f51\u5361\uff1b","title":"\u56db\u3001\u5185\u6838\u542f\u52a8\u53c2\u6570biosdevnane\u3001net.ifnames"},{"location":"centos-network-device-naming/#bios","text":"\u8981\u4e48\u662fem\u5f00\u5934\uff0c\u8981\u4e48\u662fp\u5f00\u5934\uff1b \u600e\u4e48\u6837\u4f7f\u80fdbiosdevname\u5462\uff1f2\u4e2a\u6761\u4ef6\uff0c\u5b89\u88c5biosdevname\u5305\uff0c\u4e14\u5728\u5185\u6838\u542f\u52a8\u53c2\u6570\u4e2d\u660e\u786e biosdevname=1. \u5426\u5219\u4f7f\u80fd\u4e0d\u4e86\uff1b \u4f46\u662f\u4e0d\u7ba1\u600e\u4e48\u6837\uff0c\u5982\u679c\u7528\u6237\u81ea\u5b9a\u4e49\u4e86udev rules\uff0c\u5219\u7528\u6237\u81ea\u5b9a\u4e49\u7684rules\u4f18\u5148\uff01 \u8fd9\u662f\u603b\u8ff0\uff0c\u4f46\u51e1\u7528\u6237\u81ea\u5b9a\u4e49rules\uff0c\u4f18\u5148\u7ea7\u6700\u9ad8\uff1b","title":"bios\u547d\u540d\u89c4\u5219\uff1a"},{"location":"centos-network-device-naming/#netifname","text":"\u5982\u679c\u5728\u542f\u52a8\u53c2\u6570\u4e2d\u589e\u52a0net.ifname=0\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5728/lib/udev/rule.d/80-net-name-slot.rules\u4f53\u73b0\u4f7f\u7528\u4ef7\u503c\uff0c\u5219\u544a\u8bc9\u7cfb\u7edf\u4e0d\u7528scheme\u7684\u65b9\u5f0f\u6765\u547d\u540d\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u4f1a\u6062\u590dethx\u8fd9\u79cd\u4e0d\u786e\u5b9a\u6027\u7684\u547d\u540d\u65b9\u5f0f\uff1b","title":"\u5185\u6838\u542f\u52a8\u53c2\u6570net.ifname,"},{"location":"centos-network-device-naming/#ethx","text":"\u5185\u6838\u5728boot \u8fc7\u7a0b\u662f\u9ed8\u8ba4\u4f7f\u7528ethX\u65b9\u5f0f\u6765\u547d\u540d\u7684\uff0c\u6bcf\u6b21\u542f\u52a8\u7684\u65f6\u5019\u90fd\u4e0d\u786e\u5b9a\uff0c\u542f\u52a8\u4f1a\u540e\u518d\u901a\u8fc7udev\u7b49\u65b9\u5f0f\u53bbrename, \u53c2\u8003\u6587\u6863\uff1a https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/sec-troubleshooting_network_device_naming","title":"\u4e94\u3001 \u4e0d\u8981\u7528ethX\u53bb\u547d\u540d"},{"location":"centos7-set-kernel/","text":"CentOS 7\u3067\u30ab\u30fc\u30cd\u30eb\u3092\u30d3\u30eb\u30c9\u3059\u308b\u6a5f\u4f1a\u304c\u3042\u3063\u305f\u306e\u3067\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30ab\u30fc\u30cd\u30eb\u3092\u5909\u66f4\u3059\u308b\u65b9\u6cd5\u3092\u30e1\u30e2\u3057\u3066\u304a\u304d\u307e\u3059\u3002\u30c6\u30ad\u30b9\u30c8\u30a8\u30c7\u30a3\u30bf\u3067grub.cfg\u3092\u7de8\u96c6\u3059\u308b\u3082\u306e\u3060\u3068\u3059\u3063\u304b\u308a\u601d\u3044\u8fbc\u3093\u3067\u305f\u306e\u3067\u3057\u3070\u3089\u304fgrub.cfg\u3092\u3058\u30fc\u30fc\u3063\u3068\u773a\u3081\u3066\u305f\u306e\u3067\u3059\u304c\u3001\u8abf\u3079\u3066\u307f\u305f\u3068\u3053\u308d\u6e96\u5099\u3055\u308c\u3066\u3044\u308bgrub2-set-default\u30b3\u30de\u30f3\u30c9\u3067\u5909\u66f4\u3067\u304d\u307e\u3059\u3002 \u73fe\u5728\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3092\u8abf\u3079\u308b \u00b6 [root@backup ~]# grub2-editenv list saved_entry=CentOS Linux (3.10.0-693.2.2.el7.x86_64) 7 (Core) [root@backup ~]# \u30ab\u30fc\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3092\u8868\u793a\u3059\u308b \u00b6 [root@backup ~]# awk -F\\' '$1==\"menuentry \" {print i++ \" : \" $2}' /etc/grub2.cfg 0 : CentOS Linux (3.10.0-693.2.2.el7.x86_64) 7 (Core) 1 : CentOS Linux, with Linux 3.10.0-229.20.1.el7.x86_64 2 : CentOS Linux, with Linux 3.10.0-123.el7.x86_64 3 : CentOS Linux, with Linux 0-rescue-1857a64194e64a80a83a91324b8169d5 [root@backup ~]# \u5229\u7528\u3057\u305f\u3044\u30ab\u30fc\u30cd\u30eb\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u306b\u8a2d\u5b9a\u3059\u308b \u00b6 \u4f8b\u3048\u3070 1 : CentOS Linux, with Linux 3.10.0-229.20.1.el7.x86_64 \u306b\u5909\u66f4\u3059\u308b\u5834\u5408\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3067\u3059\u3002 [root@backup ~]# grub2-set-default 1 [root@backup ~]# grub2-editenv list saved_entry=1 \u518d\u8d77\u52d5\u3057\u3066\u78ba\u8a8d\u3059\u308b \u00b6","title":"centos7-set-kernel"},{"location":"centos7-set-kernel/#_1","text":"[root@backup ~]# grub2-editenv list saved_entry=CentOS Linux (3.10.0-693.2.2.el7.x86_64) 7 (Core) [root@backup ~]#","title":"\u73fe\u5728\u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u3092\u8abf\u3079\u308b"},{"location":"centos7-set-kernel/#_2","text":"[root@backup ~]# awk -F\\' '$1==\"menuentry \" {print i++ \" : \" $2}' /etc/grub2.cfg 0 : CentOS Linux (3.10.0-693.2.2.el7.x86_64) 7 (Core) 1 : CentOS Linux, with Linux 3.10.0-229.20.1.el7.x86_64 2 : CentOS Linux, with Linux 3.10.0-123.el7.x86_64 3 : CentOS Linux, with Linux 0-rescue-1857a64194e64a80a83a91324b8169d5 [root@backup ~]#","title":"\u30ab\u30fc\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3092\u8868\u793a\u3059\u308b"},{"location":"centos7-set-kernel/#_3","text":"\u4f8b\u3048\u3070 1 : CentOS Linux, with Linux 3.10.0-229.20.1.el7.x86_64 \u306b\u5909\u66f4\u3059\u308b\u5834\u5408\u306f\u4e0b\u8a18\u306e\u901a\u308a\u3067\u3059\u3002 [root@backup ~]# grub2-set-default 1 [root@backup ~]# grub2-editenv list saved_entry=1","title":"\u5229\u7528\u3057\u305f\u3044\u30ab\u30fc\u30cd\u30eb\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u306b\u8a2d\u5b9a\u3059\u308b"},{"location":"centos7-set-kernel/#_4","text":"","title":"\u518d\u8d77\u52d5\u3057\u3066\u78ba\u8a8d\u3059\u308b"},{"location":"iptables/","text":"iptables\u8be6\u89e3 \u00b6 \u539f\u6587 iptables\u6982\u5ff5 \u00b6","title":"iptables"},{"location":"iptables/#iptables","text":"\u539f\u6587","title":"iptables\u8be6\u89e3"},{"location":"iptables/#iptables_1","text":"","title":"iptables\u6982\u5ff5"},{"location":"linux-lvm/","text":"Linux\u73af\u5883\u4e0b LVM \u903b\u8f91\u5377\u7684\u5efa\u7acb\u3001\u6269\u5bb9\u548c\u51cf\u5bb9\u64cd\u4f5c \u00b6 \u524d\u8a00 \u00b6 LVM\u662f\u903b\u8f91\u76d8\u5377\u7ba1\u7406\uff08Logical Volume Manager\uff09\u7684\u7b80\u79f0\uff0c\u5b83\u662fLinux\u73af\u5883\u4e0b\u5bf9\u78c1\u76d8\u5206\u533a\u8fdb\u884c\u7ba1\u7406\u7684\u4e00\u79cd\u673a\u5236\uff0c \u00b6 LVM\u662f\u5efa\u7acb\u5728\u786c\u76d8\u548c\u5206\u533a\u4e4b\u4e0a\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c\u6765\u63d0\u9ad8\u78c1\u76d8\u5206LVM\u533a\u7ba1\u7406\u7684\u7075\u6d3b\u6027\u3002 \u524d\u9762\u8c08\u5230\uff0cLVM\u662f\u5728\u78c1\u76d8\u5206\u533a\u548c\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u6dfb\u52a0\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c \u6765\u4e3a\u6587\u4ef6\u7cfb\u7edf\u5c4f\u853d\u4e0b\u5c42\u78c1\u76d8\u5206\u533a\u5e03\u5c40\uff0c\u63d0\u4f9b\u4e00\u4e2a\u62bd\u8c61\u7684\u76d8\u5377\uff0c\u5728\u76d8\u5377\u4e0a\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\u3002 \u7269\u7406\u5377\uff08physical volume\uff09\u7269\u7406\u5377\u5c31\u662f\u6307\u786c\u76d8\u5206\u533a\u6216\u4ece\u903b\u8f91\u4e0a\u4e0e\u78c1\u76d8\u5206\u533a\u5177\u6709\u540c\u6837 \u529f\u80fd\u7684\u8bbe\u5907\uff08\u5982RAID\uff09\uff0c\u662fLVM\u7684\u57fa\u672c\u5b58\u50a8\u903b\u8f91\u5757\uff0c\u4f46\u548c\u57fa\u672c\u7684\u7269\u7406\u5b58\u50a8\u4ecb\u8d28 \uff08\u5982\u5206\u533a\u3001\u78c1\u76d8\u7b49\uff09\u6bd4\u8f83\uff0c\u5374\u5305\u542b\u6709\u4e0eLVM\u76f8\u5173\u7684\u7ba1\u7406\u53c2\u6570\u3002 LVM\u662f\u5728\u78c1\u76d8\u5206\u533a\u548c\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u6dfb\u52a0\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c \u00b6 \u6765\u4e3a\u6587\u4ef6\u7cfb\u7edf\u5c4f\u853d\u4e0b\u5c42\u78c1\u76d8\u5206\u533a\u5e03\u5c40\uff0c\u63d0\u4f9b\u4e00\u4e2a\u62bd\u8c61\u7684\u76d8\u5377\uff0c\u5728\u76d8\u5377\u4e0a\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\u3002\u9996\u5148\u6211\u4eec\u8ba8\u8bba\u4ee5\u4e0b\u51e0\u4e2aLVM\u672f\u8bed\uff1a \u7269\u7406\u5b58\u50a8\u4ecb\u8d28\uff08Thephysicalmedia\uff09 \u8fd9\u91cc\u6307\u7cfb\u7edf\u7684\u5b58\u50a8\u8bbe\u5907\uff1a\u786c\u76d8\uff0c\u662f\u5b58\u50a8\u7cfb\u7edf\u6700\u4f4e\u5c42\u7684\u5b58\u50a8\u5355\u5143\u3002 \u7269\u7406\u5377\uff08physicalvolume\uff09 \u7269\u7406\u5377\u5c31\u662f\u6307\u786c\u76d8\u5206\u533a\u6216\u4ece\u903b\u8f91\u4e0a\u4e0e\u78c1\u76d8\u5206\u533a\u5177\u6709\u540c\u6837\u529f\u80fd\u7684\u8bbe\u5907\uff08\u5982RAID\uff09\uff0c\u662fLVM\u7684\u57fa\u672c\u5b58\u50a8\u903b\u8f91\u5757\uff0c\u4f46\u548c\u57fa\u672c\u7684\u7269\u7406\u5b58\u50a8\u4ecb\u8d28\uff08\u5982\u5206\u533a\u3001\u78c1\u76d8\u7b49\uff09\u6bd4\u8f83\uff0c\u5374\u5305\u542b\u6709\u4e0eLVM\u76f8\u5173\u7684\u7ba1\u7406\u53c2\u6570\u3002 \u5377\u7ec4\uff08VolumeGroup\uff09 LVM\u5377\u7ec4\u7c7b\u4f3c\u4e8e\u975eLVM\u7cfb\u7edf\u4e2d\u7684\u7269\u7406\u786c\u76d8\uff0c\u5176\u7531\u7269\u7406\u5377\u7ec4\u6210\u3002\u53ef\u4ee5\u5728\u5377\u7ec4\u4e0a\u521b\u5efa\u4e00\u4e2a\u6216\u591a\u4e2a\u201cLVM\u5206\u533a\u201d\uff08\u903b\u8f91\u5377\uff09\uff0cLVM\u5377\u7ec4\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u7269\u7406\u5377\u7ec4\u6210\u3002 \u903b\u8f91\u5377\uff08logicalvolume\uff09 LVM\u7684\u903b\u8f91\u5377\u7c7b\u4f3c\u4e8e\u975eLVM\u7cfb\u7edf\u4e2d\u7684\u786c\u76d8\u5206\u533a\uff0c\u5728\u903b\u8f91\u5377\u4e4b\u4e0a\u53ef\u4ee5\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\uff08\u6bd4\u5982/home\u6216\u8005/usr\u7b49\uff09\u3002 PE\uff08physicalextent\uff09 \u6bcf\u4e00\u4e2a\u7269\u7406\u5377\u88ab\u5212\u5206\u4e3a\u79f0\u4e3aPE(PhysicalExtents\uff09\u7684\u57fa\u672c\u5355\u5143\uff0c\u5177\u6709\u552f\u4e00\u7f16\u53f7\u7684PE\u662f\u53ef\u4ee5\u88abLVM\u5bfb\u5740\u7684\u6700\u5c0f\u5355\u5143\u3002PE\u7684\u5927\u5c0f\u662f\u53ef\u914d\u7f6e\u7684\uff0c\u9ed8\u8ba4\u4e3a4MB\u3002 LE\uff08logicalextent\uff09 \u903b\u8f91\u5377\u4e5f\u88ab\u5212\u5206\u4e3a\u88ab\u79f0\u4e3aLE(LogicalExtents\uff09\u7684\u53ef\u88ab\u5bfb\u5740\u7684\u57fa\u672c\u5355\u4f4d\u3002\u5728\u540c\u4e00\u4e2a\u5377\u7ec4\u4e2d\uff0cLE\u7684\u5927\u5c0f\u548cPE\u662f\u76f8\u540c\u7684\uff0c\u5e76\u4e14\u4e00\u4e00\u5bf9\u5e94\u3002 \u5b9e\u9a8c\u90e8\u5206 \u00b6 ---------\u5efa\u7acb\u903b\u8f91\u5377--------- \u00b6 \u65b0\u5efa2\u4e2a\u5206\u533a,sda5 5G,sd6 10G,\u5b8c\u6210\u4e4b\u540e\u5982\u4e0b [root@yangcan /]# fdisk -l Disk /dev/sda: 42.9 GB, 42949672960 bytes 255 heads, 63 sectors/track, 5221 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x000ed173 Device Boot Start End Blocks Id System /dev/sda1 * 1 39 307200 83 Linux Partition 1 does not end on cylinder boundary. /dev/sda2 39 2167 17091584 83 Linux /dev/sda3 2167 2611 3571712 82 Linux swap / Solaris /dev/sda4 2611 5221 20966162+ 5 Extended /dev/sda5 2611 3264 5246528+ 83 Linux /dev/sda6 3265 4570 10490413+ 83 Linux \u628asda6\u521d\u59cb\u5316\u7269\u7406\u5377 [root@yangcan /]# pvcreate /dev/sda6 Device vg6 not found (or ignored by filtering). Writing physical volume data to disk \"/dev/sda6\" Physical volume \"/dev/sda6\" successfully created \u521b\u5efa\u5377\u7ec4vg6,PE\u4e3a16M [root@yangcan /]# vgcreate -s 16M vg6 /dev/sda6 Volume group \"vg6\" successfully created [root@yangcan /]# vgdisplay --- Volume group --- VG Name vg6 System ID Format lvm2 Metadata Areas 1 Metadata Sequence No 1 VG Access read/write VG Status resizable MAX LV 0 Cur LV 0 Open LV 0 Max PV 0 Cur PV 1 Act PV 1 VG Size 10.00 GiB PE Size 16.00 MiB Total PE 640 Alloc PE / Size 0 / 0 Free PE / Size 640 / 10.00 GiB VG UUID 35tmMm-Hyec-i4f1-xkd7-pMRS-RgRl-sqFa7l \u521b\u5efa\u903b\u8f91\u5377ftpdata,\u5927\u5c0f\u4e3a6G [root@yangcan /]# lvcreate -L 6G -n ftpdata vg6 Logical volume \"ftpdata\" created [root@yangcan /]# lvdisplay --- Logical volume --- LV Name /dev/vg6/ftpdata VG Name vg6 LV UUID LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM LV Write Access read/write LV Status available # open 0 LV Size 6.00 GiB Current LE 384 Segments 1 Allocation inherit Read ahead sectors auto - currently set to 256 Block device 253:0 \u683c\u5f0f\u5316ext4,\u5e76\u6302\u8f7d,\u5e76cp\u4e00\u4e9b\u6570\u636e\u8fdb\u53bb [root@yangcan /]# mke2fs -T ext4 /dev/vg6/ftpdata [root@yangcan /]# mount /dev/vg6/ftpdata /ftpdata/ [root@yangcan /]# cd /ftpdata/ [root@yangcan ftpdata]# cp /etc/*.conf ./ [root@yangcan ftpdata]# cp /usr/share/dict/linux.words ./ --------\u6269\u5bb9-------- \u00b6 \u65b0\u589e\u4e00\u4e2a\u78c1\u76d8\u5230\u5377\u7ec4vg6,\u5c31\u7528\u5230\u4e4b\u524d\u5269\u4e0b\u7684sda5\u4e86 [root@yangcan ftpdata]# vgextend vg6 /dev/sda5 Volume group \"vg6\" successfully extended [root@yangcan ftpdata]# vgdisplay --- Volume group --- VG Name vg6 System ID Format lvm2 Metadata Areas 2 Metadata Sequence No 3 VG Access read/write VG Status resizable MAX LV 0 Cur LV 1 Open LV 1 Max PV 0 Cur PV 2 Act PV 2 VG Size 15.00 GiB PE Size 16.00 MiB Total PE 960 Alloc PE / Size 384 / 6.00 GiB Free PE / Size 576 / 9.00 GiB VG UUID 35tmMm-Hyec-i4f1-xkd7-pMRS-RgRl-sqFa7l \u6269\u5bb9ftpdata,\u5f53\u6211\u4eec\u6587\u4ef6\u4e0d\u6bb5\u589e\u52a0\u7684\u65f6\u5019,\u6269\u5bb9\u5c31\u5f88\u6709\u5fc5\u8981\u4e86 [root@yangcan ftpdata]# lvextend -L +4G /dev/vg6/ftpdata \u6216\u8005\u4f7f\u7528,\u5c31\u662f\u60f3\u8ba9\u4f60\u660e\u767d-L \u548c -L +\u7684\u533a\u522b,-L \u540e\u9762\u76f4\u63a5\u52a0\u5bb9\u91cf,\u662f\u6307\u76f4\u63a5\u52a0\u5230\u5bb9\u91cf,\u800c-L +\u5bb9\u91cf,\u662f\u6307\u5728\u539f\u6709\u5bb9\u91cf\u4e0a\u52a0\u591a\u5c11\u5bb9\u91cf! [root@yangcan ftpdata]# lvextend -L 10G /dev/vg6/ftpdata Extending logical volume ftpdata to 10.00 GiB Logical volume ftpdata successfully resized [root@yangcan ftpdata]# lvdisplay --- Logical volume --- LV Name /dev/vg6/ftpdata VG Name vg6 LV UUID LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM LV Write Access read/write LV Status available # open 1 LV Size 10.00 GiB Current LE 640 Segments 1 Allocation inherit Read ahead sectors auto - currently set to 256 Block device 253:0 [root@yangcan ftpdata]# df -h|grep ftpdata /dev/mapper/vg6-ftpdata 6.0G 145M 5.5G 3% /ftpdata \u6b64\u65f6\u67e5\u770bftpdata\u6587\u4ef6\u7cfb\u7edf\u5bb9\u91cf\u7684\u65f6\u5019,\u8fd8\u662f\u4e4b\u524d\u7684\u5927\u5c0f,\u6240\u4ee5\u9700\u8981resize2fs [root@yangcan ftpdata]# resize2fs /dev/vg6/ftpdata resize2fs 1.41.12 (17-May-2010) Filesystem at /dev/vg6/ftpdata is mounted on /ftpdata; on-line resizing required old desc_blocks = 1, new_desc_blocks = 1 Performing an on-line resize of /dev/vg6/ftpdata to 2621440 (4k) blocks. The filesystem on /dev/vg6/ftpdata is now 2621440 blocks long. [root@yangcan ftpdata]# df -h|grep ftpdata /dev/mapper/vg6-ftpdata 9.9G 147M 9.3G 2% /ftpdata [root@yangcan ftpdata]# lvdisplay --- Logical volume --- LV Name /dev/vg6/ftpdata VG Name vg6 LV UUID LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM LV Write Access read/write LV Status available # open 1 LV Size 10.00 GiB Current LE 640 Segments 1 Allocation inherit Read ahead sectors auto - currently set to 256 Block device 253:0 \u73b0\u5728\u5c31\u6587\u4ef6\u7cfb\u7edf\u548c\u903b\u8f91\u5377\u7a7a\u95f4\u4e00\u81f4\u4e86 -----------\u7f29\u5bb9---------- \u00b6 \u6269\u5bb9\u5b9e\u9a8c\u505a\u5b8c\u4e86,\u63a5\u4e0b\u6765\u505a\u7f29\u5bb9,\u7f29\u5bb9\u6bd4\u6269\u5bb9\u590d\u6742,\u5e73\u65f6\u5de5\u4f5c\u4e5f\u4e0d\u80fd\u8f7b\u6613\u7684\u6307\u5b9a\u7f29\u5bb9\u7684\u5927\u5c0f. [root@yangcan ftpdata]# cd .. [root@yangcan /]# umount /ftpdata/ [root@yangcan /]# e2fsck -f /dev/vg6/ftpdata e2fsck 1.41.12 (17-May-2010) Pass 1: Checking inodes, blocks, and sizes Pass 2: Checking directory structure Pass 3: Checking directory connectivity Pass 4: Checking reference counts Pass 5: Checking group summary information /dev/vg6/ftpdata: 41/655360 files (0.0% non-contiguous), 78604/2621440 blocks \u6ce8\u610f:\u6211\u4eec\u5927\u6982\u8981\u7f29\u52306G\u5de6\u53f3,\u90a3\u6211\u4eec\u5c31\u4e0d\u80fd\u76f4\u63a5resize2fs \u52306G,\u8fd9\u6837\u80af\u5b9a\u662f\u9519\u8bef\u7684,\u56e0\u4e3aPE\u662f\u53ef\u4ee5\u88abLVM\u5bfb\u5740\u7684\u6700\u5c0f\u5355\u5143,\u672c\u6b21\u5b9e\u9a8cPE\u5927\u5c0f\u4e3a16M.\u6211\u4eec\u53bb\u505a\u7f29\u5bb9\u7684\u65f6\u5019,\u4e0d\u53ef\u80fd\u662f0.6\u4e2aPE.\u6240\u6709\u5c24\u5176\u6ce8\u610f,\u7f51\u4e0a\u5f88\u591a\u8d44\u6599\u5c31\u662f\u76f4\u63a5\u6307\u5b9a\u5927\u5c0f,\u800c\u6ca1\u6709\u505a\u6d4b\u8bd5\u73af\u8282!!!\u4f1a\u9020\u6210\u6570\u636e\u7684\u4e22\u5931,\u6240\u4ee5\u6307\u5b9a\u5927\u5c0f\u65f6,\u5148\u7528lvreduce -t \u6d4b\u8bd5\u4e00\u4e0b.\u7528bc\u7b97\u51fa6G\u7684\u4f4d\u7f6e,\u5230\u5e95\u90a3\u4e2a\u503c\u5408\u9002 [root@yangcan /]# bc bc 1.06.95 Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006 Free Software Foundation, Inc. This is free software with ABSOLUTELY NO WARRANTY. For details type `warranty'. --6000\u521a\u597d\u6574\u966416 6000%16 0 --6001\u966416\u4e3a1 6001%16 1 5999%16 15 --\u521a\u597d6000M,\u53d6\u4f59\u4e3a0,\u6211\u4eec\u6bd4\u8f83\u4e00\u4e0b6001\u548c6000\u7684\u533a\u522b [root@yangcan /]# lvreduce -L 6001M /dev/vg6/ftpdata -t Test mode: Metadata will NOT be updated and volumes will not be (de)activated. Rounding up size to full physical extent 5.88 GiB WARNING: Reducing active logical volume to 5.88 GiB THIS MAY DESTROY YOUR DATA (filesystem etc.) Do you really want to reduce ftpdata? [y/n]: n Logical volume ftpdata NOT reduced \u663e\u793a\u4e86\u8b66\u544a\u4fe1\u606f! [root@yangcan /]# lvreduce -L 6000M /dev/vg6/ftpdata -t Test mode: Metadata will NOT be updated and volumes will not be (de)activated. WARNING: Reducing active logical volume to 5.86 GiB THIS MAY DESTROY YOUR DATA (filesystem etc.) Do you really want to reduce ftpdata? [y/n]: \u63d0\u793a\u4e3a6000M\u662f,\u6ca1\u95ee\u9898 \u5f53-t \u6d4b\u8bd5\u65f6,\u6ca1\u95ee\u9898\u4e86,\u90a3\u6211\u4eec\u5c31resize2fs\u4e86 [root@yangcan /]# resize2fs /dev/vg6/ftpdata 6000M resize2fs 1.41.12 (17-May-2010) Resizing the filesystem on /dev/vg6/ftpdata to 1536000 (4k) blocks. The filesystem on /dev/vg6/ftpdata is now 1536000 blocks long. \u6302\u8f7d,\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u7684\u5927\u5c0f,\u4e3a\u6700\u65b0\u76846000M,\u6570\u636e\u4e5f\u6ca1\u6709\u4e22\u5931!! [root@yangcan /]# mount -a [root@yangcan /]# df -h Filesystem Size Used Avail Use% Mounted on /dev/sda2 17G 2.1G 14G 14% / tmpfs 504M 264K 504M 1% /dev/shm /dev/sda1 291M 31M 246M 11% /boot /dev/sr0 2.9G 2.9G 0 100% /media/cdrom /dev/mapper/vg6-ftpdata 5.8G 145M 5.4G 3% /ftpdata \u6211\u4eec\u7528lvdisplay\u67e5\u770b\u4e00\u4e0b\u903b\u8f91\u5377\u7684\u5927\u5c0f\u8fd8\u662f\u4e3a10G [root@yangcan /]# lvdisplay --- Logical volume --- LV Name /dev/vg6/ftpdata VG Name vg6 LV UUID LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM LV Write Access read/write LV Status available # open 1 LV Size 10.00 GiB Current LE 640 Segments 1 Allocation inherit Read ahead sectors auto - currently set to 256 Block device 253:0 \u6240\u4ee5\u6211\u4eec\u7528lvreduce\u8fdb\u884c\u8c03\u6574! [root@yangcan /]# lvreduce -L 6000M /dev/vg6/ftpdata WARNING: Reducing active and open logical volume to 5.86 GiB THIS MAY DESTROY YOUR DATA (filesystem etc.) Do you really want to reduce ftpdata? [y/n]: n Logical volume ftpdata NOT reduced --\u63d0\u793a\u903b\u8f91\u5377\u6b63\u5728\u6253\u5f00,\u6240\u6709\u6211\u4eec\u9700\u8981\u505c\u6b62\u903b\u8f91\u5377,\u518d\u53bb\u8c03\u6574\u5927\u5c0f [root@yangcan /]# lvchange -an /dev/vg6/ftpdata [root@yangcan /]# lvscan inactive '/dev/vg6/ftpdata' [10.00 GiB] inherit [root@yangcan /]# lvreduce -L 6000M /dev/vg6/ftpdata Reducing logical volume ftpdata to 5.86 GiB Logical volume ftpdata successfully resized [root@yangcan /]# mount -a mount: special device /dev/vg6/ftpdata does not exist --\u5f53\u6211\u4eec\u53bb\u6302\u8f7d\u7684\u65f6\u5019,\u63d0\u793a\u6ca1\u6709\u8fd9\u4e2a\u8bbe\u5907.\u6240\u4ee5\u9700\u8981\u542f\u7528 [root@yangcan /]# lvchange -ay /dev/vg6/ftpdata [root@yangcan /]# lvscan ACTIVE '/dev/vg6/ftpdata' [5.86 GiB] inherit \u91cd\u65b0\u6302\u8f7d,\u91cc\u9762\u7684\u6587\u4ef6\u8fd8\u5728! [root@yangcan /]# mount -a [root@yangcan /]# cd /ftpdata/ [root@yangcan ftpdata]# ll total 4996 -rw-r--r--. 1 root root 148 Jul 30 19:37 asound.conf -rw-r--r--. 1 root root 21214 Jul 30 19:37 dnsmasq.conf -rw-r--r--. 1 root root 559 Jul 30 19:37 dracut.conf -rw-r--r--. 1 root root 20 Jul 30 19:37 fprintd.conf -rw-r--r--. 1 root root 0 Jul 30 19:37 gai.conf -rw-------. 1 root root 781 Jul 30 19:37 grub.conf -rw-r--r--. 1 root root 9 Jul 30 19:37 host.conf -rw-r--r--. 1 root root 5309 Jul 30 19:37 kdump.conf ps: \u4f60\u4e5f\u53ef\u4ee5\u4e0d\u505a-t\u6d4b\u8bd5,\u76f4\u63a5\u6307\u5b9a\u5927\u5c0f\u53bb\u7f29\u5bb9,\u770b\u6570\u636e\u662f\u5426\u8fd8\u5728? --------\u79fb\u9664\u7269\u7406\u5377-------- \u00b6 \u79fb\u9664\u4e4b\u524d,\u7269\u7406\u5377\u91cc\u9762\u5fc5\u987b\u6ca1\u6709\u6570\u636e,\u7528\u4e0b\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u5404\u7269\u7406\u5377\u7684\u7a7a\u95f4\u5927\u5c0f.\u8ba1\u5212\u662f\u5426\u6709\u8db3\u591f\u7684\u7a7a\u95f4\u53ef\u4ee5\u88ab\u7528\u6765\u79fb\u52a8\u6570\u636e! [root@yangcan Desktop]# pvscan \u642c\u79fb\u8981\u79fb\u9664\u7269\u7406\u5377\u7684\u6570\u636e\u5230\u5176\u4ed6\u7a7a\u95f2\u4e14\u6ee1\u8db3\u5927\u5c0f\u7684\u7269\u7406\u5377 [root@yangcan Desktop]# pvmove /dev/sda6 /dev/sda7 \u5b8c\u6210\u4e4b\u540e \u4ece\u5377\u7ec4\u79fb\u9664\u7269\u7406\u5377 [root@yangcan Desktop]#vgchange -an vg5 [root@yangcan Desktop]# vgreduce vg5 /dev/sda6","title":"linux-lvm"},{"location":"linux-lvm/#linux-lvm","text":"","title":"Linux\u73af\u5883\u4e0b LVM \u903b\u8f91\u5377\u7684\u5efa\u7acb\u3001\u6269\u5bb9\u548c\u51cf\u5bb9\u64cd\u4f5c"},{"location":"linux-lvm/#_1","text":"","title":"\u524d\u8a00"},{"location":"linux-lvm/#lvmlogical-volume-managerlinux","text":"LVM\u662f\u5efa\u7acb\u5728\u786c\u76d8\u548c\u5206\u533a\u4e4b\u4e0a\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c\u6765\u63d0\u9ad8\u78c1\u76d8\u5206LVM\u533a\u7ba1\u7406\u7684\u7075\u6d3b\u6027\u3002 \u524d\u9762\u8c08\u5230\uff0cLVM\u662f\u5728\u78c1\u76d8\u5206\u533a\u548c\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u6dfb\u52a0\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c \u6765\u4e3a\u6587\u4ef6\u7cfb\u7edf\u5c4f\u853d\u4e0b\u5c42\u78c1\u76d8\u5206\u533a\u5e03\u5c40\uff0c\u63d0\u4f9b\u4e00\u4e2a\u62bd\u8c61\u7684\u76d8\u5377\uff0c\u5728\u76d8\u5377\u4e0a\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\u3002 \u7269\u7406\u5377\uff08physical volume\uff09\u7269\u7406\u5377\u5c31\u662f\u6307\u786c\u76d8\u5206\u533a\u6216\u4ece\u903b\u8f91\u4e0a\u4e0e\u78c1\u76d8\u5206\u533a\u5177\u6709\u540c\u6837 \u529f\u80fd\u7684\u8bbe\u5907\uff08\u5982RAID\uff09\uff0c\u662fLVM\u7684\u57fa\u672c\u5b58\u50a8\u903b\u8f91\u5757\uff0c\u4f46\u548c\u57fa\u672c\u7684\u7269\u7406\u5b58\u50a8\u4ecb\u8d28 \uff08\u5982\u5206\u533a\u3001\u78c1\u76d8\u7b49\uff09\u6bd4\u8f83\uff0c\u5374\u5305\u542b\u6709\u4e0eLVM\u76f8\u5173\u7684\u7ba1\u7406\u53c2\u6570\u3002","title":"LVM\u662f\u903b\u8f91\u76d8\u5377\u7ba1\u7406\uff08Logical Volume Manager\uff09\u7684\u7b80\u79f0\uff0c\u5b83\u662fLinux\u73af\u5883\u4e0b\u5bf9\u78c1\u76d8\u5206\u533a\u8fdb\u884c\u7ba1\u7406\u7684\u4e00\u79cd\u673a\u5236\uff0c"},{"location":"linux-lvm/#lvm","text":"\u6765\u4e3a\u6587\u4ef6\u7cfb\u7edf\u5c4f\u853d\u4e0b\u5c42\u78c1\u76d8\u5206\u533a\u5e03\u5c40\uff0c\u63d0\u4f9b\u4e00\u4e2a\u62bd\u8c61\u7684\u76d8\u5377\uff0c\u5728\u76d8\u5377\u4e0a\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\u3002\u9996\u5148\u6211\u4eec\u8ba8\u8bba\u4ee5\u4e0b\u51e0\u4e2aLVM\u672f\u8bed\uff1a \u7269\u7406\u5b58\u50a8\u4ecb\u8d28\uff08Thephysicalmedia\uff09 \u8fd9\u91cc\u6307\u7cfb\u7edf\u7684\u5b58\u50a8\u8bbe\u5907\uff1a\u786c\u76d8\uff0c\u662f\u5b58\u50a8\u7cfb\u7edf\u6700\u4f4e\u5c42\u7684\u5b58\u50a8\u5355\u5143\u3002 \u7269\u7406\u5377\uff08physicalvolume\uff09 \u7269\u7406\u5377\u5c31\u662f\u6307\u786c\u76d8\u5206\u533a\u6216\u4ece\u903b\u8f91\u4e0a\u4e0e\u78c1\u76d8\u5206\u533a\u5177\u6709\u540c\u6837\u529f\u80fd\u7684\u8bbe\u5907\uff08\u5982RAID\uff09\uff0c\u662fLVM\u7684\u57fa\u672c\u5b58\u50a8\u903b\u8f91\u5757\uff0c\u4f46\u548c\u57fa\u672c\u7684\u7269\u7406\u5b58\u50a8\u4ecb\u8d28\uff08\u5982\u5206\u533a\u3001\u78c1\u76d8\u7b49\uff09\u6bd4\u8f83\uff0c\u5374\u5305\u542b\u6709\u4e0eLVM\u76f8\u5173\u7684\u7ba1\u7406\u53c2\u6570\u3002 \u5377\u7ec4\uff08VolumeGroup\uff09 LVM\u5377\u7ec4\u7c7b\u4f3c\u4e8e\u975eLVM\u7cfb\u7edf\u4e2d\u7684\u7269\u7406\u786c\u76d8\uff0c\u5176\u7531\u7269\u7406\u5377\u7ec4\u6210\u3002\u53ef\u4ee5\u5728\u5377\u7ec4\u4e0a\u521b\u5efa\u4e00\u4e2a\u6216\u591a\u4e2a\u201cLVM\u5206\u533a\u201d\uff08\u903b\u8f91\u5377\uff09\uff0cLVM\u5377\u7ec4\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u7269\u7406\u5377\u7ec4\u6210\u3002 \u903b\u8f91\u5377\uff08logicalvolume\uff09 LVM\u7684\u903b\u8f91\u5377\u7c7b\u4f3c\u4e8e\u975eLVM\u7cfb\u7edf\u4e2d\u7684\u786c\u76d8\u5206\u533a\uff0c\u5728\u903b\u8f91\u5377\u4e4b\u4e0a\u53ef\u4ee5\u5efa\u7acb\u6587\u4ef6\u7cfb\u7edf\uff08\u6bd4\u5982/home\u6216\u8005/usr\u7b49\uff09\u3002 PE\uff08physicalextent\uff09 \u6bcf\u4e00\u4e2a\u7269\u7406\u5377\u88ab\u5212\u5206\u4e3a\u79f0\u4e3aPE(PhysicalExtents\uff09\u7684\u57fa\u672c\u5355\u5143\uff0c\u5177\u6709\u552f\u4e00\u7f16\u53f7\u7684PE\u662f\u53ef\u4ee5\u88abLVM\u5bfb\u5740\u7684\u6700\u5c0f\u5355\u5143\u3002PE\u7684\u5927\u5c0f\u662f\u53ef\u914d\u7f6e\u7684\uff0c\u9ed8\u8ba4\u4e3a4MB\u3002 LE\uff08logicalextent\uff09 \u903b\u8f91\u5377\u4e5f\u88ab\u5212\u5206\u4e3a\u88ab\u79f0\u4e3aLE(LogicalExtents\uff09\u7684\u53ef\u88ab\u5bfb\u5740\u7684\u57fa\u672c\u5355\u4f4d\u3002\u5728\u540c\u4e00\u4e2a\u5377\u7ec4\u4e2d\uff0cLE\u7684\u5927\u5c0f\u548cPE\u662f\u76f8\u540c\u7684\uff0c\u5e76\u4e14\u4e00\u4e00\u5bf9\u5e94\u3002","title":"LVM\u662f\u5728\u78c1\u76d8\u5206\u533a\u548c\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u6dfb\u52a0\u7684\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c"},{"location":"linux-lvm/#_2","text":"","title":"\u5b9e\u9a8c\u90e8\u5206"},{"location":"linux-lvm/#-","text":"\u65b0\u5efa2\u4e2a\u5206\u533a,sda5 5G,sd6 10G,\u5b8c\u6210\u4e4b\u540e\u5982\u4e0b [root@yangcan /]# fdisk -l Disk /dev/sda: 42.9 GB, 42949672960 bytes 255 heads, 63 sectors/track, 5221 cylinders Units = cylinders of 16065 * 512 = 8225280 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk identifier: 0x000ed173 Device Boot Start End Blocks Id System /dev/sda1 * 1 39 307200 83 Linux Partition 1 does not end on cylinder boundary. /dev/sda2 39 2167 17091584 83 Linux /dev/sda3 2167 2611 3571712 82 Linux swap / Solaris /dev/sda4 2611 5221 20966162+ 5 Extended /dev/sda5 2611 3264 5246528+ 83 Linux /dev/sda6 3265 4570 10490413+ 83 Linux \u628asda6\u521d\u59cb\u5316\u7269\u7406\u5377 [root@yangcan /]# pvcreate /dev/sda6 Device vg6 not found (or ignored by filtering). Writing physical volume data to disk \"/dev/sda6\" Physical volume \"/dev/sda6\" successfully created \u521b\u5efa\u5377\u7ec4vg6,PE\u4e3a16M [root@yangcan /]# vgcreate -s 16M vg6 /dev/sda6 Volume group \"vg6\" successfully created [root@yangcan /]# vgdisplay --- Volume group --- VG Name vg6 System ID Format lvm2 Metadata Areas 1 Metadata Sequence No 1 VG Access read/write VG Status resizable MAX LV 0 Cur LV 0 Open LV 0 Max PV 0 Cur PV 1 Act PV 1 VG Size 10.00 GiB PE Size 16.00 MiB Total PE 640 Alloc PE / Size 0 / 0 Free PE / Size 640 / 10.00 GiB VG UUID 35tmMm-Hyec-i4f1-xkd7-pMRS-RgRl-sqFa7l \u521b\u5efa\u903b\u8f91\u5377ftpdata,\u5927\u5c0f\u4e3a6G [root@yangcan /]# lvcreate -L 6G -n ftpdata vg6 Logical volume \"ftpdata\" created [root@yangcan /]# lvdisplay --- Logical volume --- LV Name /dev/vg6/ftpdata VG Name vg6 LV UUID LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM LV Write Access read/write LV Status available # open 0 LV Size 6.00 GiB Current LE 384 Segments 1 Allocation inherit Read ahead sectors auto - currently set to 256 Block device 253:0 \u683c\u5f0f\u5316ext4,\u5e76\u6302\u8f7d,\u5e76cp\u4e00\u4e9b\u6570\u636e\u8fdb\u53bb [root@yangcan /]# mke2fs -T ext4 /dev/vg6/ftpdata [root@yangcan /]# mount /dev/vg6/ftpdata /ftpdata/ [root@yangcan /]# cd /ftpdata/ [root@yangcan ftpdata]# cp /etc/*.conf ./ [root@yangcan ftpdata]# cp /usr/share/dict/linux.words ./","title":"---------\u5efa\u7acb\u903b\u8f91\u5377---------"},{"location":"linux-lvm/#-_1","text":"\u65b0\u589e\u4e00\u4e2a\u78c1\u76d8\u5230\u5377\u7ec4vg6,\u5c31\u7528\u5230\u4e4b\u524d\u5269\u4e0b\u7684sda5\u4e86 [root@yangcan ftpdata]# vgextend vg6 /dev/sda5 Volume group \"vg6\" successfully extended [root@yangcan ftpdata]# vgdisplay --- Volume group --- VG Name vg6 System ID Format lvm2 Metadata Areas 2 Metadata Sequence No 3 VG Access read/write VG Status resizable MAX LV 0 Cur LV 1 Open LV 1 Max PV 0 Cur PV 2 Act PV 2 VG Size 15.00 GiB PE Size 16.00 MiB Total PE 960 Alloc PE / Size 384 / 6.00 GiB Free PE / Size 576 / 9.00 GiB VG UUID 35tmMm-Hyec-i4f1-xkd7-pMRS-RgRl-sqFa7l \u6269\u5bb9ftpdata,\u5f53\u6211\u4eec\u6587\u4ef6\u4e0d\u6bb5\u589e\u52a0\u7684\u65f6\u5019,\u6269\u5bb9\u5c31\u5f88\u6709\u5fc5\u8981\u4e86 [root@yangcan ftpdata]# lvextend -L +4G /dev/vg6/ftpdata \u6216\u8005\u4f7f\u7528,\u5c31\u662f\u60f3\u8ba9\u4f60\u660e\u767d-L \u548c -L +\u7684\u533a\u522b,-L \u540e\u9762\u76f4\u63a5\u52a0\u5bb9\u91cf,\u662f\u6307\u76f4\u63a5\u52a0\u5230\u5bb9\u91cf,\u800c-L +\u5bb9\u91cf,\u662f\u6307\u5728\u539f\u6709\u5bb9\u91cf\u4e0a\u52a0\u591a\u5c11\u5bb9\u91cf! [root@yangcan ftpdata]# lvextend -L 10G /dev/vg6/ftpdata Extending logical volume ftpdata to 10.00 GiB Logical volume ftpdata successfully resized [root@yangcan ftpdata]# lvdisplay --- Logical volume --- LV Name /dev/vg6/ftpdata VG Name vg6 LV UUID LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM LV Write Access read/write LV Status available # open 1 LV Size 10.00 GiB Current LE 640 Segments 1 Allocation inherit Read ahead sectors auto - currently set to 256 Block device 253:0 [root@yangcan ftpdata]# df -h|grep ftpdata /dev/mapper/vg6-ftpdata 6.0G 145M 5.5G 3% /ftpdata \u6b64\u65f6\u67e5\u770bftpdata\u6587\u4ef6\u7cfb\u7edf\u5bb9\u91cf\u7684\u65f6\u5019,\u8fd8\u662f\u4e4b\u524d\u7684\u5927\u5c0f,\u6240\u4ee5\u9700\u8981resize2fs [root@yangcan ftpdata]# resize2fs /dev/vg6/ftpdata resize2fs 1.41.12 (17-May-2010) Filesystem at /dev/vg6/ftpdata is mounted on /ftpdata; on-line resizing required old desc_blocks = 1, new_desc_blocks = 1 Performing an on-line resize of /dev/vg6/ftpdata to 2621440 (4k) blocks. The filesystem on /dev/vg6/ftpdata is now 2621440 blocks long. [root@yangcan ftpdata]# df -h|grep ftpdata /dev/mapper/vg6-ftpdata 9.9G 147M 9.3G 2% /ftpdata [root@yangcan ftpdata]# lvdisplay --- Logical volume --- LV Name /dev/vg6/ftpdata VG Name vg6 LV UUID LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM LV Write Access read/write LV Status available # open 1 LV Size 10.00 GiB Current LE 640 Segments 1 Allocation inherit Read ahead sectors auto - currently set to 256 Block device 253:0 \u73b0\u5728\u5c31\u6587\u4ef6\u7cfb\u7edf\u548c\u903b\u8f91\u5377\u7a7a\u95f4\u4e00\u81f4\u4e86","title":"--------\u6269\u5bb9--------"},{"location":"linux-lvm/#-_2","text":"\u6269\u5bb9\u5b9e\u9a8c\u505a\u5b8c\u4e86,\u63a5\u4e0b\u6765\u505a\u7f29\u5bb9,\u7f29\u5bb9\u6bd4\u6269\u5bb9\u590d\u6742,\u5e73\u65f6\u5de5\u4f5c\u4e5f\u4e0d\u80fd\u8f7b\u6613\u7684\u6307\u5b9a\u7f29\u5bb9\u7684\u5927\u5c0f. [root@yangcan ftpdata]# cd .. [root@yangcan /]# umount /ftpdata/ [root@yangcan /]# e2fsck -f /dev/vg6/ftpdata e2fsck 1.41.12 (17-May-2010) Pass 1: Checking inodes, blocks, and sizes Pass 2: Checking directory structure Pass 3: Checking directory connectivity Pass 4: Checking reference counts Pass 5: Checking group summary information /dev/vg6/ftpdata: 41/655360 files (0.0% non-contiguous), 78604/2621440 blocks \u6ce8\u610f:\u6211\u4eec\u5927\u6982\u8981\u7f29\u52306G\u5de6\u53f3,\u90a3\u6211\u4eec\u5c31\u4e0d\u80fd\u76f4\u63a5resize2fs \u52306G,\u8fd9\u6837\u80af\u5b9a\u662f\u9519\u8bef\u7684,\u56e0\u4e3aPE\u662f\u53ef\u4ee5\u88abLVM\u5bfb\u5740\u7684\u6700\u5c0f\u5355\u5143,\u672c\u6b21\u5b9e\u9a8cPE\u5927\u5c0f\u4e3a16M.\u6211\u4eec\u53bb\u505a\u7f29\u5bb9\u7684\u65f6\u5019,\u4e0d\u53ef\u80fd\u662f0.6\u4e2aPE.\u6240\u6709\u5c24\u5176\u6ce8\u610f,\u7f51\u4e0a\u5f88\u591a\u8d44\u6599\u5c31\u662f\u76f4\u63a5\u6307\u5b9a\u5927\u5c0f,\u800c\u6ca1\u6709\u505a\u6d4b\u8bd5\u73af\u8282!!!\u4f1a\u9020\u6210\u6570\u636e\u7684\u4e22\u5931,\u6240\u4ee5\u6307\u5b9a\u5927\u5c0f\u65f6,\u5148\u7528lvreduce -t \u6d4b\u8bd5\u4e00\u4e0b.\u7528bc\u7b97\u51fa6G\u7684\u4f4d\u7f6e,\u5230\u5e95\u90a3\u4e2a\u503c\u5408\u9002 [root@yangcan /]# bc bc 1.06.95 Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006 Free Software Foundation, Inc. This is free software with ABSOLUTELY NO WARRANTY. For details type `warranty'. --6000\u521a\u597d\u6574\u966416 6000%16 0 --6001\u966416\u4e3a1 6001%16 1 5999%16 15 --\u521a\u597d6000M,\u53d6\u4f59\u4e3a0,\u6211\u4eec\u6bd4\u8f83\u4e00\u4e0b6001\u548c6000\u7684\u533a\u522b [root@yangcan /]# lvreduce -L 6001M /dev/vg6/ftpdata -t Test mode: Metadata will NOT be updated and volumes will not be (de)activated. Rounding up size to full physical extent 5.88 GiB WARNING: Reducing active logical volume to 5.88 GiB THIS MAY DESTROY YOUR DATA (filesystem etc.) Do you really want to reduce ftpdata? [y/n]: n Logical volume ftpdata NOT reduced \u663e\u793a\u4e86\u8b66\u544a\u4fe1\u606f! [root@yangcan /]# lvreduce -L 6000M /dev/vg6/ftpdata -t Test mode: Metadata will NOT be updated and volumes will not be (de)activated. WARNING: Reducing active logical volume to 5.86 GiB THIS MAY DESTROY YOUR DATA (filesystem etc.) Do you really want to reduce ftpdata? [y/n]: \u63d0\u793a\u4e3a6000M\u662f,\u6ca1\u95ee\u9898 \u5f53-t \u6d4b\u8bd5\u65f6,\u6ca1\u95ee\u9898\u4e86,\u90a3\u6211\u4eec\u5c31resize2fs\u4e86 [root@yangcan /]# resize2fs /dev/vg6/ftpdata 6000M resize2fs 1.41.12 (17-May-2010) Resizing the filesystem on /dev/vg6/ftpdata to 1536000 (4k) blocks. The filesystem on /dev/vg6/ftpdata is now 1536000 blocks long. \u6302\u8f7d,\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u7684\u5927\u5c0f,\u4e3a\u6700\u65b0\u76846000M,\u6570\u636e\u4e5f\u6ca1\u6709\u4e22\u5931!! [root@yangcan /]# mount -a [root@yangcan /]# df -h Filesystem Size Used Avail Use% Mounted on /dev/sda2 17G 2.1G 14G 14% / tmpfs 504M 264K 504M 1% /dev/shm /dev/sda1 291M 31M 246M 11% /boot /dev/sr0 2.9G 2.9G 0 100% /media/cdrom /dev/mapper/vg6-ftpdata 5.8G 145M 5.4G 3% /ftpdata \u6211\u4eec\u7528lvdisplay\u67e5\u770b\u4e00\u4e0b\u903b\u8f91\u5377\u7684\u5927\u5c0f\u8fd8\u662f\u4e3a10G [root@yangcan /]# lvdisplay --- Logical volume --- LV Name /dev/vg6/ftpdata VG Name vg6 LV UUID LSOtbB-k3mz-DVbb-ATcE-IhBk-V9B7-uaSStM LV Write Access read/write LV Status available # open 1 LV Size 10.00 GiB Current LE 640 Segments 1 Allocation inherit Read ahead sectors auto - currently set to 256 Block device 253:0 \u6240\u4ee5\u6211\u4eec\u7528lvreduce\u8fdb\u884c\u8c03\u6574! [root@yangcan /]# lvreduce -L 6000M /dev/vg6/ftpdata WARNING: Reducing active and open logical volume to 5.86 GiB THIS MAY DESTROY YOUR DATA (filesystem etc.) Do you really want to reduce ftpdata? [y/n]: n Logical volume ftpdata NOT reduced --\u63d0\u793a\u903b\u8f91\u5377\u6b63\u5728\u6253\u5f00,\u6240\u6709\u6211\u4eec\u9700\u8981\u505c\u6b62\u903b\u8f91\u5377,\u518d\u53bb\u8c03\u6574\u5927\u5c0f [root@yangcan /]# lvchange -an /dev/vg6/ftpdata [root@yangcan /]# lvscan inactive '/dev/vg6/ftpdata' [10.00 GiB] inherit [root@yangcan /]# lvreduce -L 6000M /dev/vg6/ftpdata Reducing logical volume ftpdata to 5.86 GiB Logical volume ftpdata successfully resized [root@yangcan /]# mount -a mount: special device /dev/vg6/ftpdata does not exist --\u5f53\u6211\u4eec\u53bb\u6302\u8f7d\u7684\u65f6\u5019,\u63d0\u793a\u6ca1\u6709\u8fd9\u4e2a\u8bbe\u5907.\u6240\u4ee5\u9700\u8981\u542f\u7528 [root@yangcan /]# lvchange -ay /dev/vg6/ftpdata [root@yangcan /]# lvscan ACTIVE '/dev/vg6/ftpdata' [5.86 GiB] inherit \u91cd\u65b0\u6302\u8f7d,\u91cc\u9762\u7684\u6587\u4ef6\u8fd8\u5728! [root@yangcan /]# mount -a [root@yangcan /]# cd /ftpdata/ [root@yangcan ftpdata]# ll total 4996 -rw-r--r--. 1 root root 148 Jul 30 19:37 asound.conf -rw-r--r--. 1 root root 21214 Jul 30 19:37 dnsmasq.conf -rw-r--r--. 1 root root 559 Jul 30 19:37 dracut.conf -rw-r--r--. 1 root root 20 Jul 30 19:37 fprintd.conf -rw-r--r--. 1 root root 0 Jul 30 19:37 gai.conf -rw-------. 1 root root 781 Jul 30 19:37 grub.conf -rw-r--r--. 1 root root 9 Jul 30 19:37 host.conf -rw-r--r--. 1 root root 5309 Jul 30 19:37 kdump.conf ps: \u4f60\u4e5f\u53ef\u4ee5\u4e0d\u505a-t\u6d4b\u8bd5,\u76f4\u63a5\u6307\u5b9a\u5927\u5c0f\u53bb\u7f29\u5bb9,\u770b\u6570\u636e\u662f\u5426\u8fd8\u5728?","title":"-----------\u7f29\u5bb9----------"},{"location":"linux-lvm/#-_3","text":"\u79fb\u9664\u4e4b\u524d,\u7269\u7406\u5377\u91cc\u9762\u5fc5\u987b\u6ca1\u6709\u6570\u636e,\u7528\u4e0b\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u5404\u7269\u7406\u5377\u7684\u7a7a\u95f4\u5927\u5c0f.\u8ba1\u5212\u662f\u5426\u6709\u8db3\u591f\u7684\u7a7a\u95f4\u53ef\u4ee5\u88ab\u7528\u6765\u79fb\u52a8\u6570\u636e! [root@yangcan Desktop]# pvscan \u642c\u79fb\u8981\u79fb\u9664\u7269\u7406\u5377\u7684\u6570\u636e\u5230\u5176\u4ed6\u7a7a\u95f2\u4e14\u6ee1\u8db3\u5927\u5c0f\u7684\u7269\u7406\u5377 [root@yangcan Desktop]# pvmove /dev/sda6 /dev/sda7 \u5b8c\u6210\u4e4b\u540e \u4ece\u5377\u7ec4\u79fb\u9664\u7269\u7406\u5377 [root@yangcan Desktop]#vgchange -an vg5 [root@yangcan Desktop]# vgreduce vg5 /dev/sda6","title":"--------\u79fb\u9664\u7269\u7406\u5377--------"},{"location":"macOS%E8%BD%AF%E4%BB%B6%E7%BC%96%E8%AF%91%E6%97%B6%E6%89%BE%E4%B8%8D%E5%88%B0%E5%A4%B4%E6%96%87%E4%BB%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-%E6%9B%B4%E6%96%B010-15/","text":"\u5143URL","title":"macOS\u8f6f\u4ef6\u7f16\u8bd1\u65f6\u627e\u4e0d\u5230\u5934\u6587\u4ef6\u89e3\u51b3\u65b9\u6cd5[\u66f4\u65b010.15]"},{"location":"megacli/","text":"StorCLI_RefMan_revf PDF Smart\u8868 \u00b6 \u9805\u76eeID \u9805\u76ee\u540d \u8a73\u7d30\u306a\u8aac\u660e 01 Raw Read Error Rate \u3053\u306e\u9805\u76ee\u306f\u30cf\u30fc\u30c9\u30c7\u30a3\u30b9\u30af\u304b\u3089\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u3080\u6642\u306b\u767a\u751f\u3057\u305f\u30a8\u30e9\u30fc\u306e\u5272\u5408\u3092\u8868\u3059\u3002\u6570\u5024\u304c\u95be\u5024\u3088\u308a\u4f4e\u3044\u5834\u5408\u3001\u30cf\u30fc\u30c9\u30c7\u30a3\u30b9\u30af\u5185\u306e\u78c1\u6c17\u30c7\u30a3\u30b9\u30af\u307e\u305f\u306f\u78c1\u6c17\u30d8\u30c3\u30c9\u306b\u7570\u5e38\u304c\u3042\u308b\u3002 05 Reallocated Sectors Count \u4ee3\u66ff\u51e6\u7f6e\uff08\u30c7\u30fc\u30bf\u3092\u7279\u5225\u306b\u4e88\u7d04\u3057\u305f\u4e88\u5099\u30a8\u30ea\u30a2\u306b\u79fb\u52d5\u3059\u308b\uff09\u3092\u65bd\u3055\u308c\u305f\u4e0d\u826f\u30bb\u30af\u30bf\u306e\u6570\u3002 C5(197) Current Pending Sector Count \u73fe\u5728\u7570\u5e38\u304c\u3042\u308a\u3001\u4ee3\u66ff\u51e6\u7406\u3092\u5f85\u3064\u30bb\u30af\u30bf\u306e\u7dcf\u6570\u3002\u3082\u3057\u5f8c\u3067\u8aad\u307f\u8fbc\u307f\u306b\u6210\u529f\u3057\u305f\u30bb\u30af\u30bf\u304c\u3042\u308c\u3070\u3001\u3053\u306e\u5024\u306f\u6e1b\u5c11\u3059\u308b\u3002 C6(198) Off-Line Scan Uncorrectable Sector Count \u30aa\u30d5\u30e9\u30a4\u30f3\u30b9\u30ad\u30e3\u30f3\u6642\u306b\u767a\u898b\u3055\u308c\u305f\u3001\u56de\u5fa9\u4e0d\u53ef\u80fd\u306a\u30bb\u30af\u30bf\u306e\u7dcf\u6570\u3002\u3053\u306e\u5024\u304c\u5897\u52a0\u3059\u308b\u5834\u5408\u306f\u3001\u78c1\u6c17\u30c7\u30a3\u30b9\u30af\u306e\u8868\u9762\u306b\u660e\u78ba\u306a\u554f\u984c\u304c\u3042\u308b\u3002 Media Error\u4ee3\u8868\u6247\u533a\u6709\u95ee\u9898\uff0c\u574f\u9053\u7b49\uff1b Other Error\u4ee3\u8868\u78c1\u76d8\u53ef\u80fd\u6709\u677e\u52a8\u3002 Media Error Count: 0 Other Error Count: 0 MegaRAID\u304c\u8a8d\u8b58\u3057\u3066\u3044\u308bHDD\u3092\u5168\u8868\u793a\u3059\u308b\u65b9\u6cd5 \u00b6 $ sudo MegaCli64 -PDList -aALL $ sudo MegaCli64 -CfgDsply -aALL \u2190 RAID\u30ab\u30fc\u30c9\u3082\u8868\u793a\u3059\u308b\u3002 HDD\u3092\u30ea\u30d3\u30eb\u30c9\u3059\u308b\u624b\u9806 \u00b6 1. #\u5bfe\u8c61\u30c7\u30a3\u30b9\u30af\u306e\u30aa\u30d5\u30e9\u30a4\u30f3 /opt/MegaRAID/MegaCli/MegaCli64 -PDOffline -PhysDrv[252:0] -a0 Adapter: 0: EnclId-252 SlotId-0 state changed to OffLine. Exit Code: 0x00 2. #status\u78ba\u8a8d /opt/MegaRAID/MegaCli/MegaCli64 -PDList -a0 | less Firmware state: Offline \u2190\u3000offline\u306b\u306a\u3063\u3066\u308b\u3002 3. #\u5bfe\u8c61\u306e\u30c7\u30a3\u30b9\u30af\u306bmissing mark\u3064\u3051\u308b /opt/MegaRAID/MegaCli/MegaCli64 -PDMarkMissing -PhysDrv[252:0] -a0 EnclId-252 SlotId-0 is marked Missing. Exit Code: 0x00 4. #missing mark\u306e\u3064\u3044\u305fdisk\u306e\u78ba\u8a8d /opt/MegaRAID/MegaCli/MegaCli64 -PDGetMissing -aALL Adapter 0 - Missing Physical drives No. Array Row Size Expected 0 0 0 1907200 MB 5. #\u524a\u9664\u524d\u306e\u6e96\u5099 /opt/MegaRAID/MegaCli/MegaCli64 -PDPrpRmv -PhysDrv[252:0] -a0 Prepare for removal Success Exit Code: 0x00 6. #Missing mark\u306e\u72b6\u614b\u5909\u66f4 /opt/MegaRAID/MegaCli/MegaCli64 -PDReplaceMissing -PhysDrv[252:0] -Array1 -row0 -a0 7. #Rebuild\u30b9\u30bf\u30fc\u30c8 /opt/MegaRAID/MegaCli/MegaCli64 -PDRbld -Start -PhysDrv[252:0] -a0 8. #\u72b6\u614b\u78ba\u8a8d /opt/MegaRAID/MegaCli/MegaCli64 -PDList -a0 | less Firmware state: Rebuild \u2190 rebuild\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u306b\u306a\u3063\u305f 9. #Rebuild\u306e\u72b6\u6cc1\u78ba\u8a8d /opt/MegaRAID/MegaCli/MegaCli64 -PDRbld -showprog -physdrv[252:0] -a0 Rebuild Progress on Device at Enclosure 252, Slot 0 Completed 4% in 11 Minutes. Exit Code: 0x00 RAID\u304c\u5197\u9577\u306b\u306a\u3063\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5 \u00b6 $ sudo MegaCli64 -LDInfo -Lall -aALL $ sudo MegaCli64 -LDInfo -Lall -aALL | grep -i state \u2460\u25c6 State: Optimal \u3092\u78ba\u8a8d for i in $(sudo /usr/local/sbin/MegaCli -PDList -aALL -NoLog | grep 'Device Id' | awk '{ print $NF }') ; do echo \"===== Device Id $i =====\" ; sudo /usr/sbin/smartctl -a -d sat+megaraid,$i /dev/sda | egrep ' ^(Ser| [15]|19[78]|#)' ; echo ; done Display Virtual Drive Information \u00b6 root@www101v:~# MegaCli64 -LDInfo -Lall -aALL Adapter 0 -- Virtual Drive Information: Virtual Disk: 0 (Target Id: 0) Name: RAID Level: Primary-1, Secondary-0, RAID Level Qualifier-0 Size:931.0 GB State: Degraded <-- \u3053\u3053 Stripe Size: 64 KB Number Of Drives:2 Span Depth:1 Default Cache Policy: WriteBack, ReadAheadNone, Cached, Write Cache OK if Bad BBU Current Cache Policy: WriteBack, ReadAheadNone, Cached, Write Cache OK if Bad BBU Access Policy: Read/Write Disk Cache Policy: Enabled Encryption Type: None Bad Blocks Exist: No Exit Code: 0x00 Display Drive Information \u00b6 root@www101v:~# MegaCli64 -PDList -aALL Adapter #0 Enclosure Device ID: 252 Slot Number: 0 Device Id: 2 Sequence Number: 2 Media Error Count: 0 Other Error Count: 0 Predictive Failure Count: 0 Last Predictive Failure Event Seq Number: 0 PD Type: SATA Raw Size: 931.512 GB [0x74706db0 Sectors] Non Coerced Size: 931.012 GB [0x74606db0 Sectors] Coerced Size: 931.0 GB [0x74600000 Sectors] Firmware state: Online, Spun Up SAS Address(0): 0x4433221103000000 Connected Port Number: 0(path0) Inquiry Data: WD-WMATV5217983WDC WD1002FBYS-50A6B0 03.00C09 FDE Capable: Not Capable FDE Enable: Disable Secured: Unsecured Locked: Unlocked Foreign State: None Device Speed: 3.0Gb/s Link Speed: 3.0Gb/s Media Type: Hard Disk Device Drive: Not Certified Rebuild \u9032\u6357\u78ba\u8a8d \u00b6 \u9759\u7684 root@www101v:~# MegaCli64 -PDRbld -ShowProg -PhysDrv[252:1] -aALL Rebuild Progress on Device at Enclosure 252, Slot 1 Completed 16% in 24 Minutes. Exit Code: 0x00 Real Time root@www101v:~# MegaCli64 -PDRbld -ProgDsply -PhysDrv[252:1] -aALL Rebuild progress of physical drives... Enclosure:Slot Percent Complete Time Elps 252 :01 ########***************17 %*********************** 00:26:56 Press <ESC> key to quit... \u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u65b9\u6cd5 \u00b6 RAID\u30ab\u30fc\u30c9\u306e\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u8a2d\u5b9a \uff1cWrite \u30b9\u30eb\u30fc\uff1e MegaCli -LDSetProp WT -Lall -Aall \uff1cWrite \u30d0\u30c3\u30af\uff1e MegaCli -LDSetProp WB -Lall -Aall RAID\u30ab\u30fc\u30c9\u306e\u8aad\u307f\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u8a2d\u5b9a \uff1cNo read ahead\uff1e MegaCli -LDSetProp NORA -Lall -Aall \uff1cRead ahead\uff1e MegaCli -LDSetProp RA -Lall -Aall \uff1cAdaptive read ahead\uff1e MegaCli -LDSetProp ADRA -Lall -Aall RAID\u30ab\u30fc\u30c9\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30dd\u30ea\u30b7\u30fc\u306e\u8a2d\u5b9a \uff1cChached\uff1e MegaCli -LDSetProp -Cached -Lall -aALL \uff1cDirect\uff1e MegaCli -LDSetProp -Direct -Lall -aALL BBU\u30e6\u30cb\u30c3\u30c8\u304c\u4e0d\u826f\u306e\u5834\u5408\u306b\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u4f7f\u3046\u304b\u3069\u3046\u304b \uff1cCachedBadBBU\uff1a\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u6709\u52b9\uff1e MegaCli -LDSetProp -CachedBadBBU -Lall -Aall \uff1cNoCachedBadBBU\uff1a\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u7121\u52b9\uff1e MegaCli -LDSetProp -NoCachedBadBBU -Lall -Aall \u30c9\u30e9\u30a4\u30d6\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u6709\u52b9\u306b\u3059\u308b\u304b\u3069\u3046\u304b \uff1cEnables drive cache\uff1a\u6709\u52b9\uff1e MegaCli -LDSetProp -EnDskCache -Lall -Aall \uff1cDisables drive cache\uff1a\u7121\u52b9\uff1e MegaCli -LDSetProp -DisDskCache -Lall -Aall \u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u78ba\u8a8d\u65b9\u6cd5 RAID\u30ab\u30fc\u30c9\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u78ba\u8a8d # MegaCli -LDGetProp -Cache -Lall -aALL Adapter 0-VD 0(target id: 0): Cache Policy:WriteThrough, ReadAheadNone, Direct, No Write Cache if bad BBU Exit Code: 0x00 \u30c9\u30e9\u30a4\u30d6\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u78ba\u8a8d # MegaCli -LDGetProp -DskCache -Lall -aALL Adapter 0-VD 0(target id: 0): Disk Write Cache : Disabled Exit Code: 0x00 Fwtermlog\u3092\u8868\u793a\u3059\u308b\u65b9\u6cd5 | grep Rebuild \u00b6 [iadmin@xxxx ~]$ sudo MegaCli64 -Fwtermlog -Dsply -aall | grep Rebuild T5: disableAutoRebuild=0, disableBatteryWarning=0, eccBucketSize=ff 02/01/15 6:05:01: EVT#02934-02/01/15 6:05:01: 106=Rebuild automatically started on PD 01(e0x20/s1) 02/01/15 6:05:03: prDiskCheckOkToRun: PR cannot run on this pd=0 since this array=1 has a PD in REBUILD state Rebuilding 02/01/15 7:43:01: EVT#02936-02/01/15 7:43:01: 103=Rebuild progress on PD 01(e0x20/s1) is 0.99%(5880s) 02/01/15 9:21:28: EVT#02937-02/01/15 9:21:28: 103=Rebuild progress on PD 01(e0x20/s1) is 1.99%(11787s) 02/01/15 10:59:38: EVT#02938-02/01/15 10:59:38: 103=Rebuild progress on PD 01(e0x20/s1) is 2.99%(17677s) 02/01/15 12:37:13: EVT#02939-02/01/15 12:37:13: 103=Rebuild progress on PD 01(e0x20/s1) is 3.99%(23532s) 02/01/15 14:15:49: EVT#02940-02/01/15 14:15:49: 103=Rebuild progress on PD 01(e0x20/s1) is 4.99%(29448s) 02/01/15 15:54:18: EVT#02941-02/01/15 15:54:18: 103=Rebuild progress on PD 01(e0x20/s1) is 5.99%(35357s) 02/01/15 17:31:16: EVT#02942-02/01/15 17:31:16: 103=Rebuild progress on PD 01(e0x20/s1) is 6.99%(41175s) 02/01/15 19:07:32: EVT#02943-02/01/15 19:07:32: 103=Rebuild progress on PD 01(e0x20/s1) is 7.99%(46951s) 02/01/15 20:44:02: EVT#02944-02/01/15 20:44:02: 103=Rebuild progress on PD 01(e0x20/s1) is 8.99%(52741s) 02/01/15 22:20:47: EVT#02945-02/01/15 22:20:47: 103=Rebuild progress on PD 01(e0x20/s1) is 9.99%(58546s) 02/01/15 23:57:46: EVT#02946-02/01/15 23:57:46: 103=Rebuild progress on PD 01(e0x20/s1) is 10.99%(64365s) 02/02/15 1:35:11: EVT#02947-02/02/15 1:35:11: 103=Rebuild progress on PD 01(e0x20/s1) is 11.99%(4674s) 02/02/15 3:12:39: EVT#02948-02/02/15 3:12:39: 103=Rebuild progress on PD 01(e0x20/s1) is 12.99%(10522s) 02/02/15 4:49:15: EVT#02949-02/02/15 4:49:15: 103=Rebuild progress on PD 01(e0x20/s1) is 13.99%(16318s) 02/02/15 6:26:01: EVT#02950-02/02/15 6:26:01: 103=Rebuild progress on PD 01(e0x20/s1) is 14.99%(22124s) 02/02/15 8:02:22: EVT#02951-02/02/15 8:02:22: 103=Rebuild progress on PD 01(e0x20/s1) is 15.99%(27905s) 02/02/15 9:39:34: EVT#02952-02/02/15 9:39:34: 103=Rebuild progress on PD 01(e0x20/s1) is 16.99%(33737s) 02/02/15 11:16:58: EVT#02953-02/02/15 11:16:58: 103=Rebuild progress on PD 01(e0x20/s1) is 17.99%(39581s) 02/02/15 12:54:33: EVT#02954-02/02/15 12:54:33: 103=Rebuild progress on PD 01(e0x20/s1) is 18.98%(45436s) 02/02/15 14:24:59: EVT#02955-02/02/15 14:24:59: 103=Rebuild progress on PD 01(e0x20/s1) is 19.98%(50862s) 02/02/15 16:02:28: EVT#02956-02/02/15 16:02:28: 103=Rebuild progress on PD 01(e0x20/s1) is 20.98%(56711s) 02/02/15 17:39:07: EVT#02957-02/02/15 17:39:07: 103=Rebuild progress on PD 01(e0x20/s1) is 21.98%(62510s) \"^Slot Number|^Firmware state|^Inquiry Data|^Raw Size|^Device Id\" \u3092\u8868\u793a\u3059\u308b \u00b6 root@ubuntu14:/home/lyvivian# megacli -PDList -aALL | egrep \"^Slot Number|^Firmware state|^Inquiry Data|^Raw Size|^Device Id\" Slot Number: 0 Device Id: 6 Raw Size: 465.761 GB [0x3a386030 Sectors] Firmware state: Online, Spun Up Inquiry Data: S313J9FF103173 ST500LM012 HN-M500MBB 2BA30010 Slot Number: 1 Device Id: 5 Raw Size: 29.843 GB [0x3bb0000 Sectors] Firmware state: Online, Spun Up Inquiry Data: 00257465041E TS32GSSD25S-M V090216 Slot Number: 2 Device Id: 4 Raw Size: 298.090 GB [0x2542eab0 Sectors] Firmware state: Online, Spun Up Inquiry Data: WD-WXE508HD9898WDC WD3200BEVT-75ZCT1 11.01A11 Slot Number: 3 Device Id: 11 Raw Size: 59.625 GB [0x7740ab0 Sectors] Firmware state: Online, Spun Up Inquiry Data: 0000000011210310A638M4-CT064M4SSD2 000F Slot Number: 4 Device Id: 7 Raw Size: 1.819 TB [0xe8e088b0 Sectors] Firmware state: Online, Spun Up Inquiry Data: WD-WCC1T0228569WDC WD20EZRX-00DC0B0 80.00A80 Slot Number: 5 Device Id: 9 Raw Size: 1.819 TB [0xe8e088b0 Sectors] Firmware state: Online, Spun Up Inquiry Data: WD-WMC301755889WDC WD20EZRX-00DC0B0 80.00A80 Slot Number: 6 Device Id: 8 Raw Size: 1.819 TB [0xe8e088b0 Sectors] Firmware state: Online, Spun Up Inquiry Data: WD-WMC301755597WDC WD20EZRX-00DC0B0 80.00A80 Slot Number: 7 Device Id: 10 Raw Size: 1.819 TB [0xe8e088b0 Sectors] Firmware state: Online, Spun Up Inquiry Data: WD-WMC301744569WDC WD20EZRX-00DC0B0 80.00A80 root@ubuntu14:/home/lyvivian# Usage \u00b6 # cd /opt/MegaRAID/storcli # ./storcli64 information about every controller ./storcli64 show informations to selected controller and its configuration ./storcli64 /c0 show informations to the available hard drives and their current state (Serial Number, temperature ) ./storcli64 /c0 /eall /sall show [all] informations to the available virtual drives and their current state. ./storcli64 /c0 /vall show [all] show the progress of ongoing rebuilds ./storcli64 /c0 /eall /sall show rebuild create a RAID 1 ./storcli64 /c0 add vd type=raid1 size=10gb names=tmp1 drives=0:2-3 create a RAID 5 ./storcli64 /c0 add vd type=raid5 size=10gb names=tmp1 drives=0:2-6 create a RAID 6 ./storecli64 /c0 add vd type=raid6 size=10gb names=tmp1 drives=0:2-7 create a RAID 10 ./storecli64 /c0 add vd type=raid10 size=2gb,3gb,4gb names=tmp1,tmp2,tmp3 drives=0:2-3,5,7 pdperarray=2 Manual \u00b6 There is a manual with all the usable parameters provided by avagotech (the succsessor of the producer LSI) to be found here. controller overview in detail \u00b6 information regarding every controller ./storecli64 show ``` # ./storcli64 show ... SNIPP ... System Overview : =============== Ctl Model Ports PDs DGs DNOpt VDs VNOpt BBU sPR DS EHS ASOs Hlth 0 Intel(R)IntegratedRAIDModuleRMS25CB080 8 2 1 0 1 0 Opt On 1&2 Y 3 Opt ``` configuration overview \u00b6 information regarding the selected controller and its configuration ./storecli64 /c0 show ``` # ./storcli64 /c0 show Generating detailed summary of the adapter, it may take a while to complete. ... SNIPP ... Product Name = Intel(R) Integrated RAID Module RMS25CB080 Serial Number = QSIP23600494 SAS Address = 5001e6756eda0000 PCI Address = 00:05:00:00 System Time = 01/25/2016 14:34:15 Mfg. Date = 09/07/12 Controller Time = 01/25/2016 13:34:14 FW Package Build = 23.12.0-0013 BIOS Version = 5.42.00_4.12.05.00_0x05270000 FW Version = 3.240.25-2382 Driver Name = megaraid_sas Driver Version = 06.805.06.01-rc1 Vendor Id = 0x1000 Device Id = 0x5B SubVendor Id = 0x8086 SubDevice Id = 0x3513 Host Interface = PCI-E Device Interface = SAS-6G Bus Number = 5 Device Number = 0 Function Number = 0 Drive Groups = 1 TOPOLOGY : ======== DG Arr Row EID:Slot DID Type State BT Size PDC PI SED DS3 FSpace 0 - - - - RAID1 Optl N 930.390 GB dflt N N none N 0 0 - - - RAID1 Optl N 930.390 GB dflt N N none N 0 0 0 252:0 8 DRIVE Onln N 930.390 GB dflt N N none - 0 0 1 252:1 9 DRIVE Onln N 930.390 GB dflt N N none - ... SNIPP ... Virtual Drives = 1 VD LIST : ======= DG/VD TYPE State Access Consist Cache Cac sCC Size Name 0/0 RAID1 Optl RW No RWBC - ON 930.390 GB ... SNIPP ... Physical Drives = 2 PD LIST : ======= EID:Slt DID State DG Size Intf Med SED PI SeSz Model Sp 252:0 8 Onln 0 930.390 GB SATA HDD N N 512B WDC WD1000CHTZ-04JCPV1 U 252:1 9 Onln 0 930.390 GB SATA HDD N N 512B WDC WD1000CHTZ-04JCPV1 U ... SNIPP ... Cachevault_Info : =============== Model State Temp Mode MfgDate Next Learn CVPM02 Optimal 23C - 2012/12/19 2016/02/22 13:07:20 ``` Information regarding the disks \u00b6 Information regarding the available disks and their current state (serial number,temperature etc.) # ./storecli64 /c0 /eall /sall show all Controller = 0 Status = Success Description = Show Drive Information Succeeded. Drive /c0/e252/s0 : ================= ------------------------------------------------------------------------------- EID:Slt DID State DG Size Intf Med SED PI SeSz Model Sp ------------------------------------------------------------------------------- 252:0 8 Onln 0 930.390 GB SATA HDD N N 512B WDC WD1000CHTZ-04JCPV1 U ------------------------------------------------------------------------------- ... SNIPP ... Drive /c0/e252/s0 - Detailed Information : ======================================== Drive /c0/e252/s0 State : ======================= Shield Counter = 0 Media Error Count = 0 Other Error Count = 0 BBM Error Count = 0 Drive Temperature = 29C (84.20 F) Predictive Failure Count = 0 S.M.A.R.T alert flagged by drive = No Drive /c0/e252/s0 Device attributes : =================================== SN = WD-WXS1E64JNL0D Manufacturer Id = ATA Model Number = WDC WD1000CHTZ-04JCPV1 NAND Vendor = NA WWN = 50014ee65a68f4c4 Firmware Revision = 04.06A01 Raw size = 931.512 GB [0x74706db0 Sectors] Coerced size = 930.390 GB [0x744c8000 Sectors] Non Coerced size = 931.012 GB [0x74606db0 Sectors] Device Speed = 6.0Gb/s Link Speed = 6.0Gb/s NCQ setting = N/A Write cache = N/A Logical Sector Size = 512B Physical Sector Size = 4 KB Connector Name = Port 0 - 3 x1 Drive /c0/e252/s0 Policies/Settings : =================================== Drive position = DriveGroup:0, Span:0, Row:0 Enclosure position = 0 Connected Port Number = 0(path0) Sequence Number = 2 Commissioned Spare = No Emergency Spare = No Last Predictive Failure Event Sequence Number = 0 Successful diagnostics completion on = N/A SED Capable = No SED Enabled = No Secured = No Locked = No Needs EKM Attention = No PI Eligible = No Certified = No Wide Port Capable = No Port Information : ================ ----------------------------------------- Port Status Linkspeed SAS address ----------------------------------------- 0 Active 6.0Gb/s 0x4433221100000000 ----------------------------------------- Inquiry Data = 7a 42 ff 3f 37 c8 10 00 00 00 00 00 3f 00 00 00 00 00 00 00 20 20 20 20 57 20 2d 44 58 57 31 53 36 45 4a 34 4c 4e 44 30 00 00 00 00 00 00 34 30 30 2e 41 36 31 30 44 57 20 43 44 57 30 31 30 30 48 43 5a 54 30 2d 4a 34 50 43 31 56 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 10 80 00 40 00 2f 01 40 00 00 00 00 07 00 ff 3f 10 00 3f 00 10 fc fb 00 00 01 ff ff ff 0f 00 00 07 00 Drive /c0/e252/s1 : ================= ------------------------------------------------------------------------------- EID:Slt DID State DG Size Intf Med SED PI SeSz Model Sp ------------------------------------------------------------------------------- 252:1 9 Onln 0 930.390 GB SATA HDD N N 512B WDC WD1000CHTZ-04JCPV1 U ------------------------------------------------------------------------------- ... SNIPP ... Drive /c0/e252/s1 - Detailed Information : ======================================== Drive /c0/e252/s1 State : ======================= Shield Counter = 0 Media Error Count = 0 Other Error Count = 0 BBM Error Count = 0 Drive Temperature = 28C (82.40 F) Predictive Failure Count = 0 S.M.A.R.T alert flagged by drive = No Drive /c0/e252/s1 Device attributes : =================================== SN = WD-WXT1E64TZEFP Manufacturer Id = ATA Model Number = WDC WD1000CHTZ-04JCPV1 NAND Vendor = NA WWN = 50014ee6afbe6dc0 Firmware Revision = 04.06A01 Raw size = 931.512 GB [0x74706db0 Sectors] Coerced size = 930.390 GB [0x744c8000 Sectors] Non Coerced size = 931.012 GB [0x74606db0 Sectors] Device Speed = 6.0Gb/s Link Speed = 6.0Gb/s NCQ setting = N/A Write cache = N/A Logical Sector Size = 512B Physical Sector Size = 4 KB Connector Name = Port 0 - 3 x1 Drive /c0/e252/s1 Policies/Settings : =================================== Drive position = DriveGroup:0, Span:0, Row:1 Enclosure position = 0 Connected Port Number = 1(path0) Sequence Number = 2 Commissioned Spare = No Emergency Spare = No Last Predictive Failure Event Sequence Number = 0 Successful diagnostics completion on = N/A SED Capable = No SED Enabled = No Secured = No Locked = No Needs EKM Attention = No PI Eligible = No Certified = No Wide Port Capable = No Port Information : ================ ----------------------------------------- Port Status Linkspeed SAS address ----------------------------------------- 0 Active 6.0Gb/s 0x4433221101000000 ----------------------------------------- Description MegaCLI Command StorCLI Command Real StorCLI Example System Commands Show the software version. MegaCLI -v storcli -v storcli -v Show help information. MegaCLI -help|-h|? storcli -help|-h|? storcli -h Show the number of controllers connected MegaCLI -adpCount storcli show ctrlcount storcli show ctrlcount Controller Commands Show the status of properties related to the controllers. MegaCli -AdpGetProp <PropertyName>-aN|-a0,1,2|-aALL The following properties can be used with this command: abortcconerror alarmdsply autodetectbackplanedsbl autoenhancedimportdsply autosnapshotspace batwarndsbl bgirate bootwithpinnedcache cachebypass ccrate clusterenable coercionmode copybackdsbl defaultldpspolicy defaultsnapshotspace defaultviewspace disableldpsinterval disableldpstime disableocr dsbl eccbucketcount eccbucketleakrate eccbucketsize enableeghsp enableesmarter enableeug| enablejbod enblspindownunconfigdrvs loadbalancemode maintainpdfailhistoryenbl ncqdsply patrolreadrate perfmode predfailpollinterval rebuildrate reconrate rstrhotspareoninsert smartcpybkenbl spindowntime spinupdelay spinupdrivecount spinupencdelay /cx show <propertyName> The following properties can be used with this command: activityforlocate alarm backplane batterywarning bgirate bootwithpinnedcache cachebypass cacheflushint cc ccrate clusterenable coercion copyback directpdmapping ds eccbucketleakrate eccbucketsize enableeghsp enableesmarter enableeug exposeencldevice jbod loadbalancemode maintainpdfailhistory migraterate ncq perfmode pr prcorrectunconfiguredareas prrate rebuildrate rehostinfo restorehotspare safeid smartpollinterval spinupdelay spinupdrivecount stoponerror time usefdeonlyencrypt storcli /c0 show activityforlocate storcli /c0 show alarm storcli /c0 show backplane storcli /c0 show batterywarning storcli /c0 show bgirate storcli /c0 show bootwithpinnedcache storcli /c0 show cachebypass storcli /c0 show cacheflushint storcli /c0 show cc storcli /c0 show ccrate storcli /c0 show clusterenable storcli /c0 show coercion storcli /c0 show copyback Show the status of properties related to the controllers (continued). spinupencdrvcnt ssdsmartcpybkenbl usediskactivityforlocate usefdeonlyencrypt None Set properties on the selected controllers. Megacli -AdpSetProp <propertyname>-an|-a0,1,2|-aall The following properties can be set using this command: abortcconerror alarmdsply autodetectbackplanedsbl autoenhancedimportdsply autosnapshotspace batwarndsbl bgirate bootwithpinnedcache cachebypass ccrate clusterenable coercionmode copybackdsbl defaultldpspolicy defaultsnapshotspace defaultviewspace disableldpsinterval disableldpstime disableocr dsbl eccbucketcount eccbucketleakrate eccbucketsize enableeghsp enableesmarter enableeug| enablejbod enblspindownunconfigdrvs loadbalancemode maintainpdfailhistoryenbl ncqdsply patrolreadrate perfmode predfailpollinterval rebuildrate reconrate rstrhotspareoninsert smartcpybkenbl spindowntime spinupdelay spinupdrivecount spinupencdelay /cx set <property1> The following properties can be set using this command: abortcconerror=<on|off> activityforlocate=<on|off> alarm=<value> autorebuild=<on|off> backplane=<value> batterywarning=<on|off> bgirate=<value> bootwithpinnedcache=<on|off> cachebypass=<on|off> flush|flushcache cacheflushinterval=<value> ccrate=<value> coercion=<value> clusterenable=<value> copyback=<on|off> type=<smartssd|smarthdd|all> dimmerswitch=<on|off> directpdmapping=<enable|disable> eccbucketleakrate=<value> eccbucketsize=<value> enableeghsp=<value> enableesmarter=<value> enableeug=<value> exposeencldevice=<on|off> foreignautoimport=<on|off> jbod=<on|off> loadbalancemode=<value> maintainpdfailhistory=<on|off> migraterate=<value> ncq=<on|off> perfmode=<value> prcorrectunconfiguredareas=<on|off> prrate=<value> rebuildrate=<value> restorehotspare=<on|off> smartpollinterval=<value> spinupdelay=<value> spinupdrivecount=<value> stoponerror=<on|off> usefdeonlyencrypt=<on|off> time=yyyymmdd hh:mm:ss|systemtime usefdeonlyencrypt=<on|off> /c0 set abortcconerror=on Set properties on the selected controllers. autocarve=<on|off> autodetect=<on|off > disk=<p:-p>|all autorebuild=<on|off> carvesize=<1024..32768> dpmstat=<on|off> ondegrade=<cacheoff|follow> rebuild=<enable|disable|><1..5> rebuildmode=<adaptive|lowlatency> rebuildrate=<1..5> selftest=<enable|disable> spinup=<value> stagger=<value> verify=advanced|basic|<1..5> verify=basic [pref=ddd:hh]where hh={00..23} and ddd={mon|tue|wed|thu|fri|sat|sun} verify=enable|disable|<1..5> verifymode=<adaptive|lowlatency> verifyrate=<1..5> spinupencdrvcnt sdsmartcpybkenbl usediskactivityforlocate usefdeonlyencrypt abortcconerror=<on|off> activityforlocate=<on|off> alarm=<value> autorebuild=<on|off> backplane=<value> batterywarning=<on|off> bgirate=<value> bootwithpinnedcache=<on|off> cachebypass=<on|off> flush|flushcache cacheflushinterval=<value> ccrate=<value> coercion=<value> clusterenable=<value> copyback=<on|off> type=<smartssd|smarthdd|all> directpdmapping=<enable|disable> eccbucketleakrate=<value> eccbucketsize=<value> enableeghsp=<value> enableesmarter=<value> enableeug=<value> exposeencldevice=<on|off> foreignautoimport=<on|off> jbod=<on|off> loadbalancemode=<value> maintainpdfailhistory=<on|off> migraterate=<value> ncq=<on|off> perfmode=<value> prcorrectunconfiguredareas=<on|off> prrate=<value> rebuildrate=<value> restorehotspare=<on|off> smartpollinterval=<value> spinupdelay=<value> spinupdrivecount=<value> stoponerror=<on|off> usefdeonlyencrypt=<on|off> time=yyyymmdd hh:mm:ss|systemtime usefdeonlyencrypt=<on|off> Show the number of controllers connected. MegaCLI -adpCount storcli show ctrlcount storcli show ctrlcount Show all information about the adapter, such as cluster state, BIOS, alarm, firmware, version, and so on. MegaCli -AdpAllInfo -aN|-a0,1,2|-aALL storcli /cx show all storcli /c0 show all Show the freespace available in the controller. MegaCLI -CfgFreeSpaceinfo -aN|-a0,1,2|-aALL storcli /cx show freespace storcli /c0 show freespace Download the controller firmware MegaCli -AdpFwFlash -f filename [-NoSigChk] [-NoVerChk] -aN|-a0,1,2|-aALL storcli /cx download file=<filepath> [fwtype=<val>] [nosigchk] [noverchk] storcli /c0 download file=mr2208.rom Show the preserved cache status. MegaCLI-GetPreservedCacheList -aN|-a0,1,2|-aALL storcli /cx show preservedcache storcli /c0 show preservedcache Set the controller time MegaCLI \u2013AdpSetTime yyyymmdd hh:mm:ss -aN|-a0,1,2|-aALL storcli /c(x|all) set time=<yyyymmdd hh:mm:ss | systemtime> storcli /c0 set time=systemtime Show the controller time. MegaCLI \u2013AdpGetTime -aN storcli /cx show time storcli /c0 show time RAID Configuration commands Create a RAID configuration of RAID type 0, 1, 5, and 6. MegaCli \u2013CfgLDAdd -R0|-R1|-R5|-R6[E0:S0,E1:S1,...] [WT | WB] [NORA | RA | ADRA] [Direct | Cached] [CachedBadBBU|NoCachedBadBBU] [-szXXXXXXXX [-szYYYYYYYY [... ]]] [-strpszM] [\u2013Hsp[E5:S5,...]] [\u2013afterLdX] -aN storcli /cx add vd type=raid[0|1|5|6] [Size=<VD1_Sz>,<VD2_Sz>,..|*all] [name=<VDNAME1>,..] drives=e:s|e:s-x|e:s-x,y;e:s-x,y,z [PDperArray=x] [SED] [pdcache=on|off|*default][pi] [DimmerSwitch(ds)=default|automatic (auto)|*none|maximum(max) |MaximumWithoutCaching(maxnocache)] [wt|*wb] [nora|*ra] [*direct|cached] [CachedBadBBU|*NoCachedBadBBU] [Stripe=<8|16|32|64|128|256|512|102 4] [AfterVd=X] [Spares=[e:]s|[e:]s-x|[e:]s-x,y] [force] storcli /c0 add vd type=road1 drives=252:0,252:1 (hint: use storcli /c0 show to view available enclosure/slot e:s drives) Create a CacheCade virtual drive MegaCLI -CfgCacheCadeAdd [-rX] -Physdrv[E0:S0,...] {-Name LdNamestring} [WT|WB|ForcedWB] [-assign -LX|L0,2,5..|LALL] -aN|-a0,1,2|-Aall storcli /cx add VD cachecade|cc Type=[0,1,10] drives=[e:]s|[e:]s-x|[e:]s-x,y [ < WT| WB> ] [assignvds=0,1,2] storcli /c0 add vd type=road1 drives=252:2,252:3 Create a RAID configuration of RAID type 10, 50, and 60. MegaCli \u2013CfgSpanAdd -aN|-a0,1,2|-aALL -R10|-R50|R60 \u2013Array0[E0:S0,E1:S1,...] \u2013Array1[E0:S0,E1:S1,...] [...] [WT | WB] [NORA | RA | ADRA] [Direct | Cached] [CachedBadBBU|NoCachedBadBBU] [-szXXXXXXXX [-szYYYYYYYY [... ]]] [-strpszM] [\u2013afterLdX] -aN storcli /cx add vd type=raid[10|50|60] [Size=<VD1_Sz>,<VD2_Sz>,..|*all] [name=<VDNAME1>,..] drives=e:s|e:s-x|e:s-x,y;e:s-x,y,z [PDperArray=x] [SED] [pdcache=on|off|*default][pi] [DimmerSwitch(ds)=default|automatic (auto)|*none|maximum(max) |MaximumWithoutCaching(maxnocache)] [wt|*wb] [nora|*ra] [*direct|cached] [CachedBadBBU|*NoCachedBadBBU] [Stripe=<8|16|32|64|128|256|512|102 4] [AfterVd=X] [Spares=[e:]s|[e:]s-x|[e:]s-x,y] [force] Delete a virtual drive MegaCli -CfgClr [-Force] -aN|-a0,1,2|-aALL storcli /cx/vx delete or storcli /cx/vall (to delete all virtual drives) storcli /c0/v0 delete (warning: there is no warning given; using /c0/vall will delete all logical drives and data with no warning) Show the topology information of the drive group MegaCLI -CfgDsply -aN|-a0,1,2|-Aall storcli /cx/dall show [all] storcli /cx0/d0 show Show information for a CacheCade virtual drive MegaCLI -CfgCacheCadeDsply -aN|-a0,1,2|-Aall storcli /cx/dall show CacheCade(cc) storcli /cx0/d0 show cc Delete a virtual drive hosting the operating system MegaCLI -CfgLdDel -LX|-L0,2,5...|-LALL [-Force] -aN|-a0,1,2|-aALL storcli /cx/vx[all] delete -force storcli /c0/v0 del -force Delete a CacheCade virtual drive MegaCLI -CfgCacheCadeDel -LX|-L0,2,5...|-LALL -aN|-a0,1,2|-Aall storcli /cx/vx[all] delete CacheCade(cc) storcli /c0/vx del cc Show, delete, and import the foreign configuration commands. MegaCli \u2013CfgForeign \u2013Scan | {-Preview | \u2013Dsply| -Import | -Clear[FID]} -aN|-a0,1,2|-aALL\" storcli /cx/f(x|all) show [all] [securityKey=xxx] storcli /cx/f(x|all) del|delete [securityKey=xxx] storcli /cx/f(x|all) import [preview] [securityKey=xxx]\" storcli /c0/fall show Patrol Read Commands Show the patrol read status and patrol read parameters, if any in progress. MegaCli -AdpPR -info -aN|-a0,1,2|-aALL /cx show patrolRead /c0 show patrolread Set the patrol read options on a single adapter, multiple adapters, or all adapters (x = single controller). MegaCli -AdpPR \u2013Dsbl|EnblAuto|EnblMan|Start|Stop| Info|Suspend|Resume|Stop| SSDPatrolReadEnbl | SSDPatrolReadDsbl |{SetDelay Val}|{-SetStartTime yyyymmdd hh}|{maxConcurrentPD Val} -aN|-a0,1,2|-aALL /cx set patrolread {=on mode=<auto|manual>}|{off} /cx set patrolread [starttime=< yyyy/mm/dd hh>] [maxconcurrentpd=<value>] [includessds=<on|off>] [uncfgareas=on|off] /cx set patrolread delay=<value> /c0 set patrolread mode=manual Disable patrol read. MegaCli -AdpPR -Dsbl -aN|-a0,1,2|-aALL storcli /cx set patrolread=off storcli /c0 set patrolread=off Enable automatic patrol read. MegaCli -AdpPR -EnblAuto -aN|-a0,1,2|-aALL storcli /cx set patrolread=on mode=auto storcli /cx set patrolread=off mode=auto Enable manual patrol read. MegaCli -AdpPR -EnblMan -aN|-a0,1,2|-aALL storcli /cx set patrolread=on mode=manual storcli /c0 set patrolread=on mode=manual Start patrol read. MegaCli -AdpPR -Start -aN|-a0,1,2|-aALL storcli /cx start patrolRead storcli /c0 start patrolRead Suspend a running patrol read MegaCli -AdpPR -Suspend -aN|-a0,1,2|-aALL storcli /cx suspend patrolread storcli /c0 suspend patrolread Resume a suspended patrol read MegaCli -AdpPR -Resume -aN|-a0,1,2|-aALL storcli /cx resume patrolread storcli /c0 resume patrolread Stop a running patrol read MegaCli -AdpPR -Stop -aN|-a0,1,2|-aALL storcli /cx stop patrolRead storcli /c0 stop patrolRead Include SSD drives in patrol read MegaCli -AdpPR -SSDPatrolReadEnbl -aN|-a0,1,2|-aALL storcli /cx set patrolRead includessds=on | onlymixed storcli /c0 set patrolRead includessds=on Exclude SSD drives in patrol read MegaCli -AdpPR -SSDPatrolReadDsbl -aN|-a0,1,2|-aALL storcli /cx set patrolRead includessds=off storcli /c0 set patrolRead includessds=off Delay a patrol read MegaCli -AdpPR -SetDelay Val -aN|-a0,1,2|-aALL storcli /cx set patrolread delay=<value> note: <value> unit of time is in hours storcli /c0 set patrolread delay=1 Schedule a patrol read MegaCli -AdpPR -SetStartTime yyyymmdd hh -aN|-a0,1,2|-aALL storcli /cx set patrolread=on starttime=YYYY/MM/DD HH Set the value for maximum concurrent physical drives for the patrol read. MegaCli -AdpPR -maxConcurrentPD Val -aN|-a0,1,2|-aALL storcli /cx set patrolread maxconcurrentpd=xx storcli /c0 set patrolread maxconcurrentpd=255 Consistency Check Commands Schedule a consistency check MegaCLI -AdpCcSched -Dsbl|-Info| {-ModeConc | -ModeSeq [-ExcludeLD -LN|-L0,1,2] [-SetStartTime yyyymmdd hh ] [-SetDelay val ] } -aN|-a0,1,2|-aALL storcli /cx set consistencycheck|cc=[off|seq|conc] [delay=value] starttime=yyyy/mm/dd hh [excludevd=x-y,z] storcli /c0 set cc=off Show consistency check status and consistency parameters, in progress, if any. MegaCLI -AdpCcSched -Info storcli /cx show cc/ConsistencyCheck storcli /c0 show cc OPROM BIOS Commands Schedule a consistency check MegaCli -AdpBIOS -Dsply -aN|-a0,1,2|-aALL storcli /cx show bios storcli /c0 show bios Show consistency check status and consistency parameters, if any in progress. MegaCli -AdpBootDrive -{-Set {-Lx | -physdrv[E0:S0]}} -aN|-a0,1,2|-aALL storcli /cx/ex/sx set bootdrive=on|off storcli /cx/vx set bootdrive=on|off storcli /c0/v0 set bootdrive=on Sets the BIOS properties for the controller. MegaCli -AdpBIOS -Enbl | -Dsbl | -Dsply | SOE | BE EnblAutoSelectBootLd | DsblAutoSelectBootLd -aN|-a0,1,2|-aALL storcli /cx set bios=<on|off> storcli /cx set stoponerror|soe=<on|off> storcli /cx set autobootselect(abs)=<on|off> storcli /c0 set bios=on Battery (BBU) Commands Show battery-related information MegaCli -AdpBbuCmd -aN|-a0,1,2|-aALL storcli /cx/bbu show storcli /cx/bbu show all storcli /c0/bbu show Show the battery learn properties MegaCli -AdpBbuCmd -GetBbuProperties -aN|-a0,1,2|-aALL storcli /cx/bbu show properties storcli /c0/bbu show properties Show the battery information, firmware status, and the gas gauge status. MegaCli -AdpBbuCmd -GetBbuStatus -aN|-a0,1,2|-aALL storcli /cx/bbu show status storcli /c0/bbu show status Show battery capacity information MegaCli -AdpBbuCmd -GetBbuCapacityInfo -aN|-a0,1,2|-aALL storcli /cx/bbu show all storcli /c0/bbu show all Show battery design information MegaCli -AdpBbuCmd -GetBbuDesignInfo -aN|-a0,1,2|-aALL storcli /cx/bbu show all storcli /c0/bbu show all Set battery properties MegaCli -AdpBbuCmd -SetBbuProperties -f <fileName> -aN|-a0,1,2|-aALL storcli /cx/bbu set learnDelayInterval=<value> storcli /cx/bbu set bbuMode=<value> storcli /cx bbu set autolearnmode=<value>, where x= 0 \u2013 Enabled, 1 \u2013 Disabled, 2 \u2013 Warn though event. storcli /c0/bbu set bbumode=5 Start battery learn cycle MegaCli -AdpBbuCmd -BbuLearn -aN|-a0,1,2|-aALL storcli /cx/bbu start learn storcli /co/bbu start learn Set the battery to low power storage mode. MegaCli -AdpBbuCmd -BbuMfgSleep -aN|-a0,1,2|-aALL storcli /cx/bbu set powermode=sleep Seal the gas gauge EEPROM write access MegaCli -AdpBbuCmd -BbuMfgSeal -aN|-a0,1,2|-aALL storcli /cx/bbu set writeaccess=sealed Security Commands Set the key ID for the controller. MegaCli -CreateSecurityKey -SecurityKey sssssssssss | [-Passphrase sssssssssss] | [-KeyID kkkkkkkkkkk] -aN storcli /cx set SecurityKey=XXXXXX [passphrase=yyyyy] [keyId=zzzz] Change the security key for the controller. MegaCli -ChangeSecurityKey -OldSecurityKey sssssssssss | -SecurityKey sssssssssss| [-Passphrase sssssssssss] | [-KeyID kkkkkkkkkkk] -aN storcli /cx set SecurityKey=XXXXXX OldSecurityKey=yyyyy Compare and verify the security key for the controller Compare and verify the security key for the controller Compare and verify the security key for the controller Delete the security key MegaCLI -DestroySecurityKey | [-Force] -aN storcli /cx delete SecurityKey Set the security key for the controller MegaCli -SetKeyID -KeyID kkkkkkkkkkk -aN storcli /cx set SecurityKey KeyId=xxxx Virtual Drive Commands Show the virtual drive information MegaCli \u2013LDInfo \u2013Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) show storcli /cx/v(x|all) show all Set virtual drive properties MegaCli \u2013LDSetProp WT | WB|NORA |RA | ADRA|-Cached|Direct| CachedBadBBU|NoCachedBadBBU} | -RW|RO|Blocked | {-Name nameString} | -EnDskCache|DisDskCache \u2013Lx| -L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) set wrcache=WT|WB|AWB storcli /cx/v(x|all) set rdcache=RA|NoRA storcli /cx/v(x|all) set iopolicy=Cached|Direct storcli /cx/v(x|all) set accesspolicy=RW|RO|Blocked|RmvBlkd storcli /cx/v(x|all) set pdcache=On|Off|Default storcli /cx/v(x|all) set name=<NameString> \" Set power-saving (dimmer switch) properties. MegaCli -LDSetPowerPolicy -Default| -Automatic| -None| -Maximum| -MaximumWithoutCaching -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) set ds=Default|Auto|None|Max|MaxNoCache Show virtual drive expansion information MegaCli -getLdExpansionInfo -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) show expansion Expand the virtual drive within the existing array; also use if you replace the drives with larger drives, beyond the size of the existing array. MegaCli -LdExpansion -pN -dontExpandArray -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) expand Size=<value> [expandarray] Secure the virtual drive. MegaCLI --LDMakeSecure -Lx|-L0,1,2,...|-Lall \u2013An storcli /cx/vx set security=on Show specific properties of virtual drives. MegaCli \u2013LDGetProp -Cache | -Access | -Name | -DskCache -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/vx show Start virtual drive initialization MegaCli \u2013LDInit \u2013Start [Fast|Full] -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) start init[Full] Stop a running virtual drive initialization. MegaCli \u2013LDInit -Abort -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) stop init Show the initialization progress MegaCli \u2013LDInit \u2013ShowProg -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) show init Start a consistency check on an uninitialized virtual drive MegaCli \u2013LDCC \u2013Start \u2013Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) start cc[Force] Start, stop, suspend, resume, and show the progress of a consistency check operation MegaCli -LDCC -Start|-Abort| -Suspend|-Resume|-ShowProg| -ProgDsply -Lx|-L0,1,2|-LALL -aN|-a0,1,2|-aALL storcli /cx/v(x|all) start cc storcli /cx/v(x|all) stop cc storcli /cx/v(x|all) pause cc storcli /cx/v(x|all) resume cc storcli /cx/v(x|all) show cc Enable/disable automatic background initialization. Show, stop, pause, resume, and show the progress of the background initialization. MegaCLI -LDBI -Enbl|-Dsbl| -getSetting|-Abort|-Suspend| -Resume|-ShowProg|-ProgDsply -Lx|-L0,1,2|-LALL -aN|-a0,1,2|-Aall storcli /cx/v(x|all) set autobgi=On|Off storcli /cx/v(x|all) show autobgi storcli /cx/v(x|all) stop bgi storcli /cx/v(x|all) pause bgi storcli /cx/v(x|all) resume bgi storcli /cx/v(x|all) show bgi Start and show progress for a migrate operation. MegaCli \u2013LDRecon {\u2013Start \u2013Rx [Add | Rmv PhysDrv[E0:S0,E1:S1,...] ] } | \u2013ShowProg|-ProgDsply \u2013Lx \u2013aN storcli /cx/vx start migrate type=raidx [option=add|remove drives=[e:]s|[e:]s-x|[e:]s-x,y] [Force] storcli /cx/v(x|all) show migrate Delete preserved cache MegaCLI -DiscardPreservedCache -Lx|-L0,1,2|-Lall -force -aN|-a0,1,2|-aALL storcli /cx/v(x|all) delete preservedcache[force] Assign the CacheCade virtual drive MegaCLI -Cachecade -assign|-remove -Lx|-L0,1,2|-LALL -aN|-a0,1,2|-aALL storcli /cx/vx|all set ssdCaching=on|off Physical Drive Commands Show drive information MegaCli -pdInfo - PhysDrv[E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx show storcli /cx/ex/sx show all Start, stop, suspend, or resume an ongoing rebuild operation. MegaCLI PDRbld -Start|-Stop |-Suspend|-Resume|-ShowProg |-ProgDsply -PhysDrv [E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx start rebuild storcli /cx/ex/sx stop rebuild storcli /cx/ex/sx pause rebuild storcli /cx/ex/sx resume rebuild storcli /cx/ex/sx show rebuild Start, stop, pause, resume, or show the progress of a copyback operation MegaCLI PDCpyBk -Start|-Stop |-Suspend|-Resume|-ShowProg |-ProgDsply -PhysDrv [E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx start copyback target=exx:sxx storcli /cx/ex/sx stop copyback storcli /cx/ex/sx pause copyback storcli /cx/ex/sx resume copyback storcli /cx/ex/sx show copyback Mark a drive as missing MegaCli -PdMarkMissing -physdrv[E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx set missing Show missing drive information MegaCli -PdGetMissing -aN|-a0,1,2|-aALL storcli /cx/ex/sx show all NOTE This information is shown as part of the show all command. Replace the configured drive that is identified as missing, and then start an automatic rebuild. MegaCli -PdReplaceMissing -physdrv[E0:S0] -arrayA, -rowB -aN storcli /cx/ex/sx insert array=x row=y Set the drive state to online MegaCli \u2013PDOnline - PhysDrv[E0:S0,E1:S1....] -aN|-a0,1,2 storcli /cx/ex/sx set online Set the drive state to offline MegaCli \u2013PDOffline -PhysDrv[E0:S0,E1:S1....] -aN|-a0,1,2|-aALL storcli /cx/ex/sx set offline Set the drive state to JBOD MegaCli \u2013PDMakeGood -PhysDrv[E0:S0,E1:S1....] -aN|-a0,1,2|-aALL storcli /cx/ex/sx set good [force] or storcli /cx/ex/sx set jbod Add and delete hotspare drives MegaCli \u2013PDHSP {\u2013Set [{-Dedicated -ArrayN | -Array0,1...}] [-EnclAffinity] [-nonRevertible] } | -Rmv -PhysDrv[E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx add hotsparedrive [dgs=<N|0,1,2..>] enclaffinity nonrevertible storcli /cx/ex/sx delete hotsparedrive Start, stop, pause, resume or show the progress of an initialization process. MegaCli \u2013PDClear -Start |-Stop| -ShowProg |-ProgDsply - PhysDrv[E0:S0,E1:S1....] -aN|-a0,1,2|-aALL storcli /cx/ex/sx start initialization storcli /cx/ex/sx stop initialization storcli /cx/ex/sx pause initialization storcli /cx/ex/sx resume initialization storcli /cx/ex/sx show initialization Start a drive locate and activate (blink) the drive\u2019s LED or stop a drive locate (LED blinking) and deactivate the drive\u2019s LED MegaCli \u2013PDLocate {[-start] | -stop} -physdrv[E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx start locate storcli /cx/ex/sx stop locate Spin down an unconfigured drive and prepare it for removal or spin up spun-down drive and mark the drive state as unconfigured good. MegaCli \u2013PDPrpRmv [-Undo] \u2013 PhysDrv[E0:S0,E1:S1....] -aN|-a0,1,2|-aALL storcli /cx/ex/sx spindown storcli /cx/ex/sx spinup Show physical drive information of all connected drives. MegaCli \u2013PDList -aN|-a0,1..|-aAll storcli /cx/eall/sall show [all] NOTE This command does not show drives whose enclosure device ID is not available. Flash the physical drive firmware MegaCLI PdFwDownload[offline] [ForceActivate] {[-SataBridge] -PhysDrv[0:1]}|{-EncdevId[devId1 ]} -f <filename> -aN|-a0,1,2|-Aall storcli /cx[/ex]/sx download src=<filepath> [satabridge] storcli /cx/ex download src=<filepath> [forceActivate] Erase the drive's security configuration and securely erase data on a drive. MegaCli -PDInstantSecureErase -PhysDrv[E0:S0,E1:S1,...] | [-Force] -aN|-a0,1,2|-aALL storcli /cx/ex/sx secureerase [force] Show the security key for secured physical drives MegaCli -GetKeyID [-PhysDrv[E0:S0]] -aN storcli /cx/ex/sx show securitykey keyid Start, stop, and show the progress of a secure erase operation MegaCli -SecureErase Start[ Simple| [Normal [ |ErasePattern ErasePatternA|ErasePattern ErasePatternA ErasePattern ErasePatternB]]|[Thorough [ |ErasePattern ErasePatternA|ErasePattern ErasePatternA ErasePattern ErasePatternB]]] | Stop| ShowProg| ProgDsply [-PhysDrv [E0:S0,E1:S1,...] | -Lx|-L0,1,2|-LALL] -aN|-a0,1,2|-aALL storcli /cx[/ex]/sx start erase [simple| normal| thorough] [erasepatternA=<val>]\\n[erasepatternB=< val>] Examples: storcli /cx/ex/sx start erase simple storcli /cx/ex/sx start erase normal erasepatterna=10101010 storcli /cx/ex/sx start erase thorough erasepatterna=10101010 erasepatternb=10101111 storcli /cx/ex/sx stop erase Enable/disable the direct physical drive mapping mode. Show the current state of the direct physical drive mapping. MegaCLI DirectPdMapping -Enbl|-Dsbl|-Dsply -aN|-a0,1,2|-Aall storcli /cx set directpdmapping=<on | off> storcli /cx show directpdmapping Enclosure Commands Show enclosure information MegaCli \u2013EncInfo -aN|-a0,1,2|-aALL storcli /cx/ex show storcli /cx/ex show all Show enclosure status MegaCli \u2013EncStatus -aN|-a0,1,2|-aALL /cx/ex show status Download enclosure firmware. /cx/ex download src=filepath [offline] [forceActivate PHY Commands Show PHY information MegaCli \u2013PHYInfo -phyM -aN|-a0,1,2|-aALL storcli /cx/px(x|all) show storcli /cx/px(x|all) show all Set PHY link speed MegaCLI PhySetLinkSpeed -phyM -speed -aN|-a0,1,2|-aALL storcli /cx/px(x|all) set linkspeed=1.5|3|6|12|auto Show the PHY error counters. Megacli PhyErrorCounters -An storcli /cx/px(x|all) show storcli /cx/px(x|all) show all Alarm Commands Show alarm properties MegaCli -AdpGetProp AlarmDsply -aN|-a0,1,2|-aALL storcli /cx(x|all) show alarm Set alarm properties MegaCli -AdpSetProp AlarmEnbl | AlarmDsbl | AlarmSilence -aN|-a0,1,2|-aALL storcli /cx(x|all) set alarm=<on|off|silence> Event Log Properties Commands Show event logs. MegaCli -AdpEventLog -GetEventLogInfo -aN|-a0,1,2|-aALL /cx show eventloginfo Show the specified type of event logs. MegaCli -AdpEventLog -GetEvents {-info -warning -critical -fatal} {-f <fileName>} -aN|-a0,1,2|-aALL storcli /cx show events [type=[latest=x|ccincon vd=|[sincereboot|sinceshutdown|included eleted|latest|ccincon]]] [filter=[info|warning|critical|fatal]] file=xyz.txt Show the specified event logs MegaCli -AdpEventLog -GetSinceShutdown {-info -warning -critical -fatal} {-f <fileName>} -aN|-a0,1,2|-aALL storcli /cx show events [type=[latest=x|ccincon vd=|[sincereboot|sinceshutdown|included eleted|latest|ccincon]]] [filter=[info|warning|critical|fatal]] file=xyz.txt Delete the event logs. MegaCli -AdpEventLog -Clear -aN|-a0,1,2|-aALL storcli /cx delete events Premium Feature Key Commands Show the Safe ID of the controller MegaCli -ELF -GetSafeId -a0 storcli /cx(x|all) show safeid Show the Advanced Software Options that are enabled on the controller, including the ones in trial mode. MegaCli -ELF \u2013ControllerFeatures -a0 MegaCli -ELF \u2013ControllerFeatures -a0 Apply the Activation Key in preview mode. MegaCli -ELF -Applykey key \u2013val -preview -a0 storcli /cx(x|all) set aso key=<key value> preview Apply the Activation Key MegaCli -ELF -Applykey key \u2013val -a0 storcli /cx(x|all) set aso key=<key value> Deactivate the trial key MegaCli -ELF \u2013DeactivateTrialKey -a0 storcli /cx(x|all) set aso deactivatetrialkey Show the re-host information and, if re-hosting is necessary, show the controller and key vault serial numbers. MegaCli -ELF -ReHostInfo -a0 storcli /cx(x|all) show rehostinfo Indicate to the controller that the re-host is complete MegaCli -ELF -ReHostComplete -a0 storcli /cx(x|all) set aso rehostcomplete","title":"megacli"},{"location":"megacli/#smart","text":"\u9805\u76eeID \u9805\u76ee\u540d \u8a73\u7d30\u306a\u8aac\u660e 01 Raw Read Error Rate \u3053\u306e\u9805\u76ee\u306f\u30cf\u30fc\u30c9\u30c7\u30a3\u30b9\u30af\u304b\u3089\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u3080\u6642\u306b\u767a\u751f\u3057\u305f\u30a8\u30e9\u30fc\u306e\u5272\u5408\u3092\u8868\u3059\u3002\u6570\u5024\u304c\u95be\u5024\u3088\u308a\u4f4e\u3044\u5834\u5408\u3001\u30cf\u30fc\u30c9\u30c7\u30a3\u30b9\u30af\u5185\u306e\u78c1\u6c17\u30c7\u30a3\u30b9\u30af\u307e\u305f\u306f\u78c1\u6c17\u30d8\u30c3\u30c9\u306b\u7570\u5e38\u304c\u3042\u308b\u3002 05 Reallocated Sectors Count \u4ee3\u66ff\u51e6\u7f6e\uff08\u30c7\u30fc\u30bf\u3092\u7279\u5225\u306b\u4e88\u7d04\u3057\u305f\u4e88\u5099\u30a8\u30ea\u30a2\u306b\u79fb\u52d5\u3059\u308b\uff09\u3092\u65bd\u3055\u308c\u305f\u4e0d\u826f\u30bb\u30af\u30bf\u306e\u6570\u3002 C5(197) Current Pending Sector Count \u73fe\u5728\u7570\u5e38\u304c\u3042\u308a\u3001\u4ee3\u66ff\u51e6\u7406\u3092\u5f85\u3064\u30bb\u30af\u30bf\u306e\u7dcf\u6570\u3002\u3082\u3057\u5f8c\u3067\u8aad\u307f\u8fbc\u307f\u306b\u6210\u529f\u3057\u305f\u30bb\u30af\u30bf\u304c\u3042\u308c\u3070\u3001\u3053\u306e\u5024\u306f\u6e1b\u5c11\u3059\u308b\u3002 C6(198) Off-Line Scan Uncorrectable Sector Count \u30aa\u30d5\u30e9\u30a4\u30f3\u30b9\u30ad\u30e3\u30f3\u6642\u306b\u767a\u898b\u3055\u308c\u305f\u3001\u56de\u5fa9\u4e0d\u53ef\u80fd\u306a\u30bb\u30af\u30bf\u306e\u7dcf\u6570\u3002\u3053\u306e\u5024\u304c\u5897\u52a0\u3059\u308b\u5834\u5408\u306f\u3001\u78c1\u6c17\u30c7\u30a3\u30b9\u30af\u306e\u8868\u9762\u306b\u660e\u78ba\u306a\u554f\u984c\u304c\u3042\u308b\u3002 Media Error\u4ee3\u8868\u6247\u533a\u6709\u95ee\u9898\uff0c\u574f\u9053\u7b49\uff1b Other Error\u4ee3\u8868\u78c1\u76d8\u53ef\u80fd\u6709\u677e\u52a8\u3002 Media Error Count: 0 Other Error Count: 0","title":"Smart\u8868"},{"location":"megacli/#megaraidhdd","text":"$ sudo MegaCli64 -PDList -aALL $ sudo MegaCli64 -CfgDsply -aALL \u2190 RAID\u30ab\u30fc\u30c9\u3082\u8868\u793a\u3059\u308b\u3002","title":"MegaRAID\u304c\u8a8d\u8b58\u3057\u3066\u3044\u308bHDD\u3092\u5168\u8868\u793a\u3059\u308b\u65b9\u6cd5"},{"location":"megacli/#hdd","text":"1. #\u5bfe\u8c61\u30c7\u30a3\u30b9\u30af\u306e\u30aa\u30d5\u30e9\u30a4\u30f3 /opt/MegaRAID/MegaCli/MegaCli64 -PDOffline -PhysDrv[252:0] -a0 Adapter: 0: EnclId-252 SlotId-0 state changed to OffLine. Exit Code: 0x00 2. #status\u78ba\u8a8d /opt/MegaRAID/MegaCli/MegaCli64 -PDList -a0 | less Firmware state: Offline \u2190\u3000offline\u306b\u306a\u3063\u3066\u308b\u3002 3. #\u5bfe\u8c61\u306e\u30c7\u30a3\u30b9\u30af\u306bmissing mark\u3064\u3051\u308b /opt/MegaRAID/MegaCli/MegaCli64 -PDMarkMissing -PhysDrv[252:0] -a0 EnclId-252 SlotId-0 is marked Missing. Exit Code: 0x00 4. #missing mark\u306e\u3064\u3044\u305fdisk\u306e\u78ba\u8a8d /opt/MegaRAID/MegaCli/MegaCli64 -PDGetMissing -aALL Adapter 0 - Missing Physical drives No. Array Row Size Expected 0 0 0 1907200 MB 5. #\u524a\u9664\u524d\u306e\u6e96\u5099 /opt/MegaRAID/MegaCli/MegaCli64 -PDPrpRmv -PhysDrv[252:0] -a0 Prepare for removal Success Exit Code: 0x00 6. #Missing mark\u306e\u72b6\u614b\u5909\u66f4 /opt/MegaRAID/MegaCli/MegaCli64 -PDReplaceMissing -PhysDrv[252:0] -Array1 -row0 -a0 7. #Rebuild\u30b9\u30bf\u30fc\u30c8 /opt/MegaRAID/MegaCli/MegaCli64 -PDRbld -Start -PhysDrv[252:0] -a0 8. #\u72b6\u614b\u78ba\u8a8d /opt/MegaRAID/MegaCli/MegaCli64 -PDList -a0 | less Firmware state: Rebuild \u2190 rebuild\u306e\u30b9\u30c6\u30fc\u30bf\u30b9\u306b\u306a\u3063\u305f 9. #Rebuild\u306e\u72b6\u6cc1\u78ba\u8a8d /opt/MegaRAID/MegaCli/MegaCli64 -PDRbld -showprog -physdrv[252:0] -a0 Rebuild Progress on Device at Enclosure 252, Slot 0 Completed 4% in 11 Minutes. Exit Code: 0x00","title":"HDD\u3092\u30ea\u30d3\u30eb\u30c9\u3059\u308b\u624b\u9806"},{"location":"megacli/#raid","text":"$ sudo MegaCli64 -LDInfo -Lall -aALL $ sudo MegaCli64 -LDInfo -Lall -aALL | grep -i state \u2460\u25c6 State: Optimal \u3092\u78ba\u8a8d for i in $(sudo /usr/local/sbin/MegaCli -PDList -aALL -NoLog | grep 'Device Id' | awk '{ print $NF }') ; do echo \"===== Device Id $i =====\" ; sudo /usr/sbin/smartctl -a -d sat+megaraid,$i /dev/sda | egrep ' ^(Ser| [15]|19[78]|#)' ; echo ; done","title":"RAID\u304c\u5197\u9577\u306b\u306a\u3063\u3066\u3044\u308b\u4e8b\u3092\u78ba\u8a8d\u3059\u308b\u65b9\u6cd5"},{"location":"megacli/#display-virtual-drive-information","text":"root@www101v:~# MegaCli64 -LDInfo -Lall -aALL Adapter 0 -- Virtual Drive Information: Virtual Disk: 0 (Target Id: 0) Name: RAID Level: Primary-1, Secondary-0, RAID Level Qualifier-0 Size:931.0 GB State: Degraded <-- \u3053\u3053 Stripe Size: 64 KB Number Of Drives:2 Span Depth:1 Default Cache Policy: WriteBack, ReadAheadNone, Cached, Write Cache OK if Bad BBU Current Cache Policy: WriteBack, ReadAheadNone, Cached, Write Cache OK if Bad BBU Access Policy: Read/Write Disk Cache Policy: Enabled Encryption Type: None Bad Blocks Exist: No Exit Code: 0x00","title":"Display Virtual Drive Information"},{"location":"megacli/#display-drive-information","text":"root@www101v:~# MegaCli64 -PDList -aALL Adapter #0 Enclosure Device ID: 252 Slot Number: 0 Device Id: 2 Sequence Number: 2 Media Error Count: 0 Other Error Count: 0 Predictive Failure Count: 0 Last Predictive Failure Event Seq Number: 0 PD Type: SATA Raw Size: 931.512 GB [0x74706db0 Sectors] Non Coerced Size: 931.012 GB [0x74606db0 Sectors] Coerced Size: 931.0 GB [0x74600000 Sectors] Firmware state: Online, Spun Up SAS Address(0): 0x4433221103000000 Connected Port Number: 0(path0) Inquiry Data: WD-WMATV5217983WDC WD1002FBYS-50A6B0 03.00C09 FDE Capable: Not Capable FDE Enable: Disable Secured: Unsecured Locked: Unlocked Foreign State: None Device Speed: 3.0Gb/s Link Speed: 3.0Gb/s Media Type: Hard Disk Device Drive: Not Certified","title":"Display Drive Information"},{"location":"megacli/#rebuild","text":"\u9759\u7684 root@www101v:~# MegaCli64 -PDRbld -ShowProg -PhysDrv[252:1] -aALL Rebuild Progress on Device at Enclosure 252, Slot 1 Completed 16% in 24 Minutes. Exit Code: 0x00 Real Time root@www101v:~# MegaCli64 -PDRbld -ProgDsply -PhysDrv[252:1] -aALL Rebuild progress of physical drives... Enclosure:Slot Percent Complete Time Elps 252 :01 ########***************17 %*********************** 00:26:56 Press <ESC> key to quit...","title":"Rebuild \u9032\u6357\u78ba\u8a8d"},{"location":"megacli/#_1","text":"RAID\u30ab\u30fc\u30c9\u306e\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u8a2d\u5b9a \uff1cWrite \u30b9\u30eb\u30fc\uff1e MegaCli -LDSetProp WT -Lall -Aall \uff1cWrite \u30d0\u30c3\u30af\uff1e MegaCli -LDSetProp WB -Lall -Aall RAID\u30ab\u30fc\u30c9\u306e\u8aad\u307f\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u8a2d\u5b9a \uff1cNo read ahead\uff1e MegaCli -LDSetProp NORA -Lall -Aall \uff1cRead ahead\uff1e MegaCli -LDSetProp RA -Lall -Aall \uff1cAdaptive read ahead\uff1e MegaCli -LDSetProp ADRA -Lall -Aall RAID\u30ab\u30fc\u30c9\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30dd\u30ea\u30b7\u30fc\u306e\u8a2d\u5b9a \uff1cChached\uff1e MegaCli -LDSetProp -Cached -Lall -aALL \uff1cDirect\uff1e MegaCli -LDSetProp -Direct -Lall -aALL BBU\u30e6\u30cb\u30c3\u30c8\u304c\u4e0d\u826f\u306e\u5834\u5408\u306b\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u4f7f\u3046\u304b\u3069\u3046\u304b \uff1cCachedBadBBU\uff1a\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u6709\u52b9\uff1e MegaCli -LDSetProp -CachedBadBBU -Lall -Aall \uff1cNoCachedBadBBU\uff1a\u66f8\u304d\u8fbc\u307f\u30ad\u30e3\u30c3\u30b7\u30e5\u7121\u52b9\uff1e MegaCli -LDSetProp -NoCachedBadBBU -Lall -Aall \u30c9\u30e9\u30a4\u30d6\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u6709\u52b9\u306b\u3059\u308b\u304b\u3069\u3046\u304b \uff1cEnables drive cache\uff1a\u6709\u52b9\uff1e MegaCli -LDSetProp -EnDskCache -Lall -Aall \uff1cDisables drive cache\uff1a\u7121\u52b9\uff1e MegaCli -LDSetProp -DisDskCache -Lall -Aall \u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u78ba\u8a8d\u65b9\u6cd5 RAID\u30ab\u30fc\u30c9\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u78ba\u8a8d # MegaCli -LDGetProp -Cache -Lall -aALL Adapter 0-VD 0(target id: 0): Cache Policy:WriteThrough, ReadAheadNone, Direct, No Write Cache if bad BBU Exit Code: 0x00 \u30c9\u30e9\u30a4\u30d6\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u78ba\u8a8d # MegaCli -LDGetProp -DskCache -Lall -aALL Adapter 0-VD 0(target id: 0): Disk Write Cache : Disabled Exit Code: 0x00","title":"\u30ad\u30e3\u30c3\u30b7\u30e5\u8a2d\u5b9a\u65b9\u6cd5"},{"location":"megacli/#fwtermlog-grep-rebuild","text":"[iadmin@xxxx ~]$ sudo MegaCli64 -Fwtermlog -Dsply -aall | grep Rebuild T5: disableAutoRebuild=0, disableBatteryWarning=0, eccBucketSize=ff 02/01/15 6:05:01: EVT#02934-02/01/15 6:05:01: 106=Rebuild automatically started on PD 01(e0x20/s1) 02/01/15 6:05:03: prDiskCheckOkToRun: PR cannot run on this pd=0 since this array=1 has a PD in REBUILD state Rebuilding 02/01/15 7:43:01: EVT#02936-02/01/15 7:43:01: 103=Rebuild progress on PD 01(e0x20/s1) is 0.99%(5880s) 02/01/15 9:21:28: EVT#02937-02/01/15 9:21:28: 103=Rebuild progress on PD 01(e0x20/s1) is 1.99%(11787s) 02/01/15 10:59:38: EVT#02938-02/01/15 10:59:38: 103=Rebuild progress on PD 01(e0x20/s1) is 2.99%(17677s) 02/01/15 12:37:13: EVT#02939-02/01/15 12:37:13: 103=Rebuild progress on PD 01(e0x20/s1) is 3.99%(23532s) 02/01/15 14:15:49: EVT#02940-02/01/15 14:15:49: 103=Rebuild progress on PD 01(e0x20/s1) is 4.99%(29448s) 02/01/15 15:54:18: EVT#02941-02/01/15 15:54:18: 103=Rebuild progress on PD 01(e0x20/s1) is 5.99%(35357s) 02/01/15 17:31:16: EVT#02942-02/01/15 17:31:16: 103=Rebuild progress on PD 01(e0x20/s1) is 6.99%(41175s) 02/01/15 19:07:32: EVT#02943-02/01/15 19:07:32: 103=Rebuild progress on PD 01(e0x20/s1) is 7.99%(46951s) 02/01/15 20:44:02: EVT#02944-02/01/15 20:44:02: 103=Rebuild progress on PD 01(e0x20/s1) is 8.99%(52741s) 02/01/15 22:20:47: EVT#02945-02/01/15 22:20:47: 103=Rebuild progress on PD 01(e0x20/s1) is 9.99%(58546s) 02/01/15 23:57:46: EVT#02946-02/01/15 23:57:46: 103=Rebuild progress on PD 01(e0x20/s1) is 10.99%(64365s) 02/02/15 1:35:11: EVT#02947-02/02/15 1:35:11: 103=Rebuild progress on PD 01(e0x20/s1) is 11.99%(4674s) 02/02/15 3:12:39: EVT#02948-02/02/15 3:12:39: 103=Rebuild progress on PD 01(e0x20/s1) is 12.99%(10522s) 02/02/15 4:49:15: EVT#02949-02/02/15 4:49:15: 103=Rebuild progress on PD 01(e0x20/s1) is 13.99%(16318s) 02/02/15 6:26:01: EVT#02950-02/02/15 6:26:01: 103=Rebuild progress on PD 01(e0x20/s1) is 14.99%(22124s) 02/02/15 8:02:22: EVT#02951-02/02/15 8:02:22: 103=Rebuild progress on PD 01(e0x20/s1) is 15.99%(27905s) 02/02/15 9:39:34: EVT#02952-02/02/15 9:39:34: 103=Rebuild progress on PD 01(e0x20/s1) is 16.99%(33737s) 02/02/15 11:16:58: EVT#02953-02/02/15 11:16:58: 103=Rebuild progress on PD 01(e0x20/s1) is 17.99%(39581s) 02/02/15 12:54:33: EVT#02954-02/02/15 12:54:33: 103=Rebuild progress on PD 01(e0x20/s1) is 18.98%(45436s) 02/02/15 14:24:59: EVT#02955-02/02/15 14:24:59: 103=Rebuild progress on PD 01(e0x20/s1) is 19.98%(50862s) 02/02/15 16:02:28: EVT#02956-02/02/15 16:02:28: 103=Rebuild progress on PD 01(e0x20/s1) is 20.98%(56711s) 02/02/15 17:39:07: EVT#02957-02/02/15 17:39:07: 103=Rebuild progress on PD 01(e0x20/s1) is 21.98%(62510s)","title":"Fwtermlog\u3092\u8868\u793a\u3059\u308b\u65b9\u6cd5 | grep Rebuild"},{"location":"megacli/#slot-numberfirmware-stateinquiry-dataraw-sizedevice-id","text":"root@ubuntu14:/home/lyvivian# megacli -PDList -aALL | egrep \"^Slot Number|^Firmware state|^Inquiry Data|^Raw Size|^Device Id\" Slot Number: 0 Device Id: 6 Raw Size: 465.761 GB [0x3a386030 Sectors] Firmware state: Online, Spun Up Inquiry Data: S313J9FF103173 ST500LM012 HN-M500MBB 2BA30010 Slot Number: 1 Device Id: 5 Raw Size: 29.843 GB [0x3bb0000 Sectors] Firmware state: Online, Spun Up Inquiry Data: 00257465041E TS32GSSD25S-M V090216 Slot Number: 2 Device Id: 4 Raw Size: 298.090 GB [0x2542eab0 Sectors] Firmware state: Online, Spun Up Inquiry Data: WD-WXE508HD9898WDC WD3200BEVT-75ZCT1 11.01A11 Slot Number: 3 Device Id: 11 Raw Size: 59.625 GB [0x7740ab0 Sectors] Firmware state: Online, Spun Up Inquiry Data: 0000000011210310A638M4-CT064M4SSD2 000F Slot Number: 4 Device Id: 7 Raw Size: 1.819 TB [0xe8e088b0 Sectors] Firmware state: Online, Spun Up Inquiry Data: WD-WCC1T0228569WDC WD20EZRX-00DC0B0 80.00A80 Slot Number: 5 Device Id: 9 Raw Size: 1.819 TB [0xe8e088b0 Sectors] Firmware state: Online, Spun Up Inquiry Data: WD-WMC301755889WDC WD20EZRX-00DC0B0 80.00A80 Slot Number: 6 Device Id: 8 Raw Size: 1.819 TB [0xe8e088b0 Sectors] Firmware state: Online, Spun Up Inquiry Data: WD-WMC301755597WDC WD20EZRX-00DC0B0 80.00A80 Slot Number: 7 Device Id: 10 Raw Size: 1.819 TB [0xe8e088b0 Sectors] Firmware state: Online, Spun Up Inquiry Data: WD-WMC301744569WDC WD20EZRX-00DC0B0 80.00A80 root@ubuntu14:/home/lyvivian#","title":"\"^Slot Number|^Firmware state|^Inquiry Data|^Raw Size|^Device Id\" \u3092\u8868\u793a\u3059\u308b"},{"location":"megacli/#usage","text":"# cd /opt/MegaRAID/storcli # ./storcli64 information about every controller ./storcli64 show informations to selected controller and its configuration ./storcli64 /c0 show informations to the available hard drives and their current state (Serial Number, temperature ) ./storcli64 /c0 /eall /sall show [all] informations to the available virtual drives and their current state. ./storcli64 /c0 /vall show [all] show the progress of ongoing rebuilds ./storcli64 /c0 /eall /sall show rebuild create a RAID 1 ./storcli64 /c0 add vd type=raid1 size=10gb names=tmp1 drives=0:2-3 create a RAID 5 ./storcli64 /c0 add vd type=raid5 size=10gb names=tmp1 drives=0:2-6 create a RAID 6 ./storecli64 /c0 add vd type=raid6 size=10gb names=tmp1 drives=0:2-7 create a RAID 10 ./storecli64 /c0 add vd type=raid10 size=2gb,3gb,4gb names=tmp1,tmp2,tmp3 drives=0:2-3,5,7 pdperarray=2","title":"Usage"},{"location":"megacli/#manual","text":"There is a manual with all the usable parameters provided by avagotech (the succsessor of the producer LSI) to be found here.","title":"Manual"},{"location":"megacli/#controller-overview-in-detail","text":"information regarding every controller ./storecli64 show ``` # ./storcli64 show ... SNIPP ... System Overview : =============== Ctl Model Ports PDs DGs DNOpt VDs VNOpt BBU sPR DS EHS ASOs Hlth 0 Intel(R)IntegratedRAIDModuleRMS25CB080 8 2 1 0 1 0 Opt On 1&2 Y 3 Opt ```","title":"controller overview in detail"},{"location":"megacli/#configuration-overview","text":"information regarding the selected controller and its configuration ./storecli64 /c0 show ``` # ./storcli64 /c0 show Generating detailed summary of the adapter, it may take a while to complete. ... SNIPP ... Product Name = Intel(R) Integrated RAID Module RMS25CB080 Serial Number = QSIP23600494 SAS Address = 5001e6756eda0000 PCI Address = 00:05:00:00 System Time = 01/25/2016 14:34:15 Mfg. Date = 09/07/12 Controller Time = 01/25/2016 13:34:14 FW Package Build = 23.12.0-0013 BIOS Version = 5.42.00_4.12.05.00_0x05270000 FW Version = 3.240.25-2382 Driver Name = megaraid_sas Driver Version = 06.805.06.01-rc1 Vendor Id = 0x1000 Device Id = 0x5B SubVendor Id = 0x8086 SubDevice Id = 0x3513 Host Interface = PCI-E Device Interface = SAS-6G Bus Number = 5 Device Number = 0 Function Number = 0 Drive Groups = 1 TOPOLOGY : ======== DG Arr Row EID:Slot DID Type State BT Size PDC PI SED DS3 FSpace 0 - - - - RAID1 Optl N 930.390 GB dflt N N none N 0 0 - - - RAID1 Optl N 930.390 GB dflt N N none N 0 0 0 252:0 8 DRIVE Onln N 930.390 GB dflt N N none - 0 0 1 252:1 9 DRIVE Onln N 930.390 GB dflt N N none - ... SNIPP ... Virtual Drives = 1 VD LIST : ======= DG/VD TYPE State Access Consist Cache Cac sCC Size Name 0/0 RAID1 Optl RW No RWBC - ON 930.390 GB ... SNIPP ... Physical Drives = 2 PD LIST : ======= EID:Slt DID State DG Size Intf Med SED PI SeSz Model Sp 252:0 8 Onln 0 930.390 GB SATA HDD N N 512B WDC WD1000CHTZ-04JCPV1 U 252:1 9 Onln 0 930.390 GB SATA HDD N N 512B WDC WD1000CHTZ-04JCPV1 U ... SNIPP ... Cachevault_Info : =============== Model State Temp Mode MfgDate Next Learn CVPM02 Optimal 23C - 2012/12/19 2016/02/22 13:07:20 ```","title":"configuration overview"},{"location":"megacli/#information-regarding-the-disks","text":"Information regarding the available disks and their current state (serial number,temperature etc.) # ./storecli64 /c0 /eall /sall show all Controller = 0 Status = Success Description = Show Drive Information Succeeded. Drive /c0/e252/s0 : ================= ------------------------------------------------------------------------------- EID:Slt DID State DG Size Intf Med SED PI SeSz Model Sp ------------------------------------------------------------------------------- 252:0 8 Onln 0 930.390 GB SATA HDD N N 512B WDC WD1000CHTZ-04JCPV1 U ------------------------------------------------------------------------------- ... SNIPP ... Drive /c0/e252/s0 - Detailed Information : ======================================== Drive /c0/e252/s0 State : ======================= Shield Counter = 0 Media Error Count = 0 Other Error Count = 0 BBM Error Count = 0 Drive Temperature = 29C (84.20 F) Predictive Failure Count = 0 S.M.A.R.T alert flagged by drive = No Drive /c0/e252/s0 Device attributes : =================================== SN = WD-WXS1E64JNL0D Manufacturer Id = ATA Model Number = WDC WD1000CHTZ-04JCPV1 NAND Vendor = NA WWN = 50014ee65a68f4c4 Firmware Revision = 04.06A01 Raw size = 931.512 GB [0x74706db0 Sectors] Coerced size = 930.390 GB [0x744c8000 Sectors] Non Coerced size = 931.012 GB [0x74606db0 Sectors] Device Speed = 6.0Gb/s Link Speed = 6.0Gb/s NCQ setting = N/A Write cache = N/A Logical Sector Size = 512B Physical Sector Size = 4 KB Connector Name = Port 0 - 3 x1 Drive /c0/e252/s0 Policies/Settings : =================================== Drive position = DriveGroup:0, Span:0, Row:0 Enclosure position = 0 Connected Port Number = 0(path0) Sequence Number = 2 Commissioned Spare = No Emergency Spare = No Last Predictive Failure Event Sequence Number = 0 Successful diagnostics completion on = N/A SED Capable = No SED Enabled = No Secured = No Locked = No Needs EKM Attention = No PI Eligible = No Certified = No Wide Port Capable = No Port Information : ================ ----------------------------------------- Port Status Linkspeed SAS address ----------------------------------------- 0 Active 6.0Gb/s 0x4433221100000000 ----------------------------------------- Inquiry Data = 7a 42 ff 3f 37 c8 10 00 00 00 00 00 3f 00 00 00 00 00 00 00 20 20 20 20 57 20 2d 44 58 57 31 53 36 45 4a 34 4c 4e 44 30 00 00 00 00 00 00 34 30 30 2e 41 36 31 30 44 57 20 43 44 57 30 31 30 30 48 43 5a 54 30 2d 4a 34 50 43 31 56 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 10 80 00 40 00 2f 01 40 00 00 00 00 07 00 ff 3f 10 00 3f 00 10 fc fb 00 00 01 ff ff ff 0f 00 00 07 00 Drive /c0/e252/s1 : ================= ------------------------------------------------------------------------------- EID:Slt DID State DG Size Intf Med SED PI SeSz Model Sp ------------------------------------------------------------------------------- 252:1 9 Onln 0 930.390 GB SATA HDD N N 512B WDC WD1000CHTZ-04JCPV1 U ------------------------------------------------------------------------------- ... SNIPP ... Drive /c0/e252/s1 - Detailed Information : ======================================== Drive /c0/e252/s1 State : ======================= Shield Counter = 0 Media Error Count = 0 Other Error Count = 0 BBM Error Count = 0 Drive Temperature = 28C (82.40 F) Predictive Failure Count = 0 S.M.A.R.T alert flagged by drive = No Drive /c0/e252/s1 Device attributes : =================================== SN = WD-WXT1E64TZEFP Manufacturer Id = ATA Model Number = WDC WD1000CHTZ-04JCPV1 NAND Vendor = NA WWN = 50014ee6afbe6dc0 Firmware Revision = 04.06A01 Raw size = 931.512 GB [0x74706db0 Sectors] Coerced size = 930.390 GB [0x744c8000 Sectors] Non Coerced size = 931.012 GB [0x74606db0 Sectors] Device Speed = 6.0Gb/s Link Speed = 6.0Gb/s NCQ setting = N/A Write cache = N/A Logical Sector Size = 512B Physical Sector Size = 4 KB Connector Name = Port 0 - 3 x1 Drive /c0/e252/s1 Policies/Settings : =================================== Drive position = DriveGroup:0, Span:0, Row:1 Enclosure position = 0 Connected Port Number = 1(path0) Sequence Number = 2 Commissioned Spare = No Emergency Spare = No Last Predictive Failure Event Sequence Number = 0 Successful diagnostics completion on = N/A SED Capable = No SED Enabled = No Secured = No Locked = No Needs EKM Attention = No PI Eligible = No Certified = No Wide Port Capable = No Port Information : ================ ----------------------------------------- Port Status Linkspeed SAS address ----------------------------------------- 0 Active 6.0Gb/s 0x4433221101000000 ----------------------------------------- Description MegaCLI Command StorCLI Command Real StorCLI Example System Commands Show the software version. MegaCLI -v storcli -v storcli -v Show help information. MegaCLI -help|-h|? storcli -help|-h|? storcli -h Show the number of controllers connected MegaCLI -adpCount storcli show ctrlcount storcli show ctrlcount Controller Commands Show the status of properties related to the controllers. MegaCli -AdpGetProp <PropertyName>-aN|-a0,1,2|-aALL The following properties can be used with this command: abortcconerror alarmdsply autodetectbackplanedsbl autoenhancedimportdsply autosnapshotspace batwarndsbl bgirate bootwithpinnedcache cachebypass ccrate clusterenable coercionmode copybackdsbl defaultldpspolicy defaultsnapshotspace defaultviewspace disableldpsinterval disableldpstime disableocr dsbl eccbucketcount eccbucketleakrate eccbucketsize enableeghsp enableesmarter enableeug| enablejbod enblspindownunconfigdrvs loadbalancemode maintainpdfailhistoryenbl ncqdsply patrolreadrate perfmode predfailpollinterval rebuildrate reconrate rstrhotspareoninsert smartcpybkenbl spindowntime spinupdelay spinupdrivecount spinupencdelay /cx show <propertyName> The following properties can be used with this command: activityforlocate alarm backplane batterywarning bgirate bootwithpinnedcache cachebypass cacheflushint cc ccrate clusterenable coercion copyback directpdmapping ds eccbucketleakrate eccbucketsize enableeghsp enableesmarter enableeug exposeencldevice jbod loadbalancemode maintainpdfailhistory migraterate ncq perfmode pr prcorrectunconfiguredareas prrate rebuildrate rehostinfo restorehotspare safeid smartpollinterval spinupdelay spinupdrivecount stoponerror time usefdeonlyencrypt storcli /c0 show activityforlocate storcli /c0 show alarm storcli /c0 show backplane storcli /c0 show batterywarning storcli /c0 show bgirate storcli /c0 show bootwithpinnedcache storcli /c0 show cachebypass storcli /c0 show cacheflushint storcli /c0 show cc storcli /c0 show ccrate storcli /c0 show clusterenable storcli /c0 show coercion storcli /c0 show copyback Show the status of properties related to the controllers (continued). spinupencdrvcnt ssdsmartcpybkenbl usediskactivityforlocate usefdeonlyencrypt None Set properties on the selected controllers. Megacli -AdpSetProp <propertyname>-an|-a0,1,2|-aall The following properties can be set using this command: abortcconerror alarmdsply autodetectbackplanedsbl autoenhancedimportdsply autosnapshotspace batwarndsbl bgirate bootwithpinnedcache cachebypass ccrate clusterenable coercionmode copybackdsbl defaultldpspolicy defaultsnapshotspace defaultviewspace disableldpsinterval disableldpstime disableocr dsbl eccbucketcount eccbucketleakrate eccbucketsize enableeghsp enableesmarter enableeug| enablejbod enblspindownunconfigdrvs loadbalancemode maintainpdfailhistoryenbl ncqdsply patrolreadrate perfmode predfailpollinterval rebuildrate reconrate rstrhotspareoninsert smartcpybkenbl spindowntime spinupdelay spinupdrivecount spinupencdelay /cx set <property1> The following properties can be set using this command: abortcconerror=<on|off> activityforlocate=<on|off> alarm=<value> autorebuild=<on|off> backplane=<value> batterywarning=<on|off> bgirate=<value> bootwithpinnedcache=<on|off> cachebypass=<on|off> flush|flushcache cacheflushinterval=<value> ccrate=<value> coercion=<value> clusterenable=<value> copyback=<on|off> type=<smartssd|smarthdd|all> dimmerswitch=<on|off> directpdmapping=<enable|disable> eccbucketleakrate=<value> eccbucketsize=<value> enableeghsp=<value> enableesmarter=<value> enableeug=<value> exposeencldevice=<on|off> foreignautoimport=<on|off> jbod=<on|off> loadbalancemode=<value> maintainpdfailhistory=<on|off> migraterate=<value> ncq=<on|off> perfmode=<value> prcorrectunconfiguredareas=<on|off> prrate=<value> rebuildrate=<value> restorehotspare=<on|off> smartpollinterval=<value> spinupdelay=<value> spinupdrivecount=<value> stoponerror=<on|off> usefdeonlyencrypt=<on|off> time=yyyymmdd hh:mm:ss|systemtime usefdeonlyencrypt=<on|off> /c0 set abortcconerror=on Set properties on the selected controllers. autocarve=<on|off> autodetect=<on|off > disk=<p:-p>|all autorebuild=<on|off> carvesize=<1024..32768> dpmstat=<on|off> ondegrade=<cacheoff|follow> rebuild=<enable|disable|><1..5> rebuildmode=<adaptive|lowlatency> rebuildrate=<1..5> selftest=<enable|disable> spinup=<value> stagger=<value> verify=advanced|basic|<1..5> verify=basic [pref=ddd:hh]where hh={00..23} and ddd={mon|tue|wed|thu|fri|sat|sun} verify=enable|disable|<1..5> verifymode=<adaptive|lowlatency> verifyrate=<1..5> spinupencdrvcnt sdsmartcpybkenbl usediskactivityforlocate usefdeonlyencrypt abortcconerror=<on|off> activityforlocate=<on|off> alarm=<value> autorebuild=<on|off> backplane=<value> batterywarning=<on|off> bgirate=<value> bootwithpinnedcache=<on|off> cachebypass=<on|off> flush|flushcache cacheflushinterval=<value> ccrate=<value> coercion=<value> clusterenable=<value> copyback=<on|off> type=<smartssd|smarthdd|all> directpdmapping=<enable|disable> eccbucketleakrate=<value> eccbucketsize=<value> enableeghsp=<value> enableesmarter=<value> enableeug=<value> exposeencldevice=<on|off> foreignautoimport=<on|off> jbod=<on|off> loadbalancemode=<value> maintainpdfailhistory=<on|off> migraterate=<value> ncq=<on|off> perfmode=<value> prcorrectunconfiguredareas=<on|off> prrate=<value> rebuildrate=<value> restorehotspare=<on|off> smartpollinterval=<value> spinupdelay=<value> spinupdrivecount=<value> stoponerror=<on|off> usefdeonlyencrypt=<on|off> time=yyyymmdd hh:mm:ss|systemtime usefdeonlyencrypt=<on|off> Show the number of controllers connected. MegaCLI -adpCount storcli show ctrlcount storcli show ctrlcount Show all information about the adapter, such as cluster state, BIOS, alarm, firmware, version, and so on. MegaCli -AdpAllInfo -aN|-a0,1,2|-aALL storcli /cx show all storcli /c0 show all Show the freespace available in the controller. MegaCLI -CfgFreeSpaceinfo -aN|-a0,1,2|-aALL storcli /cx show freespace storcli /c0 show freespace Download the controller firmware MegaCli -AdpFwFlash -f filename [-NoSigChk] [-NoVerChk] -aN|-a0,1,2|-aALL storcli /cx download file=<filepath> [fwtype=<val>] [nosigchk] [noverchk] storcli /c0 download file=mr2208.rom Show the preserved cache status. MegaCLI-GetPreservedCacheList -aN|-a0,1,2|-aALL storcli /cx show preservedcache storcli /c0 show preservedcache Set the controller time MegaCLI \u2013AdpSetTime yyyymmdd hh:mm:ss -aN|-a0,1,2|-aALL storcli /c(x|all) set time=<yyyymmdd hh:mm:ss | systemtime> storcli /c0 set time=systemtime Show the controller time. MegaCLI \u2013AdpGetTime -aN storcli /cx show time storcli /c0 show time RAID Configuration commands Create a RAID configuration of RAID type 0, 1, 5, and 6. MegaCli \u2013CfgLDAdd -R0|-R1|-R5|-R6[E0:S0,E1:S1,...] [WT | WB] [NORA | RA | ADRA] [Direct | Cached] [CachedBadBBU|NoCachedBadBBU] [-szXXXXXXXX [-szYYYYYYYY [... ]]] [-strpszM] [\u2013Hsp[E5:S5,...]] [\u2013afterLdX] -aN storcli /cx add vd type=raid[0|1|5|6] [Size=<VD1_Sz>,<VD2_Sz>,..|*all] [name=<VDNAME1>,..] drives=e:s|e:s-x|e:s-x,y;e:s-x,y,z [PDperArray=x] [SED] [pdcache=on|off|*default][pi] [DimmerSwitch(ds)=default|automatic (auto)|*none|maximum(max) |MaximumWithoutCaching(maxnocache)] [wt|*wb] [nora|*ra] [*direct|cached] [CachedBadBBU|*NoCachedBadBBU] [Stripe=<8|16|32|64|128|256|512|102 4] [AfterVd=X] [Spares=[e:]s|[e:]s-x|[e:]s-x,y] [force] storcli /c0 add vd type=road1 drives=252:0,252:1 (hint: use storcli /c0 show to view available enclosure/slot e:s drives) Create a CacheCade virtual drive MegaCLI -CfgCacheCadeAdd [-rX] -Physdrv[E0:S0,...] {-Name LdNamestring} [WT|WB|ForcedWB] [-assign -LX|L0,2,5..|LALL] -aN|-a0,1,2|-Aall storcli /cx add VD cachecade|cc Type=[0,1,10] drives=[e:]s|[e:]s-x|[e:]s-x,y [ < WT| WB> ] [assignvds=0,1,2] storcli /c0 add vd type=road1 drives=252:2,252:3 Create a RAID configuration of RAID type 10, 50, and 60. MegaCli \u2013CfgSpanAdd -aN|-a0,1,2|-aALL -R10|-R50|R60 \u2013Array0[E0:S0,E1:S1,...] \u2013Array1[E0:S0,E1:S1,...] [...] [WT | WB] [NORA | RA | ADRA] [Direct | Cached] [CachedBadBBU|NoCachedBadBBU] [-szXXXXXXXX [-szYYYYYYYY [... ]]] [-strpszM] [\u2013afterLdX] -aN storcli /cx add vd type=raid[10|50|60] [Size=<VD1_Sz>,<VD2_Sz>,..|*all] [name=<VDNAME1>,..] drives=e:s|e:s-x|e:s-x,y;e:s-x,y,z [PDperArray=x] [SED] [pdcache=on|off|*default][pi] [DimmerSwitch(ds)=default|automatic (auto)|*none|maximum(max) |MaximumWithoutCaching(maxnocache)] [wt|*wb] [nora|*ra] [*direct|cached] [CachedBadBBU|*NoCachedBadBBU] [Stripe=<8|16|32|64|128|256|512|102 4] [AfterVd=X] [Spares=[e:]s|[e:]s-x|[e:]s-x,y] [force] Delete a virtual drive MegaCli -CfgClr [-Force] -aN|-a0,1,2|-aALL storcli /cx/vx delete or storcli /cx/vall (to delete all virtual drives) storcli /c0/v0 delete (warning: there is no warning given; using /c0/vall will delete all logical drives and data with no warning) Show the topology information of the drive group MegaCLI -CfgDsply -aN|-a0,1,2|-Aall storcli /cx/dall show [all] storcli /cx0/d0 show Show information for a CacheCade virtual drive MegaCLI -CfgCacheCadeDsply -aN|-a0,1,2|-Aall storcli /cx/dall show CacheCade(cc) storcli /cx0/d0 show cc Delete a virtual drive hosting the operating system MegaCLI -CfgLdDel -LX|-L0,2,5...|-LALL [-Force] -aN|-a0,1,2|-aALL storcli /cx/vx[all] delete -force storcli /c0/v0 del -force Delete a CacheCade virtual drive MegaCLI -CfgCacheCadeDel -LX|-L0,2,5...|-LALL -aN|-a0,1,2|-Aall storcli /cx/vx[all] delete CacheCade(cc) storcli /c0/vx del cc Show, delete, and import the foreign configuration commands. MegaCli \u2013CfgForeign \u2013Scan | {-Preview | \u2013Dsply| -Import | -Clear[FID]} -aN|-a0,1,2|-aALL\" storcli /cx/f(x|all) show [all] [securityKey=xxx] storcli /cx/f(x|all) del|delete [securityKey=xxx] storcli /cx/f(x|all) import [preview] [securityKey=xxx]\" storcli /c0/fall show Patrol Read Commands Show the patrol read status and patrol read parameters, if any in progress. MegaCli -AdpPR -info -aN|-a0,1,2|-aALL /cx show patrolRead /c0 show patrolread Set the patrol read options on a single adapter, multiple adapters, or all adapters (x = single controller). MegaCli -AdpPR \u2013Dsbl|EnblAuto|EnblMan|Start|Stop| Info|Suspend|Resume|Stop| SSDPatrolReadEnbl | SSDPatrolReadDsbl |{SetDelay Val}|{-SetStartTime yyyymmdd hh}|{maxConcurrentPD Val} -aN|-a0,1,2|-aALL /cx set patrolread {=on mode=<auto|manual>}|{off} /cx set patrolread [starttime=< yyyy/mm/dd hh>] [maxconcurrentpd=<value>] [includessds=<on|off>] [uncfgareas=on|off] /cx set patrolread delay=<value> /c0 set patrolread mode=manual Disable patrol read. MegaCli -AdpPR -Dsbl -aN|-a0,1,2|-aALL storcli /cx set patrolread=off storcli /c0 set patrolread=off Enable automatic patrol read. MegaCli -AdpPR -EnblAuto -aN|-a0,1,2|-aALL storcli /cx set patrolread=on mode=auto storcli /cx set patrolread=off mode=auto Enable manual patrol read. MegaCli -AdpPR -EnblMan -aN|-a0,1,2|-aALL storcli /cx set patrolread=on mode=manual storcli /c0 set patrolread=on mode=manual Start patrol read. MegaCli -AdpPR -Start -aN|-a0,1,2|-aALL storcli /cx start patrolRead storcli /c0 start patrolRead Suspend a running patrol read MegaCli -AdpPR -Suspend -aN|-a0,1,2|-aALL storcli /cx suspend patrolread storcli /c0 suspend patrolread Resume a suspended patrol read MegaCli -AdpPR -Resume -aN|-a0,1,2|-aALL storcli /cx resume patrolread storcli /c0 resume patrolread Stop a running patrol read MegaCli -AdpPR -Stop -aN|-a0,1,2|-aALL storcli /cx stop patrolRead storcli /c0 stop patrolRead Include SSD drives in patrol read MegaCli -AdpPR -SSDPatrolReadEnbl -aN|-a0,1,2|-aALL storcli /cx set patrolRead includessds=on | onlymixed storcli /c0 set patrolRead includessds=on Exclude SSD drives in patrol read MegaCli -AdpPR -SSDPatrolReadDsbl -aN|-a0,1,2|-aALL storcli /cx set patrolRead includessds=off storcli /c0 set patrolRead includessds=off Delay a patrol read MegaCli -AdpPR -SetDelay Val -aN|-a0,1,2|-aALL storcli /cx set patrolread delay=<value> note: <value> unit of time is in hours storcli /c0 set patrolread delay=1 Schedule a patrol read MegaCli -AdpPR -SetStartTime yyyymmdd hh -aN|-a0,1,2|-aALL storcli /cx set patrolread=on starttime=YYYY/MM/DD HH Set the value for maximum concurrent physical drives for the patrol read. MegaCli -AdpPR -maxConcurrentPD Val -aN|-a0,1,2|-aALL storcli /cx set patrolread maxconcurrentpd=xx storcli /c0 set patrolread maxconcurrentpd=255 Consistency Check Commands Schedule a consistency check MegaCLI -AdpCcSched -Dsbl|-Info| {-ModeConc | -ModeSeq [-ExcludeLD -LN|-L0,1,2] [-SetStartTime yyyymmdd hh ] [-SetDelay val ] } -aN|-a0,1,2|-aALL storcli /cx set consistencycheck|cc=[off|seq|conc] [delay=value] starttime=yyyy/mm/dd hh [excludevd=x-y,z] storcli /c0 set cc=off Show consistency check status and consistency parameters, in progress, if any. MegaCLI -AdpCcSched -Info storcli /cx show cc/ConsistencyCheck storcli /c0 show cc OPROM BIOS Commands Schedule a consistency check MegaCli -AdpBIOS -Dsply -aN|-a0,1,2|-aALL storcli /cx show bios storcli /c0 show bios Show consistency check status and consistency parameters, if any in progress. MegaCli -AdpBootDrive -{-Set {-Lx | -physdrv[E0:S0]}} -aN|-a0,1,2|-aALL storcli /cx/ex/sx set bootdrive=on|off storcli /cx/vx set bootdrive=on|off storcli /c0/v0 set bootdrive=on Sets the BIOS properties for the controller. MegaCli -AdpBIOS -Enbl | -Dsbl | -Dsply | SOE | BE EnblAutoSelectBootLd | DsblAutoSelectBootLd -aN|-a0,1,2|-aALL storcli /cx set bios=<on|off> storcli /cx set stoponerror|soe=<on|off> storcli /cx set autobootselect(abs)=<on|off> storcli /c0 set bios=on Battery (BBU) Commands Show battery-related information MegaCli -AdpBbuCmd -aN|-a0,1,2|-aALL storcli /cx/bbu show storcli /cx/bbu show all storcli /c0/bbu show Show the battery learn properties MegaCli -AdpBbuCmd -GetBbuProperties -aN|-a0,1,2|-aALL storcli /cx/bbu show properties storcli /c0/bbu show properties Show the battery information, firmware status, and the gas gauge status. MegaCli -AdpBbuCmd -GetBbuStatus -aN|-a0,1,2|-aALL storcli /cx/bbu show status storcli /c0/bbu show status Show battery capacity information MegaCli -AdpBbuCmd -GetBbuCapacityInfo -aN|-a0,1,2|-aALL storcli /cx/bbu show all storcli /c0/bbu show all Show battery design information MegaCli -AdpBbuCmd -GetBbuDesignInfo -aN|-a0,1,2|-aALL storcli /cx/bbu show all storcli /c0/bbu show all Set battery properties MegaCli -AdpBbuCmd -SetBbuProperties -f <fileName> -aN|-a0,1,2|-aALL storcli /cx/bbu set learnDelayInterval=<value> storcli /cx/bbu set bbuMode=<value> storcli /cx bbu set autolearnmode=<value>, where x= 0 \u2013 Enabled, 1 \u2013 Disabled, 2 \u2013 Warn though event. storcli /c0/bbu set bbumode=5 Start battery learn cycle MegaCli -AdpBbuCmd -BbuLearn -aN|-a0,1,2|-aALL storcli /cx/bbu start learn storcli /co/bbu start learn Set the battery to low power storage mode. MegaCli -AdpBbuCmd -BbuMfgSleep -aN|-a0,1,2|-aALL storcli /cx/bbu set powermode=sleep Seal the gas gauge EEPROM write access MegaCli -AdpBbuCmd -BbuMfgSeal -aN|-a0,1,2|-aALL storcli /cx/bbu set writeaccess=sealed Security Commands Set the key ID for the controller. MegaCli -CreateSecurityKey -SecurityKey sssssssssss | [-Passphrase sssssssssss] | [-KeyID kkkkkkkkkkk] -aN storcli /cx set SecurityKey=XXXXXX [passphrase=yyyyy] [keyId=zzzz] Change the security key for the controller. MegaCli -ChangeSecurityKey -OldSecurityKey sssssssssss | -SecurityKey sssssssssss| [-Passphrase sssssssssss] | [-KeyID kkkkkkkkkkk] -aN storcli /cx set SecurityKey=XXXXXX OldSecurityKey=yyyyy Compare and verify the security key for the controller Compare and verify the security key for the controller Compare and verify the security key for the controller Delete the security key MegaCLI -DestroySecurityKey | [-Force] -aN storcli /cx delete SecurityKey Set the security key for the controller MegaCli -SetKeyID -KeyID kkkkkkkkkkk -aN storcli /cx set SecurityKey KeyId=xxxx Virtual Drive Commands Show the virtual drive information MegaCli \u2013LDInfo \u2013Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) show storcli /cx/v(x|all) show all Set virtual drive properties MegaCli \u2013LDSetProp WT | WB|NORA |RA | ADRA|-Cached|Direct| CachedBadBBU|NoCachedBadBBU} | -RW|RO|Blocked | {-Name nameString} | -EnDskCache|DisDskCache \u2013Lx| -L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) set wrcache=WT|WB|AWB storcli /cx/v(x|all) set rdcache=RA|NoRA storcli /cx/v(x|all) set iopolicy=Cached|Direct storcli /cx/v(x|all) set accesspolicy=RW|RO|Blocked|RmvBlkd storcli /cx/v(x|all) set pdcache=On|Off|Default storcli /cx/v(x|all) set name=<NameString> \" Set power-saving (dimmer switch) properties. MegaCli -LDSetPowerPolicy -Default| -Automatic| -None| -Maximum| -MaximumWithoutCaching -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) set ds=Default|Auto|None|Max|MaxNoCache Show virtual drive expansion information MegaCli -getLdExpansionInfo -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) show expansion Expand the virtual drive within the existing array; also use if you replace the drives with larger drives, beyond the size of the existing array. MegaCli -LdExpansion -pN -dontExpandArray -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) expand Size=<value> [expandarray] Secure the virtual drive. MegaCLI --LDMakeSecure -Lx|-L0,1,2,...|-Lall \u2013An storcli /cx/vx set security=on Show specific properties of virtual drives. MegaCli \u2013LDGetProp -Cache | -Access | -Name | -DskCache -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/vx show Start virtual drive initialization MegaCli \u2013LDInit \u2013Start [Fast|Full] -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) start init[Full] Stop a running virtual drive initialization. MegaCli \u2013LDInit -Abort -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) stop init Show the initialization progress MegaCli \u2013LDInit \u2013ShowProg -Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) show init Start a consistency check on an uninitialized virtual drive MegaCli \u2013LDCC \u2013Start \u2013Lx|-L0,1,2|-Lall -aN|-a0,1,2|-aALL storcli /cx/v(x|all) start cc[Force] Start, stop, suspend, resume, and show the progress of a consistency check operation MegaCli -LDCC -Start|-Abort| -Suspend|-Resume|-ShowProg| -ProgDsply -Lx|-L0,1,2|-LALL -aN|-a0,1,2|-aALL storcli /cx/v(x|all) start cc storcli /cx/v(x|all) stop cc storcli /cx/v(x|all) pause cc storcli /cx/v(x|all) resume cc storcli /cx/v(x|all) show cc Enable/disable automatic background initialization. Show, stop, pause, resume, and show the progress of the background initialization. MegaCLI -LDBI -Enbl|-Dsbl| -getSetting|-Abort|-Suspend| -Resume|-ShowProg|-ProgDsply -Lx|-L0,1,2|-LALL -aN|-a0,1,2|-Aall storcli /cx/v(x|all) set autobgi=On|Off storcli /cx/v(x|all) show autobgi storcli /cx/v(x|all) stop bgi storcli /cx/v(x|all) pause bgi storcli /cx/v(x|all) resume bgi storcli /cx/v(x|all) show bgi Start and show progress for a migrate operation. MegaCli \u2013LDRecon {\u2013Start \u2013Rx [Add | Rmv PhysDrv[E0:S0,E1:S1,...] ] } | \u2013ShowProg|-ProgDsply \u2013Lx \u2013aN storcli /cx/vx start migrate type=raidx [option=add|remove drives=[e:]s|[e:]s-x|[e:]s-x,y] [Force] storcli /cx/v(x|all) show migrate Delete preserved cache MegaCLI -DiscardPreservedCache -Lx|-L0,1,2|-Lall -force -aN|-a0,1,2|-aALL storcli /cx/v(x|all) delete preservedcache[force] Assign the CacheCade virtual drive MegaCLI -Cachecade -assign|-remove -Lx|-L0,1,2|-LALL -aN|-a0,1,2|-aALL storcli /cx/vx|all set ssdCaching=on|off Physical Drive Commands Show drive information MegaCli -pdInfo - PhysDrv[E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx show storcli /cx/ex/sx show all Start, stop, suspend, or resume an ongoing rebuild operation. MegaCLI PDRbld -Start|-Stop |-Suspend|-Resume|-ShowProg |-ProgDsply -PhysDrv [E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx start rebuild storcli /cx/ex/sx stop rebuild storcli /cx/ex/sx pause rebuild storcli /cx/ex/sx resume rebuild storcli /cx/ex/sx show rebuild Start, stop, pause, resume, or show the progress of a copyback operation MegaCLI PDCpyBk -Start|-Stop |-Suspend|-Resume|-ShowProg |-ProgDsply -PhysDrv [E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx start copyback target=exx:sxx storcli /cx/ex/sx stop copyback storcli /cx/ex/sx pause copyback storcli /cx/ex/sx resume copyback storcli /cx/ex/sx show copyback Mark a drive as missing MegaCli -PdMarkMissing -physdrv[E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx set missing Show missing drive information MegaCli -PdGetMissing -aN|-a0,1,2|-aALL storcli /cx/ex/sx show all NOTE This information is shown as part of the show all command. Replace the configured drive that is identified as missing, and then start an automatic rebuild. MegaCli -PdReplaceMissing -physdrv[E0:S0] -arrayA, -rowB -aN storcli /cx/ex/sx insert array=x row=y Set the drive state to online MegaCli \u2013PDOnline - PhysDrv[E0:S0,E1:S1....] -aN|-a0,1,2 storcli /cx/ex/sx set online Set the drive state to offline MegaCli \u2013PDOffline -PhysDrv[E0:S0,E1:S1....] -aN|-a0,1,2|-aALL storcli /cx/ex/sx set offline Set the drive state to JBOD MegaCli \u2013PDMakeGood -PhysDrv[E0:S0,E1:S1....] -aN|-a0,1,2|-aALL storcli /cx/ex/sx set good [force] or storcli /cx/ex/sx set jbod Add and delete hotspare drives MegaCli \u2013PDHSP {\u2013Set [{-Dedicated -ArrayN | -Array0,1...}] [-EnclAffinity] [-nonRevertible] } | -Rmv -PhysDrv[E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx add hotsparedrive [dgs=<N|0,1,2..>] enclaffinity nonrevertible storcli /cx/ex/sx delete hotsparedrive Start, stop, pause, resume or show the progress of an initialization process. MegaCli \u2013PDClear -Start |-Stop| -ShowProg |-ProgDsply - PhysDrv[E0:S0,E1:S1....] -aN|-a0,1,2|-aALL storcli /cx/ex/sx start initialization storcli /cx/ex/sx stop initialization storcli /cx/ex/sx pause initialization storcli /cx/ex/sx resume initialization storcli /cx/ex/sx show initialization Start a drive locate and activate (blink) the drive\u2019s LED or stop a drive locate (LED blinking) and deactivate the drive\u2019s LED MegaCli \u2013PDLocate {[-start] | -stop} -physdrv[E0:S0,E1:S1,...] -aN|-a0,1,2|-aALL storcli /cx/ex/sx start locate storcli /cx/ex/sx stop locate Spin down an unconfigured drive and prepare it for removal or spin up spun-down drive and mark the drive state as unconfigured good. MegaCli \u2013PDPrpRmv [-Undo] \u2013 PhysDrv[E0:S0,E1:S1....] -aN|-a0,1,2|-aALL storcli /cx/ex/sx spindown storcli /cx/ex/sx spinup Show physical drive information of all connected drives. MegaCli \u2013PDList -aN|-a0,1..|-aAll storcli /cx/eall/sall show [all] NOTE This command does not show drives whose enclosure device ID is not available. Flash the physical drive firmware MegaCLI PdFwDownload[offline] [ForceActivate] {[-SataBridge] -PhysDrv[0:1]}|{-EncdevId[devId1 ]} -f <filename> -aN|-a0,1,2|-Aall storcli /cx[/ex]/sx download src=<filepath> [satabridge] storcli /cx/ex download src=<filepath> [forceActivate] Erase the drive's security configuration and securely erase data on a drive. MegaCli -PDInstantSecureErase -PhysDrv[E0:S0,E1:S1,...] | [-Force] -aN|-a0,1,2|-aALL storcli /cx/ex/sx secureerase [force] Show the security key for secured physical drives MegaCli -GetKeyID [-PhysDrv[E0:S0]] -aN storcli /cx/ex/sx show securitykey keyid Start, stop, and show the progress of a secure erase operation MegaCli -SecureErase Start[ Simple| [Normal [ |ErasePattern ErasePatternA|ErasePattern ErasePatternA ErasePattern ErasePatternB]]|[Thorough [ |ErasePattern ErasePatternA|ErasePattern ErasePatternA ErasePattern ErasePatternB]]] | Stop| ShowProg| ProgDsply [-PhysDrv [E0:S0,E1:S1,...] | -Lx|-L0,1,2|-LALL] -aN|-a0,1,2|-aALL storcli /cx[/ex]/sx start erase [simple| normal| thorough] [erasepatternA=<val>]\\n[erasepatternB=< val>] Examples: storcli /cx/ex/sx start erase simple storcli /cx/ex/sx start erase normal erasepatterna=10101010 storcli /cx/ex/sx start erase thorough erasepatterna=10101010 erasepatternb=10101111 storcli /cx/ex/sx stop erase Enable/disable the direct physical drive mapping mode. Show the current state of the direct physical drive mapping. MegaCLI DirectPdMapping -Enbl|-Dsbl|-Dsply -aN|-a0,1,2|-Aall storcli /cx set directpdmapping=<on | off> storcli /cx show directpdmapping Enclosure Commands Show enclosure information MegaCli \u2013EncInfo -aN|-a0,1,2|-aALL storcli /cx/ex show storcli /cx/ex show all Show enclosure status MegaCli \u2013EncStatus -aN|-a0,1,2|-aALL /cx/ex show status Download enclosure firmware. /cx/ex download src=filepath [offline] [forceActivate PHY Commands Show PHY information MegaCli \u2013PHYInfo -phyM -aN|-a0,1,2|-aALL storcli /cx/px(x|all) show storcli /cx/px(x|all) show all Set PHY link speed MegaCLI PhySetLinkSpeed -phyM -speed -aN|-a0,1,2|-aALL storcli /cx/px(x|all) set linkspeed=1.5|3|6|12|auto Show the PHY error counters. Megacli PhyErrorCounters -An storcli /cx/px(x|all) show storcli /cx/px(x|all) show all Alarm Commands Show alarm properties MegaCli -AdpGetProp AlarmDsply -aN|-a0,1,2|-aALL storcli /cx(x|all) show alarm Set alarm properties MegaCli -AdpSetProp AlarmEnbl | AlarmDsbl | AlarmSilence -aN|-a0,1,2|-aALL storcli /cx(x|all) set alarm=<on|off|silence> Event Log Properties Commands Show event logs. MegaCli -AdpEventLog -GetEventLogInfo -aN|-a0,1,2|-aALL /cx show eventloginfo Show the specified type of event logs. MegaCli -AdpEventLog -GetEvents {-info -warning -critical -fatal} {-f <fileName>} -aN|-a0,1,2|-aALL storcli /cx show events [type=[latest=x|ccincon vd=|[sincereboot|sinceshutdown|included eleted|latest|ccincon]]] [filter=[info|warning|critical|fatal]] file=xyz.txt Show the specified event logs MegaCli -AdpEventLog -GetSinceShutdown {-info -warning -critical -fatal} {-f <fileName>} -aN|-a0,1,2|-aALL storcli /cx show events [type=[latest=x|ccincon vd=|[sincereboot|sinceshutdown|included eleted|latest|ccincon]]] [filter=[info|warning|critical|fatal]] file=xyz.txt Delete the event logs. MegaCli -AdpEventLog -Clear -aN|-a0,1,2|-aALL storcli /cx delete events Premium Feature Key Commands Show the Safe ID of the controller MegaCli -ELF -GetSafeId -a0 storcli /cx(x|all) show safeid Show the Advanced Software Options that are enabled on the controller, including the ones in trial mode. MegaCli -ELF \u2013ControllerFeatures -a0 MegaCli -ELF \u2013ControllerFeatures -a0 Apply the Activation Key in preview mode. MegaCli -ELF -Applykey key \u2013val -preview -a0 storcli /cx(x|all) set aso key=<key value> preview Apply the Activation Key MegaCli -ELF -Applykey key \u2013val -a0 storcli /cx(x|all) set aso key=<key value> Deactivate the trial key MegaCli -ELF \u2013DeactivateTrialKey -a0 storcli /cx(x|all) set aso deactivatetrialkey Show the re-host information and, if re-hosting is necessary, show the controller and key vault serial numbers. MegaCli -ELF -ReHostInfo -a0 storcli /cx(x|all) show rehostinfo Indicate to the controller that the re-host is complete MegaCli -ELF -ReHostComplete -a0 storcli /cx(x|all) set aso rehostcomplete","title":"Information regarding the disks"},{"location":"megaraid/","text":"lsi_cackecade_pro_2.0_test PDF \u505aRAID\u65f6Write Policy,Read Policy,Cache Policy\u5982\u4f55\u914d\u7f6e \u00b6 Read-ahead\uff08\u9884\u8bfb\uff09\u542f\u7528\u903b\u8f91\u9a71\u52a8\u5668\u7684SCSI\u9884\u8bfb\u529f\u80fd\u3002 \u53ef\u5c06\u6b64\u53c2\u6570\u8bbe\u4e3a \u00b6 No-Read-Ahead\uff08\u975e\u9884\u8bfb\uff09 Read-ahead\uff08\u9884\u8bfb\uff09 Adaptive\uff08\u81ea\u9002\u5e94\uff09\u3002 \u9ed8\u8ba4\u8bbe\u7f6e\u4e3aAdaptive\uff08\u81ea\u9002\u5e94\uff09\u3002 No-Read-Ahead\uff08\u975e\u9884\u8bfb\uff09 \u00b6 \u6307\u5b9a\u63a7\u5236\u5668\u5728\u5f53\u524d\u903b\u8f91\u9a71\u52a8\u5668\u4e2d\u4e0d\u4f7f\u7528\u9884\u8bfb\u65b9\u5f0f\u3002 Read-ahead\uff08\u9884\u8bfb\uff09 \u00b6 \u6307\u5b9a\u63a7\u5236\u5668\u5728\u5f53\u524d\u903b\u8f91\u9a71\u52a8\u5668\u4e2d\u4f7f\u7528\u9884\u8bfb\u65b9\u5f0f\u3002 Adaptive\uff08\u81ea\u9002\u5e94\uff09 \u00b6 \u6307\u5b9a\u5982\u679c\u6700\u8fd1\u4e24\u6b21\u7684\u78c1\u76d8\u8bbf\u95ee\u51fa\u73b0\u5728\u8fde\u7eed\u7684\u6247\u533a\u5185\uff0c\u5219\u63a7\u5236\u5668\u5f00\u59cb\u91c7\u7528Read-ahead\uff08\u9884\u8bfb\uff09\u3002 \u5982\u679c\u6240\u6709\u7684\u8bfb\u53d6\u8bf7\u6c42\u90fd\u662f\u968f\u673a\u7684\uff0c\u5219\u8be5\u7b97\u6cd5\u56de\u590d\u5230No-Read-Ahead\uff08\u975e\u9884\u8bfb\uff09\uff0c\u4f46\u4ecd\u8981\u5224\u65ad\u6240\u6709\u7684\u8bfb\u53d6\u8bf7\u6c42\u662f\u5426\u6709\u6309\u987a\u5e8f\u64cd\u4f5c\u7684\u53ef\u80fd\u3002 Cache Policy\uff08\u9ad8\u901f\u7f13\u5b58\u7b56\u7565\uff09 \u9002\u5408\u5728\u7279\u5b9a\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\u8bfb\u53d6\u3002 \u5b83\u5e76\u4e0d\u5f71\u54cdRead ahead\uff08\u9884\u8bfb\uff09\u9ad8\u901f\u7f13\u5b58\u3002 \u00b6 Cached I/O\uff08\u9ad8\u901f\u7f13\u5b58I/O\uff09\u6307\u5b9a\u6240\u6709\u8bfb\u53d6\u6570\u636e\u5728\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u4e2d\u7f13\u5b58\u3002 Direct I/O\uff08\u76f4\u63a5I/O\uff09\u6307\u5b9a\u8bfb\u53d6\u6570\u636e\u4e0d\u5728\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u4e2d\u7f13\u5b58\u3002 \u6b64\u4e3a\u9ed8\u8ba4\u8bbe\u7f6e\u3002 \u5b83\u4e0d\u4f1a\u4ee3\u66ff\u9ad8\u901f\u7f13\u5b58\u7b56\u7565\u8bbe\u7f6e\u3002\u6570\u636e\u88ab\u540c\u65f6\u4f20\u9001\u5230\u9ad8\u901f\u7f13\u5b58\u548c\u4e3b\u673a\u3002 \u5982\u679c\u518d\u6b21\u8bfb\u53d6\u540c\u4e00\u6570\u636e\u5757\uff0c\u5219\u4ece\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u8bfb\u53d6 Write Policy\uff08\u5199\u5165\u7b56\u7565\uff09 \u5c06\u9ad8\u901f\u7f13\u5b58\u65b9\u6cd5\u8bbe\u7f6e\u4e3a\u56de\u5199\u6216\u901a\u8fc7\u5199\u3002 \u00b6 \u5728Write-back\uff08\u56de\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u4e2d\uff0c\u5f53\u63a7\u5236\u5668\u9ad8\u901f\u7f13\u5b58\u5df2\u63a5\u6536\u5230\u67d0\u4e2a\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u6570\u636e\u65f6\uff0c\u8be5\u63a7\u5236\u5668\u5c06\u6570\u636e\u4f20\u8f93\u5b8c\u6210\u4fe1\u53f7\u53d1\u9001\u7ed9\u4e3b\u673a\u3002 \u5728Write-through\uff08\u901a\u8fc7\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u4e2d\uff0c\u5f53\u78c1\u76d8\u5b50\u7cfb\u7edf\u5df2\u63a5\u6536\u5230\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u6570\u636e\u65f6\uff0c\u8be5\u63a7\u5236\u5668\u5c06\u6570\u636e\u4f20\u8f93\u5b8c\u6210\u4fe1\u53f7\u53d1\u9001\u7ed9\u4e3b\u673a\u3002 Write-through\uff08\u901a\u8fc7\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u4e0eWrite-back\uff08\u56de\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u76f8\u6bd4\u5177\u6709\u6570\u636e\u5b89\u5168\u7684\u4f18\u52bf\uff0c\u4f46Write-back\uff08\u56de\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u6bd4\u8d77Write-through\uff08\u901a\u8fc7\u5199\uff09\u53c8\u6709\u6027\u80fd\u4e0a\u7684\u4f18\u52bf\u3002 \u67e5\u770bRAID\u5361\u7535\u6c60\u60c5\u51b5 \u00b6 MegaCli64 -AdpBbuCmd -GetBbuStatus -aAll \u5982\u679c\u8fd4\u56de\u5982\u4e0b\u9519\u8bef\u90a3\u4e48\u53ef\u80fd\u662fRAID\u5361BUU\u7535\u6c60\u6709\u95ee\u9898\u6216\u8005\u6ca1\u6709\u7535\u6c60\u4fdd\u62a4\u529f\u80fd\uff1a Adapter 0: Get BBU Status Failed. FW error description: The required hardware component is not present. Exit Code: 0x22 \u67e5\u770b\u5f53\u524dRAID\u5361\u7f13\u5b58\u7b56\u7565 \u00b6 # MegaCli64 -LDinfo -Lall -aAll Default Cache Policy: WriteThrough, ReadAheadNone, Direct, No Write Cache if Bad BBU Current Cache Policy: WriteThrough, ReadAheadNone, Direct, No Write Cache if Bad BBU \u7b2c\u4e00\u90e8\u5206\uff1a WriteBack:\u5199\u7f13\u5b58\u7b56\u7565 WriteThrough:\u76f4\u63a5\u5199\u5165\u78c1\u76d8\uff0c\u4e0d\u9002\u7528RAID\u5361\u7f13\u5b58\u3002 \u7b2c\u4e8c\u90e8\u5206\uff1a ReadAheadNone:\u4e0d\u5f00\u542f\u9884\u8bfb ReadAhead:\u5f00\u542f\u9884\u8bfb\uff0c\u5728\u8bfb\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u9884\u5148\u628a\u540e\u9762\u987a\u5e8f\u7684\u6570\u636e\u8f7d\u5165raid\u5361\u7f13\u5b58\uff0c\u5728\u987a\u5e8f\u8bfb\u7684\u73af\u5883\u4e2d\u80fd\u63d0\u4f9b\u5f88\u597d\u7684\u6027\u80fd\uff0c\u4f46\u662f\u5728\u968f\u673a\u8bfb\u7684\u73af\u5883\u4e2d\u53cd\u800c\u964d\u4f4e\u8bfb\u7684\u6027\u80fd\uff08\u9002\u5408\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e0d\u9002\u5408\u6570\u636e\u5e93\u7cfb\u7edf\uff09 ReadAdaptive:\u81ea\u9002\u5e94\u9884\u8bfb\uff0c\u5728\u7f13\u5b58\u548cI/O\u7a7a\u95f2\u65f6\u9009\u62e9\u9884\u8bfb\uff0c\u9ed8\u8ba4\u7b56\u7565\u3002 \u7b2c\u4e09\u90e8\u5206\uff1a Direct:\u8bfb\u64cd\u4f5c\u4e0d\u7f13\u5b58\u5230RAID\u5361\u7f13\u5b58\u3002 Cached:\u8bfb\u64cd\u4f5c\u7f13\u5b58\u5230RAID\u5361\u7f13\u5b58\u3002 \u7b2c\u56db\u90e8\u5206\uff1a\u5982\u679cBBU(\u7535\u6c60)\u51fa\u73b0\u95ee\u9898\u662f\u5426\u542f\u7528Write Cache No Write Cache if Bad BBU:\u5982\u679cBBU\u51fa\u73b0\u95ee\u9898\u4e0d\u4f7f\u7528Write Cache\uff0c\u4eceWriteBack\u81ea\u52a8\u5207\u6362\u5230WriteThrough\uff0c\u9ed8\u8ba4\u914d\u7f6e\u3002 Write Cache OK if Bad BBU: \u5982\u679cBBU\u51fa\u73b0\u95ee\u9898\u4ecd\u542f\u7528Write Cache,\u8fd9\u79cd\u914d\u7f6e\u662f\u975e\u5e38\u4e0d\u5b89\u5168\u7684\uff0c\u9664\u975e\u662f\u6709UPS\u6216\u8005\u53cc\u7535\u6e90\u7684\u60c5\u51b5\u4e0b\u3002 RAID\u5361\u7b56\u7565\u66f4\u6539 \u00b6 \u4fee\u6539WriteBack\uff1a MegaCli64 -LDSetProp -WB -Lall -aAll \u4fee\u6539WriteThrough: MegaCli64 -LDSetProp -WT -Lall -aAll \u4fee\u6539No Write Cache if Bad BBU: MegaCli64 -LDSetProp -NoCachedBadBBU -Lall -aAll \u4fee\u6539Write Cache OK if Bad BBU: MegaCli64 -LDSetProp -CachedBadBBU -Lall -aAll \u5176\u5b83\u76f8\u5173\u547d\u4ee4 \u00b6 \u5176\u5b83\u76f8\u5173\u547d\u4ee4 \u67e5\u770b\u673a\u5668\u578b\u53f7 # dmidecode | grep \"Product\" \u67e5\u770b\u5382\u5546 # dmidecode| grep \"Manufacturer\" \u67e5\u770b\u5e8f\u5217\u53f7 # dmidecode | grep \"Serial Number\" \u67e5\u770bCPU\u4fe1\u606f # dmidecode | grep \"CPU\" \u67e5\u770bCPU\u4e2a\u6570 # dmidecode | grep \"Socket Designation: CPU\" |wc \u2013l \u67e5\u770b\u51fa\u5382\u65e5\u671f # dmidecode | grep \"Date\" \u67e5\u770b\u5145\u7535\u72b6\u6001 # MegaCli64 -AdpBbuCmd-GetBbuStatus -aALL |grep \"Charger Status\" \u663e\u793aBBU\u72b6\u6001\u4fe1\u606f # MegaCli64 -AdpBbuCmd-GetBbuStatus \u2013aALL \u663e\u793aBBU\u5bb9\u91cf\u4fe1\u606f # MegaCli64 -AdpBbuCmd-GetBbuCapacityInfo \u2013aALL \u663e\u793aBBU\u8bbe\u8ba1\u53c2\u6570 # MegaCli64 -AdpBbuCmd-GetBbuDesignInfo \u2013aALL \u663e\u793a\u5f53\u524dBBU\u5c5e\u6027 # MegaCli64 -AdpBbuCmd-GetBbuProperties \u2013aALL \u67e5\u770b\u5145\u7535\u8fdb\u5ea6\u767e\u5206\u6bd4 # MegaCli64 -AdpBbuCmd-GetBbuStatus -aALL |grep \"Relative State of Charge\" \u67e5\u8be2Raid\u9635\u5217\u6570 # MegaCli64 -cfgdsply -aALL|grep \"Number of DISK GROUPS:\" \u663e\u793aRaid\u5361\u578b\u53f7\uff0cRaid\u8bbe\u7f6e\uff0cDisk\u76f8\u5173\u4fe1\u606f # MegaCli64-cfgdsply \u2013aALL \u663e\u793a\u6240\u6709\u7269\u7406\u4fe1\u606f # MegaCli64 -PDList-aALL \u663e\u793a\u6240\u6709\u903b\u8f91\u78c1\u76d8\u7ec4\u4fe1\u606f # MegaCli64 -LDInfo -LALL\u2013aAll \u67e5\u770b\u7269\u7406\u78c1\u76d8\u91cd\u5efa\u8fdb\u5ea6(\u91cd\u8981) # MegaCli64 -PDRbld-ShowProg -PhysDrv [1:5] -a0 \u67e5\u770b\u9002\u914d\u5668\u4e2a\u6570 #MegaCli64 \u2013adpCount \u67e5\u770b\u9002\u914d\u5668\u65f6\u95f4 #MegaCli64 -AdpGetTime\u2013aALL \u663e\u793a\u6240\u6709\u9002\u914d\u5668\u4fe1\u606f #MegaCli64 -AdpAllInfo\u2013aAll \u67e5\u770bCache \u7b56\u7565\u8bbe\u7f6e # MegaCli64 -cfgdsply -aALL|grep Polic radi\u5361\u7535\u6c60\u5145\u653e\u7535:http://www.tuicool.com/articles/a2AzAb","title":"megaraid"},{"location":"megaraid/#raidwrite-policyread-policycache-policy","text":"","title":"\u505aRAID\u65f6Write Policy,Read Policy,Cache Policy\u5982\u4f55\u914d\u7f6e"},{"location":"megaraid/#read-aheadscsi","text":"No-Read-Ahead\uff08\u975e\u9884\u8bfb\uff09 Read-ahead\uff08\u9884\u8bfb\uff09 Adaptive\uff08\u81ea\u9002\u5e94\uff09\u3002 \u9ed8\u8ba4\u8bbe\u7f6e\u4e3aAdaptive\uff08\u81ea\u9002\u5e94\uff09\u3002","title":"Read-ahead\uff08\u9884\u8bfb\uff09\u542f\u7528\u903b\u8f91\u9a71\u52a8\u5668\u7684SCSI\u9884\u8bfb\u529f\u80fd\u3002 \u53ef\u5c06\u6b64\u53c2\u6570\u8bbe\u4e3a"},{"location":"megaraid/#no-read-ahead","text":"\u6307\u5b9a\u63a7\u5236\u5668\u5728\u5f53\u524d\u903b\u8f91\u9a71\u52a8\u5668\u4e2d\u4e0d\u4f7f\u7528\u9884\u8bfb\u65b9\u5f0f\u3002","title":"No-Read-Ahead\uff08\u975e\u9884\u8bfb\uff09"},{"location":"megaraid/#read-ahead","text":"\u6307\u5b9a\u63a7\u5236\u5668\u5728\u5f53\u524d\u903b\u8f91\u9a71\u52a8\u5668\u4e2d\u4f7f\u7528\u9884\u8bfb\u65b9\u5f0f\u3002","title":"Read-ahead\uff08\u9884\u8bfb\uff09"},{"location":"megaraid/#adaptive","text":"\u6307\u5b9a\u5982\u679c\u6700\u8fd1\u4e24\u6b21\u7684\u78c1\u76d8\u8bbf\u95ee\u51fa\u73b0\u5728\u8fde\u7eed\u7684\u6247\u533a\u5185\uff0c\u5219\u63a7\u5236\u5668\u5f00\u59cb\u91c7\u7528Read-ahead\uff08\u9884\u8bfb\uff09\u3002 \u5982\u679c\u6240\u6709\u7684\u8bfb\u53d6\u8bf7\u6c42\u90fd\u662f\u968f\u673a\u7684\uff0c\u5219\u8be5\u7b97\u6cd5\u56de\u590d\u5230No-Read-Ahead\uff08\u975e\u9884\u8bfb\uff09\uff0c\u4f46\u4ecd\u8981\u5224\u65ad\u6240\u6709\u7684\u8bfb\u53d6\u8bf7\u6c42\u662f\u5426\u6709\u6309\u987a\u5e8f\u64cd\u4f5c\u7684\u53ef\u80fd\u3002","title":"Adaptive\uff08\u81ea\u9002\u5e94\uff09"},{"location":"megaraid/#cache-policy-read-ahead","text":"Cached I/O\uff08\u9ad8\u901f\u7f13\u5b58I/O\uff09\u6307\u5b9a\u6240\u6709\u8bfb\u53d6\u6570\u636e\u5728\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u4e2d\u7f13\u5b58\u3002 Direct I/O\uff08\u76f4\u63a5I/O\uff09\u6307\u5b9a\u8bfb\u53d6\u6570\u636e\u4e0d\u5728\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u4e2d\u7f13\u5b58\u3002 \u6b64\u4e3a\u9ed8\u8ba4\u8bbe\u7f6e\u3002 \u5b83\u4e0d\u4f1a\u4ee3\u66ff\u9ad8\u901f\u7f13\u5b58\u7b56\u7565\u8bbe\u7f6e\u3002\u6570\u636e\u88ab\u540c\u65f6\u4f20\u9001\u5230\u9ad8\u901f\u7f13\u5b58\u548c\u4e3b\u673a\u3002 \u5982\u679c\u518d\u6b21\u8bfb\u53d6\u540c\u4e00\u6570\u636e\u5757\uff0c\u5219\u4ece\u9ad8\u901f\u7f13\u5b58\u5b58\u50a8\u5668\u8bfb\u53d6","title":"Cache Policy\uff08\u9ad8\u901f\u7f13\u5b58\u7b56\u7565\uff09 \u9002\u5408\u5728\u7279\u5b9a\u903b\u8f91\u9a71\u52a8\u5668\u4e0a\u8bfb\u53d6\u3002 \u5b83\u5e76\u4e0d\u5f71\u54cdRead ahead\uff08\u9884\u8bfb\uff09\u9ad8\u901f\u7f13\u5b58\u3002"},{"location":"megaraid/#write-policy","text":"\u5728Write-back\uff08\u56de\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u4e2d\uff0c\u5f53\u63a7\u5236\u5668\u9ad8\u901f\u7f13\u5b58\u5df2\u63a5\u6536\u5230\u67d0\u4e2a\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u6570\u636e\u65f6\uff0c\u8be5\u63a7\u5236\u5668\u5c06\u6570\u636e\u4f20\u8f93\u5b8c\u6210\u4fe1\u53f7\u53d1\u9001\u7ed9\u4e3b\u673a\u3002 \u5728Write-through\uff08\u901a\u8fc7\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u4e2d\uff0c\u5f53\u78c1\u76d8\u5b50\u7cfb\u7edf\u5df2\u63a5\u6536\u5230\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u7684\u6240\u6709\u6570\u636e\u65f6\uff0c\u8be5\u63a7\u5236\u5668\u5c06\u6570\u636e\u4f20\u8f93\u5b8c\u6210\u4fe1\u53f7\u53d1\u9001\u7ed9\u4e3b\u673a\u3002 Write-through\uff08\u901a\u8fc7\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u4e0eWrite-back\uff08\u56de\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u76f8\u6bd4\u5177\u6709\u6570\u636e\u5b89\u5168\u7684\u4f18\u52bf\uff0c\u4f46Write-back\uff08\u56de\u5199\uff09\u9ad8\u901f\u7f13\u5b58\u6bd4\u8d77Write-through\uff08\u901a\u8fc7\u5199\uff09\u53c8\u6709\u6027\u80fd\u4e0a\u7684\u4f18\u52bf\u3002","title":"Write Policy\uff08\u5199\u5165\u7b56\u7565\uff09 \u5c06\u9ad8\u901f\u7f13\u5b58\u65b9\u6cd5\u8bbe\u7f6e\u4e3a\u56de\u5199\u6216\u901a\u8fc7\u5199\u3002"},{"location":"megaraid/#raid","text":"MegaCli64 -AdpBbuCmd -GetBbuStatus -aAll \u5982\u679c\u8fd4\u56de\u5982\u4e0b\u9519\u8bef\u90a3\u4e48\u53ef\u80fd\u662fRAID\u5361BUU\u7535\u6c60\u6709\u95ee\u9898\u6216\u8005\u6ca1\u6709\u7535\u6c60\u4fdd\u62a4\u529f\u80fd\uff1a Adapter 0: Get BBU Status Failed. FW error description: The required hardware component is not present. Exit Code: 0x22","title":"\u67e5\u770bRAID\u5361\u7535\u6c60\u60c5\u51b5"},{"location":"megaraid/#raid_1","text":"# MegaCli64 -LDinfo -Lall -aAll Default Cache Policy: WriteThrough, ReadAheadNone, Direct, No Write Cache if Bad BBU Current Cache Policy: WriteThrough, ReadAheadNone, Direct, No Write Cache if Bad BBU \u7b2c\u4e00\u90e8\u5206\uff1a WriteBack:\u5199\u7f13\u5b58\u7b56\u7565 WriteThrough:\u76f4\u63a5\u5199\u5165\u78c1\u76d8\uff0c\u4e0d\u9002\u7528RAID\u5361\u7f13\u5b58\u3002 \u7b2c\u4e8c\u90e8\u5206\uff1a ReadAheadNone:\u4e0d\u5f00\u542f\u9884\u8bfb ReadAhead:\u5f00\u542f\u9884\u8bfb\uff0c\u5728\u8bfb\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u9884\u5148\u628a\u540e\u9762\u987a\u5e8f\u7684\u6570\u636e\u8f7d\u5165raid\u5361\u7f13\u5b58\uff0c\u5728\u987a\u5e8f\u8bfb\u7684\u73af\u5883\u4e2d\u80fd\u63d0\u4f9b\u5f88\u597d\u7684\u6027\u80fd\uff0c\u4f46\u662f\u5728\u968f\u673a\u8bfb\u7684\u73af\u5883\u4e2d\u53cd\u800c\u964d\u4f4e\u8bfb\u7684\u6027\u80fd\uff08\u9002\u5408\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e0d\u9002\u5408\u6570\u636e\u5e93\u7cfb\u7edf\uff09 ReadAdaptive:\u81ea\u9002\u5e94\u9884\u8bfb\uff0c\u5728\u7f13\u5b58\u548cI/O\u7a7a\u95f2\u65f6\u9009\u62e9\u9884\u8bfb\uff0c\u9ed8\u8ba4\u7b56\u7565\u3002 \u7b2c\u4e09\u90e8\u5206\uff1a Direct:\u8bfb\u64cd\u4f5c\u4e0d\u7f13\u5b58\u5230RAID\u5361\u7f13\u5b58\u3002 Cached:\u8bfb\u64cd\u4f5c\u7f13\u5b58\u5230RAID\u5361\u7f13\u5b58\u3002 \u7b2c\u56db\u90e8\u5206\uff1a\u5982\u679cBBU(\u7535\u6c60)\u51fa\u73b0\u95ee\u9898\u662f\u5426\u542f\u7528Write Cache No Write Cache if Bad BBU:\u5982\u679cBBU\u51fa\u73b0\u95ee\u9898\u4e0d\u4f7f\u7528Write Cache\uff0c\u4eceWriteBack\u81ea\u52a8\u5207\u6362\u5230WriteThrough\uff0c\u9ed8\u8ba4\u914d\u7f6e\u3002 Write Cache OK if Bad BBU: \u5982\u679cBBU\u51fa\u73b0\u95ee\u9898\u4ecd\u542f\u7528Write Cache,\u8fd9\u79cd\u914d\u7f6e\u662f\u975e\u5e38\u4e0d\u5b89\u5168\u7684\uff0c\u9664\u975e\u662f\u6709UPS\u6216\u8005\u53cc\u7535\u6e90\u7684\u60c5\u51b5\u4e0b\u3002","title":"\u67e5\u770b\u5f53\u524dRAID\u5361\u7f13\u5b58\u7b56\u7565"},{"location":"megaraid/#raid_2","text":"\u4fee\u6539WriteBack\uff1a MegaCli64 -LDSetProp -WB -Lall -aAll \u4fee\u6539WriteThrough: MegaCli64 -LDSetProp -WT -Lall -aAll \u4fee\u6539No Write Cache if Bad BBU: MegaCli64 -LDSetProp -NoCachedBadBBU -Lall -aAll \u4fee\u6539Write Cache OK if Bad BBU: MegaCli64 -LDSetProp -CachedBadBBU -Lall -aAll","title":"RAID\u5361\u7b56\u7565\u66f4\u6539"},{"location":"megaraid/#_1","text":"\u5176\u5b83\u76f8\u5173\u547d\u4ee4 \u67e5\u770b\u673a\u5668\u578b\u53f7 # dmidecode | grep \"Product\" \u67e5\u770b\u5382\u5546 # dmidecode| grep \"Manufacturer\" \u67e5\u770b\u5e8f\u5217\u53f7 # dmidecode | grep \"Serial Number\" \u67e5\u770bCPU\u4fe1\u606f # dmidecode | grep \"CPU\" \u67e5\u770bCPU\u4e2a\u6570 # dmidecode | grep \"Socket Designation: CPU\" |wc \u2013l \u67e5\u770b\u51fa\u5382\u65e5\u671f # dmidecode | grep \"Date\" \u67e5\u770b\u5145\u7535\u72b6\u6001 # MegaCli64 -AdpBbuCmd-GetBbuStatus -aALL |grep \"Charger Status\" \u663e\u793aBBU\u72b6\u6001\u4fe1\u606f # MegaCli64 -AdpBbuCmd-GetBbuStatus \u2013aALL \u663e\u793aBBU\u5bb9\u91cf\u4fe1\u606f # MegaCli64 -AdpBbuCmd-GetBbuCapacityInfo \u2013aALL \u663e\u793aBBU\u8bbe\u8ba1\u53c2\u6570 # MegaCli64 -AdpBbuCmd-GetBbuDesignInfo \u2013aALL \u663e\u793a\u5f53\u524dBBU\u5c5e\u6027 # MegaCli64 -AdpBbuCmd-GetBbuProperties \u2013aALL \u67e5\u770b\u5145\u7535\u8fdb\u5ea6\u767e\u5206\u6bd4 # MegaCli64 -AdpBbuCmd-GetBbuStatus -aALL |grep \"Relative State of Charge\" \u67e5\u8be2Raid\u9635\u5217\u6570 # MegaCli64 -cfgdsply -aALL|grep \"Number of DISK GROUPS:\" \u663e\u793aRaid\u5361\u578b\u53f7\uff0cRaid\u8bbe\u7f6e\uff0cDisk\u76f8\u5173\u4fe1\u606f # MegaCli64-cfgdsply \u2013aALL \u663e\u793a\u6240\u6709\u7269\u7406\u4fe1\u606f # MegaCli64 -PDList-aALL \u663e\u793a\u6240\u6709\u903b\u8f91\u78c1\u76d8\u7ec4\u4fe1\u606f # MegaCli64 -LDInfo -LALL\u2013aAll \u67e5\u770b\u7269\u7406\u78c1\u76d8\u91cd\u5efa\u8fdb\u5ea6(\u91cd\u8981) # MegaCli64 -PDRbld-ShowProg -PhysDrv [1:5] -a0 \u67e5\u770b\u9002\u914d\u5668\u4e2a\u6570 #MegaCli64 \u2013adpCount \u67e5\u770b\u9002\u914d\u5668\u65f6\u95f4 #MegaCli64 -AdpGetTime\u2013aALL \u663e\u793a\u6240\u6709\u9002\u914d\u5668\u4fe1\u606f #MegaCli64 -AdpAllInfo\u2013aAll \u67e5\u770bCache \u7b56\u7565\u8bbe\u7f6e # MegaCli64 -cfgdsply -aALL|grep Polic radi\u5361\u7535\u6c60\u5145\u653e\u7535:http://www.tuicool.com/articles/a2AzAb","title":"\u5176\u5b83\u76f8\u5173\u547d\u4ee4"},{"location":"mysql-ha/","text":"Mysql\u96c6\u7fa4\u4e4bmysql\u53cc\u4e3b\u53cc\u6d3b+keepalived\u5b9e\u73b0\u9ad8\u53ef\u7528mysql+keepalived\u642d\u5efa\u6559\u7a0b \u4e00\u3001\u4ecb\u7ecd \u00b6 MySQL\u53cc\u4e3b\u53cc\u6d3b\u662f\u6307\u4e24\u53f0mysql\u670d\u52a1\u5668mysql-1\u3001mysql-2\u90fd\u4e3amaster\u4e3b\u8282\u70b9\u670d\u52a1\u5668\uff0c\u540c\u65f6\u53c8\u662f\u5bf9\u65b9\u7684slave\u4ece\u8282\u70b9\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u90fd\u53ef\u4f5c\u4e3a\u4e3b\u6570\u636e\u5e93\u4f7f\u7528\uff0c\u5e76\u5c06\u5bf9\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u6570\u636e\u540c\u6b65\u81f3\u53e6\u5916\u4e00\u53f0mysql\u670d\u52a1\u4e2d\u3002 \u5f53\u5e94\u7528\u670d\u52a1\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86mysql-1\u8fde\u63a5\u4fe1\u606f\uff0c\u5728\u6253\u5305\u53d1\u5e03\u540e\uff0c\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f\u5df2\u7ecf\u56fa\u5b9a\uff0c\u5f53\u6570\u636e\u5e93mysql-1\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u9700\u8981\u4eba\u5de5\u5e72\u9884\u5148\u5c06\u5e94\u7528\u670d\u52a1\u505c\u6b62-->\u5c06\u5e94\u7528\u670d\u52a1\u7684mysql\u8fde\u63a5\u4fe1\u606f\u6539\u4e3amysql-2 -->\u5728\u542f\u52a8\u5e94\u7528\u670d\u52a1\u5668\uff0c\u6bd4\u8f83\u7e41\u7410\uff0c\u5f53\u5e94\u7528\u670d\u52a1\u5668\u8f83\u591a\u65f6\uff0c\u4e00\u4e2a\u4e00\u4e2a\u5173\u95ed\uff0c\u4fee\u6539\uff0c\u518d\u91cd\u542f\uff0c\u5c06\u803d\u8bef\u66f4\u591a\u65f6\u95f4\uff0c\u5e94\u7528\u670d\u52a1\u5668\u4fee\u590d\u6545\u969c\u65f6\u95f4\u5ef6\u957f\uff0c\u4e25\u91cd\u65f6\u4f1a\u9020\u6210\u707e\u96be\u6027\u7684\u540e\u679c\u3002 \u6545\u800c\u5f15\u5165\u4e86keepalived\uff0ckeepalived\u901a\u8fc7VIP\u865a\u62dfIP\u7684\u6f02\u79fb\u5b9e\u73b0\u9ad8\u53ef\u7528\uff0c\u5728\u76f8\u540c\u96c6\u7fa4\u5185\u53d1\u9001\u7ec4\u64ad\u5305\uff0cmaster\u4e3b\u901a\u8fc7VRRP\u534f\u8bae\u53d1\u9001\u7ec4\u64ad\u5305\uff0c\u544a\u8bc9\u4ece\u4e3b\u7684\u72b6\u6001\u3002 \u5f53\u6211\u4eec\u901a\u8fc7keepalived\u865a\u62df\u51fa\u4e00\u4e2aip\u670d\u52a1 mysql-3\uff0c\u5e94\u7528\u670d\u52a1\u53ea\u9700\u8981\u5c06mysql\u914d\u7f6e\u4fe1\u606f\u66f4\u6539\u4e3amysql-3\u7684\u914d\u7f6e\u4fe1\u606f\uff0cmysql-3\u5b9e\u9645\u4ee3\u7406\u7684\u5b9e\u4f53\u670d\u52a1\u5668\u4e3amysql-1\u6216mysql-2\u3002 \u4f8b\u5982\uff1a\u5f53mysql-3\u5b9e\u9645\u4ee3\u7406mysql-1\u65f6\uff0cmysql-1\u670d\u52a1\u51fa\u73b0\u6545\u969c\u540e\uff0ckeepalived\u901a\u8fc7\u81ea\u8eab\u673a\u5236\uff0c\u81ea\u52a8\u5c06mysql-2\u4f5c\u4e3a\u5b9e\u9645\u4ee3\u7406\u4e3b\u670d\u52a1\u5668\uff0c\u4e0d\u9700\u8981\u4eba\u5de5\u5e72\u9884\u53bb\u4fee\u6539mysql\u914d\u7f6e\u4fe1\u606f\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u9ad8\u53ef\u7528\u3002 \u4e8c\u3001\u51c6\u5907\u5de5\u4f5c \u00b6 \u4e24\u53f0centos7 linux\u670d\u52a1\u5668 mysql-1\uff1a192.168.222.128 mysql-2\uff1a192.168.222.129 mysql\u5b89\u88c5\u5305 \u7248\u672c\uff1amysql-5.7.36-el7-x86_64.tar.gz \u4e0b\u8f7d\u5730\u5740\uff1ahttps://cdn.mysql.com/archives/mysql-5.7/mysql-test-5.7.36-el7-x86_64.tar.gz keepalived\u5b89\u88c5\u5305 \u7248\u672c\uff1akeepalived-2.2.7.tar.gz \u4e0b\u8f7d\u5730\u5740\uff1ahttps://www.keepalived.org/software/keepalived-2.2.7.tar.gz \u4e09\u3001\u5b89\u88c5mysql \u00b6 \u5728128\u3001129\u4e24\u53f0\u670d\u52a1\u5668\u6839\u636e\u300alinux\u5b89\u88c5mysql\u670d\u52a1-\u4e24\u79cd\u5b89\u88c5\u65b9\u5f0f\u6559\u7a0b\u300b\u5b89\u88c5\u597dmysql\u5e94\u7528\u3002 \u4fee\u6539128\u670d\u52a1\u5668/etc/my.cnf\u914d\u7f6e\u6587\u4ef6\uff0c\u6ca1\u6709\u7684\u8bdd\u53ef\u81ea\u884c\u521b\u5efa\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a [client] # \u5ba2\u6237\u7aef\u8fde\u63a5\u7aef\u53e3 port=3306 # \u5ba2\u6237\u7aef\u8fde\u63a5sock socket=/opt/mysql5.7/log/mysql.socka # \u5ba2\u6237\u7aef\u7f16\u7801 default-character-set=utf8 [mysqld] # mysql\u670d\u52a1\u7aef\u53e3 port=3306 #\u5b89\u88c5\u76ee\u5f55 basedir=/opt/mysql5.7 #\u6570\u636e\u5b58\u653e\u76ee\u5f55 datadir=/opt/mysql5.7/data #sock\u6587\u4ef6\u5730\u5740 socket=/opt/mysql5.7/log/mysql.sock #\u9519\u8bef\u65e5\u5fd7\u5b58\u653e\u5730\u5740 log-error=/opt/mysql5.7/log/mysql.log #pid\u6587\u4ef6\u5730\u5740 pid-file=/opt/mysql5.7/log/mysql.pid #\u4e0b\u9762\u5185\u5bb9\u4e3amysq\u4e3b\u5907\u65f6\u914d\u7f6e\uff0c\u5355mysql\u90e8\u7f72\u62a4\u7406\u4e0b\u9762\u914d\u7f6e #server-id \u591a\u53f0\u670d\u52a1\u5668\u65f6\uff0c\u6b64\u8868\u793a\u9700\u8981\u552f\u4e00 server-id=1 #\u4e3b\u4ece\u540c\u6b65bin-log\u65e5\u5fd7\u6587\u4ef6\u540d log-bin=mysql-bin #\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_do_db\u914d\u7f6e binlog_do_db=test_db #\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u4e0d\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_ignore_db\u914d\u7f6e #binlog_ignore_db=mysql #binlog_ignore_db=information_schema #binlog_ignore_db=sys #binlog_ignore_db=performance_schema #\u4e3b\u4ece\u540c\u6b65\u65b9\u5f0f binlog_format=row #\u670d\u52a1\u7aef\u7f16\u7801 character-set-server=utf8 !includedir /etc/my.cnf.d \u4fee\u6539129\u670d\u52a1\u5668/etc/my.cnf\u914d\u7f6e\u6587\u4ef6\uff0c\u53ea\u6709server-id\u4e0d\u540c\uff0c\u4e3a2\u914d\u7f6e\u5982\u4e0b [client] #\u5ba2\u6237\u7aef\u8fde\u63a5\u7aef\u53e3 port=3306 #\u5ba2\u6237\u7aef\u8fde\u63a5sock socket=/opt/mysql5.7/log/mysql.socka #\u5ba2\u6237\u7aef\u7f16\u7801 default-character-set=utf8 [mysqld] #mysql\u670d\u52a1\u7aef\u53e3 port=3306 #\u5b89\u88c5\u76ee\u5f55 basedir=/opt/mysql5.7 #\u6570\u636e\u5b58\u653e\u76ee\u5f55 datadir=/opt/mysql5.7/data #sock\u6587\u4ef6\u5730\u5740 socket=/opt/mysql5.7/log/mysql.sock #\u9519\u8bef\u65e5\u5fd7\u5b58\u653e\u5730\u5740 log-error=/opt/mysql5.7/log/mysql.log #pid\u6587\u4ef6\u5730\u5740 pid-file=/opt/mysql5.7/log/mysql.pid #\u4e0b\u9762\u5185\u5bb9\u4e3amysq\u4e3b\u5907\u65f6\u914d\u7f6e\uff0c\u5355mysql\u90e8\u7f72\u62a4\u7406\u4e0b\u9762\u914d\u7f6e #server-id \u591a\u53f0\u670d\u52a1\u5668\u65f6\uff0c\u6b64\u8868\u793a\u9700\u8981\u552f\u4e00 server-id=2 #\u4e3b\u4ece\u540c\u6b65bin-log\u65e5\u5fd7\u6587\u4ef6\u540d log-bin=mysql-bin #\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_do_db\u914d\u7f6e binlog_do_db=test_db #\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u4e0d\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_ignore_db\u914d\u7f6e #binlog_ignore_db=mysql #binlog_ignore_db=information_schema #binlog_ignore_db=sys #binlog_ignore_db=performance_schema #\u4e3b\u4ece\u540c\u6b65\u65b9\u5f0f binlog_format=row #\u670d\u52a1\u7aef\u7f16\u7801 character-set-server=utf8 !includedir /etc/my.cnf.d \u91cd\u542fmysql\u670d\u52a1 [root@128 mysql5.7]# systemctl stop mysqld [root@128 mysql5.7]# systemctl start mysqld \u56db\u3001mysql\u6570\u636e\u5e93\u53cc\u4e3b\u53cc\u4ece\u914d\u7f6e \u00b6 1.\u8fde\u63a5128\u670d\u52a1\u5668mysql\uff0c\u5e76\u521b\u5efa\u4e3b\u4ece\u540c\u6b65\u8d26\u6237slavebak\uff0c\u5e76\u67e5\u770bmaster\u72b6\u6001\uff0c\u8bb0\u5f55\u4e0bfile\u3001psition\u503c\uff0c\u914d\u7f6e129mysql\u4ece\u5e93\u65f6\u4f7f\u7528 [root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> grant replication slave on *.* to slavebak@'%' identified by 'slavebak'; mysql> flush privileges; mysql> show master status; +------------------+----------+--------------+------------------+-------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set | +------------------+----------+--------------+------------------+-------------------+ | mysql-bin.000002 | 1287 | test_db | | | +------------------+----------+--------------+------------------+-------------------+ 1 row in set (0.01 sec) mysql> 2.\u8fde\u63a5129\u670d\u52a1\u5668\uff0c\u4f7f\u7528slavebak\u7528\u6237\u8fdc\u7a0b\u767b\u5f55128mysql\uff0c\u6d4b\u8bd5\u8fde\u63a5\u662f\u5426\u6b63\u5e38\u3002 [root@129 ~]# /opt/mysql5.7/bin/mysql -h192.168.222.128 -uslavebak -pslavebak mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> exit; [root@129 ~]# 3.\u5728129\u670d\u52a1\u5668\u7528root\u8fde\u63a5\u672c\u670d\u52a1\u5668mysql\uff0c\u5e76\u914d\u7f6e128\u7684\u4e3b\u5e93\u4fe1\u606f [root@129 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> change master to -> master_host='192.168.222.128', #128\u670d\u52a1\u5668mysql ip -> master_port=3306, #128\u670d\u52a1\u5668mysql\u7aef\u53e3 -> master_user='slavebak', #128\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237 -> master_password='slavebak', #128\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237\u5bc6\u7801 -> master_log_file='mysql-bin.000002', #\u524d\u9762\u8bb0\u5f55\u7684128\u670d\u52a1mysql file\u503c -> master_log_pos=1287; #\u524d\u9762\u8bb0\u5f55\u7684128\u670d\u52a1mysql psition\u503c Query OK, 0 rows affected, 2 warnings (0.02 sec) mysql> start slave; #\u542f\u52a8\u4ece\u5e93\u914d\u7f6e 4.\u67e5\u770b129\u4ece\u5e93\u914d\u7f6e\u662f\u5426\u6210\u529fSlave_IO_Running\u3001Slave_SQL_Running\u90fd\u4e3ayes\u5219\u6210\u529f mysql> show slave status; mysql> show slave status \\G; *************************** 1. row *************************** ...... Slave_IO_Running: Yes #\u6b64\u503c\u4e3ayes\u914d\u7f6e\u6210\u529f Slave_SQL_Running: Yes #\u6b64\u503c\u4e3ayes\u914d\u7f6ei\u6210\u529f ...... 1 row in set (0.01 sec) 5.\u5728129\u670d\u52a1\u5668mysql\u521b\u5efa\u4e3b\u4ece\u540c\u6b65\u8d26\u6237slavebak\uff0c\u67e5\u770bmaster\u72b6\u6001\uff0c\u8bb0\u5f55\u4e0bfile\u3001psition\u503c mysql> grant replication slave on *.* to slavebak@'%' identified by 'slavebak'; mysql> flush privileges; mysql> show master status; +------------------+----------+--------------+------------------+-------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set | +------------------+----------+--------------+------------------+-------------------+ | mysql-bin.000002 | 848 | test_db | | | +------------------+----------+--------------+------------------+-------------------+ 1 row in set (0.01 sec) 6.\u8fde\u63a5128\u670d\u52a1\u5668\u5e76\u4f7f\u7528root\u7528\u6237\u8fde\u63a5\u672c\u670d\u52a1\u5668mysql\uff0c\u914d\u7f6e129\u7684\u4e3b\u5e93\u4fe1\u606f [root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> change master to -> master_host='192.168.222.129', #129\u670d\u52a1\u5668mysql ip -> master_port=3306, #129\u670d\u52a1\u5668mysql\u7aef\u53e3 -> master_user='slavebak', #129\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237 -> master_password='slavebak', #129\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237\u5bc6\u7801 -> master_log_file='mysql-bin.000002', #\u524d\u9762\u8bb0\u5f55\u7684129\u670d\u52a1mysql file\u503c -> master_log_pos=848; #\u524d\u9762\u8bb0\u5f55\u7684129\u670d\u52a1mysql psition\u503c Query OK, 0 rows affected, 2 warnings (0.02 sec) mysql> start slave; #\u542f\u52a8\u4ece\u5e93\u914d\u7f6e 7.\u67e5\u770b128\u4ece\u5e93\u914d\u7f6e\u662f\u5426\u6210\u529fSlave_IO_Running\u3001Slave_SQL_Running\u90fd\u4e3ayes\u5219\u6210\u529f mysql> show slave status; mysql> show slave status \\G; *************************** 1. row *************************** ...... Slave_IO_Running: Yes #\u6b64\u503c\u4e3ayes\u914d\u7f6e\u6210\u529f Slave_SQL_Running: Yes #\u6b64\u503c\u4e3ayes\u914d\u7f6ei\u6210\u529f ...... 1 row in set (0.01 sec) \u81f3\u6b64\uff0c128\u670d\u52a1\u5668\uff0c129\u670d\u52a1\u5668\u53cc\u4e3b\u53cc\u4ece\u914d\u7f6e\u5b8c\u6210 \u4e94\u3001MySQL\u53cc\u4e3b\u53cc\u4ece\u6d4b\u8bd5 \u00b6 \u8fde\u63a5128\u670d\u52a1\u5668\uff0c\u4f7f\u7528root\u7528\u6237\u8fde\u63a5\u672c\u673amysql\uff0c\u5e76\u521b\u5efatest_db\u6570\u636e\u5e93\uff0ct_test\u8868\uff0c\u5e76\u63d2\u5165\u4e00\u6761\u6570\u636eid=1,name='zhangsan' [root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> create database test_db; Query OK, 1 row affected (0.00 sec) mysql> use test_db; mysql> create table t_test(id int primary key, name varchar(30)); Query OK, 0 row affected (0.01 sec) mysql> insert into t_test values (1, 'zhangsan'); Query OK, 1 row affected (0.01 sec) mysql> select * from t_test; +----+----------+ | id | name | +----+----------+ | 1 | zhangsan | +----+----------+ 1 rows in set (0.00 sec) \u8fde\u63a5129\u670d\u52a1\u5668\uff0c\u4f7f\u7528root\u7528\u6237\u8fde\u63a5mysql\uff0c\u67e5\u770btest_db\u6570\u636e\u5e93\u3001t_test\u8868\u4ee5\u53ca\u6570\u636e\u662f\u5426\u540c\u6b65\uff0c\u5e76\u63d2\u5165id=2\uff0cname=\u2018lisi\u2019 [root@129 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> show databases; +--------------------+ | Database | +--------------------+ | information_schema | | mysql | | performance_schema | | sys | | test_db | #test_db\u6570\u636e\u5e93\u5df2\u540c\u6b65\u8fc7\u6765 +--------------------+ 5 rows in set (0.01 sec) mysql> use test_db; mysql> show tables; +-------------------+ | Tables_in_test_db | +-------------------+ | t_test | #t_test\u8868\u5df2\u540c\u6b65\u8fc7\u6765 +-------------------+ 1 row in set (0.01 sec) mysql> select * from t_test; +----+----------+ | id | name | +----+----------+ | 1 | zhangsan | #\u6570\u636e\u5df2\u540c\u6b65\u8fc7\u6765 +----+----------+ 1 rows in set (0.00 sec) mysql> insert into t_test values (2, 'lisi'); Query OK, 1 row affected (0.01 sec) \u5728128\u670d\u52a1\u5668\u67e5\u770bid=2\uff0cname=\"lisi\" \u662f\u5426\u540c\u6b65 [root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> select * from t_test; +----+----------+ | id | name | +----+----------+ | 1 | zhangsan | | 2 | lisi | #lisi\u6570\u636e\u5df2\u540c\u6b65 +----+----------+ 1 rows in set (0.00 sec) \u81f3\u6b64\uff0c\u6570\u636e\u5e93\u53cc\u4e3b\u53cc\u4ece\u6d4b\u8bd5\u5b8c\u6210\u3002 \u516d\u3001keepalived\u5b89\u88c5 \u00b6 128\u3001129\u4e24\u53f0\u670d\u52a1\u5668\u5b89\u88c5\u6b65\u9aa4\u76f8\u540c\uff0c\u914d\u7f6e\u6587\u4ef6\u4e0d\u540c\uff0c\u4e0b\u9762\u6709\u4ecb\u7ecd\u3002 \u5b89\u88c5\u76f8\u5173\u4f9d\u8d56\u5305\uff0c\u5e76\u4e0b\u8f7dkeepalived\u5b89\u88c5\u5305\uff0c\u89e3\u538b\uff0c\u914d\u7f6e\uff0c\u7f16\u8bd1 [root@128 ~]# cd /opt [root@128 opt]# yum -y install gcc openssl-devel popt-devel psmisc [root@128 opt]# wget https://www.keepalived.org/software/keepalived-2.2.7.tar.gz [root@128 opt]# tar -zxvf keepalived-2.2.7.tar.gz [root@128 opt]# cd keepalived-2.2.7 [root@128 keepalived-2.2.7]# ./configure --prefix=/opt/keepalived-2.2.7 [root@128 keepalived-2.2.7]# make && make install \u5c06\u6587\u4ef6\u590d\u5236\u5230\u5bf9\u5e94\u76ee\u5f55\u4e0b [root@128 keepalived-2.2.7]# mkdir /etc/keepalived [root@128 keepalived-2.2.7]# cp keepalived/etc/keepalived/keepalived.conf.sample /etc/keepalived/keepalived.conf [root@128 keepalived-2.2.7]# cp keepalived/etc/init.d/keepalived /etc/init.d/ [root@128 keepalived-2.2.7]# cp keepalived/etc/sysconfig/keepalived /etc/sysconfig/ [root@128 keepalived-2.2.7]# cp bin/keepalived /usr/sbin/ \u65b0\u5efa/etc/keepalived/shutdown.sh\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a\uff1a #!/bin/bash #\u8be5\u811a\u672c\u662f\u5728mysql\u670d\u52a1\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u5c06keepalived\u5e94\u7528\u505c\u6b62\uff0c\u4ece\u800c\u4f7f\u865a\u62dfvip\u4e3b\u673a\u81ea\u52a8\u8fde\u63a5\u5230\u53e6\u4e00\u53f0mysql\u4e0a killall keepalived \u4f7f\u7528ifconfig\u547d\u4ee4\u67e5\u770b\u4e0b\u7f51\u5361\u540d\u79f0\uff0c\u672c\u673a\u7f51\u5361\u540d\u79f0\u4e3aens33 \u4fee\u6539128\u670d\u52a1\u5668/etc/keepalived/keepalived.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a ! Configuration File for keepalived global_defs { notification_email { acassen@firewall.loc failover@firewall.loc sysadmin@firewall.loc } notification_email_from Alexandre.Cassen@firewall.loc smtp_server 192.168.200.1 smtp_connect_timeout 30 router_id LVS_MASTER vrrp_skip_check_adv_addr vrrp_strict vrrp_garp_interval 0 vrrp_gna_interval 0 } vrrp_instance VI_1 { state MASTER #interface\u4e3a\u521a\u624d\u67e5\u5230\u7684\u672c\u673a\u7f51\u5361\u540d\u79f0 interface ens33 #\u540c\u4e00\u7f51\u6bb5\u4e2d\u540c\u4e00\u7ec4virtual_router_id\u503c\u76f8\u540c\u3002\u4e0d\u540c\u7ec4virtual_router_id\u503c\u552f\u4e00\u3002 #\u5982server-1\u3001server-2\u4e3a\u4e00\u7ec4\uff0cvirtual_router_id=51 #server-3\u3001server-4\u4e3a\u4e00\u7ec4\uff0c\u5219virtual_router_id\u4e0d\u80fd\u4e3a51 virtual_router_id 51 #\u5b57\u6570\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0cmaster\u5fc5\u987b\u5927\u4e8ebackup priority 100 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { #\u8be5ip\u4e3a\u865a\u62df\u51fa\u6765\u7684vip\u5730\u5740 192.168.222.130 } } #\u914d\u7f6evirtual_server ip\u4e3a\u4e0a\u9762\u914d\u7f6e\u7684\u865a\u62dfvip\u5730\u5740 \u7aef\u53e3\u4e3amysql\u7684\u7aef\u53e3 virtual_server 192.168.222.130 3306 { delay_loop 6 lb_algo rr lb_kind NAT persistence_timeout 50 protocol TCP #real_server \u8be5\u914d\u7f6e\u4e3a\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740 \u4ee5\u53ca\u5b9e\u9645\u7269\u7406\u673amysql\u7aef\u53e3 real_server 192.168.222.128 3306 { #\u5f53\u8be5ip \u7aef\u53e3\u8fde\u63a5\u5f02\u5e38\u65f6\uff0c\u6267\u884c\u8be5\u811a\u672c notify_down /etc/keepalived/shutdow.sh TCP_CHECK { #\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740 connect_ip 192.168.222.128 #\u5b9e\u9645\u7269\u7406\u673aport\u7aef\u53e3 connect_port 3306 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } } } \u4fee\u6539129\u670d\u52a1\u5668/etc/keepalived/keepalived.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0e128\u7684\u914d\u7f6e\u4e0d\u540c\u5730\u65b9\u4e3areal_server\u3001connect_ip \u4e24\u4e2a\u914d\u7f6e\uff0c\u9700\u8981\u914d\u7f6e\u5bf9\u5e94\u7684\u5b9e\u9645\u4e3b\u673aip\uff0c\u8be6\u7ec6\u5185\u5bb9\u5982\u4e0b\uff1a ! Configuration File for keepalived global_defs { notification_email { acassen@firewall.loc failover@firewall.loc sysadmin@firewall.loc } notification_email_from Alexandre.Cassen@firewall.loc smtp_server 192.168.200.1 smtp_connect_timeout 30 router_id LVS_MASTER vrrp_skip_check_adv_addr vrrp_strict vrrp_garp_interval 0 vrrp_gna_interval 0 } vrrp_instance VI_1 { state BACKUP #interface\u4e3a\u521a\u624d\u67e5\u5230\u7684\u672c\u673a\u7f51\u5361\u540d\u79f0 interface ens33 #\u540c\u4e00\u7f51\u6bb5\u4e2d\u540c\u4e00\u7ec4virtual_router_id\u503c\u76f8\u540c\u3002\u4e0d\u540c\u7ec4virtual_router_id\u503c\u552f\u4e00\u3002 #\u5982server-1\u3001server-2\u4e3a\u4e00\u7ec4\uff0cvirtual_router_id=51 #server-3\u3001server-4\u4e3a\u4e00\u7ec4\uff0c\u5219virtual_router_id\u4e0d\u80fd\u4e3a51 virtual_router_id 51 #\u5b57\u6570\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0cmaster\u5fc5\u987b\u5927\u4e8ebackup priority 90 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { #\u8be5ip\u4e3a\u865a\u62df\u51fa\u6765\u7684vip\u5730\u5740 192.168.222.130 } } #\u914d\u7f6evirtual_server ip\u4e3a\u4e0a\u9762\u914d\u7f6e\u7684\u865a\u62dfvip\u5730\u5740 \u7aef\u53e3\u4e3amysql\u7684\u7aef\u53e3 virtual_server 192.168.222.130 3306 { delay_loop 6 lb_algo rr lb_kind NAT persistence_timeout 50 protocol TCP #real_server \u8be5\u914d\u7f6e\u4e3a\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740 \u4ee5\u53ca\u5b9e\u9645\u7269\u7406\u673amysql\u7aef\u53e3 real_server 192.168.222.129 3306 { #\u5f53\u8be5ip \u7aef\u53e3\u8fde\u63a5\u5f02\u5e38\u65f6\uff0c\u6267\u884c\u8be5\u811a\u672c notify_down /etc/keepalived/shutdow.sh TCP_CHECK { #\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740 connect_ip 192.168.222.129 #\u5b9e\u9645\u7269\u7406\u673aport\u7aef\u53e3 connect_port 3306 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } } } \u8be6\u7ec6\u914d\u7f6e\u53c2\u8003 \u300aKeepalived \u5b89\u88c5\u548c\u914d\u7f6e\u8be6\u89e3\u300b \u5c06128\u3001129\u670d\u52a1\u5668keepalived\u52a0\u5165\u5f00\u673a\u81ea\u542f\uff0c\u5e76\u542f\u52a8\u670d\u52a1 [root@128 keepalived-2.2.7]# systemctl enable keepalived [root@128 keepalived-2.2.7]# systemctl start keepalived \u542f\u52a8\u540ekeepalived\u72b6\u6001\u4e3a\uff1aactive(running)\u5219\u6b63\u5e38 \u542f\u52a8\u540e\u76f8\u5f53\u4e8e\u865a\u62df\u51fa\u4e00\u4e2avip 192.168.222.130\uff0c\u53ef\u4f7f\u7528\u8fdc\u7a0b\u8fde\u63a5\u5de5\u5177\uff0c\u8fde\u63a5\u8be5\u670d\u52a1\u5668\uff0c\u8fde\u63a5\u8fdb\u53bb\u540e\u4f7f\u7528ifconfig\u67e5\u770b\u8be5\u865a\u62dfvip\u5b9e\u9645\u4e0a\u4f7f\u7528\u7684\u5b9e\u4f53\u670d\u52a1\u5668\u662f129\u670d\u52a1\u5668\u3002 \u5c06129\u670d\u52a1\u5668\u7684keepalived\u5e94\u7528\u505c\u6b62\uff0c\u518d\u6b21\u67e5\u770b130\u670d\u52a1ifconfig\uff0c\u53ef\u4ee5\u770b\u5230\uff0c130\u670d\u52a1\u5668\u81ea\u52a8\u5c06\u5b9e\u4f53\u673aip\u6f02\u79fb\u5230\u4e86128\u670d\u52a1\u5668\u4e0a \u81f3\u6b64\uff0ckeepalived\u90e8\u7f72\u5b8c\u6210\u3002","title":"mysql+keepalived\u642d\u5efa\u6559\u7a0b"},{"location":"mysql-ha/#_1","text":"MySQL\u53cc\u4e3b\u53cc\u6d3b\u662f\u6307\u4e24\u53f0mysql\u670d\u52a1\u5668mysql-1\u3001mysql-2\u90fd\u4e3amaster\u4e3b\u8282\u70b9\u670d\u52a1\u5668\uff0c\u540c\u65f6\u53c8\u662f\u5bf9\u65b9\u7684slave\u4ece\u8282\u70b9\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u90fd\u53ef\u4f5c\u4e3a\u4e3b\u6570\u636e\u5e93\u4f7f\u7528\uff0c\u5e76\u5c06\u5bf9\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u6570\u636e\u540c\u6b65\u81f3\u53e6\u5916\u4e00\u53f0mysql\u670d\u52a1\u4e2d\u3002 \u5f53\u5e94\u7528\u670d\u52a1\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u4e86mysql-1\u8fde\u63a5\u4fe1\u606f\uff0c\u5728\u6253\u5305\u53d1\u5e03\u540e\uff0c\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f\u5df2\u7ecf\u56fa\u5b9a\uff0c\u5f53\u6570\u636e\u5e93mysql-1\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u9700\u8981\u4eba\u5de5\u5e72\u9884\u5148\u5c06\u5e94\u7528\u670d\u52a1\u505c\u6b62-->\u5c06\u5e94\u7528\u670d\u52a1\u7684mysql\u8fde\u63a5\u4fe1\u606f\u6539\u4e3amysql-2 -->\u5728\u542f\u52a8\u5e94\u7528\u670d\u52a1\u5668\uff0c\u6bd4\u8f83\u7e41\u7410\uff0c\u5f53\u5e94\u7528\u670d\u52a1\u5668\u8f83\u591a\u65f6\uff0c\u4e00\u4e2a\u4e00\u4e2a\u5173\u95ed\uff0c\u4fee\u6539\uff0c\u518d\u91cd\u542f\uff0c\u5c06\u803d\u8bef\u66f4\u591a\u65f6\u95f4\uff0c\u5e94\u7528\u670d\u52a1\u5668\u4fee\u590d\u6545\u969c\u65f6\u95f4\u5ef6\u957f\uff0c\u4e25\u91cd\u65f6\u4f1a\u9020\u6210\u707e\u96be\u6027\u7684\u540e\u679c\u3002 \u6545\u800c\u5f15\u5165\u4e86keepalived\uff0ckeepalived\u901a\u8fc7VIP\u865a\u62dfIP\u7684\u6f02\u79fb\u5b9e\u73b0\u9ad8\u53ef\u7528\uff0c\u5728\u76f8\u540c\u96c6\u7fa4\u5185\u53d1\u9001\u7ec4\u64ad\u5305\uff0cmaster\u4e3b\u901a\u8fc7VRRP\u534f\u8bae\u53d1\u9001\u7ec4\u64ad\u5305\uff0c\u544a\u8bc9\u4ece\u4e3b\u7684\u72b6\u6001\u3002 \u5f53\u6211\u4eec\u901a\u8fc7keepalived\u865a\u62df\u51fa\u4e00\u4e2aip\u670d\u52a1 mysql-3\uff0c\u5e94\u7528\u670d\u52a1\u53ea\u9700\u8981\u5c06mysql\u914d\u7f6e\u4fe1\u606f\u66f4\u6539\u4e3amysql-3\u7684\u914d\u7f6e\u4fe1\u606f\uff0cmysql-3\u5b9e\u9645\u4ee3\u7406\u7684\u5b9e\u4f53\u670d\u52a1\u5668\u4e3amysql-1\u6216mysql-2\u3002 \u4f8b\u5982\uff1a\u5f53mysql-3\u5b9e\u9645\u4ee3\u7406mysql-1\u65f6\uff0cmysql-1\u670d\u52a1\u51fa\u73b0\u6545\u969c\u540e\uff0ckeepalived\u901a\u8fc7\u81ea\u8eab\u673a\u5236\uff0c\u81ea\u52a8\u5c06mysql-2\u4f5c\u4e3a\u5b9e\u9645\u4ee3\u7406\u4e3b\u670d\u52a1\u5668\uff0c\u4e0d\u9700\u8981\u4eba\u5de5\u5e72\u9884\u53bb\u4fee\u6539mysql\u914d\u7f6e\u4fe1\u606f\uff0c\u4ece\u800c\u5b9e\u73b0\u4e86\u9ad8\u53ef\u7528\u3002","title":"\u4e00\u3001\u4ecb\u7ecd"},{"location":"mysql-ha/#_2","text":"\u4e24\u53f0centos7 linux\u670d\u52a1\u5668 mysql-1\uff1a192.168.222.128 mysql-2\uff1a192.168.222.129 mysql\u5b89\u88c5\u5305 \u7248\u672c\uff1amysql-5.7.36-el7-x86_64.tar.gz \u4e0b\u8f7d\u5730\u5740\uff1ahttps://cdn.mysql.com/archives/mysql-5.7/mysql-test-5.7.36-el7-x86_64.tar.gz keepalived\u5b89\u88c5\u5305 \u7248\u672c\uff1akeepalived-2.2.7.tar.gz \u4e0b\u8f7d\u5730\u5740\uff1ahttps://www.keepalived.org/software/keepalived-2.2.7.tar.gz","title":"\u4e8c\u3001\u51c6\u5907\u5de5\u4f5c"},{"location":"mysql-ha/#mysql","text":"\u5728128\u3001129\u4e24\u53f0\u670d\u52a1\u5668\u6839\u636e\u300alinux\u5b89\u88c5mysql\u670d\u52a1-\u4e24\u79cd\u5b89\u88c5\u65b9\u5f0f\u6559\u7a0b\u300b\u5b89\u88c5\u597dmysql\u5e94\u7528\u3002 \u4fee\u6539128\u670d\u52a1\u5668/etc/my.cnf\u914d\u7f6e\u6587\u4ef6\uff0c\u6ca1\u6709\u7684\u8bdd\u53ef\u81ea\u884c\u521b\u5efa\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a [client] # \u5ba2\u6237\u7aef\u8fde\u63a5\u7aef\u53e3 port=3306 # \u5ba2\u6237\u7aef\u8fde\u63a5sock socket=/opt/mysql5.7/log/mysql.socka # \u5ba2\u6237\u7aef\u7f16\u7801 default-character-set=utf8 [mysqld] # mysql\u670d\u52a1\u7aef\u53e3 port=3306 #\u5b89\u88c5\u76ee\u5f55 basedir=/opt/mysql5.7 #\u6570\u636e\u5b58\u653e\u76ee\u5f55 datadir=/opt/mysql5.7/data #sock\u6587\u4ef6\u5730\u5740 socket=/opt/mysql5.7/log/mysql.sock #\u9519\u8bef\u65e5\u5fd7\u5b58\u653e\u5730\u5740 log-error=/opt/mysql5.7/log/mysql.log #pid\u6587\u4ef6\u5730\u5740 pid-file=/opt/mysql5.7/log/mysql.pid #\u4e0b\u9762\u5185\u5bb9\u4e3amysq\u4e3b\u5907\u65f6\u914d\u7f6e\uff0c\u5355mysql\u90e8\u7f72\u62a4\u7406\u4e0b\u9762\u914d\u7f6e #server-id \u591a\u53f0\u670d\u52a1\u5668\u65f6\uff0c\u6b64\u8868\u793a\u9700\u8981\u552f\u4e00 server-id=1 #\u4e3b\u4ece\u540c\u6b65bin-log\u65e5\u5fd7\u6587\u4ef6\u540d log-bin=mysql-bin #\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_do_db\u914d\u7f6e binlog_do_db=test_db #\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u4e0d\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_ignore_db\u914d\u7f6e #binlog_ignore_db=mysql #binlog_ignore_db=information_schema #binlog_ignore_db=sys #binlog_ignore_db=performance_schema #\u4e3b\u4ece\u540c\u6b65\u65b9\u5f0f binlog_format=row #\u670d\u52a1\u7aef\u7f16\u7801 character-set-server=utf8 !includedir /etc/my.cnf.d \u4fee\u6539129\u670d\u52a1\u5668/etc/my.cnf\u914d\u7f6e\u6587\u4ef6\uff0c\u53ea\u6709server-id\u4e0d\u540c\uff0c\u4e3a2\u914d\u7f6e\u5982\u4e0b [client] #\u5ba2\u6237\u7aef\u8fde\u63a5\u7aef\u53e3 port=3306 #\u5ba2\u6237\u7aef\u8fde\u63a5sock socket=/opt/mysql5.7/log/mysql.socka #\u5ba2\u6237\u7aef\u7f16\u7801 default-character-set=utf8 [mysqld] #mysql\u670d\u52a1\u7aef\u53e3 port=3306 #\u5b89\u88c5\u76ee\u5f55 basedir=/opt/mysql5.7 #\u6570\u636e\u5b58\u653e\u76ee\u5f55 datadir=/opt/mysql5.7/data #sock\u6587\u4ef6\u5730\u5740 socket=/opt/mysql5.7/log/mysql.sock #\u9519\u8bef\u65e5\u5fd7\u5b58\u653e\u5730\u5740 log-error=/opt/mysql5.7/log/mysql.log #pid\u6587\u4ef6\u5730\u5740 pid-file=/opt/mysql5.7/log/mysql.pid #\u4e0b\u9762\u5185\u5bb9\u4e3amysq\u4e3b\u5907\u65f6\u914d\u7f6e\uff0c\u5355mysql\u90e8\u7f72\u62a4\u7406\u4e0b\u9762\u914d\u7f6e #server-id \u591a\u53f0\u670d\u52a1\u5668\u65f6\uff0c\u6b64\u8868\u793a\u9700\u8981\u552f\u4e00 server-id=2 #\u4e3b\u4ece\u540c\u6b65bin-log\u65e5\u5fd7\u6587\u4ef6\u540d log-bin=mysql-bin #\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_do_db\u914d\u7f6e binlog_do_db=test_db #\u4e3b\u4ece\u540c\u6b65\u65f6\uff0c\u4e0d\u9700\u8981\u540c\u6b65\u7684\u6570\u636e\u5e93\uff0c\u591a\u4e2a\u6570\u636e\u5e93\u5199\u591a\u884cbinlog_ignore_db\u914d\u7f6e #binlog_ignore_db=mysql #binlog_ignore_db=information_schema #binlog_ignore_db=sys #binlog_ignore_db=performance_schema #\u4e3b\u4ece\u540c\u6b65\u65b9\u5f0f binlog_format=row #\u670d\u52a1\u7aef\u7f16\u7801 character-set-server=utf8 !includedir /etc/my.cnf.d \u91cd\u542fmysql\u670d\u52a1 [root@128 mysql5.7]# systemctl stop mysqld [root@128 mysql5.7]# systemctl start mysqld","title":"\u4e09\u3001\u5b89\u88c5mysql"},{"location":"mysql-ha/#mysql_1","text":"1.\u8fde\u63a5128\u670d\u52a1\u5668mysql\uff0c\u5e76\u521b\u5efa\u4e3b\u4ece\u540c\u6b65\u8d26\u6237slavebak\uff0c\u5e76\u67e5\u770bmaster\u72b6\u6001\uff0c\u8bb0\u5f55\u4e0bfile\u3001psition\u503c\uff0c\u914d\u7f6e129mysql\u4ece\u5e93\u65f6\u4f7f\u7528 [root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> grant replication slave on *.* to slavebak@'%' identified by 'slavebak'; mysql> flush privileges; mysql> show master status; +------------------+----------+--------------+------------------+-------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set | +------------------+----------+--------------+------------------+-------------------+ | mysql-bin.000002 | 1287 | test_db | | | +------------------+----------+--------------+------------------+-------------------+ 1 row in set (0.01 sec) mysql> 2.\u8fde\u63a5129\u670d\u52a1\u5668\uff0c\u4f7f\u7528slavebak\u7528\u6237\u8fdc\u7a0b\u767b\u5f55128mysql\uff0c\u6d4b\u8bd5\u8fde\u63a5\u662f\u5426\u6b63\u5e38\u3002 [root@129 ~]# /opt/mysql5.7/bin/mysql -h192.168.222.128 -uslavebak -pslavebak mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> exit; [root@129 ~]# 3.\u5728129\u670d\u52a1\u5668\u7528root\u8fde\u63a5\u672c\u670d\u52a1\u5668mysql\uff0c\u5e76\u914d\u7f6e128\u7684\u4e3b\u5e93\u4fe1\u606f [root@129 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> change master to -> master_host='192.168.222.128', #128\u670d\u52a1\u5668mysql ip -> master_port=3306, #128\u670d\u52a1\u5668mysql\u7aef\u53e3 -> master_user='slavebak', #128\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237 -> master_password='slavebak', #128\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237\u5bc6\u7801 -> master_log_file='mysql-bin.000002', #\u524d\u9762\u8bb0\u5f55\u7684128\u670d\u52a1mysql file\u503c -> master_log_pos=1287; #\u524d\u9762\u8bb0\u5f55\u7684128\u670d\u52a1mysql psition\u503c Query OK, 0 rows affected, 2 warnings (0.02 sec) mysql> start slave; #\u542f\u52a8\u4ece\u5e93\u914d\u7f6e 4.\u67e5\u770b129\u4ece\u5e93\u914d\u7f6e\u662f\u5426\u6210\u529fSlave_IO_Running\u3001Slave_SQL_Running\u90fd\u4e3ayes\u5219\u6210\u529f mysql> show slave status; mysql> show slave status \\G; *************************** 1. row *************************** ...... Slave_IO_Running: Yes #\u6b64\u503c\u4e3ayes\u914d\u7f6e\u6210\u529f Slave_SQL_Running: Yes #\u6b64\u503c\u4e3ayes\u914d\u7f6ei\u6210\u529f ...... 1 row in set (0.01 sec) 5.\u5728129\u670d\u52a1\u5668mysql\u521b\u5efa\u4e3b\u4ece\u540c\u6b65\u8d26\u6237slavebak\uff0c\u67e5\u770bmaster\u72b6\u6001\uff0c\u8bb0\u5f55\u4e0bfile\u3001psition\u503c mysql> grant replication slave on *.* to slavebak@'%' identified by 'slavebak'; mysql> flush privileges; mysql> show master status; +------------------+----------+--------------+------------------+-------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set | +------------------+----------+--------------+------------------+-------------------+ | mysql-bin.000002 | 848 | test_db | | | +------------------+----------+--------------+------------------+-------------------+ 1 row in set (0.01 sec) 6.\u8fde\u63a5128\u670d\u52a1\u5668\u5e76\u4f7f\u7528root\u7528\u6237\u8fde\u63a5\u672c\u670d\u52a1\u5668mysql\uff0c\u914d\u7f6e129\u7684\u4e3b\u5e93\u4fe1\u606f [root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> change master to -> master_host='192.168.222.129', #129\u670d\u52a1\u5668mysql ip -> master_port=3306, #129\u670d\u52a1\u5668mysql\u7aef\u53e3 -> master_user='slavebak', #129\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237 -> master_password='slavebak', #129\u670d\u52a1\u5668mysql\u4ece\u5e93\u540c\u6b65\u7528\u6237\u5bc6\u7801 -> master_log_file='mysql-bin.000002', #\u524d\u9762\u8bb0\u5f55\u7684129\u670d\u52a1mysql file\u503c -> master_log_pos=848; #\u524d\u9762\u8bb0\u5f55\u7684129\u670d\u52a1mysql psition\u503c Query OK, 0 rows affected, 2 warnings (0.02 sec) mysql> start slave; #\u542f\u52a8\u4ece\u5e93\u914d\u7f6e 7.\u67e5\u770b128\u4ece\u5e93\u914d\u7f6e\u662f\u5426\u6210\u529fSlave_IO_Running\u3001Slave_SQL_Running\u90fd\u4e3ayes\u5219\u6210\u529f mysql> show slave status; mysql> show slave status \\G; *************************** 1. row *************************** ...... Slave_IO_Running: Yes #\u6b64\u503c\u4e3ayes\u914d\u7f6e\u6210\u529f Slave_SQL_Running: Yes #\u6b64\u503c\u4e3ayes\u914d\u7f6ei\u6210\u529f ...... 1 row in set (0.01 sec) \u81f3\u6b64\uff0c128\u670d\u52a1\u5668\uff0c129\u670d\u52a1\u5668\u53cc\u4e3b\u53cc\u4ece\u914d\u7f6e\u5b8c\u6210","title":"\u56db\u3001mysql\u6570\u636e\u5e93\u53cc\u4e3b\u53cc\u4ece\u914d\u7f6e"},{"location":"mysql-ha/#mysql_2","text":"\u8fde\u63a5128\u670d\u52a1\u5668\uff0c\u4f7f\u7528root\u7528\u6237\u8fde\u63a5\u672c\u673amysql\uff0c\u5e76\u521b\u5efatest_db\u6570\u636e\u5e93\uff0ct_test\u8868\uff0c\u5e76\u63d2\u5165\u4e00\u6761\u6570\u636eid=1,name='zhangsan' [root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> create database test_db; Query OK, 1 row affected (0.00 sec) mysql> use test_db; mysql> create table t_test(id int primary key, name varchar(30)); Query OK, 0 row affected (0.01 sec) mysql> insert into t_test values (1, 'zhangsan'); Query OK, 1 row affected (0.01 sec) mysql> select * from t_test; +----+----------+ | id | name | +----+----------+ | 1 | zhangsan | +----+----------+ 1 rows in set (0.00 sec) \u8fde\u63a5129\u670d\u52a1\u5668\uff0c\u4f7f\u7528root\u7528\u6237\u8fde\u63a5mysql\uff0c\u67e5\u770btest_db\u6570\u636e\u5e93\u3001t_test\u8868\u4ee5\u53ca\u6570\u636e\u662f\u5426\u540c\u6b65\uff0c\u5e76\u63d2\u5165id=2\uff0cname=\u2018lisi\u2019 [root@129 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> show databases; +--------------------+ | Database | +--------------------+ | information_schema | | mysql | | performance_schema | | sys | | test_db | #test_db\u6570\u636e\u5e93\u5df2\u540c\u6b65\u8fc7\u6765 +--------------------+ 5 rows in set (0.01 sec) mysql> use test_db; mysql> show tables; +-------------------+ | Tables_in_test_db | +-------------------+ | t_test | #t_test\u8868\u5df2\u540c\u6b65\u8fc7\u6765 +-------------------+ 1 row in set (0.01 sec) mysql> select * from t_test; +----+----------+ | id | name | +----+----------+ | 1 | zhangsan | #\u6570\u636e\u5df2\u540c\u6b65\u8fc7\u6765 +----+----------+ 1 rows in set (0.00 sec) mysql> insert into t_test values (2, 'lisi'); Query OK, 1 row affected (0.01 sec) \u5728128\u670d\u52a1\u5668\u67e5\u770bid=2\uff0cname=\"lisi\" \u662f\u5426\u540c\u6b65 [root@128 ~]# /opt/mysql5.7/bin/mysql -uroot -proot mysql: [Warning] Using a password on the command line interface can be insecure. ...... Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> select * from t_test; +----+----------+ | id | name | +----+----------+ | 1 | zhangsan | | 2 | lisi | #lisi\u6570\u636e\u5df2\u540c\u6b65 +----+----------+ 1 rows in set (0.00 sec) \u81f3\u6b64\uff0c\u6570\u636e\u5e93\u53cc\u4e3b\u53cc\u4ece\u6d4b\u8bd5\u5b8c\u6210\u3002","title":"\u4e94\u3001MySQL\u53cc\u4e3b\u53cc\u4ece\u6d4b\u8bd5"},{"location":"mysql-ha/#keepalived","text":"128\u3001129\u4e24\u53f0\u670d\u52a1\u5668\u5b89\u88c5\u6b65\u9aa4\u76f8\u540c\uff0c\u914d\u7f6e\u6587\u4ef6\u4e0d\u540c\uff0c\u4e0b\u9762\u6709\u4ecb\u7ecd\u3002 \u5b89\u88c5\u76f8\u5173\u4f9d\u8d56\u5305\uff0c\u5e76\u4e0b\u8f7dkeepalived\u5b89\u88c5\u5305\uff0c\u89e3\u538b\uff0c\u914d\u7f6e\uff0c\u7f16\u8bd1 [root@128 ~]# cd /opt [root@128 opt]# yum -y install gcc openssl-devel popt-devel psmisc [root@128 opt]# wget https://www.keepalived.org/software/keepalived-2.2.7.tar.gz [root@128 opt]# tar -zxvf keepalived-2.2.7.tar.gz [root@128 opt]# cd keepalived-2.2.7 [root@128 keepalived-2.2.7]# ./configure --prefix=/opt/keepalived-2.2.7 [root@128 keepalived-2.2.7]# make && make install \u5c06\u6587\u4ef6\u590d\u5236\u5230\u5bf9\u5e94\u76ee\u5f55\u4e0b [root@128 keepalived-2.2.7]# mkdir /etc/keepalived [root@128 keepalived-2.2.7]# cp keepalived/etc/keepalived/keepalived.conf.sample /etc/keepalived/keepalived.conf [root@128 keepalived-2.2.7]# cp keepalived/etc/init.d/keepalived /etc/init.d/ [root@128 keepalived-2.2.7]# cp keepalived/etc/sysconfig/keepalived /etc/sysconfig/ [root@128 keepalived-2.2.7]# cp bin/keepalived /usr/sbin/ \u65b0\u5efa/etc/keepalived/shutdown.sh\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a\uff1a #!/bin/bash #\u8be5\u811a\u672c\u662f\u5728mysql\u670d\u52a1\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u5c06keepalived\u5e94\u7528\u505c\u6b62\uff0c\u4ece\u800c\u4f7f\u865a\u62dfvip\u4e3b\u673a\u81ea\u52a8\u8fde\u63a5\u5230\u53e6\u4e00\u53f0mysql\u4e0a killall keepalived \u4f7f\u7528ifconfig\u547d\u4ee4\u67e5\u770b\u4e0b\u7f51\u5361\u540d\u79f0\uff0c\u672c\u673a\u7f51\u5361\u540d\u79f0\u4e3aens33 \u4fee\u6539128\u670d\u52a1\u5668/etc/keepalived/keepalived.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a ! Configuration File for keepalived global_defs { notification_email { acassen@firewall.loc failover@firewall.loc sysadmin@firewall.loc } notification_email_from Alexandre.Cassen@firewall.loc smtp_server 192.168.200.1 smtp_connect_timeout 30 router_id LVS_MASTER vrrp_skip_check_adv_addr vrrp_strict vrrp_garp_interval 0 vrrp_gna_interval 0 } vrrp_instance VI_1 { state MASTER #interface\u4e3a\u521a\u624d\u67e5\u5230\u7684\u672c\u673a\u7f51\u5361\u540d\u79f0 interface ens33 #\u540c\u4e00\u7f51\u6bb5\u4e2d\u540c\u4e00\u7ec4virtual_router_id\u503c\u76f8\u540c\u3002\u4e0d\u540c\u7ec4virtual_router_id\u503c\u552f\u4e00\u3002 #\u5982server-1\u3001server-2\u4e3a\u4e00\u7ec4\uff0cvirtual_router_id=51 #server-3\u3001server-4\u4e3a\u4e00\u7ec4\uff0c\u5219virtual_router_id\u4e0d\u80fd\u4e3a51 virtual_router_id 51 #\u5b57\u6570\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0cmaster\u5fc5\u987b\u5927\u4e8ebackup priority 100 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { #\u8be5ip\u4e3a\u865a\u62df\u51fa\u6765\u7684vip\u5730\u5740 192.168.222.130 } } #\u914d\u7f6evirtual_server ip\u4e3a\u4e0a\u9762\u914d\u7f6e\u7684\u865a\u62dfvip\u5730\u5740 \u7aef\u53e3\u4e3amysql\u7684\u7aef\u53e3 virtual_server 192.168.222.130 3306 { delay_loop 6 lb_algo rr lb_kind NAT persistence_timeout 50 protocol TCP #real_server \u8be5\u914d\u7f6e\u4e3a\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740 \u4ee5\u53ca\u5b9e\u9645\u7269\u7406\u673amysql\u7aef\u53e3 real_server 192.168.222.128 3306 { #\u5f53\u8be5ip \u7aef\u53e3\u8fde\u63a5\u5f02\u5e38\u65f6\uff0c\u6267\u884c\u8be5\u811a\u672c notify_down /etc/keepalived/shutdow.sh TCP_CHECK { #\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740 connect_ip 192.168.222.128 #\u5b9e\u9645\u7269\u7406\u673aport\u7aef\u53e3 connect_port 3306 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } } } \u4fee\u6539129\u670d\u52a1\u5668/etc/keepalived/keepalived.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0e128\u7684\u914d\u7f6e\u4e0d\u540c\u5730\u65b9\u4e3areal_server\u3001connect_ip \u4e24\u4e2a\u914d\u7f6e\uff0c\u9700\u8981\u914d\u7f6e\u5bf9\u5e94\u7684\u5b9e\u9645\u4e3b\u673aip\uff0c\u8be6\u7ec6\u5185\u5bb9\u5982\u4e0b\uff1a ! Configuration File for keepalived global_defs { notification_email { acassen@firewall.loc failover@firewall.loc sysadmin@firewall.loc } notification_email_from Alexandre.Cassen@firewall.loc smtp_server 192.168.200.1 smtp_connect_timeout 30 router_id LVS_MASTER vrrp_skip_check_adv_addr vrrp_strict vrrp_garp_interval 0 vrrp_gna_interval 0 } vrrp_instance VI_1 { state BACKUP #interface\u4e3a\u521a\u624d\u67e5\u5230\u7684\u672c\u673a\u7f51\u5361\u540d\u79f0 interface ens33 #\u540c\u4e00\u7f51\u6bb5\u4e2d\u540c\u4e00\u7ec4virtual_router_id\u503c\u76f8\u540c\u3002\u4e0d\u540c\u7ec4virtual_router_id\u503c\u552f\u4e00\u3002 #\u5982server-1\u3001server-2\u4e3a\u4e00\u7ec4\uff0cvirtual_router_id=51 #server-3\u3001server-4\u4e3a\u4e00\u7ec4\uff0c\u5219virtual_router_id\u4e0d\u80fd\u4e3a51 virtual_router_id 51 #\u5b57\u6570\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0cmaster\u5fc5\u987b\u5927\u4e8ebackup priority 90 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { #\u8be5ip\u4e3a\u865a\u62df\u51fa\u6765\u7684vip\u5730\u5740 192.168.222.130 } } #\u914d\u7f6evirtual_server ip\u4e3a\u4e0a\u9762\u914d\u7f6e\u7684\u865a\u62dfvip\u5730\u5740 \u7aef\u53e3\u4e3amysql\u7684\u7aef\u53e3 virtual_server 192.168.222.130 3306 { delay_loop 6 lb_algo rr lb_kind NAT persistence_timeout 50 protocol TCP #real_server \u8be5\u914d\u7f6e\u4e3a\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740 \u4ee5\u53ca\u5b9e\u9645\u7269\u7406\u673amysql\u7aef\u53e3 real_server 192.168.222.129 3306 { #\u5f53\u8be5ip \u7aef\u53e3\u8fde\u63a5\u5f02\u5e38\u65f6\uff0c\u6267\u884c\u8be5\u811a\u672c notify_down /etc/keepalived/shutdow.sh TCP_CHECK { #\u5b9e\u9645\u7269\u7406\u673aip\u5730\u5740 connect_ip 192.168.222.129 #\u5b9e\u9645\u7269\u7406\u673aport\u7aef\u53e3 connect_port 3306 connect_timeout 3 nb_get_retry 3 delay_before_retry 3 } } } \u8be6\u7ec6\u914d\u7f6e\u53c2\u8003 \u300aKeepalived \u5b89\u88c5\u548c\u914d\u7f6e\u8be6\u89e3\u300b \u5c06128\u3001129\u670d\u52a1\u5668keepalived\u52a0\u5165\u5f00\u673a\u81ea\u542f\uff0c\u5e76\u542f\u52a8\u670d\u52a1 [root@128 keepalived-2.2.7]# systemctl enable keepalived [root@128 keepalived-2.2.7]# systemctl start keepalived \u542f\u52a8\u540ekeepalived\u72b6\u6001\u4e3a\uff1aactive(running)\u5219\u6b63\u5e38 \u542f\u52a8\u540e\u76f8\u5f53\u4e8e\u865a\u62df\u51fa\u4e00\u4e2avip 192.168.222.130\uff0c\u53ef\u4f7f\u7528\u8fdc\u7a0b\u8fde\u63a5\u5de5\u5177\uff0c\u8fde\u63a5\u8be5\u670d\u52a1\u5668\uff0c\u8fde\u63a5\u8fdb\u53bb\u540e\u4f7f\u7528ifconfig\u67e5\u770b\u8be5\u865a\u62dfvip\u5b9e\u9645\u4e0a\u4f7f\u7528\u7684\u5b9e\u4f53\u670d\u52a1\u5668\u662f129\u670d\u52a1\u5668\u3002 \u5c06129\u670d\u52a1\u5668\u7684keepalived\u5e94\u7528\u505c\u6b62\uff0c\u518d\u6b21\u67e5\u770b130\u670d\u52a1ifconfig\uff0c\u53ef\u4ee5\u770b\u5230\uff0c130\u670d\u52a1\u5668\u81ea\u52a8\u5c06\u5b9e\u4f53\u673aip\u6f02\u79fb\u5230\u4e86128\u670d\u52a1\u5668\u4e0a \u81f3\u6b64\uff0ckeepalived\u90e8\u7f72\u5b8c\u6210\u3002","title":"\u516d\u3001keepalived\u5b89\u88c5"},{"location":"mysql-table/","text":"========================================================================================================================================= \u6307\u5b9a\u7684Database\u91cc\u7684\u6307\u5b9a\u7684Table\u5bb9\u91cf \u00b6 SELECT table_name AS `Table`, round(((data_length + index_length) / 1024 / 1024), 2) `Size in MB` FROM information_schema.TABLES WHERE table_schema = \"$DB_NAME\" AND table_name = \"$TABLE_NAME\"; mysql -uroot -e \"SELECT TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 / 1024), 2) AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = '$DB_NAME' AND table_name = '$TABLE_NAME';\" - mysql55-dev# mysql -uroot -e \" SELECT TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 / 1024), 2) AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'tigrex_mygoods2' AND table_name = 'g5_apms_like';\" \u6307\u5b9a\u7684Database\u91cc\u7684\u6240\u6709\u7684Table\u5bb9\u91cf \u00b6 [root@mysqlxxx log]# mysql -uroot -e \"SELECT TABLE_SCHEMA, TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 ),2) AS 'Size (MB)' FROM information_schema.tables WHERE table_schema = 'zeroen_wp'ORDER BY (data_length + index_length) DESC ;\" +--------------+--------------------------------+-----------+ | TABLE_SCHEMA | TABLE_NAME | Size (GB) | +--------------+--------------------------------+-----------+ | zeroen_wp | wp74e2b1options | 0.39 | | zeroen_wp | wp74e2b1postmeta | 0.28 | | zeroen_wp | wp74e2b1posts | 0.13 | | zeroen_wp | wp74e2b1comments | 0.09 | | zeroen_wp | wp74e2b1users | 0.06 | | zeroen_wp | wp74e2b1usermeta | 0.05 | | zeroen_wp | wp74e2b1terms | 0.05 | | zeroen_wp | wp74e2b1termmeta | 0.05 | | zeroen_wp | wp74e2b1term_taxonomy | 0.05 | | zeroen_wp | wp74e2b1commentmeta | 0.05 | | zeroen_wp | wp74e2b1term_relationships | 0.03 | | zeroen_wp | wp74e2b1links | 0.03 | | zeroen_wp | wp74e2b1aiowps_login_lockdown | 0.02 | | zeroen_wp | wp74e2b1aiowps_login_activity | 0.02 | | zeroen_wp | wp74e2b1aiowps_global_meta | 0.02 | | zeroen_wp | wp74e2b1aiowps_failed_logins | 0.02 | | zeroen_wp | wp74e2b1aiowps_events | 0.02 | | zeroen_wp | wp74e2b1aiowps_permanent_block | 0.02 | +--------------+--------------------------------+-----------+ [root@mysqlxxx log]# \u6240\u6709\u7684Database\u91cc\u7684\u6240\u6709\u7684Table\u5bb9\u91cf \u00b6 SELECT table_schema as `Database`, table_name AS `Table`, round(((data_length + index_length) / 1024 / 1024), 2) `Size in MB` FROM information_schema.TABLES ORDER BY (data_length + index_length) DESC; - mysql -uroot -e \"SELECT TABLE_SCHEMA, TABLE_NAME, round(((data_length+index_length) / 1024),2) AS 'Size (GB)' FROM information_schema.tables ORDER BY (data_length + index_length) DESC;\" - mysql55-dev# mysql -uroot -e \" SELECT TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 / 1024), 2) AS 'Size (GB)' FROM information_schema.tables ORDER BY (data_length + index_length) DESC;\" \u6307\u5b9a\u7684Database\u91cc\u7684\u6240\u6709\u7684Table\u5bb9\u91cf \u00b6 mysql -uroot -e \"SELECT TABLE_SCHEMA AS 'Database Name', TABLE_NAME AS 'TABLE_NAME', SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = '$DB_NAME' ORDER BY (data_length + index_length) DESC;\" - mysql -uroot -e \"SELECT TABLE_SCHEMA, TABLE_NAME, round(((data_length+index_length) / 1024),2) AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'tigrex_mygoods' ORDER BY (data_length + index_length) DESC;\" use databaseName; select table_name, engine, table_rows as tbl_rows, avg_row_length as rlen, floor((data_length+index_length)/1024/1024) as allMB, #\u7dcf\u5bb9\u91cf floor((data_length)/1024/1024) as dMB, #\u30c7\u30fc\u30bf\u5bb9\u91cf floor((index_length)/1024/1024) as iMB #\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u5bb9\u91cf from information_schema.tables where table_schema=database() order by (data_length+index_length) desc; ========================================================================================================================================= mysql> select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA = 'spacerental2_kikou' and TABLE_TYPE = 'VIEW'; +------------------------+ | TABLE_NAME | +------------------------+ | roomtimetable_chk_v01 | | roomtimetable_disp | | roomtimetable_disp_v01 | | roomtimetable_disp_v02 | | sagakuview | | sagakuview1 | | sagakuview_Ytmp | | sagakuview_n | | sagakuview_ngaku | | sagakuview_s | | sagakuview_sgaku | | sagakuview_y | | sagakuview_ygaku | | yoyakubihintable_v01 | | yoyakubihintable_v02 | | yoyakubihintable_v03 | | yoyakubihintable_v04 | +------------------------+ 17 rows in set (0.01 sec) \u6307\u5b9a\u7684Database\u91cc\u7684\u7dcf\u5bb9\u91cf \u00b6 mysql# mysql -uroot -e \"SELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'test45_wdpress';\" mysql> sELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'test45_wdpress'; +----------------+----------------+ | TABLE_SCHEMA | Size (GB) | +----------------+----------------+ | test45_wdpress | 0.000793457031 | +----------------+----------------+ 1 row in set (0.01 sec) mysql> \u8907\u6570Database\u306e\u5404\u5bb9\u91cf \u00b6 mysql> SELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 AS 'Size' FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA IN (\"dbname_table1\", \"dbname_table2\") GROUP BY TABLE_SCHEMA; +--------------------+--------------+ | TABLE_SCHEMA | Size | +--------------------+--------------+ | dbname_table1 | 688.31250000 | | dbname_table2 | 657.39062500 | +--------------------+--------------+ 2 rows in set (0.09 sec) mysql> \u8907\u6570Database\u306e\u7dcf\u5bb9\u91cf and \u5404\u5bb9\u91cf \u00b6 mysql> SELECT SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size GB' FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA like \"dbname_table_%\" ; +----------------+ | Size GB | +----------------+ | 3.150512695313 | +----------------+ 1 row in set (0.58 sec) mysql> SELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 AS 'Size' FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA like \"dbname_table_%\" GROUP BY TABLE_SCHEMA; +---------------------------+--------------+ | TABLE_SCHEMA | Size | +---------------------------+--------------+ | dbname_table_1 | 661.78125000 | | dbname_table_2 | 158.42187500 | | dbname_table_3 | 472.39062500 | | dbname_table_4 | 196.60937500 | | dbname_table_5 | 82.23437500 | | dbname_table_6 | 479.35937500 | | dbname_table_7 | 403.57812500 | | dbname_table_8 | 197.03125000 | | dbname_table_9 | 156.93750000 | | dbname_table_10 | 400.75000000 | | dbname_table_11 | 17.03125000 | +---------------------------+--------------+ 11 rows in set (0.60 sec) mysql>","title":"MySQL-table"},{"location":"mysql-table/#databasetable","text":"SELECT table_name AS `Table`, round(((data_length + index_length) / 1024 / 1024), 2) `Size in MB` FROM information_schema.TABLES WHERE table_schema = \"$DB_NAME\" AND table_name = \"$TABLE_NAME\"; mysql -uroot -e \"SELECT TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 / 1024), 2) AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = '$DB_NAME' AND table_name = '$TABLE_NAME';\" - mysql55-dev# mysql -uroot -e \" SELECT TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 / 1024), 2) AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'tigrex_mygoods2' AND table_name = 'g5_apms_like';\"","title":"\u6307\u5b9a\u7684Database\u91cc\u7684\u6307\u5b9a\u7684Table\u5bb9\u91cf"},{"location":"mysql-table/#databasetable_1","text":"[root@mysqlxxx log]# mysql -uroot -e \"SELECT TABLE_SCHEMA, TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 ),2) AS 'Size (MB)' FROM information_schema.tables WHERE table_schema = 'zeroen_wp'ORDER BY (data_length + index_length) DESC ;\" +--------------+--------------------------------+-----------+ | TABLE_SCHEMA | TABLE_NAME | Size (GB) | +--------------+--------------------------------+-----------+ | zeroen_wp | wp74e2b1options | 0.39 | | zeroen_wp | wp74e2b1postmeta | 0.28 | | zeroen_wp | wp74e2b1posts | 0.13 | | zeroen_wp | wp74e2b1comments | 0.09 | | zeroen_wp | wp74e2b1users | 0.06 | | zeroen_wp | wp74e2b1usermeta | 0.05 | | zeroen_wp | wp74e2b1terms | 0.05 | | zeroen_wp | wp74e2b1termmeta | 0.05 | | zeroen_wp | wp74e2b1term_taxonomy | 0.05 | | zeroen_wp | wp74e2b1commentmeta | 0.05 | | zeroen_wp | wp74e2b1term_relationships | 0.03 | | zeroen_wp | wp74e2b1links | 0.03 | | zeroen_wp | wp74e2b1aiowps_login_lockdown | 0.02 | | zeroen_wp | wp74e2b1aiowps_login_activity | 0.02 | | zeroen_wp | wp74e2b1aiowps_global_meta | 0.02 | | zeroen_wp | wp74e2b1aiowps_failed_logins | 0.02 | | zeroen_wp | wp74e2b1aiowps_events | 0.02 | | zeroen_wp | wp74e2b1aiowps_permanent_block | 0.02 | +--------------+--------------------------------+-----------+ [root@mysqlxxx log]#","title":"\u6307\u5b9a\u7684Database\u91cc\u7684\u6240\u6709\u7684Table\u5bb9\u91cf"},{"location":"mysql-table/#databasetable_2","text":"SELECT table_schema as `Database`, table_name AS `Table`, round(((data_length + index_length) / 1024 / 1024), 2) `Size in MB` FROM information_schema.TABLES ORDER BY (data_length + index_length) DESC; - mysql -uroot -e \"SELECT TABLE_SCHEMA, TABLE_NAME, round(((data_length+index_length) / 1024),2) AS 'Size (GB)' FROM information_schema.tables ORDER BY (data_length + index_length) DESC;\" - mysql55-dev# mysql -uroot -e \" SELECT TABLE_NAME, round(((data_length+index_length) / 1024 / 1024 / 1024), 2) AS 'Size (GB)' FROM information_schema.tables ORDER BY (data_length + index_length) DESC;\"","title":"\u6240\u6709\u7684Database\u91cc\u7684\u6240\u6709\u7684Table\u5bb9\u91cf"},{"location":"mysql-table/#databasetable_3","text":"mysql -uroot -e \"SELECT TABLE_SCHEMA AS 'Database Name', TABLE_NAME AS 'TABLE_NAME', SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = '$DB_NAME' ORDER BY (data_length + index_length) DESC;\" - mysql -uroot -e \"SELECT TABLE_SCHEMA, TABLE_NAME, round(((data_length+index_length) / 1024),2) AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'tigrex_mygoods' ORDER BY (data_length + index_length) DESC;\" use databaseName; select table_name, engine, table_rows as tbl_rows, avg_row_length as rlen, floor((data_length+index_length)/1024/1024) as allMB, #\u7dcf\u5bb9\u91cf floor((data_length)/1024/1024) as dMB, #\u30c7\u30fc\u30bf\u5bb9\u91cf floor((index_length)/1024/1024) as iMB #\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u5bb9\u91cf from information_schema.tables where table_schema=database() order by (data_length+index_length) desc; ========================================================================================================================================= mysql> select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA = 'spacerental2_kikou' and TABLE_TYPE = 'VIEW'; +------------------------+ | TABLE_NAME | +------------------------+ | roomtimetable_chk_v01 | | roomtimetable_disp | | roomtimetable_disp_v01 | | roomtimetable_disp_v02 | | sagakuview | | sagakuview1 | | sagakuview_Ytmp | | sagakuview_n | | sagakuview_ngaku | | sagakuview_s | | sagakuview_sgaku | | sagakuview_y | | sagakuview_ygaku | | yoyakubihintable_v01 | | yoyakubihintable_v02 | | yoyakubihintable_v03 | | yoyakubihintable_v04 | +------------------------+ 17 rows in set (0.01 sec)","title":"\u6307\u5b9a\u7684Database\u91cc\u7684\u6240\u6709\u7684Table\u5bb9\u91cf"},{"location":"mysql-table/#database","text":"mysql# mysql -uroot -e \"SELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'test45_wdpress';\" mysql> sELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size (GB)' FROM information_schema.tables WHERE table_schema = 'test45_wdpress'; +----------------+----------------+ | TABLE_SCHEMA | Size (GB) | +----------------+----------------+ | test45_wdpress | 0.000793457031 | +----------------+----------------+ 1 row in set (0.01 sec) mysql>","title":"\u6307\u5b9a\u7684Database\u91cc\u7684\u7dcf\u5bb9\u91cf"},{"location":"mysql-table/#database_1","text":"mysql> SELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 AS 'Size' FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA IN (\"dbname_table1\", \"dbname_table2\") GROUP BY TABLE_SCHEMA; +--------------------+--------------+ | TABLE_SCHEMA | Size | +--------------------+--------------+ | dbname_table1 | 688.31250000 | | dbname_table2 | 657.39062500 | +--------------------+--------------+ 2 rows in set (0.09 sec) mysql>","title":"\u8907\u6570Database\u306e\u5404\u5bb9\u91cf"},{"location":"mysql-table/#database-and","text":"mysql> SELECT SUM(data_length+index_length) / 1024 / 1024 / 1024 AS 'Size GB' FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA like \"dbname_table_%\" ; +----------------+ | Size GB | +----------------+ | 3.150512695313 | +----------------+ 1 row in set (0.58 sec) mysql> SELECT TABLE_SCHEMA, SUM(data_length+index_length) / 1024 / 1024 AS 'Size' FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA like \"dbname_table_%\" GROUP BY TABLE_SCHEMA; +---------------------------+--------------+ | TABLE_SCHEMA | Size | +---------------------------+--------------+ | dbname_table_1 | 661.78125000 | | dbname_table_2 | 158.42187500 | | dbname_table_3 | 472.39062500 | | dbname_table_4 | 196.60937500 | | dbname_table_5 | 82.23437500 | | dbname_table_6 | 479.35937500 | | dbname_table_7 | 403.57812500 | | dbname_table_8 | 197.03125000 | | dbname_table_9 | 156.93750000 | | dbname_table_10 | 400.75000000 | | dbname_table_11 | 17.03125000 | +---------------------------+--------------+ 11 rows in set (0.60 sec) mysql>","title":"\u8907\u6570Database\u306e\u7dcf\u5bb9\u91cf and \u5404\u5bb9\u91cf"},{"location":"mysql/","text":"Mysql\u53c2\u6570\u4f18\u5316\u5bf9\u4e8e\u65b0\u624b\u6765\u8bb2\uff0c\u662f\u6bd4\u8f83\u96be\u61c2\u7684\u4e1c\u897f\uff0c\u5176\u5b9e\u8fd9\u4e2a\u53c2\u6570\u4f18\u5316\uff0c\u662f\u4e2a\u5f88\u590d\u6742\u7684\u4e1c\u897f\uff0c \u00b6 \u5bf9\u4e8e\u4e0d\u540c\u7684\u7f51\u7ad9\uff0c\u53ca\u5176\u5728\u7ebf\u91cf\uff0c\u8bbf\u95ee\u91cf\uff0c\u5e16\u5b50\u6570\u91cf\uff0c\u7f51\u7edc\u60c5\u51b5\uff0c\u4ee5\u53ca\u673a\u5668\u786c\u4ef6\u914d\u7f6e\u90fd\u6709\u5173\u7cfb\uff0c\u4f18\u5316\u4e0d\u53ef\u80fd\u4e00\u6b21\u6027\u5b8c\u6210\uff0c\u9700\u8981\u4e0d\u65ad\u7684\u89c2\u5bdf\u4ee5\u53ca\u8c03\u8bd5\uff0c\u624d\u6709\u53ef\u80fd\u5f97\u5230\u6700\u4f73\u6548\u679c\u3002 [client] port = 3306 socket = /tmp/mysql.sock [mysqld] port = 3306 socket = /tmp/mysql.sock basedir = /usr/local/mysql datadir = /data/mysql pid-file = /data/mysql/mysql.pid user = mysql bind-address = 0.0.0.0 server-id = 1 #\u8868\u793a\u662f\u672c\u673a\u7684\u5e8f\u53f7\u4e3a1,\u4e00\u822c\u6765\u8bb2\u5c31\u662fmaster\u7684\u610f\u601d skip-name-resolve # \u7981\u6b62MySQL\u5bf9\u5916\u90e8\u8fde\u63a5\u8fdb\u884cDNS\u89e3\u6790\uff0c\u4f7f\u7528\u8fd9\u4e00\u9009\u9879\u53ef\u4ee5\u6d88\u9664MySQL\u8fdb\u884cDNS\u89e3\u6790\u7684\u65f6\u95f4\u3002\u4f46\u9700\u8981\u6ce8\u610f\uff0c\u5982\u679c\u5f00\u542f\u8be5\u9009\u9879\uff0c # \u5219\u6240\u6709\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u6388\u6743\u90fd\u8981\u4f7f\u7528IP\u5730\u5740\u65b9\u5f0f\uff0c\u5426\u5219MySQL\u5c06\u65e0\u6cd5\u6b63\u5e38\u5904\u7406\u8fde\u63a5\u8bf7\u6c42 #skip-networking back_log = 600 # MySQL\u80fd\u6709\u7684\u8fde\u63a5\u6570\u91cf\u3002\u5f53\u4e3b\u8981MySQL\u7ebf\u7a0b\u5728\u4e00\u4e2a\u5f88\u77ed\u65f6\u95f4\u5185\u5f97\u5230\u975e\u5e38\u591a\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u8fd9\u5c31\u8d77\u4f5c\u7528\uff0c # \u7136\u540e\u4e3b\u7ebf\u7a0b\u82b1\u4e9b\u65f6\u95f4(\u5c3d\u7ba1\u5f88\u77ed)\u68c0\u67e5\u8fde\u63a5\u5e76\u4e14\u542f\u52a8\u4e00\u4e2a\u65b0\u7ebf\u7a0b\u3002back_log\u503c\u6307\u51fa\u5728MySQL\u6682\u65f6\u505c\u6b62\u56de\u7b54\u65b0\u8bf7\u6c42\u4e4b\u524d\u7684\u77ed\u65f6\u95f4\u5185\u591a\u5c11\u4e2a\u8bf7\u6c42\u53ef\u4ee5\u88ab\u5b58\u5728\u5806\u6808\u4e2d\u3002 # \u5982\u679c\u671f\u671b\u5728\u4e00\u4e2a\u77ed\u65f6\u95f4\u5185\u6709\u5f88\u591a\u8fde\u63a5\uff0c\u4f60\u9700\u8981\u589e\u52a0\u5b83\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679cMySQL\u7684\u8fde\u63a5\u6570\u636e\u8fbe\u5230max_connections\u65f6\uff0c\u65b0\u6765\u7684\u8bf7\u6c42\u5c06\u4f1a\u88ab\u5b58\u5728\u5806\u6808\u4e2d\uff0c # \u4ee5\u7b49\u5f85\u67d0\u4e00\u8fde\u63a5\u91ca\u653e\u8d44\u6e90\uff0c\u8be5\u5806\u6808\u7684\u6570\u91cf\u5373back_log\uff0c\u5982\u679c\u7b49\u5f85\u8fde\u63a5\u7684\u6570\u91cf\u8d85\u8fc7back_log\uff0c\u5c06\u4e0d\u88ab\u6388\u4e88\u8fde\u63a5\u8d44\u6e90\u3002 # \u53e6\u5916\uff0c\u8fd9\u503c\uff08back_log\uff09\u9650\u4e8e\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u5230\u6765\u7684TCP/IP\u8fde\u63a5\u7684\u4fa6\u542c\u961f\u5217\u7684\u5927\u5c0f\u3002 # \u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u5728\u8fd9\u4e2a\u961f\u5217\u5927\u5c0f\u4e0a\u6709\u5b83\u81ea\u5df1\u7684\u9650\u5236\uff08\u53ef\u4ee5\u68c0\u67e5\u4f60\u7684OS\u6587\u6863\u627e\u51fa\u8fd9\u4e2a\u53d8\u91cf\u7684\u6700\u5927\u503c\uff09\uff0c\u8bd5\u56fe\u8bbe\u5b9aback_log\u9ad8\u4e8e\u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u7684\u9650\u5236\u5c06\u662f\u65e0\u6548\u7684\u3002 max_connections = 1000 # MySQL\u7684\u6700\u5927\u8fde\u63a5\u6570\uff0c\u5982\u679c\u670d\u52a1\u5668\u7684\u5e76\u53d1\u8fde\u63a5\u8bf7\u6c42\u91cf\u6bd4\u8f83\u5927\uff0c\u5efa\u8bae\u8c03\u9ad8\u6b64\u503c\uff0c\u4ee5\u589e\u52a0\u5e76\u884c\u8fde\u63a5\u6570\u91cf\uff0c # \u5f53\u7136\u8fd9\u5efa\u7acb\u5728\u673a\u5668\u80fd\u652f\u6491\u7684\u60c5\u51b5\u4e0b\uff0c\u56e0\u4e3a\u5982\u679c\u8fde\u63a5\u6570\u8d8a\u591a\uff0c\u4ecb\u4e8eMySQL\u4f1a\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u63d0\u4f9b\u8fde\u63a5\u7f13\u51b2\u533a\uff0c # \u5c31\u4f1a\u5f00\u9500\u8d8a\u591a\u7684\u5185\u5b58\uff0c\u6240\u4ee5\u8981\u9002\u5f53\u8c03\u6574\u8be5\u503c\uff0c\u4e0d\u80fd\u76f2\u76ee\u63d0\u9ad8\u8bbe\u503c\u3002\u53ef\u4ee5\u8fc7'conn%'\u901a\u914d\u7b26\u67e5\u770b\u5f53\u524d\u72b6\u6001\u7684\u8fde\u63a5\u6570\u91cf\uff0c\u4ee5\u5b9a\u593a\u8be5\u503c\u7684\u5927\u5c0f\u3002 max_connect_errors = 6000 # \u5bf9\u4e8e\u540c\u4e00\u4e3b\u673a\uff0c\u5982\u679c\u6709\u8d85\u51fa\u8be5\u53c2\u6570\u503c\u4e2a\u6570\u7684\u4e2d\u65ad\u9519\u8bef\u8fde\u63a5\uff0c\u5219\u8be5\u4e3b\u673a\u5c06\u88ab\u7981\u6b62\u8fde\u63a5\u3002\u5982\u9700\u5bf9\u8be5\u4e3b\u673a\u8fdb\u884c\u89e3\u7981\uff0c\u6267\u884c\uff1aFLUSH HOST\u3002 open_files_limit = 65535 # MySQL\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u9650\u5236\uff0c\u9ed8\u8ba4\u6700\u5c0f1024;\u5f53open_files_limit\u6ca1\u6709\u88ab\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u6bd4\u8f83max_connections*5\u548culimit -n\u7684\u503c\uff0c\u54ea\u4e2a\u5927\u7528\u54ea\u4e2a\uff0c # \u5f53open_file_limit\u88ab\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u6bd4\u8f83open_files_limit\u548cmax_connections*5\u7684\u503c\uff0c\u54ea\u4e2a\u5927\u7528\u54ea\u4e2a\u3002 table_open_cache = 128 # MySQL\u6bcf\u6253\u5f00\u4e00\u4e2a\u8868\uff0c\u90fd\u4f1a\u8bfb\u5165\u4e00\u4e9b\u6570\u636e\u5230table_open_cache\u7f13\u5b58\u4e2d\uff0c\u5f53MySQL\u5728\u8fd9\u4e2a\u7f13\u5b58\u4e2d\u627e\u4e0d\u5230\u76f8\u5e94\u4fe1\u606f\u65f6\uff0c\u624d\u4f1a\u53bb\u78c1\u76d8\u4e0a\u8bfb\u53d6\u3002\u9ed8\u8ba4\u503c64 # \u5047\u5b9a\u7cfb\u7edf\u6709200\u4e2a\u5e76\u53d1\u8fde\u63a5\uff0c\u5219\u9700\u5c06\u6b64\u53c2\u6570\u8bbe\u7f6e\u4e3a200*N(N\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u6240\u9700\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u76ee)\uff1b # \u5f53\u628atable_open_cache\u8bbe\u7f6e\u4e3a\u5f88\u5927\u65f6\uff0c\u5982\u679c\u7cfb\u7edf\u5904\u7406\u4e0d\u4e86\u90a3\u4e48\u591a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u90a3\u4e48\u5c31\u4f1a\u51fa\u73b0\u5ba2\u6237\u7aef\u5931\u6548\uff0c\u8fde\u63a5\u4e0d\u4e0a max_allowed_packet = 4M # \u63a5\u53d7\u7684\u6570\u636e\u5305\u5927\u5c0f\uff1b\u589e\u52a0\u8be5\u53d8\u91cf\u7684\u503c\u5341\u5206\u5b89\u5168\uff0c\u8fd9\u662f\u56e0\u4e3a\u4ec5\u5f53\u9700\u8981\u65f6\u624d\u4f1a\u5206\u914d\u989d\u5916\u5185\u5b58\u3002 # \u4f8b\u5982\uff0c\u4ec5\u5f53\u4f60\u53d1\u51fa\u957f\u67e5\u8be2\u6216MySQLd\u5fc5\u987b\u8fd4\u56de\u5927\u7684\u7ed3\u679c\u884c\u65f6MySQLd\u624d\u4f1a\u5206\u914d\u66f4\u591a\u5185\u5b58\u3002 # \u8be5\u53d8\u91cf\u4e4b\u6240\u4ee5\u53d6\u8f83\u5c0f\u9ed8\u8ba4\u503c\u662f\u4e00\u79cd\u9884\u9632\u63aa\u65bd\uff0c\u4ee5\u6355\u83b7\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u9519\u8bef\u4fe1\u606f\u5305\uff0c\u5e76\u786e\u4fdd\u4e0d\u4f1a\u56e0\u5076\u7136\u4f7f\u7528\u5927\u7684\u4fe1\u606f\u5305\u800c\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u3002 binlog_cache_size = 1M # \u4e00\u4e2a\u4e8b\u52a1\uff0c\u5728\u6ca1\u6709\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u4ea7\u751f\u7684\u65e5\u5fd7\uff0c\u8bb0\u5f55\u5230Cache\u4e2d\uff1b\u7b49\u5230\u4e8b\u52a1\u63d0\u4ea4\u9700\u8981\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u5219\u628a\u65e5\u5fd7\u6301\u4e45\u5316\u5230\u78c1\u76d8\u3002\u9ed8\u8ba4binlog_cache_size\u5927\u5c0f32K max_heap_table_size = 8M # \u5b9a\u4e49\u4e86\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u7684\u5185\u5b58\u8868(memory table)\u7684\u5927\u5c0f\u3002\u8fd9\u4e2a\u503c\u7528\u6765\u8ba1\u7b97\u5185\u5b58\u8868\u7684\u6700\u5927\u884c\u6570\u503c\u3002\u8fd9\u4e2a\u53d8\u91cf\u652f\u6301\u52a8\u6001\u6539\u53d8 tmp_table_size = 16M # MySQL\u7684heap\uff08\u5806\u79ef\uff09\u8868\u7f13\u51b2\u5927\u5c0f\u3002\u6240\u6709\u8054\u5408\u5728\u4e00\u4e2aDML\u6307\u4ee4\u5185\u5b8c\u6210\uff0c\u5e76\u4e14\u5927\u591a\u6570\u8054\u5408\u751a\u81f3\u53ef\u4ee5\u4e0d\u7528\u4e34\u65f6\u8868\u5373\u53ef\u4ee5\u5b8c\u6210\u3002 # \u5927\u591a\u6570\u4e34\u65f6\u8868\u662f\u57fa\u4e8e\u5185\u5b58\u7684(HEAP)\u8868\u3002\u5177\u6709\u5927\u7684\u8bb0\u5f55\u957f\u5ea6\u7684\u4e34\u65f6\u8868 (\u6240\u6709\u5217\u7684\u957f\u5ea6\u7684\u548c)\u6216\u5305\u542bBLOB\u5217\u7684\u8868\u5b58\u50a8\u5728\u786c\u76d8\u4e0a\u3002 # \u5982\u679c\u67d0\u4e2a\u5185\u90e8heap\uff08\u5806\u79ef\uff09\u8868\u5927\u5c0f\u8d85\u8fc7tmp_table_size\uff0cMySQL\u53ef\u4ee5\u6839\u636e\u9700\u8981\u81ea\u52a8\u5c06\u5185\u5b58\u4e2d\u7684heap\u8868\u6539\u4e3a\u57fa\u4e8e\u786c\u76d8\u7684MyISAM\u8868\u3002 # \u8fd8\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6etmp_table_size\u9009\u9879\u6765\u589e\u52a0\u4e34\u65f6\u8868\u7684\u5927\u5c0f\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u8c03\u9ad8\u8be5\u503c\uff0cMySQL\u540c\u65f6\u5c06\u589e\u52a0heap\u8868\u7684\u5927\u5c0f\uff0c\u53ef\u8fbe\u5230\u63d0\u9ad8\u8054\u63a5\u67e5\u8be2\u901f\u5ea6\u7684\u6548\u679c read_buffer_size = 2M # MySQL\u8bfb\u5165\u7f13\u51b2\u533a\u5927\u5c0f\u3002\u5bf9\u8868\u8fdb\u884c\u987a\u5e8f\u626b\u63cf\u7684\u8bf7\u6c42\u5c06\u5206\u914d\u4e00\u4e2a\u8bfb\u5165\u7f13\u51b2\u533a\uff0cMySQL\u4f1a\u4e3a\u5b83\u5206\u914d\u4e00\u6bb5\u5185\u5b58\u7f13\u51b2\u533a\u3002 # read_buffer_size\u53d8\u91cf\u63a7\u5236\u8fd9\u4e00\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u3002 # \u5982\u679c\u5bf9\u8868\u7684\u987a\u5e8f\u626b\u63cf\u8bf7\u6c42\u975e\u5e38\u9891\u7e41\uff0c\u5e76\u4e14\u4f60\u8ba4\u4e3a\u9891\u7e41\u626b\u63cf\u8fdb\u884c\u5f97\u592a\u6162\uff0c\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u8be5\u53d8\u91cf\u503c\u4ee5\u53ca\u5185\u5b58\u7f13\u51b2\u533a\u5927\u5c0f\u63d0\u9ad8\u5176\u6027\u80fd read_rnd_buffer_size = 8M # MySQL\u7684\u968f\u673a\u8bfb\u7f13\u51b2\u533a\u5927\u5c0f\u3002\u5f53\u6309\u4efb\u610f\u987a\u5e8f\u8bfb\u53d6\u884c\u65f6(\u4f8b\u5982\uff0c\u6309\u7167\u6392\u5e8f\u987a\u5e8f)\uff0c\u5c06\u5206\u914d\u4e00\u4e2a\u968f\u673a\u8bfb\u7f13\u5b58\u533a\u3002\u8fdb\u884c\u6392\u5e8f\u67e5\u8be2\u65f6\uff0c # MySQL\u4f1a\u9996\u5148\u626b\u63cf\u4e00\u904d\u8be5\u7f13\u51b2\uff0c\u4ee5\u907f\u514d\u78c1\u76d8\u641c\u7d22\uff0c\u63d0\u9ad8\u67e5\u8be2\u901f\u5ea6\uff0c\u5982\u679c\u9700\u8981\u6392\u5e8f\u5927\u91cf\u6570\u636e\uff0c # \u53ef\u9002\u5f53\u8c03\u9ad8\u8be5\u503c\u3002\u4f46MySQL\u4f1a\u4e3a\u6bcf\u4e2a\u5ba2\u6237\u8fde\u63a5\u53d1\u653e\u8be5\u7f13\u51b2\u7a7a\u95f4\uff0c\u6240\u4ee5\u5e94\u5c3d\u91cf\u9002\u5f53\u8bbe\u7f6e\u8be5\u503c\uff0c\u4ee5\u907f\u514d\u5185\u5b58\u5f00\u9500\u8fc7\u5927 sort_buffer_size = 8M # MySQL\u6267\u884c\u6392\u5e8f\u4f7f\u7528\u7684\u7f13\u51b2\u5927\u5c0f\u3002\u5982\u679c\u60f3\u8981\u589e\u52a0ORDER BY\u7684\u901f\u5ea6\uff0c\u9996\u5148\u770b\u662f\u5426\u53ef\u4ee5\u8ba9MySQL\u4f7f\u7528\u7d22\u5f15\u800c\u4e0d\u662f\u989d\u5916\u7684\u6392\u5e8f\u9636\u6bb5\u3002 # \u5982\u679c\u4e0d\u80fd\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u589e\u52a0sort_buffer_size\u53d8\u91cf\u7684\u5927\u5c0f join_buffer_size = 8M # \u8054\u5408\u67e5\u8be2\u64cd\u4f5c\u6240\u80fd\u4f7f\u7528\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u548csort_buffer_size\u4e00\u6837\uff0c\u8be5\u53c2\u6570\u5bf9\u5e94\u7684\u5206\u914d\u5185\u5b58\u4e5f\u662f\u6bcf\u8fde\u63a5\u72ec\u4eab thread_cache_size = 8 # \u8fd9\u4e2a\u503c\uff08\u9ed8\u8ba48\uff09\u8868\u793a\u53ef\u4ee5\u91cd\u65b0\u5229\u7528\u4fdd\u5b58\u5728\u7f13\u5b58\u4e2d\u7ebf\u7a0b\u7684\u6570\u91cf\uff0c\u5f53\u65ad\u5f00\u8fde\u63a5\u65f6\u5982\u679c\u7f13\u5b58\u4e2d\u8fd8\u6709\u7a7a\u95f4\uff0c\u90a3\u4e48\u5ba2\u6237\u7aef\u7684\u7ebf\u7a0b\u5c06\u88ab\u653e\u5230\u7f13\u5b58\u4e2d\uff0c # \u5982\u679c\u7ebf\u7a0b\u91cd\u65b0\u88ab\u8bf7\u6c42\uff0c\u90a3\u4e48\u8bf7\u6c42\u5c06\u4ece\u7f13\u5b58\u4e2d\u8bfb\u53d6,\u5982\u679c\u7f13\u5b58\u4e2d\u662f\u7a7a\u7684\u6216\u8005\u662f\u65b0\u7684\u8bf7\u6c42\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7ebf\u7a0b\u5c06\u88ab\u91cd\u65b0\u521b\u5efa,\u5982\u679c\u6709\u5f88\u591a\u65b0\u7684\u7ebf\u7a0b\uff0c # \u589e\u52a0\u8fd9\u4e2a\u503c\u53ef\u4ee5\u6539\u5584\u7cfb\u7edf\u6027\u80fd.\u901a\u8fc7\u6bd4\u8f83Connections\u548cThreads_created\u72b6\u6001\u7684\u53d8\u91cf\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u53d8\u91cf\u7684\u4f5c\u7528\u3002(\u2013>\u8868\u793a\u8981\u8c03\u6574\u7684\u503c) # \u6839\u636e\u7269\u7406\u5185\u5b58\u8bbe\u7f6e\u89c4\u5219\u5982\u4e0b\uff1a # 1G - > 8 # 2G - > 16 # 3G - > 32 # \u5927\u4e8e3G - > 64 query_cache_size = 8M # MySQL\u7684\u67e5\u8be2\u7f13\u51b2\u5927\u5c0f\uff08\u4ece4.0.1\u5f00\u59cb\uff0cMySQL\u63d0\u4f9b\u4e86\u67e5\u8be2\u7f13\u51b2\u673a\u5236\uff09\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2\uff0cMySQL\u5c06SELECT\u8bed\u53e5\u548c\u67e5\u8be2\u7ed3\u679c\u5b58\u653e\u5728\u7f13\u51b2\u533a\u4e2d\uff0c # \u4eca\u540e\u5bf9\u4e8e\u540c\u6837\u7684SELECT\u8bed\u53e5\uff08\u533a\u5206\u5927\u5c0f\u5199\uff09\uff0c\u5c06\u76f4\u63a5\u4ece\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u7ed3\u679c\u3002\u6839\u636eMySQL\u7528\u6237\u624b\u518c\uff0c\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2\u6700\u591a\u53ef\u4ee5\u8fbe\u5230238%\u7684\u6548\u7387\u3002 # \u901a\u8fc7\u68c0\u67e5\u72b6\u6001\u503c'Qcache_%'\uff0c\u53ef\u4ee5\u77e5\u9053query_cache_size\u8bbe\u7f6e\u662f\u5426\u5408\u7406\uff1a\u5982\u679cQcache_lowmem_prunes\u7684\u503c\u975e\u5e38\u5927\uff0c\u5219\u8868\u660e\u7ecf\u5e38\u51fa\u73b0\u7f13\u51b2\u4e0d\u591f\u7684\u60c5\u51b5\uff0c # \u5982\u679cQcache_hits\u7684\u503c\u4e5f\u975e\u5e38\u5927\uff0c\u5219\u8868\u660e\u67e5\u8be2\u7f13\u51b2\u4f7f\u7528\u975e\u5e38\u9891\u7e41\uff0c\u6b64\u65f6\u9700\u8981\u589e\u52a0\u7f13\u51b2\u5927\u5c0f\uff1b\u5982\u679cQcache_hits\u7684\u503c\u4e0d\u5927\uff0c\u5219\u8868\u660e\u4f60\u7684\u67e5\u8be2\u91cd\u590d\u7387\u5f88\u4f4e\uff0c # \u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2\u53cd\u800c\u4f1a\u5f71\u54cd\u6548\u7387\uff0c\u90a3\u4e48\u53ef\u4ee5\u8003\u8651\u4e0d\u7528\u67e5\u8be2\u7f13\u51b2\u3002\u6b64\u5916\uff0c\u5728SELECT\u8bed\u53e5\u4e2d\u52a0\u5165SQL_NO_CACHE\u53ef\u4ee5\u660e\u786e\u8868\u793a\u4e0d\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2 query_cache_limit = 2M #\u6307\u5b9a\u5355\u4e2a\u67e5\u8be2\u80fd\u591f\u4f7f\u7528\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u9ed8\u8ba41M key_buffer_size = 4M # \u6307\u5b9a\u7528\u4e8e\u7d22\u5f15\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u589e\u52a0\u5b83\u53ef\u5f97\u5230\u66f4\u597d\u5904\u7406\u7684\u7d22\u5f15(\u5bf9\u6240\u6709\u8bfb\u548c\u591a\u91cd\u5199)\uff0c\u5230\u4f60\u80fd\u8d1f\u62c5\u5f97\u8d77\u90a3\u6837\u591a\u3002\u5982\u679c\u4f60\u4f7f\u5b83\u592a\u5927\uff0c # \u7cfb\u7edf\u5c06\u5f00\u59cb\u6362\u9875\u5e76\u4e14\u771f\u7684\u53d8\u6162\u4e86\u3002\u5bf9\u4e8e\u5185\u5b58\u57284GB\u5de6\u53f3\u7684\u670d\u52a1\u5668\u8be5\u53c2\u6570\u53ef\u8bbe\u7f6e\u4e3a384M\u6216512M\u3002\u901a\u8fc7\u68c0\u67e5\u72b6\u6001\u503cKey_read_requests\u548cKey_reads\uff0c # \u53ef\u4ee5\u77e5\u9053key_buffer_size\u8bbe\u7f6e\u662f\u5426\u5408\u7406\u3002\u6bd4\u4f8bkey_reads/key_read_requests\u5e94\u8be5\u5c3d\u53ef\u80fd\u7684\u4f4e\uff0c # \u81f3\u5c11\u662f1:100\uff0c1:1000\u66f4\u597d(\u4e0a\u8ff0\u72b6\u6001\u503c\u53ef\u4ee5\u4f7f\u7528SHOW STATUS LIKE 'key_read%'\u83b7\u5f97)\u3002\u6ce8\u610f\uff1a\u8be5\u53c2\u6570\u503c\u8bbe\u7f6e\u7684\u8fc7\u5927\u53cd\u800c\u4f1a\u662f\u670d\u52a1\u5668\u6574\u4f53\u6548\u7387\u964d\u4f4e ft_min_word_len = 4 # \u5206\u8bcd\u8bcd\u6c47\u6700\u5c0f\u957f\u5ea6\uff0c\u9ed8\u8ba44 transaction_isolation = REPEATABLE-READ # MySQL\u652f\u63014\u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff0c\u4ed6\u4eec\u5206\u522b\u662f\uff1a # READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE. # \u5982\u6ca1\u6709\u6307\u5b9a\uff0cMySQL\u9ed8\u8ba4\u91c7\u7528\u7684\u662fREPEATABLE-READ\uff0cORACLE\u9ed8\u8ba4\u7684\u662fREAD-COMMITTED log_bin = mysql-bin binlog_format = mixed expire_logs_days = 30 #\u8d85\u8fc730\u5929\u7684binlog\u5220\u9664 log_error = /data/mysql/mysql-error.log #\u9519\u8bef\u65e5\u5fd7\u8def\u5f84 slow_query_log = 1 long_query_time = 1 #\u6162\u67e5\u8be2\u65f6\u95f4 \u8d85\u8fc71\u79d2\u5219\u4e3a\u6162\u67e5\u8be2 slow_query_log_file = /data/mysql/mysql-slow.log performance_schema = 0 explicit_defaults_for_timestamp #lower_case_table_names = 1 #\u4e0d\u533a\u5206\u5927\u5c0f\u5199 skip-external-locking #MySQL\u9009\u9879\u4ee5\u907f\u514d\u5916\u90e8\u9501\u5b9a\u3002\u8be5\u9009\u9879\u9ed8\u8ba4\u5f00\u542f default-storage-engine = InnoDB #\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce innodb_file_per_table = 1 # InnoDB\u4e3a\u72ec\u7acb\u8868\u7a7a\u95f4\u6a21\u5f0f\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u7684\u6bcf\u4e2a\u8868\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a\u6570\u636e\u7a7a\u95f4 # \u72ec\u7acb\u8868\u7a7a\u95f4\u4f18\u70b9\uff1a # 1\uff0e\u6bcf\u4e2a\u8868\u90fd\u6709\u81ea\u5df2\u72ec\u7acb\u7684\u8868\u7a7a\u95f4\u3002 # 2\uff0e\u6bcf\u4e2a\u8868\u7684\u6570\u636e\u548c\u7d22\u5f15\u90fd\u4f1a\u5b58\u5728\u81ea\u5df2\u7684\u8868\u7a7a\u95f4\u4e2d\u3002 # 3\uff0e\u53ef\u4ee5\u5b9e\u73b0\u5355\u8868\u5728\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e2d\u79fb\u52a8\u3002 # 4\uff0e\u7a7a\u95f4\u53ef\u4ee5\u56de\u6536\uff08\u9664drop table\u64cd\u4f5c\u5904\uff0c\u8868\u7a7a\u4e0d\u80fd\u81ea\u5df2\u56de\u6536\uff09 # \u7f3a\u70b9\uff1a # \u5355\u8868\u589e\u52a0\u8fc7\u5927\uff0c\u5982\u8d85\u8fc7100G # \u7ed3\u8bba\uff1a # \u5171\u4eab\u8868\u7a7a\u95f4\u5728Insert\u64cd\u4f5c\u4e0a\u5c11\u6709\u4f18\u52bf\u3002\u5176\u5b83\u90fd\u6ca1\u72ec\u7acb\u8868\u7a7a\u95f4\u8868\u73b0\u597d\u3002\u5f53\u542f\u7528\u72ec\u7acb\u8868\u7a7a\u95f4\u65f6\uff0c\u8bf7\u5408\u7406\u8c03\u6574\uff1ainnodb_open_files innodb_open_files = 500 # \u9650\u5236Innodb\u80fd\u6253\u5f00\u7684\u8868\u7684\u6570\u636e\uff0c\u5982\u679c\u5e93\u91cc\u7684\u8868\u7279\u522b\u591a\u7684\u60c5\u51b5\uff0c\u8bf7\u589e\u52a0\u8fd9\u4e2a\u3002\u8fd9\u4e2a\u503c\u9ed8\u8ba4\u662f300 innodb_buffer_pool_size = 64M # InnoDB\u4f7f\u7528\u4e00\u4e2a\u7f13\u51b2\u6c60\u6765\u4fdd\u5b58\u7d22\u5f15\u548c\u539f\u59cb\u6570\u636e, \u4e0d\u50cfMyISAM. # \u8fd9\u91cc\u4f60\u8bbe\u7f6e\u8d8a\u5927,\u4f60\u5728\u5b58\u53d6\u8868\u91cc\u9762\u6570\u636e\u65f6\u6240\u9700\u8981\u7684\u78c1\u76d8I/O\u8d8a\u5c11. # \u5728\u4e00\u4e2a\u72ec\u7acb\u4f7f\u7528\u7684\u6570\u636e\u5e93\u670d\u52a1\u5668\u4e0a,\u4f60\u53ef\u4ee5\u8bbe\u7f6e\u8fd9\u4e2a\u53d8\u91cf\u5230\u670d\u52a1\u5668\u7269\u7406\u5185\u5b58\u5927\u5c0f\u768480% # \u4e0d\u8981\u8bbe\u7f6e\u8fc7\u5927,\u5426\u5219,\u7531\u4e8e\u7269\u7406\u5185\u5b58\u7684\u7ade\u4e89\u53ef\u80fd\u5bfc\u81f4\u64cd\u4f5c\u7cfb\u7edf\u7684\u6362\u9875\u98a0\u7c38. # \u6ce8\u610f\u572832\u4f4d\u7cfb\u7edf\u4e0a\u4f60\u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u80fd\u88ab\u9650\u5236\u5728 2-3.5G \u7528\u6237\u5c42\u9762\u5185\u5b58\u9650\u5236, # \u6240\u4ee5\u4e0d\u8981\u8bbe\u7f6e\u7684\u592a\u9ad8. innodb_write_io_threads = 4 innodb_read_io_threads = 4 # innodb\u4f7f\u7528\u540e\u53f0\u7ebf\u7a0b\u5904\u7406\u6570\u636e\u9875\u4e0a\u7684\u8bfb\u5199 I/O(\u8f93\u5165\u8f93\u51fa)\u8bf7\u6c42,\u6839\u636e\u4f60\u7684 CPU \u6838\u6570\u6765\u66f4\u6539,\u9ed8\u8ba4\u662f4 # \u6ce8:\u8fd9\u4e24\u4e2a\u53c2\u6570\u4e0d\u652f\u6301\u52a8\u6001\u6539\u53d8,\u9700\u8981\u628a\u8be5\u53c2\u6570\u52a0\u5165\u5230my.cnf\u91cc\uff0c\u4fee\u6539\u5b8c\u540e\u91cd\u542fMySQL\u670d\u52a1,\u5141\u8bb8\u503c\u7684\u8303\u56f4\u4ece 1-64 innodb_thread_concurrency = 0 # \u9ed8\u8ba4\u8bbe\u7f6e\u4e3a 0,\u8868\u793a\u4e0d\u9650\u5236\u5e76\u53d1\u6570\uff0c\u8fd9\u91cc\u63a8\u8350\u8bbe\u7f6e\u4e3a0\uff0c\u66f4\u597d\u53bb\u53d1\u6325CPU\u591a\u6838\u5904\u7406\u80fd\u529b\uff0c\u63d0\u9ad8\u5e76\u53d1\u91cf innodb_purge_threads = 1 # InnoDB\u4e2d\u7684\u6e05\u9664\u64cd\u4f5c\u662f\u4e00\u7c7b\u5b9a\u671f\u56de\u6536\u65e0\u7528\u6570\u636e\u7684\u64cd\u4f5c\u3002\u5728\u4e4b\u524d\u7684\u51e0\u4e2a\u7248\u672c\u4e2d\uff0c # \u6e05\u9664\u64cd\u4f5c\u662f\u4e3b\u7ebf\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u610f\u5473\u7740\u8fd0\u884c\u65f6\u5b83\u53ef\u80fd\u4f1a\u5835\u585e\u5176\u5b83\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u3002 # \u4eceMySQL5.5.X\u7248\u672c\u5f00\u59cb\uff0c\u8be5\u64cd\u4f5c\u8fd0\u884c\u4e8e\u72ec\u7acb\u7684\u7ebf\u7a0b\u4e2d,\u5e76\u652f\u6301\u66f4\u591a\u7684\u5e76\u53d1\u6570\u3002\u7528\u6237\u53ef\u901a\u8fc7\u8bbe\u7f6einnodb_purge_threads\u914d\u7f6e\u53c2\u6570\u6765\u9009\u62e9\u6e05\u9664\u64cd\u4f5c\u662f\u5426\u4f7f\u7528\u5355 # \u72ec\u7ebf\u7a0b,\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53c2\u6570\u8bbe\u7f6e\u4e3a0(\u4e0d\u4f7f\u7528\u5355\u72ec\u7ebf\u7a0b),\u8bbe\u7f6e\u4e3a 1 \u65f6\u8868\u793a\u4f7f\u7528\u5355\u72ec\u7684\u6e05\u9664\u7ebf\u7a0b\u3002\u5efa\u8bae\u4e3a1 innodb_flush_log_at_trx_commit = 2 # 0\uff1a\u5982\u679cinnodb_flush_log_at_trx_commit\u7684\u503c\u4e3a0, # log buffer\u6bcf\u79d2\u5c31\u4f1a\u88ab\u5237\u5199\u65e5\u5fd7\u6587\u4ef6\u5230\u78c1\u76d8\uff0c\u63d0\u4ea4\u4e8b\u52a1\u7684\u65f6\u5019\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c\uff08\u6267\u884c\u662f\u7531mysql\u7684master thread\u7ebf\u7a0b\u6765\u6267\u884c\u7684\u3002 # \u4e3b\u7ebf\u7a0b\u4e2d\u6bcf\u79d2\u4f1a\u5c06\u91cd\u505a\u65e5\u5fd7\u7f13\u51b2\u5199\u5165\u78c1\u76d8\u7684\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6(REDO LOG)\u4e2d\u3002\u4e0d\u8bba\u4e8b\u52a1\u662f\u5426\u5df2\u7ecf\u63d0\u4ea4\uff09\u9ed8\u8ba4\u7684\u65e5\u5fd7\u6587\u4ef6\u662fib_logfile0,ib_logfile1 # 1\uff1a\u5f53\u8bbe\u4e3a\u9ed8\u8ba4\u503c1\u7684\u65f6\u5019\uff0c\u6bcf\u6b21\u63d0\u4ea4\u4e8b\u52a1\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u5c06log buffer\u5237\u5199\u5230\u65e5\u5fd7\u3002 # 2\uff1a\u5982\u679c\u8bbe\u4e3a2,\u6bcf\u6b21\u63d0\u4ea4\u4e8b\u52a1\u90fd\u4f1a\u5199\u65e5\u5fd7\uff0c\u4f46\u5e76\u4e0d\u4f1a\u6267\u884c\u5237\u7684\u64cd\u4f5c\u3002\u6bcf\u79d2\u5b9a\u65f6\u4f1a\u5237\u5230\u65e5\u5fd7\u6587\u4ef6\u3002 # \u8981\u6ce8\u610f\u7684\u662f\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1100%\u6bcf\u79d2\u4e00\u5b9a\u90fd\u4f1a\u5237\u5230\u78c1\u76d8\uff0c\u8fd9\u8981\u53d6\u51b3\u4e8e\u8fdb\u7a0b\u7684\u8c03\u5ea6\u3002 # \u6bcf\u6b21\u4e8b\u52a1\u63d0\u4ea4\u7684\u65f6\u5019\u5c06\u6570\u636e\u5199\u5165\u4e8b\u52a1\u65e5\u5fd7\uff0c\u800c\u8fd9\u91cc\u7684\u5199\u5165\u4ec5\u662f\u8c03\u7528\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u5199\u5165\u64cd\u4f5c\uff0c # \u800c\u6587\u4ef6\u7cfb\u7edf\u662f\u6709 \u7f13\u5b58\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u5199\u5165\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u6570\u636e\u5df2\u7ecf\u5199\u5165\u5230\u7269\u7406\u78c1\u76d8 # \u9ed8\u8ba4\u503c1\u662f\u4e3a\u4e86\u4fdd\u8bc1\u5b8c\u6574\u7684ACID\u3002\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u914d\u7f6e\u9879\u8bbe\u4e3a1\u4ee5\u5916\u7684\u503c\u6765\u6362\u53d6\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u4f46\u662f\u5728\u7cfb\u7edf\u5d29\u6e83\u7684\u65f6\u5019\uff0c\u4f60\u5c06\u4f1a\u4e22\u59311\u79d2\u7684\u6570\u636e\u3002 # \u8bbe\u4e3a0\u7684\u8bdd\uff0cmysqld\u8fdb\u7a0b\u5d29\u6e83\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u4e22\u5931\u6700\u540e1\u79d2\u7684\u4e8b\u52a1\u3002 # \u8bbe\u4e3a2,\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u5d29\u6e83\u6216\u8005\u65ad\u7535\u7684\u65f6\u5019\u624d\u4f1a\u4e22\u5931\u6700\u540e1\u79d2\u7684\u6570\u636e\u3002InnoDB\u5728\u505a\u6062\u590d\u7684\u65f6\u5019\u4f1a\u5ffd\u7565\u8fd9\u4e2a\u503c\u3002 ### \u603b\u7ed3 ### # \u8bbe\u4e3a1\u5f53\u7136\u662f\u6700\u5b89\u5168\u7684\uff0c\u4f46\u6027\u80fd\u9875\u662f\u6700\u5dee\u7684\uff08\u76f8\u5bf9\u5176\u4ed6\u4e24\u4e2a\u53c2\u6570\u800c\u8a00\uff0c\u4f46\u4e0d\u662f\u4e0d\u80fd\u63a5\u53d7\uff09\u3002 # \u5982\u679c\u5bf9\u6570\u636e\u4e00\u81f4\u6027\u548c\u5b8c\u6574\u6027\u8981\u6c42\u4e0d\u9ad8\uff0c\u5b8c\u5168\u53ef\u4ee5\u8bbe\u4e3a2\uff0c\u5982\u679c\u53ea\u6700\u6c42\u6027\u80fd\uff0c\u4f8b\u5982\u9ad8\u5e76\u53d1\u5199\u7684\u65e5\u5fd7\u670d\u52a1\u5668\uff0c\u8bbe\u4e3a0\u6765\u83b7\u5f97\u66f4\u9ad8\u6027\u80fd innodb_log_buffer_size = 2M # \u6b64\u53c2\u6570\u786e\u5b9a\u4e9b\u65e5\u5fd7\u6587\u4ef6\u6240\u7528\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u7f13\u51b2\u533a\u66f4\u5927\u80fd\u63d0\u9ad8\u6027\u80fd\uff0c\u4f46\u610f\u5916\u7684\u6545\u969c\u5c06\u4f1a\u4e22\u5931\u6570\u636e\u3002MySQL\u5f00\u53d1\u4eba\u5458\u5efa\u8bae\u8bbe\u7f6e\u4e3a1\uff0d8M\u4e4b\u95f4 innodb_log_file_size = 32M # \u6b64\u53c2\u6570\u786e\u5b9a\u6570\u636e\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u66f4\u5927\u7684\u8bbe\u7f6e\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\uff0c\u4f46\u4e5f\u4f1a\u589e\u52a0\u6062\u590d\u6545\u969c\u6570\u636e\u5e93\u6240\u9700\u7684\u65f6\u95f4 innodb_log_files_in_group = 3 # \u4e3a\u63d0\u9ad8\u6027\u80fd\uff0cMySQL\u53ef\u4ee5\u4ee5\u5faa\u73af\u65b9\u5f0f\u5c06\u65e5\u5fd7\u6587\u4ef6\u5199\u5230\u591a\u4e2a\u6587\u4ef6\u3002\u63a8\u8350\u8bbe\u7f6e\u4e3a3 innodb_max_dirty_pages_pct = 90 # innodb\u4e3b\u7ebf\u7a0b\u5237\u65b0\u7f13\u5b58\u6c60\u4e2d\u7684\u6570\u636e\uff0c\u4f7f\u810f\u6570\u636e\u6bd4\u4f8b\u5c0f\u4e8e90% innodb_lock_wait_timeout = 120 # InnoDB\u4e8b\u52a1\u5728\u88ab\u56de\u6eda\u4e4b\u524d\u53ef\u4ee5\u7b49\u5f85\u4e00\u4e2a\u9501\u5b9a\u7684\u8d85\u65f6\u79d2\u6570\u3002 # InnoDB\u5728\u5b83\u81ea\u5df1\u7684\u9501\u5b9a\u8868\u4e2d\u81ea\u52a8\u68c0\u6d4b\u4e8b\u52a1\u6b7b\u9501\u5e76\u4e14\u56de\u6eda\u4e8b\u52a1\u3002InnoDB\u7528LOCK TABLES\u8bed\u53e5\u6ce8\u610f\u5230\u9501\u5b9a\u8bbe\u7f6e\u3002\u9ed8\u8ba4\u503c\u662f50\u79d2 bulk_insert_buffer_size = 8M # \u6279\u91cf\u63d2\u5165\u7f13\u5b58\u5927\u5c0f\uff0c \u8fd9\u4e2a\u53c2\u6570\u662f\u9488\u5bf9MyISAM\u5b58\u50a8\u5f15\u64ce\u6765\u8bf4\u7684\u3002 # \u9002\u7528\u4e8e\u5728\u4e00\u6b21\u6027\u63d2\u5165100-1000+\u6761\u8bb0\u5f55\u65f6\uff0c \u63d0\u9ad8\u6548\u7387\u3002\u9ed8\u8ba4\u503c\u662f8M\u3002\u53ef\u4ee5\u9488\u5bf9\u6570\u636e\u91cf\u7684\u5927\u5c0f\uff0c\u7ffb\u500d\u589e\u52a0\u3002 myisam_sort_buffer_size = 8M # MyISAM\u8bbe\u7f6e\u6062\u590d\u8868\u4e4b\u65f6\u4f7f\u7528\u7684\u7f13\u51b2\u533a\u7684\u5c3a\u5bf8\uff0c\u5f53\u5728REPAIR TABLE\u6216\u7528CREATE INDEX\u521b\u5efa\u7d22\u5f15\u6216ALTER TABLE\u8fc7\u7a0b\u4e2d\u6392\u5e8f MyISAM\u7d22\u5f15\u5206\u914d\u7684\u7f13\u51b2\u533a myisam_max_sort_file_size = 10G # \u5982\u679c\u4e34\u65f6\u6587\u4ef6\u4f1a\u53d8\u5f97\u8d85\u8fc7\u7d22\u5f15\uff0c\u4e0d\u8981\u4f7f\u7528\u5feb\u901f\u6392\u5e8f\u7d22\u5f15\u65b9\u6cd5\u6765\u521b\u5efa\u4e00\u4e2a\u7d22\u5f15\u3002\u6ce8\u91ca\uff1a\u8fd9\u4e2a\u53c2\u6570\u4ee5\u5b57\u8282\u7684\u5f62\u5f0f\u7ed9\u51fa myisam_repair_threads = 1 # \u5982\u679c\u8be5\u503c\u5927\u4e8e1\uff0c\u5728Repair by sorting\u8fc7\u7a0b\u4e2d\u5e76\u884c\u521b\u5efaMyISAM\u8868\u7d22\u5f15(\u6bcf\u4e2a\u7d22\u5f15\u5728\u81ea\u5df1\u7684\u7ebf\u7a0b\u5185) interactive_timeout = 28800 # \u670d\u52a1\u5668\u5173\u95ed\u4ea4\u4e92\u5f0f\u8fde\u63a5\u524d\u7b49\u5f85\u6d3b\u52a8\u7684\u79d2\u6570\u3002\u4ea4\u4e92\u5f0f\u5ba2\u6237\u7aef\u5b9a\u4e49\u4e3a\u5728 # mysql_real_connect()\u4e2d\u4f7f\u7528CLIENT_INTERACTIVE\u9009\u9879\u7684\u5ba2\u6237\u7aef\u3002\u9ed8\u8ba4\u503c\uff1a28800\u79d2\uff088\u5c0f\u65f6\uff09 wait_timeout = 28800 # \u670d\u52a1\u5668\u5173\u95ed\u975e\u4ea4\u4e92\u8fde\u63a5\u4e4b\u524d\u7b49\u5f85\u6d3b\u52a8\u7684\u79d2\u6570\u3002\u5728\u7ebf\u7a0b\u542f\u52a8\u65f6\uff0c\u6839\u636e\u5168\u5c40wait_timeout\u503c\u6216\u5168\u5c40interactive_timeout\u503c\u521d\u59cb\u5316\u4f1a\u8bddwait_timeout\u503c\uff0c # \u53d6\u51b3\u4e8e\u5ba2\u6237\u7aef\u7c7b\u578b(\u7531mysql_real_connect()\u7684\u8fde\u63a5\u9009\u9879CLIENT_INTERACTIVE\u5b9a\u4e49)\u3002\u53c2\u6570\u9ed8\u8ba4\u503c\uff1a28800\u79d2\uff088\u5c0f\u65f6\uff09 # MySQL\u670d\u52a1\u5668\u6240\u652f\u6301\u7684\u6700\u5927\u8fde\u63a5\u6570\u662f\u6709\u4e0a\u9650\u7684\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u7684\u5efa\u7acb\u90fd\u4f1a\u6d88\u8017\u5185\u5b58\uff0c\u56e0\u6b64\u6211\u4eec\u5e0c\u671b\u5ba2\u6237\u7aef\u5728\u8fde\u63a5\u5230MySQL Server\u5904\u7406\u5b8c\u76f8\u5e94\u7684\u64cd\u4f5c\u540e\uff0c # \u5e94\u8be5\u65ad\u5f00\u8fde\u63a5\u5e76\u91ca\u653e\u5360\u7528\u7684\u5185\u5b58\u3002\u5982\u679c\u4f60\u7684MySQL Server\u6709\u5927\u91cf\u7684\u95f2\u7f6e\u8fde\u63a5\uff0c\u4ed6\u4eec\u4e0d\u4ec5\u4f1a\u767d\u767d\u6d88\u8017\u5185\u5b58\uff0c\u800c\u4e14\u5982\u679c\u8fde\u63a5\u4e00\u76f4\u5728\u7d2f\u52a0\u800c\u4e0d\u65ad\u5f00\uff0c # \u6700\u7ec8\u80af\u5b9a\u4f1a\u8fbe\u5230MySQL Server\u7684\u8fde\u63a5\u4e0a\u9650\u6570\uff0c\u8fd9\u4f1a\u62a5'too many connections'\u7684\u9519\u8bef\u3002\u5bf9\u4e8ewait_timeout\u7684\u503c\u8bbe\u5b9a\uff0c\u5e94\u8be5\u6839\u636e\u7cfb\u7edf\u7684\u8fd0\u884c\u60c5\u51b5\u6765\u5224\u65ad\u3002 # \u5728\u7cfb\u7edf\u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7show processlist\u547d\u4ee4\u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u7684\u8fde\u63a5\u72b6\u6001\uff0c\u5982\u679c\u53d1\u73b0\u6709\u5927\u91cf\u7684sleep\u72b6\u6001\u7684\u8fde\u63a5\u8fdb\u7a0b\uff0c\u5219\u8bf4\u660e\u8be5\u53c2\u6570\u8bbe\u7f6e\u7684\u8fc7\u5927\uff0c # \u53ef\u4ee5\u8fdb\u884c\u9002\u5f53\u7684\u8c03\u6574\u5c0f\u4e9b\u3002\u8981\u540c\u65f6\u8bbe\u7f6einteractive_timeout\u548cwait_timeout\u624d\u4f1a\u751f\u6548\u3002 [mysqldump] quick max_allowed_packet = 16M #\u670d\u52a1\u5668\u53d1\u9001\u548c\u63a5\u53d7\u7684\u6700\u5927\u5305\u957f\u5ea6 [myisamchk] key_buffer_size = 8M sort_buffer_size = 8M read_buffer = 4M write_buffer = 4M innodb_flush_log_at_trx_commit \u00b6 innodb_buffer_pool_size \u00b6 \u5982 \u679c\u7528Innodb\uff0c\u90a3\u4e48\u8fd9\u662f\u4e00\u4e2a\u91cd\u8981\u53d8\u91cf\u3002\u76f8\u5bf9\u4e8eMyISAM\u6765\u8bf4\uff0cInnodb\u5bf9\u4e8ebuffer size\u66f4\u654f\u611f\u3002MySIAM\u53ef\u80fd\u5bf9\u4e8e\u5927\u6570\u636e\u91cf\u4f7f\u7528\u9ed8\u8ba4\u7684key_buffer_size\u4e5f\u8fd8\u597d\uff0c\u4f46Innodb\u5728\u5927\u6570\u636e\u91cf\u65f6\u7528\u9ed8\u8ba4\u503c\u5c31\u611f\u89c9\u5728\u722c\u4e86\u3002 Innodb\u7684\u7f13\u51b2\u6c60\u4f1a\u7f13\u5b58\u6570\u636e\u548c\u7d22\u5f15\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u7ed9\u7cfb\u7edf\u7684\u7f13\u5b58\u7559\u7a7a\u95f4\uff0c\u5982\u679c\u53ea\u7528Innodb\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e2a\u503c\u8bbe\u4e3a\u5185\u5b58\u768470%-80%\u3002\u548c key_buffer\u76f8\u540c\uff0c\u5982\u679c\u6570\u636e\u91cf\u6bd4\u8f83\u5c0f\u4e5f\u4e0d\u600e\u4e48\u589e\u52a0\uff0c\u90a3\u4e48\u4e0d\u8981\u628a\u8fd9\u4e2a\u503c\u8bbe\u592a\u9ad8\u4e5f\u53ef\u4ee5\u63d0\u9ad8\u5185\u5b58\u7684\u4f7f\u7528\u7387\u3002 innodb_additional_pool_size \u00b6 \u8fd9\u4e2a\u7684\u6548\u679c\u4e0d\u662f\u5f88\u660e\u663e\uff0c\u81f3\u5c11\u662f\u5f53\u64cd\u4f5c\u7cfb\u7edf\u80fd\u5408\u7406\u5206\u914d\u5185\u5b58\u65f6\u3002\u4f46\u4f60\u53ef\u80fd\u4ecd\u9700\u8981\u8bbe\u621020M\u6216\u66f4\u591a\u4e00\u70b9\u4ee5\u770bInnodb\u4f1a\u5206\u914d\u591a\u5c11\u5185\u5b58\u505a\u5176\u4ed6\u7528\u9014\u3002 innodb_log_file_size \u00b6 \u5bf9\u4e8e\u5199\u5f88\u591a\u5c24\u5176\u662f\u5927\u6570\u636e\u91cf\u65f6\u975e\u5e38\u91cd\u8981\u3002\u8981\u6ce8\u610f\uff0c\u5927\u7684\u6587\u4ef6\u63d0\u4f9b\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u4f46\u6570\u636e\u5e93\u6062\u590d\u65f6\u4f1a\u7528\u66f4\u591a\u7684\u65f6\u95f4\u3002\u6211\u4e00\u822c\u752864M-512M\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u670d\u52a1\u5668\u7684\u7a7a\u95f4\u3002 innodb_log_buffer_size \u00b6 \u9ed8\u8ba4\u503c\u5bf9\u4e8e\u591a\u6570\u4e2d\u7b49\u5199\u64cd\u4f5c\u548c\u4e8b\u52a1\u77ed\u7684\u8fd0\u7528\u90fd\u662f\u53ef\u4ee5\u7684\u3002\u5982 \u679c\u7ecf\u5e38\u505a\u66f4\u65b0\u6216\u8005\u4f7f\u7528\u4e86\u5f88\u591ablob\u6570\u636e\uff0c\u5e94\u8be5\u589e\u5927\u8fd9\u4e2a\u503c\u3002\u4f46\u592a\u5927\u4e86\u4e5f\u662f\u6d6a\u8d39\u5185\u5b58\uff0c\u56e0\u4e3a1\u79d2\u949f\u603b\u4f1a flush\uff08\u8fd9\u4e2a\u8bcd\u7684\u4e2d\u6587\u600e\u4e48\u8bf4\u5462\uff1f\uff09\u4e00\u6b21\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u8bbe\u5230\u8d85\u8fc71\u79d2\u7684\u9700\u6c42\u30028M-16M\u4e00\u822c\u5e94\u8be5\u591f\u4e86\u3002\u5c0f\u7684\u8fd0\u7528\u53ef\u4ee5\u8bbe\u66f4\u5c0f\u4e00\u70b9\u3002 innodb_flush_log_at_trx_commit \uff08\u8fd9\u4e2a\u5f88\u7ba1\u7528\uff09 \u00b6 \u62b1\u6028Innodb\u6bd4MyISAM\u6162 100\u500d\uff1f\u90a3\u4e48\u4f60\u5927\u6982\u662f\u5fd8\u4e86\u8c03\u6574\u8fd9\u4e2a\u503c\u3002\u9ed8\u8ba4\u503c1\u7684\u610f\u601d\u662f\u6bcf\u4e00\u6b21\u4e8b\u52a1\u63d0\u4ea4\u6216\u4e8b\u52a1\u5916\u7684\u6307\u4ee4\u90fd\u9700\u8981\u628a\u65e5\u5fd7\u5199\u5165\uff08flush\uff09\u786c\u76d8\uff0c\u8fd9\u662f\u5f88\u8d39\u65f6\u7684\u3002\u7279\u522b\u662f\u4f7f\u7528\u7535 \u6c60\u4f9b\u7535\u7f13\u5b58\uff08Battery backed up cache\uff09\u65f6\u3002\u8bbe\u62102\u5bf9\u4e8e\u5f88\u591a\u8fd0\u7528\uff0c\u7279\u522b\u662f\u4eceMyISAM\u8868\u8f6c\u8fc7\u6765\u7684\u662f\u53ef\u4ee5\u7684\uff0c\u5b83\u7684\u610f\u601d\u662f\u4e0d\u5199\u5165\u786c\u76d8\u800c\u662f\u5199\u5165\u7cfb\u7edf\u7f13\u5b58\u3002\u65e5\u5fd7\u4ecd\u7136\u4f1a\u6bcf\u79d2flush\u5230\u786c \u76d8\uff0c\u6240\u4ee5\u4f60\u4e00\u822c\u4e0d\u4f1a\u4e22\u5931\u8d85\u8fc71-2\u79d2\u7684\u66f4\u65b0\u3002\u8bbe\u62100\u4f1a\u66f4\u5feb\u4e00\u70b9\uff0c\u4f46\u5b89\u5168\u65b9\u9762\u6bd4\u8f83\u5dee\uff0c\u5373\u4f7fMySQL\u6302\u4e86\u4e5f\u53ef\u80fd\u4f1a\u4e22\u5931\u4e8b\u52a1\u7684\u6570\u636e\u3002\u800c\u503c2\u53ea\u4f1a\u5728\u6574\u4e2a\u64cd\u4f5c\u7cfb\u7edf \u6302\u4e86\u65f6\u624d\u53ef\u80fd\u4e22\u6570\u636e\u3002 innodb_flush_log_at_trx_commit \u00b6 If the value of innodb_flush_log_at_trx_commit is 0, the log buffer is written out to the log file once per second and the flush to disk operation is performed on the log file, but nothing is done at a transaction commit. When the value is 1, the log buffer is written out to the log file at each transaction commit and the flush to disk operation is performed on the log file. When the value is 2, the log buffer is written out to the file at each commit, but the flush to disk operation is not performed on it. However, the flushing on the log file takes place once per second also when the value is 2. Note that the once-per-second flushing is not 100% guaranteed to happen every second, due to process scheduling issues. The default value of this variable is 1 (prior to MySQL 4.0.13, the default is 0). A value of 1 is required for ACID compliance. You can achieve better performance by setting the value different from 1, but then you can lose at most one second worth of transactions in a crash. With a value of 0, any mysqldprocess crash can erase the last second of transactions. With a value of 2, then only an operating system crash or a power outage can erase the last second of transactions. However, InnoDB's crash recovery is not affected and thus crash recovery does work regardless of the value. Note For the greatest possible durability and consistency in a replication setup using InnoDB with transactions, use innodb_flush_log_at_trx_commit=1, sync_binlog=1, and innodb-safe-binlog in your master server my.cnf file. Caution Many operating systems and some disk hardware fool the flush-to-disk operation. They may tellmysqld that the flush has taken place, even though it has not. Then the durability of transactions is not guaranteed even with the setting 1, and in the worst case a power outage can even corrupt theInnoDB database. Using a battery-backed disk cache in the SCSI disk controller or in the disk itself speeds up file flushes, and makes the operation safer. You can also try using the Unix commandhdparm to disable the caching of disk writes in hardware caches, or use some other command specific to the hardware vendor. my.cnf \u6700\u7d42\u5f62\u614b \u00b6 [mysql] default-character-set=utf8 socket=/tmp/mysql.sock [mysqld] user=mysql datadir=/home/mysql socket=/tmp/mysql.sock tmpdir=/home/tmp slow_query_log=1 # slow query \u6a5f\u80fd\u3092ON\u306b\u3059\u308b long_query_time=10 # slow query \u6642\u9593\u309210\u79d2\u306b\u8a2d\u5b9a slow_query_log_file=/var/log/mysql/slow_query.log log-error=/var/log/mysql/error.log log_output=FILE # log\u5f62\u5f0f\u3092file\u5f0f\u306b\u8a2d\u5b9a #myisam myisam_sort_buffer_size=128M # MyISAM\u3067\u4ee5\u4e0b\u306e\u6642\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30bd\u30fc\u30c8\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 # REPAIR TABLE\u3001CREATE INDEX\u3001ALTER INDEX\u3002\u901a\u5e38\u306e\u30af\u30a8\u30ea(DML)\u3067\u306f\u4f7f\u308f\u308c\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3001\u305d\u308c\u307b\u3069\u591a\u304f\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u3002 key_buffer_size=512M # MyISAM\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 # \u591a\u304f\u5272\u308a\u5f53\u3066\u305f\u65b9\u304c\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u5411\u4e0a\u3057\u307e\u3059\u3002\u30b0\u30ed\u30fc\u30d0\u30eb\u30d0\u30c3\u30d5\u30a1\u306a\u306e\u3067\u3069\u304b\u3093\u3068\u5272\u308a\u5f53\u3066\u3089\u308c\u307e\u3059\u3002 # \u3082\u3057\u3001MyISAM\u3092(\u3042\u307e\u308a)\u4f7f\u3063\u3066\u306a\u3044\u306e\u306a\u3089\u3070\u3001\u5c0f\u3055\u304f\u3057\u3066\u307b\u304b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u56de\u3059\u306e\u3082\u30a2\u30ea\u3067\u3059\u3002 sort_buffer_size=2M # ORDER BY\u3084GROUP BY\u306e\u3068\u304d\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 read_buffer_size=2M # \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u7528\u3044\u306a\u3044\u30c6\u30fc\u30d6\u30eb\u30b9\u30ad\u30e3\u30f3\u306e\u3068\u304d\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 read_rnd_buffer_size=2M # \u30bd\u30fc\u30c8\u5f8c\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u8aad\u3080\u3068\u304d\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 # \u30c7\u30a3\u30b9\u30afI/O\u304c\u6e1b\u308b\u306e\u3067ORDER BY\u306e\u6027\u80fd\u5411\u4e0a\u304c\u671f\u5f85\u3067\u304d\u307e\u3059\u3002 #server default-storage-engine=INNODB skip-name-resolve # DNS\u89e3\u6c7a\u3092OFF\u306b\u3059\u308b skip-ssl # MySQL5.7\u3067\u306fSSL\u5229\u7528\u3057\u306a\u3044\u305f\u3081\u3001OFF\u306b\u3059\u308b max_connections=300 # \u6700\u5927\u63a5\u7d9a\u6570\u3092300\u306b\u3059\u308b\u3001\u30b5\u30fc\u30d0\u306e\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3068\u30cd\u30c3\u30c8\u5e2f\u57df\u306b\u3088\u308b\u3082\u306e\u3067\u3001 # \u4eca\u5f8c\u30b5\u30fc\u30d0\u30ea\u30d7\u30ec\u30fc\u30b9\u306810G\u5316\u3057\u305f\u5f8c\u3001\u5909\u66f4\u3059\u308b\u5fc5\u8981\u3042\u308a\u307e\u3059\u3002 max_connect_errors=300 # \u9023\u7d9a\u3057\u3066\u63a5\u7d9a\u8981\u6c42\u304c\u4e2d\u65ad\u3055\u308c\u305f\u5834\u5408\u306b\u305d\u308c\u3092\u8a31\u53ef\u3059\u308b\u56de\u6570\u3092\u6c7a\u5b9a\u3057\u307e\u3059\u3002 max_allowed_packet=16M # MySQL Server \u304a\u3088\u3073\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u9593\u3067\u8ee2\u9001\u53ef\u80fd\u306a\u30d1\u30b1\u30c3\u30c8\u6570\u3002 query_cache_size=512M # \u30af\u30a8\u30ea\u30ad\u30e3\u30c3\u30b7\u30e5\u9818\u57df\u3002 query_cache_limit=32M # \u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u30af\u30a8\u30ea\u7d50\u679c\u306e\u6700\u5927\u30b5\u30a4\u30ba\u3002 query_cache_type=1 # SELECT SQL_NO_CACHE \u4ee5\u5916\u306e\u30af\u30a8\u30ea\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b connect_timeout=30 # connect timeout \u6642\u9593\u309230\u79d2\u306b\u8a2d\u5b9a max_user_connections=30 # \u5358\u4e00\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u3088\u308b\u540c\u6642\u63a5\u7d9a\u306e\u6570 thread_cache_size=300 # \u30b9\u30ec\u30c3\u30c9\u3092\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u306e\u5207\u65ad\u5f8c\u306b\u3082\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u3066\u304a\u304f\u6570\u3002 # thread_cache_size\u3092N\u306b\u8a2d\u5b9a\u3059\u308b\u3068\u3001N\u500b\u306e\u30a2\u30af\u30c6\u30a3\u30d6\u3067\u306a\u3044\u63a5\u7d9a\u30b9\u30ec\u30c3\u30c9\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3067\u304d\u308b\u3002 # \u95a2\u9023\u4ed8\u3051\u3089\u308c\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u63a5\u7d9a\u304c\u7d42\u4e86\u3059\u308b\u3068\u3001\u63a5\u7d9a\u30b9\u30ec\u30c3\u30c9\u306f\u30a2\u30af\u30c6\u30a3\u30d6\u3067\u306a\u304f\u306a\u308b\u3002 back_log=50 # MySQL \u3067\u4fdd\u6301\u3067\u304d\u308b\u672a\u51e6\u7406\u306e\u63a5\u7d9a\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u6570\u3002 table_open_cache=19200 # \u3059\u3079\u3066\u306e\u30b9\u30ec\u30c3\u30c9\u306b\u3064\u3044\u3066\u958b\u3044\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u306e\u6570\u3002 table_definition_cache=16000 # \u5b9a\u7fa9\u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u683c\u7d0d\u53ef\u80fd\u306a (.frm \u30d5\u30a1\u30a4\u30eb\u304b\u3089\u306e) \u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\u306e\u6570\u3002 delayed_insert_timeout=60 # \u7d42\u4e86\u3059\u308b\u524d\u306b\u3001INSERT DELAYED \u30cf\u30f3\u30c9\u30e9\u30b9\u30ec\u30c3\u30c9\u304c INSERT \u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u3092\u5f85\u6a5f\u3059\u308b\u79d2\u6570\u3002 interactive_timeout=300 # \u30b5\u30fc\u30d0\u30fc\u304c\u5bfe\u8a71\u578b\u306e\u63a5\u7d9a\u3067\u3001\u5bfe\u8a71\u578b\u306e\u63a5\u7d9a\u3092\u9589\u3058\u308b\u524d\u306b\u30a2\u30af\u30c6\u30a3\u30d3\u30c6\u30a3\u30fc\u3092\u5f85\u6a5f\u3059\u308b\u79d2\u6570\u3002 wait_timeout=300 # \u975e\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u306a\u63a5\u7d9a\u3092\u9589\u3058\u308b\u524d\u306b\u3001\u30b5\u30fc\u30d0\u30fc\u304c\u305d\u306e\u63a5\u7d9a\u4e0a\u3067\u30a2\u30af\u30c6\u30a3\u30d3\u30c6\u30a3\u30fc\u3092\u5f85\u6a5f\u3059\u308b\u79d2\u6570\u3002 tmp_table_size=256M # \u5185\u90e8\u30a4\u30f3\u30e1\u30e2\u30ea\u30fc\u306e\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306e\u6700\u5927\u30b5\u30a4\u30ba\u3002 max_heap_table_size=256M # \u30e6\u30fc\u30b6\u30fc\u304c\u4f5c\u6210\u3057\u305f MEMORY \u30c6\u30fc\u30d6\u30eb\u306e\u5897\u52a0\u304c\u8a31\u53ef\u3055\u308c\u308b\u6700\u5927\u30b5\u30a4\u30ba\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002 # character-set-server=utf8 collation-server=utf8_general_ci #innodb options innodb_thread_concurrency=32 # InnoDB \u306f\u3001\u3053\u306e\u5909\u6570\u3067\u6307\u5b9a\u3055\u308c\u305f\u5236\u9650\u4ee5\u4e0b\u306e\u6570\u306e\u30aa\u30da\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u30b7\u30b9\u30c6\u30e0\u30b9\u30ec\u30c3\u30c9\u3092\u540c\u6642\u306b InnoDB \u5185\u90e8\u306b\u4fdd\u6301\u3057\u3088\u3046\u3068\u8a66\u307f\u307e\u3059 # \u30b9\u30ec\u30c3\u30c9\u6570\u304c\u3053\u306e\u5236\u9650\u306b\u9054\u3059\u308b\u3068\u3001\u305d\u308c\u4ee5\u964d\u306e\u30b9\u30ec\u30c3\u30c9\u306f\u5b9f\u884c\u3055\u308c\u308b\u307e\u3067, # \u300c\u5148\u5165\u308c\u5148\u51fa\u3057\u300d (FIFO) \u30ad\u30e5\u30fc\u5185\u3067\u5f85\u6a5f\u72b6\u614b\u306b\u306a\u308a\u307e\u3059\u3002\u30ed\u30c3\u30af\u3092\u5f85\u6a5f\u3057\u3066\u3044\u308b\u30b9\u30ec\u30c3\u30c9\u306f\u3001\u4e26\u5217\u5b9f\u884c\u4e2d\u306e\u30b9\u30ec\u30c3\u30c9\u306e\u6570\u306b\u30ab\u30a6\u30f3\u30c8\u3055\u308c\u307e\u305b\u3093\u3002 innodb_buffer_pool_size=48G # \u5168\u4f53\u30e1\u30e2\u30ea\u306e50%\u301c60%\u306b\u8a2d\u5b9a\u3059\u308b\u30028\u306e\u500d\u6570\u3002 innodb_buffer_pool_dump_pct=100 innodb_buffer_pool_dump_at_shutdown=1 innodb_buffer_pool_load_at_startup=0 # http://tech.gmo-media.jp/post/128523146249/innodb-buffer-pool-load-at-startup innodb_log_file_size=2G innodb_log_files_in_group=2 # \u30ed\u30b0\u30b0\u30eb\u30fc\u30d7\u5185\u306e\u5404\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30a4\u30ba\u3067\u3059\u3002\u901a\u5e38\u306finnodb_buffer_pool_size\u306e25\uff05\u304c\u826f\u3044\u3068\u8a00\u308f\u308c\u3066\u307e\u3059\u304c\u3001 # 12G\u306eib_logfile\u304c\u751f\u6210\u3055\u308c\u3001\u30af\u30e9\u30c3\u30b7\u30e5\u30ea\u30ab\u30d0\u30ea\u6642\u306e\u901f\u5ea6\u304c\u9045\u304f\u306a\u308b\u305f\u3081\u30014G\u306b\u3057\u307e\u3057\u305f\u3002 # \u3082\u3057\u3001SSD\u3067\u306f\u306a\u304f\u3001NVME\u3067\u3042\u308c\u3070\u3001\u9069\u5f53\u306a\u5024\u306b\u5909\u66f4\u3059\u308b\u3079\u304d\u3060\u308d\u3046\u3002 innodb_log_buffer_size=4M # \u30c7\u30a3\u30b9\u30af\u4e0a\u306e\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u3080\u969b\u306b InnoDB \u3067\u4f7f\u7528\u3055\u308c\u308b\u30d0\u30c3\u30d5\u30a1\u30fc\u306e\u30b5\u30a4\u30ba\u3067\u3059\u3002 # \u30ed\u30b0\u30d0\u30c3\u30d5\u30a1\u30fc\u3092\u5927\u304d\u304f\u3059\u308b\u3068\u3001\u30c7\u30a3\u30b9\u30af I/O \u3092\u7bc0\u7d04\u3067\u304d\u307e\u3059\u304c\u3001\u969c\u5bb3\u6642\u30ed\u30fc\u30b9\u3059\u308b\u30c7\u30fc\u30bf\u3082\u591a\u3044\u3001 # \u63a8\u5968\u306f1\u301c8M\u3067\u3059\u3002 innodb_file_per_table # \u65b0\u305f\u306b\u4f5c\u6210\u3055\u308c\u305f\u5404\u30c6\u30fc\u30d6\u30eb\u306e\u30c7\u30fc\u30bf\u304a\u3088\u3073\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u30b9\u30da\u30fc\u30b9\u3067\u306f\u306a\u304f, # \u500b\u5225\u306e .ibd \u30d5\u30a1\u30a4\u30eb\u306b\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\u3053\u308c\u3089\u306e InnoDB \u30c6\u30fc\u30d6\u30eb\u7528\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u306f\u3001\u30c6\u30fc\u30d6\u30eb\u304c\u524a\u9664\u3055\u308c\u305f\u308a\u3001 # \u5207\u308a\u6368\u3066\u3089\u308c\u305f\u308a\u3059\u308b\u3068\u518d\u5229\u7528\u3055\u308c\u307e\u3059\u30025.6.6 \u4ee5\u4e0a\u306f\u30c7\u30d5\u30a9\u30eb\u30c8ON\u3067\u3059\u3002 innodb_open_files=9600 # \u3053\u306e\u5909\u6570\u306f\u3001\u8907\u6570\u306e InnoDB \u30c6\u30fc\u30d6\u30eb\u30b9\u30da\u30fc\u30b9\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306b\u306e\u307f\u95a2\u9023\u3057\u307e\u3059\u3002 # MySQL \u3067\u4e00\u5ea6\u306b\u958b\u3044\u305f\u307e\u307e\u306b\u3067\u304d\u308b .ibd \u30d5\u30a1\u30a4\u30eb\u306e\u6700\u5927\u6570\u304c\u6307\u5b9a\u3055\u308c\u307e\u3059\u3002 innodb_flush_method=O_DIRECT # InnoDB \u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304a\u3088\u3073\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306b\u30c7\u30fc\u30bf\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3059\u308b\u969b\u306b\u4f7f\u7528\u3055\u308c\u308b\u65b9\u6cd5\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002 # \u3053\u308c\u306b\u3088\u308a\u3001I/O \u30b9\u30eb\u30fc\u30d7\u30c3\u30c8\u304c\u5f71\u97ff\u3092\u53d7\u3051\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u5909\u6570\u306f\u3001Unix \u304a\u3088\u3073 Linux \u30b7\u30b9\u30c6\u30e0\u3067\u306e\u307f\u69cb\u6210\u53ef\u80fd\u3067\u3059\u3002 # Windows \u30b7\u30b9\u30c6\u30e0\u3067\u306f\u3001\u30d5\u30e9\u30c3\u30b7\u30e5\u65b9\u6cd5\u306f\u5e38\u306b async_unbuffered \u3067\u3042\u308a\u3001\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002 # - fsync: InnoDB \u306f fsync() \u30b7\u30b9\u30c6\u30e0\u30b3\u30fc\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3001\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3068\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u4e21\u65b9\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u307e\u3059\u3002fsync \u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067\u3059\u3002 # # - O_DSYNC: InnoDB \u306f\u3001O_SYNC \u3092\u4f7f\u7528\u3057\u3066\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u3001fsync() \u3092\u4f7f\u7528\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u307e\u3059\u3002\u3055\u307e\u3056\u307e\u306a\u7a2e\u985e\u306e Unix \u3067\u554f\u984c\u304c\u767a\u751f\u3057\u3066\u3044\u308b\u305f\u3081\u3001InnoDB \u3067\u306f\u76f4\u63a5 O_DSYNC \u304c\u4f7f\u7528\u3055\u308c\u307e\u305b\u3093\u3002 # # - O_DIRECT: InnoDB \u306f\u3001O_DIRECT (Solaris \u3067\u306f directio()) \u3092\u4f7f\u7528\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001fsync() \u3092\u4f7f\u7528\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3068\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u4e21\u65b9\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u307e\u3059\u3002\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u3001\u4e00\u90e8\u306e GNU/Linux \u30d0\u30fc\u30b8\u30e7\u30f3\u3001FreeBSD\u3001\u304a\u3088\u3073 Solaris \u3067\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002 # # - O_DIRECT_NO_FSYNC: InnoDB \u306f\u3001I/O \u306e\u30d5\u30e9\u30c3\u30b7\u30e5\u6642\u306b O_DIRECT \u3092\u4f7f\u7528\u3057\u307e\u3059\u304c\u3001\u5f8c\u7d9a\u306e fsync() \u30b7\u30b9\u30c6\u30e0\u30b3\u30fc\u30eb\u306f\u30b9\u30ad\u30c3\u30d7\u3057\u307e\u3059\u3002\u3053\u306e\u8a2d\u5b9a\u306f\u3001\u4e00\u90e8\u306e\u30bf\u30a4\u30d7\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306b\u306f\u9069\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u305d\u306e\u4ed6\u306b\u306f\u9069\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u305f\u3068\u3048\u3070\u3001XFS \u306b\u306f\u9069\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u305f\u3068\u3048\u3070\u3001\u4f7f\u7528\u4e2d\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3067\u3059\u3079\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u30e1\u30bf\u30c7\u30fc\u30bf\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u3001fsync() \u304c\u5fc5\u8981\u3067\u3042\u308b\u306e\u304b\u3069\u3046\u304b\u304c\u4e0d\u660e\u306a\u5834\u5408\u306f\u3001\u4ee3\u308f\u308a\u306b O_DIRECT \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f MySQL 5.6.7 (Bug #11754304\u3001Bug #45892) \u3067\u5c0e\u5165\u3055\u308c\u307e\u3057\u305f\u3002 default_password_lifetime=0 # \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u6709\u52b9\u671f\u9650\u3001\u30ec\u30f3\u30b5\u30d0\u3068\u9023\u643a\u3057\u3066\u3044\u308b\u305f\u3081\u3001OFF\u306b\u3057\u307e\u3057\u305f\u3002 #enforce-gtid-consistency=1 #gtid-mode=ON #safe-user-create=1 #explicit_defaults_for_timestamp=1 log_timestamps=SYSTEM # \u30ed\u30b0\u306b\u51fa\u529b\u3055\u308c\u308b\u6642\u523b\u5909\u6570\u3067\u3059\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306fUTC\u3067\u3059\u304c\u3001\u8aad\u307f\u306b\u304f\u3044\u305f\u3081\u3001SYSTEM\u306b\u5909\u66f4\u3057\u307e\u3057\u305f\u3002 disable-partition-engine-check=1 # https://yoku0825.blogspot.jp/2017/04/mysql-5717-deprecated-partition-engine.html # MySQL8 \u306e\u904e\u6e21\u671f\u306b\u3042\u305f\u308bMySQL 5.7\u306b\u8ffd\u52a0\u3055\u308c\u305f\u3082\u306e\u3067\u3059\u3001\u4eca\u5f8cMySQL8\u30ea\u30ea\u30fc\u30b9\u3057\u305f\u5834\u5408\u3001 # \u30e6\u30fc\u30b6\u304cDB\u79fb\u8a2d\u3059\u308b\u6642\u7d04\u7acb\u3064\u3060\u308d\u3046\uff08\u3068\u601d\u3046\uff09\u3001\u3057\u304b\u3057\u3001\u6bce\u56deMySQL\u8d77\u52d5\u6642\u306btable\u3068\u30c1\u30a7\u30c3\u30af\u3059\u308b\u305f\u3081\u3001 # \u6642\u9593\u304b\u304b\u308b\u305f\u3081\u3001disable\u3057\u307e\u3057\u305f\u3002 show_compatibility_56=on # https://yakst.com/ja/posts/2733 innodb_buffer_pool_instances=8 # InnoDB \u306e\u30d0\u30c3\u30d5\u30a1\u30fc\u30d7\u30fc\u30eb\u304c\u5206\u5272\u3055\u308c\u308b\u9818\u57df\u306e\u6570\u3067\u3059\u3002CPU\u30b3\u30a2\u6570\u306b\u5408\u308f\u305b\u308b\u3002 innodb_rollback_segments=32 # \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5185\u3067 InnoDB \u304c\u4f7f\u7528\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u30b9\u30da\u30fc\u30b9\u306b\u3042\u308b\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u6570\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002 innodb_write_io_threads=16 innodb_read_io_threads=16 innodb_io_capacity=2000 innodb_io_capacity_max=5000 # MySQL\u30b5\u30fc\u30d0\u306fSSD\u306e\u305f\u3081\u3001io_capacity\u30922000\u301c5000\u306b\u8a2d\u5b9a\u3059\u308b\u3002 innodb_max_dirty_pages_pct=40 # InnoDB \u306f\u3001\u30c0\u30fc\u30c6\u30a3\u30fc\u30da\u30fc\u30b8\u306e\u5272\u5408\u304c\u3053\u306e\u5024\u3092\u8d85\u3048\u306a\u3044\u3088\u3046\u306b\u3001\u30d0\u30c3\u30d5\u30a1\u30fc\u30d7\u30fc\u30eb\u304b\u3089\u30c7\u30fc\u30bf\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u3088\u3046\u3068\u8a66\u307f\u307e\u3059\u3002 innodb_flush_log_at_trx_commit=2 \u73b0\u5728\u7684\u8bbe\u7f6e \u00b6 \u751f\u4ea7\u73af\u5883 \u00b6 [mysql] default-character-set=utf8mb4 socket=/tmp/mysql.sock [mysqld] server_id=1 user=mysql datadir=/home/mysql socket=/tmp/mysql.sock tmpdir=/home/tmp bind-address=0.0.0.0 # log log_bin=mysql-bin binlog_error_action=IGNORE_ERROR expire_logs_days=2 slow_query_log=1 long_query_time=10 slow_query_log_file=/var/log/mysql/slow_query.log log_error=/var/log/mysql/error.log log_output=FILE # server sql_mode=\"ONLY_FULL_GROUP_BY,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\" default_storage_engine=INNODB skip-partition skip-name-resolve skip-ssl skip-symbolic-links max_connections=600 max_connect_errors=300 max_allowed_packet=16M connect_timeout=30 max_user_connections=30 table_open_cache=19200 interactive_timeout=300 wait_timeout=300 tmp_table_size=256M max_heap_table_size=256M default_password_lifetime=0 explicit_defaults_for_timestamp=1 log_timestamps=SYSTEM disable_partition_engine_check=1 character-set-server=utf8mb4 collation-server=utf8mb4_general_ci # buffer sort_buffer_size=1M read_buffer_size=1M read_rnd_buffer_size=1M # MyISAM myisam_sort_buffer_size=128M key_buffer_size=512M # InnoDB innodb_strict_mode=1 innodb_file_per_table innodb_temp_data_file_path=ibtmp1:12M:autoextend:max:10G innodb_buffer_pool_size=56G innodb_buffer_pool_dump_pct=100 innodb_buffer_pool_dump_at_shutdown=1 innodb_buffer_pool_load_at_startup=0 innodb_log_file_size=512M innodb_write_io_threads=16 innodb_read_io_threads=16 innodb_io_capacity=2000 innodb_io_capacity_max=5000 innodb_flush_log_at_trx_commit=2 innodb_flush_method=O_DIRECT innodb_flush_neighbors=0 innodb_read_ahead_threshold=0","title":"Mysql\u53c2\u6570\u4f18\u5316"},{"location":"mysql/#mysql","text":"\u5bf9\u4e8e\u4e0d\u540c\u7684\u7f51\u7ad9\uff0c\u53ca\u5176\u5728\u7ebf\u91cf\uff0c\u8bbf\u95ee\u91cf\uff0c\u5e16\u5b50\u6570\u91cf\uff0c\u7f51\u7edc\u60c5\u51b5\uff0c\u4ee5\u53ca\u673a\u5668\u786c\u4ef6\u914d\u7f6e\u90fd\u6709\u5173\u7cfb\uff0c\u4f18\u5316\u4e0d\u53ef\u80fd\u4e00\u6b21\u6027\u5b8c\u6210\uff0c\u9700\u8981\u4e0d\u65ad\u7684\u89c2\u5bdf\u4ee5\u53ca\u8c03\u8bd5\uff0c\u624d\u6709\u53ef\u80fd\u5f97\u5230\u6700\u4f73\u6548\u679c\u3002 [client] port = 3306 socket = /tmp/mysql.sock [mysqld] port = 3306 socket = /tmp/mysql.sock basedir = /usr/local/mysql datadir = /data/mysql pid-file = /data/mysql/mysql.pid user = mysql bind-address = 0.0.0.0 server-id = 1 #\u8868\u793a\u662f\u672c\u673a\u7684\u5e8f\u53f7\u4e3a1,\u4e00\u822c\u6765\u8bb2\u5c31\u662fmaster\u7684\u610f\u601d skip-name-resolve # \u7981\u6b62MySQL\u5bf9\u5916\u90e8\u8fde\u63a5\u8fdb\u884cDNS\u89e3\u6790\uff0c\u4f7f\u7528\u8fd9\u4e00\u9009\u9879\u53ef\u4ee5\u6d88\u9664MySQL\u8fdb\u884cDNS\u89e3\u6790\u7684\u65f6\u95f4\u3002\u4f46\u9700\u8981\u6ce8\u610f\uff0c\u5982\u679c\u5f00\u542f\u8be5\u9009\u9879\uff0c # \u5219\u6240\u6709\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u6388\u6743\u90fd\u8981\u4f7f\u7528IP\u5730\u5740\u65b9\u5f0f\uff0c\u5426\u5219MySQL\u5c06\u65e0\u6cd5\u6b63\u5e38\u5904\u7406\u8fde\u63a5\u8bf7\u6c42 #skip-networking back_log = 600 # MySQL\u80fd\u6709\u7684\u8fde\u63a5\u6570\u91cf\u3002\u5f53\u4e3b\u8981MySQL\u7ebf\u7a0b\u5728\u4e00\u4e2a\u5f88\u77ed\u65f6\u95f4\u5185\u5f97\u5230\u975e\u5e38\u591a\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u8fd9\u5c31\u8d77\u4f5c\u7528\uff0c # \u7136\u540e\u4e3b\u7ebf\u7a0b\u82b1\u4e9b\u65f6\u95f4(\u5c3d\u7ba1\u5f88\u77ed)\u68c0\u67e5\u8fde\u63a5\u5e76\u4e14\u542f\u52a8\u4e00\u4e2a\u65b0\u7ebf\u7a0b\u3002back_log\u503c\u6307\u51fa\u5728MySQL\u6682\u65f6\u505c\u6b62\u56de\u7b54\u65b0\u8bf7\u6c42\u4e4b\u524d\u7684\u77ed\u65f6\u95f4\u5185\u591a\u5c11\u4e2a\u8bf7\u6c42\u53ef\u4ee5\u88ab\u5b58\u5728\u5806\u6808\u4e2d\u3002 # \u5982\u679c\u671f\u671b\u5728\u4e00\u4e2a\u77ed\u65f6\u95f4\u5185\u6709\u5f88\u591a\u8fde\u63a5\uff0c\u4f60\u9700\u8981\u589e\u52a0\u5b83\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679cMySQL\u7684\u8fde\u63a5\u6570\u636e\u8fbe\u5230max_connections\u65f6\uff0c\u65b0\u6765\u7684\u8bf7\u6c42\u5c06\u4f1a\u88ab\u5b58\u5728\u5806\u6808\u4e2d\uff0c # \u4ee5\u7b49\u5f85\u67d0\u4e00\u8fde\u63a5\u91ca\u653e\u8d44\u6e90\uff0c\u8be5\u5806\u6808\u7684\u6570\u91cf\u5373back_log\uff0c\u5982\u679c\u7b49\u5f85\u8fde\u63a5\u7684\u6570\u91cf\u8d85\u8fc7back_log\uff0c\u5c06\u4e0d\u88ab\u6388\u4e88\u8fde\u63a5\u8d44\u6e90\u3002 # \u53e6\u5916\uff0c\u8fd9\u503c\uff08back_log\uff09\u9650\u4e8e\u60a8\u7684\u64cd\u4f5c\u7cfb\u7edf\u5bf9\u5230\u6765\u7684TCP/IP\u8fde\u63a5\u7684\u4fa6\u542c\u961f\u5217\u7684\u5927\u5c0f\u3002 # \u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u5728\u8fd9\u4e2a\u961f\u5217\u5927\u5c0f\u4e0a\u6709\u5b83\u81ea\u5df1\u7684\u9650\u5236\uff08\u53ef\u4ee5\u68c0\u67e5\u4f60\u7684OS\u6587\u6863\u627e\u51fa\u8fd9\u4e2a\u53d8\u91cf\u7684\u6700\u5927\u503c\uff09\uff0c\u8bd5\u56fe\u8bbe\u5b9aback_log\u9ad8\u4e8e\u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u7684\u9650\u5236\u5c06\u662f\u65e0\u6548\u7684\u3002 max_connections = 1000 # MySQL\u7684\u6700\u5927\u8fde\u63a5\u6570\uff0c\u5982\u679c\u670d\u52a1\u5668\u7684\u5e76\u53d1\u8fde\u63a5\u8bf7\u6c42\u91cf\u6bd4\u8f83\u5927\uff0c\u5efa\u8bae\u8c03\u9ad8\u6b64\u503c\uff0c\u4ee5\u589e\u52a0\u5e76\u884c\u8fde\u63a5\u6570\u91cf\uff0c # \u5f53\u7136\u8fd9\u5efa\u7acb\u5728\u673a\u5668\u80fd\u652f\u6491\u7684\u60c5\u51b5\u4e0b\uff0c\u56e0\u4e3a\u5982\u679c\u8fde\u63a5\u6570\u8d8a\u591a\uff0c\u4ecb\u4e8eMySQL\u4f1a\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u63d0\u4f9b\u8fde\u63a5\u7f13\u51b2\u533a\uff0c # \u5c31\u4f1a\u5f00\u9500\u8d8a\u591a\u7684\u5185\u5b58\uff0c\u6240\u4ee5\u8981\u9002\u5f53\u8c03\u6574\u8be5\u503c\uff0c\u4e0d\u80fd\u76f2\u76ee\u63d0\u9ad8\u8bbe\u503c\u3002\u53ef\u4ee5\u8fc7'conn%'\u901a\u914d\u7b26\u67e5\u770b\u5f53\u524d\u72b6\u6001\u7684\u8fde\u63a5\u6570\u91cf\uff0c\u4ee5\u5b9a\u593a\u8be5\u503c\u7684\u5927\u5c0f\u3002 max_connect_errors = 6000 # \u5bf9\u4e8e\u540c\u4e00\u4e3b\u673a\uff0c\u5982\u679c\u6709\u8d85\u51fa\u8be5\u53c2\u6570\u503c\u4e2a\u6570\u7684\u4e2d\u65ad\u9519\u8bef\u8fde\u63a5\uff0c\u5219\u8be5\u4e3b\u673a\u5c06\u88ab\u7981\u6b62\u8fde\u63a5\u3002\u5982\u9700\u5bf9\u8be5\u4e3b\u673a\u8fdb\u884c\u89e3\u7981\uff0c\u6267\u884c\uff1aFLUSH HOST\u3002 open_files_limit = 65535 # MySQL\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u9650\u5236\uff0c\u9ed8\u8ba4\u6700\u5c0f1024;\u5f53open_files_limit\u6ca1\u6709\u88ab\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u6bd4\u8f83max_connections*5\u548culimit -n\u7684\u503c\uff0c\u54ea\u4e2a\u5927\u7528\u54ea\u4e2a\uff0c # \u5f53open_file_limit\u88ab\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u6bd4\u8f83open_files_limit\u548cmax_connections*5\u7684\u503c\uff0c\u54ea\u4e2a\u5927\u7528\u54ea\u4e2a\u3002 table_open_cache = 128 # MySQL\u6bcf\u6253\u5f00\u4e00\u4e2a\u8868\uff0c\u90fd\u4f1a\u8bfb\u5165\u4e00\u4e9b\u6570\u636e\u5230table_open_cache\u7f13\u5b58\u4e2d\uff0c\u5f53MySQL\u5728\u8fd9\u4e2a\u7f13\u5b58\u4e2d\u627e\u4e0d\u5230\u76f8\u5e94\u4fe1\u606f\u65f6\uff0c\u624d\u4f1a\u53bb\u78c1\u76d8\u4e0a\u8bfb\u53d6\u3002\u9ed8\u8ba4\u503c64 # \u5047\u5b9a\u7cfb\u7edf\u6709200\u4e2a\u5e76\u53d1\u8fde\u63a5\uff0c\u5219\u9700\u5c06\u6b64\u53c2\u6570\u8bbe\u7f6e\u4e3a200*N(N\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u6240\u9700\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u76ee)\uff1b # \u5f53\u628atable_open_cache\u8bbe\u7f6e\u4e3a\u5f88\u5927\u65f6\uff0c\u5982\u679c\u7cfb\u7edf\u5904\u7406\u4e0d\u4e86\u90a3\u4e48\u591a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u90a3\u4e48\u5c31\u4f1a\u51fa\u73b0\u5ba2\u6237\u7aef\u5931\u6548\uff0c\u8fde\u63a5\u4e0d\u4e0a max_allowed_packet = 4M # \u63a5\u53d7\u7684\u6570\u636e\u5305\u5927\u5c0f\uff1b\u589e\u52a0\u8be5\u53d8\u91cf\u7684\u503c\u5341\u5206\u5b89\u5168\uff0c\u8fd9\u662f\u56e0\u4e3a\u4ec5\u5f53\u9700\u8981\u65f6\u624d\u4f1a\u5206\u914d\u989d\u5916\u5185\u5b58\u3002 # \u4f8b\u5982\uff0c\u4ec5\u5f53\u4f60\u53d1\u51fa\u957f\u67e5\u8be2\u6216MySQLd\u5fc5\u987b\u8fd4\u56de\u5927\u7684\u7ed3\u679c\u884c\u65f6MySQLd\u624d\u4f1a\u5206\u914d\u66f4\u591a\u5185\u5b58\u3002 # \u8be5\u53d8\u91cf\u4e4b\u6240\u4ee5\u53d6\u8f83\u5c0f\u9ed8\u8ba4\u503c\u662f\u4e00\u79cd\u9884\u9632\u63aa\u65bd\uff0c\u4ee5\u6355\u83b7\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u9519\u8bef\u4fe1\u606f\u5305\uff0c\u5e76\u786e\u4fdd\u4e0d\u4f1a\u56e0\u5076\u7136\u4f7f\u7528\u5927\u7684\u4fe1\u606f\u5305\u800c\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\u3002 binlog_cache_size = 1M # \u4e00\u4e2a\u4e8b\u52a1\uff0c\u5728\u6ca1\u6709\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u4ea7\u751f\u7684\u65e5\u5fd7\uff0c\u8bb0\u5f55\u5230Cache\u4e2d\uff1b\u7b49\u5230\u4e8b\u52a1\u63d0\u4ea4\u9700\u8981\u63d0\u4ea4\u7684\u65f6\u5019\uff0c\u5219\u628a\u65e5\u5fd7\u6301\u4e45\u5316\u5230\u78c1\u76d8\u3002\u9ed8\u8ba4binlog_cache_size\u5927\u5c0f32K max_heap_table_size = 8M # \u5b9a\u4e49\u4e86\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u7684\u5185\u5b58\u8868(memory table)\u7684\u5927\u5c0f\u3002\u8fd9\u4e2a\u503c\u7528\u6765\u8ba1\u7b97\u5185\u5b58\u8868\u7684\u6700\u5927\u884c\u6570\u503c\u3002\u8fd9\u4e2a\u53d8\u91cf\u652f\u6301\u52a8\u6001\u6539\u53d8 tmp_table_size = 16M # MySQL\u7684heap\uff08\u5806\u79ef\uff09\u8868\u7f13\u51b2\u5927\u5c0f\u3002\u6240\u6709\u8054\u5408\u5728\u4e00\u4e2aDML\u6307\u4ee4\u5185\u5b8c\u6210\uff0c\u5e76\u4e14\u5927\u591a\u6570\u8054\u5408\u751a\u81f3\u53ef\u4ee5\u4e0d\u7528\u4e34\u65f6\u8868\u5373\u53ef\u4ee5\u5b8c\u6210\u3002 # \u5927\u591a\u6570\u4e34\u65f6\u8868\u662f\u57fa\u4e8e\u5185\u5b58\u7684(HEAP)\u8868\u3002\u5177\u6709\u5927\u7684\u8bb0\u5f55\u957f\u5ea6\u7684\u4e34\u65f6\u8868 (\u6240\u6709\u5217\u7684\u957f\u5ea6\u7684\u548c)\u6216\u5305\u542bBLOB\u5217\u7684\u8868\u5b58\u50a8\u5728\u786c\u76d8\u4e0a\u3002 # \u5982\u679c\u67d0\u4e2a\u5185\u90e8heap\uff08\u5806\u79ef\uff09\u8868\u5927\u5c0f\u8d85\u8fc7tmp_table_size\uff0cMySQL\u53ef\u4ee5\u6839\u636e\u9700\u8981\u81ea\u52a8\u5c06\u5185\u5b58\u4e2d\u7684heap\u8868\u6539\u4e3a\u57fa\u4e8e\u786c\u76d8\u7684MyISAM\u8868\u3002 # \u8fd8\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6etmp_table_size\u9009\u9879\u6765\u589e\u52a0\u4e34\u65f6\u8868\u7684\u5927\u5c0f\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u8c03\u9ad8\u8be5\u503c\uff0cMySQL\u540c\u65f6\u5c06\u589e\u52a0heap\u8868\u7684\u5927\u5c0f\uff0c\u53ef\u8fbe\u5230\u63d0\u9ad8\u8054\u63a5\u67e5\u8be2\u901f\u5ea6\u7684\u6548\u679c read_buffer_size = 2M # MySQL\u8bfb\u5165\u7f13\u51b2\u533a\u5927\u5c0f\u3002\u5bf9\u8868\u8fdb\u884c\u987a\u5e8f\u626b\u63cf\u7684\u8bf7\u6c42\u5c06\u5206\u914d\u4e00\u4e2a\u8bfb\u5165\u7f13\u51b2\u533a\uff0cMySQL\u4f1a\u4e3a\u5b83\u5206\u914d\u4e00\u6bb5\u5185\u5b58\u7f13\u51b2\u533a\u3002 # read_buffer_size\u53d8\u91cf\u63a7\u5236\u8fd9\u4e00\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u3002 # \u5982\u679c\u5bf9\u8868\u7684\u987a\u5e8f\u626b\u63cf\u8bf7\u6c42\u975e\u5e38\u9891\u7e41\uff0c\u5e76\u4e14\u4f60\u8ba4\u4e3a\u9891\u7e41\u626b\u63cf\u8fdb\u884c\u5f97\u592a\u6162\uff0c\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u8be5\u53d8\u91cf\u503c\u4ee5\u53ca\u5185\u5b58\u7f13\u51b2\u533a\u5927\u5c0f\u63d0\u9ad8\u5176\u6027\u80fd read_rnd_buffer_size = 8M # MySQL\u7684\u968f\u673a\u8bfb\u7f13\u51b2\u533a\u5927\u5c0f\u3002\u5f53\u6309\u4efb\u610f\u987a\u5e8f\u8bfb\u53d6\u884c\u65f6(\u4f8b\u5982\uff0c\u6309\u7167\u6392\u5e8f\u987a\u5e8f)\uff0c\u5c06\u5206\u914d\u4e00\u4e2a\u968f\u673a\u8bfb\u7f13\u5b58\u533a\u3002\u8fdb\u884c\u6392\u5e8f\u67e5\u8be2\u65f6\uff0c # MySQL\u4f1a\u9996\u5148\u626b\u63cf\u4e00\u904d\u8be5\u7f13\u51b2\uff0c\u4ee5\u907f\u514d\u78c1\u76d8\u641c\u7d22\uff0c\u63d0\u9ad8\u67e5\u8be2\u901f\u5ea6\uff0c\u5982\u679c\u9700\u8981\u6392\u5e8f\u5927\u91cf\u6570\u636e\uff0c # \u53ef\u9002\u5f53\u8c03\u9ad8\u8be5\u503c\u3002\u4f46MySQL\u4f1a\u4e3a\u6bcf\u4e2a\u5ba2\u6237\u8fde\u63a5\u53d1\u653e\u8be5\u7f13\u51b2\u7a7a\u95f4\uff0c\u6240\u4ee5\u5e94\u5c3d\u91cf\u9002\u5f53\u8bbe\u7f6e\u8be5\u503c\uff0c\u4ee5\u907f\u514d\u5185\u5b58\u5f00\u9500\u8fc7\u5927 sort_buffer_size = 8M # MySQL\u6267\u884c\u6392\u5e8f\u4f7f\u7528\u7684\u7f13\u51b2\u5927\u5c0f\u3002\u5982\u679c\u60f3\u8981\u589e\u52a0ORDER BY\u7684\u901f\u5ea6\uff0c\u9996\u5148\u770b\u662f\u5426\u53ef\u4ee5\u8ba9MySQL\u4f7f\u7528\u7d22\u5f15\u800c\u4e0d\u662f\u989d\u5916\u7684\u6392\u5e8f\u9636\u6bb5\u3002 # \u5982\u679c\u4e0d\u80fd\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u589e\u52a0sort_buffer_size\u53d8\u91cf\u7684\u5927\u5c0f join_buffer_size = 8M # \u8054\u5408\u67e5\u8be2\u64cd\u4f5c\u6240\u80fd\u4f7f\u7528\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u548csort_buffer_size\u4e00\u6837\uff0c\u8be5\u53c2\u6570\u5bf9\u5e94\u7684\u5206\u914d\u5185\u5b58\u4e5f\u662f\u6bcf\u8fde\u63a5\u72ec\u4eab thread_cache_size = 8 # \u8fd9\u4e2a\u503c\uff08\u9ed8\u8ba48\uff09\u8868\u793a\u53ef\u4ee5\u91cd\u65b0\u5229\u7528\u4fdd\u5b58\u5728\u7f13\u5b58\u4e2d\u7ebf\u7a0b\u7684\u6570\u91cf\uff0c\u5f53\u65ad\u5f00\u8fde\u63a5\u65f6\u5982\u679c\u7f13\u5b58\u4e2d\u8fd8\u6709\u7a7a\u95f4\uff0c\u90a3\u4e48\u5ba2\u6237\u7aef\u7684\u7ebf\u7a0b\u5c06\u88ab\u653e\u5230\u7f13\u5b58\u4e2d\uff0c # \u5982\u679c\u7ebf\u7a0b\u91cd\u65b0\u88ab\u8bf7\u6c42\uff0c\u90a3\u4e48\u8bf7\u6c42\u5c06\u4ece\u7f13\u5b58\u4e2d\u8bfb\u53d6,\u5982\u679c\u7f13\u5b58\u4e2d\u662f\u7a7a\u7684\u6216\u8005\u662f\u65b0\u7684\u8bf7\u6c42\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7ebf\u7a0b\u5c06\u88ab\u91cd\u65b0\u521b\u5efa,\u5982\u679c\u6709\u5f88\u591a\u65b0\u7684\u7ebf\u7a0b\uff0c # \u589e\u52a0\u8fd9\u4e2a\u503c\u53ef\u4ee5\u6539\u5584\u7cfb\u7edf\u6027\u80fd.\u901a\u8fc7\u6bd4\u8f83Connections\u548cThreads_created\u72b6\u6001\u7684\u53d8\u91cf\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u53d8\u91cf\u7684\u4f5c\u7528\u3002(\u2013>\u8868\u793a\u8981\u8c03\u6574\u7684\u503c) # \u6839\u636e\u7269\u7406\u5185\u5b58\u8bbe\u7f6e\u89c4\u5219\u5982\u4e0b\uff1a # 1G - > 8 # 2G - > 16 # 3G - > 32 # \u5927\u4e8e3G - > 64 query_cache_size = 8M # MySQL\u7684\u67e5\u8be2\u7f13\u51b2\u5927\u5c0f\uff08\u4ece4.0.1\u5f00\u59cb\uff0cMySQL\u63d0\u4f9b\u4e86\u67e5\u8be2\u7f13\u51b2\u673a\u5236\uff09\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2\uff0cMySQL\u5c06SELECT\u8bed\u53e5\u548c\u67e5\u8be2\u7ed3\u679c\u5b58\u653e\u5728\u7f13\u51b2\u533a\u4e2d\uff0c # \u4eca\u540e\u5bf9\u4e8e\u540c\u6837\u7684SELECT\u8bed\u53e5\uff08\u533a\u5206\u5927\u5c0f\u5199\uff09\uff0c\u5c06\u76f4\u63a5\u4ece\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u7ed3\u679c\u3002\u6839\u636eMySQL\u7528\u6237\u624b\u518c\uff0c\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2\u6700\u591a\u53ef\u4ee5\u8fbe\u5230238%\u7684\u6548\u7387\u3002 # \u901a\u8fc7\u68c0\u67e5\u72b6\u6001\u503c'Qcache_%'\uff0c\u53ef\u4ee5\u77e5\u9053query_cache_size\u8bbe\u7f6e\u662f\u5426\u5408\u7406\uff1a\u5982\u679cQcache_lowmem_prunes\u7684\u503c\u975e\u5e38\u5927\uff0c\u5219\u8868\u660e\u7ecf\u5e38\u51fa\u73b0\u7f13\u51b2\u4e0d\u591f\u7684\u60c5\u51b5\uff0c # \u5982\u679cQcache_hits\u7684\u503c\u4e5f\u975e\u5e38\u5927\uff0c\u5219\u8868\u660e\u67e5\u8be2\u7f13\u51b2\u4f7f\u7528\u975e\u5e38\u9891\u7e41\uff0c\u6b64\u65f6\u9700\u8981\u589e\u52a0\u7f13\u51b2\u5927\u5c0f\uff1b\u5982\u679cQcache_hits\u7684\u503c\u4e0d\u5927\uff0c\u5219\u8868\u660e\u4f60\u7684\u67e5\u8be2\u91cd\u590d\u7387\u5f88\u4f4e\uff0c # \u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2\u53cd\u800c\u4f1a\u5f71\u54cd\u6548\u7387\uff0c\u90a3\u4e48\u53ef\u4ee5\u8003\u8651\u4e0d\u7528\u67e5\u8be2\u7f13\u51b2\u3002\u6b64\u5916\uff0c\u5728SELECT\u8bed\u53e5\u4e2d\u52a0\u5165SQL_NO_CACHE\u53ef\u4ee5\u660e\u786e\u8868\u793a\u4e0d\u4f7f\u7528\u67e5\u8be2\u7f13\u51b2 query_cache_limit = 2M #\u6307\u5b9a\u5355\u4e2a\u67e5\u8be2\u80fd\u591f\u4f7f\u7528\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u9ed8\u8ba41M key_buffer_size = 4M # \u6307\u5b9a\u7528\u4e8e\u7d22\u5f15\u7684\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u589e\u52a0\u5b83\u53ef\u5f97\u5230\u66f4\u597d\u5904\u7406\u7684\u7d22\u5f15(\u5bf9\u6240\u6709\u8bfb\u548c\u591a\u91cd\u5199)\uff0c\u5230\u4f60\u80fd\u8d1f\u62c5\u5f97\u8d77\u90a3\u6837\u591a\u3002\u5982\u679c\u4f60\u4f7f\u5b83\u592a\u5927\uff0c # \u7cfb\u7edf\u5c06\u5f00\u59cb\u6362\u9875\u5e76\u4e14\u771f\u7684\u53d8\u6162\u4e86\u3002\u5bf9\u4e8e\u5185\u5b58\u57284GB\u5de6\u53f3\u7684\u670d\u52a1\u5668\u8be5\u53c2\u6570\u53ef\u8bbe\u7f6e\u4e3a384M\u6216512M\u3002\u901a\u8fc7\u68c0\u67e5\u72b6\u6001\u503cKey_read_requests\u548cKey_reads\uff0c # \u53ef\u4ee5\u77e5\u9053key_buffer_size\u8bbe\u7f6e\u662f\u5426\u5408\u7406\u3002\u6bd4\u4f8bkey_reads/key_read_requests\u5e94\u8be5\u5c3d\u53ef\u80fd\u7684\u4f4e\uff0c # \u81f3\u5c11\u662f1:100\uff0c1:1000\u66f4\u597d(\u4e0a\u8ff0\u72b6\u6001\u503c\u53ef\u4ee5\u4f7f\u7528SHOW STATUS LIKE 'key_read%'\u83b7\u5f97)\u3002\u6ce8\u610f\uff1a\u8be5\u53c2\u6570\u503c\u8bbe\u7f6e\u7684\u8fc7\u5927\u53cd\u800c\u4f1a\u662f\u670d\u52a1\u5668\u6574\u4f53\u6548\u7387\u964d\u4f4e ft_min_word_len = 4 # \u5206\u8bcd\u8bcd\u6c47\u6700\u5c0f\u957f\u5ea6\uff0c\u9ed8\u8ba44 transaction_isolation = REPEATABLE-READ # MySQL\u652f\u63014\u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff0c\u4ed6\u4eec\u5206\u522b\u662f\uff1a # READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE. # \u5982\u6ca1\u6709\u6307\u5b9a\uff0cMySQL\u9ed8\u8ba4\u91c7\u7528\u7684\u662fREPEATABLE-READ\uff0cORACLE\u9ed8\u8ba4\u7684\u662fREAD-COMMITTED log_bin = mysql-bin binlog_format = mixed expire_logs_days = 30 #\u8d85\u8fc730\u5929\u7684binlog\u5220\u9664 log_error = /data/mysql/mysql-error.log #\u9519\u8bef\u65e5\u5fd7\u8def\u5f84 slow_query_log = 1 long_query_time = 1 #\u6162\u67e5\u8be2\u65f6\u95f4 \u8d85\u8fc71\u79d2\u5219\u4e3a\u6162\u67e5\u8be2 slow_query_log_file = /data/mysql/mysql-slow.log performance_schema = 0 explicit_defaults_for_timestamp #lower_case_table_names = 1 #\u4e0d\u533a\u5206\u5927\u5c0f\u5199 skip-external-locking #MySQL\u9009\u9879\u4ee5\u907f\u514d\u5916\u90e8\u9501\u5b9a\u3002\u8be5\u9009\u9879\u9ed8\u8ba4\u5f00\u542f default-storage-engine = InnoDB #\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce innodb_file_per_table = 1 # InnoDB\u4e3a\u72ec\u7acb\u8868\u7a7a\u95f4\u6a21\u5f0f\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u7684\u6bcf\u4e2a\u8868\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a\u6570\u636e\u7a7a\u95f4 # \u72ec\u7acb\u8868\u7a7a\u95f4\u4f18\u70b9\uff1a # 1\uff0e\u6bcf\u4e2a\u8868\u90fd\u6709\u81ea\u5df2\u72ec\u7acb\u7684\u8868\u7a7a\u95f4\u3002 # 2\uff0e\u6bcf\u4e2a\u8868\u7684\u6570\u636e\u548c\u7d22\u5f15\u90fd\u4f1a\u5b58\u5728\u81ea\u5df2\u7684\u8868\u7a7a\u95f4\u4e2d\u3002 # 3\uff0e\u53ef\u4ee5\u5b9e\u73b0\u5355\u8868\u5728\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4e2d\u79fb\u52a8\u3002 # 4\uff0e\u7a7a\u95f4\u53ef\u4ee5\u56de\u6536\uff08\u9664drop table\u64cd\u4f5c\u5904\uff0c\u8868\u7a7a\u4e0d\u80fd\u81ea\u5df2\u56de\u6536\uff09 # \u7f3a\u70b9\uff1a # \u5355\u8868\u589e\u52a0\u8fc7\u5927\uff0c\u5982\u8d85\u8fc7100G # \u7ed3\u8bba\uff1a # \u5171\u4eab\u8868\u7a7a\u95f4\u5728Insert\u64cd\u4f5c\u4e0a\u5c11\u6709\u4f18\u52bf\u3002\u5176\u5b83\u90fd\u6ca1\u72ec\u7acb\u8868\u7a7a\u95f4\u8868\u73b0\u597d\u3002\u5f53\u542f\u7528\u72ec\u7acb\u8868\u7a7a\u95f4\u65f6\uff0c\u8bf7\u5408\u7406\u8c03\u6574\uff1ainnodb_open_files innodb_open_files = 500 # \u9650\u5236Innodb\u80fd\u6253\u5f00\u7684\u8868\u7684\u6570\u636e\uff0c\u5982\u679c\u5e93\u91cc\u7684\u8868\u7279\u522b\u591a\u7684\u60c5\u51b5\uff0c\u8bf7\u589e\u52a0\u8fd9\u4e2a\u3002\u8fd9\u4e2a\u503c\u9ed8\u8ba4\u662f300 innodb_buffer_pool_size = 64M # InnoDB\u4f7f\u7528\u4e00\u4e2a\u7f13\u51b2\u6c60\u6765\u4fdd\u5b58\u7d22\u5f15\u548c\u539f\u59cb\u6570\u636e, \u4e0d\u50cfMyISAM. # \u8fd9\u91cc\u4f60\u8bbe\u7f6e\u8d8a\u5927,\u4f60\u5728\u5b58\u53d6\u8868\u91cc\u9762\u6570\u636e\u65f6\u6240\u9700\u8981\u7684\u78c1\u76d8I/O\u8d8a\u5c11. # \u5728\u4e00\u4e2a\u72ec\u7acb\u4f7f\u7528\u7684\u6570\u636e\u5e93\u670d\u52a1\u5668\u4e0a,\u4f60\u53ef\u4ee5\u8bbe\u7f6e\u8fd9\u4e2a\u53d8\u91cf\u5230\u670d\u52a1\u5668\u7269\u7406\u5185\u5b58\u5927\u5c0f\u768480% # \u4e0d\u8981\u8bbe\u7f6e\u8fc7\u5927,\u5426\u5219,\u7531\u4e8e\u7269\u7406\u5185\u5b58\u7684\u7ade\u4e89\u53ef\u80fd\u5bfc\u81f4\u64cd\u4f5c\u7cfb\u7edf\u7684\u6362\u9875\u98a0\u7c38. # \u6ce8\u610f\u572832\u4f4d\u7cfb\u7edf\u4e0a\u4f60\u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u80fd\u88ab\u9650\u5236\u5728 2-3.5G \u7528\u6237\u5c42\u9762\u5185\u5b58\u9650\u5236, # \u6240\u4ee5\u4e0d\u8981\u8bbe\u7f6e\u7684\u592a\u9ad8. innodb_write_io_threads = 4 innodb_read_io_threads = 4 # innodb\u4f7f\u7528\u540e\u53f0\u7ebf\u7a0b\u5904\u7406\u6570\u636e\u9875\u4e0a\u7684\u8bfb\u5199 I/O(\u8f93\u5165\u8f93\u51fa)\u8bf7\u6c42,\u6839\u636e\u4f60\u7684 CPU \u6838\u6570\u6765\u66f4\u6539,\u9ed8\u8ba4\u662f4 # \u6ce8:\u8fd9\u4e24\u4e2a\u53c2\u6570\u4e0d\u652f\u6301\u52a8\u6001\u6539\u53d8,\u9700\u8981\u628a\u8be5\u53c2\u6570\u52a0\u5165\u5230my.cnf\u91cc\uff0c\u4fee\u6539\u5b8c\u540e\u91cd\u542fMySQL\u670d\u52a1,\u5141\u8bb8\u503c\u7684\u8303\u56f4\u4ece 1-64 innodb_thread_concurrency = 0 # \u9ed8\u8ba4\u8bbe\u7f6e\u4e3a 0,\u8868\u793a\u4e0d\u9650\u5236\u5e76\u53d1\u6570\uff0c\u8fd9\u91cc\u63a8\u8350\u8bbe\u7f6e\u4e3a0\uff0c\u66f4\u597d\u53bb\u53d1\u6325CPU\u591a\u6838\u5904\u7406\u80fd\u529b\uff0c\u63d0\u9ad8\u5e76\u53d1\u91cf innodb_purge_threads = 1 # InnoDB\u4e2d\u7684\u6e05\u9664\u64cd\u4f5c\u662f\u4e00\u7c7b\u5b9a\u671f\u56de\u6536\u65e0\u7528\u6570\u636e\u7684\u64cd\u4f5c\u3002\u5728\u4e4b\u524d\u7684\u51e0\u4e2a\u7248\u672c\u4e2d\uff0c # \u6e05\u9664\u64cd\u4f5c\u662f\u4e3b\u7ebf\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u8fd9\u610f\u5473\u7740\u8fd0\u884c\u65f6\u5b83\u53ef\u80fd\u4f1a\u5835\u585e\u5176\u5b83\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u3002 # \u4eceMySQL5.5.X\u7248\u672c\u5f00\u59cb\uff0c\u8be5\u64cd\u4f5c\u8fd0\u884c\u4e8e\u72ec\u7acb\u7684\u7ebf\u7a0b\u4e2d,\u5e76\u652f\u6301\u66f4\u591a\u7684\u5e76\u53d1\u6570\u3002\u7528\u6237\u53ef\u901a\u8fc7\u8bbe\u7f6einnodb_purge_threads\u914d\u7f6e\u53c2\u6570\u6765\u9009\u62e9\u6e05\u9664\u64cd\u4f5c\u662f\u5426\u4f7f\u7528\u5355 # \u72ec\u7ebf\u7a0b,\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53c2\u6570\u8bbe\u7f6e\u4e3a0(\u4e0d\u4f7f\u7528\u5355\u72ec\u7ebf\u7a0b),\u8bbe\u7f6e\u4e3a 1 \u65f6\u8868\u793a\u4f7f\u7528\u5355\u72ec\u7684\u6e05\u9664\u7ebf\u7a0b\u3002\u5efa\u8bae\u4e3a1 innodb_flush_log_at_trx_commit = 2 # 0\uff1a\u5982\u679cinnodb_flush_log_at_trx_commit\u7684\u503c\u4e3a0, # log buffer\u6bcf\u79d2\u5c31\u4f1a\u88ab\u5237\u5199\u65e5\u5fd7\u6587\u4ef6\u5230\u78c1\u76d8\uff0c\u63d0\u4ea4\u4e8b\u52a1\u7684\u65f6\u5019\u4e0d\u505a\u4efb\u4f55\u64cd\u4f5c\uff08\u6267\u884c\u662f\u7531mysql\u7684master thread\u7ebf\u7a0b\u6765\u6267\u884c\u7684\u3002 # \u4e3b\u7ebf\u7a0b\u4e2d\u6bcf\u79d2\u4f1a\u5c06\u91cd\u505a\u65e5\u5fd7\u7f13\u51b2\u5199\u5165\u78c1\u76d8\u7684\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6(REDO LOG)\u4e2d\u3002\u4e0d\u8bba\u4e8b\u52a1\u662f\u5426\u5df2\u7ecf\u63d0\u4ea4\uff09\u9ed8\u8ba4\u7684\u65e5\u5fd7\u6587\u4ef6\u662fib_logfile0,ib_logfile1 # 1\uff1a\u5f53\u8bbe\u4e3a\u9ed8\u8ba4\u503c1\u7684\u65f6\u5019\uff0c\u6bcf\u6b21\u63d0\u4ea4\u4e8b\u52a1\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u5c06log buffer\u5237\u5199\u5230\u65e5\u5fd7\u3002 # 2\uff1a\u5982\u679c\u8bbe\u4e3a2,\u6bcf\u6b21\u63d0\u4ea4\u4e8b\u52a1\u90fd\u4f1a\u5199\u65e5\u5fd7\uff0c\u4f46\u5e76\u4e0d\u4f1a\u6267\u884c\u5237\u7684\u64cd\u4f5c\u3002\u6bcf\u79d2\u5b9a\u65f6\u4f1a\u5237\u5230\u65e5\u5fd7\u6587\u4ef6\u3002 # \u8981\u6ce8\u610f\u7684\u662f\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1100%\u6bcf\u79d2\u4e00\u5b9a\u90fd\u4f1a\u5237\u5230\u78c1\u76d8\uff0c\u8fd9\u8981\u53d6\u51b3\u4e8e\u8fdb\u7a0b\u7684\u8c03\u5ea6\u3002 # \u6bcf\u6b21\u4e8b\u52a1\u63d0\u4ea4\u7684\u65f6\u5019\u5c06\u6570\u636e\u5199\u5165\u4e8b\u52a1\u65e5\u5fd7\uff0c\u800c\u8fd9\u91cc\u7684\u5199\u5165\u4ec5\u662f\u8c03\u7528\u4e86\u6587\u4ef6\u7cfb\u7edf\u7684\u5199\u5165\u64cd\u4f5c\uff0c # \u800c\u6587\u4ef6\u7cfb\u7edf\u662f\u6709 \u7f13\u5b58\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u5199\u5165\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u6570\u636e\u5df2\u7ecf\u5199\u5165\u5230\u7269\u7406\u78c1\u76d8 # \u9ed8\u8ba4\u503c1\u662f\u4e3a\u4e86\u4fdd\u8bc1\u5b8c\u6574\u7684ACID\u3002\u5f53\u7136\uff0c\u4f60\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u914d\u7f6e\u9879\u8bbe\u4e3a1\u4ee5\u5916\u7684\u503c\u6765\u6362\u53d6\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u4f46\u662f\u5728\u7cfb\u7edf\u5d29\u6e83\u7684\u65f6\u5019\uff0c\u4f60\u5c06\u4f1a\u4e22\u59311\u79d2\u7684\u6570\u636e\u3002 # \u8bbe\u4e3a0\u7684\u8bdd\uff0cmysqld\u8fdb\u7a0b\u5d29\u6e83\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u4e22\u5931\u6700\u540e1\u79d2\u7684\u4e8b\u52a1\u3002 # \u8bbe\u4e3a2,\u53ea\u6709\u5728\u64cd\u4f5c\u7cfb\u7edf\u5d29\u6e83\u6216\u8005\u65ad\u7535\u7684\u65f6\u5019\u624d\u4f1a\u4e22\u5931\u6700\u540e1\u79d2\u7684\u6570\u636e\u3002InnoDB\u5728\u505a\u6062\u590d\u7684\u65f6\u5019\u4f1a\u5ffd\u7565\u8fd9\u4e2a\u503c\u3002 ### \u603b\u7ed3 ### # \u8bbe\u4e3a1\u5f53\u7136\u662f\u6700\u5b89\u5168\u7684\uff0c\u4f46\u6027\u80fd\u9875\u662f\u6700\u5dee\u7684\uff08\u76f8\u5bf9\u5176\u4ed6\u4e24\u4e2a\u53c2\u6570\u800c\u8a00\uff0c\u4f46\u4e0d\u662f\u4e0d\u80fd\u63a5\u53d7\uff09\u3002 # \u5982\u679c\u5bf9\u6570\u636e\u4e00\u81f4\u6027\u548c\u5b8c\u6574\u6027\u8981\u6c42\u4e0d\u9ad8\uff0c\u5b8c\u5168\u53ef\u4ee5\u8bbe\u4e3a2\uff0c\u5982\u679c\u53ea\u6700\u6c42\u6027\u80fd\uff0c\u4f8b\u5982\u9ad8\u5e76\u53d1\u5199\u7684\u65e5\u5fd7\u670d\u52a1\u5668\uff0c\u8bbe\u4e3a0\u6765\u83b7\u5f97\u66f4\u9ad8\u6027\u80fd innodb_log_buffer_size = 2M # \u6b64\u53c2\u6570\u786e\u5b9a\u4e9b\u65e5\u5fd7\u6587\u4ef6\u6240\u7528\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u4ee5M\u4e3a\u5355\u4f4d\u3002\u7f13\u51b2\u533a\u66f4\u5927\u80fd\u63d0\u9ad8\u6027\u80fd\uff0c\u4f46\u610f\u5916\u7684\u6545\u969c\u5c06\u4f1a\u4e22\u5931\u6570\u636e\u3002MySQL\u5f00\u53d1\u4eba\u5458\u5efa\u8bae\u8bbe\u7f6e\u4e3a1\uff0d8M\u4e4b\u95f4 innodb_log_file_size = 32M # \u6b64\u53c2\u6570\u786e\u5b9a\u6570\u636e\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u66f4\u5927\u7684\u8bbe\u7f6e\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\uff0c\u4f46\u4e5f\u4f1a\u589e\u52a0\u6062\u590d\u6545\u969c\u6570\u636e\u5e93\u6240\u9700\u7684\u65f6\u95f4 innodb_log_files_in_group = 3 # \u4e3a\u63d0\u9ad8\u6027\u80fd\uff0cMySQL\u53ef\u4ee5\u4ee5\u5faa\u73af\u65b9\u5f0f\u5c06\u65e5\u5fd7\u6587\u4ef6\u5199\u5230\u591a\u4e2a\u6587\u4ef6\u3002\u63a8\u8350\u8bbe\u7f6e\u4e3a3 innodb_max_dirty_pages_pct = 90 # innodb\u4e3b\u7ebf\u7a0b\u5237\u65b0\u7f13\u5b58\u6c60\u4e2d\u7684\u6570\u636e\uff0c\u4f7f\u810f\u6570\u636e\u6bd4\u4f8b\u5c0f\u4e8e90% innodb_lock_wait_timeout = 120 # InnoDB\u4e8b\u52a1\u5728\u88ab\u56de\u6eda\u4e4b\u524d\u53ef\u4ee5\u7b49\u5f85\u4e00\u4e2a\u9501\u5b9a\u7684\u8d85\u65f6\u79d2\u6570\u3002 # InnoDB\u5728\u5b83\u81ea\u5df1\u7684\u9501\u5b9a\u8868\u4e2d\u81ea\u52a8\u68c0\u6d4b\u4e8b\u52a1\u6b7b\u9501\u5e76\u4e14\u56de\u6eda\u4e8b\u52a1\u3002InnoDB\u7528LOCK TABLES\u8bed\u53e5\u6ce8\u610f\u5230\u9501\u5b9a\u8bbe\u7f6e\u3002\u9ed8\u8ba4\u503c\u662f50\u79d2 bulk_insert_buffer_size = 8M # \u6279\u91cf\u63d2\u5165\u7f13\u5b58\u5927\u5c0f\uff0c \u8fd9\u4e2a\u53c2\u6570\u662f\u9488\u5bf9MyISAM\u5b58\u50a8\u5f15\u64ce\u6765\u8bf4\u7684\u3002 # \u9002\u7528\u4e8e\u5728\u4e00\u6b21\u6027\u63d2\u5165100-1000+\u6761\u8bb0\u5f55\u65f6\uff0c \u63d0\u9ad8\u6548\u7387\u3002\u9ed8\u8ba4\u503c\u662f8M\u3002\u53ef\u4ee5\u9488\u5bf9\u6570\u636e\u91cf\u7684\u5927\u5c0f\uff0c\u7ffb\u500d\u589e\u52a0\u3002 myisam_sort_buffer_size = 8M # MyISAM\u8bbe\u7f6e\u6062\u590d\u8868\u4e4b\u65f6\u4f7f\u7528\u7684\u7f13\u51b2\u533a\u7684\u5c3a\u5bf8\uff0c\u5f53\u5728REPAIR TABLE\u6216\u7528CREATE INDEX\u521b\u5efa\u7d22\u5f15\u6216ALTER TABLE\u8fc7\u7a0b\u4e2d\u6392\u5e8f MyISAM\u7d22\u5f15\u5206\u914d\u7684\u7f13\u51b2\u533a myisam_max_sort_file_size = 10G # \u5982\u679c\u4e34\u65f6\u6587\u4ef6\u4f1a\u53d8\u5f97\u8d85\u8fc7\u7d22\u5f15\uff0c\u4e0d\u8981\u4f7f\u7528\u5feb\u901f\u6392\u5e8f\u7d22\u5f15\u65b9\u6cd5\u6765\u521b\u5efa\u4e00\u4e2a\u7d22\u5f15\u3002\u6ce8\u91ca\uff1a\u8fd9\u4e2a\u53c2\u6570\u4ee5\u5b57\u8282\u7684\u5f62\u5f0f\u7ed9\u51fa myisam_repair_threads = 1 # \u5982\u679c\u8be5\u503c\u5927\u4e8e1\uff0c\u5728Repair by sorting\u8fc7\u7a0b\u4e2d\u5e76\u884c\u521b\u5efaMyISAM\u8868\u7d22\u5f15(\u6bcf\u4e2a\u7d22\u5f15\u5728\u81ea\u5df1\u7684\u7ebf\u7a0b\u5185) interactive_timeout = 28800 # \u670d\u52a1\u5668\u5173\u95ed\u4ea4\u4e92\u5f0f\u8fde\u63a5\u524d\u7b49\u5f85\u6d3b\u52a8\u7684\u79d2\u6570\u3002\u4ea4\u4e92\u5f0f\u5ba2\u6237\u7aef\u5b9a\u4e49\u4e3a\u5728 # mysql_real_connect()\u4e2d\u4f7f\u7528CLIENT_INTERACTIVE\u9009\u9879\u7684\u5ba2\u6237\u7aef\u3002\u9ed8\u8ba4\u503c\uff1a28800\u79d2\uff088\u5c0f\u65f6\uff09 wait_timeout = 28800 # \u670d\u52a1\u5668\u5173\u95ed\u975e\u4ea4\u4e92\u8fde\u63a5\u4e4b\u524d\u7b49\u5f85\u6d3b\u52a8\u7684\u79d2\u6570\u3002\u5728\u7ebf\u7a0b\u542f\u52a8\u65f6\uff0c\u6839\u636e\u5168\u5c40wait_timeout\u503c\u6216\u5168\u5c40interactive_timeout\u503c\u521d\u59cb\u5316\u4f1a\u8bddwait_timeout\u503c\uff0c # \u53d6\u51b3\u4e8e\u5ba2\u6237\u7aef\u7c7b\u578b(\u7531mysql_real_connect()\u7684\u8fde\u63a5\u9009\u9879CLIENT_INTERACTIVE\u5b9a\u4e49)\u3002\u53c2\u6570\u9ed8\u8ba4\u503c\uff1a28800\u79d2\uff088\u5c0f\u65f6\uff09 # MySQL\u670d\u52a1\u5668\u6240\u652f\u6301\u7684\u6700\u5927\u8fde\u63a5\u6570\u662f\u6709\u4e0a\u9650\u7684\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u8fde\u63a5\u7684\u5efa\u7acb\u90fd\u4f1a\u6d88\u8017\u5185\u5b58\uff0c\u56e0\u6b64\u6211\u4eec\u5e0c\u671b\u5ba2\u6237\u7aef\u5728\u8fde\u63a5\u5230MySQL Server\u5904\u7406\u5b8c\u76f8\u5e94\u7684\u64cd\u4f5c\u540e\uff0c # \u5e94\u8be5\u65ad\u5f00\u8fde\u63a5\u5e76\u91ca\u653e\u5360\u7528\u7684\u5185\u5b58\u3002\u5982\u679c\u4f60\u7684MySQL Server\u6709\u5927\u91cf\u7684\u95f2\u7f6e\u8fde\u63a5\uff0c\u4ed6\u4eec\u4e0d\u4ec5\u4f1a\u767d\u767d\u6d88\u8017\u5185\u5b58\uff0c\u800c\u4e14\u5982\u679c\u8fde\u63a5\u4e00\u76f4\u5728\u7d2f\u52a0\u800c\u4e0d\u65ad\u5f00\uff0c # \u6700\u7ec8\u80af\u5b9a\u4f1a\u8fbe\u5230MySQL Server\u7684\u8fde\u63a5\u4e0a\u9650\u6570\uff0c\u8fd9\u4f1a\u62a5'too many connections'\u7684\u9519\u8bef\u3002\u5bf9\u4e8ewait_timeout\u7684\u503c\u8bbe\u5b9a\uff0c\u5e94\u8be5\u6839\u636e\u7cfb\u7edf\u7684\u8fd0\u884c\u60c5\u51b5\u6765\u5224\u65ad\u3002 # \u5728\u7cfb\u7edf\u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7show processlist\u547d\u4ee4\u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u7684\u8fde\u63a5\u72b6\u6001\uff0c\u5982\u679c\u53d1\u73b0\u6709\u5927\u91cf\u7684sleep\u72b6\u6001\u7684\u8fde\u63a5\u8fdb\u7a0b\uff0c\u5219\u8bf4\u660e\u8be5\u53c2\u6570\u8bbe\u7f6e\u7684\u8fc7\u5927\uff0c # \u53ef\u4ee5\u8fdb\u884c\u9002\u5f53\u7684\u8c03\u6574\u5c0f\u4e9b\u3002\u8981\u540c\u65f6\u8bbe\u7f6einteractive_timeout\u548cwait_timeout\u624d\u4f1a\u751f\u6548\u3002 [mysqldump] quick max_allowed_packet = 16M #\u670d\u52a1\u5668\u53d1\u9001\u548c\u63a5\u53d7\u7684\u6700\u5927\u5305\u957f\u5ea6 [myisamchk] key_buffer_size = 8M sort_buffer_size = 8M read_buffer = 4M write_buffer = 4M","title":"Mysql\u53c2\u6570\u4f18\u5316\u5bf9\u4e8e\u65b0\u624b\u6765\u8bb2\uff0c\u662f\u6bd4\u8f83\u96be\u61c2\u7684\u4e1c\u897f\uff0c\u5176\u5b9e\u8fd9\u4e2a\u53c2\u6570\u4f18\u5316\uff0c\u662f\u4e2a\u5f88\u590d\u6742\u7684\u4e1c\u897f\uff0c"},{"location":"mysql/#innodb_flush_log_at_trx_commit","text":"","title":"innodb_flush_log_at_trx_commit"},{"location":"mysql/#innodb_buffer_pool_size","text":"\u5982 \u679c\u7528Innodb\uff0c\u90a3\u4e48\u8fd9\u662f\u4e00\u4e2a\u91cd\u8981\u53d8\u91cf\u3002\u76f8\u5bf9\u4e8eMyISAM\u6765\u8bf4\uff0cInnodb\u5bf9\u4e8ebuffer size\u66f4\u654f\u611f\u3002MySIAM\u53ef\u80fd\u5bf9\u4e8e\u5927\u6570\u636e\u91cf\u4f7f\u7528\u9ed8\u8ba4\u7684key_buffer_size\u4e5f\u8fd8\u597d\uff0c\u4f46Innodb\u5728\u5927\u6570\u636e\u91cf\u65f6\u7528\u9ed8\u8ba4\u503c\u5c31\u611f\u89c9\u5728\u722c\u4e86\u3002 Innodb\u7684\u7f13\u51b2\u6c60\u4f1a\u7f13\u5b58\u6570\u636e\u548c\u7d22\u5f15\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u7ed9\u7cfb\u7edf\u7684\u7f13\u5b58\u7559\u7a7a\u95f4\uff0c\u5982\u679c\u53ea\u7528Innodb\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e2a\u503c\u8bbe\u4e3a\u5185\u5b58\u768470%-80%\u3002\u548c key_buffer\u76f8\u540c\uff0c\u5982\u679c\u6570\u636e\u91cf\u6bd4\u8f83\u5c0f\u4e5f\u4e0d\u600e\u4e48\u589e\u52a0\uff0c\u90a3\u4e48\u4e0d\u8981\u628a\u8fd9\u4e2a\u503c\u8bbe\u592a\u9ad8\u4e5f\u53ef\u4ee5\u63d0\u9ad8\u5185\u5b58\u7684\u4f7f\u7528\u7387\u3002","title":"innodb_buffer_pool_size"},{"location":"mysql/#innodb_additional_pool_size","text":"\u8fd9\u4e2a\u7684\u6548\u679c\u4e0d\u662f\u5f88\u660e\u663e\uff0c\u81f3\u5c11\u662f\u5f53\u64cd\u4f5c\u7cfb\u7edf\u80fd\u5408\u7406\u5206\u914d\u5185\u5b58\u65f6\u3002\u4f46\u4f60\u53ef\u80fd\u4ecd\u9700\u8981\u8bbe\u621020M\u6216\u66f4\u591a\u4e00\u70b9\u4ee5\u770bInnodb\u4f1a\u5206\u914d\u591a\u5c11\u5185\u5b58\u505a\u5176\u4ed6\u7528\u9014\u3002","title":"innodb_additional_pool_size"},{"location":"mysql/#innodb_log_file_size","text":"\u5bf9\u4e8e\u5199\u5f88\u591a\u5c24\u5176\u662f\u5927\u6570\u636e\u91cf\u65f6\u975e\u5e38\u91cd\u8981\u3002\u8981\u6ce8\u610f\uff0c\u5927\u7684\u6587\u4ef6\u63d0\u4f9b\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u4f46\u6570\u636e\u5e93\u6062\u590d\u65f6\u4f1a\u7528\u66f4\u591a\u7684\u65f6\u95f4\u3002\u6211\u4e00\u822c\u752864M-512M\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u670d\u52a1\u5668\u7684\u7a7a\u95f4\u3002","title":"innodb_log_file_size"},{"location":"mysql/#innodb_log_buffer_size","text":"\u9ed8\u8ba4\u503c\u5bf9\u4e8e\u591a\u6570\u4e2d\u7b49\u5199\u64cd\u4f5c\u548c\u4e8b\u52a1\u77ed\u7684\u8fd0\u7528\u90fd\u662f\u53ef\u4ee5\u7684\u3002\u5982 \u679c\u7ecf\u5e38\u505a\u66f4\u65b0\u6216\u8005\u4f7f\u7528\u4e86\u5f88\u591ablob\u6570\u636e\uff0c\u5e94\u8be5\u589e\u5927\u8fd9\u4e2a\u503c\u3002\u4f46\u592a\u5927\u4e86\u4e5f\u662f\u6d6a\u8d39\u5185\u5b58\uff0c\u56e0\u4e3a1\u79d2\u949f\u603b\u4f1a flush\uff08\u8fd9\u4e2a\u8bcd\u7684\u4e2d\u6587\u600e\u4e48\u8bf4\u5462\uff1f\uff09\u4e00\u6b21\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u8bbe\u5230\u8d85\u8fc71\u79d2\u7684\u9700\u6c42\u30028M-16M\u4e00\u822c\u5e94\u8be5\u591f\u4e86\u3002\u5c0f\u7684\u8fd0\u7528\u53ef\u4ee5\u8bbe\u66f4\u5c0f\u4e00\u70b9\u3002","title":"innodb_log_buffer_size"},{"location":"mysql/#innodb_flush_log_at_trx_commit_1","text":"\u62b1\u6028Innodb\u6bd4MyISAM\u6162 100\u500d\uff1f\u90a3\u4e48\u4f60\u5927\u6982\u662f\u5fd8\u4e86\u8c03\u6574\u8fd9\u4e2a\u503c\u3002\u9ed8\u8ba4\u503c1\u7684\u610f\u601d\u662f\u6bcf\u4e00\u6b21\u4e8b\u52a1\u63d0\u4ea4\u6216\u4e8b\u52a1\u5916\u7684\u6307\u4ee4\u90fd\u9700\u8981\u628a\u65e5\u5fd7\u5199\u5165\uff08flush\uff09\u786c\u76d8\uff0c\u8fd9\u662f\u5f88\u8d39\u65f6\u7684\u3002\u7279\u522b\u662f\u4f7f\u7528\u7535 \u6c60\u4f9b\u7535\u7f13\u5b58\uff08Battery backed up cache\uff09\u65f6\u3002\u8bbe\u62102\u5bf9\u4e8e\u5f88\u591a\u8fd0\u7528\uff0c\u7279\u522b\u662f\u4eceMyISAM\u8868\u8f6c\u8fc7\u6765\u7684\u662f\u53ef\u4ee5\u7684\uff0c\u5b83\u7684\u610f\u601d\u662f\u4e0d\u5199\u5165\u786c\u76d8\u800c\u662f\u5199\u5165\u7cfb\u7edf\u7f13\u5b58\u3002\u65e5\u5fd7\u4ecd\u7136\u4f1a\u6bcf\u79d2flush\u5230\u786c \u76d8\uff0c\u6240\u4ee5\u4f60\u4e00\u822c\u4e0d\u4f1a\u4e22\u5931\u8d85\u8fc71-2\u79d2\u7684\u66f4\u65b0\u3002\u8bbe\u62100\u4f1a\u66f4\u5feb\u4e00\u70b9\uff0c\u4f46\u5b89\u5168\u65b9\u9762\u6bd4\u8f83\u5dee\uff0c\u5373\u4f7fMySQL\u6302\u4e86\u4e5f\u53ef\u80fd\u4f1a\u4e22\u5931\u4e8b\u52a1\u7684\u6570\u636e\u3002\u800c\u503c2\u53ea\u4f1a\u5728\u6574\u4e2a\u64cd\u4f5c\u7cfb\u7edf \u6302\u4e86\u65f6\u624d\u53ef\u80fd\u4e22\u6570\u636e\u3002","title":"innodb_flush_log_at_trx_commit  \uff08\u8fd9\u4e2a\u5f88\u7ba1\u7528\uff09"},{"location":"mysql/#innodb_flush_log_at_trx_commit_2","text":"If the value of innodb_flush_log_at_trx_commit is 0, the log buffer is written out to the log file once per second and the flush to disk operation is performed on the log file, but nothing is done at a transaction commit. When the value is 1, the log buffer is written out to the log file at each transaction commit and the flush to disk operation is performed on the log file. When the value is 2, the log buffer is written out to the file at each commit, but the flush to disk operation is not performed on it. However, the flushing on the log file takes place once per second also when the value is 2. Note that the once-per-second flushing is not 100% guaranteed to happen every second, due to process scheduling issues. The default value of this variable is 1 (prior to MySQL 4.0.13, the default is 0). A value of 1 is required for ACID compliance. You can achieve better performance by setting the value different from 1, but then you can lose at most one second worth of transactions in a crash. With a value of 0, any mysqldprocess crash can erase the last second of transactions. With a value of 2, then only an operating system crash or a power outage can erase the last second of transactions. However, InnoDB's crash recovery is not affected and thus crash recovery does work regardless of the value. Note For the greatest possible durability and consistency in a replication setup using InnoDB with transactions, use innodb_flush_log_at_trx_commit=1, sync_binlog=1, and innodb-safe-binlog in your master server my.cnf file. Caution Many operating systems and some disk hardware fool the flush-to-disk operation. They may tellmysqld that the flush has taken place, even though it has not. Then the durability of transactions is not guaranteed even with the setting 1, and in the worst case a power outage can even corrupt theInnoDB database. Using a battery-backed disk cache in the SCSI disk controller or in the disk itself speeds up file flushes, and makes the operation safer. You can also try using the Unix commandhdparm to disable the caching of disk writes in hardware caches, or use some other command specific to the hardware vendor.","title":"innodb_flush_log_at_trx_commit"},{"location":"mysql/#mycnf","text":"[mysql] default-character-set=utf8 socket=/tmp/mysql.sock [mysqld] user=mysql datadir=/home/mysql socket=/tmp/mysql.sock tmpdir=/home/tmp slow_query_log=1 # slow query \u6a5f\u80fd\u3092ON\u306b\u3059\u308b long_query_time=10 # slow query \u6642\u9593\u309210\u79d2\u306b\u8a2d\u5b9a slow_query_log_file=/var/log/mysql/slow_query.log log-error=/var/log/mysql/error.log log_output=FILE # log\u5f62\u5f0f\u3092file\u5f0f\u306b\u8a2d\u5b9a #myisam myisam_sort_buffer_size=128M # MyISAM\u3067\u4ee5\u4e0b\u306e\u6642\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u306e\u30bd\u30fc\u30c8\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 # REPAIR TABLE\u3001CREATE INDEX\u3001ALTER INDEX\u3002\u901a\u5e38\u306e\u30af\u30a8\u30ea(DML)\u3067\u306f\u4f7f\u308f\u308c\u306a\u3044\u3088\u3046\u306a\u306e\u3067\u3001\u305d\u308c\u307b\u3069\u591a\u304f\u3059\u308b\u5fc5\u8981\u306f\u306a\u3044\u3067\u3057\u3087\u3046\u3002 key_buffer_size=512M # MyISAM\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 # \u591a\u304f\u5272\u308a\u5f53\u3066\u305f\u65b9\u304c\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u5411\u4e0a\u3057\u307e\u3059\u3002\u30b0\u30ed\u30fc\u30d0\u30eb\u30d0\u30c3\u30d5\u30a1\u306a\u306e\u3067\u3069\u304b\u3093\u3068\u5272\u308a\u5f53\u3066\u3089\u308c\u307e\u3059\u3002 # \u3082\u3057\u3001MyISAM\u3092(\u3042\u307e\u308a)\u4f7f\u3063\u3066\u306a\u3044\u306e\u306a\u3089\u3070\u3001\u5c0f\u3055\u304f\u3057\u3066\u307b\u304b\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u56de\u3059\u306e\u3082\u30a2\u30ea\u3067\u3059\u3002 sort_buffer_size=2M # ORDER BY\u3084GROUP BY\u306e\u3068\u304d\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 read_buffer_size=2M # \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u7528\u3044\u306a\u3044\u30c6\u30fc\u30d6\u30eb\u30b9\u30ad\u30e3\u30f3\u306e\u3068\u304d\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 read_rnd_buffer_size=2M # \u30bd\u30fc\u30c8\u5f8c\u306b\u30ec\u30b3\u30fc\u30c9\u3092\u8aad\u3080\u3068\u304d\u306b\u4f7f\u308f\u308c\u308b\u30e1\u30e2\u30ea\u4e0a\u306e\u9818\u57df\u3067\u3059\u3002 # \u30c7\u30a3\u30b9\u30afI/O\u304c\u6e1b\u308b\u306e\u3067ORDER BY\u306e\u6027\u80fd\u5411\u4e0a\u304c\u671f\u5f85\u3067\u304d\u307e\u3059\u3002 #server default-storage-engine=INNODB skip-name-resolve # DNS\u89e3\u6c7a\u3092OFF\u306b\u3059\u308b skip-ssl # MySQL5.7\u3067\u306fSSL\u5229\u7528\u3057\u306a\u3044\u305f\u3081\u3001OFF\u306b\u3059\u308b max_connections=300 # \u6700\u5927\u63a5\u7d9a\u6570\u3092300\u306b\u3059\u308b\u3001\u30b5\u30fc\u30d0\u306e\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3068\u30cd\u30c3\u30c8\u5e2f\u57df\u306b\u3088\u308b\u3082\u306e\u3067\u3001 # \u4eca\u5f8c\u30b5\u30fc\u30d0\u30ea\u30d7\u30ec\u30fc\u30b9\u306810G\u5316\u3057\u305f\u5f8c\u3001\u5909\u66f4\u3059\u308b\u5fc5\u8981\u3042\u308a\u307e\u3059\u3002 max_connect_errors=300 # \u9023\u7d9a\u3057\u3066\u63a5\u7d9a\u8981\u6c42\u304c\u4e2d\u65ad\u3055\u308c\u305f\u5834\u5408\u306b\u305d\u308c\u3092\u8a31\u53ef\u3059\u308b\u56de\u6570\u3092\u6c7a\u5b9a\u3057\u307e\u3059\u3002 max_allowed_packet=16M # MySQL Server \u304a\u3088\u3073\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u9593\u3067\u8ee2\u9001\u53ef\u80fd\u306a\u30d1\u30b1\u30c3\u30c8\u6570\u3002 query_cache_size=512M # \u30af\u30a8\u30ea\u30ad\u30e3\u30c3\u30b7\u30e5\u9818\u57df\u3002 query_cache_limit=32M # \u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b\u30af\u30a8\u30ea\u7d50\u679c\u306e\u6700\u5927\u30b5\u30a4\u30ba\u3002 query_cache_type=1 # SELECT SQL_NO_CACHE \u4ee5\u5916\u306e\u30af\u30a8\u30ea\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3059\u308b connect_timeout=30 # connect timeout \u6642\u9593\u309230\u79d2\u306b\u8a2d\u5b9a max_user_connections=30 # \u5358\u4e00\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u3088\u308b\u540c\u6642\u63a5\u7d9a\u306e\u6570 thread_cache_size=300 # \u30b9\u30ec\u30c3\u30c9\u3092\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u306e\u5207\u65ad\u5f8c\u306b\u3082\u30ad\u30e3\u30c3\u30b7\u30e5\u3057\u3066\u304a\u304f\u6570\u3002 # thread_cache_size\u3092N\u306b\u8a2d\u5b9a\u3059\u308b\u3068\u3001N\u500b\u306e\u30a2\u30af\u30c6\u30a3\u30d6\u3067\u306a\u3044\u63a5\u7d9a\u30b9\u30ec\u30c3\u30c9\u3092\u30ad\u30e3\u30c3\u30b7\u30e5\u3067\u304d\u308b\u3002 # \u95a2\u9023\u4ed8\u3051\u3089\u308c\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u63a5\u7d9a\u304c\u7d42\u4e86\u3059\u308b\u3068\u3001\u63a5\u7d9a\u30b9\u30ec\u30c3\u30c9\u306f\u30a2\u30af\u30c6\u30a3\u30d6\u3067\u306a\u304f\u306a\u308b\u3002 back_log=50 # MySQL \u3067\u4fdd\u6301\u3067\u304d\u308b\u672a\u51e6\u7406\u306e\u63a5\u7d9a\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u6570\u3002 table_open_cache=19200 # \u3059\u3079\u3066\u306e\u30b9\u30ec\u30c3\u30c9\u306b\u3064\u3044\u3066\u958b\u3044\u3066\u3044\u308b\u30c6\u30fc\u30d6\u30eb\u306e\u6570\u3002 table_definition_cache=16000 # \u5b9a\u7fa9\u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u683c\u7d0d\u53ef\u80fd\u306a (.frm \u30d5\u30a1\u30a4\u30eb\u304b\u3089\u306e) \u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\u306e\u6570\u3002 delayed_insert_timeout=60 # \u7d42\u4e86\u3059\u308b\u524d\u306b\u3001INSERT DELAYED \u30cf\u30f3\u30c9\u30e9\u30b9\u30ec\u30c3\u30c9\u304c INSERT \u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u3092\u5f85\u6a5f\u3059\u308b\u79d2\u6570\u3002 interactive_timeout=300 # \u30b5\u30fc\u30d0\u30fc\u304c\u5bfe\u8a71\u578b\u306e\u63a5\u7d9a\u3067\u3001\u5bfe\u8a71\u578b\u306e\u63a5\u7d9a\u3092\u9589\u3058\u308b\u524d\u306b\u30a2\u30af\u30c6\u30a3\u30d3\u30c6\u30a3\u30fc\u3092\u5f85\u6a5f\u3059\u308b\u79d2\u6570\u3002 wait_timeout=300 # \u975e\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u306a\u63a5\u7d9a\u3092\u9589\u3058\u308b\u524d\u306b\u3001\u30b5\u30fc\u30d0\u30fc\u304c\u305d\u306e\u63a5\u7d9a\u4e0a\u3067\u30a2\u30af\u30c6\u30a3\u30d3\u30c6\u30a3\u30fc\u3092\u5f85\u6a5f\u3059\u308b\u79d2\u6570\u3002 tmp_table_size=256M # \u5185\u90e8\u30a4\u30f3\u30e1\u30e2\u30ea\u30fc\u306e\u4e00\u6642\u30c6\u30fc\u30d6\u30eb\u306e\u6700\u5927\u30b5\u30a4\u30ba\u3002 max_heap_table_size=256M # \u30e6\u30fc\u30b6\u30fc\u304c\u4f5c\u6210\u3057\u305f MEMORY \u30c6\u30fc\u30d6\u30eb\u306e\u5897\u52a0\u304c\u8a31\u53ef\u3055\u308c\u308b\u6700\u5927\u30b5\u30a4\u30ba\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002 # character-set-server=utf8 collation-server=utf8_general_ci #innodb options innodb_thread_concurrency=32 # InnoDB \u306f\u3001\u3053\u306e\u5909\u6570\u3067\u6307\u5b9a\u3055\u308c\u305f\u5236\u9650\u4ee5\u4e0b\u306e\u6570\u306e\u30aa\u30da\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u30b7\u30b9\u30c6\u30e0\u30b9\u30ec\u30c3\u30c9\u3092\u540c\u6642\u306b InnoDB \u5185\u90e8\u306b\u4fdd\u6301\u3057\u3088\u3046\u3068\u8a66\u307f\u307e\u3059 # \u30b9\u30ec\u30c3\u30c9\u6570\u304c\u3053\u306e\u5236\u9650\u306b\u9054\u3059\u308b\u3068\u3001\u305d\u308c\u4ee5\u964d\u306e\u30b9\u30ec\u30c3\u30c9\u306f\u5b9f\u884c\u3055\u308c\u308b\u307e\u3067, # \u300c\u5148\u5165\u308c\u5148\u51fa\u3057\u300d (FIFO) \u30ad\u30e5\u30fc\u5185\u3067\u5f85\u6a5f\u72b6\u614b\u306b\u306a\u308a\u307e\u3059\u3002\u30ed\u30c3\u30af\u3092\u5f85\u6a5f\u3057\u3066\u3044\u308b\u30b9\u30ec\u30c3\u30c9\u306f\u3001\u4e26\u5217\u5b9f\u884c\u4e2d\u306e\u30b9\u30ec\u30c3\u30c9\u306e\u6570\u306b\u30ab\u30a6\u30f3\u30c8\u3055\u308c\u307e\u305b\u3093\u3002 innodb_buffer_pool_size=48G # \u5168\u4f53\u30e1\u30e2\u30ea\u306e50%\u301c60%\u306b\u8a2d\u5b9a\u3059\u308b\u30028\u306e\u500d\u6570\u3002 innodb_buffer_pool_dump_pct=100 innodb_buffer_pool_dump_at_shutdown=1 innodb_buffer_pool_load_at_startup=0 # http://tech.gmo-media.jp/post/128523146249/innodb-buffer-pool-load-at-startup innodb_log_file_size=2G innodb_log_files_in_group=2 # \u30ed\u30b0\u30b0\u30eb\u30fc\u30d7\u5185\u306e\u5404\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30a4\u30ba\u3067\u3059\u3002\u901a\u5e38\u306finnodb_buffer_pool_size\u306e25\uff05\u304c\u826f\u3044\u3068\u8a00\u308f\u308c\u3066\u307e\u3059\u304c\u3001 # 12G\u306eib_logfile\u304c\u751f\u6210\u3055\u308c\u3001\u30af\u30e9\u30c3\u30b7\u30e5\u30ea\u30ab\u30d0\u30ea\u6642\u306e\u901f\u5ea6\u304c\u9045\u304f\u306a\u308b\u305f\u3081\u30014G\u306b\u3057\u307e\u3057\u305f\u3002 # \u3082\u3057\u3001SSD\u3067\u306f\u306a\u304f\u3001NVME\u3067\u3042\u308c\u3070\u3001\u9069\u5f53\u306a\u5024\u306b\u5909\u66f4\u3059\u308b\u3079\u304d\u3060\u308d\u3046\u3002 innodb_log_buffer_size=4M # \u30c7\u30a3\u30b9\u30af\u4e0a\u306e\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306b\u66f8\u304d\u8fbc\u3080\u969b\u306b InnoDB \u3067\u4f7f\u7528\u3055\u308c\u308b\u30d0\u30c3\u30d5\u30a1\u30fc\u306e\u30b5\u30a4\u30ba\u3067\u3059\u3002 # \u30ed\u30b0\u30d0\u30c3\u30d5\u30a1\u30fc\u3092\u5927\u304d\u304f\u3059\u308b\u3068\u3001\u30c7\u30a3\u30b9\u30af I/O \u3092\u7bc0\u7d04\u3067\u304d\u307e\u3059\u304c\u3001\u969c\u5bb3\u6642\u30ed\u30fc\u30b9\u3059\u308b\u30c7\u30fc\u30bf\u3082\u591a\u3044\u3001 # \u63a8\u5968\u306f1\u301c8M\u3067\u3059\u3002 innodb_file_per_table # \u65b0\u305f\u306b\u4f5c\u6210\u3055\u308c\u305f\u5404\u30c6\u30fc\u30d6\u30eb\u306e\u30c7\u30fc\u30bf\u304a\u3088\u3073\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u304c\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u30b9\u30da\u30fc\u30b9\u3067\u306f\u306a\u304f, # \u500b\u5225\u306e .ibd \u30d5\u30a1\u30a4\u30eb\u306b\u683c\u7d0d\u3055\u308c\u307e\u3059\u3002\u3053\u308c\u3089\u306e InnoDB \u30c6\u30fc\u30d6\u30eb\u7528\u306e\u30b9\u30c8\u30ec\u30fc\u30b8\u306f\u3001\u30c6\u30fc\u30d6\u30eb\u304c\u524a\u9664\u3055\u308c\u305f\u308a\u3001 # \u5207\u308a\u6368\u3066\u3089\u308c\u305f\u308a\u3059\u308b\u3068\u518d\u5229\u7528\u3055\u308c\u307e\u3059\u30025.6.6 \u4ee5\u4e0a\u306f\u30c7\u30d5\u30a9\u30eb\u30c8ON\u3067\u3059\u3002 innodb_open_files=9600 # \u3053\u306e\u5909\u6570\u306f\u3001\u8907\u6570\u306e InnoDB \u30c6\u30fc\u30d6\u30eb\u30b9\u30da\u30fc\u30b9\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306b\u306e\u307f\u95a2\u9023\u3057\u307e\u3059\u3002 # MySQL \u3067\u4e00\u5ea6\u306b\u958b\u3044\u305f\u307e\u307e\u306b\u3067\u304d\u308b .ibd \u30d5\u30a1\u30a4\u30eb\u306e\u6700\u5927\u6570\u304c\u6307\u5b9a\u3055\u308c\u307e\u3059\u3002 innodb_flush_method=O_DIRECT # InnoDB \u306e\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u304a\u3088\u3073\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306b\u30c7\u30fc\u30bf\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3059\u308b\u969b\u306b\u4f7f\u7528\u3055\u308c\u308b\u65b9\u6cd5\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002 # \u3053\u308c\u306b\u3088\u308a\u3001I/O \u30b9\u30eb\u30fc\u30d7\u30c3\u30c8\u304c\u5f71\u97ff\u3092\u53d7\u3051\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u3053\u306e\u5909\u6570\u306f\u3001Unix \u304a\u3088\u3073 Linux \u30b7\u30b9\u30c6\u30e0\u3067\u306e\u307f\u69cb\u6210\u53ef\u80fd\u3067\u3059\u3002 # Windows \u30b7\u30b9\u30c6\u30e0\u3067\u306f\u3001\u30d5\u30e9\u30c3\u30b7\u30e5\u65b9\u6cd5\u306f\u5e38\u306b async_unbuffered \u3067\u3042\u308a\u3001\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002 # - fsync: InnoDB \u306f fsync() \u30b7\u30b9\u30c6\u30e0\u30b3\u30fc\u30eb\u3092\u4f7f\u7528\u3057\u3066\u3001\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3068\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u4e21\u65b9\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u307e\u3059\u3002fsync \u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u8a2d\u5b9a\u3067\u3059\u3002 # # - O_DSYNC: InnoDB \u306f\u3001O_SYNC \u3092\u4f7f\u7528\u3057\u3066\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u3001fsync() \u3092\u4f7f\u7528\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u307e\u3059\u3002\u3055\u307e\u3056\u307e\u306a\u7a2e\u985e\u306e Unix \u3067\u554f\u984c\u304c\u767a\u751f\u3057\u3066\u3044\u308b\u305f\u3081\u3001InnoDB \u3067\u306f\u76f4\u63a5 O_DSYNC \u304c\u4f7f\u7528\u3055\u308c\u307e\u305b\u3093\u3002 # # - O_DIRECT: InnoDB \u306f\u3001O_DIRECT (Solaris \u3067\u306f directio()) \u3092\u4f7f\u7528\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304d\u3001fsync() \u3092\u4f7f\u7528\u3057\u3066\u30c7\u30fc\u30bf\u30d5\u30a1\u30a4\u30eb\u3068\u30ed\u30b0\u30d5\u30a1\u30a4\u30eb\u306e\u4e21\u65b9\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u307e\u3059\u3002\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f\u3001\u4e00\u90e8\u306e GNU/Linux \u30d0\u30fc\u30b8\u30e7\u30f3\u3001FreeBSD\u3001\u304a\u3088\u3073 Solaris \u3067\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002 # # - O_DIRECT_NO_FSYNC: InnoDB \u306f\u3001I/O \u306e\u30d5\u30e9\u30c3\u30b7\u30e5\u6642\u306b O_DIRECT \u3092\u4f7f\u7528\u3057\u307e\u3059\u304c\u3001\u5f8c\u7d9a\u306e fsync() \u30b7\u30b9\u30c6\u30e0\u30b3\u30fc\u30eb\u306f\u30b9\u30ad\u30c3\u30d7\u3057\u307e\u3059\u3002\u3053\u306e\u8a2d\u5b9a\u306f\u3001\u4e00\u90e8\u306e\u30bf\u30a4\u30d7\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u306b\u306f\u9069\u3057\u3066\u3044\u307e\u3059\u304c\u3001\u305d\u306e\u4ed6\u306b\u306f\u9069\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u305f\u3068\u3048\u3070\u3001XFS \u306b\u306f\u9069\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u305f\u3068\u3048\u3070\u3001\u4f7f\u7528\u4e2d\u306e\u30d5\u30a1\u30a4\u30eb\u30b7\u30b9\u30c6\u30e0\u3067\u3059\u3079\u3066\u306e\u30d5\u30a1\u30a4\u30eb\u30e1\u30bf\u30c7\u30fc\u30bf\u3092\u4fdd\u6301\u3059\u308b\u305f\u3081\u306b\u3001fsync() \u304c\u5fc5\u8981\u3067\u3042\u308b\u306e\u304b\u3069\u3046\u304b\u304c\u4e0d\u660e\u306a\u5834\u5408\u306f\u3001\u4ee3\u308f\u308a\u306b O_DIRECT \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3053\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u306f MySQL 5.6.7 (Bug #11754304\u3001Bug #45892) \u3067\u5c0e\u5165\u3055\u308c\u307e\u3057\u305f\u3002 default_password_lifetime=0 # \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u6709\u52b9\u671f\u9650\u3001\u30ec\u30f3\u30b5\u30d0\u3068\u9023\u643a\u3057\u3066\u3044\u308b\u305f\u3081\u3001OFF\u306b\u3057\u307e\u3057\u305f\u3002 #enforce-gtid-consistency=1 #gtid-mode=ON #safe-user-create=1 #explicit_defaults_for_timestamp=1 log_timestamps=SYSTEM # \u30ed\u30b0\u306b\u51fa\u529b\u3055\u308c\u308b\u6642\u523b\u5909\u6570\u3067\u3059\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306fUTC\u3067\u3059\u304c\u3001\u8aad\u307f\u306b\u304f\u3044\u305f\u3081\u3001SYSTEM\u306b\u5909\u66f4\u3057\u307e\u3057\u305f\u3002 disable-partition-engine-check=1 # https://yoku0825.blogspot.jp/2017/04/mysql-5717-deprecated-partition-engine.html # MySQL8 \u306e\u904e\u6e21\u671f\u306b\u3042\u305f\u308bMySQL 5.7\u306b\u8ffd\u52a0\u3055\u308c\u305f\u3082\u306e\u3067\u3059\u3001\u4eca\u5f8cMySQL8\u30ea\u30ea\u30fc\u30b9\u3057\u305f\u5834\u5408\u3001 # \u30e6\u30fc\u30b6\u304cDB\u79fb\u8a2d\u3059\u308b\u6642\u7d04\u7acb\u3064\u3060\u308d\u3046\uff08\u3068\u601d\u3046\uff09\u3001\u3057\u304b\u3057\u3001\u6bce\u56deMySQL\u8d77\u52d5\u6642\u306btable\u3068\u30c1\u30a7\u30c3\u30af\u3059\u308b\u305f\u3081\u3001 # \u6642\u9593\u304b\u304b\u308b\u305f\u3081\u3001disable\u3057\u307e\u3057\u305f\u3002 show_compatibility_56=on # https://yakst.com/ja/posts/2733 innodb_buffer_pool_instances=8 # InnoDB \u306e\u30d0\u30c3\u30d5\u30a1\u30fc\u30d7\u30fc\u30eb\u304c\u5206\u5272\u3055\u308c\u308b\u9818\u57df\u306e\u6570\u3067\u3059\u3002CPU\u30b3\u30a2\u6570\u306b\u5408\u308f\u305b\u308b\u3002 innodb_rollback_segments=32 # \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5185\u3067 InnoDB \u304c\u4f7f\u7528\u3059\u308b\u30b7\u30b9\u30c6\u30e0\u30c6\u30fc\u30d6\u30eb\u30b9\u30da\u30fc\u30b9\u306b\u3042\u308b\u30ed\u30fc\u30eb\u30d0\u30c3\u30af\u30bb\u30b0\u30e1\u30f3\u30c8\u306e\u6570\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002 innodb_write_io_threads=16 innodb_read_io_threads=16 innodb_io_capacity=2000 innodb_io_capacity_max=5000 # MySQL\u30b5\u30fc\u30d0\u306fSSD\u306e\u305f\u3081\u3001io_capacity\u30922000\u301c5000\u306b\u8a2d\u5b9a\u3059\u308b\u3002 innodb_max_dirty_pages_pct=40 # InnoDB \u306f\u3001\u30c0\u30fc\u30c6\u30a3\u30fc\u30da\u30fc\u30b8\u306e\u5272\u5408\u304c\u3053\u306e\u5024\u3092\u8d85\u3048\u306a\u3044\u3088\u3046\u306b\u3001\u30d0\u30c3\u30d5\u30a1\u30fc\u30d7\u30fc\u30eb\u304b\u3089\u30c7\u30fc\u30bf\u3092\u30d5\u30e9\u30c3\u30b7\u30e5\u3057\u3088\u3046\u3068\u8a66\u307f\u307e\u3059\u3002 innodb_flush_log_at_trx_commit=2","title":"my.cnf \u6700\u7d42\u5f62\u614b"},{"location":"mysql/#_1","text":"","title":"\u73b0\u5728\u7684\u8bbe\u7f6e"},{"location":"mysql/#_2","text":"[mysql] default-character-set=utf8mb4 socket=/tmp/mysql.sock [mysqld] server_id=1 user=mysql datadir=/home/mysql socket=/tmp/mysql.sock tmpdir=/home/tmp bind-address=0.0.0.0 # log log_bin=mysql-bin binlog_error_action=IGNORE_ERROR expire_logs_days=2 slow_query_log=1 long_query_time=10 slow_query_log_file=/var/log/mysql/slow_query.log log_error=/var/log/mysql/error.log log_output=FILE # server sql_mode=\"ONLY_FULL_GROUP_BY,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\" default_storage_engine=INNODB skip-partition skip-name-resolve skip-ssl skip-symbolic-links max_connections=600 max_connect_errors=300 max_allowed_packet=16M connect_timeout=30 max_user_connections=30 table_open_cache=19200 interactive_timeout=300 wait_timeout=300 tmp_table_size=256M max_heap_table_size=256M default_password_lifetime=0 explicit_defaults_for_timestamp=1 log_timestamps=SYSTEM disable_partition_engine_check=1 character-set-server=utf8mb4 collation-server=utf8mb4_general_ci # buffer sort_buffer_size=1M read_buffer_size=1M read_rnd_buffer_size=1M # MyISAM myisam_sort_buffer_size=128M key_buffer_size=512M # InnoDB innodb_strict_mode=1 innodb_file_per_table innodb_temp_data_file_path=ibtmp1:12M:autoextend:max:10G innodb_buffer_pool_size=56G innodb_buffer_pool_dump_pct=100 innodb_buffer_pool_dump_at_shutdown=1 innodb_buffer_pool_load_at_startup=0 innodb_log_file_size=512M innodb_write_io_threads=16 innodb_read_io_threads=16 innodb_io_capacity=2000 innodb_io_capacity_max=5000 innodb_flush_log_at_trx_commit=2 innodb_flush_method=O_DIRECT innodb_flush_neighbors=0 innodb_read_ahead_threshold=0","title":"\u751f\u4ea7\u73af\u5883"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/","text":"Linux\u7cfb\u306e\u30d3\u30eb\u30c9\u30aa\u30d7\u30b7\u30e7\u30f3 \u00b6 MySQL5.6 \u00b6 $ cat build-mysql5.6.sh export CC=\"cc\" export CXX=\"c++\" export CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\" export CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions\" #export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\" cmake \\ -DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.6\" \\ -DINSTALL_DOCDIR=\"share/doc/mysql\" \\ -DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\ -DINSTALL_INCLUDEDIR=\"include/mysql\" \\ -DINSTALL_INFODIR=\"info\" \\ -DINSTALL_LIBDIR=\"lib/mysql\" \\ -DINSTALL_MANDIR=\"man\" \\ -DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\ -DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\ -DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\ -DINSTALL_SBINDIR=\"libexec\" \\ -DINSTALL_SCRIPTDIR=\"bin\" \\ -DINSTALL_SHAREDIR=\"share\" \\ -DINSTALL_SQLBENCHDIR=\"share/mysql\" \\ -DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\ -DWITH_UNIT_TESTS=0 \\ -DWITH_SSL=system \\ -DWITH_READLINE=1 \\ -DWITH_LIBWRAP=0 \\ -DWITHOUT_SERVER=1 \\ -DWITH_EMBEDDED_SERVER=\"ON\" make make install MySQL5.5 \u00b6 $ cat build-mysql5.5.sh export CC=\"cc\" export CXX=\"c++\" export CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\" export CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions -fpermissive \" #export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\" cmake \\ -DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.5\" \\ -DINSTALL_DOCDIR=\"share/doc/mysql\" \\ -DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\ -DINSTALL_INCLUDEDIR=\"include/mysql\" \\ -DINSTALL_INFODIR=\"info\" \\ -DINSTALL_LIBDIR=\"lib/mysql\" \\ -DINSTALL_MANDIR=\"man\" \\ -DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\ -DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\ -DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\ -DINSTALL_SBINDIR=\"libexec\" \\ -DINSTALL_SCRIPTDIR=\"bin\" \\ -DINSTALL_SHAREDIR=\"share\" \\ -DINSTALL_SQLBENCHDIR=\"share/mysql\" \\ -DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\ -DWITH_UNIT_TESTS=0 \\ -DWITH_SSL=system \\ -DWITH_READLINE=1 \\ -DWITH_LIBWRAP=0 \\ -DWITHOUT_SERVER=0 \\ -DWITH_EMBEDDED_SERVER=\"ON\" make make install FreeBSD\u7cfb\u306e\u30d3\u30eb\u30c9\u30aa\u30d7\u30b7\u30e7\u30f3 \u00b6 MySQL5.6 \u00b6 export CC=\"cc\" export CXX=\"c++\" export CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\" #export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\" export CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions\" cmake \\ -DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.6\" \\ -DINSTALL_DOCDIR=\"share/doc/mysql\" \\ -DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\ -DINSTALL_INCLUDEDIR=\"include/mysql\" \\ -DINSTALL_INFODIR=\"info\" \\ -DINSTALL_LIBDIR=\"lib/mysql\" \\ -DINSTALL_MANDIR=\"man\" \\ -DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\ -DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\ -DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\ -DINSTALL_SBINDIR=\"libexec\" \\ -DINSTALL_SCRIPTDIR=\"bin\" \\ -DINSTALL_SHAREDIR=\"share\" \\ -DINSTALL_SQLBENCHDIR=\"share/mysql\" \\ -DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\ -DWITH_UNIT_TESTS=0 \\ -DWITH_SSL=system \\ -DWITH_READLINE=1 \\ -DWITH_LIBWRAP=0 \\ -DWITHOUT_SERVER=1 \\ -DWITH_EMBEDDED_SERVER=\"ON\" make make install MySQL5.5 \u00b6 $ cat mysql-5.5.61/build-mysql5.5.sh export CC=\"cc\" export CXX=\"c++\" export CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\" export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions -fpermissive\" #export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\" #export CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions -fpermissive\" cmake \\ -DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.5\" \\ -DINSTALL_DOCDIR=\"share/doc/mysql\" \\ -DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\ -DINSTALL_INCLUDEDIR=\"include/mysql\" \\ -DINSTALL_INFODIR=\"info\" \\ -DINSTALL_LIBDIR=\"lib/mysql\" \\ -DINSTALL_MANDIR=\"man\" \\ -DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\ -DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\ -DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\ -DINSTALL_SBINDIR=\"libexec\" \\ -DINSTALL_SCRIPTDIR=\"bin\" \\ -DINSTALL_SHAREDIR=\"share\" \\ -DINSTALL_SQLBENCHDIR=\"share/mysql\" \\ -DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\ -DWITH_UNIT_TESTS=0 \\ -DWITH_SSL=system \\ -DWITH_READLINE=1 \\ -DWITH_LIBWRAP=0 \\ -DWITHOUT_SERVER=0 \\ -DWITHOUT_PARTITION_STORAGE_ENGINE=1 \\ -DWITH_EMBEDDED_SERVER=\"ON\" make make install","title":"MySQL\u30d3\u30eb\u30c9"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#linux","text":"","title":"Linux\u7cfb\u306e\u30d3\u30eb\u30c9\u30aa\u30d7\u30b7\u30e7\u30f3"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#mysql56","text":"$ cat build-mysql5.6.sh export CC=\"cc\" export CXX=\"c++\" export CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\" export CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions\" #export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\" cmake \\ -DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.6\" \\ -DINSTALL_DOCDIR=\"share/doc/mysql\" \\ -DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\ -DINSTALL_INCLUDEDIR=\"include/mysql\" \\ -DINSTALL_INFODIR=\"info\" \\ -DINSTALL_LIBDIR=\"lib/mysql\" \\ -DINSTALL_MANDIR=\"man\" \\ -DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\ -DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\ -DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\ -DINSTALL_SBINDIR=\"libexec\" \\ -DINSTALL_SCRIPTDIR=\"bin\" \\ -DINSTALL_SHAREDIR=\"share\" \\ -DINSTALL_SQLBENCHDIR=\"share/mysql\" \\ -DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\ -DWITH_UNIT_TESTS=0 \\ -DWITH_SSL=system \\ -DWITH_READLINE=1 \\ -DWITH_LIBWRAP=0 \\ -DWITHOUT_SERVER=1 \\ -DWITH_EMBEDDED_SERVER=\"ON\" make make install","title":"MySQL5.6"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#mysql55","text":"$ cat build-mysql5.5.sh export CC=\"cc\" export CXX=\"c++\" export CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\" export CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions -fpermissive \" #export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\" cmake \\ -DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.5\" \\ -DINSTALL_DOCDIR=\"share/doc/mysql\" \\ -DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\ -DINSTALL_INCLUDEDIR=\"include/mysql\" \\ -DINSTALL_INFODIR=\"info\" \\ -DINSTALL_LIBDIR=\"lib/mysql\" \\ -DINSTALL_MANDIR=\"man\" \\ -DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\ -DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\ -DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\ -DINSTALL_SBINDIR=\"libexec\" \\ -DINSTALL_SCRIPTDIR=\"bin\" \\ -DINSTALL_SHAREDIR=\"share\" \\ -DINSTALL_SQLBENCHDIR=\"share/mysql\" \\ -DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\ -DWITH_UNIT_TESTS=0 \\ -DWITH_SSL=system \\ -DWITH_READLINE=1 \\ -DWITH_LIBWRAP=0 \\ -DWITHOUT_SERVER=0 \\ -DWITH_EMBEDDED_SERVER=\"ON\" make make install","title":"MySQL5.5"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#freebsd","text":"","title":"FreeBSD\u7cfb\u306e\u30d3\u30eb\u30c9\u30aa\u30d7\u30b7\u30e7\u30f3"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#mysql56_1","text":"export CC=\"cc\" export CXX=\"c++\" export CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\" #export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\" export CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions\" cmake \\ -DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.6\" \\ -DINSTALL_DOCDIR=\"share/doc/mysql\" \\ -DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\ -DINSTALL_INCLUDEDIR=\"include/mysql\" \\ -DINSTALL_INFODIR=\"info\" \\ -DINSTALL_LIBDIR=\"lib/mysql\" \\ -DINSTALL_MANDIR=\"man\" \\ -DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\ -DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\ -DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\ -DINSTALL_SBINDIR=\"libexec\" \\ -DINSTALL_SCRIPTDIR=\"bin\" \\ -DINSTALL_SHAREDIR=\"share\" \\ -DINSTALL_SQLBENCHDIR=\"share/mysql\" \\ -DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\ -DWITH_UNIT_TESTS=0 \\ -DWITH_SSL=system \\ -DWITH_READLINE=1 \\ -DWITH_LIBWRAP=0 \\ -DWITHOUT_SERVER=1 \\ -DWITH_EMBEDDED_SERVER=\"ON\" make make install","title":"MySQL5.6"},{"location":"mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/#mysql55_1","text":"$ cat mysql-5.5.61/build-mysql5.5.sh export CC=\"cc\" export CXX=\"c++\" export CFLAGS=\"-O2 -fPIC -fno-omit-frame-pointer\" export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions -fpermissive\" #export CXXFLAGS=\"${CFLAGS} -Wno-c++11-narrowing -felide-constructors -fno-rtti -fno-exceptions\" #export CXXFLAGS=\"${CFLAGS} -Wno-narrowing -felide-constructors -fno-rtti -fexceptions -fpermissive\" cmake \\ -DCMAKE_INSTALL_PREFIX=\"/home/USER/myetc/mysql/5.5\" \\ -DINSTALL_DOCDIR=\"share/doc/mysql\" \\ -DINSTALL_DOCREADMEDIR=\"share/doc/mysql\" \\ -DINSTALL_INCLUDEDIR=\"include/mysql\" \\ -DINSTALL_INFODIR=\"info\" \\ -DINSTALL_LIBDIR=\"lib/mysql\" \\ -DINSTALL_MANDIR=\"man\" \\ -DINSTALL_MYSQLSHAREDIR=\"share/mysql\" \\ -DINSTALL_MYSQLTESTDIR=\"share/mysql/tests\" \\ -DINSTALL_PLUGINDIR=\"lib/mysql/plugin\" \\ -DINSTALL_SBINDIR=\"libexec\" \\ -DINSTALL_SCRIPTDIR=\"bin\" \\ -DINSTALL_SHAREDIR=\"share\" \\ -DINSTALL_SQLBENCHDIR=\"share/mysql\" \\ -DINSTALL_SUPPORTFILESDIR=\"share/mysql\" \\ -DWITH_UNIT_TESTS=0 \\ -DWITH_SSL=system \\ -DWITH_READLINE=1 \\ -DWITH_LIBWRAP=0 \\ -DWITHOUT_SERVER=0 \\ -DWITHOUT_PARTITION_STORAGE_ENGINE=1 \\ -DWITH_EMBEDDED_SERVER=\"ON\" make make install","title":"MySQL5.5"},{"location":"python-config/","text":"Python \u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u7ba1\u7406\u7684\u6700\u4f73\u5de5\u7a0b\u5b9e\u8df5 \u00b6 https://cloud.tencent.com/developer/beta/article/2269479 \u6700\u8fd1\u5728\u7ed3\u5408 Python-3.12.0a6 \u7248\u672c\u5f00\u53d1\u4e00\u4e2a\u591a\u7ebf\u7a0b\u67b6\u6784\u7684\u540e\u53f0\u670d\u52a1\uff1b\u670d\u52a1\u542f\u52a8\u65f6\u4f1a\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u4e14\u8981\u6c42\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u540c\u4e00\u4efd\u914d\u7f6e\u3002 \u670d\u52a1\u672c\u8eab\u76f4\u63a5\u901a\u8fc7 http \u63a5\u53e3\u6765\u52a8\u6001\u8c03\u6574\u914d\u7f6e\u9879\u7684\u503c\uff0c\u8fd8\u8981\u505a\u5230\u670d\u52a1\u9000\u51fa\u4e4b\u540e\u6301\u4e45\u5316\u914d\u7f6e\u9879\u5230\u914d\u7f6e\u6587\u4ef6\u3002 \u4e00\u5f00\u59cb\u4ee5\u4e3a\u8fd9\u4e2a\u7528 Python \u5199\u4e5f\u4f1a\u8981\u7528\u51e0\u767e\u884c \uff0c\u6700\u540e\u53d1\u73b0\u5b8c\u6210\u6838\u5fc3\u529f\u80fd\u5c31\u53ea\u9700\u8981\u4e0d\u5230 50 \u884c\uff0cPython \u725b\u903c\uff01\uff01\uff01 \u9700\u6c42\u4e00\uff1a\u652f\u6301\u7b80\u5355\u7684\u914d\u7f6e\u9879 \u00b6 \u5047\u8bbe\u6211\u4eec\u76ee\u524d\u53ea\u652f\u6301 name \u548c port \u4e24\u4e2a\u914d\u7f6e\u9879\uff0c\u591a\u652f\u6301\u51e0\u4e2a\u4e0d\u96be\uff0c\u53ea\u662f\u4e0d\u65b9\u4fbf\u6f14\u793a\u3002 \"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406 \"\"\" from dataclasses import dataclass @dataclass class Config(object): name:str= \"mysql\" port:int = 3306 \u770b\u8d77\u6765\u662f\u6ca1\u95ee\u9898\u4e86\uff0c\u4e0b\u9762\u53ef\u4ee5\u8bd5\u7528\u4e00\u4e0b\uff0c\u4e5f\u987a\u5e26\u5f15\u5bfc\u51fa\u7b2c\u4e8c\u4e2a\u9700\u6c42\u3002 In [6]: a = Config() In [7]: b = Config() In [8]: id(a) Out[8]: 4407850896 In [9]: id(b) Out[9]: 4407852496 \u53ef\u4ee5\u770b\u5230\u4e24\u4e2a\u914d\u7f6e\u5bf9\u8c61\u7684 ID \u503c\u4e0d\u4e00\u6837\u3002\u7531\u4e8e\u914d\u7f6e\u6587\u4ef6\u53ea\u6709\u4e00\u4e2a\uff0c\u6211\u4eec\u5e0c\u671b\u914d\u7f6e\u5bf9\u8c61\u4e5f\u53ea\u6709\u4e00\u4e2a\u3002 \u9700\u6c42\u4e8c\uff1a\u914d\u7f6e\u5bf9\u8c61\u5168\u5c40\u552f\u4e00 \u00b6 \u4ea4\u4ee3\u4e00\u4e2a\u80cc\u666f\uff0c\u89e3\u91ca\u5668\u5728\u505a import \u7684\u65f6\u5019\u662f\u5355\u4e00\u7ebf\u7a0b\u5728\u8dd1\u7684\u3002\u6709\u4e86\u8fd9\u4e2a\u524d\u63d0\u6211\u4eec\u53ef\u4ee5\u5c11\u5199\u4e00\u4e9b\u52a0\u9501\u7684\u4ee3\u7801\uff0c\u80fd\u5c11\u5199\u4e00\u884c\u7b97\u4e00\u884c\u5427\u3002 \"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406 \"\"\" from dataclasses import dataclass @dataclass class Config(object): name:str= \"mysql\" port:int = 3306 _instance = None # \u5355\u4f8b\u6a21\u5f0f def __new__(cls, *args, **kw): if cls._instance is None: cls._instance = object.__new__(cls, *args, **kw) return cls._instance \u7528 Python \u5c31\u662f\u8fd9\u4e48\u7684\u7b80\u5355\uff0c\u51e0\u884c\u4ee3\u7801\u5c31\u641e\u5b9a\u4e86\u3002\u4f46\u662f\u8fd8\u662f\u8981\u6d4b\u8bd5\u4e00\u4e0b\u987a\u5e26\u5f15\u5bfc\u51fa\u4e0b\u4e00\u4e2a\u9700\u6c42\u3002 In [4]: a = Config() In [5]: b = Config() In [6]: id(a) Out[6]: 4414751568 In [7]: id(b) Out[7]: 4414751568 \u73b0\u5728\u914d\u7f6e\u5bf9\u8c61\u5df2\u7ecf\u662f\u5355\u4f8b\u4e86\uff0c\u4f46\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5b83\u7684\u6bcf\u4e2a\u914d\u7f6e\u9879\u7684\u503c\u90fd\u662f\u9ed8\u8ba4\u503c\uff0c\u6211\u4eec\u5f53\u7136\u662f\u5e0c\u671b\u5b83\u5728\u521b\u5efa\u5bf9\u8c61\u7684\u65f6\u5019\u662f\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\u5566\u3002\u4e0b\u9762\u770b\u9700\u6c42\u4e09\u600e\u4e48\u5b9e\u73b0 \u9700\u6c42\u4e09\uff1a\u6839\u636e\u914d\u7f6e\u6587\u4ef6\u6784\u9020\u914d\u7f6e\u5bf9\u8c61 \u00b6 \u5047\u8bbe\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u88ab \u201c\u6301\u4e45\u5316\u201d \u5230\u4e86 /tmp/config.json \uff0c\u73b0\u5728\u5c31\u53ef\u4ee5\u5199\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u5e76\u66f4\u65b0\u914d\u7f6e\u5bf9\u8c61\u503c\u7684\u4ee3\u7801\u4e86\u3002 \"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406 \"\"\" import json import logging from pathlib import Path from dataclasses import dataclass @dataclass class Config(object): name:str= \"mysql\" port:int = 3306 _instance = None # \u5355\u4f8b\u6a21\u5f0f def __new__(cls, *args, **kw): if cls._instance is None: cls._instance = object.__new__(cls, *args, **kw) return cls._instance # \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6 def __post_init__(self): \"\"\"\u5982\u679c\u914d\u7f6e\u6587\u4ef6\u5b58\u5728\u5c31\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\uff0c\u8986\u76d6\u9ed8\u8ba4\u503c\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5982\u679c\u9047\u5230\u5f02\u5e38\u5c31\u4fdd\u6301\u9ed8\u8ba4\u503c \"\"\" if (config_file:=Path(\"/tmp/config.json\")) and config_file.exists(): try: with open(config_file) as f: json_data = json.loads(f.read()) self.__dict__.update(json_data) except Exception as err: pass else: logging.warn(\"config file '{}' not exists. well using defautl values .\".format(config_file)) \u5047\u8bbe\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9\u662f\u8fd9\u6837\u7684\u3002 cat /tmp/config.json { \"name\": \"trump\", \"port\": 8848 } \u4e0b\u9762\u7684\u6d4b\u8bd5\u4e00\u4e0b In [2]: a = Config() In [3]: a Out[3]: Config(name='trump', port=8848) In [4]: b = Config() In [5]: b Out[5]: Config(name='trump', port=8848) In [6]: a == b Out[6]: True \u53ef\u4ee5\u770b\u5230 name \u548c port \u5df2\u7ecf\u6ca1\u6709\u4f7f\u7528\u9ed8\u8ba4\u7684 \"mysql\" \u548c 3306 \u4e86\uff0c\u800c\u662f\u4f7f\u7528\u4e86\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\u3002 \u5230\u8fd9\u91cc\u6211\u4eec\u53ea\u5269\u4e0b\u6700\u540e\u4e00\u4e2a\u9700\u6c42\uff0c\u5c31\u662f\u5728\u7a0b\u5e8f\u9000\u51fa\u7684\u65f6\u5019\uff0c\u628a\u914d\u7f6e\u5bf9\u8c61\u7684\u503c\u66f4\u65b0\u56de\u914d\u7f6e\u6587\u4ef6\u3002\u8fd9\u4e2a\u5c31\u770b\u9700\u6c42\u56db\u600e\u4e48\u5199\u3002 \u9700\u6c42\u56db\uff1a\u7a0b\u5e8f\u9000\u51fa\u524d\u81ea\u52a8\u6301\u4e45\u5316\u914d\u7f6e\u5bf9\u8c61\u5230\u914d\u7f6e\u6587\u4ef6 \u00b6 \u89e3\u91ca\u5668\u5728\u9000\u51fa\u524d\u6709\u4e2a\u94a9\u5b50(atexit)\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u91cc\u6307\u5b9a\u56de\u8c03\u51fd\u6570\uff0c\u8fd9\u4e2a\u65f6\u5019\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6\u518d\u9002\u5408\u4e0d\u8fc7\u3002 \"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406 \"\"\" import json import atexit import logging from pathlib import Path from dataclasses import dataclass, asdict @dataclass class Config(object): name:str= \"mysql\" port:int = 3306 _instance = None # \u5355\u4f8b\u6a21\u5f0f def __new__(cls, *args, **kw): if cls._instance is None: cls._instance = object.__new__(cls, *args, **kw) return cls._instance # \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6 def __post_init__(self): \"\"\"\u5982\u679c\u914d\u7f6e\u6587\u4ef6\u5b58\u5728\u5c31\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\uff0c\u8986\u76d6\u9ed8\u8ba4\u503c\uff1b\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5982\u679c\u9047\u5230\u5f02\u5e38\u5c31\u4fdd\u6301\u9ed8\u8ba4\u503c\u3002\u7a0b\u5e8f\u9000\u51fa\u65f6\u6301\u4e45\u5230\u5230\u914d\u7f6e\u5230\u6587\u4ef6\u3002 \"\"\" if (config_file:=Path(\"/tmp/config.json\")) and config_file.exists(): try: with open(config_file) as f: json_data = json.loads(f.read()) self.__dict__.update(json_data) except Exception as err: pass else: logging.warn(\"config file '{}' not exists. well using defautl values .\".format(config_file)) # \u7a0b\u5e8f\u9000\u51fa\u65f6\u4fdd\u5b58\u914d\u7f6e\u5230\u914d\u7f6e\u6587\u4ef6 /tmp/config.json def sync_to_disk(): \"\"\" \"\"\" json_str = json.dumps(asdict(self), indent=4) with open(config_file, 'w') as f: logging.warning(\"save configs to '{}' \".format(config_file)) f.write(json_str) atexit.register(sync_to_disk) \u9a8c\u8bc1\u4e00\u4e0b In [1]: from appconfig import Config In [2]: a = Config() In [3]: a.name Out[3]: 'trump' In [4]: a.name = \"hello-world\" In [5]: exit() WARNING:root:save configs to '/tmp/config.json' \u770b\u65e5\u5fd7\u662f\u5df2\u7ecf\u628a\u914d\u7f6e\u9879\u66f4\u65b0\u56de\u914d\u7f6e\u6587\u4ef6\u4e86\uff0c\u4f46\u662f\u8fd8\u662f cat \u786e\u8ba4\u4e00\u4e0b\u4e3a\u597d\u3002 cat /tmp/config.json { \"name\": \"hello-world\", \"port\": 8848 } \u53ef\u4ee5\u770b\u5230\u786e\u5b9e\u5df2\u7ecf\u628a\u914d\u7f6e\u9879\u7684\u503c\u66f4\u65b0\u5230\u6587\u4ef6\u4e86\u3002","title":"Python\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u7ba1\u7406"},{"location":"python-config/#python","text":"https://cloud.tencent.com/developer/beta/article/2269479 \u6700\u8fd1\u5728\u7ed3\u5408 Python-3.12.0a6 \u7248\u672c\u5f00\u53d1\u4e00\u4e2a\u591a\u7ebf\u7a0b\u67b6\u6784\u7684\u540e\u53f0\u670d\u52a1\uff1b\u670d\u52a1\u542f\u52a8\u65f6\u4f1a\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u4e14\u8981\u6c42\u6240\u6709\u7ebf\u7a0b\u5171\u4eab\u540c\u4e00\u4efd\u914d\u7f6e\u3002 \u670d\u52a1\u672c\u8eab\u76f4\u63a5\u901a\u8fc7 http \u63a5\u53e3\u6765\u52a8\u6001\u8c03\u6574\u914d\u7f6e\u9879\u7684\u503c\uff0c\u8fd8\u8981\u505a\u5230\u670d\u52a1\u9000\u51fa\u4e4b\u540e\u6301\u4e45\u5316\u914d\u7f6e\u9879\u5230\u914d\u7f6e\u6587\u4ef6\u3002 \u4e00\u5f00\u59cb\u4ee5\u4e3a\u8fd9\u4e2a\u7528 Python \u5199\u4e5f\u4f1a\u8981\u7528\u51e0\u767e\u884c \uff0c\u6700\u540e\u53d1\u73b0\u5b8c\u6210\u6838\u5fc3\u529f\u80fd\u5c31\u53ea\u9700\u8981\u4e0d\u5230 50 \u884c\uff0cPython \u725b\u903c\uff01\uff01\uff01","title":"Python \u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u7ba1\u7406\u7684\u6700\u4f73\u5de5\u7a0b\u5b9e\u8df5"},{"location":"python-config/#_1","text":"\u5047\u8bbe\u6211\u4eec\u76ee\u524d\u53ea\u652f\u6301 name \u548c port \u4e24\u4e2a\u914d\u7f6e\u9879\uff0c\u591a\u652f\u6301\u51e0\u4e2a\u4e0d\u96be\uff0c\u53ea\u662f\u4e0d\u65b9\u4fbf\u6f14\u793a\u3002 \"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406 \"\"\" from dataclasses import dataclass @dataclass class Config(object): name:str= \"mysql\" port:int = 3306 \u770b\u8d77\u6765\u662f\u6ca1\u95ee\u9898\u4e86\uff0c\u4e0b\u9762\u53ef\u4ee5\u8bd5\u7528\u4e00\u4e0b\uff0c\u4e5f\u987a\u5e26\u5f15\u5bfc\u51fa\u7b2c\u4e8c\u4e2a\u9700\u6c42\u3002 In [6]: a = Config() In [7]: b = Config() In [8]: id(a) Out[8]: 4407850896 In [9]: id(b) Out[9]: 4407852496 \u53ef\u4ee5\u770b\u5230\u4e24\u4e2a\u914d\u7f6e\u5bf9\u8c61\u7684 ID \u503c\u4e0d\u4e00\u6837\u3002\u7531\u4e8e\u914d\u7f6e\u6587\u4ef6\u53ea\u6709\u4e00\u4e2a\uff0c\u6211\u4eec\u5e0c\u671b\u914d\u7f6e\u5bf9\u8c61\u4e5f\u53ea\u6709\u4e00\u4e2a\u3002","title":"\u9700\u6c42\u4e00\uff1a\u652f\u6301\u7b80\u5355\u7684\u914d\u7f6e\u9879"},{"location":"python-config/#_2","text":"\u4ea4\u4ee3\u4e00\u4e2a\u80cc\u666f\uff0c\u89e3\u91ca\u5668\u5728\u505a import \u7684\u65f6\u5019\u662f\u5355\u4e00\u7ebf\u7a0b\u5728\u8dd1\u7684\u3002\u6709\u4e86\u8fd9\u4e2a\u524d\u63d0\u6211\u4eec\u53ef\u4ee5\u5c11\u5199\u4e00\u4e9b\u52a0\u9501\u7684\u4ee3\u7801\uff0c\u80fd\u5c11\u5199\u4e00\u884c\u7b97\u4e00\u884c\u5427\u3002 \"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406 \"\"\" from dataclasses import dataclass @dataclass class Config(object): name:str= \"mysql\" port:int = 3306 _instance = None # \u5355\u4f8b\u6a21\u5f0f def __new__(cls, *args, **kw): if cls._instance is None: cls._instance = object.__new__(cls, *args, **kw) return cls._instance \u7528 Python \u5c31\u662f\u8fd9\u4e48\u7684\u7b80\u5355\uff0c\u51e0\u884c\u4ee3\u7801\u5c31\u641e\u5b9a\u4e86\u3002\u4f46\u662f\u8fd8\u662f\u8981\u6d4b\u8bd5\u4e00\u4e0b\u987a\u5e26\u5f15\u5bfc\u51fa\u4e0b\u4e00\u4e2a\u9700\u6c42\u3002 In [4]: a = Config() In [5]: b = Config() In [6]: id(a) Out[6]: 4414751568 In [7]: id(b) Out[7]: 4414751568 \u73b0\u5728\u914d\u7f6e\u5bf9\u8c61\u5df2\u7ecf\u662f\u5355\u4f8b\u4e86\uff0c\u4f46\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5b83\u7684\u6bcf\u4e2a\u914d\u7f6e\u9879\u7684\u503c\u90fd\u662f\u9ed8\u8ba4\u503c\uff0c\u6211\u4eec\u5f53\u7136\u662f\u5e0c\u671b\u5b83\u5728\u521b\u5efa\u5bf9\u8c61\u7684\u65f6\u5019\u662f\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\u5566\u3002\u4e0b\u9762\u770b\u9700\u6c42\u4e09\u600e\u4e48\u5b9e\u73b0","title":"\u9700\u6c42\u4e8c\uff1a\u914d\u7f6e\u5bf9\u8c61\u5168\u5c40\u552f\u4e00"},{"location":"python-config/#_3","text":"\u5047\u8bbe\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u88ab \u201c\u6301\u4e45\u5316\u201d \u5230\u4e86 /tmp/config.json \uff0c\u73b0\u5728\u5c31\u53ef\u4ee5\u5199\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u5e76\u66f4\u65b0\u914d\u7f6e\u5bf9\u8c61\u503c\u7684\u4ee3\u7801\u4e86\u3002 \"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406 \"\"\" import json import logging from pathlib import Path from dataclasses import dataclass @dataclass class Config(object): name:str= \"mysql\" port:int = 3306 _instance = None # \u5355\u4f8b\u6a21\u5f0f def __new__(cls, *args, **kw): if cls._instance is None: cls._instance = object.__new__(cls, *args, **kw) return cls._instance # \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6 def __post_init__(self): \"\"\"\u5982\u679c\u914d\u7f6e\u6587\u4ef6\u5b58\u5728\u5c31\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\uff0c\u8986\u76d6\u9ed8\u8ba4\u503c\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5982\u679c\u9047\u5230\u5f02\u5e38\u5c31\u4fdd\u6301\u9ed8\u8ba4\u503c \"\"\" if (config_file:=Path(\"/tmp/config.json\")) and config_file.exists(): try: with open(config_file) as f: json_data = json.loads(f.read()) self.__dict__.update(json_data) except Exception as err: pass else: logging.warn(\"config file '{}' not exists. well using defautl values .\".format(config_file)) \u5047\u8bbe\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9\u662f\u8fd9\u6837\u7684\u3002 cat /tmp/config.json { \"name\": \"trump\", \"port\": 8848 } \u4e0b\u9762\u7684\u6d4b\u8bd5\u4e00\u4e0b In [2]: a = Config() In [3]: a Out[3]: Config(name='trump', port=8848) In [4]: b = Config() In [5]: b Out[5]: Config(name='trump', port=8848) In [6]: a == b Out[6]: True \u53ef\u4ee5\u770b\u5230 name \u548c port \u5df2\u7ecf\u6ca1\u6709\u4f7f\u7528\u9ed8\u8ba4\u7684 \"mysql\" \u548c 3306 \u4e86\uff0c\u800c\u662f\u4f7f\u7528\u4e86\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\u3002 \u5230\u8fd9\u91cc\u6211\u4eec\u53ea\u5269\u4e0b\u6700\u540e\u4e00\u4e2a\u9700\u6c42\uff0c\u5c31\u662f\u5728\u7a0b\u5e8f\u9000\u51fa\u7684\u65f6\u5019\uff0c\u628a\u914d\u7f6e\u5bf9\u8c61\u7684\u503c\u66f4\u65b0\u56de\u914d\u7f6e\u6587\u4ef6\u3002\u8fd9\u4e2a\u5c31\u770b\u9700\u6c42\u56db\u600e\u4e48\u5199\u3002","title":"\u9700\u6c42\u4e09\uff1a\u6839\u636e\u914d\u7f6e\u6587\u4ef6\u6784\u9020\u914d\u7f6e\u5bf9\u8c61"},{"location":"python-config/#_4","text":"\u89e3\u91ca\u5668\u5728\u9000\u51fa\u524d\u6709\u4e2a\u94a9\u5b50(atexit)\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u91cc\u6307\u5b9a\u56de\u8c03\u51fd\u6570\uff0c\u8fd9\u4e2a\u65f6\u5019\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6\u518d\u9002\u5408\u4e0d\u8fc7\u3002 \"\"\"\u5b9e\u4f8b\u914d\u7f6e\u7ba1\u7406 \"\"\" import json import atexit import logging from pathlib import Path from dataclasses import dataclass, asdict @dataclass class Config(object): name:str= \"mysql\" port:int = 3306 _instance = None # \u5355\u4f8b\u6a21\u5f0f def __new__(cls, *args, **kw): if cls._instance is None: cls._instance = object.__new__(cls, *args, **kw) return cls._instance # \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6 def __post_init__(self): \"\"\"\u5982\u679c\u914d\u7f6e\u6587\u4ef6\u5b58\u5728\u5c31\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\uff0c\u8986\u76d6\u9ed8\u8ba4\u503c\uff1b\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u5982\u679c\u9047\u5230\u5f02\u5e38\u5c31\u4fdd\u6301\u9ed8\u8ba4\u503c\u3002\u7a0b\u5e8f\u9000\u51fa\u65f6\u6301\u4e45\u5230\u5230\u914d\u7f6e\u5230\u6587\u4ef6\u3002 \"\"\" if (config_file:=Path(\"/tmp/config.json\")) and config_file.exists(): try: with open(config_file) as f: json_data = json.loads(f.read()) self.__dict__.update(json_data) except Exception as err: pass else: logging.warn(\"config file '{}' not exists. well using defautl values .\".format(config_file)) # \u7a0b\u5e8f\u9000\u51fa\u65f6\u4fdd\u5b58\u914d\u7f6e\u5230\u914d\u7f6e\u6587\u4ef6 /tmp/config.json def sync_to_disk(): \"\"\" \"\"\" json_str = json.dumps(asdict(self), indent=4) with open(config_file, 'w') as f: logging.warning(\"save configs to '{}' \".format(config_file)) f.write(json_str) atexit.register(sync_to_disk) \u9a8c\u8bc1\u4e00\u4e0b In [1]: from appconfig import Config In [2]: a = Config() In [3]: a.name Out[3]: 'trump' In [4]: a.name = \"hello-world\" In [5]: exit() WARNING:root:save configs to '/tmp/config.json' \u770b\u65e5\u5fd7\u662f\u5df2\u7ecf\u628a\u914d\u7f6e\u9879\u66f4\u65b0\u56de\u914d\u7f6e\u6587\u4ef6\u4e86\uff0c\u4f46\u662f\u8fd8\u662f cat \u786e\u8ba4\u4e00\u4e0b\u4e3a\u597d\u3002 cat /tmp/config.json { \"name\": \"hello-world\", \"port\": 8848 } \u53ef\u4ee5\u770b\u5230\u786e\u5b9e\u5df2\u7ecf\u628a\u914d\u7f6e\u9879\u7684\u503c\u66f4\u65b0\u5230\u6587\u4ef6\u4e86\u3002","title":"\u9700\u6c42\u56db\uff1a\u7a0b\u5e8f\u9000\u51fa\u524d\u81ea\u52a8\u6301\u4e45\u5316\u914d\u7f6e\u5bf9\u8c61\u5230\u914d\u7f6e\u6587\u4ef6"},{"location":"python-decorator/","text":"\u88c5\u9970\u5668\u662f\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684 Python \u6982\u5ff5\uff0c\u53ef\u80fd\u7b97\u662f\u8fdb\u9636\u7684\u4e00\u5927\u95e8\u69db\u3002\u672c\u6587\u6bd4\u8f83\u5168\u9762\u5730\u5bf9\u88c5\u9970\u5668\u8fdb\u884c\u4e86\u4ecb\u7ecd\uff0c\u5e76\u4e14\u914d\u5907\u4e86\u8be6\u7ec6\u7684\u4ee3\u7801\u793a\u4f8b\uff0c\u63a8\u8350\u9605\u8bfb\u3002 \u4f5c\u8005\uff1aToby \u539f\u6587\uff1ahttps://betacat.online/posts/python-decorator/index.html Python \u4e2d\u7684\u88c5\u9970\u5668\u662f\u4f60\u8fdb\u5165 Python \u5927\u95e8\u7684\u4e00\u9053\u574e\uff0c\u4e0d\u7ba1\u4f60\u8de8\u4e0d\u8de8\u8fc7\u53bb\u5b83\u90fd\u5728\u90a3\u91cc\u3002 \u4e3a\u4ec0\u4e48\u9700\u8981\u88c5\u9970\u5668 \u00b6 \u6211\u4eec\u5047\u8bbe\u4f60\u7684\u7a0b\u5e8f\u5b9e\u73b0\u4e86 say_hello () \u548c say_goodbye () \u4e24\u4e2a\u51fd\u6570\u3002 def say_hello(): print \"hello!\" def say_goodbye(): print \"hello!\" # bug here if __name__ == '__main__': say_hello() say_goodbye() \u4f46\u662f\u5728\u5b9e\u9645\u8c03\u7528\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u7a0b\u5e8f\u51fa\u9519\u4e86\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u6253\u5370\u4e86\u4e24\u4e2a hello \u3002\u7ecf\u8fc7\u8c03\u8bd5\u4f60\u53d1\u73b0\u662f say_goodbye () \u51fa\u9519\u4e86\u3002\u8001\u677f\u8981\u6c42\u8c03\u7528\u6bcf\u4e2a\u65b9\u6cd5\u524d\u90fd\u8981\u8bb0\u5f55\u8fdb\u5165\u51fd\u6570\u7684\u65f6\u95f4\u548c\u540d\u79f0\uff0c\u6bd4\u5982\u8fd9\u6837\uff1a [DEBUG] 2016 - 10 - 27 11:11:11 - Enter say_hello() Hello! [DEBUG] 2016 - 10 - 27 11:11:11 - Enter say_goodbye() Goodbye! \u597d\uff0c\u5c0f A \u662f\u4e2a\u6bd5\u4e1a\u751f\uff0c\u4ed6\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\u3002 def say_hello(): print \"[DEBUG]: enter say_hello()\" print \"hello!\" def say_goodbye(): print \"[DEBUG]: enter say_goodbye()\" print \"hello!\" if __name__ == '__main__': say_hello() say_goodbye() \u5f88 low \u5427\uff1f \u55ef\u662f\u7684\u3002\u5c0f B \u5de5\u4f5c\u6709\u4e00\u6bb5\u65f6\u95f4\u4e86\uff0c\u4ed6\u544a\u8bc9\u5c0f A \u5e94\u8be5\u8fd9\u6837\u5199\u3002 def debug(): import inspect caller_name = inspect.stack()[1][3] print \"[DEBUG]: enter {}()\".format(caller_name) def say_hello(): debug() print \"hello!\" def say_goodbye(): debug() print \"goodbye!\" if __name__ == '__main__': say_hello() say_goodbye() \u662f\u4e0d\u662f\u597d\u4e00\u70b9\uff1f\u90a3\u5f53\u7136\uff0c\u4f46\u662f\u6bcf\u4e2a\u4e1a\u52a1\u51fd\u6570\u91cc\u90fd\u8981\u8c03\u7528\u4e00\u4e0b debug () \u51fd\u6570\uff0c\u662f\u4e0d\u662f\u5f88\u96be\u53d7\uff1f\u4e07\u4e00\u8001\u677f\u8bf4 say \u76f8\u5173\u7684\u51fd\u6570\u4e0d\u7528 debug \uff0c do \u76f8\u5173\u7684\u624d\u9700\u8981\u5462\uff1f \u90a3\u4e48\u88c5\u9970\u5668\u8fd9\u65f6\u5019\u5e94\u8be5\u767b\u573a\u4e86\u3002 \u88c5\u9970\u5668\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a Python \u51fd\u6570\uff0c\u5b83\u53ef\u4ee5\u8ba9\u5176\u4ed6\u51fd\u6570\u5728\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u4ee3\u7801\u53d8\u52a8\u7684\u524d\u63d0\u4e0b\u589e\u52a0\u989d\u5916\u529f\u80fd\uff0c\u88c5\u9970\u5668\u7684\u8fd4\u56de\u503c\u4e5f\u662f\u4e00\u4e2a\u51fd\u6570\u5bf9\u8c61\u3002\u5b83\u7ecf\u5e38\u7528\u4e8e\u6709\u5207\u9762\u9700\u6c42\u7684\u573a\u666f\uff0c\u6bd4\u5982\uff1a\u63d2\u5165\u65e5\u5fd7\u3001\u6027\u80fd\u6d4b\u8bd5\u3001\u4e8b\u52a1\u5904\u7406\u3001\u7f13\u5b58\u3001\u6743\u9650\u6821\u9a8c\u7b49\u573a\u666f\u3002\u88c5\u9970\u5668\u662f\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\u7684\u7edd\u4f73\u8bbe\u8ba1\uff0c\u6709\u4e86\u88c5\u9970\u5668\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u62bd\u79bb\u51fa\u5927\u91cf\u4e0e\u51fd\u6570\u529f\u80fd\u672c\u8eab\u65e0\u5173\u7684\u96f7\u540c\u4ee3\u7801\u5e76\u7ee7\u7eed\u91cd\u7528\u3002 \u6982\u62ec\u7684\u8bb2\uff0c\u88c5\u9970\u5668\u7684\u4f5c\u7528\u5c31\u662f \u4e3a\u5df2\u7ecf\u5b58\u5728\u7684\u51fd\u6570\u6216\u5bf9\u8c61\u6dfb\u52a0\u989d\u5916\u7684\u529f\u80fd\u3002 \u600e\u4e48\u5199\u4e00\u4e2a\u88c5\u9970\u5668 \u5728\u65e9\u4e9b\u65f6\u5019 (Python Version < 2.4\uff0c2004\u5e74\u4ee5\u524d)\uff0c\u4e3a\u4e00\u4e2a\u51fd\u6570\u6dfb\u52a0\u989d\u5916\u529f\u80fd\u7684\u5199\u6cd5\u662f\u8fd9\u6837\u7684\u3002 def debug(func): def wrapper(): print \"[DEBUG]: enter {}()\".format(func.__name__) return func() return wrapper def say_hello(): print \"hello!\" say_hello = debug(say_hello) # \u6dfb\u52a0\u529f\u80fd\u5e76\u4fdd\u6301\u539f\u51fd\u6570\u540d\u4e0d\u53d8 \u4e0a\u9762\u7684 debug \u51fd\u6570\u5176\u5b9e\u5df2\u7ecf\u662f\u4e00\u4e2a\u88c5\u9970\u5668\u4e86\uff0c\u5b83\u5bf9\u539f\u51fd\u6570\u505a\u4e86\u5305\u88c5\u5e76\u8fd4\u56de\u4e86\u53e6\u5916\u4e00\u4e2a\u51fd\u6570\uff0c\u989d\u5916\u6dfb\u52a0\u4e86\u4e00\u4e9b\u529f\u80fd\u3002\u56e0\u4e3a\u8fd9\u6837\u5199\u5b9e\u5728\u4e0d\u592a\u4f18\u96c5\uff0c\u4e0b\u9762\u4ee3\u7801\u7b49\u540c\u4e8e\u65e9\u671f\u7684\u5199\u6cd5\u3002 def debug(func): def wrapper(): print \"[DEBUG]: enter {}()\".format(func.__name__) return func() return wrapper @debug def say_hello(): print \"hello!\" \u8fd9\u662f\u6700\u7b80\u5355\u7684\u88c5\u9970\u5668\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u88ab\u88c5\u9970\u7684\u51fd\u6570\u9700\u8981\u4f20\u5165\u53c2\u6570\uff0c\u90a3\u4e48\u8fd9\u4e2a\u88c5\u9970\u5668\u5c31\u574f\u4e86\u3002\u56e0\u4e3a\u8fd4\u56de\u7684\u51fd\u6570\u5e76\u4e0d\u80fd\u63a5\u53d7\u53c2\u6570\uff0c\u4f60\u53ef\u4ee5\u6307\u5b9a\u88c5\u9970\u5668\u51fd\u6570 wrapper \u63a5\u53d7\u548c\u539f\u51fd\u6570\u4e00\u6837\u7684\u53c2\u6570\uff0c\u6bd4\u5982\uff1a def debug(func): def wrapper(something): # \u6307\u5b9a\u4e00\u6bdb\u4e00\u6837\u7684\u53c2\u6570 print \"[DEBUG]: enter {}()\".format(func.__name__) return func(something) return wrapper # \u8fd4\u56de\u5305\u88c5\u8fc7\u51fd\u6570 @debug def say(something): print \"hello {}!\".format(something) \u8fd9\u6837\u4f60\u5c31\u89e3\u51b3\u4e86\u4e00\u4e2a\u95ee\u9898\uff0c\u4f46\u53c8\u591a\u4e86 N \u4e2a\u95ee\u9898\u3002\u56e0\u4e3a\u51fd\u6570\u6709\u5343\u5343\u4e07\uff0c\u4f60\u53ea\u7ba1\u4f60\u81ea\u5df1\u7684\u51fd\u6570\uff0c\u522b\u4eba\u7684\u51fd\u6570\u53c2\u6570\u662f\u4ec0\u4e48\u6837\u5b50\uff0c\u9b3c\u77e5\u9053\uff1f\u8fd8\u597d Python \u63d0\u4f9b\u4e86\u53ef\u53d8\u53c2\u6570 * args \u548c\u5173\u952e\u5b57\u53c2\u6570 ** kwargs \uff0c\u6709\u4e86\u8fd9\u4e24\u4e2a\u53c2\u6570\uff0c\u88c5\u9970\u5668\u5c31\u53ef\u4ee5\u7528\u4e8e\u4efb\u610f\u76ee\u6807\u51fd\u6570\u4e86\u3002 def debug(func): def wrapper(*args, **kwargs): # \u6307\u5b9a\u5b87\u5b99\u65e0\u654c\u53c2\u6570 print \"[DEBUG]: enter {}()\".format(func.__name__) print 'Prepare and say...', return func(*args, **kwargs) return wrapper # \u8fd4\u56de @debug def say(something): print \"hello {}!\".format(something) \u81f3\u6b64\uff0c\u4f60\u5df2\u5b8c\u5168\u638c\u63e1\u521d\u7ea7\u7684\u88c5\u9970\u5668\u5199\u6cd5\u3002 \u9ad8\u7ea7\u4e00\u70b9\u7684\u88c5\u9970\u5668 \u00b6 \u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\u548c\u7c7b\u88c5\u9970\u5668\u5c5e\u4e8e\u8fdb\u9636\u7684\u5185\u5bb9\u3002\u5728\u7406\u89e3\u8fd9\u4e9b\u88c5\u9970\u5668\u4e4b\u524d\uff0c\u6700\u597d\u5bf9\u51fd\u6570\u7684\u95ed\u5305\u548c\u88c5\u9970\u5668\u7684\u63a5\u53e3\u7ea6\u5b9a\u6709\u4e00\u5b9a\u4e86\u89e3\u3002(\u53c2\u89c1http://betacat.online/posts/python- closure/) \u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668 \u00b6 \u5047\u8bbe\u6211\u4eec\u524d\u6587\u7684\u88c5\u9970\u5668\u9700\u8981\u5b8c\u6210\u7684\u529f\u80fd\u4e0d\u4ec5\u4ec5\u662f\u80fd\u5728\u8fdb\u5165\u67d0\u4e2a\u51fd\u6570\u540e\u6253\u51fa log \u4fe1\u606f\uff0c\u800c\u4e14\u8fd8\u9700\u6307\u5b9a log \u7684\u7ea7\u522b\uff0c\u90a3\u4e48\u88c5\u9970\u5668\u5c31\u4f1a\u662f\u8fd9\u6837\u7684\u3002 def debug(func): def logging(level): def wrapper(func): def inner_wrapper(*args, **kwargs): print \"[{level}]: enter function {func}()\".format( level=level, func=func.__name__) return func(*args, **kwargs) return inner_wrapper return wrapper @logging(level='INFO') def say(something): print \"say {}!\".format(something) @logging(level='DEBUG') def do(something): print \"do {}...\".format(something) if __name__ == '__main__': say('hello') do(\"my work\") \u662f\u4e0d\u662f\u6709\u4e00\u4e9b\u6655\uff1f\u4f60\u53ef\u4ee5\u8fd9\u4e48\u7406\u89e3\uff0c\u5f53\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\u88ab\u6253\u5728\u67d0\u4e2a\u51fd\u6570\u4e0a\u65f6\uff0c\u6bd4\u5982 @ logging ( level =' DEBUG ') \uff0c\u5b83\u5176\u5b9e\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u4f1a\u9a6c\u4e0a\u88ab\u6267\u884c\uff0c\u53ea\u8981\u8fd9\u4e2a\u5b83\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u88c5\u9970\u5668\u65f6\uff0c\u90a3\u5c31\u6ca1\u95ee\u9898\u3002\u7ec6\u7ec6\u518d\u4f53\u4f1a\u4e00\u4e0b\u3002 \u57fa\u4e8e\u7c7b\u5b9e\u73b0\u7684\u88c5\u9970\u5668 \u00b6 \u88c5\u9970\u5668\u51fd\u6570\u5176\u5b9e\u662f\u8fd9\u6837\u4e00\u4e2a\u63a5\u53e3\u7ea6\u675f\uff0c\u5b83\u5fc5\u987b\u63a5\u53d7\u4e00\u4e2a callable \u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\uff0c\u7136\u540e\u8fd4\u56de\u4e00\u4e2a callable \u5bf9\u8c61\u3002\u5728 Python \u4e2d\u4e00\u822c callable \u5bf9\u8c61\u90fd\u662f\u51fd\u6570\uff0c\u4f46\u4e5f\u6709\u4f8b\u5916\u3002\u53ea\u8981\u67d0\u4e2a\u5bf9\u8c61\u91cd\u8f7d\u4e86 __call__ () \u65b9\u6cd5\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u662f callable \u7684\u3002 class Test(): def __call__(self): print 'call me!'t = Test() t() # call me \u50cf __call__ \u8fd9\u6837\u524d\u540e\u90fd\u5e26\u4e0b\u5212\u7ebf\u7684\u65b9\u6cd5\u5728 Python \u4e2d\u88ab\u79f0\u4e3a\u5185\u7f6e\u65b9\u6cd5\uff0c\u6709\u65f6\u5019\u4e5f\u88ab\u79f0\u4e3a\u9b54\u6cd5\u65b9\u6cd5\u3002\u91cd\u8f7d\u8fd9\u4e9b\u9b54\u6cd5\u65b9\u6cd5\u4e00\u822c\u4f1a\u6539\u53d8\u5bf9\u8c61\u7684\u5185\u90e8\u884c\u4e3a\u3002\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u5c31\u8ba9\u4e00\u4e2a\u7c7b\u5bf9\u8c61\u62e5\u6709\u4e86\u88ab\u8c03\u7528\u7684\u884c\u4e3a\u3002 \u56de\u5230\u88c5\u9970\u5668\u4e0a\u7684\u6982\u5ff5\u4e0a\u6765\uff0c\u88c5\u9970\u5668\u8981\u6c42\u63a5\u53d7\u4e00\u4e2a callable \u5bf9\u8c61\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a callable \u5bf9\u8c61\uff08\u4e0d\u592a\u4e25\u8c28\uff0c\u8be6\u89c1\u540e\u6587\uff09\u3002\u90a3\u4e48\u7528\u7c7b\u6765\u5b9e\u73b0\u4e5f\u662f\u4e5f\u53ef\u4ee5\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u8ba9\u7c7b\u7684\u6784\u9020\u51fd\u6570 __init__ () \u63a5\u53d7\u4e00\u4e2a\u51fd\u6570\uff0c\u7136\u540e\u91cd\u8f7d __call__ () \u5e76\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\uff0c\u4e5f\u53ef\u4ee5\u8fbe\u5230\u88c5\u9970\u5668\u51fd\u6570\u7684\u6548\u679c\u3002 class logging(object): def __init__(self, func): self.func = func def __call__(self, *args, **kwargs): print \"[DEBUG]: enter function {func}()\".format( func=self.func.__name__) return self.func(*args, **kwargs) @logging def say(something): print \"say {}!\".format(something) \u5e26\u53c2\u6570\u7684\u7c7b\u88c5\u9970\u5668 \u00b6 \u5982\u679c\u9700\u8981\u901a\u8fc7\u7c7b\u5f62\u5f0f\u5b9e\u73b0\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\uff0c\u90a3\u4e48\u4f1a\u6bd4\u524d\u9762\u7684\u4f8b\u5b50\u7a0d\u5fae\u590d\u6742\u4e00\u70b9\u3002\u90a3\u4e48\u5728\u6784\u9020\u51fd\u6570\u91cc\u63a5\u53d7\u7684\u5c31\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u800c\u662f\u4f20\u5165\u7684\u53c2\u6570\u3002\u901a\u8fc7\u7c7b\u628a\u8fd9\u4e9b\u53c2\u6570\u4fdd\u5b58\u8d77\u6765\u3002\u7136\u540e\u5728\u91cd\u8f7d __call__ \u65b9\u6cd5\u662f\u5c31\u9700\u8981\u63a5\u53d7\u4e00\u4e2a\u51fd\u6570\u5e76\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\u3002 class logging(object): def __init__(self, level='INFO'): self.level = level def __call__(self, func): # \u63a5\u53d7\u51fd\u6570 def wrapper(*args, **kwargs): print \"[{level}]: enter function {func}()\".format( level=self.level, func=func.__name__) func(*args, **kwargs) return wrapper # \u8fd4\u56de\u51fd\u6570 @logging(level='INFO') def say(something): print \"say {}!\".format(something) \u5185\u7f6e\u7684\u88c5\u9970\u5668 \u00b6 \u5185\u7f6e\u7684\u88c5\u9970\u5668\u548c\u666e\u901a\u7684\u88c5\u9970\u5668\u539f\u7406\u662f\u4e00\u6837\u7684\uff0c\u53ea\u4e0d\u8fc7\u8fd4\u56de\u7684\u4e0d\u662f\u51fd\u6570\uff0c\u800c\u662f\u7c7b\u5bf9\u8c61\uff0c\u6240\u4ee5\u66f4\u96be\u7406\u89e3\u4e00\u4e9b\u3002 @ property \u00b6 \u5728\u4e86\u89e3\u8fd9\u4e2a\u88c5\u9970\u5668\u524d\uff0c\u4f60\u9700\u8981\u77e5\u9053\u5728\u4e0d\u4f7f\u7528\u88c5\u9970\u5668\u600e\u4e48\u5199\u4e00\u4e2a\u5c5e\u6027\u3002 def getx(self): return self._x def setx(self, value): self._x = value def delx(self): del self._x# create a property x = property(getx, setx, delx, \"I am doc for x property\") \u4ee5\u4e0a\u5c31\u662f\u4e00\u4e2aPython\u5c5e\u6027\u7684\u6807\u51c6\u5199\u6cd5\uff0c\u5176\u5b9e\u548cJava\u633a\u50cf\u7684\uff0c\u80fd\u8fbe\u5230\u4e00\u6837\u7684\u6548\u679c\u4f46\u770b\u8d77\u6765\u66f4\u7b80\u5355\u3002 @property def x(self): ... # \u7b49\u540c\u4e8e def x(self): ... x = property(x) \u5c5e\u6027\u6709\u4e09\u4e2a\u88c5\u9970\u5668\uff1a setter , getter , deleter \uff0c\u90fd\u662f\u5728 property () \u7684\u57fa\u7840\u4e0a\u505a\u4e86\u4e00\u4e9b\u5c01\u88c5\uff0c\u56e0\u4e3a setter \u548c deleter \u662f property () \u7684\u7b2c\u4e8c\u548c\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c getter \u88c5\u9970\u5668\u548c\u4e0d\u5e26 getter \u7684\u5c5e\u6027\u88c5\u9970\u5668\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u4f30\u8ba1\u53ea\u662f\u4e3a\u4e86\u51d1\u6570\uff0c\u672c\u8eab\u6ca1\u6709\u4efb\u4f55\u5b58\u5728\u7684\u610f\u4e49\u3002\u7ecf\u8fc7 @ property \u88c5\u9970\u8fc7\u7684\u51fd\u6570\u8fd4\u56de\u7684\u4e0d\u518d\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u800c\u662f\u4e00\u4e2a property \u5bf9\u8c61\u3002 >>> property() <property object at 0x10ff07940 > @ classmethod \u00b6 \u6709\u4e86 @ property \u88c5\u9970\u5668\u7684\u4e86\u89e3\uff0c\u8fd9\u4e24\u4e2a\u88c5\u9970\u5668\u7684\u539f\u7406\u662f\u5dee\u4e0d\u591a\u7684\u3002 @ staticmethod \u8fd4\u56de\u7684\u662f\u4e00\u4e2a staticmethod \u7c7b\u5bf9\u8c61\uff0c\u800c @ classmethod \u8fd4\u56de\u7684\u662f\u4e00\u4e2a classmethod \u7c7b\u5bf9\u8c61\u3002\u4ed6\u4eec\u90fd\u662f\u8c03\u7528\u7684\u662f\u5404\u81ea\u7684 __init__ () \u6784\u9020\u51fd\u6570\u3002 class classmethod(object): \"\"\" classmethod(function) -> method \"\"\" def __init__(self, function): # for @classmethod decorator pass # ... class staticmethod(object): \"\"\" staticmethod(function) -> method \"\"\" def __init__(self, function): # for @staticmethod decorator pass # ... class Foo(object): @staticmethod def bar(): pass # \u7b49\u540c\u4e8e bar = staticmethod(bar) \u81f3\u6b64\uff0c\u6211\u4eec\u4e0a\u6587\u63d0\u5230\u7684\u88c5\u9970\u5668\u63a5\u53e3\u5b9a\u4e49\u53ef\u4ee5\u66f4\u52a0\u660e\u786e\u4e00\u4e9b\uff0c\u88c5\u9970\u5668\u5fc5\u987b\u63a5\u53d7\u4e00\u4e2a callable \u5bf9\u8c61\uff0c\u5176\u5b9e\u5b83\u5e76\u4e0d\u5173\u5fc3\u4f60\u8fd4\u56de\u4ec0\u4e48\uff0c\u53ef\u4ee5\u662f\u53e6\u5916\u4e00\u4e2a callable \u5bf9\u8c61\uff08\u5927\u90e8\u5206\u60c5\u51b5\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u7c7b\u5bf9\u8c61\uff0c\u6bd4\u5982 property \u3002 \u88c5\u9970\u5668\u91cc\u7684\u90a3\u4e9b\u5751 \u00b6 \u88c5\u9970\u5668\u53ef\u4ee5\u8ba9\u4f60\u4ee3\u7801\u66f4\u52a0\u4f18\u96c5\uff0c\u51cf\u5c11\u91cd\u590d\uff0c\u4f46\u4e5f\u4e0d\u5168\u662f\u4f18\u70b9\uff0c\u4e5f\u4f1a\u5e26\u6765\u4e00\u4e9b\u95ee\u9898\u3002 \u4f4d\u7f6e\u9519\u8bef\u7684\u4ee3\u7801 \u00b6 \u8ba9\u6211\u4eec\u76f4\u63a5\u770b\u793a\u4f8b\u4ee3\u7801\u3002 def html_tags(tag_name): print 'begin outer function.' def wrapper_(func): print \"begin of inner wrapper function.\" def wrapper(*args, **kwargs): content = func(*args, **kwargs) print \"<{tag}>{content}</{tag}>\".format(tag=tag_name, content=content) print 'end of inner wrapper function.' return wrapper print 'end of outer function' return wrapper_@html_tags('b') def hello(name='Toby'): return 'Hello {}!'.format(name) hello() hello() \u5728\u88c5\u9970\u5668\u4e2d\u6211\u5728\u5404\u4e2a\u53ef\u80fd\u7684\u4f4d\u7f6e\u90fd\u52a0\u4e0a\u4e86 print \u8bed\u53e5\uff0c\u7528\u4e8e\u8bb0\u5f55\u88ab\u8c03\u7528\u7684\u60c5\u51b5\u3002\u4f60\u77e5\u9053\u4ed6\u4eec\u6700\u540e\u6253\u5370\u51fa\u6765\u7684\u987a\u5e8f\u5417\uff1f\u5982\u679c\u4f60\u5fc3\u91cc\u6ca1\u5e95\uff0c\u90a3\u4e48\u6700\u597d\u4e0d\u8981\u5728\u88c5\u9970\u5668\u51fd\u6570\u4e4b\u5916\u6dfb\u52a0\u903b\u8f91\u529f\u80fd\uff0c\u5426\u5219\u8fd9\u4e2a\u88c5\u9970\u5668\u5c31\u4e0d\u53d7\u4f60\u63a7\u5236\u4e86\u3002\u4ee5\u4e0b\u662f\u8f93\u51fa\u7ed3\u679c\uff1a begin outer function. end of outer function begin of inner wrapper function. end of inner wrapper function. <b > Hello Toby!< /b > <b > Hello Toby!< /b > \u9519\u8bef\u7684\u51fd\u6570\u7b7e\u540d\u548c\u6587\u6863 \u00b6 \u88c5\u9970\u5668\u88c5\u9970\u8fc7\u7684\u51fd\u6570\u770b\u4e0a\u53bb\u540d\u5b57\u6ca1\u53d8\uff0c\u5176\u5b9e\u5df2\u7ecf\u53d8\u4e86\u3002 def logging(func): def wrapper(*args, **kwargs): \"\"\"print log before a function.\"\"\" print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__) return func(*args, **kwargs) return wrapper @logging def say(something): \"\"\"say something\"\"\" print \"say {}!\".format(something) print say.__name__ # wrapper \u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\u5462\uff1f@\u7b49\u540c\u4e8e\u8fd9\u6837\u7684\u5199\u6cd5\u3002 say = logging(say) logging \u5176\u5b9e\u8fd4\u56de\u7684\u51fd\u6570\u540d\u5b57\u521a\u597d\u662f wrapper \uff0c\u90a3\u4e48\u4e0a\u9762\u7684\u8fd9\u4e2a\u8bed\u53e5\u521a\u597d\u5c31\u662f\u628a\u8fd9\u4e2a\u7ed3\u679c\u8d4b\u503c\u7ed9 say \uff0c say \u7684 __name__ \u81ea\u7136\u4e5f\u5c31\u662f wrapper \u4e86\uff0c\u4e0d\u4ec5\u4ec5\u662f name \uff0c\u5176\u4ed6\u5c5e\u6027\u4e5f\u90fd\u662f\u6765\u81ea wrapper \uff0c\u6bd4\u5982 doc \uff0c source \u7b49\u7b49\u3002 \u4f7f\u7528\u6807\u51c6\u5e93\u91cc\u7684 functools.wraps \uff0c\u53ef\u4ee5\u57fa\u672c\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002 from functools import wrapsdef logging(func): @wraps(func) def wrapper(*args, **kwargs): \"\"\"print log before a function.\"\"\" print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__) return func(*args, **kwargs) return wrapper @logging def say(something): \"\"\"say something\"\"\" print \"say {}!\".format(something) print say.__name__ # say print say.__doc__ # say something \u770b\u4e0a\u53bb\u4e0d\u9519\uff01\u4e3b\u8981\u95ee\u9898\u89e3\u51b3\u4e86\uff0c\u4f46\u5176\u5b9e\u8fd8\u4e0d\u592a\u5b8c\u7f8e\u3002\u56e0\u4e3a\u51fd\u6570\u7684\u7b7e\u540d\u548c\u6e90\u7801\u8fd8\u662f\u62ff\u4e0d\u5230\u7684\u3002 import inspect print inspect.getargspec(say) # failed print inspect.getsource(say) # failed \u5982\u679c\u8981\u5f7b\u5e95\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u501f\u7528\u7b2c\u4e09\u65b9\u5305\uff0c\u6bd4\u5982 wrapt \u3002\u540e\u6587\u6709\u4ecb\u7ecd\u3002 \u4e0d\u80fd\u88c5\u9970@staticmethod \u6216\u8005 @classmethod \u00b6 \u5f53\u4f60\u60f3\u628a\u88c5\u9970\u5668\u7528\u5728\u4e00\u4e2a\u9759\u6001\u65b9\u6cd5\u6216\u8005\u7c7b\u65b9\u6cd5\u65f6\uff0c\u4e0d\u597d\u610f\u601d\uff0c\u62a5\u9519\u4e86\u3002 class Car(object): def __init__(self, model): self.model = model @logging # \u88c5\u9970\u5b9e\u4f8b\u65b9\u6cd5\uff0cOK def run(self): print \"{} is running!\".format(self.model) @logging # \u88c5\u9970\u9759\u6001\u65b9\u6cd5\uff0cFailed @staticmethod def check_model_for(obj): if isinstance(obj, Car): print \"The model of your car is {}\".format(obj.model) else: print \"{} is not a car!\".format(obj) \"\"\" Traceback (most recent call last): ... File \"example_4.py\", line 10, in logging @wraps(func) File \"C:\\Python27\\lib\\functools.py\", line 33, in update_wrapper setattr(wrapper, attr, getattr(wrapped, attr)) AttributeError: 'staticmethod' object has no attribute '__module__' \"\"\" \u524d\u9762\u5df2\u7ecf\u89e3\u91ca\u4e86 @ staticmethod \u8fd9\u4e2a\u88c5\u9970\u5668\uff0c\u5176\u5b9e\u5b83\u8fd4\u56de\u7684\u5e76\u4e0d\u662f\u4e00\u4e2a callable \u5bf9\u8c61\uff0c\u800c\u662f\u4e00\u4e2a staticmethod \u5bf9\u8c61\uff0c\u90a3\u4e48\u5b83\u662f\u4e0d\u7b26\u5408\u88c5\u9970\u5668\u8981\u6c42\u7684\uff08\u6bd4\u5982\u4f20\u5165\u4e00\u4e2a callable \u5bf9\u8c61\uff09\uff0c\u4f60\u81ea\u7136\u4e0d\u80fd\u5728\u5b83\u4e4b\u4e0a\u518d\u52a0\u522b\u7684\u88c5\u9970\u5668\u3002\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5f88\u7b80\u5355\uff0c\u53ea\u8981\u628a\u4f60\u7684\u88c5\u9970\u5668\u653e\u5728 @ staticmethod \u4e4b\u524d\u5c31\u597d\u4e86\uff0c\u56e0\u4e3a\u4f60\u7684\u88c5\u9970\u5668\u8fd4\u56de\u7684\u8fd8\u662f\u4e00\u4e2a\u6b63\u5e38\u7684\u51fd\u6570\uff0c\u7136\u540e\u518d\u52a0\u4e0a\u4e00\u4e2a @ staticmethod \u662f\u4e0d\u4f1a\u51fa\u95ee\u9898\u7684\u3002 class Car(object): def __init__(self, model): self.model = model @staticmethod @logging def check_model_for(obj): pass \u5982\u4f55\u4f18\u5316\u4f60\u7684\u88c5\u9970\u5668 \u00b6 \u5d4c\u5957\u7684\u88c5\u9970\u51fd\u6570\u4e0d\u592a\u76f4\u89c2\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e09\u65b9\u5305\u7c7b\u6539\u8fdb\u8fd9\u6837\u7684\u60c5\u51b5\uff0c\u8ba9\u88c5\u9970\u5668\u51fd\u6570\u53ef\u8bfb\u6027\u66f4\u597d\u3002 decorator.py \u00b6 decorator.py \u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u88c5\u9970\u5668\u52a0\u5f3a\u5305\u3002\u4f60\u53ef\u4ee5\u5f88\u76f4\u89c2\u7684\u5148\u5b9a\u4e49\u5305\u88c5\u51fd\u6570 wrapper () \uff0c\u518d\u4f7f\u7528 decorate ( func , wrapper ) \u65b9\u6cd5\u5c31\u53ef\u4ee5\u5b8c\u6210\u4e00\u4e2a\u88c5\u9970\u5668\u3002 from decorator import decorate def wrapper(func, *args, **kwargs): \"\"\"print log before a function.\"\"\" print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__) return func(*args, **kwargs) def logging(func): return decorate(func, wrapper) # \u7528wrapper\u88c5\u9970func \u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5b83\u81ea\u5e26\u7684 @ decorator \u88c5\u9970\u5668\u6765\u5b8c\u6210\u4f60\u7684\u88c5\u9970\u5668\u3002 from decorator import decorator @decorator def logging(func, *args, **kwargs): print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__) return func(*args, **kwargs) decorator.py \u5b9e\u73b0\u7684\u88c5\u9970\u5668\u80fd\u5b8c\u6574\u4fdd\u7559\u539f\u51fd\u6570\u7684 name \uff0c doc \u548c args \uff0c\u552f\u4e00\u6709\u95ee\u9898\u7684\u5c31\u662f inspect.getsource ( func ) \u8fd4\u56de\u7684\u8fd8\u662f\u88c5\u9970\u5668\u7684\u6e90\u4ee3\u7801\uff0c\u4f60\u9700\u8981\u6539\u6210 inspect.getsource ( func.__wrapped__ ) \u3002 wrapt \u00b6 wrapt \u662f\u4e00\u4e2a\u529f\u80fd\u975e\u5e38\u5b8c\u5584\u7684\u5305\uff0c\u7528\u4e8e\u5b9e\u73b0\u5404\u79cd\u4f60\u60f3\u5230\u6216\u8005\u4f60\u6ca1\u60f3\u5230\u7684\u88c5\u9970\u5668\u3002\u4f7f\u7528 wrapt \u5b9e\u73b0\u7684\u88c5\u9970\u5668\u4f60\u4e0d\u9700\u8981\u62c5\u5fc3\u4e4b\u524d inspect \u4e2d\u9047\u5230\u7684\u6240\u6709\u95ee\u9898\uff0c\u56e0\u4e3a\u5b83\u90fd\u5e2e\u4f60\u5904\u7406\u4e86\uff0c\u751a\u81f3 inspect.getsource ( func ) \u4e5f\u51c6\u786e\u65e0\u8bef\u3002 import wrapt# without argument in decorator @wrapt.decorator def logging(wrapped, instance, args, kwargs): # instance is must print \"[DEBUG]: enter {}()\".format(wrapped.__name__) return wrapped(*args, **kwargs) @logging def say(something): pass \u4f7f\u7528 wrapt \u4f60\u53ea\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u88c5\u9970\u5668\u51fd\u6570\uff0c\u4f46\u662f\u51fd\u6570\u7b7e\u540d\u662f\u56fa\u5b9a\u7684\uff0c\u5fc5\u987b\u662f ( wrapped , instance, args, kwargs ) \uff0c\u6ce8\u610f\u7b2c\u4e8c\u4e2a\u53c2\u6570 instance \u662f\u5fc5\u987b\u7684\uff0c\u5c31\u7b97\u4f60\u4e0d\u7528\u5b83\u3002\u5f53\u88c5\u9970\u5668\u88c5\u9970\u5728\u4e0d\u540c\u4f4d\u7f6e\u65f6\u5b83\u5c06\u5f97\u5230\u4e0d\u540c\u7684\u503c\uff0c\u6bd4\u5982\u88c5\u9970\u5728\u7c7b\u5b9e\u4f8b\u65b9\u6cd5\u65f6\u4f60\u53ef\u4ee5\u62ff\u5230\u8fd9\u4e2a\u7c7b\u5b9e\u4f8b\u3002\u6839\u636e instance \u7684\u503c\u4f60\u80fd\u591f\u66f4\u52a0\u7075\u6d3b\u7684\u8c03\u6574\u4f60\u7684\u88c5\u9970\u5668\u3002\u53e6\u5916\uff0c args \u548c kwargs \u4e5f\u662f\u56fa\u5b9a\u7684\uff0c\u6ce8\u610f\u524d\u9762\u6ca1\u6709\u661f\u53f7\u3002\u5728\u88c5\u9970\u5668\u5185\u90e8\u8c03\u7528\u539f\u51fd\u6570\u65f6\u624d\u5e26\u661f\u53f7\u3002 \u5982\u679c\u4f60\u9700\u8981\u4f7f\u7528 wrapt \u5199\u4e00\u4e2a\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\uff0c\u53ef\u4ee5\u8fd9\u6837\u5199\u3002 def logging(level): @wrapt.decorator def wrapper(wrapped, instance, args, kwargs): print \"[{}]: enter {}()\".format(level, wrapped.__name__) return wrapped(*args, **kwargs) return wrapper@logging(level=\"INFO\") def do(work): pass \u5173\u4e8e wrapt \u7684\u4f7f\u7528\uff0c\u5efa\u8bae\u67e5\u9605\u5b98\u65b9\u6587\u6863\uff0c\u5728\u6b64\u4e0d\u5728\u8d58\u8ff0\u3002 http://wrapt.readthedocs.io/en/latest/quick-start.html \u5c0f\u7ed3 \u00b6 Python \u7684\u88c5\u9970\u5668\u548c Java \u7684\u6ce8\u89e3\uff08 Annotation \uff09\u5e76\u4e0d\u662f\u540c\u4e00\u56de\u4e8b\uff0c\u548c C# \u4e2d\u7684\u7279\u6027\uff08 Attribute \uff09\u4e5f\u4e0d\u4e00\u6837\uff0c\u5b8c\u5168\u662f\u4e24\u4e2a\u6982\u5ff5\u3002 \u88c5\u9970\u5668\u7684\u7406\u5ff5\u662f\u5bf9\u539f\u51fd\u6570\u3001\u5bf9\u8c61\u7684\u52a0\u5f3a\uff0c\u76f8\u5f53\u4e8e\u91cd\u65b0\u5c01\u88c5\uff0c\u6240\u4ee5\u4e00\u822c\u88c5\u9970\u5668\u51fd\u6570\u90fd\u88ab\u547d\u540d\u4e3a wrapper () \uff0c\u610f\u4e49\u5728\u4e8e\u5305\u88c5\u3002\u51fd\u6570\u53ea\u6709\u5728\u88ab\u8c03\u7528\u65f6\u624d\u4f1a\u53d1\u6325\u5176\u4f5c\u7528\u3002\u6bd4\u5982 @ logging \u88c5\u9970\u5668\u53ef\u4ee5\u5728\u51fd\u6570\u6267\u884c\u65f6\u989d\u5916\u8f93\u51fa\u65e5\u5fd7\uff0c @ cache \u88c5\u9970\u8fc7\u7684\u51fd\u6570\u53ef\u4ee5\u7f13\u5b58\u8ba1\u7b97\u7ed3\u679c\u7b49\u7b49\u3002 \u800c\u6ce8\u89e3\u548c\u7279\u6027\u5219\u662f\u5bf9\u76ee\u6807\u51fd\u6570\u6216\u5bf9\u8c61\u6dfb\u52a0\u4e00\u4e9b\u5c5e\u6027\uff0c\u76f8\u5f53\u4e8e\u5c06\u5176\u5206\u7c7b\u3002\u8fd9\u4e9b\u5c5e\u6027\u53ef\u4ee5\u901a\u8fc7\u53cd\u5c04\u62ff\u5230\uff0c\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u5bf9\u4e0d\u540c\u7684\u7279\u6027\u51fd\u6570\u6216\u5bf9\u8c61\u52a0\u4ee5\u5e72\u9884\u3002\u6bd4\u5982\u5e26\u6709 Setup \u7684\u51fd\u6570\u5c31\u5f53\u6210\u51c6\u5907\u6b65\u9aa4\u6267\u884c\uff0c\u6216\u8005\u627e\u5230\u6240\u6709\u5e26\u6709 TestMethod \u7684\u51fd\u6570\u4f9d\u6b21\u6267\u884c\u7b49\u7b49\u3002 \u81f3\u6b64\u6211\u6240\u4e86\u89e3\u7684\u88c5\u9970\u5668\u5df2\u7ecf\u8bb2\u5b8c\uff0c\u4f46\u662f\u8fd8\u6709\u4e00\u4e9b\u5185\u5bb9\u6ca1\u6709\u63d0\u5230\uff0c\u6bd4\u5982\u88c5\u9970\u7c7b\u7684\u88c5\u9970\u5668\u3002\u6709\u673a\u4f1a\u518d\u8865\u5145\u3002\u8c22\u8c22\u89c2\u770b\u3002 \u672c\u6587\u6e90\u7801 <https://github.com/tobyqin/python_decorator","title":"\u88c5\u9970\u5668"},{"location":"python-decorator/#_1","text":"\u6211\u4eec\u5047\u8bbe\u4f60\u7684\u7a0b\u5e8f\u5b9e\u73b0\u4e86 say_hello () \u548c say_goodbye () \u4e24\u4e2a\u51fd\u6570\u3002 def say_hello(): print \"hello!\" def say_goodbye(): print \"hello!\" # bug here if __name__ == '__main__': say_hello() say_goodbye() \u4f46\u662f\u5728\u5b9e\u9645\u8c03\u7528\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u7a0b\u5e8f\u51fa\u9519\u4e86\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u6253\u5370\u4e86\u4e24\u4e2a hello \u3002\u7ecf\u8fc7\u8c03\u8bd5\u4f60\u53d1\u73b0\u662f say_goodbye () \u51fa\u9519\u4e86\u3002\u8001\u677f\u8981\u6c42\u8c03\u7528\u6bcf\u4e2a\u65b9\u6cd5\u524d\u90fd\u8981\u8bb0\u5f55\u8fdb\u5165\u51fd\u6570\u7684\u65f6\u95f4\u548c\u540d\u79f0\uff0c\u6bd4\u5982\u8fd9\u6837\uff1a [DEBUG] 2016 - 10 - 27 11:11:11 - Enter say_hello() Hello! [DEBUG] 2016 - 10 - 27 11:11:11 - Enter say_goodbye() Goodbye! \u597d\uff0c\u5c0f A \u662f\u4e2a\u6bd5\u4e1a\u751f\uff0c\u4ed6\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\u3002 def say_hello(): print \"[DEBUG]: enter say_hello()\" print \"hello!\" def say_goodbye(): print \"[DEBUG]: enter say_goodbye()\" print \"hello!\" if __name__ == '__main__': say_hello() say_goodbye() \u5f88 low \u5427\uff1f \u55ef\u662f\u7684\u3002\u5c0f B \u5de5\u4f5c\u6709\u4e00\u6bb5\u65f6\u95f4\u4e86\uff0c\u4ed6\u544a\u8bc9\u5c0f A \u5e94\u8be5\u8fd9\u6837\u5199\u3002 def debug(): import inspect caller_name = inspect.stack()[1][3] print \"[DEBUG]: enter {}()\".format(caller_name) def say_hello(): debug() print \"hello!\" def say_goodbye(): debug() print \"goodbye!\" if __name__ == '__main__': say_hello() say_goodbye() \u662f\u4e0d\u662f\u597d\u4e00\u70b9\uff1f\u90a3\u5f53\u7136\uff0c\u4f46\u662f\u6bcf\u4e2a\u4e1a\u52a1\u51fd\u6570\u91cc\u90fd\u8981\u8c03\u7528\u4e00\u4e0b debug () \u51fd\u6570\uff0c\u662f\u4e0d\u662f\u5f88\u96be\u53d7\uff1f\u4e07\u4e00\u8001\u677f\u8bf4 say \u76f8\u5173\u7684\u51fd\u6570\u4e0d\u7528 debug \uff0c do \u76f8\u5173\u7684\u624d\u9700\u8981\u5462\uff1f \u90a3\u4e48\u88c5\u9970\u5668\u8fd9\u65f6\u5019\u5e94\u8be5\u767b\u573a\u4e86\u3002 \u88c5\u9970\u5668\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a Python \u51fd\u6570\uff0c\u5b83\u53ef\u4ee5\u8ba9\u5176\u4ed6\u51fd\u6570\u5728\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u4ee3\u7801\u53d8\u52a8\u7684\u524d\u63d0\u4e0b\u589e\u52a0\u989d\u5916\u529f\u80fd\uff0c\u88c5\u9970\u5668\u7684\u8fd4\u56de\u503c\u4e5f\u662f\u4e00\u4e2a\u51fd\u6570\u5bf9\u8c61\u3002\u5b83\u7ecf\u5e38\u7528\u4e8e\u6709\u5207\u9762\u9700\u6c42\u7684\u573a\u666f\uff0c\u6bd4\u5982\uff1a\u63d2\u5165\u65e5\u5fd7\u3001\u6027\u80fd\u6d4b\u8bd5\u3001\u4e8b\u52a1\u5904\u7406\u3001\u7f13\u5b58\u3001\u6743\u9650\u6821\u9a8c\u7b49\u573a\u666f\u3002\u88c5\u9970\u5668\u662f\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\u7684\u7edd\u4f73\u8bbe\u8ba1\uff0c\u6709\u4e86\u88c5\u9970\u5668\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u62bd\u79bb\u51fa\u5927\u91cf\u4e0e\u51fd\u6570\u529f\u80fd\u672c\u8eab\u65e0\u5173\u7684\u96f7\u540c\u4ee3\u7801\u5e76\u7ee7\u7eed\u91cd\u7528\u3002 \u6982\u62ec\u7684\u8bb2\uff0c\u88c5\u9970\u5668\u7684\u4f5c\u7528\u5c31\u662f \u4e3a\u5df2\u7ecf\u5b58\u5728\u7684\u51fd\u6570\u6216\u5bf9\u8c61\u6dfb\u52a0\u989d\u5916\u7684\u529f\u80fd\u3002 \u600e\u4e48\u5199\u4e00\u4e2a\u88c5\u9970\u5668 \u5728\u65e9\u4e9b\u65f6\u5019 (Python Version < 2.4\uff0c2004\u5e74\u4ee5\u524d)\uff0c\u4e3a\u4e00\u4e2a\u51fd\u6570\u6dfb\u52a0\u989d\u5916\u529f\u80fd\u7684\u5199\u6cd5\u662f\u8fd9\u6837\u7684\u3002 def debug(func): def wrapper(): print \"[DEBUG]: enter {}()\".format(func.__name__) return func() return wrapper def say_hello(): print \"hello!\" say_hello = debug(say_hello) # \u6dfb\u52a0\u529f\u80fd\u5e76\u4fdd\u6301\u539f\u51fd\u6570\u540d\u4e0d\u53d8 \u4e0a\u9762\u7684 debug \u51fd\u6570\u5176\u5b9e\u5df2\u7ecf\u662f\u4e00\u4e2a\u88c5\u9970\u5668\u4e86\uff0c\u5b83\u5bf9\u539f\u51fd\u6570\u505a\u4e86\u5305\u88c5\u5e76\u8fd4\u56de\u4e86\u53e6\u5916\u4e00\u4e2a\u51fd\u6570\uff0c\u989d\u5916\u6dfb\u52a0\u4e86\u4e00\u4e9b\u529f\u80fd\u3002\u56e0\u4e3a\u8fd9\u6837\u5199\u5b9e\u5728\u4e0d\u592a\u4f18\u96c5\uff0c\u4e0b\u9762\u4ee3\u7801\u7b49\u540c\u4e8e\u65e9\u671f\u7684\u5199\u6cd5\u3002 def debug(func): def wrapper(): print \"[DEBUG]: enter {}()\".format(func.__name__) return func() return wrapper @debug def say_hello(): print \"hello!\" \u8fd9\u662f\u6700\u7b80\u5355\u7684\u88c5\u9970\u5668\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u88ab\u88c5\u9970\u7684\u51fd\u6570\u9700\u8981\u4f20\u5165\u53c2\u6570\uff0c\u90a3\u4e48\u8fd9\u4e2a\u88c5\u9970\u5668\u5c31\u574f\u4e86\u3002\u56e0\u4e3a\u8fd4\u56de\u7684\u51fd\u6570\u5e76\u4e0d\u80fd\u63a5\u53d7\u53c2\u6570\uff0c\u4f60\u53ef\u4ee5\u6307\u5b9a\u88c5\u9970\u5668\u51fd\u6570 wrapper \u63a5\u53d7\u548c\u539f\u51fd\u6570\u4e00\u6837\u7684\u53c2\u6570\uff0c\u6bd4\u5982\uff1a def debug(func): def wrapper(something): # \u6307\u5b9a\u4e00\u6bdb\u4e00\u6837\u7684\u53c2\u6570 print \"[DEBUG]: enter {}()\".format(func.__name__) return func(something) return wrapper # \u8fd4\u56de\u5305\u88c5\u8fc7\u51fd\u6570 @debug def say(something): print \"hello {}!\".format(something) \u8fd9\u6837\u4f60\u5c31\u89e3\u51b3\u4e86\u4e00\u4e2a\u95ee\u9898\uff0c\u4f46\u53c8\u591a\u4e86 N \u4e2a\u95ee\u9898\u3002\u56e0\u4e3a\u51fd\u6570\u6709\u5343\u5343\u4e07\uff0c\u4f60\u53ea\u7ba1\u4f60\u81ea\u5df1\u7684\u51fd\u6570\uff0c\u522b\u4eba\u7684\u51fd\u6570\u53c2\u6570\u662f\u4ec0\u4e48\u6837\u5b50\uff0c\u9b3c\u77e5\u9053\uff1f\u8fd8\u597d Python \u63d0\u4f9b\u4e86\u53ef\u53d8\u53c2\u6570 * args \u548c\u5173\u952e\u5b57\u53c2\u6570 ** kwargs \uff0c\u6709\u4e86\u8fd9\u4e24\u4e2a\u53c2\u6570\uff0c\u88c5\u9970\u5668\u5c31\u53ef\u4ee5\u7528\u4e8e\u4efb\u610f\u76ee\u6807\u51fd\u6570\u4e86\u3002 def debug(func): def wrapper(*args, **kwargs): # \u6307\u5b9a\u5b87\u5b99\u65e0\u654c\u53c2\u6570 print \"[DEBUG]: enter {}()\".format(func.__name__) print 'Prepare and say...', return func(*args, **kwargs) return wrapper # \u8fd4\u56de @debug def say(something): print \"hello {}!\".format(something) \u81f3\u6b64\uff0c\u4f60\u5df2\u5b8c\u5168\u638c\u63e1\u521d\u7ea7\u7684\u88c5\u9970\u5668\u5199\u6cd5\u3002","title":"\u4e3a\u4ec0\u4e48\u9700\u8981\u88c5\u9970\u5668"},{"location":"python-decorator/#_2","text":"\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\u548c\u7c7b\u88c5\u9970\u5668\u5c5e\u4e8e\u8fdb\u9636\u7684\u5185\u5bb9\u3002\u5728\u7406\u89e3\u8fd9\u4e9b\u88c5\u9970\u5668\u4e4b\u524d\uff0c\u6700\u597d\u5bf9\u51fd\u6570\u7684\u95ed\u5305\u548c\u88c5\u9970\u5668\u7684\u63a5\u53e3\u7ea6\u5b9a\u6709\u4e00\u5b9a\u4e86\u89e3\u3002(\u53c2\u89c1http://betacat.online/posts/python- closure/)","title":"\u9ad8\u7ea7\u4e00\u70b9\u7684\u88c5\u9970\u5668"},{"location":"python-decorator/#_3","text":"\u5047\u8bbe\u6211\u4eec\u524d\u6587\u7684\u88c5\u9970\u5668\u9700\u8981\u5b8c\u6210\u7684\u529f\u80fd\u4e0d\u4ec5\u4ec5\u662f\u80fd\u5728\u8fdb\u5165\u67d0\u4e2a\u51fd\u6570\u540e\u6253\u51fa log \u4fe1\u606f\uff0c\u800c\u4e14\u8fd8\u9700\u6307\u5b9a log \u7684\u7ea7\u522b\uff0c\u90a3\u4e48\u88c5\u9970\u5668\u5c31\u4f1a\u662f\u8fd9\u6837\u7684\u3002 def debug(func): def logging(level): def wrapper(func): def inner_wrapper(*args, **kwargs): print \"[{level}]: enter function {func}()\".format( level=level, func=func.__name__) return func(*args, **kwargs) return inner_wrapper return wrapper @logging(level='INFO') def say(something): print \"say {}!\".format(something) @logging(level='DEBUG') def do(something): print \"do {}...\".format(something) if __name__ == '__main__': say('hello') do(\"my work\") \u662f\u4e0d\u662f\u6709\u4e00\u4e9b\u6655\uff1f\u4f60\u53ef\u4ee5\u8fd9\u4e48\u7406\u89e3\uff0c\u5f53\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\u88ab\u6253\u5728\u67d0\u4e2a\u51fd\u6570\u4e0a\u65f6\uff0c\u6bd4\u5982 @ logging ( level =' DEBUG ') \uff0c\u5b83\u5176\u5b9e\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u4f1a\u9a6c\u4e0a\u88ab\u6267\u884c\uff0c\u53ea\u8981\u8fd9\u4e2a\u5b83\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u88c5\u9970\u5668\u65f6\uff0c\u90a3\u5c31\u6ca1\u95ee\u9898\u3002\u7ec6\u7ec6\u518d\u4f53\u4f1a\u4e00\u4e0b\u3002","title":"\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668"},{"location":"python-decorator/#_4","text":"\u88c5\u9970\u5668\u51fd\u6570\u5176\u5b9e\u662f\u8fd9\u6837\u4e00\u4e2a\u63a5\u53e3\u7ea6\u675f\uff0c\u5b83\u5fc5\u987b\u63a5\u53d7\u4e00\u4e2a callable \u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\uff0c\u7136\u540e\u8fd4\u56de\u4e00\u4e2a callable \u5bf9\u8c61\u3002\u5728 Python \u4e2d\u4e00\u822c callable \u5bf9\u8c61\u90fd\u662f\u51fd\u6570\uff0c\u4f46\u4e5f\u6709\u4f8b\u5916\u3002\u53ea\u8981\u67d0\u4e2a\u5bf9\u8c61\u91cd\u8f7d\u4e86 __call__ () \u65b9\u6cd5\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u662f callable \u7684\u3002 class Test(): def __call__(self): print 'call me!'t = Test() t() # call me \u50cf __call__ \u8fd9\u6837\u524d\u540e\u90fd\u5e26\u4e0b\u5212\u7ebf\u7684\u65b9\u6cd5\u5728 Python \u4e2d\u88ab\u79f0\u4e3a\u5185\u7f6e\u65b9\u6cd5\uff0c\u6709\u65f6\u5019\u4e5f\u88ab\u79f0\u4e3a\u9b54\u6cd5\u65b9\u6cd5\u3002\u91cd\u8f7d\u8fd9\u4e9b\u9b54\u6cd5\u65b9\u6cd5\u4e00\u822c\u4f1a\u6539\u53d8\u5bf9\u8c61\u7684\u5185\u90e8\u884c\u4e3a\u3002\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u5c31\u8ba9\u4e00\u4e2a\u7c7b\u5bf9\u8c61\u62e5\u6709\u4e86\u88ab\u8c03\u7528\u7684\u884c\u4e3a\u3002 \u56de\u5230\u88c5\u9970\u5668\u4e0a\u7684\u6982\u5ff5\u4e0a\u6765\uff0c\u88c5\u9970\u5668\u8981\u6c42\u63a5\u53d7\u4e00\u4e2a callable \u5bf9\u8c61\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a callable \u5bf9\u8c61\uff08\u4e0d\u592a\u4e25\u8c28\uff0c\u8be6\u89c1\u540e\u6587\uff09\u3002\u90a3\u4e48\u7528\u7c7b\u6765\u5b9e\u73b0\u4e5f\u662f\u4e5f\u53ef\u4ee5\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u8ba9\u7c7b\u7684\u6784\u9020\u51fd\u6570 __init__ () \u63a5\u53d7\u4e00\u4e2a\u51fd\u6570\uff0c\u7136\u540e\u91cd\u8f7d __call__ () \u5e76\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\uff0c\u4e5f\u53ef\u4ee5\u8fbe\u5230\u88c5\u9970\u5668\u51fd\u6570\u7684\u6548\u679c\u3002 class logging(object): def __init__(self, func): self.func = func def __call__(self, *args, **kwargs): print \"[DEBUG]: enter function {func}()\".format( func=self.func.__name__) return self.func(*args, **kwargs) @logging def say(something): print \"say {}!\".format(something)","title":"\u57fa\u4e8e\u7c7b\u5b9e\u73b0\u7684\u88c5\u9970\u5668"},{"location":"python-decorator/#_5","text":"\u5982\u679c\u9700\u8981\u901a\u8fc7\u7c7b\u5f62\u5f0f\u5b9e\u73b0\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\uff0c\u90a3\u4e48\u4f1a\u6bd4\u524d\u9762\u7684\u4f8b\u5b50\u7a0d\u5fae\u590d\u6742\u4e00\u70b9\u3002\u90a3\u4e48\u5728\u6784\u9020\u51fd\u6570\u91cc\u63a5\u53d7\u7684\u5c31\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u800c\u662f\u4f20\u5165\u7684\u53c2\u6570\u3002\u901a\u8fc7\u7c7b\u628a\u8fd9\u4e9b\u53c2\u6570\u4fdd\u5b58\u8d77\u6765\u3002\u7136\u540e\u5728\u91cd\u8f7d __call__ \u65b9\u6cd5\u662f\u5c31\u9700\u8981\u63a5\u53d7\u4e00\u4e2a\u51fd\u6570\u5e76\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\u3002 class logging(object): def __init__(self, level='INFO'): self.level = level def __call__(self, func): # \u63a5\u53d7\u51fd\u6570 def wrapper(*args, **kwargs): print \"[{level}]: enter function {func}()\".format( level=self.level, func=func.__name__) func(*args, **kwargs) return wrapper # \u8fd4\u56de\u51fd\u6570 @logging(level='INFO') def say(something): print \"say {}!\".format(something)","title":"\u5e26\u53c2\u6570\u7684\u7c7b\u88c5\u9970\u5668"},{"location":"python-decorator/#_6","text":"\u5185\u7f6e\u7684\u88c5\u9970\u5668\u548c\u666e\u901a\u7684\u88c5\u9970\u5668\u539f\u7406\u662f\u4e00\u6837\u7684\uff0c\u53ea\u4e0d\u8fc7\u8fd4\u56de\u7684\u4e0d\u662f\u51fd\u6570\uff0c\u800c\u662f\u7c7b\u5bf9\u8c61\uff0c\u6240\u4ee5\u66f4\u96be\u7406\u89e3\u4e00\u4e9b\u3002","title":"\u5185\u7f6e\u7684\u88c5\u9970\u5668"},{"location":"python-decorator/#property","text":"\u5728\u4e86\u89e3\u8fd9\u4e2a\u88c5\u9970\u5668\u524d\uff0c\u4f60\u9700\u8981\u77e5\u9053\u5728\u4e0d\u4f7f\u7528\u88c5\u9970\u5668\u600e\u4e48\u5199\u4e00\u4e2a\u5c5e\u6027\u3002 def getx(self): return self._x def setx(self, value): self._x = value def delx(self): del self._x# create a property x = property(getx, setx, delx, \"I am doc for x property\") \u4ee5\u4e0a\u5c31\u662f\u4e00\u4e2aPython\u5c5e\u6027\u7684\u6807\u51c6\u5199\u6cd5\uff0c\u5176\u5b9e\u548cJava\u633a\u50cf\u7684\uff0c\u80fd\u8fbe\u5230\u4e00\u6837\u7684\u6548\u679c\u4f46\u770b\u8d77\u6765\u66f4\u7b80\u5355\u3002 @property def x(self): ... # \u7b49\u540c\u4e8e def x(self): ... x = property(x) \u5c5e\u6027\u6709\u4e09\u4e2a\u88c5\u9970\u5668\uff1a setter , getter , deleter \uff0c\u90fd\u662f\u5728 property () \u7684\u57fa\u7840\u4e0a\u505a\u4e86\u4e00\u4e9b\u5c01\u88c5\uff0c\u56e0\u4e3a setter \u548c deleter \u662f property () \u7684\u7b2c\u4e8c\u548c\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c getter \u88c5\u9970\u5668\u548c\u4e0d\u5e26 getter \u7684\u5c5e\u6027\u88c5\u9970\u5668\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u4f30\u8ba1\u53ea\u662f\u4e3a\u4e86\u51d1\u6570\uff0c\u672c\u8eab\u6ca1\u6709\u4efb\u4f55\u5b58\u5728\u7684\u610f\u4e49\u3002\u7ecf\u8fc7 @ property \u88c5\u9970\u8fc7\u7684\u51fd\u6570\u8fd4\u56de\u7684\u4e0d\u518d\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u800c\u662f\u4e00\u4e2a property \u5bf9\u8c61\u3002 >>> property() <property object at 0x10ff07940 >","title":"@ property"},{"location":"python-decorator/#classmethod","text":"\u6709\u4e86 @ property \u88c5\u9970\u5668\u7684\u4e86\u89e3\uff0c\u8fd9\u4e24\u4e2a\u88c5\u9970\u5668\u7684\u539f\u7406\u662f\u5dee\u4e0d\u591a\u7684\u3002 @ staticmethod \u8fd4\u56de\u7684\u662f\u4e00\u4e2a staticmethod \u7c7b\u5bf9\u8c61\uff0c\u800c @ classmethod \u8fd4\u56de\u7684\u662f\u4e00\u4e2a classmethod \u7c7b\u5bf9\u8c61\u3002\u4ed6\u4eec\u90fd\u662f\u8c03\u7528\u7684\u662f\u5404\u81ea\u7684 __init__ () \u6784\u9020\u51fd\u6570\u3002 class classmethod(object): \"\"\" classmethod(function) -> method \"\"\" def __init__(self, function): # for @classmethod decorator pass # ... class staticmethod(object): \"\"\" staticmethod(function) -> method \"\"\" def __init__(self, function): # for @staticmethod decorator pass # ... class Foo(object): @staticmethod def bar(): pass # \u7b49\u540c\u4e8e bar = staticmethod(bar) \u81f3\u6b64\uff0c\u6211\u4eec\u4e0a\u6587\u63d0\u5230\u7684\u88c5\u9970\u5668\u63a5\u53e3\u5b9a\u4e49\u53ef\u4ee5\u66f4\u52a0\u660e\u786e\u4e00\u4e9b\uff0c\u88c5\u9970\u5668\u5fc5\u987b\u63a5\u53d7\u4e00\u4e2a callable \u5bf9\u8c61\uff0c\u5176\u5b9e\u5b83\u5e76\u4e0d\u5173\u5fc3\u4f60\u8fd4\u56de\u4ec0\u4e48\uff0c\u53ef\u4ee5\u662f\u53e6\u5916\u4e00\u4e2a callable \u5bf9\u8c61\uff08\u5927\u90e8\u5206\u60c5\u51b5\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u7c7b\u5bf9\u8c61\uff0c\u6bd4\u5982 property \u3002","title":"@ classmethod"},{"location":"python-decorator/#_7","text":"\u88c5\u9970\u5668\u53ef\u4ee5\u8ba9\u4f60\u4ee3\u7801\u66f4\u52a0\u4f18\u96c5\uff0c\u51cf\u5c11\u91cd\u590d\uff0c\u4f46\u4e5f\u4e0d\u5168\u662f\u4f18\u70b9\uff0c\u4e5f\u4f1a\u5e26\u6765\u4e00\u4e9b\u95ee\u9898\u3002","title":"\u88c5\u9970\u5668\u91cc\u7684\u90a3\u4e9b\u5751"},{"location":"python-decorator/#_8","text":"\u8ba9\u6211\u4eec\u76f4\u63a5\u770b\u793a\u4f8b\u4ee3\u7801\u3002 def html_tags(tag_name): print 'begin outer function.' def wrapper_(func): print \"begin of inner wrapper function.\" def wrapper(*args, **kwargs): content = func(*args, **kwargs) print \"<{tag}>{content}</{tag}>\".format(tag=tag_name, content=content) print 'end of inner wrapper function.' return wrapper print 'end of outer function' return wrapper_@html_tags('b') def hello(name='Toby'): return 'Hello {}!'.format(name) hello() hello() \u5728\u88c5\u9970\u5668\u4e2d\u6211\u5728\u5404\u4e2a\u53ef\u80fd\u7684\u4f4d\u7f6e\u90fd\u52a0\u4e0a\u4e86 print \u8bed\u53e5\uff0c\u7528\u4e8e\u8bb0\u5f55\u88ab\u8c03\u7528\u7684\u60c5\u51b5\u3002\u4f60\u77e5\u9053\u4ed6\u4eec\u6700\u540e\u6253\u5370\u51fa\u6765\u7684\u987a\u5e8f\u5417\uff1f\u5982\u679c\u4f60\u5fc3\u91cc\u6ca1\u5e95\uff0c\u90a3\u4e48\u6700\u597d\u4e0d\u8981\u5728\u88c5\u9970\u5668\u51fd\u6570\u4e4b\u5916\u6dfb\u52a0\u903b\u8f91\u529f\u80fd\uff0c\u5426\u5219\u8fd9\u4e2a\u88c5\u9970\u5668\u5c31\u4e0d\u53d7\u4f60\u63a7\u5236\u4e86\u3002\u4ee5\u4e0b\u662f\u8f93\u51fa\u7ed3\u679c\uff1a begin outer function. end of outer function begin of inner wrapper function. end of inner wrapper function. <b > Hello Toby!< /b > <b > Hello Toby!< /b >","title":"\u4f4d\u7f6e\u9519\u8bef\u7684\u4ee3\u7801"},{"location":"python-decorator/#_9","text":"\u88c5\u9970\u5668\u88c5\u9970\u8fc7\u7684\u51fd\u6570\u770b\u4e0a\u53bb\u540d\u5b57\u6ca1\u53d8\uff0c\u5176\u5b9e\u5df2\u7ecf\u53d8\u4e86\u3002 def logging(func): def wrapper(*args, **kwargs): \"\"\"print log before a function.\"\"\" print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__) return func(*args, **kwargs) return wrapper @logging def say(something): \"\"\"say something\"\"\" print \"say {}!\".format(something) print say.__name__ # wrapper \u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\u5462\uff1f@\u7b49\u540c\u4e8e\u8fd9\u6837\u7684\u5199\u6cd5\u3002 say = logging(say) logging \u5176\u5b9e\u8fd4\u56de\u7684\u51fd\u6570\u540d\u5b57\u521a\u597d\u662f wrapper \uff0c\u90a3\u4e48\u4e0a\u9762\u7684\u8fd9\u4e2a\u8bed\u53e5\u521a\u597d\u5c31\u662f\u628a\u8fd9\u4e2a\u7ed3\u679c\u8d4b\u503c\u7ed9 say \uff0c say \u7684 __name__ \u81ea\u7136\u4e5f\u5c31\u662f wrapper \u4e86\uff0c\u4e0d\u4ec5\u4ec5\u662f name \uff0c\u5176\u4ed6\u5c5e\u6027\u4e5f\u90fd\u662f\u6765\u81ea wrapper \uff0c\u6bd4\u5982 doc \uff0c source \u7b49\u7b49\u3002 \u4f7f\u7528\u6807\u51c6\u5e93\u91cc\u7684 functools.wraps \uff0c\u53ef\u4ee5\u57fa\u672c\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002 from functools import wrapsdef logging(func): @wraps(func) def wrapper(*args, **kwargs): \"\"\"print log before a function.\"\"\" print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__) return func(*args, **kwargs) return wrapper @logging def say(something): \"\"\"say something\"\"\" print \"say {}!\".format(something) print say.__name__ # say print say.__doc__ # say something \u770b\u4e0a\u53bb\u4e0d\u9519\uff01\u4e3b\u8981\u95ee\u9898\u89e3\u51b3\u4e86\uff0c\u4f46\u5176\u5b9e\u8fd8\u4e0d\u592a\u5b8c\u7f8e\u3002\u56e0\u4e3a\u51fd\u6570\u7684\u7b7e\u540d\u548c\u6e90\u7801\u8fd8\u662f\u62ff\u4e0d\u5230\u7684\u3002 import inspect print inspect.getargspec(say) # failed print inspect.getsource(say) # failed \u5982\u679c\u8981\u5f7b\u5e95\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u501f\u7528\u7b2c\u4e09\u65b9\u5305\uff0c\u6bd4\u5982 wrapt \u3002\u540e\u6587\u6709\u4ecb\u7ecd\u3002","title":"\u9519\u8bef\u7684\u51fd\u6570\u7b7e\u540d\u548c\u6587\u6863"},{"location":"python-decorator/#staticmethod-classmethod","text":"\u5f53\u4f60\u60f3\u628a\u88c5\u9970\u5668\u7528\u5728\u4e00\u4e2a\u9759\u6001\u65b9\u6cd5\u6216\u8005\u7c7b\u65b9\u6cd5\u65f6\uff0c\u4e0d\u597d\u610f\u601d\uff0c\u62a5\u9519\u4e86\u3002 class Car(object): def __init__(self, model): self.model = model @logging # \u88c5\u9970\u5b9e\u4f8b\u65b9\u6cd5\uff0cOK def run(self): print \"{} is running!\".format(self.model) @logging # \u88c5\u9970\u9759\u6001\u65b9\u6cd5\uff0cFailed @staticmethod def check_model_for(obj): if isinstance(obj, Car): print \"The model of your car is {}\".format(obj.model) else: print \"{} is not a car!\".format(obj) \"\"\" Traceback (most recent call last): ... File \"example_4.py\", line 10, in logging @wraps(func) File \"C:\\Python27\\lib\\functools.py\", line 33, in update_wrapper setattr(wrapper, attr, getattr(wrapped, attr)) AttributeError: 'staticmethod' object has no attribute '__module__' \"\"\" \u524d\u9762\u5df2\u7ecf\u89e3\u91ca\u4e86 @ staticmethod \u8fd9\u4e2a\u88c5\u9970\u5668\uff0c\u5176\u5b9e\u5b83\u8fd4\u56de\u7684\u5e76\u4e0d\u662f\u4e00\u4e2a callable \u5bf9\u8c61\uff0c\u800c\u662f\u4e00\u4e2a staticmethod \u5bf9\u8c61\uff0c\u90a3\u4e48\u5b83\u662f\u4e0d\u7b26\u5408\u88c5\u9970\u5668\u8981\u6c42\u7684\uff08\u6bd4\u5982\u4f20\u5165\u4e00\u4e2a callable \u5bf9\u8c61\uff09\uff0c\u4f60\u81ea\u7136\u4e0d\u80fd\u5728\u5b83\u4e4b\u4e0a\u518d\u52a0\u522b\u7684\u88c5\u9970\u5668\u3002\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5f88\u7b80\u5355\uff0c\u53ea\u8981\u628a\u4f60\u7684\u88c5\u9970\u5668\u653e\u5728 @ staticmethod \u4e4b\u524d\u5c31\u597d\u4e86\uff0c\u56e0\u4e3a\u4f60\u7684\u88c5\u9970\u5668\u8fd4\u56de\u7684\u8fd8\u662f\u4e00\u4e2a\u6b63\u5e38\u7684\u51fd\u6570\uff0c\u7136\u540e\u518d\u52a0\u4e0a\u4e00\u4e2a @ staticmethod \u662f\u4e0d\u4f1a\u51fa\u95ee\u9898\u7684\u3002 class Car(object): def __init__(self, model): self.model = model @staticmethod @logging def check_model_for(obj): pass","title":"\u4e0d\u80fd\u88c5\u9970@staticmethod \u6216\u8005 @classmethod"},{"location":"python-decorator/#_10","text":"\u5d4c\u5957\u7684\u88c5\u9970\u51fd\u6570\u4e0d\u592a\u76f4\u89c2\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e09\u65b9\u5305\u7c7b\u6539\u8fdb\u8fd9\u6837\u7684\u60c5\u51b5\uff0c\u8ba9\u88c5\u9970\u5668\u51fd\u6570\u53ef\u8bfb\u6027\u66f4\u597d\u3002","title":"\u5982\u4f55\u4f18\u5316\u4f60\u7684\u88c5\u9970\u5668"},{"location":"python-decorator/#decoratorpy","text":"decorator.py \u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u88c5\u9970\u5668\u52a0\u5f3a\u5305\u3002\u4f60\u53ef\u4ee5\u5f88\u76f4\u89c2\u7684\u5148\u5b9a\u4e49\u5305\u88c5\u51fd\u6570 wrapper () \uff0c\u518d\u4f7f\u7528 decorate ( func , wrapper ) \u65b9\u6cd5\u5c31\u53ef\u4ee5\u5b8c\u6210\u4e00\u4e2a\u88c5\u9970\u5668\u3002 from decorator import decorate def wrapper(func, *args, **kwargs): \"\"\"print log before a function.\"\"\" print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__) return func(*args, **kwargs) def logging(func): return decorate(func, wrapper) # \u7528wrapper\u88c5\u9970func \u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5b83\u81ea\u5e26\u7684 @ decorator \u88c5\u9970\u5668\u6765\u5b8c\u6210\u4f60\u7684\u88c5\u9970\u5668\u3002 from decorator import decorator @decorator def logging(func, *args, **kwargs): print \"[DEBUG] {}: enter {}()\".format(datetime.now(), func.__name__) return func(*args, **kwargs) decorator.py \u5b9e\u73b0\u7684\u88c5\u9970\u5668\u80fd\u5b8c\u6574\u4fdd\u7559\u539f\u51fd\u6570\u7684 name \uff0c doc \u548c args \uff0c\u552f\u4e00\u6709\u95ee\u9898\u7684\u5c31\u662f inspect.getsource ( func ) \u8fd4\u56de\u7684\u8fd8\u662f\u88c5\u9970\u5668\u7684\u6e90\u4ee3\u7801\uff0c\u4f60\u9700\u8981\u6539\u6210 inspect.getsource ( func.__wrapped__ ) \u3002","title":"decorator.py"},{"location":"python-decorator/#wrapt","text":"wrapt \u662f\u4e00\u4e2a\u529f\u80fd\u975e\u5e38\u5b8c\u5584\u7684\u5305\uff0c\u7528\u4e8e\u5b9e\u73b0\u5404\u79cd\u4f60\u60f3\u5230\u6216\u8005\u4f60\u6ca1\u60f3\u5230\u7684\u88c5\u9970\u5668\u3002\u4f7f\u7528 wrapt \u5b9e\u73b0\u7684\u88c5\u9970\u5668\u4f60\u4e0d\u9700\u8981\u62c5\u5fc3\u4e4b\u524d inspect \u4e2d\u9047\u5230\u7684\u6240\u6709\u95ee\u9898\uff0c\u56e0\u4e3a\u5b83\u90fd\u5e2e\u4f60\u5904\u7406\u4e86\uff0c\u751a\u81f3 inspect.getsource ( func ) \u4e5f\u51c6\u786e\u65e0\u8bef\u3002 import wrapt# without argument in decorator @wrapt.decorator def logging(wrapped, instance, args, kwargs): # instance is must print \"[DEBUG]: enter {}()\".format(wrapped.__name__) return wrapped(*args, **kwargs) @logging def say(something): pass \u4f7f\u7528 wrapt \u4f60\u53ea\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u88c5\u9970\u5668\u51fd\u6570\uff0c\u4f46\u662f\u51fd\u6570\u7b7e\u540d\u662f\u56fa\u5b9a\u7684\uff0c\u5fc5\u987b\u662f ( wrapped , instance, args, kwargs ) \uff0c\u6ce8\u610f\u7b2c\u4e8c\u4e2a\u53c2\u6570 instance \u662f\u5fc5\u987b\u7684\uff0c\u5c31\u7b97\u4f60\u4e0d\u7528\u5b83\u3002\u5f53\u88c5\u9970\u5668\u88c5\u9970\u5728\u4e0d\u540c\u4f4d\u7f6e\u65f6\u5b83\u5c06\u5f97\u5230\u4e0d\u540c\u7684\u503c\uff0c\u6bd4\u5982\u88c5\u9970\u5728\u7c7b\u5b9e\u4f8b\u65b9\u6cd5\u65f6\u4f60\u53ef\u4ee5\u62ff\u5230\u8fd9\u4e2a\u7c7b\u5b9e\u4f8b\u3002\u6839\u636e instance \u7684\u503c\u4f60\u80fd\u591f\u66f4\u52a0\u7075\u6d3b\u7684\u8c03\u6574\u4f60\u7684\u88c5\u9970\u5668\u3002\u53e6\u5916\uff0c args \u548c kwargs \u4e5f\u662f\u56fa\u5b9a\u7684\uff0c\u6ce8\u610f\u524d\u9762\u6ca1\u6709\u661f\u53f7\u3002\u5728\u88c5\u9970\u5668\u5185\u90e8\u8c03\u7528\u539f\u51fd\u6570\u65f6\u624d\u5e26\u661f\u53f7\u3002 \u5982\u679c\u4f60\u9700\u8981\u4f7f\u7528 wrapt \u5199\u4e00\u4e2a\u5e26\u53c2\u6570\u7684\u88c5\u9970\u5668\uff0c\u53ef\u4ee5\u8fd9\u6837\u5199\u3002 def logging(level): @wrapt.decorator def wrapper(wrapped, instance, args, kwargs): print \"[{}]: enter {}()\".format(level, wrapped.__name__) return wrapped(*args, **kwargs) return wrapper@logging(level=\"INFO\") def do(work): pass \u5173\u4e8e wrapt \u7684\u4f7f\u7528\uff0c\u5efa\u8bae\u67e5\u9605\u5b98\u65b9\u6587\u6863\uff0c\u5728\u6b64\u4e0d\u5728\u8d58\u8ff0\u3002 http://wrapt.readthedocs.io/en/latest/quick-start.html","title":"wrapt"},{"location":"python-decorator/#_11","text":"Python \u7684\u88c5\u9970\u5668\u548c Java \u7684\u6ce8\u89e3\uff08 Annotation \uff09\u5e76\u4e0d\u662f\u540c\u4e00\u56de\u4e8b\uff0c\u548c C# \u4e2d\u7684\u7279\u6027\uff08 Attribute \uff09\u4e5f\u4e0d\u4e00\u6837\uff0c\u5b8c\u5168\u662f\u4e24\u4e2a\u6982\u5ff5\u3002 \u88c5\u9970\u5668\u7684\u7406\u5ff5\u662f\u5bf9\u539f\u51fd\u6570\u3001\u5bf9\u8c61\u7684\u52a0\u5f3a\uff0c\u76f8\u5f53\u4e8e\u91cd\u65b0\u5c01\u88c5\uff0c\u6240\u4ee5\u4e00\u822c\u88c5\u9970\u5668\u51fd\u6570\u90fd\u88ab\u547d\u540d\u4e3a wrapper () \uff0c\u610f\u4e49\u5728\u4e8e\u5305\u88c5\u3002\u51fd\u6570\u53ea\u6709\u5728\u88ab\u8c03\u7528\u65f6\u624d\u4f1a\u53d1\u6325\u5176\u4f5c\u7528\u3002\u6bd4\u5982 @ logging \u88c5\u9970\u5668\u53ef\u4ee5\u5728\u51fd\u6570\u6267\u884c\u65f6\u989d\u5916\u8f93\u51fa\u65e5\u5fd7\uff0c @ cache \u88c5\u9970\u8fc7\u7684\u51fd\u6570\u53ef\u4ee5\u7f13\u5b58\u8ba1\u7b97\u7ed3\u679c\u7b49\u7b49\u3002 \u800c\u6ce8\u89e3\u548c\u7279\u6027\u5219\u662f\u5bf9\u76ee\u6807\u51fd\u6570\u6216\u5bf9\u8c61\u6dfb\u52a0\u4e00\u4e9b\u5c5e\u6027\uff0c\u76f8\u5f53\u4e8e\u5c06\u5176\u5206\u7c7b\u3002\u8fd9\u4e9b\u5c5e\u6027\u53ef\u4ee5\u901a\u8fc7\u53cd\u5c04\u62ff\u5230\uff0c\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u5bf9\u4e0d\u540c\u7684\u7279\u6027\u51fd\u6570\u6216\u5bf9\u8c61\u52a0\u4ee5\u5e72\u9884\u3002\u6bd4\u5982\u5e26\u6709 Setup \u7684\u51fd\u6570\u5c31\u5f53\u6210\u51c6\u5907\u6b65\u9aa4\u6267\u884c\uff0c\u6216\u8005\u627e\u5230\u6240\u6709\u5e26\u6709 TestMethod \u7684\u51fd\u6570\u4f9d\u6b21\u6267\u884c\u7b49\u7b49\u3002 \u81f3\u6b64\u6211\u6240\u4e86\u89e3\u7684\u88c5\u9970\u5668\u5df2\u7ecf\u8bb2\u5b8c\uff0c\u4f46\u662f\u8fd8\u6709\u4e00\u4e9b\u5185\u5bb9\u6ca1\u6709\u63d0\u5230\uff0c\u6bd4\u5982\u88c5\u9970\u7c7b\u7684\u88c5\u9970\u5668\u3002\u6709\u673a\u4f1a\u518d\u8865\u5145\u3002\u8c22\u8c22\u89c2\u770b\u3002 \u672c\u6587\u6e90\u7801 <https://github.com/tobyqin/python_decorator","title":"\u5c0f\u7ed3"},{"location":"python-dunder/","text":"Python\u4e2d\u4e0b\u5212\u7ebf\u76845\u79cd\u542b\u4e49 \u00b6 \u672c\u6587\u4ecb\u7ecd\u4e86Python\u4e2d\u5355\u4e0b\u5212\u7ebf\u548c\u53cc\u4e0b\u5212\u7ebf\uff08\"dunder\"\uff09\u7684\u5404\u79cd\u542b\u4e49\u548c\u547d\u540d\u7ea6\u5b9a\uff0c\u540d\u79f0\u4fee\u9970\uff08name mangling\uff09\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u4ee5\u53ca\u5b83\u5982\u4f55\u5f71\u54cd\u4f60\u81ea\u5df1\u7684Python\u7c7b\u3002 \u5355\u4e0b\u5212\u7ebf\u548c\u53cc\u4e0b\u5212\u7ebf\u5728Python\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u79f0\u4e2d\u90fd\u5404\u6709\u5176\u542b\u4e49\u3002\u6709\u4e00\u4e9b\u542b\u4e49\u4ec5\u4ec5\u662f\u4f9d\u7167\u7ea6\u5b9a\uff0c\u88ab\u89c6\u4f5c\u662f\u5bf9\u7a0b\u5e8f\u5458\u7684\u63d0\u793a - \u800c\u6709\u4e00\u4e9b\u542b\u4e49\u662f\u7531Python\u89e3\u91ca\u5668\u4e25\u683c\u6267\u884c\u7684\u3002 \u5982\u679c\u4f60\u60f3\u77e5\u9053\u201cPython\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u79f0\u4e2d\u5355\u4e0b\u5212\u7ebf\u548c\u53cc\u4e0b\u5212\u7ebf\u7684\u542b\u4e49\u662f\u4ec0\u4e48\uff1f\u201d\uff0c\u6211\u4f1a\u5c3d\u6211\u6240\u80fd\u5728\u8fd9\u91cc\u4e3a\u4f60\u89e3\u7b54\u3002 \u5728\u672c\u6587\u4e2d\uff0c\u6211\u5c06\u8ba8\u8bba\u4ee5\u4e0b\u4e94\u79cd\u4e0b\u5212\u7ebf\u6a21\u5f0f\u548c\u547d\u540d\u7ea6\u5b9a\uff0c\u4ee5\u53ca\u5b83\u4eec\u5982\u4f55\u5f71\u54cdPython\u7a0b\u5e8f\u7684\u884c\u4e3a\uff1a \u5355\u524d\u5bfc\u4e0b\u5212\u7ebf\uff1a_var \u5355\u672b\u5c3e\u4e0b\u5212\u7ebf\uff1avar_ \u53cc\u524d\u5bfc\u4e0b\u5212\u7ebf\uff1a__var \u53cc\u524d\u5bfc\u548c\u672b\u5c3e\u4e0b\u5212\u7ebf\uff1a__var__ \u5355\u4e0b\u5212\u7ebf\uff1a_ \u5728\u6587\u7ae0\u7ed3\u5c3e\u5904\uff0c\u4f60\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u7b80\u77ed\u7684\u201c\u901f\u67e5\u8868\u201d\uff0c\u603b\u7ed3\u4e86\u4e94\u79cd\u4e0d\u540c\u7684\u4e0b\u5212\u7ebf\u547d\u540d\u7ea6\u5b9a\u53ca\u5176\u542b\u4e49\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7b80\u77ed\u7684\u89c6\u9891\u6559\u7a0b\uff0c\u53ef\u8ba9\u4f60\u4eb2\u8eab\u4f53\u9a8c\u5b83\u4eec\u7684\u884c\u4e3a\u3002 1. \u5355\u524d\u5bfc\u4e0b\u5212\u7ebf _var \u00b6 \u5f53\u6d89\u53ca\u5230\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u79f0\u65f6\uff0c\u5355\u4e2a\u4e0b\u5212\u7ebf\u524d\u7f00\u6709\u4e00\u4e2a\u7ea6\u5b9a\u4fd7\u6210\u7684\u542b\u4e49\u3002 \u5b83\u662f\u5bf9\u7a0b\u5e8f\u5458\u7684\u4e00\u4e2a\u63d0\u793a - \u610f\u5473\u7740Python\u793e\u533a\u4e00\u81f4\u8ba4\u4e3a\u5b83\u5e94\u8be5\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u4f46\u7a0b\u5e8f\u7684\u884c\u4e3a\u4e0d\u53d7\u5f71\u54cd\u3002 \u4e0b\u5212\u7ebf\u524d\u7f00\u7684\u542b\u4e49\u662f\u544a\u77e5\u5176\u4ed6\u7a0b\u5e8f\u5458\uff1a\u4ee5\u5355\u4e2a\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\u53d8\u91cf\u6216\u65b9\u6cd5\u4ec5\u4f9b\u5185\u90e8\u4f7f\u7528\u3002 \u8be5\u7ea6\u5b9a\u5728PEP 8\u4e2d\u6709\u5b9a\u4e49\u3002 \u8fd9\u4e0d\u662fPython\u5f3a\u5236\u89c4\u5b9a\u7684\u3002 Python\u4e0d\u50cfJava\u90a3\u6837\u5728\u201c\u79c1\u6709\u201d\u548c\u201c\u516c\u5171\u201d\u53d8\u91cf\u4e4b\u95f4\u6709\u5f88\u5f3a\u7684\u533a\u522b\u3002 \u8fd9\u5c31\u50cf\u6709\u4eba\u63d0\u51fa\u4e86\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4e0b\u5212\u7ebf\u8b66\u544a\u6807\u5fd7\uff0c\u8bf4\uff1a \u201c\u563f\uff0c\u8fd9\u4e0d\u662f\u771f\u7684\u8981\u6210\u4e3a\u7c7b\u7684\u516c\u5171\u63a5\u53e3\u7684\u4e00\u90e8\u5206\u3002\u4e0d\u53bb\u7ba1\u5b83\u5c31\u597d\u3002\u201c \u770b\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a class Test: def __init__(self): self.foo = 11 self._bar = 23 \u5982\u679c\u4f60\u5b9e\u4f8b\u5316\u6b64\u7c7b\uff0c\u5e76\u5c1d\u8bd5\u8bbf\u95ee\u5728__init__\u6784\u9020\u51fd\u6570\u4e2d\u5b9a\u4e49\u7684foo\u548c_bar\u5c5e\u6027\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\uff1f \u8ba9\u6211\u4eec\u6765\u770b\u770b\uff1a >>> t = Test() >>> t.foo 11 >>> t._bar 23 \u4f60\u4f1a\u770b\u5230_bar\u4e2d\u7684\u5355\u4e2a\u4e0b\u5212\u7ebf\u5e76\u6ca1\u6709\u963b\u6b62\u6211\u4eec\u201c\u8fdb\u5165\u201d\u7c7b\u5e76\u8bbf\u95ee\u8be5\u53d8\u91cf\u7684\u503c\u3002 \u8fd9\u662f\u56e0\u4e3aPython\u4e2d\u7684\u5355\u4e2a\u4e0b\u5212\u7ebf\u524d\u7f00\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7ea6\u5b9a - \u81f3\u5c11\u76f8\u5bf9\u4e8e\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u800c\u8a00\u3002 \u4f46\u662f\uff0c\u524d\u5bfc\u4e0b\u5212\u7ebf\u7684\u786e\u4f1a\u5f71\u54cd\u4ece\u6a21\u5757\u4e2d\u5bfc\u5165\u540d\u79f0\u7684\u65b9\u5f0f\u3002 \u5047\u8bbe\u4f60\u5728\u4e00\u4e2a\u540d\u4e3amy_module\u7684\u6a21\u5757\u4e2d\u6709\u4ee5\u4e0b\u4ee3\u7801\uff1a # This is my_module.py: def external_func(): return 23 def _internal_func(): return 42 \u73b0\u5728\uff0c\u5982\u679c\u4f7f\u7528\u901a\u914d\u7b26\u4ece\u6a21\u5757\u4e2d\u5bfc\u5165\u6240\u6709\u540d\u79f0\uff0c\u5219Python\u4e0d\u4f1a\u5bfc\u5165\u5e26\u6709\u524d\u5bfc\u4e0b\u5212\u7ebf\u7684\u540d\u79f0\uff08\u9664\u975e\u6a21\u5757\u5b9a\u4e49\u4e86\u8986\u76d6\u6b64\u884c\u4e3a\u7684__all__\u5217\u8868\uff09\uff1a >>> from my_module import * >>> external_func() 23 >>> _internal_func() NameError: \"name '_internal_func' is not defined\" \u987a\u4fbf\u8bf4\u4e00\u4e0b\uff0c\u5e94\u8be5\u907f\u514d\u901a\u914d\u7b26\u5bfc\u5165\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f7f\u540d\u79f0\u7a7a\u95f4\u4e2d\u5b58\u5728\u54ea\u4e9b\u540d\u79f0\u4e0d\u6e05\u695a\u3002 \u4e3a\u4e86\u6e05\u695a\u8d77\u89c1\uff0c\u575a\u6301\u5e38\u89c4\u5bfc\u5165\u66f4\u597d\u3002 \u4e0e\u901a\u914d\u7b26\u5bfc\u5165\u4e0d\u540c\uff0c\u5e38\u89c4\u5bfc\u5165\u4e0d\u53d7\u524d\u5bfc\u5355\u4e2a\u4e0b\u5212\u7ebf\u547d\u540d\u7ea6\u5b9a\u7684\u5f71\u54cd\uff1a >>> import my_module >>> my_module.external_func() 23 >>> my_module._internal_func() 42 \u6211\u77e5\u9053\u8fd9\u4e00\u70b9\u53ef\u80fd\u6709\u70b9\u4ee4\u4eba\u56f0\u60d1\u3002 \u5982\u679c\u4f60\u9075\u5faaPEP 8\u63a8\u8350\uff0c\u907f\u514d\u901a\u914d\u7b26\u5bfc\u5165\uff0c\u90a3\u4e48\u4f60\u771f\u6b63\u9700\u8981\u8bb0\u4f4f\u7684\u53ea\u6709\u8fd9\u4e2a\uff1a \u5355\u4e2a\u4e0b\u5212\u7ebf\u662f\u4e00\u4e2aPython\u547d\u540d\u7ea6\u5b9a\uff0c\u8868\u793a\u8fd9\u4e2a\u540d\u79f0\u662f\u4f9b\u5185\u90e8\u4f7f\u7528\u7684\u3002 \u5b83\u901a\u5e38\u4e0d\u7531Python\u89e3\u91ca\u5668\u5f3a\u5236\u6267\u884c\uff0c\u4ec5\u4ec5\u4f5c\u4e3a\u4e00\u79cd\u5bf9\u7a0b\u5e8f\u5458\u7684\u63d0\u793a\u3002 2. \u5355\u672b\u5c3e\u4e0b\u5212\u7ebf var_ \u00b6 \u6709\u65f6\u5019\uff0c\u4e00\u4e2a\u53d8\u91cf\u7684\u6700\u5408\u9002\u7684\u540d\u79f0\u5df2\u7ecf\u88ab\u4e00\u4e2a\u5173\u952e\u5b57\u6240\u5360\u7528\u3002 \u56e0\u6b64\uff0c\u50cfclass\u6216def\u8fd9\u6837\u7684\u540d\u79f0\u4e0d\u80fd\u7528\u4f5cPython\u4e2d\u7684\u53d8\u91cf\u540d\u79f0\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u4ee5\u9644\u52a0\u4e00\u4e2a\u4e0b\u5212\u7ebf\u6765\u89e3\u51b3\u547d\u540d\u51b2\u7a81\uff1a >>> def make_object(name, class): SyntaxError: \"invalid syntax\" >>> def make_object(name, class_): pass \u603b\u4e4b\uff0c\u5355\u4e2a\u672b\u5c3e\u4e0b\u5212\u7ebf\uff08\u540e\u7f00\uff09\u662f\u4e00\u4e2a\u7ea6\u5b9a\uff0c\u7528\u6765\u907f\u514d\u4e0ePython\u5173\u952e\u5b57\u4ea7\u751f\u547d\u540d\u51b2\u7a81\u3002 PEP 8\u89e3\u91ca\u4e86\u8fd9\u4e2a\u7ea6\u5b9a\u3002 3. \u53cc\u524d\u5bfc\u4e0b\u5212\u7ebf __var \u00b6 \u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u6240\u6d89\u53ca\u7684\u6240\u6709\u547d\u540d\u6a21\u5f0f\u7684\u542b\u4e49\uff0c\u6765\u81ea\u4e8e\u5df2\u8fbe\u6210\u5171\u8bc6\u7684\u7ea6\u5b9a\u3002 \u800c\u5bf9\u4e8e\u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u5934\u7684Python\u7c7b\u7684\u5c5e\u6027\uff08\u5305\u62ec\u53d8\u91cf\u548c\u65b9\u6cd5\uff09\uff0c\u60c5\u51b5\u5c31\u6709\u70b9\u4e0d\u540c\u4e86\u3002 \u53cc\u4e0b\u5212\u7ebf\u524d\u7f00\u4f1a\u5bfc\u81f4Python\u89e3\u91ca\u5668\u91cd\u5199\u5c5e\u6027\u540d\u79f0\uff0c\u4ee5\u907f\u514d\u5b50\u7c7b\u4e2d\u7684\u547d\u540d\u51b2\u7a81\u3002 \u8fd9\u4e5f\u53eb\u505a\u540d\u79f0\u4fee\u9970\uff08name mangling\uff09 - \u89e3\u91ca\u5668\u66f4\u6539\u53d8\u91cf\u7684\u540d\u79f0\uff0c\u4ee5\u4fbf\u5728\u7c7b\u88ab\u6269\u5c55\u7684\u65f6\u5019\u4e0d\u5bb9\u6613\u4ea7\u751f\u51b2\u7a81\u3002 \u6211\u77e5\u9053\u8fd9\u542c\u8d77\u6765\u5f88\u62bd\u8c61\u3002 \u56e0\u6b64\uff0c\u6211\u7ec4\u5408\u4e86\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4ee3\u7801\u793a\u4f8b\u6765\u4e88\u4ee5\u8bf4\u660e\uff1a class Test: def __init__(self): self.foo = 11 self._bar = 23 self.__baz = 23 \u8ba9\u6211\u4eec\u7528\u5185\u7f6e\u7684dir()\u51fd\u6570\u6765\u770b\u770b\u8fd9\u4e2a\u5bf9\u8c61\u7684\u5c5e\u6027\uff1a >>> t = Test() >>> dir(t) ['_Test__baz', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_bar', 'foo'] \u4ee5\u4e0a\u662f\u8fd9\u4e2a\u5bf9\u8c61\u5c5e\u6027\u7684\u5217\u8868\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e2a\u5217\u8868\uff0c\u5e76\u5bfb\u627e\u6211\u4eec\u7684\u539f\u59cb\u53d8\u91cf\u540d\u79f0foo\uff0c_bar\u548c__baz - \u6211\u4fdd\u8bc1\u4f60\u4f1a\u6ce8\u610f\u5230\u4e00\u4e9b\u6709\u8da3\u7684\u53d8\u5316\u3002 - self.foo\u53d8\u91cf\u5728\u5c5e\u6027\u5217\u8868\u4e2d\u663e\u793a\u4e3a\u672a\u4fee\u6539\u4e3afoo\u3002 - self._bar\u7684\u884c\u4e3a\u65b9\u5f0f\u76f8\u540c - \u5b83\u4ee5_bar\u7684\u5f62\u5f0f\u663e\u793a\u5728\u7c7b\u4e0a\u3002 \u5c31\u50cf\u6211\u4e4b\u524d\u8bf4\u8fc7\u7684\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u524d\u5bfc\u4e0b\u5212\u7ebf\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7ea6\u5b9a\u3002 \u7ed9\u7a0b\u5e8f\u5458\u4e00\u4e2a\u63d0\u793a\u800c\u5df2\u3002 - \u7136\u800c\uff0c\u5bf9\u4e8eself.__baz\u800c\u8a00\uff0c\u60c5\u51b5\u770b\u8d77\u6765\u6709\u70b9\u4e0d\u540c\u3002 \u5f53\u4f60\u5728\u8be5\u5217\u8868\u4e2d\u641c\u7d22__baz\u65f6\uff0c\u4f60\u4f1a\u770b\u4e0d\u5230\u6709\u8fd9\u4e2a\u540d\u5b57\u7684\u53d8\u91cf\u3002 __baz\u51fa\u4ec0\u4e48\u60c5\u51b5\u4e86\uff1f \u5982\u679c\u4f60\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u4f60\u4f1a\u770b\u5230\u6b64\u5bf9\u8c61\u4e0a\u6709\u4e00\u4e2a\u540d\u4e3a_Test__baz\u7684\u5c5e\u6027\u3002 \u8fd9\u5c31\u662fPython\u89e3\u91ca\u5668\u6240\u505a\u7684\u540d\u79f0\u4fee\u9970\u3002 \u5b83\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u9632\u6b62\u53d8\u91cf\u5728\u5b50\u7c7b\u4e2d\u88ab\u91cd\u5199\u3002 \u8ba9\u6211\u4eec\u521b\u5efa\u53e6\u4e00\u4e2a\u6269\u5c55Test\u7c7b\u7684\u7c7b\uff0c\u5e76\u5c1d\u8bd5\u91cd\u5199\u6784\u9020\u51fd\u6570\u4e2d\u6dfb\u52a0\u7684\u73b0\u6709\u5c5e\u6027\uff1a class ExtendedTest(Test): def __init__(self): super().__init__() self.foo = 'overridden' self._bar = 'overridden' self.__baz = 'overridden' \u73b0\u5728\uff0c\u4f60\u8ba4\u4e3afoo\uff0c_bar\u548c__baz\u7684\u503c\u4f1a\u51fa\u73b0\u5728\u8fd9\u4e2aExtendedTest\u7c7b\u7684\u5b9e\u4f8b\u4e0a\u5417\uff1f \u6211\u4eec\u6765\u770b\u4e00\u770b\uff1a >>> t2 = ExtendedTest() >>> t2.foo 'overridden' >>> t2._bar 'overridden' >>> t2.__baz AttributeError: \"'ExtendedTest' object has no attribute '__baz'\" \u7b49\u4e00\u4e0b\uff0c\u5f53\u6211\u4eec\u5c1d\u8bd5\u67e5\u770bt2 .__ baz\u7684\u503c\u65f6\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u4f1a\u5f97\u5230AttributeError\uff1f \u540d\u79f0\u4fee\u9970\u88ab\u518d\u6b21\u89e6\u53d1\u4e86\uff01 \u4e8b\u5b9e\u8bc1\u660e\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u751a\u81f3\u6ca1\u6709__baz\u5c5e\u6027\uff1a >>> dir(t2) ['_ExtendedTest__baz', '_Test__baz', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_bar', 'foo', 'get_vars'] \u6b63\u5982\u4f60\u53ef\u4ee5\u770b\u5230__baz\u53d8\u6210_ExtendedTest__baz\u4ee5\u9632\u6b62\u610f\u5916\u4fee\u6539\uff1a >>> t2._ExtendedTest__baz 'overridden' \u4f46\u539f\u6765\u7684_Test__baz\u8fd8\u5728\uff1a >>> t2._Test__baz 42 \u53cc\u4e0b\u5212\u7ebf\u540d\u79f0\u4fee\u9970\u5bf9\u7a0b\u5e8f\u5458\u662f\u5b8c\u5168\u900f\u660e\u7684\u3002 \u4e0b\u9762\u7684\u4f8b\u5b50\u8bc1\u5b9e\u4e86\u8fd9\u4e00\u70b9\uff1a class ManglingTest: def __init__(self): self.__mangled = 'hello' def get_mangled(self): return self.__mangled >>> ManglingTest().get_mangled() 'hello' >>> ManglingTest().__mangled AttributeError: \"'ManglingTest' object has no attribute '__mangled'\" \u540d\u79f0\u4fee\u9970\u662f\u5426\u4e5f\u9002\u7528\u4e8e\u65b9\u6cd5\u540d\u79f0\uff1f \u662f\u7684\uff0c\u4e5f\u9002\u7528\u3002\u540d\u79f0\u4fee\u9970\u4f1a\u5f71\u54cd\u5728\u4e00\u4e2a\u7c7b\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u4ee5\u4e24\u4e2a\u4e0b\u5212\u7ebf\u5b57\u7b26\uff08\"dunders\"\uff09\u5f00\u5934\u7684\u6240\u6709\u540d\u79f0\uff1a class MangledMethod: def __method(self): return 42 def call_it(self): return self.__method() >>> MangledMethod().__method() AttributeError: \"'MangledMethod' object has no attribute '__method'\" >>> MangledMethod().call_it() 42 \u8fd9\u662f\u53e6\u4e00\u4e2a\u4e5f\u8bb8\u4ee4\u4eba\u60ca\u8bb6\u7684\u8fd0\u7528\u540d\u79f0\u4fee\u9970\u7684\u4f8b\u5b50\uff1a _MangledGlobal__mangled = 23 class MangledGlobal: def test(self): return __mangled >>> MangledGlobal().test() 23 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u58f0\u660e\u4e86\u4e00\u4e2a\u540d\u4e3a_MangledGlobal__mangled\u7684\u5168\u5c40\u53d8\u91cf\u3002\u7136\u540e\u6211\u5728\u540d\u4e3aMangledGlobal\u7684\u7c7b\u7684\u4e0a\u4e0b\u6587\u4e2d\u8bbf\u95ee\u53d8\u91cf\u3002\u7531\u4e8e\u540d\u79f0\u4fee\u9970\uff0c\u6211\u80fd\u591f\u5728\u7c7b\u7684test()\u65b9\u6cd5\u5185\uff0c\u4ee5__mangled\u6765\u5f15\u7528_MangledGlobal__mangled\u5168\u5c40\u53d8\u91cf\u3002 Python\u89e3\u91ca\u5668\u81ea\u52a8\u5c06\u540d\u79f0__mangled\u6269\u5c55\u4e3a_MangledGlobal__mangled\uff0c\u56e0\u4e3a\u5b83\u4ee5\u4e24\u4e2a\u4e0b\u5212\u7ebf\u5b57\u7b26\u5f00\u5934\u3002\u8fd9\u8868\u660e\u540d\u79f0\u4fee\u9970\u4e0d\u662f\u4e13\u95e8\u4e0e\u7c7b\u5c5e\u6027\u5173\u8054\u7684\u3002\u5b83\u9002\u7528\u4e8e\u5728\u7c7b\u4e0a\u4e0b\u6587\u4e2d\u4f7f\u7528\u7684\u4e24\u4e2a\u4e0b\u5212\u7ebf\u5b57\u7b26\u5f00\u5934\u7684\u4efb\u4f55\u540d\u79f0\u3002 \u6709\u5f88\u591a\u8981\u5438\u6536\u7684\u5185\u5bb9\u5427\u3002 \u8001\u5b9e\u8bf4\uff0c\u8fd9\u4e9b\u4f8b\u5b50\u548c\u89e3\u91ca\u4e0d\u662f\u4ece\u6211\u8111\u5b50\u91cc\u8e66\u51fa\u6765\u7684\u3002\u6211\u4f5c\u4e86\u4e00\u4e9b\u7814\u7a76\u548c\u52a0\u5de5\u624d\u5f04\u51fa\u6765\u3002\u6211\u4e00\u76f4\u4f7f\u7528Python\uff0c\u6709\u5f88\u591a\u5e74\u4e86\uff0c\u4f46\u662f\u50cf\u8fd9\u6837\u7684\u89c4\u5219\u548c\u7279\u6b8a\u60c5\u51b5\u5e76\u4e0d\u603b\u662f\u6d6e\u73b0\u5728\u8111\u6d77\u91cc\u3002 \u6709\u65f6\u5019\u7a0b\u5e8f\u5458\u6700\u91cd\u8981\u7684\u6280\u80fd\u662f\u201c\u6a21\u5f0f\u8bc6\u522b\u201d\uff0c\u800c\u4e14\u77e5\u9053\u5728\u54ea\u91cc\u67e5\u9605\u4fe1\u606f\u3002\u5982\u679c\u60a8\u5728\u8fd9\u4e00\u70b9\u4e0a\u611f\u5230\u6709\u70b9\u4e0d\u77e5\u6240\u63aa\uff0c\u8bf7\u4e0d\u8981\u62c5\u5fc3\u3002\u6162\u6162\u6765\uff0c\u8bd5\u8bd5\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u7684\u4e00\u4e9b\u4f8b\u5b50\u3002 \u8ba9\u8fd9\u4e9b\u6982\u5ff5\u5b8c\u5168\u6c89\u6d78\u4e0b\u6765\uff0c\u4ee5\u4fbf\u4f60\u80fd\u591f\u7406\u89e3\u540d\u79f0\u4fee\u9970\u7684\u603b\u4f53\u601d\u8def\uff0c\u4ee5\u53ca\u6211\u5411\u60a8\u5c55\u793a\u7684\u4e00\u4e9b\u5176\u4ed6\u7684\u884c\u4e3a\u3002\u5982\u679c\u6709\u4e00\u5929\u4f60\u548c\u5b83\u4eec\u4e0d\u671f\u800c\u9047\uff0c\u4f60\u4f1a\u77e5\u9053\u5728\u6587\u6863\u4e2d\u6309\u4ec0\u4e48\u6765\u67e5\u3002 4. \u53cc\u524d\u5bfc\u548c\u53cc\u672b\u5c3e\u4e0b\u5212\u7ebf var \u00b6 \u4e5f\u8bb8\u4ee4\u4eba\u60ca\u8bb6\u7684\u662f\uff0c\u5982\u679c\u4e00\u4e2a\u540d\u5b57\u540c\u65f6\u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u59cb\u548c\u7ed3\u675f\uff0c\u5219\u4e0d\u4f1a\u5e94\u7528\u540d\u79f0\u4fee\u9970\u3002 \u7531\u53cc\u4e0b\u5212\u7ebf\u524d\u7f00\u548c\u540e\u7f00\u5305\u56f4\u7684\u53d8\u91cf\u4e0d\u4f1a\u88abPython\u89e3\u91ca\u5668\u4fee\u6539\uff1a class PrefixPostfixTest: def __init__(self): self.__bam__ = 42 >>> PrefixPostfixTest().__bam__ 42 \u4f46\u662f\uff0cPython\u4fdd\u7559\u4e86\u6709\u53cc\u524d\u5bfc\u548c\u53cc\u672b\u5c3e\u4e0b\u5212\u7ebf\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u7279\u6b8a\u7528\u9014\u3002 \u8fd9\u6837\u7684\u4f8b\u5b50\u6709\uff0c init__\u5bf9\u8c61\u6784\u9020\u51fd\u6570\uff0c\u6216__call --- \u5b83\u4f7f\u5f97\u4e00\u4e2a\u5bf9\u8c61\u53ef\u4ee5\u88ab\u8c03\u7528\u3002 \u8fd9\u4e9bdunder\u65b9\u6cd5\u901a\u5e38\u88ab\u79f0\u4e3a\u795e\u5947\u65b9\u6cd5 - \u4f46Python\u793e\u533a\u4e2d\u7684\u8bb8\u591a\u4eba\uff08\u5305\u62ec\u6211\u81ea\u5df1\uff09\u90fd\u4e0d\u559c\u6b22\u8fd9\u79cd\u65b9\u6cd5\u3002 \u6700\u597d\u907f\u514d\u5728\u81ea\u5df1\u7684\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u4ee5\u53cc\u4e0b\u5212\u7ebf\uff08\u201cdunders\u201d\uff09\u5f00\u5934\u548c\u7ed3\u5c3e\u7684\u540d\u79f0\uff0c\u4ee5\u907f\u514d\u4e0e\u5c06\u6765Python\u8bed\u8a00\u7684\u53d8\u5316\u4ea7\u751f\u51b2\u7a81\u3002 5.\u5355\u4e0b\u5212\u7ebf _ \u00b6 \u6309\u7167\u4e60\u60ef\uff0c\u6709\u65f6\u5019\u5355\u4e2a\u72ec\u7acb\u4e0b\u5212\u7ebf\u662f\u7528\u4f5c\u4e00\u4e2a\u540d\u5b57\uff0c\u6765\u8868\u793a\u67d0\u4e2a\u53d8\u91cf\u662f\u4e34\u65f6\u7684\u6216\u65e0\u5173\u7d27\u8981\u7684\u3002 \u4f8b\u5982\uff0c\u5728\u4e0b\u9762\u7684\u5faa\u73af\u4e2d\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u8bbf\u95ee\u6b63\u5728\u8fd0\u884c\u7684\u7d22\u5f15\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u201c_\u201d\u6765\u8868\u793a\u5b83\u53ea\u662f\u4e00\u4e2a\u4e34\u65f6\u503c\uff1a >>> for _ in range(32): ... print('Hello, World.') \u4f60\u4e5f\u53ef\u4ee5\u5728\u62c6\u5206(unpacking)\u8868\u8fbe\u5f0f\u4e2d\u5c06\u5355\u4e2a\u4e0b\u5212\u7ebf\u7528\u4f5c\u201c\u4e0d\u5173\u5fc3\u7684\u201d\u53d8\u91cf\uff0c\u4ee5\u5ffd\u7565\u7279\u5b9a\u7684\u503c\u3002 \u540c\u6837\uff0c\u8fd9\u4e2a\u542b\u4e49\u53ea\u662f\u201c\u4f9d\u7167\u7ea6\u5b9a\u201d\uff0c\u5e76\u4e0d\u4f1a\u5728Python\u89e3\u91ca\u5668\u4e2d\u89e6\u53d1\u7279\u6b8a\u7684\u884c\u4e3a\u3002 \u5355\u4e2a\u4e0b\u5212\u7ebf\u4ec5\u4ec5\u662f\u4e00\u4e2a\u6709\u6548\u7684\u53d8\u91cf\u540d\u79f0\uff0c\u4f1a\u6709\u8fd9\u4e2a\u7528\u9014\u800c\u5df2\u3002 \u5728\u4e0b\u9762\u7684\u4ee3\u7801\u793a\u4f8b\u4e2d\uff0c\u6211\u5c06\u6c7d\u8f66\u5143\u7ec4\u62c6\u5206\u4e3a\u5355\u72ec\u7684\u53d8\u91cf\uff0c\u4f46\u6211\u53ea\u5bf9\u989c\u8272\u548c\u91cc\u7a0b\u503c\u611f\u5174\u8da3\u3002 \u4f46\u662f\uff0c\u4e3a\u4e86\u4f7f\u62c6\u5206\u8868\u8fbe\u5f0f\u6210\u529f\u8fd0\u884c\uff0c\u6211\u9700\u8981\u5c06\u5305\u542b\u5728\u5143\u7ec4\u4e2d\u7684\u6240\u6709\u503c\u5206\u914d\u7ed9\u53d8\u91cf\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u201c_\u201d\u4f5c\u4e3a\u5360\u4f4d\u7b26\u53d8\u91cf\u53ef\u4ee5\u6d3e\u4e0a\u7528\u573a\uff1a >>> car = ('red', 'auto', 12, 3812.4) >>> color, _, _, mileage = car >>> color 'red' >>> mileage 3812.4 >>> _ 12 \u9664\u4e86\u7528\u4f5c\u4e34\u65f6\u53d8\u91cf\u4e4b\u5916\uff0c\u201c_\u201d\u662f\u5927\u591a\u6570Python REPL\u4e2d\u7684\u4e00\u4e2a\u7279\u6b8a\u53d8\u91cf\uff0c\u5b83\u8868\u793a\u7531\u89e3\u91ca\u5668\u8bc4\u4f30\u7684\u6700\u8fd1\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u3002 \u8fd9\u6837\u5c31\u5f88\u65b9\u4fbf\u4e86\uff0c\u6bd4\u5982\u4f60\u53ef\u4ee5\u5728\u4e00\u4e2a\u89e3\u91ca\u5668\u4f1a\u8bdd\u4e2d\u8bbf\u95ee\u5148\u524d\u8ba1\u7b97\u7684\u7ed3\u679c\uff0c\u6216\u8005\uff0c\u4f60\u662f\u5728\u52a8\u6001\u6784\u5efa\u591a\u4e2a\u5bf9\u8c61\u5e76\u4e0e\u5b83\u4eec\u4ea4\u4e92\uff0c\u65e0\u9700\u4e8b\u5148\u7ed9\u8fd9\u4e9b\u5bf9\u8c61\u5206\u914d\u540d\u5b57\uff1a >>> 20 + 3 23 >>> _ 23 >>> print(_) 23 >>> list() [] >>> _.append(1) >>> _.append(2) >>> _.append(3) >>> _ [1, 2, 3] Python\u4e0b\u5212\u7ebf\u547d\u540d\u6a21\u5f0f - \u5c0f\u7ed3 \u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u77ed\u7684\u5c0f\u7ed3\uff0c\u5373\u201c\u901f\u67e5\u8868\u201d\uff0c\u7f57\u5217\u4e86\u6211\u5728\u672c\u6587\u4e2d\u8c08\u5230\u7684\u4e94\u79cdPython\u4e0b\u5212\u7ebf\u6a21\u5f0f\u7684\u542b\u4e49\uff1a","title":"5\u79cd\u4e0b\u5212\u7ebf"},{"location":"python-dunder/#python5","text":"\u672c\u6587\u4ecb\u7ecd\u4e86Python\u4e2d\u5355\u4e0b\u5212\u7ebf\u548c\u53cc\u4e0b\u5212\u7ebf\uff08\"dunder\"\uff09\u7684\u5404\u79cd\u542b\u4e49\u548c\u547d\u540d\u7ea6\u5b9a\uff0c\u540d\u79f0\u4fee\u9970\uff08name mangling\uff09\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u4ee5\u53ca\u5b83\u5982\u4f55\u5f71\u54cd\u4f60\u81ea\u5df1\u7684Python\u7c7b\u3002 \u5355\u4e0b\u5212\u7ebf\u548c\u53cc\u4e0b\u5212\u7ebf\u5728Python\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u79f0\u4e2d\u90fd\u5404\u6709\u5176\u542b\u4e49\u3002\u6709\u4e00\u4e9b\u542b\u4e49\u4ec5\u4ec5\u662f\u4f9d\u7167\u7ea6\u5b9a\uff0c\u88ab\u89c6\u4f5c\u662f\u5bf9\u7a0b\u5e8f\u5458\u7684\u63d0\u793a - \u800c\u6709\u4e00\u4e9b\u542b\u4e49\u662f\u7531Python\u89e3\u91ca\u5668\u4e25\u683c\u6267\u884c\u7684\u3002 \u5982\u679c\u4f60\u60f3\u77e5\u9053\u201cPython\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u79f0\u4e2d\u5355\u4e0b\u5212\u7ebf\u548c\u53cc\u4e0b\u5212\u7ebf\u7684\u542b\u4e49\u662f\u4ec0\u4e48\uff1f\u201d\uff0c\u6211\u4f1a\u5c3d\u6211\u6240\u80fd\u5728\u8fd9\u91cc\u4e3a\u4f60\u89e3\u7b54\u3002 \u5728\u672c\u6587\u4e2d\uff0c\u6211\u5c06\u8ba8\u8bba\u4ee5\u4e0b\u4e94\u79cd\u4e0b\u5212\u7ebf\u6a21\u5f0f\u548c\u547d\u540d\u7ea6\u5b9a\uff0c\u4ee5\u53ca\u5b83\u4eec\u5982\u4f55\u5f71\u54cdPython\u7a0b\u5e8f\u7684\u884c\u4e3a\uff1a \u5355\u524d\u5bfc\u4e0b\u5212\u7ebf\uff1a_var \u5355\u672b\u5c3e\u4e0b\u5212\u7ebf\uff1avar_ \u53cc\u524d\u5bfc\u4e0b\u5212\u7ebf\uff1a__var \u53cc\u524d\u5bfc\u548c\u672b\u5c3e\u4e0b\u5212\u7ebf\uff1a__var__ \u5355\u4e0b\u5212\u7ebf\uff1a_ \u5728\u6587\u7ae0\u7ed3\u5c3e\u5904\uff0c\u4f60\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u7b80\u77ed\u7684\u201c\u901f\u67e5\u8868\u201d\uff0c\u603b\u7ed3\u4e86\u4e94\u79cd\u4e0d\u540c\u7684\u4e0b\u5212\u7ebf\u547d\u540d\u7ea6\u5b9a\u53ca\u5176\u542b\u4e49\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7b80\u77ed\u7684\u89c6\u9891\u6559\u7a0b\uff0c\u53ef\u8ba9\u4f60\u4eb2\u8eab\u4f53\u9a8c\u5b83\u4eec\u7684\u884c\u4e3a\u3002","title":"Python\u4e2d\u4e0b\u5212\u7ebf\u76845\u79cd\u542b\u4e49"},{"location":"python-dunder/#1-_var","text":"\u5f53\u6d89\u53ca\u5230\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u79f0\u65f6\uff0c\u5355\u4e2a\u4e0b\u5212\u7ebf\u524d\u7f00\u6709\u4e00\u4e2a\u7ea6\u5b9a\u4fd7\u6210\u7684\u542b\u4e49\u3002 \u5b83\u662f\u5bf9\u7a0b\u5e8f\u5458\u7684\u4e00\u4e2a\u63d0\u793a - \u610f\u5473\u7740Python\u793e\u533a\u4e00\u81f4\u8ba4\u4e3a\u5b83\u5e94\u8be5\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u4f46\u7a0b\u5e8f\u7684\u884c\u4e3a\u4e0d\u53d7\u5f71\u54cd\u3002 \u4e0b\u5212\u7ebf\u524d\u7f00\u7684\u542b\u4e49\u662f\u544a\u77e5\u5176\u4ed6\u7a0b\u5e8f\u5458\uff1a\u4ee5\u5355\u4e2a\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\u53d8\u91cf\u6216\u65b9\u6cd5\u4ec5\u4f9b\u5185\u90e8\u4f7f\u7528\u3002 \u8be5\u7ea6\u5b9a\u5728PEP 8\u4e2d\u6709\u5b9a\u4e49\u3002 \u8fd9\u4e0d\u662fPython\u5f3a\u5236\u89c4\u5b9a\u7684\u3002 Python\u4e0d\u50cfJava\u90a3\u6837\u5728\u201c\u79c1\u6709\u201d\u548c\u201c\u516c\u5171\u201d\u53d8\u91cf\u4e4b\u95f4\u6709\u5f88\u5f3a\u7684\u533a\u522b\u3002 \u8fd9\u5c31\u50cf\u6709\u4eba\u63d0\u51fa\u4e86\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4e0b\u5212\u7ebf\u8b66\u544a\u6807\u5fd7\uff0c\u8bf4\uff1a \u201c\u563f\uff0c\u8fd9\u4e0d\u662f\u771f\u7684\u8981\u6210\u4e3a\u7c7b\u7684\u516c\u5171\u63a5\u53e3\u7684\u4e00\u90e8\u5206\u3002\u4e0d\u53bb\u7ba1\u5b83\u5c31\u597d\u3002\u201c \u770b\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a class Test: def __init__(self): self.foo = 11 self._bar = 23 \u5982\u679c\u4f60\u5b9e\u4f8b\u5316\u6b64\u7c7b\uff0c\u5e76\u5c1d\u8bd5\u8bbf\u95ee\u5728__init__\u6784\u9020\u51fd\u6570\u4e2d\u5b9a\u4e49\u7684foo\u548c_bar\u5c5e\u6027\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\uff1f \u8ba9\u6211\u4eec\u6765\u770b\u770b\uff1a >>> t = Test() >>> t.foo 11 >>> t._bar 23 \u4f60\u4f1a\u770b\u5230_bar\u4e2d\u7684\u5355\u4e2a\u4e0b\u5212\u7ebf\u5e76\u6ca1\u6709\u963b\u6b62\u6211\u4eec\u201c\u8fdb\u5165\u201d\u7c7b\u5e76\u8bbf\u95ee\u8be5\u53d8\u91cf\u7684\u503c\u3002 \u8fd9\u662f\u56e0\u4e3aPython\u4e2d\u7684\u5355\u4e2a\u4e0b\u5212\u7ebf\u524d\u7f00\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7ea6\u5b9a - \u81f3\u5c11\u76f8\u5bf9\u4e8e\u53d8\u91cf\u548c\u65b9\u6cd5\u540d\u800c\u8a00\u3002 \u4f46\u662f\uff0c\u524d\u5bfc\u4e0b\u5212\u7ebf\u7684\u786e\u4f1a\u5f71\u54cd\u4ece\u6a21\u5757\u4e2d\u5bfc\u5165\u540d\u79f0\u7684\u65b9\u5f0f\u3002 \u5047\u8bbe\u4f60\u5728\u4e00\u4e2a\u540d\u4e3amy_module\u7684\u6a21\u5757\u4e2d\u6709\u4ee5\u4e0b\u4ee3\u7801\uff1a # This is my_module.py: def external_func(): return 23 def _internal_func(): return 42 \u73b0\u5728\uff0c\u5982\u679c\u4f7f\u7528\u901a\u914d\u7b26\u4ece\u6a21\u5757\u4e2d\u5bfc\u5165\u6240\u6709\u540d\u79f0\uff0c\u5219Python\u4e0d\u4f1a\u5bfc\u5165\u5e26\u6709\u524d\u5bfc\u4e0b\u5212\u7ebf\u7684\u540d\u79f0\uff08\u9664\u975e\u6a21\u5757\u5b9a\u4e49\u4e86\u8986\u76d6\u6b64\u884c\u4e3a\u7684__all__\u5217\u8868\uff09\uff1a >>> from my_module import * >>> external_func() 23 >>> _internal_func() NameError: \"name '_internal_func' is not defined\" \u987a\u4fbf\u8bf4\u4e00\u4e0b\uff0c\u5e94\u8be5\u907f\u514d\u901a\u914d\u7b26\u5bfc\u5165\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f7f\u540d\u79f0\u7a7a\u95f4\u4e2d\u5b58\u5728\u54ea\u4e9b\u540d\u79f0\u4e0d\u6e05\u695a\u3002 \u4e3a\u4e86\u6e05\u695a\u8d77\u89c1\uff0c\u575a\u6301\u5e38\u89c4\u5bfc\u5165\u66f4\u597d\u3002 \u4e0e\u901a\u914d\u7b26\u5bfc\u5165\u4e0d\u540c\uff0c\u5e38\u89c4\u5bfc\u5165\u4e0d\u53d7\u524d\u5bfc\u5355\u4e2a\u4e0b\u5212\u7ebf\u547d\u540d\u7ea6\u5b9a\u7684\u5f71\u54cd\uff1a >>> import my_module >>> my_module.external_func() 23 >>> my_module._internal_func() 42 \u6211\u77e5\u9053\u8fd9\u4e00\u70b9\u53ef\u80fd\u6709\u70b9\u4ee4\u4eba\u56f0\u60d1\u3002 \u5982\u679c\u4f60\u9075\u5faaPEP 8\u63a8\u8350\uff0c\u907f\u514d\u901a\u914d\u7b26\u5bfc\u5165\uff0c\u90a3\u4e48\u4f60\u771f\u6b63\u9700\u8981\u8bb0\u4f4f\u7684\u53ea\u6709\u8fd9\u4e2a\uff1a \u5355\u4e2a\u4e0b\u5212\u7ebf\u662f\u4e00\u4e2aPython\u547d\u540d\u7ea6\u5b9a\uff0c\u8868\u793a\u8fd9\u4e2a\u540d\u79f0\u662f\u4f9b\u5185\u90e8\u4f7f\u7528\u7684\u3002 \u5b83\u901a\u5e38\u4e0d\u7531Python\u89e3\u91ca\u5668\u5f3a\u5236\u6267\u884c\uff0c\u4ec5\u4ec5\u4f5c\u4e3a\u4e00\u79cd\u5bf9\u7a0b\u5e8f\u5458\u7684\u63d0\u793a\u3002","title":"1. \u5355\u524d\u5bfc\u4e0b\u5212\u7ebf _var"},{"location":"python-dunder/#2-var_","text":"\u6709\u65f6\u5019\uff0c\u4e00\u4e2a\u53d8\u91cf\u7684\u6700\u5408\u9002\u7684\u540d\u79f0\u5df2\u7ecf\u88ab\u4e00\u4e2a\u5173\u952e\u5b57\u6240\u5360\u7528\u3002 \u56e0\u6b64\uff0c\u50cfclass\u6216def\u8fd9\u6837\u7684\u540d\u79f0\u4e0d\u80fd\u7528\u4f5cPython\u4e2d\u7684\u53d8\u91cf\u540d\u79f0\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f60\u53ef\u4ee5\u9644\u52a0\u4e00\u4e2a\u4e0b\u5212\u7ebf\u6765\u89e3\u51b3\u547d\u540d\u51b2\u7a81\uff1a >>> def make_object(name, class): SyntaxError: \"invalid syntax\" >>> def make_object(name, class_): pass \u603b\u4e4b\uff0c\u5355\u4e2a\u672b\u5c3e\u4e0b\u5212\u7ebf\uff08\u540e\u7f00\uff09\u662f\u4e00\u4e2a\u7ea6\u5b9a\uff0c\u7528\u6765\u907f\u514d\u4e0ePython\u5173\u952e\u5b57\u4ea7\u751f\u547d\u540d\u51b2\u7a81\u3002 PEP 8\u89e3\u91ca\u4e86\u8fd9\u4e2a\u7ea6\u5b9a\u3002","title":"2. \u5355\u672b\u5c3e\u4e0b\u5212\u7ebf var_"},{"location":"python-dunder/#3-__var","text":"\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u6240\u6d89\u53ca\u7684\u6240\u6709\u547d\u540d\u6a21\u5f0f\u7684\u542b\u4e49\uff0c\u6765\u81ea\u4e8e\u5df2\u8fbe\u6210\u5171\u8bc6\u7684\u7ea6\u5b9a\u3002 \u800c\u5bf9\u4e8e\u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u5934\u7684Python\u7c7b\u7684\u5c5e\u6027\uff08\u5305\u62ec\u53d8\u91cf\u548c\u65b9\u6cd5\uff09\uff0c\u60c5\u51b5\u5c31\u6709\u70b9\u4e0d\u540c\u4e86\u3002 \u53cc\u4e0b\u5212\u7ebf\u524d\u7f00\u4f1a\u5bfc\u81f4Python\u89e3\u91ca\u5668\u91cd\u5199\u5c5e\u6027\u540d\u79f0\uff0c\u4ee5\u907f\u514d\u5b50\u7c7b\u4e2d\u7684\u547d\u540d\u51b2\u7a81\u3002 \u8fd9\u4e5f\u53eb\u505a\u540d\u79f0\u4fee\u9970\uff08name mangling\uff09 - \u89e3\u91ca\u5668\u66f4\u6539\u53d8\u91cf\u7684\u540d\u79f0\uff0c\u4ee5\u4fbf\u5728\u7c7b\u88ab\u6269\u5c55\u7684\u65f6\u5019\u4e0d\u5bb9\u6613\u4ea7\u751f\u51b2\u7a81\u3002 \u6211\u77e5\u9053\u8fd9\u542c\u8d77\u6765\u5f88\u62bd\u8c61\u3002 \u56e0\u6b64\uff0c\u6211\u7ec4\u5408\u4e86\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4ee3\u7801\u793a\u4f8b\u6765\u4e88\u4ee5\u8bf4\u660e\uff1a class Test: def __init__(self): self.foo = 11 self._bar = 23 self.__baz = 23 \u8ba9\u6211\u4eec\u7528\u5185\u7f6e\u7684dir()\u51fd\u6570\u6765\u770b\u770b\u8fd9\u4e2a\u5bf9\u8c61\u7684\u5c5e\u6027\uff1a >>> t = Test() >>> dir(t) ['_Test__baz', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_bar', 'foo'] \u4ee5\u4e0a\u662f\u8fd9\u4e2a\u5bf9\u8c61\u5c5e\u6027\u7684\u5217\u8868\u3002 \u8ba9\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e2a\u5217\u8868\uff0c\u5e76\u5bfb\u627e\u6211\u4eec\u7684\u539f\u59cb\u53d8\u91cf\u540d\u79f0foo\uff0c_bar\u548c__baz - \u6211\u4fdd\u8bc1\u4f60\u4f1a\u6ce8\u610f\u5230\u4e00\u4e9b\u6709\u8da3\u7684\u53d8\u5316\u3002 - self.foo\u53d8\u91cf\u5728\u5c5e\u6027\u5217\u8868\u4e2d\u663e\u793a\u4e3a\u672a\u4fee\u6539\u4e3afoo\u3002 - self._bar\u7684\u884c\u4e3a\u65b9\u5f0f\u76f8\u540c - \u5b83\u4ee5_bar\u7684\u5f62\u5f0f\u663e\u793a\u5728\u7c7b\u4e0a\u3002 \u5c31\u50cf\u6211\u4e4b\u524d\u8bf4\u8fc7\u7684\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u524d\u5bfc\u4e0b\u5212\u7ebf\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7ea6\u5b9a\u3002 \u7ed9\u7a0b\u5e8f\u5458\u4e00\u4e2a\u63d0\u793a\u800c\u5df2\u3002 - \u7136\u800c\uff0c\u5bf9\u4e8eself.__baz\u800c\u8a00\uff0c\u60c5\u51b5\u770b\u8d77\u6765\u6709\u70b9\u4e0d\u540c\u3002 \u5f53\u4f60\u5728\u8be5\u5217\u8868\u4e2d\u641c\u7d22__baz\u65f6\uff0c\u4f60\u4f1a\u770b\u4e0d\u5230\u6709\u8fd9\u4e2a\u540d\u5b57\u7684\u53d8\u91cf\u3002 __baz\u51fa\u4ec0\u4e48\u60c5\u51b5\u4e86\uff1f \u5982\u679c\u4f60\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u4f60\u4f1a\u770b\u5230\u6b64\u5bf9\u8c61\u4e0a\u6709\u4e00\u4e2a\u540d\u4e3a_Test__baz\u7684\u5c5e\u6027\u3002 \u8fd9\u5c31\u662fPython\u89e3\u91ca\u5668\u6240\u505a\u7684\u540d\u79f0\u4fee\u9970\u3002 \u5b83\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u9632\u6b62\u53d8\u91cf\u5728\u5b50\u7c7b\u4e2d\u88ab\u91cd\u5199\u3002 \u8ba9\u6211\u4eec\u521b\u5efa\u53e6\u4e00\u4e2a\u6269\u5c55Test\u7c7b\u7684\u7c7b\uff0c\u5e76\u5c1d\u8bd5\u91cd\u5199\u6784\u9020\u51fd\u6570\u4e2d\u6dfb\u52a0\u7684\u73b0\u6709\u5c5e\u6027\uff1a class ExtendedTest(Test): def __init__(self): super().__init__() self.foo = 'overridden' self._bar = 'overridden' self.__baz = 'overridden' \u73b0\u5728\uff0c\u4f60\u8ba4\u4e3afoo\uff0c_bar\u548c__baz\u7684\u503c\u4f1a\u51fa\u73b0\u5728\u8fd9\u4e2aExtendedTest\u7c7b\u7684\u5b9e\u4f8b\u4e0a\u5417\uff1f \u6211\u4eec\u6765\u770b\u4e00\u770b\uff1a >>> t2 = ExtendedTest() >>> t2.foo 'overridden' >>> t2._bar 'overridden' >>> t2.__baz AttributeError: \"'ExtendedTest' object has no attribute '__baz'\" \u7b49\u4e00\u4e0b\uff0c\u5f53\u6211\u4eec\u5c1d\u8bd5\u67e5\u770bt2 .__ baz\u7684\u503c\u65f6\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u4f1a\u5f97\u5230AttributeError\uff1f \u540d\u79f0\u4fee\u9970\u88ab\u518d\u6b21\u89e6\u53d1\u4e86\uff01 \u4e8b\u5b9e\u8bc1\u660e\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u751a\u81f3\u6ca1\u6709__baz\u5c5e\u6027\uff1a >>> dir(t2) ['_ExtendedTest__baz', '_Test__baz', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_bar', 'foo', 'get_vars'] \u6b63\u5982\u4f60\u53ef\u4ee5\u770b\u5230__baz\u53d8\u6210_ExtendedTest__baz\u4ee5\u9632\u6b62\u610f\u5916\u4fee\u6539\uff1a >>> t2._ExtendedTest__baz 'overridden' \u4f46\u539f\u6765\u7684_Test__baz\u8fd8\u5728\uff1a >>> t2._Test__baz 42 \u53cc\u4e0b\u5212\u7ebf\u540d\u79f0\u4fee\u9970\u5bf9\u7a0b\u5e8f\u5458\u662f\u5b8c\u5168\u900f\u660e\u7684\u3002 \u4e0b\u9762\u7684\u4f8b\u5b50\u8bc1\u5b9e\u4e86\u8fd9\u4e00\u70b9\uff1a class ManglingTest: def __init__(self): self.__mangled = 'hello' def get_mangled(self): return self.__mangled >>> ManglingTest().get_mangled() 'hello' >>> ManglingTest().__mangled AttributeError: \"'ManglingTest' object has no attribute '__mangled'\" \u540d\u79f0\u4fee\u9970\u662f\u5426\u4e5f\u9002\u7528\u4e8e\u65b9\u6cd5\u540d\u79f0\uff1f \u662f\u7684\uff0c\u4e5f\u9002\u7528\u3002\u540d\u79f0\u4fee\u9970\u4f1a\u5f71\u54cd\u5728\u4e00\u4e2a\u7c7b\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u4ee5\u4e24\u4e2a\u4e0b\u5212\u7ebf\u5b57\u7b26\uff08\"dunders\"\uff09\u5f00\u5934\u7684\u6240\u6709\u540d\u79f0\uff1a class MangledMethod: def __method(self): return 42 def call_it(self): return self.__method() >>> MangledMethod().__method() AttributeError: \"'MangledMethod' object has no attribute '__method'\" >>> MangledMethod().call_it() 42 \u8fd9\u662f\u53e6\u4e00\u4e2a\u4e5f\u8bb8\u4ee4\u4eba\u60ca\u8bb6\u7684\u8fd0\u7528\u540d\u79f0\u4fee\u9970\u7684\u4f8b\u5b50\uff1a _MangledGlobal__mangled = 23 class MangledGlobal: def test(self): return __mangled >>> MangledGlobal().test() 23 \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u58f0\u660e\u4e86\u4e00\u4e2a\u540d\u4e3a_MangledGlobal__mangled\u7684\u5168\u5c40\u53d8\u91cf\u3002\u7136\u540e\u6211\u5728\u540d\u4e3aMangledGlobal\u7684\u7c7b\u7684\u4e0a\u4e0b\u6587\u4e2d\u8bbf\u95ee\u53d8\u91cf\u3002\u7531\u4e8e\u540d\u79f0\u4fee\u9970\uff0c\u6211\u80fd\u591f\u5728\u7c7b\u7684test()\u65b9\u6cd5\u5185\uff0c\u4ee5__mangled\u6765\u5f15\u7528_MangledGlobal__mangled\u5168\u5c40\u53d8\u91cf\u3002 Python\u89e3\u91ca\u5668\u81ea\u52a8\u5c06\u540d\u79f0__mangled\u6269\u5c55\u4e3a_MangledGlobal__mangled\uff0c\u56e0\u4e3a\u5b83\u4ee5\u4e24\u4e2a\u4e0b\u5212\u7ebf\u5b57\u7b26\u5f00\u5934\u3002\u8fd9\u8868\u660e\u540d\u79f0\u4fee\u9970\u4e0d\u662f\u4e13\u95e8\u4e0e\u7c7b\u5c5e\u6027\u5173\u8054\u7684\u3002\u5b83\u9002\u7528\u4e8e\u5728\u7c7b\u4e0a\u4e0b\u6587\u4e2d\u4f7f\u7528\u7684\u4e24\u4e2a\u4e0b\u5212\u7ebf\u5b57\u7b26\u5f00\u5934\u7684\u4efb\u4f55\u540d\u79f0\u3002 \u6709\u5f88\u591a\u8981\u5438\u6536\u7684\u5185\u5bb9\u5427\u3002 \u8001\u5b9e\u8bf4\uff0c\u8fd9\u4e9b\u4f8b\u5b50\u548c\u89e3\u91ca\u4e0d\u662f\u4ece\u6211\u8111\u5b50\u91cc\u8e66\u51fa\u6765\u7684\u3002\u6211\u4f5c\u4e86\u4e00\u4e9b\u7814\u7a76\u548c\u52a0\u5de5\u624d\u5f04\u51fa\u6765\u3002\u6211\u4e00\u76f4\u4f7f\u7528Python\uff0c\u6709\u5f88\u591a\u5e74\u4e86\uff0c\u4f46\u662f\u50cf\u8fd9\u6837\u7684\u89c4\u5219\u548c\u7279\u6b8a\u60c5\u51b5\u5e76\u4e0d\u603b\u662f\u6d6e\u73b0\u5728\u8111\u6d77\u91cc\u3002 \u6709\u65f6\u5019\u7a0b\u5e8f\u5458\u6700\u91cd\u8981\u7684\u6280\u80fd\u662f\u201c\u6a21\u5f0f\u8bc6\u522b\u201d\uff0c\u800c\u4e14\u77e5\u9053\u5728\u54ea\u91cc\u67e5\u9605\u4fe1\u606f\u3002\u5982\u679c\u60a8\u5728\u8fd9\u4e00\u70b9\u4e0a\u611f\u5230\u6709\u70b9\u4e0d\u77e5\u6240\u63aa\uff0c\u8bf7\u4e0d\u8981\u62c5\u5fc3\u3002\u6162\u6162\u6765\uff0c\u8bd5\u8bd5\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u7684\u4e00\u4e9b\u4f8b\u5b50\u3002 \u8ba9\u8fd9\u4e9b\u6982\u5ff5\u5b8c\u5168\u6c89\u6d78\u4e0b\u6765\uff0c\u4ee5\u4fbf\u4f60\u80fd\u591f\u7406\u89e3\u540d\u79f0\u4fee\u9970\u7684\u603b\u4f53\u601d\u8def\uff0c\u4ee5\u53ca\u6211\u5411\u60a8\u5c55\u793a\u7684\u4e00\u4e9b\u5176\u4ed6\u7684\u884c\u4e3a\u3002\u5982\u679c\u6709\u4e00\u5929\u4f60\u548c\u5b83\u4eec\u4e0d\u671f\u800c\u9047\uff0c\u4f60\u4f1a\u77e5\u9053\u5728\u6587\u6863\u4e2d\u6309\u4ec0\u4e48\u6765\u67e5\u3002","title":"3. \u53cc\u524d\u5bfc\u4e0b\u5212\u7ebf __var"},{"location":"python-dunder/#4-var","text":"\u4e5f\u8bb8\u4ee4\u4eba\u60ca\u8bb6\u7684\u662f\uff0c\u5982\u679c\u4e00\u4e2a\u540d\u5b57\u540c\u65f6\u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u59cb\u548c\u7ed3\u675f\uff0c\u5219\u4e0d\u4f1a\u5e94\u7528\u540d\u79f0\u4fee\u9970\u3002 \u7531\u53cc\u4e0b\u5212\u7ebf\u524d\u7f00\u548c\u540e\u7f00\u5305\u56f4\u7684\u53d8\u91cf\u4e0d\u4f1a\u88abPython\u89e3\u91ca\u5668\u4fee\u6539\uff1a class PrefixPostfixTest: def __init__(self): self.__bam__ = 42 >>> PrefixPostfixTest().__bam__ 42 \u4f46\u662f\uff0cPython\u4fdd\u7559\u4e86\u6709\u53cc\u524d\u5bfc\u548c\u53cc\u672b\u5c3e\u4e0b\u5212\u7ebf\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u7279\u6b8a\u7528\u9014\u3002 \u8fd9\u6837\u7684\u4f8b\u5b50\u6709\uff0c init__\u5bf9\u8c61\u6784\u9020\u51fd\u6570\uff0c\u6216__call --- \u5b83\u4f7f\u5f97\u4e00\u4e2a\u5bf9\u8c61\u53ef\u4ee5\u88ab\u8c03\u7528\u3002 \u8fd9\u4e9bdunder\u65b9\u6cd5\u901a\u5e38\u88ab\u79f0\u4e3a\u795e\u5947\u65b9\u6cd5 - \u4f46Python\u793e\u533a\u4e2d\u7684\u8bb8\u591a\u4eba\uff08\u5305\u62ec\u6211\u81ea\u5df1\uff09\u90fd\u4e0d\u559c\u6b22\u8fd9\u79cd\u65b9\u6cd5\u3002 \u6700\u597d\u907f\u514d\u5728\u81ea\u5df1\u7684\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u4ee5\u53cc\u4e0b\u5212\u7ebf\uff08\u201cdunders\u201d\uff09\u5f00\u5934\u548c\u7ed3\u5c3e\u7684\u540d\u79f0\uff0c\u4ee5\u907f\u514d\u4e0e\u5c06\u6765Python\u8bed\u8a00\u7684\u53d8\u5316\u4ea7\u751f\u51b2\u7a81\u3002","title":"4. \u53cc\u524d\u5bfc\u548c\u53cc\u672b\u5c3e\u4e0b\u5212\u7ebf var"},{"location":"python-dunder/#5-_","text":"\u6309\u7167\u4e60\u60ef\uff0c\u6709\u65f6\u5019\u5355\u4e2a\u72ec\u7acb\u4e0b\u5212\u7ebf\u662f\u7528\u4f5c\u4e00\u4e2a\u540d\u5b57\uff0c\u6765\u8868\u793a\u67d0\u4e2a\u53d8\u91cf\u662f\u4e34\u65f6\u7684\u6216\u65e0\u5173\u7d27\u8981\u7684\u3002 \u4f8b\u5982\uff0c\u5728\u4e0b\u9762\u7684\u5faa\u73af\u4e2d\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u8bbf\u95ee\u6b63\u5728\u8fd0\u884c\u7684\u7d22\u5f15\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u201c_\u201d\u6765\u8868\u793a\u5b83\u53ea\u662f\u4e00\u4e2a\u4e34\u65f6\u503c\uff1a >>> for _ in range(32): ... print('Hello, World.') \u4f60\u4e5f\u53ef\u4ee5\u5728\u62c6\u5206(unpacking)\u8868\u8fbe\u5f0f\u4e2d\u5c06\u5355\u4e2a\u4e0b\u5212\u7ebf\u7528\u4f5c\u201c\u4e0d\u5173\u5fc3\u7684\u201d\u53d8\u91cf\uff0c\u4ee5\u5ffd\u7565\u7279\u5b9a\u7684\u503c\u3002 \u540c\u6837\uff0c\u8fd9\u4e2a\u542b\u4e49\u53ea\u662f\u201c\u4f9d\u7167\u7ea6\u5b9a\u201d\uff0c\u5e76\u4e0d\u4f1a\u5728Python\u89e3\u91ca\u5668\u4e2d\u89e6\u53d1\u7279\u6b8a\u7684\u884c\u4e3a\u3002 \u5355\u4e2a\u4e0b\u5212\u7ebf\u4ec5\u4ec5\u662f\u4e00\u4e2a\u6709\u6548\u7684\u53d8\u91cf\u540d\u79f0\uff0c\u4f1a\u6709\u8fd9\u4e2a\u7528\u9014\u800c\u5df2\u3002 \u5728\u4e0b\u9762\u7684\u4ee3\u7801\u793a\u4f8b\u4e2d\uff0c\u6211\u5c06\u6c7d\u8f66\u5143\u7ec4\u62c6\u5206\u4e3a\u5355\u72ec\u7684\u53d8\u91cf\uff0c\u4f46\u6211\u53ea\u5bf9\u989c\u8272\u548c\u91cc\u7a0b\u503c\u611f\u5174\u8da3\u3002 \u4f46\u662f\uff0c\u4e3a\u4e86\u4f7f\u62c6\u5206\u8868\u8fbe\u5f0f\u6210\u529f\u8fd0\u884c\uff0c\u6211\u9700\u8981\u5c06\u5305\u542b\u5728\u5143\u7ec4\u4e2d\u7684\u6240\u6709\u503c\u5206\u914d\u7ed9\u53d8\u91cf\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u201c_\u201d\u4f5c\u4e3a\u5360\u4f4d\u7b26\u53d8\u91cf\u53ef\u4ee5\u6d3e\u4e0a\u7528\u573a\uff1a >>> car = ('red', 'auto', 12, 3812.4) >>> color, _, _, mileage = car >>> color 'red' >>> mileage 3812.4 >>> _ 12 \u9664\u4e86\u7528\u4f5c\u4e34\u65f6\u53d8\u91cf\u4e4b\u5916\uff0c\u201c_\u201d\u662f\u5927\u591a\u6570Python REPL\u4e2d\u7684\u4e00\u4e2a\u7279\u6b8a\u53d8\u91cf\uff0c\u5b83\u8868\u793a\u7531\u89e3\u91ca\u5668\u8bc4\u4f30\u7684\u6700\u8fd1\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u3002 \u8fd9\u6837\u5c31\u5f88\u65b9\u4fbf\u4e86\uff0c\u6bd4\u5982\u4f60\u53ef\u4ee5\u5728\u4e00\u4e2a\u89e3\u91ca\u5668\u4f1a\u8bdd\u4e2d\u8bbf\u95ee\u5148\u524d\u8ba1\u7b97\u7684\u7ed3\u679c\uff0c\u6216\u8005\uff0c\u4f60\u662f\u5728\u52a8\u6001\u6784\u5efa\u591a\u4e2a\u5bf9\u8c61\u5e76\u4e0e\u5b83\u4eec\u4ea4\u4e92\uff0c\u65e0\u9700\u4e8b\u5148\u7ed9\u8fd9\u4e9b\u5bf9\u8c61\u5206\u914d\u540d\u5b57\uff1a >>> 20 + 3 23 >>> _ 23 >>> print(_) 23 >>> list() [] >>> _.append(1) >>> _.append(2) >>> _.append(3) >>> _ [1, 2, 3] Python\u4e0b\u5212\u7ebf\u547d\u540d\u6a21\u5f0f - \u5c0f\u7ed3 \u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u77ed\u7684\u5c0f\u7ed3\uff0c\u5373\u201c\u901f\u67e5\u8868\u201d\uff0c\u7f57\u5217\u4e86\u6211\u5728\u672c\u6587\u4e2d\u8c08\u5230\u7684\u4e94\u79cdPython\u4e0b\u5212\u7ebf\u6a21\u5f0f\u7684\u542b\u4e49\uff1a","title":"5.\u5355\u4e0b\u5212\u7ebf _"},{"location":"python-function/","text":"Python\u4f20\u5165\u53c2\u6570\u7684\u51e0\u79cd\u65b9\u6cd5 \u00b6 Python\u4f20\u5165\u53c2\u6570\u7684\u65b9\u6cd5\u6709\uff1a\u4f4d\u7f6e\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53ef\u53d8\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u3001\u548c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u3001\u4ee5\u53ca\u5404\u79cd\u53c2\u6570\u8c03\u7528\u7684\u7ec4\u5408 \u5199\u5728\u524d\u9762 \u00b6 Python\u552f\u4e00\u652f\u6301\u7684\u53c2\u6570\u4f20\u9012\u65b9\u5f0f\u662f\u300e\u5171\u4eab\u4f20\u53c2\u300f\uff08call by sharing\uff09 \u591a\u6570\u9762\u5411\u5bf9\u8c61\u8bed\u8a00\u90fd\u91c7\u7528\u8fd9\u4e00\u6a21\u5f0f\uff0c\u5305\u62ecRuby\u3001Smalltalk\u548cJava\uff08Java\u7684\u5f15\u7528\u7c7b\u578b\u662f\u8fd9\u6837\uff0c\u57fa\u672c\u7c7b\u578b\u6309\u503c\u4f20\u9012\uff09 \u5171\u4eab\u4f20\u53c2\u662f\u6307\u51fd\u6570\u7684\u5404\u4e2a\u5f62\u5f0f\u53c2\u6570\u83b7\u5f97\u5b9e\u53c2\u4e2d\u5404\u4e2a\u5f15\u7528\u7684\u526f\u672c\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u51fd\u6570\u5185\u90e8\u7684\u5f62\u53c2\u662f\u5b9e\u53c2\u7684\u522b\u540d\uff08alias\uff09 \u8fd9\u79cd\u65b9\u6848\u7684\u7ed3\u679c\u662f\uff0c\u51fd\u6570\u53ef\u80fd\u4f1a\u4fee\u6539\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u7684\u53ef\u53d8\u5bf9\u8c61\uff0c\u4f46\u662f\u65e0\u6cd5\u4fee\u6539\u90a3\u4e9b\u5bf9\u8c61\u7684\u6807\u8bc6\uff08\u5373\u4e0d\u80fd\u628a\u4e00\u4e2a\u5bf9\u8c61\u66ff\u6362\u4e3a\u53e6\u4e00\u4e2a\u5bf9\u8c61\uff09 \u4f4d\u7f6e\u53c2\u6570 \u00b6 \u4f4d\u7f6e\u53c2\u6570\u662f\u6700\u7b80\u5355\u7684\u4f20\u5165\u53c2\u6570\u7684\u65b9\u5f0f\uff0c\u5728\u5176\u5b83\u7684\u8bed\u8a00\u4e2d\u4e5f\u5e38\u5e38\u88ab\u4f7f\u7528 \u6f14\u793a\u4e00\uff1a \u00b6 def func(a, b): print(a+b) func(1, 2) #3 \u6f14\u793a\u4e8c\uff1a \u00b6 def power(x, n): s = 1 while(n > 0): n -= 1 s *= n return s power(2, 3) #8 \u9ed8\u8ba4\u53c2\u6570 \u00b6 \u9ed8\u8ba4\u53c2\u6570\u5c31\u662f\u5728\u8c03\u7528\u51fd\u6570\u7684\u65f6\u5019\u4f7f\u7528\u4e00\u4e9b\u5305\u542b\u9ed8\u8ba4\u503c\u7684\u53c2\u6570 def power(x, n=2): s = 1 while(n > 0): n -= 1 s *= n reutrn s power(3) #9 power(2, 3) #8 \u5b9a\u4e49\u9ed8\u8ba4\u53c2\u6570\u8981\u7262\u8bb0\u4e00\u70b9\uff1a\u9ed8\u8ba4\u53c2\u6570\u5fc5\u987b\u6307\u5411\u4e0d\u53d8\u5bf9\u8c61\uff01 \u00b6 #\u4ee5\u4e0b\u8fd9\u4e2a\u51fd\u6570\u5982\u679c\u88ab\u591a\u6b21\u8c03\u7528\u4f1a\u5728\u9ed8\u8ba4\u6dfb\u52a0\u591a\u4e2aEND\u5b57\u7b26\u4e32 def add_end(l = []): l.append('END') return l #\u4e3a\u4e86\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\uff0c\u5e94\u8be5\u628a\u4f20\u5165\u7684\u9ed8\u8ba4\u53c2\u6570\u8bbe\u7f6e\u4e3a\u4e0d\u53ef\u53d8\u7684 def add_end(l = None): l = [] l.append('END') return l \u53ef\u53d8\u53c2\u6570 \u00b6 \u53ef\u53d8\u53c2\u6570\u5c31\u662f\u5141\u8bb8\u5728\u8c03\u7528\u53c2\u6570\u7684\u65f6\u5019\u4f20\u5165\u591a\u4e2a\uff08\u22650\u4e2a\uff09\u53c2\u6570\uff08\u7c7b\u4f3c\u4e8e\u5217\u8868\u3001\u5b57\u5178\uff09 #\u4f20\u5165\u4e00\u4e2a\u5217\u8868\uff0c\u4e25\u683c\u5730\u8bf4\u8fd9\u4e0d\u662f\u53ef\u53d8\u53c2\u6570 def calc(l): sum = 0 for n in l: sum += n return sum >>> calc([1,2,3]) #\u8fd9\u624d\u662f\u53ef\u53d8\u53c2\u6570\uff0c\u867d\u7136\u5728\u4f7f\u7528\u4e0a\u548c\u5217\u8868\u6ca1\u6709\u533a\u522b\uff0c\u4f46\u662f\u53c2\u6570nums\u63a5\u6536\u5230\u7684\u662f\u4e00\u4e2atuple\uff08\u8fd9\u4e9b\u53c2\u6570\u5728\u4f20\u5165\u65f6\u88ab\u81ea\u52a8\u7ec4\u7ec4\u88c5\u4e3a\u4e00\u4e2a\u5143\u7956\uff09 def calc(*nums): sum = 0 for n in nums: sum += n return sum >>> calc(1,2,3) 7 >>> my_ls = [1,2,3] >>> calc(*my_ls) 7 \u5173\u952e\u5b57\u53c2\u6570 \u00b6 \u53ef\u53d8\u53c2\u6570\u5141\u8bb8\u4f20\u51650\u4e2a\uff5e\u591a\u4e2a\u53c2\u6570\uff0c\u800c\u5173\u952e\u5b57\u53c2\u6570\u5141\u8bb8\u5728\u8c03\u7528\u65f6\u4ee5\u5b57\u5178\u5f62\u5f0f\u4f20\u51650\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\uff08\u6ce8\u610f\u533a\u522b\uff0c\u4e00\u4e2a\u662f\u5b57\u5178\u4e00\u4e2a\u662f\u5217\u8868\uff09\uff1b\u5728\u4f20\u9012\u53c2\u6570\u65f6\u7528\u7b49\u53f7\uff08=\uff09\u8fde\u63a5\u952e\u548c\u503c #\u7528\u4e24\u4e2a\u661f\u53f7\u8868\u793a\u5173\u952e\u5b57\u53c2\u6570 def person_info(name, age, **kw): print(\"name\", name, \"age\", age, \"other\", kw) >>> person_info(\"Xiaoming\", 12) name Xiaoming age 12 other{} >>> person_info(\"Dahuang\", 35, city = \"Beijing\") name Dahuang age 35 other {'city':'Beijing'} \u547d\u540d\u5173\u952e\u5b57\u53c2\u6570 \u00b6 \u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u5728\u5173\u952e\u5b57\u53c2\u6570\u7684\u57fa\u7840\u4e0a\u9650\u5236\u4f20\u5165\u7684\u7684\u5173\u952e\u5b57\u7684\u53d8\u91cf\u540d \u548c\u666e\u901a\u5173\u952e\u5b57\u53c2\u6570\u4e0d\u540c\uff0c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u9700\u8981\u4e00\u4e2a\u7528\u6765\u533a\u5206\u7684\u5206\u9694\u7b26*\uff0c\u5b83\u540e\u9762\u7684\u53c2\u6570\u88ab\u8ba4\u4e3a\u662f\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570 #\u8fd9\u91cc\u661f\u53f7\u5206\u5272\u7b26\u540e\u9762\u7684city\u3001job\u662f\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570 person_info(name, age, *, city, job): print(name, age, city, job) >>> person_info(\"Alex\", 17, city = \"Beijing\", job = \"Engineer\") Alex 17 Beijing Engineer #\u770b\u6765\u8fd9\u91cc\u4e0d\u518d\u88ab\u81ea\u52a8\u7ec4\u88c5\u4e3a\u5b57\u5178 \u4e0d\u8fc7\u4e5f\u6709\u4f8b\u5916\uff0c\u5982\u679c\u53c2\u6570\u4e2d\u5df2\u7ecf\u6709\u4e00\u4e2a\u53ef\u53d8\u53c2\u6570\u7684\u8bdd\uff0c\u524d\u9762\u8bb2\u7684\u661f\u53f7\u5206\u5272\u7b26\u5c31\u4e0d\u8981\u5199\u4e86\uff08\u5176\u5b9e\u661f\u53f7\u662f\u5199\u7ed9Python\u89e3\u91ca\u5668\u770b\u7684\uff0c\u5982\u679c\u4e00\u4e2a\u661f\u53f7\u4e5f\u6ca1\u6709\u7684\u8bdd\u5c31\u65e0\u6cd5\u533a\u5206\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u548c\u4f4d\u7f6e\u53c2\u6570\u4e86\uff0c\u800c\u5982\u679c\u6709\u4e00\u4e2a\u661f\u53f7\u5373\u4f7f\u6765\u81ea\u53d8\u957f\u53c2\u6570\u5c31\u53ef\u4ee5\u533a\u5206\u5f00\u6765\uff09 #args\u662f\u53d8\u957f\u53c2\u6570\uff0c\u800ccity\u548cjob\u662f\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570 person_info(name, age, *args, city, job): print(name, age, args, city) >>> person_info(\"Liqiang\", 43, \"balabala\", city = \"Wuhan\", job = \"Coder\") Liqiang 43 balabala Wuhan Coder \u53c2\u6570\u7ec4\u5408 \u00b6 \u603b\u7ed3\u4e00\u4e0b\uff0c\u5728Python\u4e2d\u4e00\u79cd\u53ef\u4ee5\u4f7f\u75285\u4e2d\u4f20\u9012\u53c2\u6570\u7684\u65b9\u5f0f\uff08\u4f4d\u7f6e\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53d8\u957f\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u3001\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff09 \u6ce8\u610f\uff0c\u8fd9\u4e9b\u53c2\u6570\u5728\u4e66\u5199\u65f6\u8981\u9075\u5faa\u4e00\u5b9a\u7684\u987a\u5e8f\u5373\uff1a\u4f4d\u7f6e\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53d8\u957f\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u3001\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff08\u548c\u672c\u6587\u7684\u884c\u6587\u987a\u5e8f\u4e00\u81f4\uff09 \u8fd9\u91cc\u7b80\u5355\u4e3e\u4e24\u4e2a\u6817\u5b50 def f1(a, b, c=0, *args, **kw): print(\"a = \", a, \"b = \", b, \"args = \", args, \"kw = \",kw) def f2(a, b, c=0, *, d, **kw): print(\"a = \", a, \"b = \", b, \"c = \", c, \"d = \", d, \"kw = \", kw) >>> f1(1, 2) a = 1 b = 2 c = 0 args =() kw = {} >>> f1(1, 2, c=3) a = 1 b = 2 c = 3 args = () kw = {} >>> f1(1, 2, 3, 'a', 'b') a = 1 b = 2 c = 3 args = ('a', 'b') kw = {} >>> f1(1, 2, 3, 'a', 'b', x = 99) a = 1 b = 2 c = 3 args = ('a', 'b') kw = {'x':99} >>> f2(1, 2, d = 99, ext = None) a = 1 b =2 c = 0 d = 99 kw = {'ext':None} \u5199\u5728\u540e\u9762 \u00b6 \u5173\u4e8ePython\u53c2\u6570\u4f20\u9012\uff0c\u6709\u4ee5\u4e0b\u51e0\u70b9\u63d0\u8bf7\u6ce8\u610f\uff1a \u53c2\u6570\u7684\u4f20\u9012\u662f\u901a\u8fc7\u81ea\u52a8\u5c06\u5bf9\u8c61\u8d4b\u503c\u7ed9\u672c\u5730\u53d8\u91cf\u540d\u6765\u5b9e\u73b0\u7684 \u51fd\u6570\u53c2\u6570\u5728\u5b9e\u9645\u4e2d\u53ea\u662fPython\u8d4b\u503c\u7684\u53e6\u4e00\u4e2a\u5b9e\u4f8b\u800c\u5df2\uff0c\u56e0\u4e3a\u5f15\u7528\u53ef\u4ee5\u662f\u4ee5\u6307\u9488\u7684\u5f62\u5f0f\u6765\u5b9e\u73b0\u7684\uff0c\u6240\u6709\u7684\u53c2\u6570\u5b9e\u9645\u4e0a\u90fd\u662f\u901a\u8fc7\u6307\u9488\u8fdb\u884c\u4f20\u9012\u7684\uff0c\u4f5c\u4e3a\u53c2\u6570\u88ab\u4f20\u9012\u7684\u5bf9\u8c61\u4ece\u6765\u4e0d\u81ea\u52a8\u62f7\u8d1d \u5728\u51fd\u6570\u5185\u90e8\u7684\u53c2\u6570\u540d\u7684\u8d4b\u503c\u4e0d\u4f1a\u5f71\u54cd\u8c03\u7528\u8005 \u5728\u51fd\u6570\u8fd0\u884c\u65f6\uff0c\u5728\u51fd\u6570\u5934\u90e8\u7684\u53c2\u6570\u540d\u65f6\u4e00\u4e2a\u65b0\u7684\u3001\u672c\u5730\u7684\u53d8\u91cf\u540d\uff0c\u8fd9\u4e2a\u53d8\u91cf\u540d\u662f\u5728\u51fd\u6570\u7684\u672c\u5730\u4f5c\u7528\u57df\u5185\u7684\uff0c\u51fd\u6570\u53c2\u6570\u540d\u548c\u8c03\u7528\u8005\u4f5c\u7528\u57df\u4e2d\u7684\u53d8\u91cf\u662f\u6ca1\u6709\u533a\u522b\u7684 \u6539\u53d8\u51fd\u6570\u7684\u53ef\u53d8\u5bf9\u8c61\u53c2\u6570\u7684\u503c\u4e5f\u8bb8\u4f1a\u5bf9\u8c03\u7528\u8005\u6709\u5f71\u54cd \u6362\u53e5\u8bdd\u8bf4\uff0c\u56e0\u4e3a\u53c2\u6570\u662f\u7b80\u5355\u5730\u8d4b\u503c\u7ed9\u4f20\u5165\u7684\u5bf9\u8c61\uff0c\u51fd\u6570\u5c31\u80fd\u591f\u5c31\u5730\u6539\u53d8\u4f20\u5165\u7684\u53ef\u53d8\u5bf9\u8c61\uff0c\u56e0\u6b64\u5176\u7ed3\u679c\u4f1a\u5f71\u54cd\u8c03\u7528\u8005\uff1b\u53ef\u53d8\u53c2\u6570\u5bf9\u51fd\u6570\u6765\u8bf4\u53ef\u4ee5\u505a\u8f93\u5165\u548c\u8f93\u51fa\u7684 Python\u7684\u901a\u8fc7\u8d4b\u503c\u8fdb\u884c\u4f20\u9012\u7684\u673a\u5236\u4e0eC++\u7684\u5f15\u7528\u53c2\u6570\u9009\u9879\u4e0d\u5b8c\u5168\u76f8\u540c\uff0c\u4f46\u662f\u5b9e\u9645\u4e2d\uff0c\u5b83\u4e0eC\u8bed\u8a00\u7684\u53c2\u6570\u4f20\u9012\u6a21\u578b\u76f8\u5f53\u7c7b\u4f3c\uff1a \u00b6 \u4e0d\u53ef\u53d8\u53c2\u6570\u201c\u901a\u8fc7\u503c\u201d\u8fdb\u884c\u4f20\u9012 \u50cf\u6574\u6570\u548c\u5b57\u7b26\u4e32\u8fd9\u6837\u7684\u5bf9\u8c61\u662f\u4e0d\u53ef\u53d8\u5bf9\u8c61\uff0c\u5b83\u4eec\u901a\u8fc7\u5bf9\u8c61\u5f15\u7528\u800c\u4e0d\u662f\u62f7\u8d1d\u8fdb\u884c\u4f20\u9012\u7684\uff0c\u4f46\u662f\u56e0\u4e3a\u65e0\u8bba\u5982\u4f55\u90fd\u4e0d\u53ef\u80fd\u5728\u539f\u5904\u6539\u53d8\u4e0d\u53ef\u53d8\u5bf9\u8c61\uff0c\u5b9e\u9645\u7684\u6548\u679c\u5c31\u5f88\u50cf\u521b\u5efa\u4e86\u4e00\u4efd\u62f7\u8d1d \u53ef\u53d8\u5bf9\u8c61\u662f\u901a\u8fc7\u201c\u6307\u9488\u201d\u8fdb\u884c\u4f20\u9012\u7684 \u5217\u8868\u548c\u5b57\u5178\u8fd9\u6837\u7684\u5bf9\u8c61\u4e5f\u662f\u901a\u8fc7\u5bf9\u8c61\u5f15\u7528\u8fdb\u884c\u4f20\u9012\u7684\uff0c\u8fd9\u4e00\u70b9\u4e0eC\u8bed\u8a00\u4f7f\u7528\u6307\u9488\u4f20\u9012\u6570\u7ec4\u5f88\u76f8\u4f3c\uff0c\u53ef\u53d8\u5bf9\u8c61\u80fd\u591f\u5728\u51fd\u6570\u5185\u90e8\u8fdb\u884c\u539f\u5904\u7684\u6539\u53d8\uff0c\u8fd9\u4e00\u70b9\u548cC\u6570\u7ec4\u5f88\u50cf","title":"\u4f20\u5165\u53c2\u6570\u7684\u51e0\u79cd\u65b9\u6cd5"},{"location":"python-function/#python","text":"Python\u4f20\u5165\u53c2\u6570\u7684\u65b9\u6cd5\u6709\uff1a\u4f4d\u7f6e\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53ef\u53d8\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u3001\u548c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u3001\u4ee5\u53ca\u5404\u79cd\u53c2\u6570\u8c03\u7528\u7684\u7ec4\u5408","title":"Python\u4f20\u5165\u53c2\u6570\u7684\u51e0\u79cd\u65b9\u6cd5"},{"location":"python-function/#_1","text":"Python\u552f\u4e00\u652f\u6301\u7684\u53c2\u6570\u4f20\u9012\u65b9\u5f0f\u662f\u300e\u5171\u4eab\u4f20\u53c2\u300f\uff08call by sharing\uff09 \u591a\u6570\u9762\u5411\u5bf9\u8c61\u8bed\u8a00\u90fd\u91c7\u7528\u8fd9\u4e00\u6a21\u5f0f\uff0c\u5305\u62ecRuby\u3001Smalltalk\u548cJava\uff08Java\u7684\u5f15\u7528\u7c7b\u578b\u662f\u8fd9\u6837\uff0c\u57fa\u672c\u7c7b\u578b\u6309\u503c\u4f20\u9012\uff09 \u5171\u4eab\u4f20\u53c2\u662f\u6307\u51fd\u6570\u7684\u5404\u4e2a\u5f62\u5f0f\u53c2\u6570\u83b7\u5f97\u5b9e\u53c2\u4e2d\u5404\u4e2a\u5f15\u7528\u7684\u526f\u672c\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u51fd\u6570\u5185\u90e8\u7684\u5f62\u53c2\u662f\u5b9e\u53c2\u7684\u522b\u540d\uff08alias\uff09 \u8fd9\u79cd\u65b9\u6848\u7684\u7ed3\u679c\u662f\uff0c\u51fd\u6570\u53ef\u80fd\u4f1a\u4fee\u6539\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u7684\u53ef\u53d8\u5bf9\u8c61\uff0c\u4f46\u662f\u65e0\u6cd5\u4fee\u6539\u90a3\u4e9b\u5bf9\u8c61\u7684\u6807\u8bc6\uff08\u5373\u4e0d\u80fd\u628a\u4e00\u4e2a\u5bf9\u8c61\u66ff\u6362\u4e3a\u53e6\u4e00\u4e2a\u5bf9\u8c61\uff09","title":"\u5199\u5728\u524d\u9762"},{"location":"python-function/#_2","text":"\u4f4d\u7f6e\u53c2\u6570\u662f\u6700\u7b80\u5355\u7684\u4f20\u5165\u53c2\u6570\u7684\u65b9\u5f0f\uff0c\u5728\u5176\u5b83\u7684\u8bed\u8a00\u4e2d\u4e5f\u5e38\u5e38\u88ab\u4f7f\u7528","title":"\u4f4d\u7f6e\u53c2\u6570"},{"location":"python-function/#_3","text":"def func(a, b): print(a+b) func(1, 2) #3","title":"\u6f14\u793a\u4e00\uff1a"},{"location":"python-function/#_4","text":"def power(x, n): s = 1 while(n > 0): n -= 1 s *= n return s power(2, 3) #8","title":"\u6f14\u793a\u4e8c\uff1a"},{"location":"python-function/#_5","text":"\u9ed8\u8ba4\u53c2\u6570\u5c31\u662f\u5728\u8c03\u7528\u51fd\u6570\u7684\u65f6\u5019\u4f7f\u7528\u4e00\u4e9b\u5305\u542b\u9ed8\u8ba4\u503c\u7684\u53c2\u6570 def power(x, n=2): s = 1 while(n > 0): n -= 1 s *= n reutrn s power(3) #9 power(2, 3) #8","title":"\u9ed8\u8ba4\u53c2\u6570"},{"location":"python-function/#_6","text":"#\u4ee5\u4e0b\u8fd9\u4e2a\u51fd\u6570\u5982\u679c\u88ab\u591a\u6b21\u8c03\u7528\u4f1a\u5728\u9ed8\u8ba4\u6dfb\u52a0\u591a\u4e2aEND\u5b57\u7b26\u4e32 def add_end(l = []): l.append('END') return l #\u4e3a\u4e86\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\uff0c\u5e94\u8be5\u628a\u4f20\u5165\u7684\u9ed8\u8ba4\u53c2\u6570\u8bbe\u7f6e\u4e3a\u4e0d\u53ef\u53d8\u7684 def add_end(l = None): l = [] l.append('END') return l","title":"\u5b9a\u4e49\u9ed8\u8ba4\u53c2\u6570\u8981\u7262\u8bb0\u4e00\u70b9\uff1a\u9ed8\u8ba4\u53c2\u6570\u5fc5\u987b\u6307\u5411\u4e0d\u53d8\u5bf9\u8c61\uff01"},{"location":"python-function/#_7","text":"\u53ef\u53d8\u53c2\u6570\u5c31\u662f\u5141\u8bb8\u5728\u8c03\u7528\u53c2\u6570\u7684\u65f6\u5019\u4f20\u5165\u591a\u4e2a\uff08\u22650\u4e2a\uff09\u53c2\u6570\uff08\u7c7b\u4f3c\u4e8e\u5217\u8868\u3001\u5b57\u5178\uff09 #\u4f20\u5165\u4e00\u4e2a\u5217\u8868\uff0c\u4e25\u683c\u5730\u8bf4\u8fd9\u4e0d\u662f\u53ef\u53d8\u53c2\u6570 def calc(l): sum = 0 for n in l: sum += n return sum >>> calc([1,2,3]) #\u8fd9\u624d\u662f\u53ef\u53d8\u53c2\u6570\uff0c\u867d\u7136\u5728\u4f7f\u7528\u4e0a\u548c\u5217\u8868\u6ca1\u6709\u533a\u522b\uff0c\u4f46\u662f\u53c2\u6570nums\u63a5\u6536\u5230\u7684\u662f\u4e00\u4e2atuple\uff08\u8fd9\u4e9b\u53c2\u6570\u5728\u4f20\u5165\u65f6\u88ab\u81ea\u52a8\u7ec4\u7ec4\u88c5\u4e3a\u4e00\u4e2a\u5143\u7956\uff09 def calc(*nums): sum = 0 for n in nums: sum += n return sum >>> calc(1,2,3) 7 >>> my_ls = [1,2,3] >>> calc(*my_ls) 7","title":"\u53ef\u53d8\u53c2\u6570"},{"location":"python-function/#_8","text":"\u53ef\u53d8\u53c2\u6570\u5141\u8bb8\u4f20\u51650\u4e2a\uff5e\u591a\u4e2a\u53c2\u6570\uff0c\u800c\u5173\u952e\u5b57\u53c2\u6570\u5141\u8bb8\u5728\u8c03\u7528\u65f6\u4ee5\u5b57\u5178\u5f62\u5f0f\u4f20\u51650\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\uff08\u6ce8\u610f\u533a\u522b\uff0c\u4e00\u4e2a\u662f\u5b57\u5178\u4e00\u4e2a\u662f\u5217\u8868\uff09\uff1b\u5728\u4f20\u9012\u53c2\u6570\u65f6\u7528\u7b49\u53f7\uff08=\uff09\u8fde\u63a5\u952e\u548c\u503c #\u7528\u4e24\u4e2a\u661f\u53f7\u8868\u793a\u5173\u952e\u5b57\u53c2\u6570 def person_info(name, age, **kw): print(\"name\", name, \"age\", age, \"other\", kw) >>> person_info(\"Xiaoming\", 12) name Xiaoming age 12 other{} >>> person_info(\"Dahuang\", 35, city = \"Beijing\") name Dahuang age 35 other {'city':'Beijing'}","title":"\u5173\u952e\u5b57\u53c2\u6570"},{"location":"python-function/#_9","text":"\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u5728\u5173\u952e\u5b57\u53c2\u6570\u7684\u57fa\u7840\u4e0a\u9650\u5236\u4f20\u5165\u7684\u7684\u5173\u952e\u5b57\u7684\u53d8\u91cf\u540d \u548c\u666e\u901a\u5173\u952e\u5b57\u53c2\u6570\u4e0d\u540c\uff0c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u9700\u8981\u4e00\u4e2a\u7528\u6765\u533a\u5206\u7684\u5206\u9694\u7b26*\uff0c\u5b83\u540e\u9762\u7684\u53c2\u6570\u88ab\u8ba4\u4e3a\u662f\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570 #\u8fd9\u91cc\u661f\u53f7\u5206\u5272\u7b26\u540e\u9762\u7684city\u3001job\u662f\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570 person_info(name, age, *, city, job): print(name, age, city, job) >>> person_info(\"Alex\", 17, city = \"Beijing\", job = \"Engineer\") Alex 17 Beijing Engineer #\u770b\u6765\u8fd9\u91cc\u4e0d\u518d\u88ab\u81ea\u52a8\u7ec4\u88c5\u4e3a\u5b57\u5178 \u4e0d\u8fc7\u4e5f\u6709\u4f8b\u5916\uff0c\u5982\u679c\u53c2\u6570\u4e2d\u5df2\u7ecf\u6709\u4e00\u4e2a\u53ef\u53d8\u53c2\u6570\u7684\u8bdd\uff0c\u524d\u9762\u8bb2\u7684\u661f\u53f7\u5206\u5272\u7b26\u5c31\u4e0d\u8981\u5199\u4e86\uff08\u5176\u5b9e\u661f\u53f7\u662f\u5199\u7ed9Python\u89e3\u91ca\u5668\u770b\u7684\uff0c\u5982\u679c\u4e00\u4e2a\u661f\u53f7\u4e5f\u6ca1\u6709\u7684\u8bdd\u5c31\u65e0\u6cd5\u533a\u5206\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u548c\u4f4d\u7f6e\u53c2\u6570\u4e86\uff0c\u800c\u5982\u679c\u6709\u4e00\u4e2a\u661f\u53f7\u5373\u4f7f\u6765\u81ea\u53d8\u957f\u53c2\u6570\u5c31\u53ef\u4ee5\u533a\u5206\u5f00\u6765\uff09 #args\u662f\u53d8\u957f\u53c2\u6570\uff0c\u800ccity\u548cjob\u662f\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570 person_info(name, age, *args, city, job): print(name, age, args, city) >>> person_info(\"Liqiang\", 43, \"balabala\", city = \"Wuhan\", job = \"Coder\") Liqiang 43 balabala Wuhan Coder","title":"\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570"},{"location":"python-function/#_10","text":"\u603b\u7ed3\u4e00\u4e0b\uff0c\u5728Python\u4e2d\u4e00\u79cd\u53ef\u4ee5\u4f7f\u75285\u4e2d\u4f20\u9012\u53c2\u6570\u7684\u65b9\u5f0f\uff08\u4f4d\u7f6e\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53d8\u957f\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u3001\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff09 \u6ce8\u610f\uff0c\u8fd9\u4e9b\u53c2\u6570\u5728\u4e66\u5199\u65f6\u8981\u9075\u5faa\u4e00\u5b9a\u7684\u987a\u5e8f\u5373\uff1a\u4f4d\u7f6e\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53d8\u957f\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u3001\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff08\u548c\u672c\u6587\u7684\u884c\u6587\u987a\u5e8f\u4e00\u81f4\uff09 \u8fd9\u91cc\u7b80\u5355\u4e3e\u4e24\u4e2a\u6817\u5b50 def f1(a, b, c=0, *args, **kw): print(\"a = \", a, \"b = \", b, \"args = \", args, \"kw = \",kw) def f2(a, b, c=0, *, d, **kw): print(\"a = \", a, \"b = \", b, \"c = \", c, \"d = \", d, \"kw = \", kw) >>> f1(1, 2) a = 1 b = 2 c = 0 args =() kw = {} >>> f1(1, 2, c=3) a = 1 b = 2 c = 3 args = () kw = {} >>> f1(1, 2, 3, 'a', 'b') a = 1 b = 2 c = 3 args = ('a', 'b') kw = {} >>> f1(1, 2, 3, 'a', 'b', x = 99) a = 1 b = 2 c = 3 args = ('a', 'b') kw = {'x':99} >>> f2(1, 2, d = 99, ext = None) a = 1 b =2 c = 0 d = 99 kw = {'ext':None}","title":"\u53c2\u6570\u7ec4\u5408"},{"location":"python-function/#_11","text":"\u5173\u4e8ePython\u53c2\u6570\u4f20\u9012\uff0c\u6709\u4ee5\u4e0b\u51e0\u70b9\u63d0\u8bf7\u6ce8\u610f\uff1a \u53c2\u6570\u7684\u4f20\u9012\u662f\u901a\u8fc7\u81ea\u52a8\u5c06\u5bf9\u8c61\u8d4b\u503c\u7ed9\u672c\u5730\u53d8\u91cf\u540d\u6765\u5b9e\u73b0\u7684 \u51fd\u6570\u53c2\u6570\u5728\u5b9e\u9645\u4e2d\u53ea\u662fPython\u8d4b\u503c\u7684\u53e6\u4e00\u4e2a\u5b9e\u4f8b\u800c\u5df2\uff0c\u56e0\u4e3a\u5f15\u7528\u53ef\u4ee5\u662f\u4ee5\u6307\u9488\u7684\u5f62\u5f0f\u6765\u5b9e\u73b0\u7684\uff0c\u6240\u6709\u7684\u53c2\u6570\u5b9e\u9645\u4e0a\u90fd\u662f\u901a\u8fc7\u6307\u9488\u8fdb\u884c\u4f20\u9012\u7684\uff0c\u4f5c\u4e3a\u53c2\u6570\u88ab\u4f20\u9012\u7684\u5bf9\u8c61\u4ece\u6765\u4e0d\u81ea\u52a8\u62f7\u8d1d \u5728\u51fd\u6570\u5185\u90e8\u7684\u53c2\u6570\u540d\u7684\u8d4b\u503c\u4e0d\u4f1a\u5f71\u54cd\u8c03\u7528\u8005 \u5728\u51fd\u6570\u8fd0\u884c\u65f6\uff0c\u5728\u51fd\u6570\u5934\u90e8\u7684\u53c2\u6570\u540d\u65f6\u4e00\u4e2a\u65b0\u7684\u3001\u672c\u5730\u7684\u53d8\u91cf\u540d\uff0c\u8fd9\u4e2a\u53d8\u91cf\u540d\u662f\u5728\u51fd\u6570\u7684\u672c\u5730\u4f5c\u7528\u57df\u5185\u7684\uff0c\u51fd\u6570\u53c2\u6570\u540d\u548c\u8c03\u7528\u8005\u4f5c\u7528\u57df\u4e2d\u7684\u53d8\u91cf\u662f\u6ca1\u6709\u533a\u522b\u7684 \u6539\u53d8\u51fd\u6570\u7684\u53ef\u53d8\u5bf9\u8c61\u53c2\u6570\u7684\u503c\u4e5f\u8bb8\u4f1a\u5bf9\u8c03\u7528\u8005\u6709\u5f71\u54cd \u6362\u53e5\u8bdd\u8bf4\uff0c\u56e0\u4e3a\u53c2\u6570\u662f\u7b80\u5355\u5730\u8d4b\u503c\u7ed9\u4f20\u5165\u7684\u5bf9\u8c61\uff0c\u51fd\u6570\u5c31\u80fd\u591f\u5c31\u5730\u6539\u53d8\u4f20\u5165\u7684\u53ef\u53d8\u5bf9\u8c61\uff0c\u56e0\u6b64\u5176\u7ed3\u679c\u4f1a\u5f71\u54cd\u8c03\u7528\u8005\uff1b\u53ef\u53d8\u53c2\u6570\u5bf9\u51fd\u6570\u6765\u8bf4\u53ef\u4ee5\u505a\u8f93\u5165\u548c\u8f93\u51fa\u7684","title":"\u5199\u5728\u540e\u9762"},{"location":"python-function/#pythoncc","text":"\u4e0d\u53ef\u53d8\u53c2\u6570\u201c\u901a\u8fc7\u503c\u201d\u8fdb\u884c\u4f20\u9012 \u50cf\u6574\u6570\u548c\u5b57\u7b26\u4e32\u8fd9\u6837\u7684\u5bf9\u8c61\u662f\u4e0d\u53ef\u53d8\u5bf9\u8c61\uff0c\u5b83\u4eec\u901a\u8fc7\u5bf9\u8c61\u5f15\u7528\u800c\u4e0d\u662f\u62f7\u8d1d\u8fdb\u884c\u4f20\u9012\u7684\uff0c\u4f46\u662f\u56e0\u4e3a\u65e0\u8bba\u5982\u4f55\u90fd\u4e0d\u53ef\u80fd\u5728\u539f\u5904\u6539\u53d8\u4e0d\u53ef\u53d8\u5bf9\u8c61\uff0c\u5b9e\u9645\u7684\u6548\u679c\u5c31\u5f88\u50cf\u521b\u5efa\u4e86\u4e00\u4efd\u62f7\u8d1d \u53ef\u53d8\u5bf9\u8c61\u662f\u901a\u8fc7\u201c\u6307\u9488\u201d\u8fdb\u884c\u4f20\u9012\u7684 \u5217\u8868\u548c\u5b57\u5178\u8fd9\u6837\u7684\u5bf9\u8c61\u4e5f\u662f\u901a\u8fc7\u5bf9\u8c61\u5f15\u7528\u8fdb\u884c\u4f20\u9012\u7684\uff0c\u8fd9\u4e00\u70b9\u4e0eC\u8bed\u8a00\u4f7f\u7528\u6307\u9488\u4f20\u9012\u6570\u7ec4\u5f88\u76f8\u4f3c\uff0c\u53ef\u53d8\u5bf9\u8c61\u80fd\u591f\u5728\u51fd\u6570\u5185\u90e8\u8fdb\u884c\u539f\u5904\u7684\u6539\u53d8\uff0c\u8fd9\u4e00\u70b9\u548cC\u6570\u7ec4\u5f88\u50cf","title":"Python\u7684\u901a\u8fc7\u8d4b\u503c\u8fdb\u884c\u4f20\u9012\u7684\u673a\u5236\u4e0eC++\u7684\u5f15\u7528\u53c2\u6570\u9009\u9879\u4e0d\u5b8c\u5168\u76f8\u540c\uff0c\u4f46\u662f\u5b9e\u9645\u4e2d\uff0c\u5b83\u4e0eC\u8bed\u8a00\u7684\u53c2\u6570\u4f20\u9012\u6a21\u578b\u76f8\u5f53\u7c7b\u4f3c\uff1a"},{"location":"python-mysql/","text":"\u8001\u4e86\u8001\u4e86\uff0c\u8bb0\u4e0d\u4f4f\u4e86\u3002 http://www.cnblogs.com/wenchengxiaopenyou/p/5701899.html \u524d\u8a00 \u00b6 \u672c\u7bc7\u7684\u4e3b\u8981\u5185\u5bb9\u4e3a\u6574\u7406mysql\u7684\u57fa\u7840\u5185\u5bb9\uff0c\u5206\u4eab\u7684\u540c\u65f6\u65b9\u4fbf\u65e5\u540e\u67e5\u9605\uff0c\u540c\u65f6\u7ed3\u5408python\u7684\u5b66\u4e60\u6574\u7406python\u64cd\u4f5cmysql\u7684\u65b9\u6cd5\u4ee5\u53capython\u7684ORM\u3002 \u4e00.\u6570\u636e\u5e93\u521d\u63a2 \u00b6 \u5728\u5f00\u59cbmysql\u4e4b\u524d\u5148\u4e86\u89e3\u4e0b\u4ec0\u4e48\u662f\u6570\u636e\u5e93\uff1a \u6570\u636e\u5e93\uff08Database\uff09\u662f\u6309\u7167\u6570\u636e\u7ed3\u6784\u6765\u7ec4\u7ec7\u3001\u5b58\u50a8\u548c\u7ba1\u7406\u6570\u636e\u7684\u4ed3\u5e93\uff0c\u5b83\u4ea7\u751f\u4e8e\u8ddd\u4eca\u516d\u5341\u591a\u5e74\u524d\uff0c\u968f\u7740\u4fe1\u606f\u6280\u672f\u548c\u5e02\u573a\u7684\u53d1\u5c55\uff0c\u7279\u522b\u662f\u4e8c\u5341\u4e16\u7eaa\u4e5d\u5341\u5e74\u4ee3\u4ee5\u540e\uff0c\u6570\u636e\u7ba1\u7406\u4e0d\u518d\u4ec5\u4ec5\u662f\u5b58\u50a8\u548c\u7ba1\u7406\u6570\u636e\uff0c\u800c\u8f6c\u53d8\u6210\u7528\u6237\u6240\u9700\u8981\u7684\u5404\u79cd\u6570\u636e\u7ba1\u7406\u7684\u65b9\u5f0f\u3002\u6570\u636e\u5e93\u6709\u5f88\u591a\u79cd\u7c7b\u578b\uff0c\u4ece\u6700\u7b80\u5355\u7684\u5b58\u50a8\u6709\u5404\u79cd\u6570\u636e\u7684\u8868\u683c\u5230\u80fd\u591f\u8fdb\u884c\u6d77\u91cf\u6570\u636e\u5b58\u50a8\u7684\u5927\u578b\u6570\u636e\u5e93\u7cfb\u7edf\u90fd\u5728\u5404\u4e2a\u65b9\u9762\u5f97\u5230\u4e86\u5e7f\u6cdb\u7684\u5e94\u7528\u3002 \u901a\u4fd7\u7684\u8bb2\u6570\u636e\u5e93\u5c31\u662f\u8bb2\u6570\u636e\u4fdd\u5b58\u5728\u6587\u4ef6\u6216\u8005\u5185\u5b58\u4e2d\uff0c\u63a5\u6536\u7279\u5b9a\u7684\u547d\u4ee4\u7136\u540e\u5bf9\u6587\u4ef6\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u6570\u636e\u5e93\u5c31\u662f\u4e00\u4e2a\u5de5\u5177\u5b83\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u53bb\u7ba1\u7406\u8fd9\u4e9b\u6587\u4ef6\u5939\u6216\u8005\u6587\u4ef6\uff0c\u6211\u95e8\u53ea\u9700\u8981\u901a\u8fc7\u547d\u4ee4\u7684\u65b9\u5f0f\u544a\u8bc9\u4ed6\u4eec\u53bb\u6267\u884c\u5c31\u884c\u4e86\u3002 \u90a3\u4e48mysql\u53c8\u662f\u4ec0\u4e48\u5462\uff1f MySQL\u662f\u4e00\u4e2a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u7531\u745e\u5178MySQL AB \u516c\u53f8\u5f00\u53d1\uff0c\u76ee\u524d\u5c5e\u4e8e Oracle \u65d7\u4e0b\u516c\u53f8\u3002MySQL \u6700\u6d41\u884c\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u5728 WEB \u5e94\u7528\u65b9\u9762MySQL\u662f\u6700\u597d\u7684 RDBMS (Relational Database Management System\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf) \u5e94\u7528\u8f6f\u4ef6\u4e4b\u4e00\u3002 \u4e0emysql\u76f8\u7c7b\u4f3c\u529f\u80fd\u7684\u6570\u636e\u5e93\u8fd8\u6709\uff1aMySQL\u3001Oracle\u3001SQLite\u3001Access\u3001MS SQL Server\u7b49 \u518d\u4e86\u89e3\u4e0b\u4ec0\u4e48\u662fSQL\uff1a SQL\u662fStructured Query Language(\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00)\u7684\u7f29\u5199\u3002SQL\u662f\u4e13\u4e3a\u6570\u636e\u5e93\u800c\u5efa\u7acb\u7684\u64cd\u4f5c\u547d\u4ee4\u96c6\uff0c\u662f\u4e00\u79cd\u529f\u80fd\u9f50\u5168\u7684\u6570\u636e\u5e93\u8bed\u8a00\u3002\u5728\u4f7f\u7528\u5b83\u65f6\uff0c\u53ea\u9700\u8981\u53d1\u51fa\u201c\u505a\u4ec0\u4e48\u201d\u7684\u547d\u4ee4\uff0c\u201c\u600e\u4e48\u505a\u201d\u662f\u4e0d\u7528\u4f7f\u7528\u8005\u8003\u8651\u7684\u3002SQL\u529f\u80fd\u5f3a\u5927\u3001\u7b80\u5355\u6613\u5b66\u3001\u4f7f\u7528\u65b9\u4fbf\uff0c\u5df2\u7ecf\u6210\u4e3a\u4e86\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u57fa\u7840\uff0c\u5e76\u4e14\u73b0\u5728\u51e0\u4e4e\u6240\u6709\u7684\u6570\u636e\u5e93\u5747\u652f\u6301SQL\u3002\u6b63\u5982\u4e0a\u6587\u63d0\u5230\u7684SQl\u5c31\u662f\u6211\u4eec\u63a7\u5236\u6570\u636e\u5e93\u7684\u65b9\u6cd5\uff0c\u547d\u4ee4\u3002 \u4e09.\u771f\u6b63\u7684\u6570\u636e\u5e93\u64cd\u4f5c\uff1a \u00b6 1.\u663e\u793a\u6570\u636e\u5e93 SHOW DATABASES; \u5b89\u88c5\u5b8cmysql\u6570\u636e\u5e93\u540e\u9ed8\u8ba4\u6570\u636e\u5e93\u5982\u4e0b\uff1a mysql - \u7528\u6237\u6743\u9650\u76f8\u5173\u6570\u636e test - \u7528\u4e8e\u7528\u6237\u6d4b\u8bd5\u6570\u636e information_schema - MySQL\u672c\u8eab\u67b6\u6784\u76f8\u5173\u6570\u636e 2.\u4f7f\u7528\u6570\u636e\u5e93 USE db_name; \uff03\u6307\u5b9a\u8981\u64cd\u4f5c\u7684\u6570\u636e\u5e93\u540d\u5b57 3.\u663e\u793a\u6240\u6709\u8868 SHOW TABLES; 4.\u7528\u6237\u6388\u6743 \u5728\u7528\u6237\u6388\u6743\u90e8\u5206\u5305\u62ec\uff1a \u7528\u6237\u7ba1\u7406 \u6388\u6743\u7ba1\u7406 \u7528\u6237\u7ba1\u7406\uff1a \u521b\u5efa\u7528\u6237 create user '\u7528\u6237\u540d'@'IP\u5730\u5740' identified by '\u5bc6\u7801'; \u5220\u9664\u7528\u6237 drop user '\u7528\u6237\u540d'@'IP\u5730\u5740'; \u4fee\u6539\u7528\u6237 rename user '\u7528\u6237\u540d'@'IP\u5730\u5740'; to '\u65b0\u7528\u6237\u540d'@'IP\u5730\u5740'; \u4fee\u6539\u5bc6\u7801 set password for '\u7528\u6237\u540d'@'IP\u5730\u5740' = Password('\u65b0\u5bc6\u7801'); \u6ce8\u610f\uff1a\u7528\u6237\u6743\u9650\u76f8\u5173\u6570\u636e\u4fdd\u5b58\u5728\u9ed8\u8ba4\u7684mysql\u6570\u636e\u5e93\u7684user\u8868\u4e2d\uff0c\u867d\u7136\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5bf9\u5176\u8fdb\u884c\u64cd\u4f5c\uff0c\u4f46\u662f\u672a\u6765\u5b89\u5168\u6027\u4e0d\u5efa\u8bae\u90a3\u4e48\u505a\u3002 \u6388\u6743\u7ba1\u7406\uff1a show grants for '\u7528\u6237'@'IP\u5730\u5740' -- \u67e5\u770b\u6743\u9650 grant \u6743\u9650 on \u6570\u636e\u5e93.\u8868 to '\u7528\u6237'@'IP\u5730\u5740' -- \u6388\u6743 revoke \u6743\u9650 on \u6570\u636e\u5e93.\u8868 from '\u7528\u6237'@'IP\u5730\u5740' -- \u53d6\u6d88\u6743\u9650 \u66f4\u52a0\u8be6\u7ec6\uff1a all privileges \u9664grant\u5916\u7684\u6240\u6709\u6743\u9650 select \u4ec5\u67e5\u6743\u9650 select,insert \u67e5\u548c\u63d2\u5165\u6743\u9650 ... usage \u65e0\u8bbf\u95ee\u6743\u9650 alter \u4f7f\u7528alter table alter routine \u4f7f\u7528alter procedure\u548cdrop procedure create \u4f7f\u7528create table create routine \u4f7f\u7528create procedure create temporary tables \u4f7f\u7528create temporary tables create user \u4f7f\u7528create user\u3001drop user\u3001rename user\u548crevoke all privileges create view \u4f7f\u7528create view delete \u4f7f\u7528delete drop \u4f7f\u7528drop table execute \u4f7f\u7528call\u548c\u5b58\u50a8\u8fc7\u7a0b file \u4f7f\u7528select into outfile \u548c load data infile grant option \u4f7f\u7528grant \u548c revoke index \u4f7f\u7528index insert \u4f7f\u7528insert lock tables \u4f7f\u7528lock table process \u4f7f\u7528show full processlist select \u4f7f\u7528select show databases \u4f7f\u7528show databases show view \u4f7f\u7528show view update \u4f7f\u7528update reload \u4f7f\u7528flush shutdown \u4f7f\u7528mysqladmin shutdown(\u5173\u95edMySQL) super \udbff\udc42\udbff\udc08\u4f7f\u7528change master\u3001kill\u3001logs\u3001purge\u3001master\u548cset global\u3002\u8fd8\u5141\u8bb8mysqladmin\udbff\udd57\udbff\udd58\udbff\udc8a\udbff\udc8b\u8c03\u8bd5\u767b\u9646 replication client \u670d\u52a1\u5668\u4f4d\u7f6e\u7684\u8bbf\u95ee replication slave \u7531\u590d\u5236\u4ece\u5c5e\u4f7f\u7528 \u5bf9\u4e8e\u76ee\u6807\u6570\u636e\u5e93\u4ee5\u53ca\u5185\u90e8\u5176\u4ed6\uff1a \u6570\u636e\u5e93\u540d.* \u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709 \u6570\u636e\u5e93\u540d.\u8868 \u6307\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u67d0\u5f20\u8868 \u6570\u636e\u5e93\u540d.\u5b58\u50a8\u8fc7\u7a0b \u6307\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u5b58\u50a8\u8fc7\u7a0b *.* \u6240\u6709\u6570\u636e\u5e93 \u7528\u6237\u540d@IP\u5730\u5740 \u7528\u6237\u53ea\u80fd\u5728\u6539IP\u4e0b\u624d\u80fd\u8bbf\u95ee \u7528\u6237\u540d@192.168.1.% \u7528\u6237\u53ea\u80fd\u5728\u6539IP\u6bb5\u4e0b\u624d\u80fd\u8bbf\u95ee(\u901a\u914d\u7b26%\u8868\u793a\u4efb\u610f) \u7528\u6237\u540d@% \u7528\u6237\u53ef\u4ee5\u518d\u4efb\u610fIP\u4e0b\u8bbf\u95ee(\u9ed8\u8ba4IP\u5730\u5740\u4e3a%) \u56db.\u8868\u64cd\u4f5c \u00b6 1.\u521b\u5efa\u8868 create table \u8868\u540d( \u5217\u540d \u7c7b\u578b \u662f\u5426\u53ef\u4ee5\u4e3a\u7a7a\uff0c \u5217\u540d \u7c7b\u578b \u662f\u5426\u53ef\u4ee5\u4e3a\u7a7a ) \u662f\u5426\u53ef\u7a7a \u662f\u5426\u53ef\u7a7a\uff0cnull\u8868\u793a\u7a7a\uff0c\u975e\u5b57\u7b26\u4e32 not null - \u4e0d\u53ef\u7a7a null - \u53ef\u7a7a \u9ed8\u8ba4\u503c \u9ed8\u8ba4\u503c\uff0c\u521b\u5efa\u5217\u65f6\u53ef\u4ee5\u6307\u5b9a\u9ed8\u8ba4\u503c\uff0c\u5f53\u63d2\u5165\u6570\u636e\u65f6\u5982\u679c\u672a\u4e3b\u52a8\u8bbe\u7f6e\uff0c\u5219\u81ea\u52a8\u6dfb\u52a0\u9ed8\u8ba4\u503c create table tb1( nid int not null defalut 2, num int not null ) \u81ea\u589e \u81ea\u589e\uff0c\u5982\u679c\u4e3a\u67d0\u5217\u8bbe\u7f6e\u81ea\u589e\u5217\uff0c\u63d2\u5165\u6570\u636e\u65f6\u65e0\u9700\u8bbe\u7f6e\u6b64\u5217\uff0c\u9ed8\u8ba4\u5c06\u81ea\u589e\uff08\u8868\u4e2d\u53ea\u80fd\u6709\u4e00\u4e2a\u81ea\u589e\u5217\uff09 create table tb1( nid int not null auto_increment primary key, num int null ) \u6216 create table tb1( nid int not null auto_increment, num int null, index(nid) ) \u6ce8\u610f\uff1a1\u3001\u5bf9\u4e8e\u81ea\u589e\u5217\uff0c\u5fc5\u987b\u662f\u7d22\u5f15\uff08\u542b\u4e3b\u952e\uff09\u3002 2\u3001\u5bf9\u4e8e\u81ea\u589e\u53ef\u4ee5\u8bbe\u7f6e\u6b65\u957f\u548c\u8d77\u59cb\u503c show session variables like 'auto_inc%'; set session auto_increment_increment=2; set session auto_increment_offset=10; shwo global variables like 'auto_inc%'; set global auto_increment_increment=2; set global auto_increment_offset=10; \u4e3b\u952e \u5916\u952e\uff0c\u4e00\u4e2a\u7279\u6b8a\u7684\u7d22\u5f15\uff0c\u53ea\u80fd\u662f\u6307\u5b9a\u5185\u5bb9 creat table color( nid int not null primary key, name char(16) not null ) create table fruit( nid int not null primary key, smt char(32) null , color_id int not null, constraint fk_cc foreign key (color_id) references color(nid) ) 2.\u5220\u9664\u8868 drop table \u8868\u540d 3.\u6e05\u7a7a\u8868 delete from \u8868\u540d truncate table \u8868\u540d 4.\u4fee\u6539\u8868 \u6dfb\u52a0\u5217\uff1aalter table \u8868\u540d add \u5217\u540d \u7c7b\u578b \u5220\u9664\u5217\uff1aalter table \u8868\u540d drop column \u5217\u540d \u4fee\u6539\u5217\uff1a alter table \u8868\u540d modify column \u5217\u540d \u7c7b\u578b; -- \u7c7b\u578b alter table \u8868\u540d change \u539f\u5217\u540d \u65b0\u5217\u540d \u7c7b\u578b; -- \u5217\u540d\uff0c\u7c7b\u578b \u6dfb\u52a0\u4e3b\u952e\uff1a alter table \u8868\u540d add primary key(\u5217\u540d); \u5220\u9664\u4e3b\u952e\uff1a alter table \u8868\u540d drop primary key; alter table \u8868\u540d modify \u5217\u540d int, drop primary key; \u6dfb\u52a0\u5916\u952e\uff1aalter table \u4ece\u8868 add constraint \u5916\u952e\u540d\u79f0\uff08\u5f62\u5982\uff1aFK_\u4ece\u8868_\u4e3b\u8868\uff09 foreign key \u4ece\u8868(\u5916\u952e\u5b57\u6bb5) references \u4e3b\u8868(\u4e3b\u952e\u5b57\u6bb5); \u5220\u9664\u5916\u952e\uff1aalter table \u8868\u540d drop foreign key \u5916\u952e\u540d\u79f0 \u4fee\u6539\u9ed8\u8ba4\u503c\uff1aALTER TABLE testalter_tbl ALTER i SET DEFAULT 1000; \u5220\u9664\u9ed8\u8ba4\u503c\uff1aALTER TABLE testalter_tbl ALTER i DROP DEFAULT; \u4e94.mysql\u7684\u57fa\u672c\u64cd\u4f5c \u00b6 1.\u589e insert into \u8868 (\u5217\u540d,\u5217\u540d...) values (\u503c,\u503c,\u503c...) insert into \u8868 (\u5217\u540d,\u5217\u540d...) values (\u503c,\u503c,\u503c...),(\u503c,\u503c,\u503c...) insert into \u8868 (\u5217\u540d,\u5217\u540d...) select (\u5217\u540d,\u5217\u540d...) from \u8868 2.\u5220 delete from \u8868 delete from \u8868 where id\uff1d1 and name\uff1d'zhaowencheng' 3.\u6539 update \u8868 set name \uff1d 'zhaowencheng' where id>1 4.\u67e5 select * from \u8868 select * from \u8868 where id > 1 select nid,name,gender as gg from \u8868 where id > 1 5.\u5176\u5b83 1\u3001\u6761\u4ef6 select * from \u8868 where id > 1 and name != 'zhaowencheng' and num = 12; select * from \u8868 where id between 5 and 16; select * from \u8868 where id in (11,22,33) select * from \u8868 where id not in (11,22,33) select * from \u8868 where id in (select nid from \u8868) 2\u3001\u901a\u914d\u7b26 select * from \u8868 where name like 'zhao%' - zhao\u5f00\u5934\u7684\u6240\u6709\uff08\u591a\u4e2a\u5b57\u7b26\u4e32\uff09 select * from \u8868 where name like 'zhao_' - zhao\u5f00\u5934\u7684\u6240\u6709\uff08\u4e00\u4e2a\u5b57\u7b26\uff09 3\u3001\u9650\u5236 select * from \u8868 limit 5; - \u524d5\u884c select * from \u8868 limit 4,5; - \u4ece\u7b2c4\u884c\u5f00\u59cb\u76845\u884c select * from \u8868 limit 5 offset 4 - \u4ece\u7b2c4\u884c\u5f00\u59cb\u76845\u884c 4\u3001\u6392\u5e8f select * from \u8868 order by \u5217 asc - \u6839\u636e \u201c\u5217\u201d \u4ece\u5c0f\u5230\u5927\u6392\u5217 select * from \u8868 order by \u5217 desc - \u6839\u636e \u201c\u5217\u201d \u4ece\u5927\u5230\u5c0f\u6392\u5217 select * from \u8868 order by \u52171 desc,\u52172 asc - \u6839\u636e \u201c\u52171\u201d \u4ece\u5927\u5230\u5c0f\u6392\u5217\uff0c\u5982\u679c\u76f8\u540c\u5219\u6309\u52172\u4ece\u5c0f\u5230\u5927\u6392\u5e8f 5\u3001\u5206\u7ec4 select num from \u8868 group by num select num,nid from \u8868 group by num,nid select num,nid from \u8868 where nid > 10 group by num,nid order nid desc select num,nid,count(*),sum(score),max(score),min(score) from \u8868 group by num,nid select num from \u8868 group by num having max(id) > 10 \u7279\u522b\u7684\uff1agroup by \u5fc5\u987b\u5728where\u4e4b\u540e\uff0corder by\u4e4b\u524d 6\u3001\u8fde\u8868 \u65e0\u5bf9\u5e94\u5173\u7cfb\u5219\u4e0d\u663e\u793a select A.num, A.name, B.name from A,B Where A.nid = B.nid \u65e0\u5bf9\u5e94\u5173\u7cfb\u5219\u4e0d\u663e\u793a select A.num, A.name, B.name from A inner join B on A.nid = B.nid A\u8868\u6240\u6709\u663e\u793a\uff0c\u5982\u679cB\u4e2d\u65e0\u5bf9\u5e94\u5173\u7cfb\uff0c\u5219\u503c\u4e3anull select A.num, A.name, B.name from A left join B on A.nid = B.nid B\u8868\u6240\u6709\u663e\u793a\uff0c\u5982\u679cB\u4e2d\u65e0\u5bf9\u5e94\u5173\u7cfb\uff0c\u5219\u503c\u4e3anull select A.num, A.name, B.name from A right join B on A.nid = B.nid 7\u3001\u7ec4\u5408 \u7ec4\u5408\uff0c\u81ea\u52a8\u5904\u7406\u91cd\u5408 select nickname from A union select name from B \u7ec4\u5408\uff0c\u4e0d\u5904\u7406\u91cd\u5408 select nickname from A union all select name from B \u516d.pymsql \u00b6 1.\u5b89\u88c5pymysql \uff03\u76f4\u63a5pip\u5b89\u88c5 pip3 install pymysql 2.\u4f7f\u7528 \u6267\u884csql #!/usr/bin/env python # -*- coding:utf-8 -*- import pymysql # \u521b\u5efa\u8fde\u63a5 conn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1') # \u521b\u5efa\u6e38\u6807 cursor = conn.cursor() # \u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u6536\u5f71\u54cd\u884c\u6570 effect_row = cursor.execute(\"update hosts set host = '1.1.1.2'\") # \u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u53d7\u5f71\u54cd\u884c\u6570 #effect_row = cursor.execute(\"update hosts set host = '1.1.1.2' where nid > %s\", (1,)) # \u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u53d7\u5f71\u54cd\u884c\u6570 #effect_row = cursor.executemany(\"insert into hosts(host,color_id)values(%s,%s)\", [(\"1.1.1.11\",1),(\"1.1.1.11\",2)]) # \u63d0\u4ea4\uff0c\u4e0d\u7136\u65e0\u6cd5\u4fdd\u5b58\u65b0\u5efa\u6216\u8005\u4fee\u6539\u7684\u6570\u636e conn.commit() # \u5173\u95ed\u6e38\u6807 cursor.close() # \u5173\u95ed\u8fde\u63a5 conn.close() \u83b7\u53d6\u65b0\u521b\u5efa\u6570\u636e\u81ea\u589eID #!/usr/bin/env python # -*- coding:utf-8 -*- import pymysql conn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1') cursor = conn.cursor() cursor.executemany(\"insert into hosts(host,color_id)values(%s,%s)\", [(\"1.1.1.11\",1),(\"1.1.1.11\",2)]) conn.commit() cursor.close() conn.close() # \u83b7\u53d6\u6700\u65b0\u81ea\u589eID new_id = cursor.lastrowid \u83b7\u53d6\u67e5\u8be2\u6570\u636e #!/usr/bin/env python # -*- coding:utf-8 -*- import pymysql conn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1') cursor = conn.cursor() cursor.execute(\"select * from hosts\") # \u83b7\u53d6\u7b2c\u4e00\u884c\u6570\u636e row_1 = cursor.fetchone() # \u83b7\u53d6\u524dn\u884c\u6570\u636e # row_2 = cursor.fetchmany(3) # \u83b7\u53d6\u6240\u6709\u6570\u636e # row_3 = cursor.fetchall() conn.commit() cursor.close() conn.close() \u6ce8\uff1a\u5728fetch\u6570\u636e\u65f6\u6309\u7167\u987a\u5e8f\u8fdb\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528cursor.scroll(num,mode)\u6765\u79fb\u52a8\u6e38\u6807\u4f4d\u7f6e\uff0c\u5982\uff1a cursor.scroll(1,mode='relative') # \u76f8\u5bf9\u5f53\u524d\u4f4d\u7f6e\u79fb\u52a8 cursor.scroll(2,mode='absolute') # \u76f8\u5bf9\u7edd\u5bf9\u4f4d\u7f6e\u79fb\u52a8 fetch\u6570\u636e\u7c7b\u578b \u5173\u4e8e\u9ed8\u8ba4\u83b7\u53d6\u7684\u6570\u636e\u662f\u5143\u7956\u7c7b\u578b\uff0c\u5982\u679c\u60f3\u8981\u6216\u8005\u5b57\u5178\u7c7b\u578b\u7684\u6570\u636e\uff0c\u5373\uff1a #!/usr/bin/env python # -*- coding:utf-8 -*- import pymysql conn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1') # \u6e38\u6807\u8bbe\u7f6e\u4e3a\u5b57\u5178\u7c7b\u578b cursor = conn.cursor(cursor=pymysql.cursors.DictCursor) r = cursor.execute(\"call p1()\") result = cursor.fetchone() conn.commit() cursor.close() conn.close()","title":"\u64cd\u4f5cmysql\u57fa\u7840"},{"location":"python-mysql/#_1","text":"\u672c\u7bc7\u7684\u4e3b\u8981\u5185\u5bb9\u4e3a\u6574\u7406mysql\u7684\u57fa\u7840\u5185\u5bb9\uff0c\u5206\u4eab\u7684\u540c\u65f6\u65b9\u4fbf\u65e5\u540e\u67e5\u9605\uff0c\u540c\u65f6\u7ed3\u5408python\u7684\u5b66\u4e60\u6574\u7406python\u64cd\u4f5cmysql\u7684\u65b9\u6cd5\u4ee5\u53capython\u7684ORM\u3002","title":"\u524d\u8a00"},{"location":"python-mysql/#_2","text":"\u5728\u5f00\u59cbmysql\u4e4b\u524d\u5148\u4e86\u89e3\u4e0b\u4ec0\u4e48\u662f\u6570\u636e\u5e93\uff1a \u6570\u636e\u5e93\uff08Database\uff09\u662f\u6309\u7167\u6570\u636e\u7ed3\u6784\u6765\u7ec4\u7ec7\u3001\u5b58\u50a8\u548c\u7ba1\u7406\u6570\u636e\u7684\u4ed3\u5e93\uff0c\u5b83\u4ea7\u751f\u4e8e\u8ddd\u4eca\u516d\u5341\u591a\u5e74\u524d\uff0c\u968f\u7740\u4fe1\u606f\u6280\u672f\u548c\u5e02\u573a\u7684\u53d1\u5c55\uff0c\u7279\u522b\u662f\u4e8c\u5341\u4e16\u7eaa\u4e5d\u5341\u5e74\u4ee3\u4ee5\u540e\uff0c\u6570\u636e\u7ba1\u7406\u4e0d\u518d\u4ec5\u4ec5\u662f\u5b58\u50a8\u548c\u7ba1\u7406\u6570\u636e\uff0c\u800c\u8f6c\u53d8\u6210\u7528\u6237\u6240\u9700\u8981\u7684\u5404\u79cd\u6570\u636e\u7ba1\u7406\u7684\u65b9\u5f0f\u3002\u6570\u636e\u5e93\u6709\u5f88\u591a\u79cd\u7c7b\u578b\uff0c\u4ece\u6700\u7b80\u5355\u7684\u5b58\u50a8\u6709\u5404\u79cd\u6570\u636e\u7684\u8868\u683c\u5230\u80fd\u591f\u8fdb\u884c\u6d77\u91cf\u6570\u636e\u5b58\u50a8\u7684\u5927\u578b\u6570\u636e\u5e93\u7cfb\u7edf\u90fd\u5728\u5404\u4e2a\u65b9\u9762\u5f97\u5230\u4e86\u5e7f\u6cdb\u7684\u5e94\u7528\u3002 \u901a\u4fd7\u7684\u8bb2\u6570\u636e\u5e93\u5c31\u662f\u8bb2\u6570\u636e\u4fdd\u5b58\u5728\u6587\u4ef6\u6216\u8005\u5185\u5b58\u4e2d\uff0c\u63a5\u6536\u7279\u5b9a\u7684\u547d\u4ee4\u7136\u540e\u5bf9\u6587\u4ef6\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u6570\u636e\u5e93\u5c31\u662f\u4e00\u4e2a\u5de5\u5177\u5b83\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u53bb\u7ba1\u7406\u8fd9\u4e9b\u6587\u4ef6\u5939\u6216\u8005\u6587\u4ef6\uff0c\u6211\u95e8\u53ea\u9700\u8981\u901a\u8fc7\u547d\u4ee4\u7684\u65b9\u5f0f\u544a\u8bc9\u4ed6\u4eec\u53bb\u6267\u884c\u5c31\u884c\u4e86\u3002 \u90a3\u4e48mysql\u53c8\u662f\u4ec0\u4e48\u5462\uff1f MySQL\u662f\u4e00\u4e2a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u7531\u745e\u5178MySQL AB \u516c\u53f8\u5f00\u53d1\uff0c\u76ee\u524d\u5c5e\u4e8e Oracle \u65d7\u4e0b\u516c\u53f8\u3002MySQL \u6700\u6d41\u884c\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u5728 WEB \u5e94\u7528\u65b9\u9762MySQL\u662f\u6700\u597d\u7684 RDBMS (Relational Database Management System\uff0c\u5173\u7cfb\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf) \u5e94\u7528\u8f6f\u4ef6\u4e4b\u4e00\u3002 \u4e0emysql\u76f8\u7c7b\u4f3c\u529f\u80fd\u7684\u6570\u636e\u5e93\u8fd8\u6709\uff1aMySQL\u3001Oracle\u3001SQLite\u3001Access\u3001MS SQL Server\u7b49 \u518d\u4e86\u89e3\u4e0b\u4ec0\u4e48\u662fSQL\uff1a SQL\u662fStructured Query Language(\u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00)\u7684\u7f29\u5199\u3002SQL\u662f\u4e13\u4e3a\u6570\u636e\u5e93\u800c\u5efa\u7acb\u7684\u64cd\u4f5c\u547d\u4ee4\u96c6\uff0c\u662f\u4e00\u79cd\u529f\u80fd\u9f50\u5168\u7684\u6570\u636e\u5e93\u8bed\u8a00\u3002\u5728\u4f7f\u7528\u5b83\u65f6\uff0c\u53ea\u9700\u8981\u53d1\u51fa\u201c\u505a\u4ec0\u4e48\u201d\u7684\u547d\u4ee4\uff0c\u201c\u600e\u4e48\u505a\u201d\u662f\u4e0d\u7528\u4f7f\u7528\u8005\u8003\u8651\u7684\u3002SQL\u529f\u80fd\u5f3a\u5927\u3001\u7b80\u5355\u6613\u5b66\u3001\u4f7f\u7528\u65b9\u4fbf\uff0c\u5df2\u7ecf\u6210\u4e3a\u4e86\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u57fa\u7840\uff0c\u5e76\u4e14\u73b0\u5728\u51e0\u4e4e\u6240\u6709\u7684\u6570\u636e\u5e93\u5747\u652f\u6301SQL\u3002\u6b63\u5982\u4e0a\u6587\u63d0\u5230\u7684SQl\u5c31\u662f\u6211\u4eec\u63a7\u5236\u6570\u636e\u5e93\u7684\u65b9\u6cd5\uff0c\u547d\u4ee4\u3002","title":"\u4e00.\u6570\u636e\u5e93\u521d\u63a2"},{"location":"python-mysql/#_3","text":"1.\u663e\u793a\u6570\u636e\u5e93 SHOW DATABASES; \u5b89\u88c5\u5b8cmysql\u6570\u636e\u5e93\u540e\u9ed8\u8ba4\u6570\u636e\u5e93\u5982\u4e0b\uff1a mysql - \u7528\u6237\u6743\u9650\u76f8\u5173\u6570\u636e test - \u7528\u4e8e\u7528\u6237\u6d4b\u8bd5\u6570\u636e information_schema - MySQL\u672c\u8eab\u67b6\u6784\u76f8\u5173\u6570\u636e 2.\u4f7f\u7528\u6570\u636e\u5e93 USE db_name; \uff03\u6307\u5b9a\u8981\u64cd\u4f5c\u7684\u6570\u636e\u5e93\u540d\u5b57 3.\u663e\u793a\u6240\u6709\u8868 SHOW TABLES; 4.\u7528\u6237\u6388\u6743 \u5728\u7528\u6237\u6388\u6743\u90e8\u5206\u5305\u62ec\uff1a \u7528\u6237\u7ba1\u7406 \u6388\u6743\u7ba1\u7406 \u7528\u6237\u7ba1\u7406\uff1a \u521b\u5efa\u7528\u6237 create user '\u7528\u6237\u540d'@'IP\u5730\u5740' identified by '\u5bc6\u7801'; \u5220\u9664\u7528\u6237 drop user '\u7528\u6237\u540d'@'IP\u5730\u5740'; \u4fee\u6539\u7528\u6237 rename user '\u7528\u6237\u540d'@'IP\u5730\u5740'; to '\u65b0\u7528\u6237\u540d'@'IP\u5730\u5740'; \u4fee\u6539\u5bc6\u7801 set password for '\u7528\u6237\u540d'@'IP\u5730\u5740' = Password('\u65b0\u5bc6\u7801'); \u6ce8\u610f\uff1a\u7528\u6237\u6743\u9650\u76f8\u5173\u6570\u636e\u4fdd\u5b58\u5728\u9ed8\u8ba4\u7684mysql\u6570\u636e\u5e93\u7684user\u8868\u4e2d\uff0c\u867d\u7136\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5bf9\u5176\u8fdb\u884c\u64cd\u4f5c\uff0c\u4f46\u662f\u672a\u6765\u5b89\u5168\u6027\u4e0d\u5efa\u8bae\u90a3\u4e48\u505a\u3002 \u6388\u6743\u7ba1\u7406\uff1a show grants for '\u7528\u6237'@'IP\u5730\u5740' -- \u67e5\u770b\u6743\u9650 grant \u6743\u9650 on \u6570\u636e\u5e93.\u8868 to '\u7528\u6237'@'IP\u5730\u5740' -- \u6388\u6743 revoke \u6743\u9650 on \u6570\u636e\u5e93.\u8868 from '\u7528\u6237'@'IP\u5730\u5740' -- \u53d6\u6d88\u6743\u9650 \u66f4\u52a0\u8be6\u7ec6\uff1a all privileges \u9664grant\u5916\u7684\u6240\u6709\u6743\u9650 select \u4ec5\u67e5\u6743\u9650 select,insert \u67e5\u548c\u63d2\u5165\u6743\u9650 ... usage \u65e0\u8bbf\u95ee\u6743\u9650 alter \u4f7f\u7528alter table alter routine \u4f7f\u7528alter procedure\u548cdrop procedure create \u4f7f\u7528create table create routine \u4f7f\u7528create procedure create temporary tables \u4f7f\u7528create temporary tables create user \u4f7f\u7528create user\u3001drop user\u3001rename user\u548crevoke all privileges create view \u4f7f\u7528create view delete \u4f7f\u7528delete drop \u4f7f\u7528drop table execute \u4f7f\u7528call\u548c\u5b58\u50a8\u8fc7\u7a0b file \u4f7f\u7528select into outfile \u548c load data infile grant option \u4f7f\u7528grant \u548c revoke index \u4f7f\u7528index insert \u4f7f\u7528insert lock tables \u4f7f\u7528lock table process \u4f7f\u7528show full processlist select \u4f7f\u7528select show databases \u4f7f\u7528show databases show view \u4f7f\u7528show view update \u4f7f\u7528update reload \u4f7f\u7528flush shutdown \u4f7f\u7528mysqladmin shutdown(\u5173\u95edMySQL) super \udbff\udc42\udbff\udc08\u4f7f\u7528change master\u3001kill\u3001logs\u3001purge\u3001master\u548cset global\u3002\u8fd8\u5141\u8bb8mysqladmin\udbff\udd57\udbff\udd58\udbff\udc8a\udbff\udc8b\u8c03\u8bd5\u767b\u9646 replication client \u670d\u52a1\u5668\u4f4d\u7f6e\u7684\u8bbf\u95ee replication slave \u7531\u590d\u5236\u4ece\u5c5e\u4f7f\u7528 \u5bf9\u4e8e\u76ee\u6807\u6570\u636e\u5e93\u4ee5\u53ca\u5185\u90e8\u5176\u4ed6\uff1a \u6570\u636e\u5e93\u540d.* \u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709 \u6570\u636e\u5e93\u540d.\u8868 \u6307\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u67d0\u5f20\u8868 \u6570\u636e\u5e93\u540d.\u5b58\u50a8\u8fc7\u7a0b \u6307\u5b9a\u6570\u636e\u5e93\u4e2d\u7684\u5b58\u50a8\u8fc7\u7a0b *.* \u6240\u6709\u6570\u636e\u5e93 \u7528\u6237\u540d@IP\u5730\u5740 \u7528\u6237\u53ea\u80fd\u5728\u6539IP\u4e0b\u624d\u80fd\u8bbf\u95ee \u7528\u6237\u540d@192.168.1.% \u7528\u6237\u53ea\u80fd\u5728\u6539IP\u6bb5\u4e0b\u624d\u80fd\u8bbf\u95ee(\u901a\u914d\u7b26%\u8868\u793a\u4efb\u610f) \u7528\u6237\u540d@% \u7528\u6237\u53ef\u4ee5\u518d\u4efb\u610fIP\u4e0b\u8bbf\u95ee(\u9ed8\u8ba4IP\u5730\u5740\u4e3a%)","title":"\u4e09.\u771f\u6b63\u7684\u6570\u636e\u5e93\u64cd\u4f5c\uff1a"},{"location":"python-mysql/#_4","text":"1.\u521b\u5efa\u8868 create table \u8868\u540d( \u5217\u540d \u7c7b\u578b \u662f\u5426\u53ef\u4ee5\u4e3a\u7a7a\uff0c \u5217\u540d \u7c7b\u578b \u662f\u5426\u53ef\u4ee5\u4e3a\u7a7a ) \u662f\u5426\u53ef\u7a7a \u662f\u5426\u53ef\u7a7a\uff0cnull\u8868\u793a\u7a7a\uff0c\u975e\u5b57\u7b26\u4e32 not null - \u4e0d\u53ef\u7a7a null - \u53ef\u7a7a \u9ed8\u8ba4\u503c \u9ed8\u8ba4\u503c\uff0c\u521b\u5efa\u5217\u65f6\u53ef\u4ee5\u6307\u5b9a\u9ed8\u8ba4\u503c\uff0c\u5f53\u63d2\u5165\u6570\u636e\u65f6\u5982\u679c\u672a\u4e3b\u52a8\u8bbe\u7f6e\uff0c\u5219\u81ea\u52a8\u6dfb\u52a0\u9ed8\u8ba4\u503c create table tb1( nid int not null defalut 2, num int not null ) \u81ea\u589e \u81ea\u589e\uff0c\u5982\u679c\u4e3a\u67d0\u5217\u8bbe\u7f6e\u81ea\u589e\u5217\uff0c\u63d2\u5165\u6570\u636e\u65f6\u65e0\u9700\u8bbe\u7f6e\u6b64\u5217\uff0c\u9ed8\u8ba4\u5c06\u81ea\u589e\uff08\u8868\u4e2d\u53ea\u80fd\u6709\u4e00\u4e2a\u81ea\u589e\u5217\uff09 create table tb1( nid int not null auto_increment primary key, num int null ) \u6216 create table tb1( nid int not null auto_increment, num int null, index(nid) ) \u6ce8\u610f\uff1a1\u3001\u5bf9\u4e8e\u81ea\u589e\u5217\uff0c\u5fc5\u987b\u662f\u7d22\u5f15\uff08\u542b\u4e3b\u952e\uff09\u3002 2\u3001\u5bf9\u4e8e\u81ea\u589e\u53ef\u4ee5\u8bbe\u7f6e\u6b65\u957f\u548c\u8d77\u59cb\u503c show session variables like 'auto_inc%'; set session auto_increment_increment=2; set session auto_increment_offset=10; shwo global variables like 'auto_inc%'; set global auto_increment_increment=2; set global auto_increment_offset=10; \u4e3b\u952e \u5916\u952e\uff0c\u4e00\u4e2a\u7279\u6b8a\u7684\u7d22\u5f15\uff0c\u53ea\u80fd\u662f\u6307\u5b9a\u5185\u5bb9 creat table color( nid int not null primary key, name char(16) not null ) create table fruit( nid int not null primary key, smt char(32) null , color_id int not null, constraint fk_cc foreign key (color_id) references color(nid) ) 2.\u5220\u9664\u8868 drop table \u8868\u540d 3.\u6e05\u7a7a\u8868 delete from \u8868\u540d truncate table \u8868\u540d 4.\u4fee\u6539\u8868 \u6dfb\u52a0\u5217\uff1aalter table \u8868\u540d add \u5217\u540d \u7c7b\u578b \u5220\u9664\u5217\uff1aalter table \u8868\u540d drop column \u5217\u540d \u4fee\u6539\u5217\uff1a alter table \u8868\u540d modify column \u5217\u540d \u7c7b\u578b; -- \u7c7b\u578b alter table \u8868\u540d change \u539f\u5217\u540d \u65b0\u5217\u540d \u7c7b\u578b; -- \u5217\u540d\uff0c\u7c7b\u578b \u6dfb\u52a0\u4e3b\u952e\uff1a alter table \u8868\u540d add primary key(\u5217\u540d); \u5220\u9664\u4e3b\u952e\uff1a alter table \u8868\u540d drop primary key; alter table \u8868\u540d modify \u5217\u540d int, drop primary key; \u6dfb\u52a0\u5916\u952e\uff1aalter table \u4ece\u8868 add constraint \u5916\u952e\u540d\u79f0\uff08\u5f62\u5982\uff1aFK_\u4ece\u8868_\u4e3b\u8868\uff09 foreign key \u4ece\u8868(\u5916\u952e\u5b57\u6bb5) references \u4e3b\u8868(\u4e3b\u952e\u5b57\u6bb5); \u5220\u9664\u5916\u952e\uff1aalter table \u8868\u540d drop foreign key \u5916\u952e\u540d\u79f0 \u4fee\u6539\u9ed8\u8ba4\u503c\uff1aALTER TABLE testalter_tbl ALTER i SET DEFAULT 1000; \u5220\u9664\u9ed8\u8ba4\u503c\uff1aALTER TABLE testalter_tbl ALTER i DROP DEFAULT;","title":"\u56db.\u8868\u64cd\u4f5c"},{"location":"python-mysql/#mysql","text":"1.\u589e insert into \u8868 (\u5217\u540d,\u5217\u540d...) values (\u503c,\u503c,\u503c...) insert into \u8868 (\u5217\u540d,\u5217\u540d...) values (\u503c,\u503c,\u503c...),(\u503c,\u503c,\u503c...) insert into \u8868 (\u5217\u540d,\u5217\u540d...) select (\u5217\u540d,\u5217\u540d...) from \u8868 2.\u5220 delete from \u8868 delete from \u8868 where id\uff1d1 and name\uff1d'zhaowencheng' 3.\u6539 update \u8868 set name \uff1d 'zhaowencheng' where id>1 4.\u67e5 select * from \u8868 select * from \u8868 where id > 1 select nid,name,gender as gg from \u8868 where id > 1 5.\u5176\u5b83 1\u3001\u6761\u4ef6 select * from \u8868 where id > 1 and name != 'zhaowencheng' and num = 12; select * from \u8868 where id between 5 and 16; select * from \u8868 where id in (11,22,33) select * from \u8868 where id not in (11,22,33) select * from \u8868 where id in (select nid from \u8868) 2\u3001\u901a\u914d\u7b26 select * from \u8868 where name like 'zhao%' - zhao\u5f00\u5934\u7684\u6240\u6709\uff08\u591a\u4e2a\u5b57\u7b26\u4e32\uff09 select * from \u8868 where name like 'zhao_' - zhao\u5f00\u5934\u7684\u6240\u6709\uff08\u4e00\u4e2a\u5b57\u7b26\uff09 3\u3001\u9650\u5236 select * from \u8868 limit 5; - \u524d5\u884c select * from \u8868 limit 4,5; - \u4ece\u7b2c4\u884c\u5f00\u59cb\u76845\u884c select * from \u8868 limit 5 offset 4 - \u4ece\u7b2c4\u884c\u5f00\u59cb\u76845\u884c 4\u3001\u6392\u5e8f select * from \u8868 order by \u5217 asc - \u6839\u636e \u201c\u5217\u201d \u4ece\u5c0f\u5230\u5927\u6392\u5217 select * from \u8868 order by \u5217 desc - \u6839\u636e \u201c\u5217\u201d \u4ece\u5927\u5230\u5c0f\u6392\u5217 select * from \u8868 order by \u52171 desc,\u52172 asc - \u6839\u636e \u201c\u52171\u201d \u4ece\u5927\u5230\u5c0f\u6392\u5217\uff0c\u5982\u679c\u76f8\u540c\u5219\u6309\u52172\u4ece\u5c0f\u5230\u5927\u6392\u5e8f 5\u3001\u5206\u7ec4 select num from \u8868 group by num select num,nid from \u8868 group by num,nid select num,nid from \u8868 where nid > 10 group by num,nid order nid desc select num,nid,count(*),sum(score),max(score),min(score) from \u8868 group by num,nid select num from \u8868 group by num having max(id) > 10 \u7279\u522b\u7684\uff1agroup by \u5fc5\u987b\u5728where\u4e4b\u540e\uff0corder by\u4e4b\u524d 6\u3001\u8fde\u8868 \u65e0\u5bf9\u5e94\u5173\u7cfb\u5219\u4e0d\u663e\u793a select A.num, A.name, B.name from A,B Where A.nid = B.nid \u65e0\u5bf9\u5e94\u5173\u7cfb\u5219\u4e0d\u663e\u793a select A.num, A.name, B.name from A inner join B on A.nid = B.nid A\u8868\u6240\u6709\u663e\u793a\uff0c\u5982\u679cB\u4e2d\u65e0\u5bf9\u5e94\u5173\u7cfb\uff0c\u5219\u503c\u4e3anull select A.num, A.name, B.name from A left join B on A.nid = B.nid B\u8868\u6240\u6709\u663e\u793a\uff0c\u5982\u679cB\u4e2d\u65e0\u5bf9\u5e94\u5173\u7cfb\uff0c\u5219\u503c\u4e3anull select A.num, A.name, B.name from A right join B on A.nid = B.nid 7\u3001\u7ec4\u5408 \u7ec4\u5408\uff0c\u81ea\u52a8\u5904\u7406\u91cd\u5408 select nickname from A union select name from B \u7ec4\u5408\uff0c\u4e0d\u5904\u7406\u91cd\u5408 select nickname from A union all select name from B","title":"\u4e94.mysql\u7684\u57fa\u672c\u64cd\u4f5c"},{"location":"python-mysql/#pymsql","text":"1.\u5b89\u88c5pymysql \uff03\u76f4\u63a5pip\u5b89\u88c5 pip3 install pymysql 2.\u4f7f\u7528 \u6267\u884csql #!/usr/bin/env python # -*- coding:utf-8 -*- import pymysql # \u521b\u5efa\u8fde\u63a5 conn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1') # \u521b\u5efa\u6e38\u6807 cursor = conn.cursor() # \u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u6536\u5f71\u54cd\u884c\u6570 effect_row = cursor.execute(\"update hosts set host = '1.1.1.2'\") # \u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u53d7\u5f71\u54cd\u884c\u6570 #effect_row = cursor.execute(\"update hosts set host = '1.1.1.2' where nid > %s\", (1,)) # \u6267\u884cSQL\uff0c\u5e76\u8fd4\u56de\u53d7\u5f71\u54cd\u884c\u6570 #effect_row = cursor.executemany(\"insert into hosts(host,color_id)values(%s,%s)\", [(\"1.1.1.11\",1),(\"1.1.1.11\",2)]) # \u63d0\u4ea4\uff0c\u4e0d\u7136\u65e0\u6cd5\u4fdd\u5b58\u65b0\u5efa\u6216\u8005\u4fee\u6539\u7684\u6570\u636e conn.commit() # \u5173\u95ed\u6e38\u6807 cursor.close() # \u5173\u95ed\u8fde\u63a5 conn.close() \u83b7\u53d6\u65b0\u521b\u5efa\u6570\u636e\u81ea\u589eID #!/usr/bin/env python # -*- coding:utf-8 -*- import pymysql conn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1') cursor = conn.cursor() cursor.executemany(\"insert into hosts(host,color_id)values(%s,%s)\", [(\"1.1.1.11\",1),(\"1.1.1.11\",2)]) conn.commit() cursor.close() conn.close() # \u83b7\u53d6\u6700\u65b0\u81ea\u589eID new_id = cursor.lastrowid \u83b7\u53d6\u67e5\u8be2\u6570\u636e #!/usr/bin/env python # -*- coding:utf-8 -*- import pymysql conn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1') cursor = conn.cursor() cursor.execute(\"select * from hosts\") # \u83b7\u53d6\u7b2c\u4e00\u884c\u6570\u636e row_1 = cursor.fetchone() # \u83b7\u53d6\u524dn\u884c\u6570\u636e # row_2 = cursor.fetchmany(3) # \u83b7\u53d6\u6240\u6709\u6570\u636e # row_3 = cursor.fetchall() conn.commit() cursor.close() conn.close() \u6ce8\uff1a\u5728fetch\u6570\u636e\u65f6\u6309\u7167\u987a\u5e8f\u8fdb\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528cursor.scroll(num,mode)\u6765\u79fb\u52a8\u6e38\u6807\u4f4d\u7f6e\uff0c\u5982\uff1a cursor.scroll(1,mode='relative') # \u76f8\u5bf9\u5f53\u524d\u4f4d\u7f6e\u79fb\u52a8 cursor.scroll(2,mode='absolute') # \u76f8\u5bf9\u7edd\u5bf9\u4f4d\u7f6e\u79fb\u52a8 fetch\u6570\u636e\u7c7b\u578b \u5173\u4e8e\u9ed8\u8ba4\u83b7\u53d6\u7684\u6570\u636e\u662f\u5143\u7956\u7c7b\u578b\uff0c\u5982\u679c\u60f3\u8981\u6216\u8005\u5b57\u5178\u7c7b\u578b\u7684\u6570\u636e\uff0c\u5373\uff1a #!/usr/bin/env python # -*- coding:utf-8 -*- import pymysql conn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='123', db='t1') # \u6e38\u6807\u8bbe\u7f6e\u4e3a\u5b57\u5178\u7c7b\u578b cursor = conn.cursor(cursor=pymysql.cursors.DictCursor) r = cursor.execute(\"call p1()\") result = cursor.fetchone() conn.commit() cursor.close() conn.close()","title":"\u516d.pymsql"},{"location":"python-styleguide/","text":"Python \u98ce\u683c\u6307\u5357 - \u5185\u5bb9\u76ee\u5f55 \u00b6 https://zh-google-styleguide.readthedocs.io/en/latest/google-python-styleguide/contents/","title":"Python\u98ce\u683c\u89c4\u8303"},{"location":"python-styleguide/#python-","text":"https://zh-google-styleguide.readthedocs.io/en/latest/google-python-styleguide/contents/","title":"Python \u98ce\u683c\u6307\u5357 - \u5185\u5bb9\u76ee\u5f55"},{"location":"python/","text":"Python 3 \u90a3\u4e9b\u975e\u5e38\u89c4\u7684\u6280\u5de7 \u00b6 \u539f\u6587 \u5217\u8868\u63a8\u5bfc\u5f0f \u00b6 \u4f60\u6709\u4e00\u4e2alist\uff1abag = [1, 2, 3, 4, 5] \u73b0\u5728\u4f60\u60f3\u8ba9\u6240\u6709\u5143\u7d20\u7ffb\u500d\uff0c\u8ba9\u5b83\u770b\u8d77\u6765\u662f\u8fd9\u4e2a\u6837\u5b50\uff1a[2, 4, 6, 8, 10] \u5927\u591a\u521d\u5b66\u8005\uff0c\u6839\u636e\u4e4b\u524d\u8bed\u8a00\u7684\u7ecf\u9a8c\u4f1a\u5927\u6982\u8fd9\u6837\u6765\u505a bag = [1, 2, 3, 4, 5] for i in range(len(bag)): bag[i] = bag[i] * 2 \u4f46\u662f\u6709\u66f4\u597d\u7684\u65b9\u6cd5\uff1a bag = [elem * 2 for elem in bag] \u5f88\u7b80\u6d01\u5bf9\u4e0d\u5bf9\uff1f\u8fd9\u53eb\u505aPython\u7684\u5217\u8868\u63a8\u5bfc\u5f0f\u3002 \u70b9\u51fbTrey Hunner\u2019s tutorial[1]\u67e5\u770b\u66f4\u591a\u5173\u4e8e\u5217\u8868\u63a8\u5bfc\u5f0f\u7684\u4ecb\u7ecd\u3002 \u904d\u5386\u5217\u8868 \u00b6 \u7ee7\u7eed\uff0c\u8fd8\u662f\u4e0a\u9762\u7684\u5217\u8868\u3002 \u5982\u679c\u53ef\u80fd\u5c3d\u91cf\u907f\u514d\u8fd9\u6837\u505a\uff1a bag = [1, 2, 3, 4, 5] for i in range(len(bag)): print(bag[i]) \u53d6\u800c\u4ee3\u4e4b\u7684\u5e94\u8be5\u662f\u8fd9\u6837\uff1a bag = [1, 2, 3, 4, 5] for i in bag: print(i) \u5982\u679cx\u662f\u4e00\u4e2a\u5217\u8868\uff0c\u4f60\u53ef\u4ee5\u5bf9\u5b83\u7684\u5143\u7d20\u8fdb\u884c\u8fed\u4ee3\u3002\u591a\u6570\u60c5\u51b5\u4e0b\u4f60\u4e0d\u9700\u8981\u5404\u5143\u7d20\u7684\u7d22\u5f15\uff0c\u4f46\u5982\u679c\u4f60\u975e\u8981\u8fd9\u6837\u505a\uff0c\u90a3\u5c31\u7528enumerate\u51fd\u6570\u3002\u5b83\u50cf\u4e0b\u8fb9\u7684\u6837\u5b50\uff1a bag = [1, 2, 3, 4, 5] for index, element in enumerate(bag): print(index, element) \u975e\u5e38\u76f4\u89c2\u660e\u4e86\u3002 \u5143\u7d20\u4e92\u6362 \u00b6 \u5982\u679c\u4f60\u662f\u4ecejava\u6216\u8005C\u8bed\u8a00\u8f6c\u5230Python\u6765\uff0c\u53ef\u80fd\u4f1a\u4e60\u60ef\u4e8e\u8fd9\u6837\uff1a a = 5 b = 10 # \u4ea4\u6362 a \u548c b tmp = a a = b b = tmp \u4f46Python\u63d0\u4f9b\u4e86\u4e00\u4e2a\u66f4\u81ea\u7136\u66f4\u597d\u7684\u65b9\u6cd5\uff01 a = 5 b = 10 # \u4ea4\u6362a \u548c b a, b = b, a \u591f\u6f02\u4eae\u5427\uff1f \u521d\u59cb\u5316\u5217\u8868 \u00b6 \u5047\u5982\u4f60\u8981\u4e00\u4e2a\u662f10\u4e2a\u6574\u65700\u7684\u5217\u8868\uff0c\u4f60\u53ef\u80fd\u9996\u5148\u60f3\u5230\uff1a bag = for _ in range(10): bag.append(0) \u6362\u4e2a\u65b9\u5f0f\u5427\uff1a bag = [0] * 10 \u770b\uff0c\u591a\u4f18\u96c5\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u4f60\u5217\u8868\u5305\u542b\u4e86\u5217\u8868\uff0c\u8fd9\u6837\u505a\u4f1a\u4ea7\u751f\u6d45\u62f7\u8d1d\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff1a bag_of_bags = [[0]] * 5 # [[0], [0], [0], [0], [0]] bag_of_bags[0][0] = 1 # [[1], [1], [1], [1], [1]] Oops\uff01\u6240\u6709\u7684\u5217\u8868\u90fd\u6539\u53d8\u4e86\uff0c\u800c\u6211\u4eec\u53ea\u662f\u60f3\u8981\u6539\u53d8\u7b2c\u4e00\u4e2a\u5217\u8868\u3002 \u6539\u4e00\u6539\u5566\uff1a bag_of_bags = [[0] for _ in range(5)] # [[0], [0], [0], [0], [0]] bag_of_bags[0][0] = 1 # [[1], [0], [0], [0], [0]] \u540c\u65f6\u8bb0\u4f4f\uff1a \u201c\u8fc7\u65e9\u4f18\u5316\u662f\u4e07\u6076\u4e4b\u6e90\u201d \u95ee\u95ee\u81ea\u5df1\uff0c\u521d\u59cb\u5316\u4e00\u4e2a\u5217\u8868\u662f\u5fc5\u987b\u7684\u5417\uff1f \u6784\u9020\u5b57\u7b26\u4e32 \u00b6 \u4f60\u4f1a\u7ecf\u5e38\u9700\u8981\u6253\u5370\u5b57\u7b26\u4e32\u3002\u8981\u662f\u6709\u5f88\u591a\u53d8\u91cf\uff0c\u907f\u514d\u4e0b\u9762\u8fd9\u6837\uff1a name = \"Raymond\" age = 22 born_in = \"Oakland, CA\" string = \"Hello my name is \" + name + \"and I'm \" + str(age) + \" years old. I was born in \" + born_in + \".\" print(string) \u989d\uff0c\u8fd9\u770b\u8d77\u6765\u591a\u4e71\u5440\uff1f\u4f60\u53ef\u4ee5\u7528\u4e2a\u6f02\u4eae\u7b80\u6d01\u7684\u65b9\u6cd5\u6765\u4ee3\u66ff\uff0c.format\u3002 \u8fd9\u6837\u505a\uff1a name = \"Raymond\" age = 22 born_in = \"Oakland, CA\" string = \"Hello my name is {0} and I'm {1} years old. I was born in {2}.\".format(name, age, born_in) print(string) \u597d\u591a\u4e86\uff01 \u8fd4\u56de \u00b6 Python\u5141\u8bb8\u4f60\u5728\u4e00\u4e2a\u51fd\u6570\u4e2d\u8fd4\u56de\u591a\u4e2a\u5143\u7d20\uff0c\u8fd9\u8ba9\u751f\u6d3b\u66f4\u7b80\u5355\u3002\u4f46\u662f\u5728\u89e3\u5305\u5143\u7ec4\u7684\u65f6\u5019\u51fa\u51fa\u7ebf\u8fd9\u6837\u7684\u5e38\u89c1\u9519\u8bef\uff1a def binary: return 0, 1 result = binary zero = result[0] one = result[1] \u8fd9\u662f\u6ca1\u5fc5\u8981\u7684\uff0c\u4f60\u5b8c\u5168\u53ef\u4ee5\u6362\u6210\u8fd9\u6837\uff1a def binary: return 0, 1 zero, one = binary \u8981\u662f\u4f60\u9700\u8981\u6240\u6709\u7684\u5143\u7d20\u88ab\u8fd4\u56de\uff0c\u7528\u4e2a\u4e0b\u5212\u7ebf_\uff1a zero, _ = binary \u5c31\u662f\u8fd9\u4e48\u9ad8\u6548\u7387\uff01 \u8bbf\u95ee \u00b6 \u4f60\u4e5f\u4f1a\u7ecf\u5e38\u7ed9dicts\u4e2d\u5199\u5165key\uff0cpair\uff08\u952e\uff0c\u503c\uff09\u3002 \u5982\u679c\u4f60\u8bd5\u56fe\u8bbf\u95ee\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u4e8edict\u7684key\uff0c\u53ef\u80fd\u4f1a\u4e3a\u4e86\u907f\u514dKeyError\u9519\u8bef\uff0c\u4f60\u4f1a\u503e\u5411\u4e8e\u8fd9\u6837\u505a\uff1a countr = {} bag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7] for i in bag: if i in countr: countr[i] += 1 else: countr[i] = 1 for i in range(10): if i in countr: print(\"Count of {}: {}\".format(i, countr[i])) else: print(\"Count of {}: {}\".format(i, 0)) \u4f46\u662f\uff0c\u7528get\u662f\u4e2a\u66f4\u597d\u7684\u529e\u6cd5\u3002 countr = {} bag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7] for i in bag: countr[i] = countr.get(i, 0) + 1 for i in range(10): print(\"Count of {}: {}\".format(i, countr.get(i, 0))) \u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u7528setdefault\u6765\u4ee3\u66ff\u3002 \u8fd9\u8fd8\u7528\u4e00\u4e2a\u66f4\u7b80\u5355\u5374\u591a\u8d39\u70b9\u5f00\u9500\u7684\u529e\u6cd5\uff1a bag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7] countr = dict([(num, bag.count(num)) for num in bag]) for i in range(10): print(\"Count of {}: {}\".format(i, countr.get(i, 0))) \u4f60\u4e5f\u53ef\u4ee5\u7528dict\u63a8\u5bfc\u5f0f\u3002 countr = {num: bag.count(num) for num in bag} \u8fd9\u4e24\u79cd\u65b9\u6cd5\u5f00\u9500\u5927\u662f\u56e0\u4e3a\u5b83\u4eec\u5728\u6bcf\u6b21count\u88ab\u8c03\u7528\u65f6\u90fd\u4f1a\u5bf9\u5217\u8868\u904d\u5386\u3002 \u4f7f\u7528\u5e93 \u00b6 \u73b0\u6709\u7684\u5e93\u53ea\u9700\u5bfc\u5165\u4f60\u5c31\u53ef\u4ee5\u505a\u4f60\u771f\u6b63\u60f3\u505a\u7684\u4e86\u3002 \u8fd8\u662f\u8bf4\u524d\u9762\u7684\u4f8b\u5b50\uff0c\u6211\u4eec\u5efa\u4e00\u4e2a\u51fd\u6570\u6765\u6570\u4e00\u4e2a\u6570\u5b57\u5728\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\u3002\u90a3\u4e48\uff0c\u5df2\u7ecf\u6709\u4e00\u4e2a\u5e93\u5c31\u53ef\u4ee5\u505a\u8fd9\u6837\u7684\u4e8b\u60c5\u3002 from collections import Counter bag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7] countr = Counter(bag) for i in range(10): print(\"Count of {}: {}\".format(i, countr[i])) \u4e00\u4e9b\u7528\u5e93\u7684\u7406\u7531\uff1a \u4ee3\u7801\u662f\u6b63\u786e\u800c\u4e14\u7ecf\u8fc7\u6d4b\u8bd5\u7684\u3002 \u5b83\u4eec\u7684\u7b97\u6cd5\u53ef\u80fd\u4f1a\u662f\u6700\u4f18\u7684\uff0c\u8fd9\u6837\u5c31\u8dd1\u7684\u66f4\u5feb\u3002 \u62bd\u8c61\u5316\uff1a\u5b83\u4eec\u6307\u5411\u660e\u786e\u800c\u4e14\u6587\u6863\u53cb\u597d\uff0c\u4f60\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u90a3\u4e9b\u8fd8\u6ca1\u6709\u88ab\u5b9e\u73b0\u7684\u3002 \u6700\u540e\uff0c\u5b83\u90fd\u5df2\u7ecf\u5728\u90a3\u513f\u4e86\uff0c\u4f60\u4e0d\u7528\u518d\u9020\u8f6e\u5b50\u4e86\u3002 \u5728\u5217\u8868\u4e2d\u5207\u7247/\u6b65\u8fdb \u00b6 \u4f60\u53ef\u4ee5\u6307\u5b9astart\u7684\u70b9\u548cstop\u70b9\uff0c\u5c31\u50cf\u8fd9\u6837list[start:stop:step]\u3002\u6211\u4eec\u53d6\u51fa\u5217\u8868\u4e2d\u7684\u524d5\u4e2a\u5143\u7d20\uff1a bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] for elem in bag[:5]: print(elem) \u8fd9\u5c31\u662f\u5207\u7247\uff0c\u6211\u4eec\u6307\u5b9astop\u70b9\u662f5\uff0c\u518d\u505c\u6b62\u524d\u5c31\u4f1a\u4ece\u5217\u8868\u4e2d\u53d6\u51fa5\u4e2a\u5143\u7d20\u3002 \u8981\u662f\u6700\u540e5\u4e2a\u5143\u7d20\u600e\u4e48\u505a\uff1f bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] for elem in bag[-5:]: print(elem) \u6ca1\u770b\u660e\u767d\u5417\uff1f-5\u610f\u5473\u7740\u4ece\u5217\u8868\u7684\u7ed3\u5c3e\u53d6\u51fa5\u4e2a\u5143\u7d20\u3002 \u5982\u679c\u4f60\u60f3\u5bf9\u5217\u8868\u4e2d\u5143\u7d20\u95f4\u9694\u64cd\u4f5c\uff0c\u4f60\u53ef\u80fd\u4f1a\u8fd9\u6837\u505a\uff1a bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] for index, elem in enumerate(bag): if index % 2 == 0: print(elem) \u4f46\u662f\u4f60\u5e94\u8be5\u8fd9\u6837\u6765\u505a\uff1a bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] for elem in bag[::2]: print(elem) # \u6216\u8005\u7528 ranges bag = list(range(0,10,2)) print(bag) \u8fd9\u5c31\u662f\u5217\u8868\u4e2d\u7684\u6b65\u8fdb\u3002list[::2]\u610f\u601d\u662f\u904d\u5386\u5217\u8868\u540c\u65f6\u4e24\u6b65\u53d6\u51fa\u4e00\u4e2a\u5143\u7d20\u3002 \u4f60\u53ef\u4ee5\u7528list[::-1]\u5f88\u9177\u7684\u7ffb\u8f6c\u5217\u8868\u3002 tab\u952e\u8fd8\u662f\u7a7a\u683c\u952e \u00b6 \u957f\u65f6\u95f4\u6765\u770b\uff0c\u5c06tab\u548c\u7a7a\u683c\u6df7\u5728\u4e00\u8d77\u4f1a\u9020\u6210\u707e\u96be\uff0c\u4f60\u4f1a\u770b\u5230IndentationError: unexpected indent\u3002\u4e0d\u7ba1\u4f60\u9009\u62e9tab\u952e\u8fd8\u662f\u7a7a\u683c\u952e\uff0c\u4f60\u5e94\u8be5\u5728\u4f60\u7684\u6587\u4ef6\u548c\u9879\u76ee\u4e2d\u4e00\u76f4\u4fdd\u6301\u4f7f\u7528\u3002 \u4e00\u4e2a\u4f7f\u7528\u7a7a\u683c\u800c\u4e0d\u662ftab\u7684\u539f\u56e0\u662f\uff0ctab\u4e0d\u662f\u5728\u6240\u6709\u7f16\u8f91\u5668\u4e2d\u90fd\u4e00\u6837\u7684\u3002\u89c6\u5462\u6240\u7528\u7684\u7f16\u8f91\u5668\uff0ctab\u53ef\u80fd\u4f1a\u88ab\u5f53\u4f5c2\u52308\u4e2a\u7a7a\u683c\u3002 \u4f60\u4e5f\u53ef\u4ee5\u5728\u5199\u4ee3\u7801\u65f6\u7528\u7a7a\u683c\u6765\u5b9a\u4e49tab\u3002\u8fd9\u6837\u4f60\u53ef\u4ee5\u81ea\u5df1\u9009\u62e9\u7528\u51e0\u4e2a\u7a7a\u683c\u6765\u5f53\u505atab\u3002\u5927\u591a\u6570Python\u7528\u6237\u662f\u75284\u4e2a\u7a7a\u683c\u3002 for\u6587\u51e6\u7406\u304c1\u884c\u3067\u66f8\u3051\u308b\uff01\u7d20\u6575\u306a\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18 \u00b6 \u539f\u6587 1\u884c\u3067\u66f8\u304f\u30ea\u30b9\u30c8\u51e6\u7406 \u00b6 \u3055\u3063\u305d\u304f\u30ea\u30b9\u30c8\u5185\u5305\u8a18\u8ff0\uff08list comprehension\uff09\u3092\u6271\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u4eca\u56de\u306f\u4ee5\u4e0b\u306e\u914d\u5217\u30c7\u30fc\u30bf\u3092\u6271\u3046\u3053\u3068\u3068\u3057\u307e\u3059\u3002 data = [1, 2, 3, 4, 5] \u3053\u306e\u914d\u5217\u306b\u3064\u3044\u3066\u3001\u5404\u8981\u7d20\u306e\u5024\u30922\u500d\u306b\u3059\u308b\u51e6\u7406\u3092\u901a\u5e38\u306efor\u6587\u3067\u8a18\u8ff0\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002 data\u914d\u5217\u306e\u4e2d\u8eab\u30922\u500d\u306b\u3059\u308b \u00b6 newData = [] for d in data: newData.append(d * 2) \u3053\u306e3\u884c\u306e\u5b9f\u88c5\u3092\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3067\u8a18\u8ff0\u3059\u308b\u30681\u884c\u3067\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u7d20\u6575\uff01 data\u914d\u5217\u306e\u4e2d\u8eab\u30922\u500d\u306b\u3059\u308b \u00b6 newData = [d * 2 for d in data] \u3053\u306e\u66f8\u304d\u65b9\u306f\u30b7\u30f3\u30d7\u30eb\u3060\u3057\u76f4\u611f\u7684\u306b\u7406\u89e3\u3067\u304d\u308b\u306e\u3067\u3001\u306a\u304b\u306a\u304b\u4fbf\u5229\u3067\u3059\u3002 1\u884c\u3067\u66f8\u304f\u30ea\u30b9\u30c8\u51e6\u7406\uff08if\u6587\u4ed8\u304d\uff09 \u00b6 \u3055\u3089\u306b\u3001\u51e6\u7406\u306e\u4e2d\u3067\u6761\u4ef6\u5f0f\uff08if\u6587\uff09\u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070\u5076\u6570\u306e\u307f\u51e6\u7406\u3057\u305f\u3044\u5834\u5408\u306b\u3001\u901a\u5e38\u306e\u66f8\u304d\u65b9\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002 newData = [] for d in data: if d % 2 == 0: newData.append(d * 2) \u4e0a\u8a18\u306e\u5834\u5408\u306b\u306f4\u884c\u306e\u5b9f\u88c5\u3067\u3059\u304c\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3060\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b1\u884c\u3067\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 newData = [d * 2 for d in data if d % 2 == 0] \u30aa\u30e9\u30a4\u30ea\u30fc\u306e\u672c\u3084Web\u4e0a\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3082\u826f\u304f\u898b\u308b\u8a18\u8ff0\u306a\u306e\u3067\u3001\u3053\u306e\u8a18\u8ff0\u306f\u8aad\u307f\u66f8\u304d\u3067\u304d\u308b\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002 \u30e9\u30e0\u30c0\u5f0f\uff0bfilter\u3067\u540c\u3058\u3053\u3068\u3092\u5b9f\u73fe\u3067\u304d\u308b \u00b6 \u30e9\u30e0\u30c0\u5f0f\u3067\u3082\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3068\u540c\u3058\u3088\u3046\u306b\u30011\u884c\u3067\u51e6\u7406\u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 newData = [] for d in data: if d % 2 == 0: newData.append(d) \u3053\u308c\u3092\u30e9\u30e0\u30c0\u5f0f\u3067\u66f8\u304f\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002 newData = filter(lambda x:x%2==0, data) \u3053\u306e\u8a18\u8ff0\u3082\u306a\u304b\u306a\u304b\u826f\u3055\u305d\u3046\u3067\u3059\u306d\uff01\u305f\u3060\u30e9\u30e0\u30c0\u5f0f\u306e\u5834\u5408\u306b\u306f\u3001filter\u3057\u305f\u5f8c\u306b\u6f14\u7b97\u3092\u884c\u3046\uff08\u4f8b\uff1a\u5024\u30922\u500d\u306b\u3059\u308b\uff09\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306e\u65b9\u304c\u3088\u308a\u67d4\u8edf\u306b\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002 \u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306f\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3082\u826f\u3044 \u00b6 \u901a\u5e38\u306efor\u6587\u3092\u66f8\u304f\u3088\u308a\u3082\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306e\u65b9\u304c\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u826f\u3044\u3067\u3059\u3002\u3044\u304f\u3064\u304b\u8abf\u3079\u305f\u60c5\u5831\u306b\u3088\u308b\u3068\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3067for\u51e6\u7406\u3059\u308c\u3070\u3001\u8a18\u8ff0\u3057\u305f\u6587\u6cd5\u3092C\u8a00\u8a9e\u30ec\u30d9\u30eb\u3067\u51e6\u7406\u3059\u308b\u305f\u3081\u901f\u3044\u3068\u306e\u3053\u3068\u3002\u5b9f\u969b\u306b\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002 import time # \u5229\u7528\u3059\u308b\u30c7\u30fc\u30bf data = [i for i in range(1, 1000000)] # \u901a\u5e38\u306efor\u6587 time1 = time.clock() newData = [] for d in data: if d % 2 == 0: newData.append(d) time2 = time.clock() print time2 - time1 #0.234422\u79d2 # \u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18 time1 = time.clock() newData = [d for d in data if d % 2 == 0] time2 = time.clock() print time2 - time1 #0.185301\u79d2 # filter\u3068\u30e9\u30e0\u30c0\u5f0f time1 = time.clock() newData = filter(lambda x:x%2==0, data) time2 = time.clock() print time2 - time1 #0.184838 \u4f55\u5ea6\u304b\u8a66\u3057\u305f\u3068\u3053\u308d\u3001\u4e0a\u8a18\u4f8b\u306e\u5834\u5408\u306b\u306f\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306f\u901a\u5e38\u306efor\u6587\u8a18\u8ff0\u3088\u308a\u308222\uff05\u9ad8\u901f\u3067\u3057\u305f\uff08\u50d5\u306eMacBookAir\u306e\u5834\u5408\uff09\u3002","title":"\u975e\u5e38\u89c4\u7684\u6280\u5de7"},{"location":"python/#python-3","text":"\u539f\u6587","title":"Python 3 \u90a3\u4e9b\u975e\u5e38\u89c4\u7684\u6280\u5de7"},{"location":"python/#_1","text":"\u4f60\u6709\u4e00\u4e2alist\uff1abag = [1, 2, 3, 4, 5] \u73b0\u5728\u4f60\u60f3\u8ba9\u6240\u6709\u5143\u7d20\u7ffb\u500d\uff0c\u8ba9\u5b83\u770b\u8d77\u6765\u662f\u8fd9\u4e2a\u6837\u5b50\uff1a[2, 4, 6, 8, 10] \u5927\u591a\u521d\u5b66\u8005\uff0c\u6839\u636e\u4e4b\u524d\u8bed\u8a00\u7684\u7ecf\u9a8c\u4f1a\u5927\u6982\u8fd9\u6837\u6765\u505a bag = [1, 2, 3, 4, 5] for i in range(len(bag)): bag[i] = bag[i] * 2 \u4f46\u662f\u6709\u66f4\u597d\u7684\u65b9\u6cd5\uff1a bag = [elem * 2 for elem in bag] \u5f88\u7b80\u6d01\u5bf9\u4e0d\u5bf9\uff1f\u8fd9\u53eb\u505aPython\u7684\u5217\u8868\u63a8\u5bfc\u5f0f\u3002 \u70b9\u51fbTrey Hunner\u2019s tutorial[1]\u67e5\u770b\u66f4\u591a\u5173\u4e8e\u5217\u8868\u63a8\u5bfc\u5f0f\u7684\u4ecb\u7ecd\u3002","title":"\u5217\u8868\u63a8\u5bfc\u5f0f"},{"location":"python/#_2","text":"\u7ee7\u7eed\uff0c\u8fd8\u662f\u4e0a\u9762\u7684\u5217\u8868\u3002 \u5982\u679c\u53ef\u80fd\u5c3d\u91cf\u907f\u514d\u8fd9\u6837\u505a\uff1a bag = [1, 2, 3, 4, 5] for i in range(len(bag)): print(bag[i]) \u53d6\u800c\u4ee3\u4e4b\u7684\u5e94\u8be5\u662f\u8fd9\u6837\uff1a bag = [1, 2, 3, 4, 5] for i in bag: print(i) \u5982\u679cx\u662f\u4e00\u4e2a\u5217\u8868\uff0c\u4f60\u53ef\u4ee5\u5bf9\u5b83\u7684\u5143\u7d20\u8fdb\u884c\u8fed\u4ee3\u3002\u591a\u6570\u60c5\u51b5\u4e0b\u4f60\u4e0d\u9700\u8981\u5404\u5143\u7d20\u7684\u7d22\u5f15\uff0c\u4f46\u5982\u679c\u4f60\u975e\u8981\u8fd9\u6837\u505a\uff0c\u90a3\u5c31\u7528enumerate\u51fd\u6570\u3002\u5b83\u50cf\u4e0b\u8fb9\u7684\u6837\u5b50\uff1a bag = [1, 2, 3, 4, 5] for index, element in enumerate(bag): print(index, element) \u975e\u5e38\u76f4\u89c2\u660e\u4e86\u3002","title":"\u904d\u5386\u5217\u8868"},{"location":"python/#_3","text":"\u5982\u679c\u4f60\u662f\u4ecejava\u6216\u8005C\u8bed\u8a00\u8f6c\u5230Python\u6765\uff0c\u53ef\u80fd\u4f1a\u4e60\u60ef\u4e8e\u8fd9\u6837\uff1a a = 5 b = 10 # \u4ea4\u6362 a \u548c b tmp = a a = b b = tmp \u4f46Python\u63d0\u4f9b\u4e86\u4e00\u4e2a\u66f4\u81ea\u7136\u66f4\u597d\u7684\u65b9\u6cd5\uff01 a = 5 b = 10 # \u4ea4\u6362a \u548c b a, b = b, a \u591f\u6f02\u4eae\u5427\uff1f","title":"\u5143\u7d20\u4e92\u6362"},{"location":"python/#_4","text":"\u5047\u5982\u4f60\u8981\u4e00\u4e2a\u662f10\u4e2a\u6574\u65700\u7684\u5217\u8868\uff0c\u4f60\u53ef\u80fd\u9996\u5148\u60f3\u5230\uff1a bag = for _ in range(10): bag.append(0) \u6362\u4e2a\u65b9\u5f0f\u5427\uff1a bag = [0] * 10 \u770b\uff0c\u591a\u4f18\u96c5\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u4f60\u5217\u8868\u5305\u542b\u4e86\u5217\u8868\uff0c\u8fd9\u6837\u505a\u4f1a\u4ea7\u751f\u6d45\u62f7\u8d1d\u3002 \u4e3e\u4e2a\u4f8b\u5b50\uff1a bag_of_bags = [[0]] * 5 # [[0], [0], [0], [0], [0]] bag_of_bags[0][0] = 1 # [[1], [1], [1], [1], [1]] Oops\uff01\u6240\u6709\u7684\u5217\u8868\u90fd\u6539\u53d8\u4e86\uff0c\u800c\u6211\u4eec\u53ea\u662f\u60f3\u8981\u6539\u53d8\u7b2c\u4e00\u4e2a\u5217\u8868\u3002 \u6539\u4e00\u6539\u5566\uff1a bag_of_bags = [[0] for _ in range(5)] # [[0], [0], [0], [0], [0]] bag_of_bags[0][0] = 1 # [[1], [0], [0], [0], [0]] \u540c\u65f6\u8bb0\u4f4f\uff1a \u201c\u8fc7\u65e9\u4f18\u5316\u662f\u4e07\u6076\u4e4b\u6e90\u201d \u95ee\u95ee\u81ea\u5df1\uff0c\u521d\u59cb\u5316\u4e00\u4e2a\u5217\u8868\u662f\u5fc5\u987b\u7684\u5417\uff1f","title":"\u521d\u59cb\u5316\u5217\u8868"},{"location":"python/#_5","text":"\u4f60\u4f1a\u7ecf\u5e38\u9700\u8981\u6253\u5370\u5b57\u7b26\u4e32\u3002\u8981\u662f\u6709\u5f88\u591a\u53d8\u91cf\uff0c\u907f\u514d\u4e0b\u9762\u8fd9\u6837\uff1a name = \"Raymond\" age = 22 born_in = \"Oakland, CA\" string = \"Hello my name is \" + name + \"and I'm \" + str(age) + \" years old. I was born in \" + born_in + \".\" print(string) \u989d\uff0c\u8fd9\u770b\u8d77\u6765\u591a\u4e71\u5440\uff1f\u4f60\u53ef\u4ee5\u7528\u4e2a\u6f02\u4eae\u7b80\u6d01\u7684\u65b9\u6cd5\u6765\u4ee3\u66ff\uff0c.format\u3002 \u8fd9\u6837\u505a\uff1a name = \"Raymond\" age = 22 born_in = \"Oakland, CA\" string = \"Hello my name is {0} and I'm {1} years old. I was born in {2}.\".format(name, age, born_in) print(string) \u597d\u591a\u4e86\uff01","title":"\u6784\u9020\u5b57\u7b26\u4e32"},{"location":"python/#_6","text":"Python\u5141\u8bb8\u4f60\u5728\u4e00\u4e2a\u51fd\u6570\u4e2d\u8fd4\u56de\u591a\u4e2a\u5143\u7d20\uff0c\u8fd9\u8ba9\u751f\u6d3b\u66f4\u7b80\u5355\u3002\u4f46\u662f\u5728\u89e3\u5305\u5143\u7ec4\u7684\u65f6\u5019\u51fa\u51fa\u7ebf\u8fd9\u6837\u7684\u5e38\u89c1\u9519\u8bef\uff1a def binary: return 0, 1 result = binary zero = result[0] one = result[1] \u8fd9\u662f\u6ca1\u5fc5\u8981\u7684\uff0c\u4f60\u5b8c\u5168\u53ef\u4ee5\u6362\u6210\u8fd9\u6837\uff1a def binary: return 0, 1 zero, one = binary \u8981\u662f\u4f60\u9700\u8981\u6240\u6709\u7684\u5143\u7d20\u88ab\u8fd4\u56de\uff0c\u7528\u4e2a\u4e0b\u5212\u7ebf_\uff1a zero, _ = binary \u5c31\u662f\u8fd9\u4e48\u9ad8\u6548\u7387\uff01","title":"\u8fd4\u56de"},{"location":"python/#_7","text":"\u4f60\u4e5f\u4f1a\u7ecf\u5e38\u7ed9dicts\u4e2d\u5199\u5165key\uff0cpair\uff08\u952e\uff0c\u503c\uff09\u3002 \u5982\u679c\u4f60\u8bd5\u56fe\u8bbf\u95ee\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u4e8edict\u7684key\uff0c\u53ef\u80fd\u4f1a\u4e3a\u4e86\u907f\u514dKeyError\u9519\u8bef\uff0c\u4f60\u4f1a\u503e\u5411\u4e8e\u8fd9\u6837\u505a\uff1a countr = {} bag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7] for i in bag: if i in countr: countr[i] += 1 else: countr[i] = 1 for i in range(10): if i in countr: print(\"Count of {}: {}\".format(i, countr[i])) else: print(\"Count of {}: {}\".format(i, 0)) \u4f46\u662f\uff0c\u7528get\u662f\u4e2a\u66f4\u597d\u7684\u529e\u6cd5\u3002 countr = {} bag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7] for i in bag: countr[i] = countr.get(i, 0) + 1 for i in range(10): print(\"Count of {}: {}\".format(i, countr.get(i, 0))) \u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u7528setdefault\u6765\u4ee3\u66ff\u3002 \u8fd9\u8fd8\u7528\u4e00\u4e2a\u66f4\u7b80\u5355\u5374\u591a\u8d39\u70b9\u5f00\u9500\u7684\u529e\u6cd5\uff1a bag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7] countr = dict([(num, bag.count(num)) for num in bag]) for i in range(10): print(\"Count of {}: {}\".format(i, countr.get(i, 0))) \u4f60\u4e5f\u53ef\u4ee5\u7528dict\u63a8\u5bfc\u5f0f\u3002 countr = {num: bag.count(num) for num in bag} \u8fd9\u4e24\u79cd\u65b9\u6cd5\u5f00\u9500\u5927\u662f\u56e0\u4e3a\u5b83\u4eec\u5728\u6bcf\u6b21count\u88ab\u8c03\u7528\u65f6\u90fd\u4f1a\u5bf9\u5217\u8868\u904d\u5386\u3002","title":"\u8bbf\u95ee"},{"location":"python/#_8","text":"\u73b0\u6709\u7684\u5e93\u53ea\u9700\u5bfc\u5165\u4f60\u5c31\u53ef\u4ee5\u505a\u4f60\u771f\u6b63\u60f3\u505a\u7684\u4e86\u3002 \u8fd8\u662f\u8bf4\u524d\u9762\u7684\u4f8b\u5b50\uff0c\u6211\u4eec\u5efa\u4e00\u4e2a\u51fd\u6570\u6765\u6570\u4e00\u4e2a\u6570\u5b57\u5728\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\u3002\u90a3\u4e48\uff0c\u5df2\u7ecf\u6709\u4e00\u4e2a\u5e93\u5c31\u53ef\u4ee5\u505a\u8fd9\u6837\u7684\u4e8b\u60c5\u3002 from collections import Counter bag = [2, 3, 1, 2, 5, 6, 7, 9, 2, 7] countr = Counter(bag) for i in range(10): print(\"Count of {}: {}\".format(i, countr[i])) \u4e00\u4e9b\u7528\u5e93\u7684\u7406\u7531\uff1a \u4ee3\u7801\u662f\u6b63\u786e\u800c\u4e14\u7ecf\u8fc7\u6d4b\u8bd5\u7684\u3002 \u5b83\u4eec\u7684\u7b97\u6cd5\u53ef\u80fd\u4f1a\u662f\u6700\u4f18\u7684\uff0c\u8fd9\u6837\u5c31\u8dd1\u7684\u66f4\u5feb\u3002 \u62bd\u8c61\u5316\uff1a\u5b83\u4eec\u6307\u5411\u660e\u786e\u800c\u4e14\u6587\u6863\u53cb\u597d\uff0c\u4f60\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u90a3\u4e9b\u8fd8\u6ca1\u6709\u88ab\u5b9e\u73b0\u7684\u3002 \u6700\u540e\uff0c\u5b83\u90fd\u5df2\u7ecf\u5728\u90a3\u513f\u4e86\uff0c\u4f60\u4e0d\u7528\u518d\u9020\u8f6e\u5b50\u4e86\u3002","title":"\u4f7f\u7528\u5e93"},{"location":"python/#_9","text":"\u4f60\u53ef\u4ee5\u6307\u5b9astart\u7684\u70b9\u548cstop\u70b9\uff0c\u5c31\u50cf\u8fd9\u6837list[start:stop:step]\u3002\u6211\u4eec\u53d6\u51fa\u5217\u8868\u4e2d\u7684\u524d5\u4e2a\u5143\u7d20\uff1a bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] for elem in bag[:5]: print(elem) \u8fd9\u5c31\u662f\u5207\u7247\uff0c\u6211\u4eec\u6307\u5b9astop\u70b9\u662f5\uff0c\u518d\u505c\u6b62\u524d\u5c31\u4f1a\u4ece\u5217\u8868\u4e2d\u53d6\u51fa5\u4e2a\u5143\u7d20\u3002 \u8981\u662f\u6700\u540e5\u4e2a\u5143\u7d20\u600e\u4e48\u505a\uff1f bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] for elem in bag[-5:]: print(elem) \u6ca1\u770b\u660e\u767d\u5417\uff1f-5\u610f\u5473\u7740\u4ece\u5217\u8868\u7684\u7ed3\u5c3e\u53d6\u51fa5\u4e2a\u5143\u7d20\u3002 \u5982\u679c\u4f60\u60f3\u5bf9\u5217\u8868\u4e2d\u5143\u7d20\u95f4\u9694\u64cd\u4f5c\uff0c\u4f60\u53ef\u80fd\u4f1a\u8fd9\u6837\u505a\uff1a bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] for index, elem in enumerate(bag): if index % 2 == 0: print(elem) \u4f46\u662f\u4f60\u5e94\u8be5\u8fd9\u6837\u6765\u505a\uff1a bag = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] for elem in bag[::2]: print(elem) # \u6216\u8005\u7528 ranges bag = list(range(0,10,2)) print(bag) \u8fd9\u5c31\u662f\u5217\u8868\u4e2d\u7684\u6b65\u8fdb\u3002list[::2]\u610f\u601d\u662f\u904d\u5386\u5217\u8868\u540c\u65f6\u4e24\u6b65\u53d6\u51fa\u4e00\u4e2a\u5143\u7d20\u3002 \u4f60\u53ef\u4ee5\u7528list[::-1]\u5f88\u9177\u7684\u7ffb\u8f6c\u5217\u8868\u3002","title":"\u5728\u5217\u8868\u4e2d\u5207\u7247/\u6b65\u8fdb"},{"location":"python/#tab","text":"\u957f\u65f6\u95f4\u6765\u770b\uff0c\u5c06tab\u548c\u7a7a\u683c\u6df7\u5728\u4e00\u8d77\u4f1a\u9020\u6210\u707e\u96be\uff0c\u4f60\u4f1a\u770b\u5230IndentationError: unexpected indent\u3002\u4e0d\u7ba1\u4f60\u9009\u62e9tab\u952e\u8fd8\u662f\u7a7a\u683c\u952e\uff0c\u4f60\u5e94\u8be5\u5728\u4f60\u7684\u6587\u4ef6\u548c\u9879\u76ee\u4e2d\u4e00\u76f4\u4fdd\u6301\u4f7f\u7528\u3002 \u4e00\u4e2a\u4f7f\u7528\u7a7a\u683c\u800c\u4e0d\u662ftab\u7684\u539f\u56e0\u662f\uff0ctab\u4e0d\u662f\u5728\u6240\u6709\u7f16\u8f91\u5668\u4e2d\u90fd\u4e00\u6837\u7684\u3002\u89c6\u5462\u6240\u7528\u7684\u7f16\u8f91\u5668\uff0ctab\u53ef\u80fd\u4f1a\u88ab\u5f53\u4f5c2\u52308\u4e2a\u7a7a\u683c\u3002 \u4f60\u4e5f\u53ef\u4ee5\u5728\u5199\u4ee3\u7801\u65f6\u7528\u7a7a\u683c\u6765\u5b9a\u4e49tab\u3002\u8fd9\u6837\u4f60\u53ef\u4ee5\u81ea\u5df1\u9009\u62e9\u7528\u51e0\u4e2a\u7a7a\u683c\u6765\u5f53\u505atab\u3002\u5927\u591a\u6570Python\u7528\u6237\u662f\u75284\u4e2a\u7a7a\u683c\u3002","title":"tab\u952e\u8fd8\u662f\u7a7a\u683c\u952e"},{"location":"python/#for1","text":"\u539f\u6587","title":"for\u6587\u51e6\u7406\u304c1\u884c\u3067\u66f8\u3051\u308b\uff01\u7d20\u6575\u306a\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18"},{"location":"python/#1","text":"\u3055\u3063\u305d\u304f\u30ea\u30b9\u30c8\u5185\u5305\u8a18\u8ff0\uff08list comprehension\uff09\u3092\u6271\u3044\u305f\u3044\u3068\u601d\u3044\u307e\u3059\u3002\u4eca\u56de\u306f\u4ee5\u4e0b\u306e\u914d\u5217\u30c7\u30fc\u30bf\u3092\u6271\u3046\u3053\u3068\u3068\u3057\u307e\u3059\u3002 data = [1, 2, 3, 4, 5] \u3053\u306e\u914d\u5217\u306b\u3064\u3044\u3066\u3001\u5404\u8981\u7d20\u306e\u5024\u30922\u500d\u306b\u3059\u308b\u51e6\u7406\u3092\u901a\u5e38\u306efor\u6587\u3067\u8a18\u8ff0\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002","title":"1\u884c\u3067\u66f8\u304f\u30ea\u30b9\u30c8\u51e6\u7406"},{"location":"python/#data2","text":"newData = [] for d in data: newData.append(d * 2) \u3053\u306e3\u884c\u306e\u5b9f\u88c5\u3092\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3067\u8a18\u8ff0\u3059\u308b\u30681\u884c\u3067\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u7d20\u6575\uff01","title":"data\u914d\u5217\u306e\u4e2d\u8eab\u30922\u500d\u306b\u3059\u308b"},{"location":"python/#data2_1","text":"newData = [d * 2 for d in data] \u3053\u306e\u66f8\u304d\u65b9\u306f\u30b7\u30f3\u30d7\u30eb\u3060\u3057\u76f4\u611f\u7684\u306b\u7406\u89e3\u3067\u304d\u308b\u306e\u3067\u3001\u306a\u304b\u306a\u304b\u4fbf\u5229\u3067\u3059\u3002","title":"data\u914d\u5217\u306e\u4e2d\u8eab\u30922\u500d\u306b\u3059\u308b"},{"location":"python/#1if","text":"\u3055\u3089\u306b\u3001\u51e6\u7406\u306e\u4e2d\u3067\u6761\u4ef6\u5f0f\uff08if\u6587\uff09\u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\u4f8b\u3048\u3070\u5076\u6570\u306e\u307f\u51e6\u7406\u3057\u305f\u3044\u5834\u5408\u306b\u3001\u901a\u5e38\u306e\u66f8\u304d\u65b9\u3067\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3002 newData = [] for d in data: if d % 2 == 0: newData.append(d * 2) \u4e0a\u8a18\u306e\u5834\u5408\u306b\u306f4\u884c\u306e\u5b9f\u88c5\u3067\u3059\u304c\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3060\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b1\u884c\u3067\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 newData = [d * 2 for d in data if d % 2 == 0] \u30aa\u30e9\u30a4\u30ea\u30fc\u306e\u672c\u3084Web\u4e0a\u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u3067\u3082\u826f\u304f\u898b\u308b\u8a18\u8ff0\u306a\u306e\u3067\u3001\u3053\u306e\u8a18\u8ff0\u306f\u8aad\u307f\u66f8\u304d\u3067\u304d\u308b\u5fc5\u8981\u304c\u3042\u308a\u305d\u3046\u3067\u3059\u3002","title":"1\u884c\u3067\u66f8\u304f\u30ea\u30b9\u30c8\u51e6\u7406\uff08if\u6587\u4ed8\u304d\uff09"},{"location":"python/#filter","text":"\u30e9\u30e0\u30c0\u5f0f\u3067\u3082\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3068\u540c\u3058\u3088\u3046\u306b\u30011\u884c\u3067\u51e6\u7406\u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002 newData = [] for d in data: if d % 2 == 0: newData.append(d) \u3053\u308c\u3092\u30e9\u30e0\u30c0\u5f0f\u3067\u66f8\u304f\u3068\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002 newData = filter(lambda x:x%2==0, data) \u3053\u306e\u8a18\u8ff0\u3082\u306a\u304b\u306a\u304b\u826f\u3055\u305d\u3046\u3067\u3059\u306d\uff01\u305f\u3060\u30e9\u30e0\u30c0\u5f0f\u306e\u5834\u5408\u306b\u306f\u3001filter\u3057\u305f\u5f8c\u306b\u6f14\u7b97\u3092\u884c\u3046\uff08\u4f8b\uff1a\u5024\u30922\u500d\u306b\u3059\u308b\uff09\u3053\u3068\u304c\u3067\u304d\u306a\u3044\u306e\u3067\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306e\u65b9\u304c\u3088\u308a\u67d4\u8edf\u306b\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002","title":"\u30e9\u30e0\u30c0\u5f0f\uff0bfilter\u3067\u540c\u3058\u3053\u3068\u3092\u5b9f\u73fe\u3067\u304d\u308b"},{"location":"python/#_10","text":"\u901a\u5e38\u306efor\u6587\u3092\u66f8\u304f\u3088\u308a\u3082\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306e\u65b9\u304c\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u304c\u826f\u3044\u3067\u3059\u3002\u3044\u304f\u3064\u304b\u8abf\u3079\u305f\u60c5\u5831\u306b\u3088\u308b\u3068\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3067for\u51e6\u7406\u3059\u308c\u3070\u3001\u8a18\u8ff0\u3057\u305f\u6587\u6cd5\u3092C\u8a00\u8a9e\u30ec\u30d9\u30eb\u3067\u51e6\u7406\u3059\u308b\u305f\u3081\u901f\u3044\u3068\u306e\u3053\u3068\u3002\u5b9f\u969b\u306b\u8a66\u3057\u3066\u307f\u307e\u3057\u305f\u3002 import time # \u5229\u7528\u3059\u308b\u30c7\u30fc\u30bf data = [i for i in range(1, 1000000)] # \u901a\u5e38\u306efor\u6587 time1 = time.clock() newData = [] for d in data: if d % 2 == 0: newData.append(d) time2 = time.clock() print time2 - time1 #0.234422\u79d2 # \u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18 time1 = time.clock() newData = [d for d in data if d % 2 == 0] time2 = time.clock() print time2 - time1 #0.185301\u79d2 # filter\u3068\u30e9\u30e0\u30c0\u5f0f time1 = time.clock() newData = filter(lambda x:x%2==0, data) time2 = time.clock() print time2 - time1 #0.184838 \u4f55\u5ea6\u304b\u8a66\u3057\u305f\u3068\u3053\u308d\u3001\u4e0a\u8a18\u4f8b\u306e\u5834\u5408\u306b\u306f\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306f\u901a\u5e38\u306efor\u6587\u8a18\u8ff0\u3088\u308a\u308222\uff05\u9ad8\u901f\u3067\u3057\u305f\uff08\u50d5\u306eMacBookAir\u306e\u5834\u5408\uff09\u3002","title":"\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u306f\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3082\u826f\u3044"},{"location":"sar/","text":"sar \u2014\u2014 Linux \u4e0a\u6700\u4e3a\u5168\u9762\u7684\u7cfb\u7edf\u6027\u80fd\u5206\u6790\u5de5\u5177\u4e4b\u4e00 \u00b6 sar \uff08System Activity Reporter \u7cfb\u7edf\u6d3b\u52a8\u60c5\u51b5\u62a5\u544a\uff09\u662f\u76ee\u524d Linux \u4e0a\u6700\u4e3a\u5168\u9762\u7684\u7cfb\u7edf\u6027\u80fd\u5206\u6790\u5de5\u5177\u4e4b\u4e00\uff0c\u53ef\u4ee5\u4ece\u591a\u65b9\u9762\u5bf9\u7cfb\u7edf\u7684\u6d3b\u52a8\u8fdb\u884c\u62a5\u544a\uff0c\u5305\u62ec\uff1a\u6587\u4ef6\u7684\u8bfb\u5199\u60c5\u51b5\u3001\u7cfb\u7edf\u8c03\u7528\u7684\u4f7f\u7528\u60c5\u51b5\u3001\u78c1\u76d8 I/O\u3001CPU \u6548\u7387\u3001\u5185\u5b58\u4f7f\u7528\u72b6\u51b5\u3001\u8fdb\u7a0b\u6d3b\u52a8\u53ca IPC \u6709\u5173\u7684\u6d3b\u52a8\u7b49\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 sar \u547d\u4ee4\u6765\u83b7\u5f97\u6574\u4e2a\u7cfb\u7edf\u6027\u80fd\u7684\u62a5\u544a\u3002\u8fd9\u6709\u52a9\u4e8e\u6211\u4eec\u5b9a\u4f4d\u7cfb\u7edf\u6027\u80fd\u7684\u74f6\u9888\uff0c\u5e76\u4e14\u6709\u52a9\u4e8e\u6211\u4eec\u627e\u51fa\u8fd9\u4e9b\u70e6\u4eba\u7684\u6027\u80fd\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5\u3002 Linux \u5185\u6838\u7ef4\u62a4\u7740\u4e00\u4e9b\u5185\u90e8\u8ba1\u6570\u5668\uff0c\u8fd9\u4e9b\u8ba1\u6570\u5668\u5305\u542b\u4e86\u6240\u6709\u7684\u8bf7\u6c42\u53ca\u5176\u5b8c\u6210\u65f6\u95f4\u548c I/O \u5757\u6570\u7b49\u4fe1\u606f\uff0c sar \u547d\u4ee4\u4ece\u6240\u6709\u7684\u8fd9\u4e9b\u4fe1\u606f\u4e2d\u8ba1\u7b97\u51fa\u8bf7\u6c42\u7684\u5229\u7528\u7387\u548c\u6bd4\u4f8b\uff0c\u4ee5\u4fbf\u627e\u51fa\u74f6\u9888\u6240\u5728\u3002 sar \u547d\u4ee4\u4e3b\u8981\u7684\u7528\u9014\u662f\u751f\u6210\u67d0\u6bb5\u65f6\u95f4\u5185\u6240\u6709\u6d3b\u52a8\u7684\u62a5\u544a\uff0c\u56e0\u6b64\u5fc5\u9700\u786e\u4fdd sar \u547d\u4ee4\u5728\u9002\u5f53\u7684\u65f6\u95f4\u8fdb\u884c\u6570\u636e\u91c7\u96c6\uff08\u800c\u4e0d\u662f\u5728\u5348\u9910\u65f6\u95f4\u6216\u8005\u5468\u672b\uff09 \u539f\u6587\u5730\u5740: https://shockerli.net/post/li... \u547d\u4ee4\u53c2\u6570 \u00b6 \u7528\u6cd5: sar [ \u9009\u9879 ] [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u4e3b\u9009\u9879\u548c\u62a5\u544a\uff1a -b I/O \u548c\u4f20\u8f93\u901f\u7387\u4fe1\u606f\u72b6\u51b5 -B \u5206\u9875\u72b6\u51b5 -d \u5757\u8bbe\u5907\u72b6\u51b5 -I { <\u4e2d\u65ad> | SUM | ALL | XALL } \u4e2d\u65ad\u4fe1\u606f\u72b6\u51b5 -m \u7535\u6e90\u7ba1\u7406\u4fe1\u606f\u72b6\u51b5 -n { <\u5173\u952e\u8bcd> [,...] | ALL } \u7f51\u7edc\u7edf\u8ba1\u4fe1\u606f \u5173\u952e\u8bcd\u53ef\u4ee5\u662f\uff1a DEV \u7f51\u5361 EDEV \u7f51\u5361 (\u9519\u8bef) NFS NFS \u5ba2\u6237\u7aef NFSD NFS \u670d\u52a1\u5668 SOCK Sockets (\u5957\u63a5\u5b57) (v4) IP IP \u6d41 (v4) EIP IP \u6d41 (v4) (\u9519\u8bef) ICMP ICMP \u6d41 (v4) EICMP ICMP \u6d41 (v4) (\u9519\u8bef) TCP TCP \u6d41 (v4) ETCP TCP \u6d41 (v4) (\u9519\u8bef) UDP UDP \u6d41 (v4) SOCK6 Sockets (\u5957\u63a5\u5b57) (v6) IP6 IP \u6d41 (v6) EIP6 IP \u6d41 (v6) (\u9519\u8bef) ICMP6 ICMP \u6d41 (v6) EICMP6 ICMP \u6d41 (v6) (\u9519\u8bef) UDP6 UDP \u6d41 (v6) -q \u961f\u5217\u957f\u5ea6\u548c\u5e73\u5747\u8d1f\u8f7d -r \u5185\u5b58\u5229\u7528\u7387 -R \u5185\u5b58\u72b6\u51b5 -S \u4ea4\u6362\u7a7a\u95f4\u5229\u7528\u7387 -u [ ALL ] CPU \u5229\u7528\u7387 -v Kernel table \u72b6\u51b5 -w \u4efb\u52a1\u521b\u5efa\u4e0e\u7cfb\u7edf\u8f6c\u6362\u7edf\u8ba1\u4fe1\u606f -W \u4ea4\u6362\u4fe1\u606f -y TTY \u8bbe\u5907\u72b6\u51b5 -o {<\u6587\u4ef6\u8def\u5f84>} \u5c06\u547d\u4ee4\u7ed3\u679c\u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u5b58\u653e\u5728\u6307\u5b9a\u6587\u4ef6\u4e2d \u5e38\u7528\u547d\u4ee4 \u00b6 sar \u547d\u4ee4\u6765\u81ea\u4e8e sysstat \u5de5\u5177\u5305\uff0c\u5982\u679c\u63d0\u793a sar \u547d\u4ee4\u4e0d\u5b58\u5728\uff0c\u9700\u5148\u5b89\u88c5 sysstat \u3002 \u7f51\u7edc\u7edf\u8ba1\u4fe1\u606f \u00b6 sar -n <\u5173\u952e\u8bcd> [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -n DEV 1 5 \u5e73\u5747\u65f6\u95f4: IFACE rxpck/s txpck/s rxkB/s txkB/s rxcmp/s txcmp/s rxmcst/s \u5e73\u5747\u65f6\u95f4: lo 2.21 2.21 0.18 0.18 0.00 0.00 0.00 \u5e73\u5747\u65f6\u95f4: eth0 4.62 3.82 0.37 1.90 0.00 0.00 0.00 \u547d\u4ee4\u4e2d 1 5 \u8868\u793a\u6bcf\u4e00\u79d2\u949f\u53d6 1 \u6b21\u503c\uff0c\u4e00\u5171\u53d6 5 \u6b21\u3002 \u547d\u4ee4\u6267\u884c\u540e\u4f1a\u5217\u51fa\u6bcf\u4e2a\u7f51\u5361\u8fd9 5 \u6b21\u53d6\u503c\u7684\u5e73\u5747\u6570\u636e\uff0c\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u6765\u786e\u5b9a\u5e26\u5bbd\u8dd1\u6ee1\u7684\u7f51\u5361\u540d\u79f0\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b eth0 \u4e3a\u5185\u7f51\u7f51\u5361\uff0ceth1 \u4e3a\u5916\u7f51\u7f51\u5361\u3002 CPU \u5229\u7528\u7387 \u00b6 sar -u [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -u 1 3 Linux 2.6.32-642.13.1.el6.x86_64 (upfor106) 2018\u5e7404\u670825\u65e5 _x86_64_ (1 CPU) 10\u65f633\u520608\u79d2 CPU %user %nice %system %iowait %steal %idle 10\u65f633\u520609\u79d2 all 0.00 0.00 0.00 0.00 0.00 100.00 10\u65f633\u520610\u79d2 all 0.99 0.00 0.99 0.00 0.00 98.02 10\u65f633\u520611\u79d2 all 0.00 0.00 0.00 0.00 0.00 100.00 \u5e73\u5747\u65f6\u95f4: all 0.33 0.00 0.33 0.00 0.00 99.33 \u547d\u4ee4\u4e2d 1 3 \u8868\u793a\u6bcf\u4e00\u79d2\u949f\u53d6 1 \u6b21\u503c\uff0c\u4e00\u5171\u53d6 3 \u6b21\u3002 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a CPU\uff1aall \u8868\u793a\u7edf\u8ba1\u4fe1\u606f\u4e3a\u6240\u6709 CPU \u7684\u5e73\u5747\u503c\u3002 %user\uff1a\u663e\u793a\u5728\u7528\u6237\u7ea7\u522b(application)\u8fd0\u884c\u4f7f\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4 %nice\uff1a\u663e\u793a\u5728\u7528\u6237\u7ea7\u522b\uff0c\u7528\u4e8enice\u64cd\u4f5c\uff0c\u6240\u5360\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4 %system\uff1a\u5728\u6838\u5fc3\u7ea7\u522b(kernel)\u8fd0\u884c\u6240\u4f7f\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4 %iowait\uff1a\u663e\u793a\u7528\u4e8e\u7b49\u5f85I/O\u64cd\u4f5c\u5360\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4 %steal\uff1a\u7ba1\u7406\u7a0b\u5e8f(hypervisor)\u4e3a\u53e6\u4e00\u4e2a\u865a\u62df\u8fdb\u7a0b\u63d0\u4f9b\u670d\u52a1\u800c\u7b49\u5f85\u865a\u62df CPU \u7684\u767e\u5206\u6bd4 %idle\uff1a\u663e\u793a CPU \u7a7a\u95f2\u65f6\u95f4\u5360\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4 1. \u82e5 %iowait \u7684\u503c\u8fc7\u9ad8\uff0c\u8868\u793a\u786c\u76d8\u5b58\u5728I/O\u74f6\u9888 2. \u82e5 %idle \u7684\u503c\u9ad8\u4f46\u7cfb\u7edf\u54cd\u5e94\u6162\u65f6\uff0c\u6709\u53ef\u80fd\u662f CPU \u7b49\u5f85\u5206\u914d\u5185\u5b58\uff0c\u6b64\u65f6\u5e94\u52a0\u5927\u5185\u5b58\u5bb9\u91cf 3. \u82e5 %idle \u7684\u503c\u6301\u7eed\u4f4e\u4e8e1\uff0c\u5219\u7cfb\u7edf\u7684 CPU \u5904\u7406\u80fd\u529b\u76f8\u5bf9\u8f83\u4f4e\uff0c\u8868\u660e\u7cfb\u7edf\u4e2d\u6700\u9700\u8981\u89e3\u51b3\u7684\u8d44\u6e90\u662f CPU \u7d22\u5f15\u8282\u70b9\uff0c\u6587\u4ef6\u548c\u5176\u4ed6\u5185\u6838\u8868\u7684\u72b6\u6001 \u00b6 sar -v [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -v 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 10\u65f650\u520629\u79d2 dentunusd file-nr inode-nr pty-nr 10\u65f650\u520630\u79d2 920045 864 13910 2 10\u65f650\u520631\u79d2 920045 864 13910 2 10\u65f650\u520632\u79d2 920045 896 13910 2 \u5e73\u5747\u65f6\u95f4: 920045 875 13910 2 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a dentunusd\uff1a\u76ee\u5f55\u9ad8\u901f\u7f13\u5b58\u4e2d\u672a\u88ab\u4f7f\u7528\u7684\u6761\u76ee\u6570\u91cf file-nr\uff1a\u6587\u4ef6\u53e5\u67c4\uff08file handle\uff09\u7684\u4f7f\u7528\u6570\u91cf inode-nr\uff1a\u7d22\u5f15\u8282\u70b9\u53e5\u67c4\uff08inode handle\uff09\u7684\u4f7f\u7528\u6570\u91cf pty-nr\uff1a\u4f7f\u7528\u7684 pty \u6570\u91cf \u5185\u5b58\u5229\u7528\u7387 \u00b6 sar -r [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -r 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 10\u65f653\u520600\u79d2 kbmemfree kbmemused %memused kbbuffers kbcached kbcommit %commit 10\u65f653\u520601\u79d2 2027760 2028732 50.01 145492 1243820 1163900 28.69 10\u65f653\u520602\u79d2 2027620 2028872 50.02 145492 1243820 1163896 28.69 10\u65f653\u520603\u79d2 2028100 2028392 50.00 145492 1243820 1163900 28.69 \u5e73\u5747\u65f6\u95f4: 2027827 2028665 50.01 145492 1243820 1163899 28.69 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a kbmemfree\uff1a\u8fd9\u4e2a\u503c\u548c free \u547d\u4ee4\u4e2d\u7684 free \u503c\u57fa\u672c\u4e00\u81f4\uff0c\u6240\u4ee5\u5b83\u4e0d\u5305\u62ec buffer \u548c cache \u7684\u7a7a\u95f4 kbmemused\uff1a\u8fd9\u4e2a\u503c\u548c free \u547d\u4ee4\u4e2d\u7684 used \u503c\u57fa\u672c\u4e00\u81f4,\u6240\u4ee5\u5b83\u5305\u62ec buffer \u548c cache \u7684\u7a7a\u95f4 %memused\uff1a\u8fd9\u4e2a\u503c\u662f kbmemused \u548c\u5185\u5b58\u603b\u91cf(\u4e0d\u5305\u62ec swap)\u7684\u4e00\u4e2a\u767e\u5206\u6bd4 kbbuffers \u548c kbcached\uff1a\u8fd9\u4e24\u4e2a\u503c\u5c31\u662f free \u547d\u4ee4\u4e2d\u7684 buffer \u548c cache kbcommit\uff1a\u4fdd\u8bc1\u5f53\u524d\u7cfb\u7edf\u6240\u9700\u8981\u7684\u5185\u5b58\uff0c\u5373\u4e3a\u4e86\u786e\u4fdd\u4e0d\u6ea2\u51fa\u800c\u9700\u8981\u7684\u5185\u5b58(RAM + swap) %commit\uff1a\u8fd9\u4e2a\u503c\u662f kbcommit \u4e0e\u5185\u5b58\u603b\u91cf(\u5305\u62ec swap)\u7684\u4e00\u4e2a\u767e\u5206\u6bd4 \u5185\u5b58\u5206\u9875\u72b6\u51b5 \u00b6 sar -B [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -B 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 10\u65f655\u520641\u79d2 pgpgin/s pgpgout/s fault/s majflt/s pgfree/s pgscank/s pgscand/s pgsteal/s %vmeff 10\u65f655\u520642\u79d2 0.00 0.00 5723.76 0.00 3356.44 0.00 0.00 0.00 0.00 10\u65f655\u520643\u79d2 0.00 0.00 1185.00 0.00 312.00 0.00 0.00 0.00 0.00 10\u65f655\u520644\u79d2 0.00 0.00 27.00 0.00 56.00 0.00 0.00 0.00 0.00 \u5e73\u5747\u65f6\u95f4: 0.00 0.00 2323.26 0.00 1248.50 0.00 0.00 0.00 0.00 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a pgpgin/s\uff1a\u8868\u793a\u6bcf\u79d2\u4ece\u78c1\u76d8\u6216SWAP\u7f6e\u6362\u5230\u5185\u5b58\u7684\u5b57\u8282\u6570(KB) pgpgout/s\uff1a\u8868\u793a\u6bcf\u79d2\u4ece\u5185\u5b58\u7f6e\u6362\u5230\u78c1\u76d8\u6216SWAP\u7684\u5b57\u8282\u6570(KB) fault/s\uff1a\u6bcf\u79d2\u949f\u7cfb\u7edf\u4ea7\u751f\u7684\u7f3a\u9875\u6570\uff0c\u5373\u4e3b\u7f3a\u9875\u4e0e\u6b21\u7f3a\u9875\u4e4b\u548c(major + minor) majflt/s\uff1a\u6bcf\u79d2\u949f\u4ea7\u751f\u7684\u4e3b\u7f3a\u9875\u6570 pgfree/s\uff1a\u6bcf\u79d2\u88ab\u653e\u5165\u7a7a\u95f2\u961f\u5217\u4e2d\u7684\u9875\u4e2a\u6570 pgscank/s\uff1a\u6bcf\u79d2\u88ab kswapd \u626b\u63cf\u7684\u9875\u4e2a\u6570 pgscand/s\uff1a\u6bcf\u79d2\u76f4\u63a5\u88ab\u626b\u63cf\u7684\u9875\u4e2a\u6570 pgsteal/s\uff1a\u6bcf\u79d2\u949f\u4ece cache \u4e2d\u88ab\u6e05\u9664\u6765\u6ee1\u8db3\u5185\u5b58\u9700\u8981\u7684\u9875\u4e2a\u6570 %vmeff\uff1a\u6bcf\u79d2\u6e05\u9664\u7684\u9875(pgsteal)\u5360\u603b\u626b\u63cf\u9875(pgscank + pgscand)\u7684\u767e\u5206\u6bd4 I/O \u548c\u4f20\u8f93\u901f\u7387\u4fe1\u606f\u72b6\u51b5 \u00b6 sar -b [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -b 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 10\u65f658\u520615\u79d2 tps rtps wtps bread/s bwrtn/s 10\u65f658\u520616\u79d2 7.00 0.00 7.00 0.00 64.00 10\u65f658\u520617\u79d2 4.04 0.00 4.04 0.00 80.81 10\u65f658\u520618\u79d2 0.00 0.00 0.00 0.00 0.00 \u5e73\u5747\u65f6\u95f4: 3.67 0.00 3.67 0.00 48.00 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a tps\uff1a\u6bcf\u79d2\u949f\u7269\u7406\u8bbe\u5907\u7684 I/O \u4f20\u8f93\u603b\u91cf rtps\uff1a\u6bcf\u79d2\u949f\u4ece\u7269\u7406\u8bbe\u5907\u8bfb\u5165\u7684\u6570\u636e\u603b\u91cf wtps\uff1a\u6bcf\u79d2\u949f\u5411\u7269\u7406\u8bbe\u5907\u5199\u5165\u7684\u6570\u636e\u603b\u91cf bread/s\uff1a\u6bcf\u79d2\u949f\u4ece\u7269\u7406\u8bbe\u5907\u8bfb\u5165\u7684\u6570\u636e\u91cf\uff0c\u5355\u4f4d\u4e3a\uff1a\u5757/s bwrtn/s\uff1a\u6bcf\u79d2\u949f\u5411\u7269\u7406\u8bbe\u5907\u5199\u5165\u7684\u6570\u636e\u91cf\uff0c\u5355\u4f4d\u4e3a\uff1a\u5757/s \u961f\u5217\u957f\u5ea6\u548c\u5e73\u5747\u8d1f\u8f7d \u00b6 sar -q [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -q 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 11\u65f600\u520635\u79d2 runq-sz plist-sz ldavg-1 ldavg-5 ldavg-15 11\u65f600\u520636\u79d2 0 268 0.00 0.00 0.00 11\u65f600\u520637\u79d2 0 268 0.00 0.00 0.00 11\u65f600\u520638\u79d2 0 268 0.00 0.00 0.00 \u5e73\u5747\u65f6\u95f4: 0 268 0.00 0.00 0.00 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a runq-sz\uff1a\u8fd0\u884c\u961f\u5217\u7684\u957f\u5ea6\uff08\u7b49\u5f85\u8fd0\u884c\u7684\u8fdb\u7a0b\u6570\uff09 plist-sz\uff1a\u8fdb\u7a0b\u5217\u8868\u4e2d\u8fdb\u7a0b\uff08processes\uff09\u548c\u7ebf\u7a0b\uff08threads\uff09\u7684\u6570\u91cf ldavg-1\uff1a\u6700\u540e1\u5206\u949f\u7684\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d\uff08System load average\uff09 ldavg-5\uff1a\u8fc7\u53bb5\u5206\u949f\u7684\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d ldavg-15\uff1a\u8fc7\u53bb15\u5206\u949f\u7684\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d \u7cfb\u7edf\u4ea4\u6362\u4fe1\u606f \u00b6 sar -W [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -W 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 11\u65f601\u520645\u79d2 pswpin/s pswpout/s 11\u65f601\u520646\u79d2 0.00 0.00 11\u65f601\u520647\u79d2 0.00 0.00 11\u65f601\u520648\u79d2 0.00 0.00 \u5e73\u5747\u65f6\u95f4: 0.00 0.00 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a pswpin/s\uff1a\u6bcf\u79d2\u7cfb\u7edf\u6362\u5165\u7684\u4ea4\u6362\u9875\u9762\uff08swap page\uff09\u6570\u91cf pswpout/s\uff1a\u6bcf\u79d2\u7cfb\u7edf\u6362\u51fa\u7684\u4ea4\u6362\u9875\u9762\uff08swap page\uff09\u6570\u91cf \u5757\u8bbe\u5907\u72b6\u51b5 \u00b6 sar -d [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -d 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 11\u65f602\u520646\u79d2 DEV tps rd_sec/s wr_sec/s avgrq-sz avgqu-sz await svctm %util 11\u65f602\u520647\u79d2 dev252-0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 11\u65f602\u520647\u79d2 DEV tps rd_sec/s wr_sec/s avgrq-sz avgqu-sz await svctm %util 11\u65f602\u520648\u79d2 dev252-0 6.06 0.00 64.65 10.67 0.00 0.00 0.00 0.00 11\u65f602\u520648\u79d2 DEV tps rd_sec/s wr_sec/s avgrq-sz avgqu-sz await svctm %util 11\u65f602\u520649\u79d2 dev252-0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 \u5e73\u5747\u65f6\u95f4: DEV tps rd_sec/s wr_sec/s avgrq-sz avgqu-sz await svctm %util \u5e73\u5747\u65f6\u95f4: dev252-0 2.00 0.00 21.33 10.67 0.00 0.00 0.00 0.00 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a tps: \u6bcf\u79d2\u4ece\u7269\u7406\u78c1\u76d8 I/O \u7684\u6b21\u6570\u3002\u591a\u4e2a\u903b\u8f91\u8bf7\u6c42\u4f1a\u88ab\u5408\u5e76\u4e3a\u4e00\u4e2a I/O \u78c1\u76d8\u8bf7\u6c42\uff0c\u4e00\u6b21\u4f20\u8f93\u7684\u5927\u5c0f\u662f\u4e0d\u786e\u5b9a\u7684 rd_sec/s: \u6bcf\u79d2\u8bfb\u6247\u533a\u7684\u6b21\u6570 wr_sec/s: \u6bcf\u79d2\u5199\u6247\u533a\u7684\u6b21\u6570 avgrq-sz: \u5e73\u5747\u6bcf\u6b21\u8bbe\u5907 I/O \u64cd\u4f5c\u7684\u6570\u636e\u5927\u5c0f(\u6247\u533a) avgqu-sz: \u78c1\u76d8\u8bf7\u6c42\u961f\u5217\u7684\u5e73\u5747\u957f\u5ea6 await: \u4ece\u8bf7\u6c42\u78c1\u76d8\u64cd\u4f5c\u5230\u7cfb\u7edf\u5b8c\u6210\u5904\u7406\uff0c\u6bcf\u6b21\u8bf7\u6c42\u7684\u5e73\u5747\u6d88\u8017\u65f6\u95f4\uff0c\u5305\u62ec\u8bf7\u6c42\u961f\u5217\u7b49\u5f85\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u6beb\u79d2(1\u79d2=1000\u6beb\u79d2) svctm: \u7cfb\u7edf\u5904\u7406\u6bcf\u6b21\u8bf7\u6c42\u7684\u5e73\u5747\u65f6\u95f4,\u4e0d\u5305\u62ec\u5728\u8bf7\u6c42\u961f\u5217\u4e2d\u6d88\u8017\u7684\u65f6\u95f4. %util: I/O\u8bf7\u6c42\u5360CPU\u7684\u767e\u5206\u6bd4\uff0c\u6bd4\u7387\u8d8a\u5927\uff0c\u8bf4\u660e\u8d8a\u9971\u548c 1. avgqu-sz \u7684\u503c\u8f83\u4f4e\u65f6\uff0c\u8bbe\u5907\u7684\u5229\u7528\u7387\u8f83\u9ad8 2. \u5f53%util\u7684\u503c\u63a5\u8fd1 1% \u65f6\uff0c\u8868\u793a\u8bbe\u5907\u5e26\u5bbd\u5df2\u7ecf\u5360\u6ee1 \u8f93\u51fa\u7edf\u8ba1\u7684\u6570\u636e\u4fe1\u606f \u00b6 sar -o path_file [\u9009\u9879] [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -o sarfile.log -u 1 3 \u4e0a\u8ff0\u793a\u4f8b\u547d\u4ee4\u4f1a\u5c06 sar -u 1 3 \u91c7\u96c6\u5230\u7684\u6570\u636e\u4ee5\u4e8c\u8fdb\u5236\u7684\u683c\u5f0f\u5b58\u653e\u5230\u6587\u4ef6 sarfile.log \u4e2d\u3002 \u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4 sadf -d sarfile.log \u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u6587\u4ef6\u8f6c\u6362\u6210\u6570\u636e\u5e93\u53ef\u8bfb\u7684\u683c\u5f0f\u3002 sadf -d sarfile.log # hostname;interval;timestamp;CPU;%user;%nice;%system;%iowait;%steal;%idle upfor163;1;2018-04-25 03:15:02 UTC;-1;0.00;0.00;0.50;0.50;0.00;99.00 upfor163;1;2018-04-25 03:15:03 UTC;-1;1.01;0.00;0.00;0.00;0.00;98.99 upfor163;1;2018-04-25 03:15:04 UTC;-1;0.00;0.00;0.00;0.00;0.00;100.00 \u4e5f\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u6570\u636e\u5b58\u50a8\u5728\u4e00\u4e2a csv \u6587\u6863\u4e2d\uff0c\u7136\u540e\u7ed8\u5236\u6210\u56fe\u8868\u5c55\u793a\u65b9\u5f0f\uff0c\u5982\u4e0b\u6240\u793a\uff1a sadf -d sarfile.log | sed 's/;/,/g' > sarfile.csv \u4ece\u6570\u636e\u6587\u4ef6\u8bfb\u53d6\u4fe1\u606f \u00b6 sar -f <\u6587\u4ef6\u8def\u5f84> \u793a\u4f8b\uff1a sar -f sarfile.log Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 11\u65f615\u520601\u79d2 CPU %user %nice %system %iowait %steal %idle 11\u65f615\u520602\u79d2 all 0.00 0.00 0.50 0.50 0.00 99.00 11\u65f615\u520603\u79d2 all 1.01 0.00 0.00 0.00 0.00 98.99 11\u65f615\u520604\u79d2 all 0.00 0.00 0.00 0.00 0.00 100.00 \u5e73\u5747\u65f6\u95f4: all 0.33 0.00 0.17 0.17 0.00 99.33 \u53c8\u5c06\u4e4b\u524d\u5b58\u50a8\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u7ed9\u8bfb\u53d6\u5e76\u5c55\u793a\u51fa\u6765\u3002 \u6027\u80fd\u95ee\u9898\u6392\u67e5\u6280\u5de7 \u00b6 \u6000\u7591 CPU \u5b58\u5728\u74f6\u9888\uff0c\u53ef\u7528 sar -u \u548c sar -q \u7b49\u6765\u67e5\u770b \u6000\u7591\u5185\u5b58\u5b58\u5728\u74f6\u9888\uff0c\u53ef\u7528 sar -B \u3001 sar -r \u548c sar -W \u7b49\u6765\u67e5\u770b \u6000\u7591 I/O \u5b58\u5728\u74f6\u9888\uff0c\u53ef\u7528 sar -b \u3001 sar -u \u548c sar -d \u7b49\u6765\u67e5\u770b \u539f\u6587\u5730\u5740: https://shockerli.net/post/li...","title":"sar"},{"location":"sar/#sar-linux","text":"sar \uff08System Activity Reporter \u7cfb\u7edf\u6d3b\u52a8\u60c5\u51b5\u62a5\u544a\uff09\u662f\u76ee\u524d Linux \u4e0a\u6700\u4e3a\u5168\u9762\u7684\u7cfb\u7edf\u6027\u80fd\u5206\u6790\u5de5\u5177\u4e4b\u4e00\uff0c\u53ef\u4ee5\u4ece\u591a\u65b9\u9762\u5bf9\u7cfb\u7edf\u7684\u6d3b\u52a8\u8fdb\u884c\u62a5\u544a\uff0c\u5305\u62ec\uff1a\u6587\u4ef6\u7684\u8bfb\u5199\u60c5\u51b5\u3001\u7cfb\u7edf\u8c03\u7528\u7684\u4f7f\u7528\u60c5\u51b5\u3001\u78c1\u76d8 I/O\u3001CPU \u6548\u7387\u3001\u5185\u5b58\u4f7f\u7528\u72b6\u51b5\u3001\u8fdb\u7a0b\u6d3b\u52a8\u53ca IPC \u6709\u5173\u7684\u6d3b\u52a8\u7b49\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 sar \u547d\u4ee4\u6765\u83b7\u5f97\u6574\u4e2a\u7cfb\u7edf\u6027\u80fd\u7684\u62a5\u544a\u3002\u8fd9\u6709\u52a9\u4e8e\u6211\u4eec\u5b9a\u4f4d\u7cfb\u7edf\u6027\u80fd\u7684\u74f6\u9888\uff0c\u5e76\u4e14\u6709\u52a9\u4e8e\u6211\u4eec\u627e\u51fa\u8fd9\u4e9b\u70e6\u4eba\u7684\u6027\u80fd\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5\u3002 Linux \u5185\u6838\u7ef4\u62a4\u7740\u4e00\u4e9b\u5185\u90e8\u8ba1\u6570\u5668\uff0c\u8fd9\u4e9b\u8ba1\u6570\u5668\u5305\u542b\u4e86\u6240\u6709\u7684\u8bf7\u6c42\u53ca\u5176\u5b8c\u6210\u65f6\u95f4\u548c I/O \u5757\u6570\u7b49\u4fe1\u606f\uff0c sar \u547d\u4ee4\u4ece\u6240\u6709\u7684\u8fd9\u4e9b\u4fe1\u606f\u4e2d\u8ba1\u7b97\u51fa\u8bf7\u6c42\u7684\u5229\u7528\u7387\u548c\u6bd4\u4f8b\uff0c\u4ee5\u4fbf\u627e\u51fa\u74f6\u9888\u6240\u5728\u3002 sar \u547d\u4ee4\u4e3b\u8981\u7684\u7528\u9014\u662f\u751f\u6210\u67d0\u6bb5\u65f6\u95f4\u5185\u6240\u6709\u6d3b\u52a8\u7684\u62a5\u544a\uff0c\u56e0\u6b64\u5fc5\u9700\u786e\u4fdd sar \u547d\u4ee4\u5728\u9002\u5f53\u7684\u65f6\u95f4\u8fdb\u884c\u6570\u636e\u91c7\u96c6\uff08\u800c\u4e0d\u662f\u5728\u5348\u9910\u65f6\u95f4\u6216\u8005\u5468\u672b\uff09 \u539f\u6587\u5730\u5740: https://shockerli.net/post/li...","title":"sar \u2014\u2014 Linux \u4e0a\u6700\u4e3a\u5168\u9762\u7684\u7cfb\u7edf\u6027\u80fd\u5206\u6790\u5de5\u5177\u4e4b\u4e00"},{"location":"sar/#_1","text":"\u7528\u6cd5: sar [ \u9009\u9879 ] [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u4e3b\u9009\u9879\u548c\u62a5\u544a\uff1a -b I/O \u548c\u4f20\u8f93\u901f\u7387\u4fe1\u606f\u72b6\u51b5 -B \u5206\u9875\u72b6\u51b5 -d \u5757\u8bbe\u5907\u72b6\u51b5 -I { <\u4e2d\u65ad> | SUM | ALL | XALL } \u4e2d\u65ad\u4fe1\u606f\u72b6\u51b5 -m \u7535\u6e90\u7ba1\u7406\u4fe1\u606f\u72b6\u51b5 -n { <\u5173\u952e\u8bcd> [,...] | ALL } \u7f51\u7edc\u7edf\u8ba1\u4fe1\u606f \u5173\u952e\u8bcd\u53ef\u4ee5\u662f\uff1a DEV \u7f51\u5361 EDEV \u7f51\u5361 (\u9519\u8bef) NFS NFS \u5ba2\u6237\u7aef NFSD NFS \u670d\u52a1\u5668 SOCK Sockets (\u5957\u63a5\u5b57) (v4) IP IP \u6d41 (v4) EIP IP \u6d41 (v4) (\u9519\u8bef) ICMP ICMP \u6d41 (v4) EICMP ICMP \u6d41 (v4) (\u9519\u8bef) TCP TCP \u6d41 (v4) ETCP TCP \u6d41 (v4) (\u9519\u8bef) UDP UDP \u6d41 (v4) SOCK6 Sockets (\u5957\u63a5\u5b57) (v6) IP6 IP \u6d41 (v6) EIP6 IP \u6d41 (v6) (\u9519\u8bef) ICMP6 ICMP \u6d41 (v6) EICMP6 ICMP \u6d41 (v6) (\u9519\u8bef) UDP6 UDP \u6d41 (v6) -q \u961f\u5217\u957f\u5ea6\u548c\u5e73\u5747\u8d1f\u8f7d -r \u5185\u5b58\u5229\u7528\u7387 -R \u5185\u5b58\u72b6\u51b5 -S \u4ea4\u6362\u7a7a\u95f4\u5229\u7528\u7387 -u [ ALL ] CPU \u5229\u7528\u7387 -v Kernel table \u72b6\u51b5 -w \u4efb\u52a1\u521b\u5efa\u4e0e\u7cfb\u7edf\u8f6c\u6362\u7edf\u8ba1\u4fe1\u606f -W \u4ea4\u6362\u4fe1\u606f -y TTY \u8bbe\u5907\u72b6\u51b5 -o {<\u6587\u4ef6\u8def\u5f84>} \u5c06\u547d\u4ee4\u7ed3\u679c\u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u5b58\u653e\u5728\u6307\u5b9a\u6587\u4ef6\u4e2d","title":"\u547d\u4ee4\u53c2\u6570"},{"location":"sar/#_2","text":"sar \u547d\u4ee4\u6765\u81ea\u4e8e sysstat \u5de5\u5177\u5305\uff0c\u5982\u679c\u63d0\u793a sar \u547d\u4ee4\u4e0d\u5b58\u5728\uff0c\u9700\u5148\u5b89\u88c5 sysstat \u3002","title":"\u5e38\u7528\u547d\u4ee4"},{"location":"sar/#_3","text":"sar -n <\u5173\u952e\u8bcd> [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -n DEV 1 5 \u5e73\u5747\u65f6\u95f4: IFACE rxpck/s txpck/s rxkB/s txkB/s rxcmp/s txcmp/s rxmcst/s \u5e73\u5747\u65f6\u95f4: lo 2.21 2.21 0.18 0.18 0.00 0.00 0.00 \u5e73\u5747\u65f6\u95f4: eth0 4.62 3.82 0.37 1.90 0.00 0.00 0.00 \u547d\u4ee4\u4e2d 1 5 \u8868\u793a\u6bcf\u4e00\u79d2\u949f\u53d6 1 \u6b21\u503c\uff0c\u4e00\u5171\u53d6 5 \u6b21\u3002 \u547d\u4ee4\u6267\u884c\u540e\u4f1a\u5217\u51fa\u6bcf\u4e2a\u7f51\u5361\u8fd9 5 \u6b21\u53d6\u503c\u7684\u5e73\u5747\u6570\u636e\uff0c\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u6765\u786e\u5b9a\u5e26\u5bbd\u8dd1\u6ee1\u7684\u7f51\u5361\u540d\u79f0\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b eth0 \u4e3a\u5185\u7f51\u7f51\u5361\uff0ceth1 \u4e3a\u5916\u7f51\u7f51\u5361\u3002","title":"\u7f51\u7edc\u7edf\u8ba1\u4fe1\u606f"},{"location":"sar/#cpu","text":"sar -u [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -u 1 3 Linux 2.6.32-642.13.1.el6.x86_64 (upfor106) 2018\u5e7404\u670825\u65e5 _x86_64_ (1 CPU) 10\u65f633\u520608\u79d2 CPU %user %nice %system %iowait %steal %idle 10\u65f633\u520609\u79d2 all 0.00 0.00 0.00 0.00 0.00 100.00 10\u65f633\u520610\u79d2 all 0.99 0.00 0.99 0.00 0.00 98.02 10\u65f633\u520611\u79d2 all 0.00 0.00 0.00 0.00 0.00 100.00 \u5e73\u5747\u65f6\u95f4: all 0.33 0.00 0.33 0.00 0.00 99.33 \u547d\u4ee4\u4e2d 1 3 \u8868\u793a\u6bcf\u4e00\u79d2\u949f\u53d6 1 \u6b21\u503c\uff0c\u4e00\u5171\u53d6 3 \u6b21\u3002 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a CPU\uff1aall \u8868\u793a\u7edf\u8ba1\u4fe1\u606f\u4e3a\u6240\u6709 CPU \u7684\u5e73\u5747\u503c\u3002 %user\uff1a\u663e\u793a\u5728\u7528\u6237\u7ea7\u522b(application)\u8fd0\u884c\u4f7f\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4 %nice\uff1a\u663e\u793a\u5728\u7528\u6237\u7ea7\u522b\uff0c\u7528\u4e8enice\u64cd\u4f5c\uff0c\u6240\u5360\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4 %system\uff1a\u5728\u6838\u5fc3\u7ea7\u522b(kernel)\u8fd0\u884c\u6240\u4f7f\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4 %iowait\uff1a\u663e\u793a\u7528\u4e8e\u7b49\u5f85I/O\u64cd\u4f5c\u5360\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4 %steal\uff1a\u7ba1\u7406\u7a0b\u5e8f(hypervisor)\u4e3a\u53e6\u4e00\u4e2a\u865a\u62df\u8fdb\u7a0b\u63d0\u4f9b\u670d\u52a1\u800c\u7b49\u5f85\u865a\u62df CPU \u7684\u767e\u5206\u6bd4 %idle\uff1a\u663e\u793a CPU \u7a7a\u95f2\u65f6\u95f4\u5360\u7528 CPU \u603b\u65f6\u95f4\u7684\u767e\u5206\u6bd4 1. \u82e5 %iowait \u7684\u503c\u8fc7\u9ad8\uff0c\u8868\u793a\u786c\u76d8\u5b58\u5728I/O\u74f6\u9888 2. \u82e5 %idle \u7684\u503c\u9ad8\u4f46\u7cfb\u7edf\u54cd\u5e94\u6162\u65f6\uff0c\u6709\u53ef\u80fd\u662f CPU \u7b49\u5f85\u5206\u914d\u5185\u5b58\uff0c\u6b64\u65f6\u5e94\u52a0\u5927\u5185\u5b58\u5bb9\u91cf 3. \u82e5 %idle \u7684\u503c\u6301\u7eed\u4f4e\u4e8e1\uff0c\u5219\u7cfb\u7edf\u7684 CPU \u5904\u7406\u80fd\u529b\u76f8\u5bf9\u8f83\u4f4e\uff0c\u8868\u660e\u7cfb\u7edf\u4e2d\u6700\u9700\u8981\u89e3\u51b3\u7684\u8d44\u6e90\u662f CPU","title":"CPU \u5229\u7528\u7387"},{"location":"sar/#_4","text":"sar -v [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -v 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 10\u65f650\u520629\u79d2 dentunusd file-nr inode-nr pty-nr 10\u65f650\u520630\u79d2 920045 864 13910 2 10\u65f650\u520631\u79d2 920045 864 13910 2 10\u65f650\u520632\u79d2 920045 896 13910 2 \u5e73\u5747\u65f6\u95f4: 920045 875 13910 2 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a dentunusd\uff1a\u76ee\u5f55\u9ad8\u901f\u7f13\u5b58\u4e2d\u672a\u88ab\u4f7f\u7528\u7684\u6761\u76ee\u6570\u91cf file-nr\uff1a\u6587\u4ef6\u53e5\u67c4\uff08file handle\uff09\u7684\u4f7f\u7528\u6570\u91cf inode-nr\uff1a\u7d22\u5f15\u8282\u70b9\u53e5\u67c4\uff08inode handle\uff09\u7684\u4f7f\u7528\u6570\u91cf pty-nr\uff1a\u4f7f\u7528\u7684 pty \u6570\u91cf","title":"\u7d22\u5f15\u8282\u70b9\uff0c\u6587\u4ef6\u548c\u5176\u4ed6\u5185\u6838\u8868\u7684\u72b6\u6001"},{"location":"sar/#_5","text":"sar -r [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -r 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 10\u65f653\u520600\u79d2 kbmemfree kbmemused %memused kbbuffers kbcached kbcommit %commit 10\u65f653\u520601\u79d2 2027760 2028732 50.01 145492 1243820 1163900 28.69 10\u65f653\u520602\u79d2 2027620 2028872 50.02 145492 1243820 1163896 28.69 10\u65f653\u520603\u79d2 2028100 2028392 50.00 145492 1243820 1163900 28.69 \u5e73\u5747\u65f6\u95f4: 2027827 2028665 50.01 145492 1243820 1163899 28.69 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a kbmemfree\uff1a\u8fd9\u4e2a\u503c\u548c free \u547d\u4ee4\u4e2d\u7684 free \u503c\u57fa\u672c\u4e00\u81f4\uff0c\u6240\u4ee5\u5b83\u4e0d\u5305\u62ec buffer \u548c cache \u7684\u7a7a\u95f4 kbmemused\uff1a\u8fd9\u4e2a\u503c\u548c free \u547d\u4ee4\u4e2d\u7684 used \u503c\u57fa\u672c\u4e00\u81f4,\u6240\u4ee5\u5b83\u5305\u62ec buffer \u548c cache \u7684\u7a7a\u95f4 %memused\uff1a\u8fd9\u4e2a\u503c\u662f kbmemused \u548c\u5185\u5b58\u603b\u91cf(\u4e0d\u5305\u62ec swap)\u7684\u4e00\u4e2a\u767e\u5206\u6bd4 kbbuffers \u548c kbcached\uff1a\u8fd9\u4e24\u4e2a\u503c\u5c31\u662f free \u547d\u4ee4\u4e2d\u7684 buffer \u548c cache kbcommit\uff1a\u4fdd\u8bc1\u5f53\u524d\u7cfb\u7edf\u6240\u9700\u8981\u7684\u5185\u5b58\uff0c\u5373\u4e3a\u4e86\u786e\u4fdd\u4e0d\u6ea2\u51fa\u800c\u9700\u8981\u7684\u5185\u5b58(RAM + swap) %commit\uff1a\u8fd9\u4e2a\u503c\u662f kbcommit \u4e0e\u5185\u5b58\u603b\u91cf(\u5305\u62ec swap)\u7684\u4e00\u4e2a\u767e\u5206\u6bd4","title":"\u5185\u5b58\u5229\u7528\u7387"},{"location":"sar/#_6","text":"sar -B [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -B 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 10\u65f655\u520641\u79d2 pgpgin/s pgpgout/s fault/s majflt/s pgfree/s pgscank/s pgscand/s pgsteal/s %vmeff 10\u65f655\u520642\u79d2 0.00 0.00 5723.76 0.00 3356.44 0.00 0.00 0.00 0.00 10\u65f655\u520643\u79d2 0.00 0.00 1185.00 0.00 312.00 0.00 0.00 0.00 0.00 10\u65f655\u520644\u79d2 0.00 0.00 27.00 0.00 56.00 0.00 0.00 0.00 0.00 \u5e73\u5747\u65f6\u95f4: 0.00 0.00 2323.26 0.00 1248.50 0.00 0.00 0.00 0.00 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a pgpgin/s\uff1a\u8868\u793a\u6bcf\u79d2\u4ece\u78c1\u76d8\u6216SWAP\u7f6e\u6362\u5230\u5185\u5b58\u7684\u5b57\u8282\u6570(KB) pgpgout/s\uff1a\u8868\u793a\u6bcf\u79d2\u4ece\u5185\u5b58\u7f6e\u6362\u5230\u78c1\u76d8\u6216SWAP\u7684\u5b57\u8282\u6570(KB) fault/s\uff1a\u6bcf\u79d2\u949f\u7cfb\u7edf\u4ea7\u751f\u7684\u7f3a\u9875\u6570\uff0c\u5373\u4e3b\u7f3a\u9875\u4e0e\u6b21\u7f3a\u9875\u4e4b\u548c(major + minor) majflt/s\uff1a\u6bcf\u79d2\u949f\u4ea7\u751f\u7684\u4e3b\u7f3a\u9875\u6570 pgfree/s\uff1a\u6bcf\u79d2\u88ab\u653e\u5165\u7a7a\u95f2\u961f\u5217\u4e2d\u7684\u9875\u4e2a\u6570 pgscank/s\uff1a\u6bcf\u79d2\u88ab kswapd \u626b\u63cf\u7684\u9875\u4e2a\u6570 pgscand/s\uff1a\u6bcf\u79d2\u76f4\u63a5\u88ab\u626b\u63cf\u7684\u9875\u4e2a\u6570 pgsteal/s\uff1a\u6bcf\u79d2\u949f\u4ece cache \u4e2d\u88ab\u6e05\u9664\u6765\u6ee1\u8db3\u5185\u5b58\u9700\u8981\u7684\u9875\u4e2a\u6570 %vmeff\uff1a\u6bcf\u79d2\u6e05\u9664\u7684\u9875(pgsteal)\u5360\u603b\u626b\u63cf\u9875(pgscank + pgscand)\u7684\u767e\u5206\u6bd4","title":"\u5185\u5b58\u5206\u9875\u72b6\u51b5"},{"location":"sar/#io","text":"sar -b [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -b 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 10\u65f658\u520615\u79d2 tps rtps wtps bread/s bwrtn/s 10\u65f658\u520616\u79d2 7.00 0.00 7.00 0.00 64.00 10\u65f658\u520617\u79d2 4.04 0.00 4.04 0.00 80.81 10\u65f658\u520618\u79d2 0.00 0.00 0.00 0.00 0.00 \u5e73\u5747\u65f6\u95f4: 3.67 0.00 3.67 0.00 48.00 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a tps\uff1a\u6bcf\u79d2\u949f\u7269\u7406\u8bbe\u5907\u7684 I/O \u4f20\u8f93\u603b\u91cf rtps\uff1a\u6bcf\u79d2\u949f\u4ece\u7269\u7406\u8bbe\u5907\u8bfb\u5165\u7684\u6570\u636e\u603b\u91cf wtps\uff1a\u6bcf\u79d2\u949f\u5411\u7269\u7406\u8bbe\u5907\u5199\u5165\u7684\u6570\u636e\u603b\u91cf bread/s\uff1a\u6bcf\u79d2\u949f\u4ece\u7269\u7406\u8bbe\u5907\u8bfb\u5165\u7684\u6570\u636e\u91cf\uff0c\u5355\u4f4d\u4e3a\uff1a\u5757/s bwrtn/s\uff1a\u6bcf\u79d2\u949f\u5411\u7269\u7406\u8bbe\u5907\u5199\u5165\u7684\u6570\u636e\u91cf\uff0c\u5355\u4f4d\u4e3a\uff1a\u5757/s","title":"I/O \u548c\u4f20\u8f93\u901f\u7387\u4fe1\u606f\u72b6\u51b5"},{"location":"sar/#_7","text":"sar -q [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -q 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 11\u65f600\u520635\u79d2 runq-sz plist-sz ldavg-1 ldavg-5 ldavg-15 11\u65f600\u520636\u79d2 0 268 0.00 0.00 0.00 11\u65f600\u520637\u79d2 0 268 0.00 0.00 0.00 11\u65f600\u520638\u79d2 0 268 0.00 0.00 0.00 \u5e73\u5747\u65f6\u95f4: 0 268 0.00 0.00 0.00 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a runq-sz\uff1a\u8fd0\u884c\u961f\u5217\u7684\u957f\u5ea6\uff08\u7b49\u5f85\u8fd0\u884c\u7684\u8fdb\u7a0b\u6570\uff09 plist-sz\uff1a\u8fdb\u7a0b\u5217\u8868\u4e2d\u8fdb\u7a0b\uff08processes\uff09\u548c\u7ebf\u7a0b\uff08threads\uff09\u7684\u6570\u91cf ldavg-1\uff1a\u6700\u540e1\u5206\u949f\u7684\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d\uff08System load average\uff09 ldavg-5\uff1a\u8fc7\u53bb5\u5206\u949f\u7684\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d ldavg-15\uff1a\u8fc7\u53bb15\u5206\u949f\u7684\u7cfb\u7edf\u5e73\u5747\u8d1f\u8f7d","title":"\u961f\u5217\u957f\u5ea6\u548c\u5e73\u5747\u8d1f\u8f7d"},{"location":"sar/#_8","text":"sar -W [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -W 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 11\u65f601\u520645\u79d2 pswpin/s pswpout/s 11\u65f601\u520646\u79d2 0.00 0.00 11\u65f601\u520647\u79d2 0.00 0.00 11\u65f601\u520648\u79d2 0.00 0.00 \u5e73\u5747\u65f6\u95f4: 0.00 0.00 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a pswpin/s\uff1a\u6bcf\u79d2\u7cfb\u7edf\u6362\u5165\u7684\u4ea4\u6362\u9875\u9762\uff08swap page\uff09\u6570\u91cf pswpout/s\uff1a\u6bcf\u79d2\u7cfb\u7edf\u6362\u51fa\u7684\u4ea4\u6362\u9875\u9762\uff08swap page\uff09\u6570\u91cf","title":"\u7cfb\u7edf\u4ea4\u6362\u4fe1\u606f"},{"location":"sar/#_9","text":"sar -d [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -d 1 3 Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 11\u65f602\u520646\u79d2 DEV tps rd_sec/s wr_sec/s avgrq-sz avgqu-sz await svctm %util 11\u65f602\u520647\u79d2 dev252-0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 11\u65f602\u520647\u79d2 DEV tps rd_sec/s wr_sec/s avgrq-sz avgqu-sz await svctm %util 11\u65f602\u520648\u79d2 dev252-0 6.06 0.00 64.65 10.67 0.00 0.00 0.00 0.00 11\u65f602\u520648\u79d2 DEV tps rd_sec/s wr_sec/s avgrq-sz avgqu-sz await svctm %util 11\u65f602\u520649\u79d2 dev252-0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 \u5e73\u5747\u65f6\u95f4: DEV tps rd_sec/s wr_sec/s avgrq-sz avgqu-sz await svctm %util \u5e73\u5747\u65f6\u95f4: dev252-0 2.00 0.00 21.33 10.67 0.00 0.00 0.00 0.00 \u8f93\u51fa\u9879\u8bf4\u660e\uff1a tps: \u6bcf\u79d2\u4ece\u7269\u7406\u78c1\u76d8 I/O \u7684\u6b21\u6570\u3002\u591a\u4e2a\u903b\u8f91\u8bf7\u6c42\u4f1a\u88ab\u5408\u5e76\u4e3a\u4e00\u4e2a I/O \u78c1\u76d8\u8bf7\u6c42\uff0c\u4e00\u6b21\u4f20\u8f93\u7684\u5927\u5c0f\u662f\u4e0d\u786e\u5b9a\u7684 rd_sec/s: \u6bcf\u79d2\u8bfb\u6247\u533a\u7684\u6b21\u6570 wr_sec/s: \u6bcf\u79d2\u5199\u6247\u533a\u7684\u6b21\u6570 avgrq-sz: \u5e73\u5747\u6bcf\u6b21\u8bbe\u5907 I/O \u64cd\u4f5c\u7684\u6570\u636e\u5927\u5c0f(\u6247\u533a) avgqu-sz: \u78c1\u76d8\u8bf7\u6c42\u961f\u5217\u7684\u5e73\u5747\u957f\u5ea6 await: \u4ece\u8bf7\u6c42\u78c1\u76d8\u64cd\u4f5c\u5230\u7cfb\u7edf\u5b8c\u6210\u5904\u7406\uff0c\u6bcf\u6b21\u8bf7\u6c42\u7684\u5e73\u5747\u6d88\u8017\u65f6\u95f4\uff0c\u5305\u62ec\u8bf7\u6c42\u961f\u5217\u7b49\u5f85\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u6beb\u79d2(1\u79d2=1000\u6beb\u79d2) svctm: \u7cfb\u7edf\u5904\u7406\u6bcf\u6b21\u8bf7\u6c42\u7684\u5e73\u5747\u65f6\u95f4,\u4e0d\u5305\u62ec\u5728\u8bf7\u6c42\u961f\u5217\u4e2d\u6d88\u8017\u7684\u65f6\u95f4. %util: I/O\u8bf7\u6c42\u5360CPU\u7684\u767e\u5206\u6bd4\uff0c\u6bd4\u7387\u8d8a\u5927\uff0c\u8bf4\u660e\u8d8a\u9971\u548c 1. avgqu-sz \u7684\u503c\u8f83\u4f4e\u65f6\uff0c\u8bbe\u5907\u7684\u5229\u7528\u7387\u8f83\u9ad8 2. \u5f53%util\u7684\u503c\u63a5\u8fd1 1% \u65f6\uff0c\u8868\u793a\u8bbe\u5907\u5e26\u5bbd\u5df2\u7ecf\u5360\u6ee1","title":"\u5757\u8bbe\u5907\u72b6\u51b5"},{"location":"sar/#_10","text":"sar -o path_file [\u9009\u9879] [ <\u65f6\u95f4\u95f4\u9694> [ <\u6b21\u6570> ] ] \u793a\u4f8b\uff1a sar -o sarfile.log -u 1 3 \u4e0a\u8ff0\u793a\u4f8b\u547d\u4ee4\u4f1a\u5c06 sar -u 1 3 \u91c7\u96c6\u5230\u7684\u6570\u636e\u4ee5\u4e8c\u8fdb\u5236\u7684\u683c\u5f0f\u5b58\u653e\u5230\u6587\u4ef6 sarfile.log \u4e2d\u3002 \u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4 sadf -d sarfile.log \u5c06\u4e8c\u8fdb\u5236\u6570\u636e\u6587\u4ef6\u8f6c\u6362\u6210\u6570\u636e\u5e93\u53ef\u8bfb\u7684\u683c\u5f0f\u3002 sadf -d sarfile.log # hostname;interval;timestamp;CPU;%user;%nice;%system;%iowait;%steal;%idle upfor163;1;2018-04-25 03:15:02 UTC;-1;0.00;0.00;0.50;0.50;0.00;99.00 upfor163;1;2018-04-25 03:15:03 UTC;-1;1.01;0.00;0.00;0.00;0.00;98.99 upfor163;1;2018-04-25 03:15:04 UTC;-1;0.00;0.00;0.00;0.00;0.00;100.00 \u4e5f\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u6570\u636e\u5b58\u50a8\u5728\u4e00\u4e2a csv \u6587\u6863\u4e2d\uff0c\u7136\u540e\u7ed8\u5236\u6210\u56fe\u8868\u5c55\u793a\u65b9\u5f0f\uff0c\u5982\u4e0b\u6240\u793a\uff1a sadf -d sarfile.log | sed 's/;/,/g' > sarfile.csv","title":"\u8f93\u51fa\u7edf\u8ba1\u7684\u6570\u636e\u4fe1\u606f"},{"location":"sar/#_11","text":"sar -f <\u6587\u4ef6\u8def\u5f84> \u793a\u4f8b\uff1a sar -f sarfile.log Linux 2.6.32-696.13.2.el6.x86_64 (upfor163) 2018\u5e7404\u670825\u65e5 _x86_64_ (2 CPU) 11\u65f615\u520601\u79d2 CPU %user %nice %system %iowait %steal %idle 11\u65f615\u520602\u79d2 all 0.00 0.00 0.50 0.50 0.00 99.00 11\u65f615\u520603\u79d2 all 1.01 0.00 0.00 0.00 0.00 98.99 11\u65f615\u520604\u79d2 all 0.00 0.00 0.00 0.00 0.00 100.00 \u5e73\u5747\u65f6\u95f4: all 0.33 0.00 0.17 0.17 0.00 99.33 \u53c8\u5c06\u4e4b\u524d\u5b58\u50a8\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u7ed9\u8bfb\u53d6\u5e76\u5c55\u793a\u51fa\u6765\u3002","title":"\u4ece\u6570\u636e\u6587\u4ef6\u8bfb\u53d6\u4fe1\u606f"},{"location":"sar/#_12","text":"\u6000\u7591 CPU \u5b58\u5728\u74f6\u9888\uff0c\u53ef\u7528 sar -u \u548c sar -q \u7b49\u6765\u67e5\u770b \u6000\u7591\u5185\u5b58\u5b58\u5728\u74f6\u9888\uff0c\u53ef\u7528 sar -B \u3001 sar -r \u548c sar -W \u7b49\u6765\u67e5\u770b \u6000\u7591 I/O \u5b58\u5728\u74f6\u9888\uff0c\u53ef\u7528 sar -b \u3001 sar -u \u548c sar -d \u7b49\u6765\u67e5\u770b \u539f\u6587\u5730\u5740: https://shockerli.net/post/li...","title":"\u6027\u80fd\u95ee\u9898\u6392\u67e5\u6280\u5de7"},{"location":"sed/","text":"\u4e09\u5341\u5206\u949f\u5b66\u4f1aSED \u00b6 \u539f\u6587 \u672c\u6587\u627f\u63a5\u4e4b\u524d\u5199\u7684[\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK][]\u4e00\u6587\uff0c\u5728\u5b66\u4e60\u5b8cAWK\u4e4b\u540e\uff0c\u8d81\u70ed\u6253\u94c1\u53c8\u5b66\u4e60\u4e86\u4e00\u4e0bSED\uff0c\u4e0d\u5f97\u4e0d\u8bf4\u8fd9\u4e24\u4e2a\u5de5\u5177\u771f\u7684\u582a\u79f0\u6587\u672c\u5904\u7406\u795e\u5668\uff0c\u8c01\u7528\u8c01\u77e5\u9053\uff01\u672c\u6587\u5927\u90e8\u5206\u5185\u5bb9\u4f9d\u65e7\u662f\u7ffb\u8bd1\u81eaTutorialspoint\u4e0a\u7684\u5165\u95e8\u6559\u7a0b\uff0c\u8fd9\u6b21\u662f Sed Tutorial \u4e00\u6587\uff0c\u5185\u5bb9\u505a\u4e86\u4e00\u4e9b\u5220\u51cf\u548c\u8865\u5145\uff0c\u589e\u52a0\u4e86\u4e00\u4e9b\u539f\u6587\u4e2d\u6ca1\u6709\u63d0\u53ca\u5230\u7684\u8bed\u6cd5\u548c\u547d\u4ee4\u7684\u8bb2\u89e3\uff0c\u5e76\u4e14\u5bf9\u539f\u6587\u6240\u6709\u7684\u793a\u4f8b\u90fd\u4e00\u4e00\u8fdb\u884c\u4e86\u9a8c\u8bc1\uff0c\u5e0c\u671b\u672c\u6587\u5bf9\u5927\u5bb6\u5b66\u4e60\u548c\u4e86\u89e3Sed\u6709\u6240\u5e2e\u52a9\u3002 \u6587\u4e2d\u7528\u5230\u7684\u6d4b\u8bd5\u6587\u4ef6\u53ef\u4ee5\u5728 https://github.com/mylxsw/sed-demo \u627e\u5230\u3002 \u672c\u6587\u5c06\u4f1a\u6301\u7eed\u4fee\u6b63\u548c\u66f4\u65b0\uff0c\u6700\u65b0\u5185\u5bb9\u8bf7\u53c2\u8003\u6211\u7684 GITHUB \u4e0a\u7684 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6b22\u8fce Star\u3002 \u4e09\u5341\u5206\u949f\u5b66\u4f1aSED \u6982\u8ff0 SED\u7684\u5178\u578b\u7528\u9014 \u5de5\u4f5c\u6d41 \u9700\u8981\u6ce8\u610f\u7684\u51e0\u70b9 \u793a\u4f8b \u57fa\u7840\u8bed\u6cd5 \u6807\u51c6\u9009\u9879 GNU\u9009\u9879 \u5faa\u73af \u5206\u652f \u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4 \u6a21\u5f0f\u7a7a\u95f4 \u884c\u5bfb\u5740 \u6570\u5b57\u65b9\u5f0f\u7684\u884c\u5bfb\u5740 \u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u8fc7\u6ee4\u5668 \u4fdd\u6301\u7a7a\u95f4 \u57fa\u672c\u547d\u4ee4 \u5220\u9664\u547d\u4ee4 d \u6587\u4ef6\u5199\u5165\u547d\u4ee4 w \u8ffd\u52a0\u547d\u4ee4 a \u884c\u66ff\u6362\u547d\u4ee4 c \u63d2\u5165\u547d\u4ee4 i \u8f6c\u6362\u547d\u4ee4 y \u8f93\u51fa\u9690\u85cf\u5b57\u7b26\u547d\u4ee4 l \u9000\u51fa\u547d\u4ee4 q \u6587\u4ef6\u8bfb\u53d6\u547d\u4ee4 r \u6267\u884c\u5916\u90e8\u547d\u4ee4 e \u6392\u9664\u547d\u4ee4 ! \u591a\u884c\u547d\u4ee4 N - \u52a0\u8f7d\u4e0b\u4e00\u884c D - \u5220\u9664\u591a\u884c\u4e2d\u7684\u4e00\u884c P - \u8f93\u51fa\u591a\u884c\u4e2d\u7684\u4e00\u884c \u5176\u5b83\u547d\u4ee4 n - \u5355\u884cnext v - SED\u7248\u672c\u68c0\u67e5 \u7279\u6b8a\u5b57\u7b26 =\u547d\u4ee4 &\u547d\u4ee4 \u5b57\u7b26\u4e32 \u66ff\u6362\u547d\u4ee4 s \u5339\u914d\u5b50\u5b57\u7b26\u4e32 \u7ba1\u7406\u6a21\u5f0f \u6b63\u5219\u8868\u8fbe\u5f0f \u6807\u51c6\u6b63\u5219\u8868\u8fbe\u5f0f ^ $ . [] [\\^] [-] \\? \uff0c\\+ \uff0c* {n} \uff0c{n,} \uff0c{m, n} | POSIX\u517c\u5bb9\u7684\u6b63\u5219 \u5143\u5b57\u7b26 \\s \\S \\w \uff0c \\W \u5e38\u7528\u4ee3\u7801\u6bb5 Cat\u547d\u4ee4 \u79fb\u9664\u7a7a\u884c \u5220\u9664\u8fde\u7eed\u7a7a\u884c \u5220\u9664\u5f00\u5934\u7684\u7a7a\u884c \u5220\u9664\u7ed3\u5c3e\u7684\u7a7a\u884c \u8fc7\u6ee4\u6240\u6709\u7684html\u6807\u7b7e \u4eceC++\u7a0b\u5e8f\u4e2d\u79fb\u9664\u6ce8\u91ca \u4e3a\u67d0\u4e9b\u884c\u6dfb\u52a0\u6ce8\u91ca \u5b9e\u73b0Wc -l\u547d\u4ee4 \u6a21\u62df\u5b9e\u73b0head\u547d\u4ee4 \u6a21\u62dftail -1\u547d\u4ee4 \u6a21\u62dfDos2unix\u547d\u4ee4 \u6a21\u62dfUnix2dos\u547d\u4ee4 \u6a21\u62dfcat -E\u547d\u4ee4 \u6a21\u62dfcat -ET\u547d\u4ee4 \u6a21\u62dfnl\u547d\u4ee4 \u6a21\u62dfcp\u547d\u4ee4 \u6a21\u62dfexpand\u547d\u4ee4 \u6a21\u62dftee\u547d\u4ee4 \u6a21\u62dfcat -s\u547d\u4ee4 \u6a21\u62dfgrep\u547d\u4ee4 \u6a21\u62dfgrep -v\u547d\u4ee4 \u6a21\u62dftr\u547d\u4ee4 \u5199\u5728\u6700\u540e \u53c2\u8003 \u6982\u8ff0 \u00b6 SED\u7684\u82f1\u6587\u5168\u79f0\u662f Stream EDitor \uff0c\u5b83\u662f\u4e00\u4e2a\u7b80\u5355\u800c\u5f3a\u5927\u7684\u6587\u672c\u89e3\u6790\u8f6c\u6362\u5de5\u5177\uff0c\u57281973-1974\u5e74\u671f\u95f4\u7531\u8d1d\u5c14\u5b9e\u9a8c\u5ba4\u7684 Lee E. McMahon \u5f00\u53d1\uff0c\u4eca\u5929\uff0c\u5b83\u5df2\u7ecf\u8fd0\u884c\u5728\u6240\u6709\u7684\u4e3b\u6d41\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u4e86\u3002 McMahon \u521b\u5efa\u4e86\u4e00\u4e2a\u901a\u7528\u7684\u884c\u7f16\u8f91\u5668\uff0c\u6700\u7ec8\u53d8\u6210\u4e3a\u4e86SED\u3002SED\u7684\u5f88\u591a\u8bed\u6cd5\u548c\u7279\u6027\u90fd\u501f\u9274\u4e86 ed \u7f16\u8f91\u5668\u3002\u8bbe\u8ba1\u4e4b\u521d\uff0c\u5b83\u5c31\u5df2\u7ecf\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\uff0cSED\u53ef\u4ee5\u4ece\u6587\u4ef6\u4e2d\u63a5\u53d7\u7c7b\u4f3c\u4e8e\u7ba1\u9053\u7684\u8f93\u5165\uff0c\u4e5f\u53ef\u4ee5\u63a5\u53d7\u6765\u81ea\u6807\u51c6\u8f93\u5165\u6d41\u7684\u8f93\u5165\u3002 SED\u7531\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u7ec4\u7ec7\uff08FSF\uff09\u5f00\u53d1\u548c\u7ef4\u62a4\u5e76\u4e14\u968f\u7740GNU/Linux\u8fdb\u884c\u5206\u53d1\uff0c\u56e0\u6b64\uff0c\u901a\u5e38\u5b83\u4e5f\u79f0\u4f5c GNU SED \u3002\u5bf9\u4e8e\u65b0\u624b\u6765\u8bf4\uff0cSED\u7684\u8bed\u6cd5\u770b\u8d77\u6765\u53ef\u80fd\u6709\u4e9b\u795e\u79d8\uff0c\u4f46\u662f\uff0c\u4e00\u65e6\u638c\u63e1\u4e86\u5b83\u7684\u8bed\u6cd5\uff0c\u4f60\u5c31\u53ef\u4ee5\u53ea\u7528\u51e0\u884c\u4ee3\u7801\u53bb\u89e3\u51b3\u975e\u5e38\u590d\u6742\u7684\u4efb\u52a1\uff0c\u8fd9\u5c31\u662fSED\u7684\u9b45\u529b\u6240\u5728\u3002 SED\u7684\u5178\u578b\u7528\u9014 \u00b6 SED\u7684\u7528\u9014\u975e\u5e38\u5e7f\u6cdb\uff0c\u4f8b\u5982\uff1a \u6587\u672c\u66ff\u6362 \u9009\u62e9\u6027\u7684\u8f93\u51fa\u6587\u672c\u6587\u4ef6 \u4ece\u6587\u672c\u6587\u4ef6\u7684\u67d0\u5904\u5f00\u59cb\u7f16\u8f91 \u65e0\u4ea4\u4e92\u5f0f\u7684\u5bf9\u6587\u672c\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\u7b49 \u5de5\u4f5c\u6d41 \u00b6 \u5728\u672c\u7ae0\u4e2d\uff0c\u6211\u4eec\u5c06\u4f1a\u63a2\u7d22SED\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u8981\u60f3\u6210\u4e3a\u4e00\u4e2aSED\u4e13\u5bb6\uff0c\u4f60\u9700\u8981\u77e5\u9053\u5b83\u7684\u5185\u90e8\u5b9e\u73b0\u3002SED\u9075\u5faa\u7b80\u5355\u7684\u5de5\u4f5c\u6d41\uff1a \u8bfb\u53d6 \uff0c \u6267\u884c \u548c \u663e\u793a \uff0c\u4e0b\u56fe\u63cf\u8ff0\u4e86\u8be5\u5de5\u4f5c\u6d41\uff1a \u8bfb\u53d6 \uff1a SED\u4ece\u8f93\u5165\u6d41\uff08\u6587\u4ef6\uff0c\u7ba1\u9053\u6216\u8005\u6807\u51c6\u8f93\u5165\uff09\u4e2d\u8bfb\u53d6\u4e00\u884c\u5e76\u4e14\u5b58\u50a8\u5230\u5b83\u53eb\u505a \u6a21\u5f0f\u7a7a\u95f4\uff08 pattern buffer \uff09 \u7684\u5185\u90e8\u7f13\u51b2\u533a \u6267\u884c \uff1a \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684SED\u547d\u4ee4\u90fd\u5728 \u6a21\u5f0f\u7a7a\u95f4 \u4e2d\u987a\u5e8f\u7684\u6267\u884c\uff0c\u9664\u975e\u6307\u5b9a\u4e86\u884c\u7684\u5730\u5740\uff0c\u5426\u5219SED\u547d\u4ee4\u5c06\u4f1a\u5728\u6240\u6709\u7684\u884c\u4e0a\u4f9d\u6b21\u6267\u884c \u663e\u793a \uff1a \u53d1\u9001\u4fee\u6539\u540e\u7684\u5185\u5bb9\u5230\u8f93\u51fa\u6d41\u3002\u5728\u53d1\u9001\u6570\u636e\u4e4b\u540e\uff0c \u6a21\u5f0f\u7a7a\u95f4 \u5c06\u4f1a\u88ab\u6e05\u7a7a\u3002 \u5728\u6587\u4ef6\u6240\u6709\u7684\u5185\u5bb9\u90fd\u88ab\u5904\u7406\u5b8c\u6210\u4e4b\u524d\uff0c\u4e0a\u8ff0\u8fc7\u7a0b\u5c06\u4f1a\u91cd\u590d\u6267\u884c \u9700\u8981\u6ce8\u610f\u7684\u51e0\u70b9 \u00b6 \u6a21\u5f0f\u7a7a\u95f4 \uff08 pattern buffer \uff09 \u662f\u4e00\u5757\u6d3b\u8dc3\u7684\u7f13\u51b2\u533a\uff0c\u5728sed\u7f16\u8f91\u5668\u6267\u884c\u547d\u4ee4\u65f6\u5b83\u4f1a\u4fdd\u5b58\u5f85\u68c0\u67e5\u7684\u6587\u672c \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684SED\u547d\u4ee4\u90fd\u662f\u5728\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u6267\u884c\uff0c\u56e0\u6b64\u8f93\u5165\u6587\u4ef6\u5e76\u4e0d\u4f1a\u53d1\u751f\u6539\u53d8 \u8fd8\u6709\u53e6\u5916\u4e00\u4e2a\u7f13\u51b2\u533a\u53eb\u505a \u4fdd\u6301\u7a7a\u95f4 \uff08 hold buffer \uff09\uff0c\u5728\u5904\u7406\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u67d0\u4e9b\u884c\u65f6\uff0c\u53ef\u4ee5\u7528\u4fdd\u6301\u7a7a\u95f4\u6765\u4e34\u65f6\u4fdd\u5b58\u4e00\u4e9b\u884c\u3002\u5728\u6bcf\u4e00\u4e2a\u5faa\u73af\u7ed3\u675f\u7684\u65f6\u5019\uff0cSED\u5c06\u4f1a\u79fb\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\uff0c\u4f46\u662f\u8be5\u7f13\u51b2\u533a\u4e2d\u7684\u5185\u5bb9\u5728\u6240\u6709\u7684\u5faa\u73af\u8fc7\u7a0b\u4e2d\u662f\u6301\u4e45\u5b58\u50a8\u7684\u3002SED\u547d\u4ee4\u65e0\u6cd5\u76f4\u63a5\u5728\u8be5\u7f13\u51b2\u533a\u4e2d\u6267\u884c\uff0c\u56e0\u6b64SED\u5141\u8bb8\u6570\u636e\u5728 \u4fdd\u6301\u7a7a\u95f4 \u548c \u6a21\u5f0f\u7a7a\u95f4 \u4e4b\u95f4\u5207\u6362 \u521d\u59cb\u60c5\u51b5\u4e0b\uff0c \u4fdd\u6301\u7a7a\u95f4 \u548c \u6a21\u5f0f\u7a7a\u95f4 \u8fd9\u4e24\u4e2a\u7f13\u51b2\u533a\u90fd\u662f\u7a7a\u7684 \u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u8f93\u5165\u6587\u4ef6\u7684\u8bdd\uff0cSED\u5c06\u4f1a\u4ece\u6807\u51c6\u8f93\u5165\u63a5\u6536\u8bf7\u6c42 \u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u5730\u5740\u8303\u56f4\u7684\u8bdd\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bSED\u5c06\u4f1a\u5bf9\u6240\u6709\u7684\u884c\u8fdb\u884c\u64cd\u4f5c \u793a\u4f8b \u00b6 \u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a quote.txt \u7684\u6587\u672c\u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u4e3a\u8457\u540d\u4f5c\u5bb6 Paulo Coelho \u7684\u4e00\u6bb5\u540d\u8a00 $ vi quote.txt There is only one thing that makes a dream impossible to achieve: the fear of failure. - Paulo Coelho, The Alchemist \u4e3a\u4e86\u7406\u89e3SED\u7684\u5de5\u4f5c\u6d41\uff0c\u6211\u4eec\u9996\u5148\u4f7f\u7528SED\u663e\u793a\u51faquote.txt\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u8be5\u793a\u4f8b\u4e0e cat \u547d\u4ee4\u7c7b\u4f3c $ sed '' quote.txt There is only one thing that makes a dream impossible to achieve: the fear of failure. - Paulo Coelho, The Alchemist \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0cquote.txt\u662f\u8f93\u5165\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u4e24\u4e2a\u5355\u5f15\u53f7\u662f\u8981\u6267\u884c\u7684SED\u547d\u4ee4\u3002 \u9996\u5148\uff0cSED\u5c06\u4f1a\u8bfb\u53d6quote.txt\u6587\u4ef6\u4e2d\u7684\u4e00\u884c\u5185\u5bb9\u5b58\u50a8\u5230\u5b83\u7684\u6a21\u5f0f\u7a7a\u95f4\u4e2d\uff0c\u7136\u540e\u4f1a\u5728\u8be5\u7f13\u51b2\u533a\u4e2d\u6267\u884cSED\u547d\u4ee4\u3002\u5728\u8fd9\u91cc\uff0c\u6ca1\u6709\u63d0\u4f9bSED\u547d\u4ee4\uff0c\u56e0\u6b64\u5bf9\u8be5\u7f13\u51b2\u533a\u6ca1\u6709\u8981\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u6700\u540e\u5b83\u4f1a\u5220\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u5e76\u4e14\u6253\u5370\u8be5\u5185\u5bb9\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u5f88\u7b80\u5355\u7684\u8fc7\u7a0b\uff0c\u5bf9\u5427? \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0cSED\u4f1a\u4ece\u6807\u51c6\u8f93\u5165\u6d41\u63a5\u53d7\u8f93\u5165 $ sed '' \u5f53\u4e0a\u8ff0\u547d\u4ee4\u88ab\u6267\u884c\u7684\u65f6\u5019\uff0c\u5c06\u4f1a\u4ea7\u751f\u4e0b\u5217\u7ed3\u679c There is only one thing that makes a dream impossible to achieve: the fear of failure. There is only one thing that makes a dream impossible to achieve: the fear of failure. \u5728\u8fd9\u91cc\uff0c\u7b2c\u4e00\u884c\u5185\u5bb9\u662f\u901a\u8fc7\u952e\u76d8\u8f93\u5165\u7684\u5185\u5bb9\uff0c\u7b2c\u4e8c\u884c\u662fSED\u8f93\u51fa\u7684\u5185\u5bb9\u3002 \u4eceSED\u4f1a\u8bdd\u4e2d\u9000\u51fa\uff0c\u4f7f\u7528\u7ec4\u5408\u952e ctrl-D (^D) \u57fa\u7840\u8bed\u6cd5 \u00b6 \u672c\u7ae0\u4e2d\u5c06\u4f1a\u4ecb\u7ecdSED\u4e2d\u7684\u57fa\u672c\u547d\u4ee4\u548c\u5b83\u7684\u547d\u4ee4\u884c\u4f7f\u7528\u65b9\u6cd5\u3002SED\u53ef\u4ee5\u7528\u4e0b\u5217\u4e24\u79cd\u65b9\u5f0f\u8c03\u7528\uff1a sed [-n] [-e] 'command(s)' files sed [-n] -f scriptfile files \u7b2c\u4e00\u79cd\u65b9\u5f0f\u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528\u5355\u5f15\u53f7\u6307\u5b9a\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u5219\u6307\u5b9a\u4e86\u5305\u542bSED\u547d\u4ee4\u7684\u811a\u672c\u6587\u4ef6\u3002\u5f53\u7136\uff0c\u8fd9\u4e24\u79cd\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\uff0cSED\u63d0\u4f9b\u4e86\u5f88\u591a\u53c2\u6570\u7528\u4e8e\u63a7\u5236\u8fd9\u79cd\u884c\u4e3a\u3002 \u8ba9\u6211\u4eec\u770b\u770b\u5982\u4f55\u6307\u5b9a\u591a\u4e2aSED\u547d\u4ee4\u3002SED\u63d0\u4f9b\u4e86 delete \u547d\u4ee4\u7528\u4e8e\u5220\u9664\u67d0\u4e9b\u884c\uff0c\u8fd9\u91cc\u8ba9\u6211\u4eec\u5220\u9664\u7b2c\u4e00\u884c\uff0c\u7b2c\u4e8c\u884c\u548c\u7b2c\u4e94\u884c\uff1a \u9996\u5148\uff0c\u4f7f\u7528 cat \u547d\u4ee4\u663e\u793a\u6587\u4ef6\u5185\u5bb9 $ cat books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u73b0\u5728\uff0c\u4f7f\u7528SED\u79fb\u9664\u6307\u5b9a\u7684\u884c\uff0c\u4e3a\u4e86\u5220\u9664\u4e09\u884c\uff0c\u6211\u4eec\u4f7f\u7528 -e \u9009\u9879\u6307\u5b9a\u4e09\u4e2a\u72ec\u7acb\u7684\u547d\u4ee4 $ sed -e '1d' -e '2d' -e '5d' books.txt 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06\u591a\u4e2aSED\u547d\u4ee4\u5199\u5728\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u5c06\u8be5\u6587\u4ef6\u4f5c\u4e3aSED\u547d\u4ee4\u7684\u53c2\u6570\uff0cSED\u53ef\u4ee5\u5bf9\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u6bcf\u4e00\u4e2a\u547d\u4ee4\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u63cf\u8ff0\u4e86SED\u7684\u7b2c\u4e8c\u79cd\u7528\u6cd5 \u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a\u5305\u542bSED\u547d\u4ee4\u7684\u6587\u672c\u6587\u4ef6\uff0c\u4e3a\u4e86\u4fbf\u4e8e\u7406\u89e3\uff0c\u6211\u4eec\u4f7f\u7528\u4e0e\u4e4b\u524d\u76f8\u540c\u7684SED\u547d\u4ee4 $ echo -e \"1d\\n2d\\n5d\" > commands.txt $ cat commands.txt 1d 2d 5d \u63a5\u4e0b\u6765\u6784\u9020\u4e00\u4e2aSED\u547d\u4ee4\u53bb\u6267\u884c\u8be5\u64cd\u4f5c $ sed -f commands.txt books.txt 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u6807\u51c6\u9009\u9879 \u00b6 SED\u652f\u6301\u4e0b\u5217\u6807\u51c6\u9009\u9879\uff1a -n \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u5728\u5904\u7406\u5b8c\u6210\u540e\u5c06\u4f1a\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u8be5\u9009\u9879\u7528\u4e8e\u963b\u6b62\u8be5\u884c\u4e3a $ sed -n '' quote.txt -e \u6307\u5b9a\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4f7f\u7528\u8be5\u53c2\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\u547d\u4ee4\uff0c\u8ba9\u6211\u4eec\u6253\u5370\u6bcf\u4e00\u884c\u4e24\u6b21\uff1a $ sed -e '' -e 'p' quote.txt There is only one thing that makes a dream impossible to achieve: the fear of failure. There is only one thing that makes a dream impossible to achieve: the fear of failure. - Paulo Coelho, The Alchemist - Paulo Coelho, The Alchemist -f \u6307\u5b9a\u5305\u542b\u8981\u6267\u884c\u7684\u547d\u4ee4\u7684\u811a\u672c\u6587\u4ef6 $ echo \"p\" > commands $ $ sed -n -f commands quote.txt There is only one thing that makes a dream impossible to achieve: the fear of failure. - Paulo Coelho, The Alchemist GNU\u9009\u9879 \u00b6 \u8fd9\u4e9b\u9009\u9879\u662fGNU\u89c4\u8303\u5b9a\u4e49\u7684\uff0c\u53ef\u80fd\u5bf9\u4e8e\u67d0\u4e9b\u7248\u672c\u7684SED\u5e76\u4e0d\u652f\u6301\u3002 -n \uff0c --quiet , --slient \uff1a\u4e0e\u6807\u51c6\u7684-n\u9009\u9879\u76f8\u540c -e script \uff0c --expression=script \uff1a\u4e0e\u6807\u51c6\u7684-e\u9009\u9879\u76f8\u540c -f script-file \uff0c --file=script-file \uff1a\u4e0e\u6807\u51c6\u7684-f\u9009\u9879\u76f8\u540c --follow-symlinks \uff1a\u5982\u679c\u63d0\u4f9b\u8be5\u9009\u9879\u7684\u8bdd\uff0c\u5728\u7f16\u8f91\u7684\u6587\u4ef6\u662f\u7b26\u53f7\u94fe\u63a5\u65f6\uff0cSED\u5c06\u4f1a\u8ddf\u968f\u94fe\u63a5 -i[SUFFIX] \uff0c --in-place[=SUFFIX] \uff1a\u8be5\u9009\u9879\u7528\u4e8e\u5bf9\u5f53\u524d\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u5982\u679c\u63d0\u4f9b\u4e86SUFFIX\u7684\u8bdd\uff0c\u5c06\u4f1a\u5907\u4efd\u539f\u59cb\u6587\u4ef6\uff0c\u5426\u5219\u5c06\u4f1a\u8986\u76d6\u539f\u59cb\u6587\u4ef6 -l N \uff0c --line-lenght=N \uff1a\u8be5\u9009\u9879\u7528\u4e8e\u8bbe\u7f6e\u884c\u7684\u957f\u5ea6\u4e3aN\u4e2a\u5b57\u7b26 --posix \uff1a\u8be5\u9009\u9879\u7981\u7528\u6240\u6709\u7684GNU\u6269\u5c55 -r \uff0c --regexp-extended \uff1a\u8be5\u9009\u9879\u5c06\u542f\u7528\u6269\u5c55\u7684\u6b63\u5219\u8868\u8fbe\u5f0f -u \uff0c --unbuffered \uff1a\u6307\u5b9a\u8be5\u9009\u9879\u7684\u65f6\u5019\uff0cSED\u5c06\u4f1a\u4ece\u8f93\u5165\u6587\u4ef6\u4e2d\u52a0\u8f7d\u6700\u5c11\u7684\u6570\u636e\uff0c\u5e76\u4e14\u66f4\u52a0\u9891\u7e41\u7684\u5237\u51fa\u5230\u8f93\u51fa\u7f13\u51b2\u533a\u3002\u5728\u7f16\u8f91 tail -f \u547d\u4ee4\u7684\u8f93\u51fa\uff0c\u4f60\u4e0d\u5e0c\u671b\u7b49\u5f85\u8f93\u51fa\u7684\u65f6\u5019\u8be5\u9009\u9879\u662f\u975e\u5e38\u6709\u7528\u7684\u3002 -z \uff0c --null-data \uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u5bf9\u6bcf\u4e00\u884c\u4f7f\u7528\u6362\u884c\u7b26\u5206\u5272\uff0c\u5982\u679c\u63d0\u4f9b\u4e86\u8be5\u9009\u9879\u7684\u8bdd\uff0c\u5b83\u5c06\u4f7f\u7528NULL\u5b57\u7b26\u5206\u5272\u884c \u5faa\u73af \u00b6 \u4e0e\u5176\u5b83\u7f16\u7a0b\u8bed\u8a00\u7c7b\u4f3c\uff0cSED\u63d0\u4f9b\u4e86\u7528\u4e8e\u63a7\u5236\u6267\u884c\u6d41\u7684\u5faa\u73af\u548c\u5206\u652f\u8bed\u53e5\u3002 SED\u4e2d\u7684\u5faa\u73af\u6709\u70b9\u7c7b\u4f3c\u4e8e goto \u8bed\u53e5\uff0cSED\u53ef\u4ee5\u6839\u636e\u6807\u7b7e\uff08label\uff09\u8df3\u8f6c\u5230\u67d0\u4e00\u884c\u7ee7\u7eed\u6267\u884c\uff0c\u5728SED\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u5982\u4e0b\u7684\u6807\u7b7e\uff1a :label :start :end :up \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u56db\u4e2a\u6807\u7b7e\u3002 \u8981\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u6807\u7b7e\uff0c\u4f7f\u7528 b \u547d\u4ee4\u540e\u9762\u8ddf\u7740\u6807\u7b7e\u540d\uff0c\u5982\u679c\u5ffd\u7565\u6807\u7b7e\u540d\u7684\u8bdd\uff0cSED\u5c06\u4f1a\u8df3\u8f6c\u5230SED\u6587\u4ef6\u7684\u7ed3\u5c3e\u3002 b \u6807\u7b7e\u7528\u4e8e\u65e0\u6761\u4ef6\u7684\u8df3\u8f6c\u5230\u6307\u5b9a\u7684label\u3002 \u4e3a\u4e86\u66f4\u597d\u5730\u7406\u89e3SED\u4e2d\u7684\u5faa\u73af\u548c\u5206\u652f\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3abooks2.txt\u7684\u6587\u672c\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e9b\u56fe\u4e66\u7684\u6807\u9898\u548c\u4f5c\u8005\u4fe1\u606f\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\u4f1a\u5408\u5e76\u56fe\u4e66\u7684\u6807\u9898\u548c\u4f5c\u8005\uff0c\u4f7f\u7528\u9017\u53f7\u5206\u9694\u3002\u4e4b\u540e\u641c\u7d22\u6240\u6709\u5339\u914d\u201cPaulo\u201d\u7684\u884c\uff0c\u5982\u679c\u5339\u914d\u7684\u8bdd\u5c31\u5728\u8fd9\u4e00\u884c\u7684\u5f00\u5934\u6dfb\u52a0 - \uff0c\u5426\u5219\u8df3\u8f6c\u5230 Print \u6807\u7b7e\uff0c\u6253\u5370\u51fa\u8be5\u884c\u5185\u5bb9\u3002 $ cat books2.txt A Storm of Swords George R. R. Martin The Two Towers J. R. R. Tolkien The Alchemist Paulo Coelho The Fellowship of the Ring J. R. R. Tolkien The Pilgrimage Paulo Coelho A Game of Thrones George R. R. Martin $ sed -n ' h;n;H;x s/\\n/, / /Paulo/!b Print s/^/- / :Print p' books2.txt A Storm of Swords , George R. R. Martin The Two Towers , J. R. R. Tolkien - The Alchemist , Paulo Coelho The Fellowship of the Ring , J. R. R. Tolkien - The Pilgrimage , Paulo Coelho A Game of Thrones , George R. R. Martin \u4e4d\u770b\u6765\u4e0a\u8ff0\u7684\u4ee3\u7801\u975e\u5e38\u795e\u79d8\uff0c\u8ba9\u6211\u4eec\u9010\u6b65\u62c6\u89e3\u4e00\u4e0b \u7b2c\u4e00\u884c\u662f h;n;H;x \u8fd9\u51e0\u4e2a\u547d\u4ee4\uff0c\u8bb0\u5f97\u4e0a\u9762\u6211\u4eec\u63d0\u5230\u7684 \u4fdd\u6301\u7a7a\u95f4 \u5417\uff1f\u7b2c\u4e00\u4e2a h \u662f\u6307\u5c06\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u8986\u76d6\u5230 \u4fdd\u6301\u7a7a\u95f4 \u4e2d\uff0c n \u7528\u4e8e\u63d0\u524d\u8bfb\u53d6\u4e0b\u4e00\u884c\uff0c\u5e76\u4e14\u8986\u76d6\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u8fd9\u4e00\u884c\uff0c H \u5c06\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u8ffd\u52a0\u5230 \u4fdd\u6301\u7a7a\u95f4 \u4e2d\uff0c\u6700\u540e\u7684 x \u7528\u4e8e\u4ea4\u6362\u6a21\u5f0f\u7a7a\u95f4\u548c \u4fdd\u6301\u7a7a\u95f4 \u4e2d\u7684\u5185\u5bb9\u3002\u56e0\u6b64\u8fd9\u91cc\u5c31\u662f\u6307\u6bcf\u6b21\u8bfb\u53d6\u4e24\u884c\u653e\u5230\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u4ea4\u7ed9\u4e0b\u9762\u7684\u547d\u4ee4\u8fdb\u884c\u5904\u7406 \u63a5\u4e0b\u6765\u662f s/\\n/, / \u7528\u4e8e\u5c06\u4e0a\u9762\u7684\u4e24\u884c\u5185\u5bb9\u4e2d\u7684\u6362\u884c\u7b26\u66ff\u6362\u4e3a\u9017\u53f7 \u7b2c\u4e09\u4e2a\u547d\u4ee4\u5728\u4e0d\u5339\u914d\u7684\u65f6\u5019\u8df3\u8f6c\u5230 Print \u6807\u7b7e\uff0c\u5426\u5219\u7ee7\u7eed\u6267\u884c\u7b2c\u56db\u4e2a\u547d\u4ee4 :Print \u4ec5\u4ec5\u662f\u4e00\u4e2a\u6807\u7b7e\u540d\uff0c\u800c p \u5219\u662fprint\u547d\u4ee4 \u4e3a\u4e86\u63d0\u9ad8\u53ef\u8bfb\u6027\uff0c\u6bcf\u4e00\u4e2a\u547d\u4ee4\u90fd\u5360\u4e86\u4e00\u884c\uff0c\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u628a\u6240\u6709\u547d\u4ee4\u653e\u5728\u4e00\u884c $ sed -n 'h;n;H;x;s/\\n/, /;/Paulo/!b Print; s/^/- /; :Print;p' books2.txt \u5173\u4e8e h \uff0c H \uff0c x \u547d\u4ee4\u53c2\u8003\u5b98\u65b9\u624b\u518c sed, a stream editor 3.6 Less Frequently-Used Commands \u8282 \u5206\u652f \u00b6 \u4f7f\u7528 t \u547d\u4ee4\u521b\u5efa\u5206\u652f\u3002\u53ea\u6709\u5f53\u524d\u7f6e\u6761\u4ef6\u6210\u529f\u7684\u65f6\u5019\uff0c t \u547d\u4ee4\u624d\u4f1a\u8df3\u8f6c\u5230\u8be5\u6807\u7b7e\u3002 t \u547d\u4ee4\u53ea\u6709\u5728\u524d\u4e00\u4e2a\u66ff\u6362\uff08s\uff09\u547d\u4ee4\u6267\u884c\u6210\u529f\u7684\u65f6\u5019\u624d\u4f1a\u6267\u884c\u3002 \u8ba9\u6211\u4eec\u770b\u4e00\u4e9b\u524d\u9762\u7ae0\u8282\u4e2d\u7684\u4f8b\u5b50\uff0c\u4e0e\u4e4b\u524d\u4e0d\u540c\u7684\u662f\uff0c\u8fd9\u6b21\u6211\u4eec\u5c06\u6253\u5370\u56db\u4e2a\u8fde\u5b57\u7b26\"-\"\uff0c\u800c\u4e4b\u524d\u662f\u4e00\u4e2a\u3002 $ sed -n ' h;n;H;x s/\\n/, / :Loop /Paulo/s/^/-/ /----/!t Loop p' books2.txt A Storm of Swords , George R. R. Martin The Two Towers , J. R. R. Tolkien ----The Alchemist , Paulo Coelho The Fellowship of the Ring , J. R. R. Tolkien ----The Pilgrimage , Paulo Coelho A Game of Thrones , George R. R. Martin \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u524d\u9762\u4e24\u884c\u4e0e\u4e0a\u4e00\u8282\u4e2d\u8bb2\u7684\u4f5c\u7528\u4e00\u81f4\uff0c\u7b2c\u4e09\u884c\u5b9a\u4e49\u4e86\u4e00\u4e2a Loop \u6807\u7b7e\uff0c\u63a5\u4e0b\u6765\u5339\u914d\u5b58\u5728\u201cPaulo\u201d\u7684\u884c\uff0c\u5982\u679c\u5b58\u5728\u5219\u5728\u6700\u524d\u9762\u6dfb\u52a0\u4e00\u4e2a - \uff0c\u63a5\u4e0b\u6765\u662f\u6211\u4eec\u8fd9\u91cc\u7684\u91cd\u70b9\uff1a /----/!t Loop \u8fd9\u4e00\u884c\u9996\u5148\u68c0\u67e5\u4e0a\u9762\u6dfb\u52a0 - \u4e4b\u540e\u662f\u5426\u6ee1\u8db3\u56db\u4e2a - \uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u5219\u8df3\u8f6c\u5230Loop\u7ee7\u7eed\u6267\u884c\u7b2c\u4e09\u884c\uff0c\u8fd9\u6837\u4e0d\u505c\u7684\u8ffd\u52a0 - \uff0c\u6700\u540e\u5982\u679c\u6539\u884c\u6ee1\u8db3\u524d\u9762\u6709\u56db\u4e2a - \u624d\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\u3002 \u4e3a\u4e86\u63d0\u9ad8\u53ef\u8bfb\u6027\uff0c\u6211\u4eec\u5c06\u6bcf\u4e00\u4e2aSED\u547d\u4ee4\u72ec\u7acb\u4e00\u884c\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u540c\u4e00\u884c\u4e2d\u4f7f\u7528\uff1a sed -n 'h;n;H;x; s/\\n/, /; :Loop;/Paulo/s/^/-/; /----/!t Loop; p' books.txt \u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4 \u00b6 \u6a21\u5f0f\u7a7a\u95f4 \u00b6 \u5bf9\u4efb\u4f55\u6587\u4ef6\u7684\u6765\u8bf4\uff0c\u6700\u57fa\u672c\u7684\u64cd\u4f5c\u5c31\u662f\u8f93\u51fa\u5b83\u7684\u5185\u5bb9\uff0c\u4e3a\u4e86\u5b9e\u73b0\u8be5\u76ee\u7684\uff0c\u5728SED\u4e2d\u53ef\u4ee5\u4f7f\u7528 print \u547d\u4ee4\u6253\u5370\u51fa\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u3002 \u9996\u5148\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u884c\u53f7\uff0c\u4e66\u540d\uff0c\u4f5c\u8005\u548c\u9875\u7801\u6570\u7684\u6587\u4ef6\uff0c\u5728\u672c\u6587\u4e2d\u6211\u4eec\u5c06\u4f1a\u4f7f\u7528\u8be5\u6587\u4ef6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u521b\u5efa\u4efb\u4f55\u5176\u5b83\u7684\u6587\u4ef6\uff0c\u4f46\u662f\u8fd9\u91cc\u6211\u4eec\u5c31\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\u7684\u6587\u4ef6 $ vi books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho,288 6) A Game of Thrones, George R. R. Martin, 864 \u6267\u884c p \u547d\u4ee4 $ sed 'p' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 6) A Game of Thrones, George R. R. Martin, 864 \u4f60\u53ef\u80fd\u4f1a\u7591\u60d1\uff0c\u4e3a\u4ec0\u4e48\u6bcf\u4e00\u884c\u88ab\u663e\u793a\u4e86\u4e24\u6b21\uff1f \u4f60\u8fd8\u8bb0\u5f97SED\u7684\u5de5\u4f5c\u6d41\u5417\uff1f\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u5c06\u4f1a\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\uff0c\u53e6\u5916\uff0c\u6211\u4eec\u7684\u547d\u4ee4\u4e2d\u5305\u542b\u4e86\u8f93\u51fa\u547d\u4ee4 p \uff0c\u56e0\u6b64\u6bcf\u4e00\u884c\u88ab\u6253\u5370\u4e24\u6b21\u3002\u4f46\u662f\u4e0d\u8981\u62c5\u5fc3\uff0cSED\u63d0\u4f9b\u4e86 -n \u53c2\u6570\u7528\u4e8e\u7981\u6b62\u81ea\u52a8\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u7684\u6bcf\u4e00\u884c\u7684\u884c\u4e3a $ sed -n 'p' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u884c\u5bfb\u5740 \u00b6 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728SED\u4e2d\u4f7f\u7528\u7684\u547d\u4ee4\u4f1a\u4f5c\u7528\u4e8e\u6587\u672c\u6570\u636e\u7684\u6240\u6709\u884c\u3002\u5982\u679c\u53ea\u60f3\u5c06\u547d\u4ee4\u4f5c\u7528\u4e8e\u7279\u5b9a\u7684\u884c\u6216\u8005\u67d0\u4e9b\u884c\uff0c\u5219\u9700\u8981\u4f7f\u7528 \u884c\u5bfb\u5740 \u529f\u80fd\u3002 \u5728SED\u4e2d\u5305\u542b\u4e24\u79cd\u5f62\u5f0f\u7684\u884c\u5bfb\u5740\uff1a \u4ee5\u6570\u5b57\u5f62\u5f0f\u8868\u793a\u7684\u884c\u533a\u95f4 \u4ee5\u6587\u672c\u6a21\u5f0f\u6765\u8fc7\u6ee4\u884c \u4e24\u79cd\u5f62\u5f0f\u90fd\u4f7f\u7528\u76f8\u540c\u7684\u8bed\u6cd5\u683c\u5f0f [address]command \u6570\u5b57\u65b9\u5f0f\u7684\u884c\u5bfb\u5740 \u00b6 \u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2dSED\u53ea\u4f1a\u5bf9\u7b2c3\u884c\u8fdb\u884c\u64cd\u4f5c $ sed -n '3p' books.txt 3) The Alchemist, Paulo Coelho, 197 \u5f53\u7136\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8ba9SED\u8f93\u51fa\u67d0\u4e9b\u884c\u3002\u5728SED\u4e2d\u4f7f\u7528\u9017\u53f7 , \u5206\u9694\u8f93\u51fa\u884c\u53f7\u7684\u8303\u56f4\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u4ee3\u7801\u4f1a\u8f93\u51fa\u51fa2-5\u884c\u7684\u5185\u5bb9 $ sed -n '2,5 p' books.txt 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 \u7279\u6b8a\u5b57\u7b26 $ \u4ee3\u8868\u4e86\u6587\u4ef6\u7684\u6700\u540e\u4e00\u884c\uff0c\u8f93\u51fa\u6587\u4ef6\u7684\u6700\u540e\u4e00\u884c $ sed -n '$ p' books.txt 6) A Game of Thrones, George R. R. Martin, 864 \u4e5f\u53ef\u4ee5\u4f7f\u7528 $ \u6307\u5b9a\u8f93\u51fa\u7684\u5730\u5740\u8303\u56f4\uff0c\u4e0b\u5217\u547d\u4ee4\u8f93\u51fa\u7b2c\u4e09\u884c\u5230\u6700\u540e\u4e00\u884c $ sed -n '3,$ p' books.txt 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho,288 6) A Game of Thrones, George R. R. Martin, 864 SED\u8fd8\u63d0\u4f9b\u4e86\u53e6\u5916\u4e24\u79cd\u64cd\u4f5c\u7b26\u7528\u4e8e\u6307\u5b9a\u5730\u5740\u8303\u56f4\uff0c\u7b2c\u4e00\u4e2a\u662f\u52a0\u53f7\uff08 + \uff09\u64cd\u4f5c\u7b26\uff0c\u5b83\u53ef\u4ee5\u4e0e\u9017\u53f7\uff08 , \uff09\u64cd\u4f5c\u7b26\u4e00\u8d77\u4f7f\u7528\uff0c\u4f8b\u5982 M, +n \u5c06\u4f1a\u6253\u5370\u51fa\u4ece\u7b2c M \u884c\u5f00\u59cb\u7684\u4e0b n \u884c\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u4f1a\u8f93\u51fa\u7b2c\u4e8c\u884c\u5f00\u59cb\u7684\u4e0b\u9762\u56db\u884c $ sed -n '2,+4 p' books.txt 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u6ce2\u6d6a\u7ebf\u64cd\u4f5c\u7b26\uff08 ~ \uff09\u6307\u5b9a\u5730\u5740\u8303\u56f4\uff0c\u5b83\u4f7f\u7528 M~N \u7684\u5f62\u5f0f\uff0c\u5b83\u544a\u8bc9SED\u5e94\u8be5\u5904\u7406 M \u884c\u5f00\u59cb\u7684\u6bcf N \u884c\u3002\u4f8b\u5982\uff0c 50~5 \u5339\u914d\u884c\u53f750\uff0c55\uff0c60\uff0c65\u7b49\uff0c\u8ba9\u6211\u4eec\u53ea\u8f93\u51fa\u6587\u4ef6\u4e2d\u7684\u5947\u6570\u884c $ sed -n '1~2 p' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 3) The Alchemist, Paulo Coelho, 197 5) The Pilgrimage, Paulo Coelho, 288 \u4e0b\u9762\u7684\u4ee3\u7801\u5219\u662f\u53ea\u8f93\u51fa\u6587\u4ef6\u4e2d\u7684\u5076\u6570\u884c $ sed -n '2~2 p' books.txt 2) The Two Towers, J. R. R. Tolkien, 352 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u6ce8\u610f\uff0c\u5982\u679c\u4f7f\u7528\u7684\u662fMac\u7cfb\u7edf\u81ea\u5e26\u7684sed\u547d\u4ee4\uff0c\u53ef\u80fd\u4e0d\u652f\u6301 ~ \u548c + \u64cd\u4f5c\u7b26\u3002\u53ef\u4ee5\u4f7f\u7528 brew install gnu-sed --with-default-names \u91cd\u65b0\u5b89\u88c5GNU-SED\u3002 \u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u8fc7\u6ee4\u5668 \u00b6 SED\u7f16\u8f91\u5668\u5141\u8bb8\u6307\u5b9a\u6587\u672c\u6a21\u5f0f\u6765\u8fc7\u6ee4\u51fa\u547d\u4ee4\u8981\u4f5c\u7528\u7684\u884c\u3002\u683c\u5f0f\u5982\u4e0b\uff1a /pattern/command \u5fc5\u987b\u7528\u6b63\u659c\u7ebf\u5c06\u8981\u6307\u5b9a\u7684pattern\u5c01\u8d77\u6765\u3002sed\u7f16\u8f91\u5668\u4f1a\u5c06\u8be5\u547d\u4ee4\u4f5c\u7528\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u6a21\u5f0f\u7684\u884c\u4e0a\u3002 \u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u5c06\u4f1a\u8f93\u51fa\u6240\u6709\u4f5c\u8005\u4e3aPaulo Coelho\u7684\u4e66\u7c4d\u3002 $ sed -n '/Paulo/ p' books.txt 3) The Alchemist, Paulo Coelho, 197 5) The Pilgrimage, Paulo Coelho, 288 \u6a21\u5f0f\u5339\u914d\u4e5f\u53ef\u4ee5\u4e0e\u6570\u5b57\u5f62\u5f0f\u7684\u5bfb\u5740\u540c\u65f6\u4f7f\u7528\uff0c\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u4ece\u7b2c\u4e00\u6b21\u5339\u914d\u5230 Alchemist \u5f00\u59cb\u8f93\u51fa\uff0c\u76f4\u5230\u7b2c5\u884c\u4e3a\u6b62\u3002 $ sed -n '/Alchemist/, 5 p' books.txt 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 \u4f7f\u7528\u9017\u53f7\uff08 , \uff09\u64cd\u4f5c\u7b26\u6307\u5b9a\u5339\u914d\u591a\u4e2a\u5339\u914d\u7684\u6a21\u5f0f\u3002\u4e0b\u5217\u7684\u793a\u4f8b\u5c06\u4f1a\u8f93\u51faTwo\u548cPilgrimage\u4e4b\u95f4\u7684\u6240\u6709\u884c $ sed -n '/Two/, /Pilgrimage/ p' books.txt 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 \u5728\u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u8fc7\u6ee4\u5668\u7684\u65f6\u5019\uff0c\u4e0e\u6570\u5b57\u65b9\u5f0f\u7684\u884c\u5bfb\u5740\u7c7b\u4f3c\uff0c\u53ef\u4ee5\u4f7f\u7528\u52a0\u53f7\u64cd\u4f5c\u7b26 + \uff0c\u5b83\u4f1a\u8f93\u51fa\u4ece\u5f53\u524d\u5339\u914d\u4f4d\u7f6e\u5f00\u59cb\u7684\u67d0\u51e0\u884c\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u4ece\u7b2c\u4e00\u6b21Two\u51fa\u73b0\u7684\u4f4d\u7f6e\u5f00\u59cb\u8f93\u51fa\u63a5\u4e0b\u6765\u76844\u884c $ sed -n '/Two/, +4 p' books.txt 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u4fdd\u6301\u7a7a\u95f4 \u00b6 \u5728\u5904\u7406\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u67d0\u4e9b\u884c\u65f6\uff0c\u53ef\u4ee5\u7528\u4fdd\u6301\u7a7a\u95f4\u6765\u4e34\u65f6\u4fdd\u5b58\u4e00\u4e9b\u884c\u3002\u67095\u6761\u547d\u4ee4\u53ef\u7528\u6765\u64cd\u4f5c\u4fdd\u6301\u7a7a\u95f4 \u547d\u4ee4 \u63cf\u8ff0 h \u5c06\u6a21\u5f0f\u7a7a\u95f4\u590d\u5236\u5230\u4fdd\u6301\u7a7a\u95f4 H \u5c06\u6a21\u5f0f\u7a7a\u95f4\u9644\u52a0\u5230\u4fdd\u6301\u7a7a\u95f4 g \u5c06\u4fdd\u6301\u7a7a\u95f4\u590d\u5236\u5230\u6a21\u5f0f\u7a7a\u95f4 G \u5c06\u4fdd\u6301\u7a7a\u95f4\u9644\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4 x \u4ea4\u6362\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4\u7684\u5185\u5bb9 \u5173\u4e8e\u4fdd\u6301\u7a7a\u95f4\u8fd9\u91cc\u5c31\u4e0d\u5728\u4e3e\u4f8b\u4e86\uff0c\u524d\u9762\u518d \u5faa\u73af \u90e8\u5206\u8bb2\u89e3\u4e0b\u9762\u8fd9\u4e2a\u547d\u4ee4\u7684\u65f6\u5019\u6211\u4eec\u5df2\u7ecf\u5bf9\u5b83\u7684\u4f7f\u7528\u505a\u4e86\u8bf4\u660e\u3002 $ sed -n 'h;n;H;x;s/\\n/, /;/Paulo/!b Print; s/^/- /; :Print;p' books2.txt \u57fa\u672c\u547d\u4ee4 \u00b6 \u672c\u7ae0\u5c06\u4f1a\u8bb2\u89e3\u4e00\u4e9b\u5e38\u7528\u7684SED\u547d\u4ee4\uff0c\u4e3b\u8981\u5305\u62ec DELETE \uff0c WRITE \uff0c APPEND \uff0c CHANGE \uff0c INSERT \uff0c TRANSLATE \uff0c QUIT \uff0c READ \uff0c EXECUTE \u7b49\u547d\u4ee4\u3002 \u5220\u9664\u547d\u4ee4 d \u00b6 \u5220\u9664\u547d\u4ee4\u683c\u5f0f\u5982\u4e0b [address1[,address2]]d address1 \u548c address2 \u662f\u5f00\u59cb\u548c\u622a\u6b62\u5730\u5740\uff0c\u5b83\u4eec\u53ef\u4ee5\u662f\u884c\u53f7\u6216\u8005\u5b57\u7b26\u4e32\u5339\u914d\u6a21\u5f0f\uff0c\u8fd9\u4e24\u79cd\u5730\u5740\u90fd\u662f\u53ef\u9009\u7684\u3002 \u7531\u547d\u4ee4\u7684\u540d\u79f0\u53ef\u4ee5\u77e5\u9053\uff0c delete \u547d\u4ee4\u662f\u7528\u6765\u6267\u884c\u5220\u9664\u64cd\u4f5c\u7684\uff0c\u5e76\u4e14\u56e0\u4e3aSED\u662f\u57fa\u4e8e\u884c\u7684\u7f16\u8f91\u5668\uff0c\u56e0\u6b64\u6211\u4eec\u8bf4\u8be5\u547d\u4ee4\u662f\u7528\u6765\u5220\u9664\u884c\u7684\u3002\u6ce8\u610f\u7684\u662f\uff0c\u8be5\u547d\u4ee4\u53ea\u4f1a\u79fb\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u884c\uff0c\u8fd9\u6837\u8be5\u884c\u5c31\u4e0d\u4f1a\u88ab\u53d1\u9001\u5230\u8f93\u51fa\u6d41\uff0c\u4f46\u539f\u59cb\u5185\u5bb9\u4e0d\u4f1a\u6539\u53d8\u3002 $ sed 'd' books.txt \u4e3a\u4ec0\u4e48\u6ca1\u6709\u8f93\u51fa\u4efb\u4f55\u5185\u5bb9\uff1f\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u5c06\u4f1a\u5bf9\u6bcf\u4e00\u884c\u6267\u884c\u5220\u9664\u64cd\u4f5c\uff0c\u8fd9\u5c31\u662f\u8be5\u547d\u4ee4\u4e3a\u4ec0\u4e48\u6ca1\u6709\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u8f93\u51fa\u4efb\u4f55\u5185\u5bb9\u7684\u539f\u56e0\u3002 \u4e0b\u5217\u547d\u4ee4\u53ea\u79fb\u9664\u7b2c\u56db\u884c [jerry]$ sed '4d' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 SED\u4e5f\u63a5\u53d7\u4f7f\u7528\u9017\u53f7(,)\u5206\u9694\u7684\u5730\u5740\u8303\u56f4\u3002\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u5730\u5740\u8303\u56f4\u53bb\u79fb\u9664N1\u5230N2\u884c\uff0c\u4f8b\u5982\uff0c\u4e0b\u5217\u547d\u4ee4\u5c06\u5220\u96642-4\u884c $ sed '2, 4 d' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 SED\u7684\u5730\u5740\u8303\u56f4\u5e76\u4e0d\u4ec5\u4ec5\u9650\u4e8e\u6570\u5b57\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6307\u5b9a\u6a21\u5f0f\u5339\u914d\u4f5c\u4e3a\u5730\u5740\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u79fb\u9664\u6240\u6709\u4f5c\u8005\u4e3aPaulo Coelho\u7684\u4e66\u7c4d $ sed '/Paulo Coelho/d' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u6211\u79fb\u9664\u6240\u6709\u4ee5 Storm \u548c Fellowship \u5f00\u5934\u7684\u884c $ sed '/Storm/,/Fellowship/d' books.txt 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u6587\u4ef6\u5199\u5165\u547d\u4ee4 w \u00b6 SED\u63d0\u4f9b\u4e86 write \u547d\u4ee4\u7528\u4e8e\u5c06\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u5199\u5165\u5230\u6587\u4ef6\uff0c\u4e0e delete \u547d\u4ee4\u7c7b\u4f3c\uff0c\u4e0b\u9762\u662f write \u547d\u4ee4\u7684\u8bed\u6cd5 [address1[,address2]]w file w \u6307\u5b9a\u662f\u5199\u547d\u4ee4\uff0c file \u6307\u7684\u662f\u5b58\u50a8\u6587\u4ef6\u5185\u5bb9\u7684\u6587\u4ef6\u540d\u3002\u4f7f\u7528 file \u64cd\u4f5c\u7b26\u7684\u65f6\u5019\u8981\u5c0f\u5fc3\uff0c\u5f53\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\u4f46\u662f\u6587\u4ef6\u4e0d\u5b58\u5728\u7684\u65f6\u5019\u5b83\u4f1a\u81ea\u52a8\u521b\u5efa\uff0c\u5982\u679c\u5df2\u7ecf\u5b58\u5728\u7684\u8bdd\u5219\u4f1a \u8986\u76d6 \u539f\u6587\u4ef6\u7684\u5185\u5bb9\u3002 \u4e0b\u9762\u7684SED\u547d\u4ee4\u4f1a\u521b\u5efa\u6587\u4ef6books.txt\u7684\u526f\u672c\uff0c\u5728 w \u548c file \u4e4b\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u7a7a\u683c $ sed -n 'w books.bak' books.txt \u4e0a\u8ff0\u547d\u4ee4\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a books.bak \u7684\u6587\u4ef6\uff0c\u9a8c\u8bc1\u4e00\u4e0b\u4e24\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u662f\u5426\u76f8\u540c $ diff books.txt books.bak $ echo $? \u4e00\u65e6\u6267\u884c\u4e0a\u8ff0\u7684\u4ee3\u7801\uff0c\u4f60\u5c06\u4f1a\u5f97\u5230\u4e0b\u5217\u8f93\u51fa 0 \u806a\u660e\u7684\u4f60\u53ef\u80fd\u5df2\u7ecf\u60f3\u5230\u4e86\uff0c\u8fd9\u4e0d\u5c31\u662f cp \u547d\u4ee4\u505a\u7684\u4e8b\u60c5\u5417\uff01\u786e\u5b9e\u5982\u6b64\uff0c cp \u547d\u4ee4\u4e5f\u505a\u4e86\u540c\u4e00\u4ef6\u4e8b\u60c5\uff0c\u4f46\u662fSED\u662f\u4e00\u4e2a\u6210\u719f\u7684\u5de5\u5177\uff0c\u4f7f\u7528\u5b83\u4f60\u53ef\u4ee5\u53ea\u590d\u5236\u6587\u4ef6\u4e2d\u7684\u67d0\u4e9b\u884c\u5230\u65b0\u7684\u6587\u4ef6\u4e2d\uff0c\u5982\u4e0b\u4ee3\u7801\u4f1a\u5b58\u50a8\u6587\u4ef6\u4e2d\u7684\u5947\u6570\u884c\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6 $ sed -n '2~2 w junk.txt' books.txt $ cat junk.txt 2) The Two Towers, J. R. R. Tolkien, 352 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u5047\u8bbe\u4f60\u5e0c\u671b\u5b58\u50a8\u6240\u6709\u72ec\u7acb\u4f5c\u8005\u7684\u4e66\u5230\u5355\u72ec\u7684\u6587\u4ef6\u3002\u5982\u679c\u4eba\u5de5\u53bb\u505a\u7684\u8bdd\uff0c\u80af\u5b9a\u662f\u975e\u5e38\u65e0\u804a\u800c\u4e14\u6ca1\u6709\u6280\u672f\u542b\u91cf\u7684\uff0c\u4f46\u662f\u4f7f\u7528SED\uff0c\u4f60\u5c31\u6709\u4e86\u66f4\u52a0\u806a\u660e\u7684\u65b9\u6cd5\u53bb\u5b9e\u73b0 $ sed -n -e '/Martin/ w Martin.txt' -e '/Paulo/ w Paulo.txt' -e '/Tolkien/ w Tolkien.txt' books.txt $ cat Martin.txt 1) A Storm of Swords, George R. R. Martin, 1216 6) A Game of Thrones, George R. R. Martin, 864 $ cat Paulo.txt 3) The Alchemist, Paulo Coelho, 197 5) The Pilgrimage, Paulo Coelho, 288 $ cat Tolkien.txt 2) The Two Towers, J. R. R. Tolkien, 352 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 \u8ffd\u52a0\u547d\u4ee4 a \u00b6 \u6587\u672c\u8ffd\u52a0\u547d\u4ee4\u8bed\u6cd5\uff1a [address]a\\ Append text \u5728\u7b2c\u56db\u884c\u4e4b\u540e\u8ffd\u52a0\u4e00\u672c\u65b0\u4e66\uff1a $ sed '4 a 7) Adultry, Paulo Coelho, 234' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 7) Adultry, Paulo Coelho, 234 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u5728\u547d\u4ee4\u90e8\u5206\uff0c4\u6307\u7684\u662f\u884c\u53f7\uff0c a \u662fappend\u547d\u4ee4\uff0c\u5269\u4f59\u90e8\u5206\u4e3a\u8981\u8ffd\u52a0\u7684\u6587\u672c\u3002 \u5728\u6587\u4ef6\u7684\u7ed3\u5c3e\u63d2\u5165\u4e00\u884c\u6587\u672c\uff0c\u4f7f\u7528 $ \u4f5c\u4e3a\u5730\u5740 $ sed '$ a 7) Adultry, Paulo Coelho, 234' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 7) Adultry, Paulo Coelho, 234 \u9664\u4e86\u884c\u53f7\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u6307\u5b9a\u5730\u5740\uff0c\u4f8b\u5982\uff0c\u5728\u5339\u914d The Alchemist \u7684\u884c\u4e4b\u540e\u8ffd\u52a0\u6587\u672c $ sed '/The Alchemist/ a 7) Adultry, Paulo Coelho, 234' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 7) Adultry, Paulo Coelho, 234 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u884c\u66ff\u6362\u547d\u4ee4 c \u00b6 SED\u901a\u8fc7 c \u63d0\u4f9b\u4e86 change \u548c replace \u547d\u4ee4\uff0c\u8be5\u547d\u4ee4\u5e2e\u52a9\u6211\u4eec\u4f7f\u7528\u65b0\u6587\u672c\u66ff\u6362\u5df2\u7ecf\u5b58\u5728\u7684\u884c\uff0c\u5f53\u63d0\u4f9b\u884c\u7684\u5730\u5740\u8303\u56f4\u65f6\uff0c\u6240\u6709\u7684\u884c\u90fd\u88ab\u4f5c\u4e3a\u4e00\u7ec4\u88ab\u66ff\u6362\u4e3a\u5355\u884c\u6587\u672c\uff0c\u4e0b\u9762\u662f\u8be5\u547d\u4ee4\u7684\u8bed\u6cd5 [address1[,address2]]c\\ Replace text \u6bd4\u5982\uff0c\u66ff\u6362\u6587\u672c\u4e2d\u7684\u7b2c\u4e09\u884c\u4e3a\u65b0\u7684\u5185\u5bb9 $ sed '3 c 3) Adultry, Paulo Coelho, 324' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) Adultry, Paulo Coelho, 324 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 SED\u4e5f\u63a5\u53d7\u6a21\u5f0f\u4f5c\u4e3a\u5730\u5740 $ sed '/The Alchemist/ c 3) Adultry, Paulo Coelho, 324' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) Adultry, Paulo Coelho, 324 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u591a\u884c\u66ff\u6362\u4e5f\u662f\u652f\u6301\u7684\uff0c\u4e0b\u9762\u7684\u547d\u4ee4\u5b9e\u73b0\u4e86\u5c06\u7b2c4-6\u884c\u5185\u5bb9\u66ff\u6362\u4e3a\u5355\u884c $ sed '4, 6 c 4) Adultry, Paulo Coelho, 324' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) Adultry, Paulo Coelho, 324 \u63d2\u5165\u547d\u4ee4 i \u00b6 \u63d2\u5165\u547d\u4ee4\u4e0e\u8ffd\u52a0\u547d\u4ee4\u7c7b\u4f3c\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\u63d2\u5165\u547d\u4ee4\u662f\u5728\u5339\u914d\u7684\u4f4d\u7f6e\u524d\u63d2\u5165\u65b0\u7684\u4e00\u884c\u3002 [address]i\\ Insert text \u4e0b\u9762\u7684\u547d\u4ee4\u4f1a\u5728\u7b2c\u56db\u884c\u524d\u63d2\u5165\u65b0\u7684\u4e00\u884c $ sed '4 i 7) Adultry, Paulo Coelho, 324' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 7) Adultry, Paulo Coelho, 324 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u8f6c\u6362\u547d\u4ee4 y \u00b6 \u8f6c\u6362\uff08Translate\uff09\u547d\u4ee4 y \u662f\u552f\u4e00\u53ef\u4ee5\u5904\u7406\u5355\u4e2a\u5b57\u7b26\u7684sed\u7f16\u8f91\u5668\u547d\u4ee4\u3002\u8f6c\u6362\u547d\u4ee4\u683c\u5f0f \u5982\u4e0b [address]y/inchars/outchars/ \u8f6c\u6362\u547d\u4ee4\u4f1a\u5bf9inchars\u548coutchars\u503c\u8fdb\u884c\u4e00\u5bf9\u4e00\u7684\u6620\u5c04\u3002inchars\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4f1a\u88ab\u8f6c\u6362\u4e3aoutchars\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\uff0c\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4f1a\u88ab\u8f6c\u6362\u6210outchars\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u3002\u8fd9\u4e2a\u6620\u5c04\u8fc7\u7a0b\u4f1a\u4e00\u76f4\u6301\u7eed\u5230\u5904\u7406\u5b8c\u6307\u5b9a\u5b57\u7b26\u3002\u5982\u679cinchars\u548coutchars\u7684\u957f\u5ea6\u4e0d\u540c\uff0c\u5219sed\u7f16\u8f91\u5668\u4f1a\u4ea7\u751f\u4e00 \u6761\u9519\u8bef\u6d88\u606f\u3002 $ echo \"1 5 15 20\" | sed 'y/151520/IVXVXX/' I V IV XX \u8f93\u51fa\u9690\u85cf\u5b57\u7b26\u547d\u4ee4 l \u00b6 \u4f60\u80fd\u901a\u8fc7\u76f4\u63a5\u89c2\u5bdf\u533a\u5206\u51fa\u5355\u8bcd\u662f\u901a\u8fc7\u7a7a\u683c\u8fd8\u662ftab\u8fdb\u884c\u5206\u9694\u7684\u5417\uff1f\u663e\u7136\u662f\u4e0d\u80fd\u7684\uff0c\u4f46\u662fSED\u53ef\u4ee5\u4e3a\u4f60\u505a\u5230\u8fd9\u70b9\u3002\u4f7f\u7528 l \u547d\u4ee4\uff08\u82f1\u6587\u5b57\u6bcdL\u7684\u5c0f\u5199\uff09\u53ef\u4ee5\u663e\u793a\u6587\u672c\u4e2d\u7684\u9690\u85cf\u5b57\u7b26\uff08\u4f8b\u5982 \\t \u6216\u8005 $ \u5b57\u7b26\uff09\u3002 [address1[,address2]]l [address1[,address2]]l [len] \u4e3a\u4e86\u6d4b\u8bd5\u8be5\u547d\u4ee4\uff0c\u6211\u4eec\u9996\u5148\u5c06books.txt\u4e2d\u7684\u7a7a\u683c\u66ff\u6362\u4e3atab\u3002 $ sed 's/ /\\t/g' books.txt > junk.txt \u63a5\u4e0b\u6765\u6267\u884c l \u547d\u4ee4 $ sed -n 'l' junk.txt 1)\\tStorm\\tof\\tSwords,\\tGeorge\\tR.\\tR.\\tMartin,\\t1216\\t$ 2)\\tThe\\tTwo\\tTowers,\\tJ.\\tR.\\tR.\\tTolkien,\\t352\\t$ 3)\\tThe\\tAlchemist,\\tPaulo\\tCoelho,\\t197\\t$ 4)\\tThe\\tFellowship\\tof\\tthe\\tRing,\\tJ.\\tR.\\tR.\\tTolkien,\\t432\\t$ 5)\\tThe\\tPilgrimage,\\tPaulo\\tCoelho,\\t288\\t$ 6)\\tA\\tGame\\tof\\tThrones,\\tGeorge\\tR.\\tR.\\tMartin,\\t864$ \u4f7f\u7528 l \u547d\u4ee4\u7684\u65f6\u5019\uff0c\u4e00\u4e2a\u5f88\u6709\u8da3\u7684\u7279\u6027\u662f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u5b9e\u73b0\u6587\u672c\u6309\u7167\u6307\u5b9a\u7684\u5bbd\u5ea6\u6362\u884c\u3002 $ sed -n 'l 25' books.txt 1) Storm of Swords, Geor\\ ge R. R. Martin, 1216 $ 2) The Two Towers, J. R.\\ R. Tolkien, 352 $ 3) The Alchemist, Paulo \\ Coelho, 197 $ 4) The Fellowship of the\\ Ring, J. R. R. Tolkien,\\ 432 $ 5) The Pilgrimage, Paulo\\ Coelho, 288 $ 6) A Game of Thrones, Ge\\ orge R. R. Martin, 864$ \u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\u5728 l \u547d\u4ee4\u540e\u8ddf\u4e86\u4e00\u4e2a\u6570\u5b5725\uff0c\u5b83\u544a\u8bc9SED\u6309\u7167\u6bcf\u884c25\u4e2a\u5b57\u7b26\u8fdb\u884c\u6362\u884c\uff0c\u5982\u679c\u6307\u5b9a\u8fd9\u4e2a\u6570\u5b57\u4e3a0\u7684\u8bdd\uff0c\u5219\u53ea\u6709\u5728\u5b58\u5728\u6362\u884c\u7b26\u7684\u60c5\u51b5\u4e0b\u624d\u8fdb\u884c\u6362\u884c\u3002 l \u547d\u4ee4\u662fGNU-SED\u7684\u4e00\u90e8\u5206\uff0c\u5176\u5b83\u7684\u4e00\u4e9b\u53d8\u4f53\u4e2d\u53ef\u80fd\u65e0\u6cd5\u4f7f\u7528\u8be5\u547d\u4ee4\u3002 \u9000\u51fa\u547d\u4ee4 q \u00b6 \u5728SED\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 Quit \u547d\u4ee4\u9000\u51fa\u5f53\u524d\u7684\u6267\u884c\u6d41 [address]q [address]q [value] \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c q \u547d\u4ee4\u4e0d\u652f\u6301\u5730\u5740\u8303\u56f4\uff0c\u53ea\u652f\u6301\u5355\u4e2a\u5730\u5740\u5339\u914d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0bSED\u4f1a\u6309\u7167\u8bfb\u53d6\u3001\u6267\u884c\u3001\u91cd\u590d\u7684\u5de5\u4f5c\u6d41\u6267\u884c\uff0c\u4f46\u5f53\u5b83\u9047\u5230 q \u547d\u4ee4\u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u9000\u51fa\u5f53\u524d\u7684\u6267\u884c\u6d41\u3002 $ sed '3 q' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 $ sed '/The Alchemist/ q' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 q \u547d\u4ee4\u4e5f\u652f\u6301\u63d0\u4f9b\u4e00\u4e2avalue\uff0c\u8fd9\u4e2avalue\u5c06\u4f5c\u4e3a\u7a0b\u5e8f\u7684\u8fd4\u56de\u4ee3\u7801\u8fd4\u56de $ sed '/The Alchemist/ q 100' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 $ echo $? 100 \u6587\u4ef6\u8bfb\u53d6\u547d\u4ee4 r \u00b6 \u5728SED\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9SED\u4f7f\u7528Read\u547d\u4ee4\u4ece\u5916\u90e8\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5185\u5bb9\u5e76\u4e14\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u65f6\u5019\u663e\u793a\u51fa\u6765\u3002 [address]r file \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c r \u547d\u4ee4\u548c\u6587\u4ef6\u540d\u4e4b\u95f4\u5fc5\u987b\u53ea\u6709\u4e00\u4e2a\u7a7a\u683c\u3002 \u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u6253\u5f00 junk.txt \u6587\u4ef6\uff0c\u5c06\u5176\u5185\u5bb9\u63d2\u5165\u5230 books.txt \u6587\u4ef6\u7684\u7b2c\u4e09\u884c\u4e4b\u540e $ echo \"This is junk text.\" > junk.txt $ sed '3 r junk.txt' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 This is junk text. 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 r \u547d\u4ee4\u4e5f\u652f\u6301\u5730\u5740\u8303\u56f4\uff0c\u4f8b\u5982 3, 5 r junk.txt \u4f1a\u5728\u7b2c\u4e09\u884c\uff0c\u7b2c\u56db\u884c\uff0c\u7b2c\u4e94\u884c\u540e\u9762\u5206\u522b\u63d2\u5165 junk.txt \u7684\u5185\u5bb9 \u6267\u884c\u5916\u90e8\u547d\u4ee4 e \u00b6 \u5982\u679c\u4f60\u770b\u8fc7[\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK][]\u4e00\u6587\uff0c\u4f60\u53ef\u80fd\u5df2\u7ecf\u77e5\u9053\u4e86\u5728AWK\u4e2d\u53ef\u4ee5\u6267\u884c\u5916\u90e8\u7684\u547d\u4ee4\uff0c\u90a3\u4e48\u5728SED\u4e2d\u6211\u4eec\u662f\u5426\u4e5f\u53ef\u4ee5\u8fd9\u6837\u505a\uff1f \u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u5728SED\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 e \u547d\u4ee4\u6267\u884c\u5916\u90e8\u547d\u4ee4 [address1[,address2]]e [command] \u4e0b\u9762\u7684\u547d\u4ee4\u4f1a\u5728\u7b2c\u4e09\u884c\u4e4b\u524d\u6267\u884c date \u547d\u4ee4 $ sed '3 e date' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 2016\u5e7411\u670829\u65e5 \u661f\u671f\u4e8c 22\u65f646\u520614\u79d2 CST 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u53e6\u4e00\u4e2a\u793a\u4f8b $ sed '3,5 e who' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 mylxsw console Nov 29 19:30 mylxsw ttys000 Nov 29 22:45 3) The Alchemist, Paulo Coelho, 197 mylxsw console Nov 29 19:30 mylxsw ttys000 Nov 29 22:45 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 mylxsw console Nov 29 19:30 mylxsw ttys000 Nov 29 22:45 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u5982\u679c\u4f60\u4ed4\u7ec6\u89c2\u5bdf e \u547d\u4ee4\u7684\u8bed\u6cd5\uff0c\u4f60\u4f1a\u53d1\u73b0\u5176\u5b9e\u5b83\u7684 command \u53c2\u6570\u662f\u53ef\u9009\u7684\u3002\u5728\u6ca1\u6709\u63d0\u4f9b\u5916\u90e8\u547d\u4ee4\u7684\u65f6\u5019\uff0cSED\u4f1a\u5c06\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u4f5c\u4e3a\u8981\u6267\u884c\u7684\u547d\u4ee4\u3002 $ echo -e \"date\\ncal\\nuname\" > commands.txt $ cat commands.txt date cal uname $ sed 'e' commands.txt 2016\u5e7411\u670829\u65e5 \u661f\u671f\u4e8c 22\u65f650\u520630\u79d2 CST \u5341\u4e00\u6708 2016 \u65e5 \u4e00 \u4e8c \u4e09 \u56db \u4e94 \u516d 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 Darwin \u6392\u9664\u547d\u4ee4 ! \u00b6 \u611f\u53f9\u53f7\u547d\u4ee4\uff08 ! \uff09\u7528\u6765\u6392\u9664\u547d\u4ee4\uff0c\u4e5f\u5c31\u662f\u8ba9\u539f\u672c\u4f1a\u8d77\u4f5c\u7528\u7684\u547d\u4ee4\u4e0d\u8d77\u4f5c\u7528\u3002 $ sed -n '/Paulo/p' books.txt 3) The Alchemist, Paulo Coelho, 197 5) The Pilgrimage, Paulo Coelho, 288 $ sed -n '/Paulo/!p' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u5982\u4e0a\u4f8b\u6240\u793a\uff0c p \u547d\u4ee4\u539f\u5148\u662f\u53ea\u8f93\u51fa\u5339\u914d Paulo \u7684\u884c\uff0c\u6dfb\u52a0 ! \u4e4b\u540e\uff0c\u53d8\u6210\u4e86\u53ea\u8f93\u51fa\u4e0d\u5339\u914d Paulo \u7684\u884c\u3002 $ sed -n '1!G; h; $p' books.txt 6) A Game of Thrones, George R. R. Martin, 864 5) The Pilgrimage, Paulo Coelho, 288 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 3) The Alchemist, Paulo Coelho, 197 2) The Two Towers, J. R. R. Tolkien, 352 1) Storm of Swords, George R. R. Martin, 1216 \u4e0a\u9762\u7684\u547d\u4ee4\u5b9e\u73b0\u4e86\u7c7b\u4f3c tac \u547d\u4ee4\u7c7b\u4f3c\u7684\u8f93\u51fa\uff0c\u5c06\u6587\u672c\u5185\u5bb9\u5012\u5e8f\u8f93\u51fa\u3002\u770b\u8d77\u6765\u6709\u4e9b\u6666\u6da9\u96be\u61c2\uff0c\u5206\u89e3\u4e00\u4e0b\u5374\u5341\u5206\u7b80\u5355\uff1a 1!G \u8fd9\u53e5\u7684\u610f\u601d\u662f\u51fa\u4e86\u7b2c\u4e00\u884c\u4e4b\u5916\uff0c\u5904\u7406\u6bcf\u4e00\u884c\u7684\u65f6\u5019\u90fd\u5c06\u4fdd\u6301\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u8ffd\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4\uff08\u6b63\u5e8f->\u5012\u5e8f\uff09 h \u5c06\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u590d\u5236\u5230\u4fdd\u6301\u7a7a\u95f4\u4ee5\u5907\u4e0b\u4e00\u884c\u5339\u914d\u7684\u65f6\u5019\u8ffd\u52a0\u5230\u4e0b\u4e00\u884c\u7684\u540e\u9762 $p \u5982\u679c\u5339\u914d\u5230\u6700\u540e\u4e00\u884c\u7684\u8bdd\u5219\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9 \u4e0a\u8ff0\u6b65\u9aa4\u4e0d\u65ad\u91cd\u590d\u76f4\u5230\u6587\u672c\u7ed3\u675f\u521a\u597d\u5c06\u6587\u4ef6\u5185\u5bb9\u7ffb\u8f6c\u4e86\u4e00\u6b21 \u591a\u884c\u547d\u4ee4 \u00b6 \u5728\u4f7f\u7528sed\u7f16\u8f91\u5668\u7684\u57fa\u7840\u547d\u4ee4\u65f6\uff0c\u4f60\u53ef\u80fd\u6ce8\u610f\u5230\u4e86\u4e00\u4e2a\u5c40\u9650\u3002\u6240\u6709\u7684sed\u7f16\u8f91\u5668\u547d\u4ee4\u90fd\u662f\u9488\u5bf9 \u5355\u884c \u6570\u636e\u6267\u884c\u64cd\u4f5c\u7684\u3002\u5728sed\u7f16\u8f91\u5668\u8bfb\u53d6\u6570\u636e\u6d41\u65f6\uff0c\u5b83\u4f1a\u57fa\u4e8e \u6362\u884c\u7b26 \u7684\u4f4d\u7f6e\u5c06\u6570\u636e\u5206\u6210\u884c\u3002sed\u7f16\u8f91\u5668\u6839\u636e\u5b9a\u4e49\u597d\u7684\u811a\u672c\u547d\u4ee4\u4e00\u6b21\u5904\u7406\u4e00\u884c\u6570\u636e\uff0c\u7136\u540e\u79fb\u5230\u4e0b\u4e00\u884c\u91cd\u590d\u8fd9\u4e2a\u8fc7\u7a0b\u3002 \u5e78\u8fd0\u7684\u662f\uff0csed\u7f16\u8f91\u5668\u7684\u8bbe\u8ba1\u4eba\u5458\u5df2\u7ecf\u8003\u8651\u5230\u4e86\u8fd9\u79cd\u60c5\u51b5\uff0c\u5e76\u8bbe\u8ba1\u4e86\u5bf9\u5e94\u7684\u89e3\u51b3\u65b9\u6848\u3002sed\u7f16\u8f91\u5668\u5305\u542b\u4e86\u4e09\u4e2a\u53ef\u7528\u6765\u5904\u7406\u591a\u884c\u6587\u672c\u7684\u7279\u6b8a\u547d\u4ee4\u3002 N \uff1a\u5c06\u6570\u636e\u6d41\u4e2d\u7684\u4e0b\u4e00\u884c\u52a0\u8fdb\u6765\u521b\u5efa\u4e00\u4e2a\u591a\u884c\u7ec4\u6765\u5904\u7406 D \uff1a\u5220\u9664\u591a\u884c\u7ec4\u4e2d\u7684\u4e00\u884c P \uff1a\u6253\u5370\u591a\u884c\u7ec4\u4e2d\u7684\u4e00\u884c N - \u52a0\u8f7d\u4e0b\u4e00\u884c \u00b6 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u662f\u57fa\u4e8e\u5355\u884c\u8fdb\u884c\u64cd\u4f5c\u7684\uff0c\u6709\u4e9b\u60c5\u51b5\u4e0b\u6211\u4eec\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u591a\u884c\u8fdb\u884c\u7f16\u8f91\uff0c\u542f\u7528\u591a\u884c\u7f16\u8f91\u4f7f\u7528 N \u547d\u4ee4\uff0c\u4e0e n \u4e0d\u540c\u7684\u662f\uff0c N \u5e76\u4e0d\u4f1a\u6e05\u9664\u3001\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u7684\u5185\u5bb9\uff0c\u800c\u662f\u91c7\u7528\u4e86\u8ffd\u52a0\u6a21\u5f0f\u3002 [address1[,address2]]N \u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u4f1a\u628a books2.txt \u4e2d\u7684\u6807\u9898\u548c\u4f5c\u8005\u653e\u5230\u540c\u4e00\u884c\u5c55\u793a\uff0c\u5e76\u4e14\u4f7f\u7528\u9017\u53f7\u8fdb\u884c\u5206\u9694 $ sed 'N; s/\\n/,/g' books2.txt A Storm of Swords ,George R. R. Martin The Two Towers ,J. R. R. Tolkien The Alchemist ,Paulo Coelho The Fellowship of the Ring ,J. R. R. Tolkien The Pilgrimage ,Paulo Coelho A Game of Thrones ,George R. R. Martin D - \u5220\u9664\u591a\u884c\u4e2d\u7684\u4e00\u884c \u00b6 sed\u7f16\u8f91\u5668\u63d0\u4f9b\u4e86\u591a\u884c\u5220\u9664\u547d\u4ee4 D \uff0c\u5b83\u53ea\u5220\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u7b2c\u4e00\u884c\u3002\u8be5\u547d\u4ee4\u4f1a\u5220\u9664\u5230\u6362\u884c\u7b26\uff08\u542b \u6362\u884c\u7b26\uff09\u4e3a\u6b62\u7684\u6240\u6709\u5b57\u7b26\u3002 $ echo '\\nThis is the header line.\\nThis is a data line.\\n\\nThis is the last line.' | sed '/^$/{N; /header/D}' This is the header line. This is a data line. This is the last line. P - \u8f93\u51fa\u591a\u884c\u4e2d\u7684\u4e00\u884c \u00b6 P \u547d\u4ee4\u7528\u4e8e\u8f93\u51fa N \u547d\u4ee4\u521b\u5efa\u7684\u591a\u884c\u6587\u672c\u7684\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u7b2c\u4e00\u884c\u3002 [address1[,address2]]P \u4f8b\u5982\u4e0b\u9762\u7684\u547d\u4ee4\u53ea\u8f93\u51fa\u4e86\u56fe\u4e66\u7684\u6807\u9898 $ sed -n 'N;P' books2.txt A Storm of Swords The Two Towers The Alchemist The Fellowship of the Ring The Pilgrimage A Game of Thrones \u5176\u5b83\u547d\u4ee4 \u00b6 n - \u5355\u884cnext \u00b6 \u5c0f\u5199\u7684n\u547d\u4ee4\u4f1a\u544a\u8bc9sed\u7f16\u8f91\u5668\u79fb\u52a8\u5230\u6570\u636e\u6d41\u4e2d\u7684\u4e0b\u4e00\u6587\u672c\u884c\uff0c\u5e76\u4e14\u8986\u76d6\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u884c\u3002 $ cat data1.txt This is the header line. This is a data line. This is the last line. $ sed '/header/{n ; d}' data1.txt This is the header line. This is a data line. This is the last line. \u4e0a\u9762\u7684\u547d\u4ee4\u4e2d\uff0c\u9996\u5148\u4f1a\u5339\u914d\u5305\u542b header \u7684\u884c\uff0c\u4e4b\u540e\u5c06\u79fb\u52a8\u5230\u6570\u636e\u6d41\u7684\u4e0b\u4e00\u884c\uff0c\u8fd9\u91cc\u662f\u4e00\u4e2a\u7a7a\u884c\uff0c\u7136\u540e\u6267\u884c d \u547d\u4ee4\u5bf9\u6539\u884c\u8fdb\u884c\u5220\u9664\uff0c\u6240\u6709\u5c31\u770b\u5230\u4e86\u8fd9\u6837\u7684\u7ed3\u679c\uff1a\u7b2c\u4e00\u4e2a\u7a7a\u884c\u88ab\u5220\u9664\u6389\u4e86\u3002 v - SED\u7248\u672c\u68c0\u67e5 \u00b6 v \u547d\u4ee4\u7528\u4e8e\u68c0\u67e5SED\u7684\u7248\u672c\uff0c\u5982\u679c\u7248\u672c\u5927\u4e8e\u53c2\u6570\u4e2d\u7684\u7248\u672c\u5219\u6b63\u5e38\u6267\u884c\uff0c\u5426\u5219\u5931\u8d25 [address1[,address2]]v [version] \u4f8b\u5982 $ sed --version sed (GNU sed) 4.2.2 $ sed 'v 4.2.3' books.txt sed: -e expression #1, char 7: expected newer version of sed $ sed 'v 4.2.2' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u7279\u6b8a\u5b57\u7b26 \u00b6 \u5728SED\u4e2d\u63d0\u4f9b\u4e86\u4e24\u4e2a\u53ef\u4ee5\u7528\u4f5c\u547d\u4ee4\u7684\u7279\u6b8a\u5b57\u7b26\uff1a = \u548c & \u3002 = \u547d\u4ee4 \u00b6 = \u547d\u4ee4\u7528\u4e8e\u8f93\u51fa\u884c\u53f7\uff0c\u8bed\u6cd5\u683c\u5f0f\u4e3a [/pattern/]= [address1[,address2]]= \u4f8b\u5982\u4e3a\u6bcf\u4e00\u884c\u8f93\u51fa\u884c\u53f7 $ sed '=' books2.txt 1 A Storm of Swords 2 George R. R. Martin ... \u53ea\u4e3a1-4\u884c\u8f93\u51fa\u884c\u53f7 $ sed '1, 4=' books2.txt 1 A Storm of Swords 2 George R. R. Martin 3 The Two Towers 4 J. R. R. Tolkien The Alchemist Paulo Coelho The Fellowship of the Ring J. R. R. Tolkien The Pilgrimage Paulo Coelho A Game of Thrones George R. R. Martin \u5339\u914dPaulo\u7684\u884c\u8f93\u51fa\u884c\u53f7 $ sed '/Paulo/ =' books2.txt A Storm of Swords George R. R. Martin The Two Towers J. R. R. Tolkien The Alchemist 6 Paulo Coelho The Fellowship of the Ring J. R. R. Tolkien The Pilgrimage 10 Paulo Coelho A Game of Thrones George R. R. Martin \u6700\u540e\u4e00\u884c\u8f93\u51fa\u884c\u53f7\uff0c\u8fd9\u4e2a\u547d\u4ee4\u6bd4\u8f83\u6709\u610f\u601d\u4e86\uff0c\u53ef\u4ee5\u7528\u4e8e\u8f93\u51fa\u6587\u4ef6\u603b\u5171\u6709\u591a\u5c11\u884c $ sed -n '$ =' books2.txt 12 & \u547d\u4ee4 \u00b6 \u7279\u6b8a\u5b57\u7b26 & \u7528\u4e8e\u5b58\u50a8\u5339\u914d\u6a21\u5f0f\u7684\u5185\u5bb9\uff0c\u901a\u5e38\u4e0e\u66ff\u6362\u547d\u4ee4 s \u4e00\u8d77\u4f7f\u7528\u3002 $ sed 's/[[:digit:]]/Book number &/' books.txt Book number 1) Storm of Swords, George R. R. Martin, 1216 Book number 2) The Two Towers, J. R. R. Tolkien, 352 Book number 3) The Alchemist, Paulo Coelho, 197 Book number 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 Book number 5) The Pilgrimage, Paulo Coelho, 288 Book number 6) A Game of Thrones, George R. R. Martin, 864 \u4e0a\u8ff0\u547d\u4ee4\u7528\u4e8e\u5339\u914d\u6bcf\u4e00\u884c\u7b2c\u4e00\u4e2a\u6570\u5b57\uff0c\u5728\u5176\u524d\u9762\u6dfb\u52a0 Book number \u3002\u800c\u4e0b\u9762\u8fd9\u4e2a\u547d\u4ee4\u5219\u5339\u914d\u6700\u540e\u4e00\u4e2a\u6570\u5b57\uff0c\u5e76\u4fee\u6539\u4e3a Pages = \u3002\u5176\u4e2d [[:digit:]]* *$ \u53ef\u80fd\u6bd4\u8f83\u8d39\u89e3\uff0c\u8fd9\u4e00\u90e8\u5206\u5176\u5b9e\u662f\uff1a \u5339\u914d0\u4e2a\u6216\u591a\u4e2a\u6570\u5b57+0\u4e2a\u6216\u591a\u4e2a\u7a7a\u683c+\u884c\u5c3e \u3002 sed 's/[[:digit:]]* *$/Pages = &/' books.txt 1) Storm of Swords, George R. R. Martin, Pages = 1216 2) The Two Towers, J. R. R. Tolkien, Pages = 352 3) The Alchemist, Paulo Coelho, Pages = 197 4) The Fellowship of the Ring, J. R. R. Tolkien, Pages = 432 5) The Pilgrimage, Paulo Coelho, Pages = 288 6) A Game of Thrones, George R. R. Martin, Pages = 864 \u5b57\u7b26\u4e32 \u00b6 \u66ff\u6362\u547d\u4ee4 s \u00b6 \u6587\u672c\u66ff\u6362\u547d\u4ee4\u975e\u5e38\u5e38\u89c1\uff0c\u5176\u683c\u5f0f\u5982\u4e0b [address1[,address2]]s/pattern/replacement/[flags] \u5728\u524d\u9762\u6211\u4eec\u4f7f\u7528\u7684 books.txt \u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u9017\u53f7\u201c , \u201d\u5206\u9694\u6bcf\u4e00\u5217\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f1a\u4f7f\u7528\u66ff\u6362\u547d\u4ee4\u5c06\u5176\u66ff\u6362\u4e3a\u7ba1\u9053\u7b26\u201c | \u201d\uff1a $ sed 's/,/ |/' books.txt 1) Storm of Swords | George R. R. Martin, 1216 2) The Two Towers | J. R. R. Tolkien, 352 3) The Alchemist | Paulo Coelho, 197 4) The Fellowship of the Ring | J. R. R. Tolkien, 432 5) The Pilgrimage | Paulo Coelho, 288 6) A Game of Thrones | George R. R. Martin, 864 \u662f\u4e0d\u662f\u89c9\u5f97\u54ea\u91cc\u4e0d\u5bf9\uff1f\u76f8\u4fe1\u4f60\u5df2\u7ecf\u53d1\u73b0\uff0c\u6bcf\u4e00\u884c\u7684\u7b2c\u4e8c\u4e2a\u9017\u53f7\u90fd\u6ca1\u6709\u88ab\u66ff\u6362\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2a\u88ab\u66ff\u6362\u4e86\uff0c\u786e\u5b9e\u5982\u6b64\uff0c\u5728SED\u4e2d\uff0c\u4f7f\u7528\u66ff\u6362\u547d\u4ee4\u7684\u65f6\u5019\u9ed8\u8ba4\u53ea\u4f1a\u5bf9\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u4f4d\u7f6e\u8fdb\u884c\u66ff\u6362\u3002\u4f7f\u7528 g \u9009\u9879\u544a\u8bc9SED\u5bf9\u6240\u6709\u5185\u5bb9\u8fdb\u884c\u66ff\u6362\uff1a $ sed 's/,/ | /g' books.txt 1) Storm of Swords | George R. R. Martin | 1216 2) The Two Towers | J. R. R. Tolkien | 352 3) The Alchemist | Paulo Coelho | 197 4) The Fellowship of the Ring | J. R. R. Tolkien | 432 5) The Pilgrimage | Paulo Coelho | 288 6) A Game of Thrones | George R. R. Martin | 864 \u5982\u679c\u5bf9\u5339\u914d\u6a21\u5f0f\uff08\u6216\u5730\u5740\u8303\u56f4\uff09\u7684\u884c\u8fdb\u884c\u66ff\u6362\uff0c\u5219\u53ea\u9700\u8981\u5728 s \u547d\u4ee4\u524d\u6dfb\u52a0\u5730\u5740\u5373\u53ef\u3002\u6bd4\u5982\u53ea\u66ff\u6362\u5339\u914d The Pilgrimage \u7684\u884c\uff1a sed '/The Pilgrimage/ s/,/ | /g' books.txt \u8fd8\u6709\u4e00\u4e9b\u5176\u5b83\u7684\u9009\u9879\uff0c\u8fd9\u91cc\u5c31\u7b80\u5355\u7684\u63cf\u8ff0\u4e00\u4e0b\uff0c\u4e0d\u5728\u5c55\u5f00\u8bb2\u89e3 \u6570\u5b57n : \u53ea\u66ff\u6362\u7b2cn\u6b21\u5339\u914d\uff0c\u6bd4\u5982 sed 's/,/ | /2' books.txt \uff0c\u53ea\u66ff\u6362\u6bcf\u884c\u4e2d\u7b2c\u4e8c\u4e2a\u9017\u53f7 p \uff1a\u53ea\u8f93\u51fa\u6539\u53d8\u7684\u884c\uff0c\u6bd4\u5982 sed -n 's/Paulo Coelho/PAULO COELHO/p' books.txt w \uff1a\u5b58\u50a8\u6539\u53d8\u7684\u884c\u5230\u6587\u4ef6\uff0c\u6bd4\u5982 sed -n 's/Paulo Coelho/PAULO COELHO/w junk.txt' books.txt i \uff1a\u5339\u914d\u65f6\u5ffd\u7565\u5927\u5c0f\u5199\uff0c\u6bd4\u5982 sed -n 's/pAuLo CoElHo/PAULO COELHO/pi' books.txt \u5728\u6267\u884c\u66ff\u6362\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u5982\u679c\u8981\u66ff\u6362\u7684\u5185\u5bb9\u4e2d\u5305\u542b / \uff0c\u8fd9\u4e2a\u65f6\u5019\u600e\u4e48\u529e\uff1f\u5f88\u7b80\u5355\uff0c\u6dfb\u52a0\u8f6c\u4e49\u64cd\u4f5c\u7b26\u3002 $ echo \"/bin/sed\" | sed 's/\\/bin\\/sed/\\/home\\/mylxsw\\/src\\/sed\\/sed-4.2.2\\/sed/' /home/mylxsw/src/sed/sed-4.2.2/sed \u4e0a\u9762\u7684\u547d\u4ee4\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 \\ \u5bf9 / \u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u4e0d\u8fc7\u8868\u8fbe\u5f0f\u5df2\u7ecf\u770b\u8d77\u6765\u975e\u5e38\u96be\u770b\u4e86\uff0c\u5728SED\u4e2d\u8fd8\u53ef\u4ee5\u4f7f\u7528 | \uff0c @ \uff0c ^ \uff0c ! \u4f5c\u4e3a\u547d\u4ee4\u7684\u5206\u9694\u7b26\uff0c\u6240\u4ee5\uff0c\u4e0b\u9762\u7684\u51e0\u4e2a\u547d\u4ee4\u548c\u4e0a\u9762\u7684\u662f\u7b49\u4ef7\u7684 echo \"/bin/sed\" | sed 's|/bin/sed|/mylxsw/mylxsw/src/sed/sed-4.2.2/sed|' echo \"/bin/sed\" | sed 's@/bin/sed@/home/mylxsw/src/sed/sed-4.2.2/sed@' echo \"/bin/sed\" | sed 's^/bin/sed^/home/mylxsw/src/sed/sed-4.2.2/sed^' echo \"/bin/sed\" | sed 's!/bin/sed!/home/mylxsw/src/sed/sed-4.2.2/sed!' \u5339\u914d\u5b50\u5b57\u7b26\u4e32 \u00b6 \u524d\u9762\u6211\u4eec\u5b66\u4e60\u4e86\u66ff\u6362\u547d\u4ee4\u7684\u7528\u6cd5\uff0c\u73b0\u5728\u8ba9\u6211\u4eec\u770b\u770b\u5982\u4f55\u83b7\u53d6\u5339\u914d\u6587\u672c\u4e2d\u7684\u67d0\u4e2a\u5b50\u4e32\u3002 \u5728SED\u4e2d\uff0c\u4f7f\u7528 \\( \u548c \\) \u5bf9\u5339\u914d\u7684\u5185\u5bb9\u8fdb\u884c\u5206\u7ec4\uff0c\u4f7f\u7528 \\N \u7684\u65b9\u5f0f\u8fdb\u884c\u5f15\u7528\u3002\u8bf7\u770b\u4e0b\u9762\u793a\u4f8b $ echo \"Three One Two\" | sed 's|\\(\\w\\+\\) \\(\\w\\+\\) \\(\\w\\+\\)|\\2 \\3 \\1|' One Two Three \u6211\u4eec\u8f93\u51fa\u4e86 Three \uff0c One \uff0c Two \u4e09\u4e2a\u5355\u8bcd\uff0c\u5728SED\u7684\u66ff\u6362\u89c4\u5219\u4e2d\uff0c\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u4e86\u4e09\u5c0f\u6bb5\u6b63\u5219\u8868\u8fbe\u5f0f \\(\\w\\+\\) \u6765\u5339\u914d\u6bcf\u4e00\u4e2a\u5355\u8bcd\uff0c\u540e\u9762\u4f7f\u7528 \\1 \uff0c\uff0c \\2 \uff0c \\3 \u5206\u522b\u5f15\u7528\u5b83\u4eec\u7684\u503c\u3002 \u7ba1\u7406\u6a21\u5f0f \u00b6 \u524d\u9762\u5df2\u7ecf\u8bb2\u89e3\u8fc7\u6a21\u5f0f\u7a7a\u95f4\u548c \u4fdd\u6301\u7a7a\u95f4 \u7684\u7528\u6cd5\uff0c\u5728\u672c\u8282\u4e2d\u6211\u4eec\u5c06\u4f1a\u7ee7\u7eed\u63a2\u7d22\u5b83\u4eec\u7684\u7528\u6cd5\u3002 \u672c\u90e8\u5206\u5185\u5bb9\u6682\u672a\u66f4\u65b0\uff0c\u8bf7\u5173\u6ce8 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6211\u5c06\u6700\u5148\u5728Github\u7684\u8fd9\u4e2a\u4ed3\u5e93\u4e2d\u66f4\u65b0\u6700\u65b0\u5185\u5bb9\u3002 \u6b63\u5219\u8868\u8fbe\u5f0f \u00b6 \u8fd9\u4e00\u90e8\u5206\u5c31\u662f\u6807\u51c6\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u4ee5\u5143\u5b57\u7b26\uff0c\u6bd4\u8f83\u719f\u6089\u7684\u8bf7\u7565\u8fc7\u3002 \u6807\u51c6\u6b63\u5219\u8868\u8fbe\u5f0f \u00b6 ^ \u00b6 \u5339\u914d\u884c\u7684\u5f00\u59cb\u3002 $ sed -n '/^The/ p' books2.txt The Two Towers, J. R. R. Tolkien The Alchemist, Paulo Coelho The Fellowship of the Ring, J. R. R. Tolkien The Pilgrimage, Paulo Coelho $ \u00b6 \u5339\u914d\u884c\u7684\u7ed3\u5c3e $ sed -n '/Coelho$/ p' books2.txt The Alchemist, Paulo Coelho The Pilgrimage, Paulo Coelho . \u00b6 \u5339\u914d\u5355\u4e2a\u5b57\u7b26\uff08\u9664\u884c\u5c3e\uff09 $ echo -e \"cat\\nbat\\nrat\\nmat\\nbatting\\nrats\\nmats\" | sed -n '/^..t$/p' cat bat rat mat [] \u00b6 \u5339\u914d\u5b57\u7b26\u96c6 $ echo -e \"Call\\nTall\\nBall\" | sed -n '/[CT]all/ p' Call Tall [\\^] \u00b6 \u6392\u9664\u5b57\u7b26\u96c6 $ echo -e \"Call\\nTall\\nBall\" | sed -n '/[^CT]all/ p' Ball [-] \u00b6 \u5b57\u7b26\u8303\u56f4\u3002 $ echo -e \"Call\\nTall\\nBall\" | sed -n '/[C-Z]all/ p' Call Tall \\? \uff0c \\+ \uff0c* \u00b6 \u5206\u522b\u5bf9\u5e940\u6b21\u52301\u6b21\uff0c\u4e00\u6b21\u5230\u591a\u6b21\uff0c0\u6b21\u5230\u591a\u6b21\u5339\u914d\u3002 {n} \uff0c {n,} \uff0c {m, n} \u00b6 \u7cbe\u786e\u5339\u914dN\u6b21\uff0c\u81f3\u5c11\u5339\u914dN\u6b21\uff0c\u5339\u914dM-N\u6b21 | \u00b6 \u6216\u64cd\u4f5c\u3002 $ echo -e \"str1\\nstr2\\nstr3\\nstr4\" | sed -n '/str\\(1\\|3\\)/ p' str1 str3 POSIX\u517c\u5bb9\u7684\u6b63\u5219 \u00b6 \u4e3b\u8981\u5305\u542b [:alnum:] \uff0c [:alpha:] \uff0c [:blank:] \uff0c [:digit:] \uff0c [:lower:] \uff0c [:upper:] \uff0c [:punct:] \uff0c [:space:] \uff0c\u8fd9\u4e9b\u57fa\u672c\u90fd\u89c1\u540d\u4e4b\u610f\uff0c\u4e0d\u5728\u8d58\u8ff0\u3002 \u5143\u5b57\u7b26 \u00b6 \\s \u00b6 \u5339\u914d\u5355\u4e2a\u7a7a\u767d\u5185\u5bb9 $ echo -e \"Line\\t1\\nLine2\" | sed -n '/Line\\s/ p' Line 1 \\S \u00b6 \u5339\u914d\u5355\u4e2a\u975e\u7a7a\u767d\u5185\u5bb9\u3002 \\w \uff0c \\W \u00b6 \u5355\u4e2a\u5355\u8bcd\u3001\u975e\u5355\u8bcd\u3002 \u5e38\u7528\u4ee3\u7801\u6bb5 \u00b6 Cat\u547d\u4ee4 \u00b6 \u6a21\u62df cat \u547d\u4ee4\u6bd4\u8f83\u7b80\u5355\uff0c\u6709\u4e0b\u9762\u4e24\u79cd\u65b9\u5f0f $ sed '' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 $ sed -n 'p' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u79fb\u9664\u7a7a\u884c \u00b6 $ echo -e \"Line #1\\n\\n\\nLine #2\" | sed '/^$/d' Line #1 Line #2 \u5220\u9664\u8fde\u7eed\u7a7a\u884c \u00b6 $ echo -e \"Line #1\\n\\n\\nLine #2\" | sed '/./,/^$/!d' Line #1 Line #2 \u5220\u9664\u5f00\u5934\u7684\u7a7a\u884c \u00b6 $ echo -e \"\\nLine #1\\n\\nLine #2\" | sed '/./,$!d' Line #1 Line #2 \u5220\u9664\u7ed3\u5c3e\u7684\u7a7a\u884c \u00b6 $ echo -e \"\\nLine #1\\nLine #2\\n\\n\" | sed ':start /^\\n*$/{$d; N; b start }' Line #1 Line #2 \u8fc7\u6ee4\u6240\u6709\u7684html\u6807\u7b7e \u00b6 $ cat html.txt <html> <head> <title>This is the page title</title> </head> <body> <p> This is the <b>first</b> line in the Web page. This should provide some <i>useful</i> information to use in our sed script. </body> </html> $ sed 's/<[^>]*>//g ; /^$/d' html.txt This is the page title This is the first line in the Web page. This should provide some useful information to use in our sed script. \u4eceC++\u7a0b\u5e8f\u4e2d\u79fb\u9664\u6ce8\u91ca \u00b6 \u6709\u4e0b\u9762\u8fd9\u6837\u4e00\u4e2acpp\u6587\u4ef6 $ cat hello.cpp #include <iostream> using namespace std; int main(void) { // Displays message on stdout. cout >> \"Hello, World !!!\" >> endl; return 0; // Return success. } \u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u79fb\u9664\u6ce8\u91ca $ sed 's|//.*||g' hello.cpp #include <iostream> using namespace std; int main(void) { cout >> \"Hello, World !!!\" >> endl; return 0; } \u4e3a\u67d0\u4e9b\u884c\u6dfb\u52a0\u6ce8\u91ca \u00b6 $ sed '3,5 s/^/#/' hello.sh #!/bin/bash #pwd #hostname #uname -a who who -r lsb_release -a \u5b9e\u73b0 Wc -l \u547d\u4ee4 \u00b6 wc -l \u547d\u4ee4\u7528\u4e8e\u7edf\u8ba1\u6587\u4ef6\u4e2d\u7684\u884c\u6570\uff0c\u4f7f\u7528SED\u4e5f\u53ef\u4ee5\u6a21\u62df\u8be5\u547d\u4ee4 $ wc -l hello.cpp 9 hello.cpp $ sed -n '$ =' hello.cpp 9 \u6a21\u62df\u5b9e\u73b0 head \u547d\u4ee4 \u00b6 head \u547d\u4ee4\u7528\u4e8e\u8f93\u51fa\u6587\u4ef6\u4e2d\u7684\u524d10\u884c\u5185\u5bb9\u3002 $ head books2.txt A Storm of Swords George R. R. Martin The Two Towers J. R. R. Tolkien The Alchemist Paulo Coelho The Fellowship of the Ring J. R. R. Tolkien The Pilgrimage Paulo Coelho \u4f7f\u7528SED\u4e2d\u7684 sed '10 q' \u53ef\u4ee5\u6a21\u62df\u5b83\u7684\u5b9e\u73b0 $ sed '10 q' books.txt A Storm of Swords George R. R. Martin The Two Towers J. R. R. Tolkien The Alchemist Paulo Coelho The Fellowship of the Ring J. R. R. Tolkien The Pilgrimage Paulo Coelho \u6a21\u62df tail -1 \u547d\u4ee4 \u00b6 tail -1 \u8f93\u51fa\u6587\u4ef6\u7684\u6700\u540e\u4e00\u884c\u3002 $ cat test.txt Line #1 Line #2 $ tail -1 test.txt Line #2 $ sed $ sed -n '$p' test.txt Line #2 \u6a21\u62df Dos2unix \u547d\u4ee4 \u00b6 \u5728DOS\u73af\u5883\u4e2d\uff0c\u6362\u884c\u7b26\u662f\u4f7f\u7528 CR/LF \u4e24\u4e2a\u5b57\u7b26\u4e00\u8d77\u8868\u793a\u7684\uff0c\u4e0b\u9762\u547d\u4ee4\u6a21\u62df\u4e86 dos2unix \u547d\u4ee4\u8f6c\u6362\u8fd9\u4e9b\u6362\u884c\u7b26\u4e3aUNIX\u6362\u884c\u7b26\u3002 \u5728GNU/Linux\u73af\u5883\u4e2d\uff0c CR/LF \u901a\u5e38\u4f7f\u7528\"\\^M\"\uff08\u4e0d\u662f\u7b80\u5355\u7684\u4e24\u4e2a\u7b26\u53f7\u7ec4\u5408\uff0c\u8bf7\u4f7f\u7528\u5feb\u6377\u952eCtrl+v,Ctrl+m\u8f93\u5165\uff09\u8fdb\u884c\u8868\u793a\u3002 $ echo -e \"Line #1\\r\\nLine #2\\r\" > test.txt $ file test.txt test.txt: ASCII text, with CRLF line terminators $ sed 's/^M$//' test.txt > new.txt $ file new.txt new.txt: ASCII text $ cat -vte new.txt Line #1$ Line #2$ \u6a21\u62df Unix2dos \u547d\u4ee4 \u00b6 $ file new.txt new.txt: ASCII text $ sed 's/$/\\r/' new.txt > new2.txt $ file new2.txt new2.txt: ASCII text, with CRLF line terminators $ cat -vte new2.txt Line #1^M$ Line #2^M$ \u6a21\u62df cat -E \u547d\u4ee4 \u00b6 cat -E \u547d\u4ee4\u4f1a\u5728\u6bcf\u4e00\u884c\u7684\u884c\u5c3e\u8f93\u51fa\u4e00\u4e2a $ \u7b26\u53f7\u3002 $ echo -e \"Line #1\\nLine #2\" | cat -E Line #1$ Line #2$ $ echo -e \"Line #1\\nLine #2\" | sed 's|$|&$|' Line #1$ Line #2$ \u6ce8\u610f\uff0c\u5728Mac\u4e0b\u4e0d\u652f\u6301 cat -E \uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528sed\u4ee3\u66ff \u6a21\u62df cat -ET \u547d\u4ee4 \u00b6 cat -ET \u547d\u4ee4\u4e0d\u4ec5\u5bf9\u6bcf\u4e00\u884c\u7684\u884c\u5c3e\u6dfb\u52a0 $ \uff0c\u8fd8\u4f1a\u5c06\u6bcf\u4e00\u884c\u4e2d\u7684TAB\u663e\u793a\u4e3a ^I \u3002 $ echo -e \"Line #1\\tLine #2\" | cat -ET Line #1^ILine #2$ $ echo -e \"Line #1\\tLine #2\" | sed -n 'l' | sed 'y/\\\\t/^I/' Line #1^ILine #2$ \u6a21\u62df nl \u547d\u4ee4 \u00b6 \u547d\u4ee4 nl \u53ef\u4ee5\u4e3a\u8f93\u5165\u5185\u5bb9\u7684\u6bcf\u4e00\u884c\u6dfb\u52a0\u884c\u53f7\uff0c\u8bb0\u5f97\u4e4b\u524d\u4ecb\u7ecd\u7684 = \u64cd\u4f5c\u7b26\u5427\uff0c\u5728SED\u4e2d\u6211\u4eec\u53ef\u4ee5\u7528\u5b83\u6765\u5b9e\u73b0\u4e0e nl \u547d\u4ee4\u7c7b\u4f3c\u7684\u529f\u80fd\u3002 $ echo -e \"Line #1\\nLine #2\" |nl 1 Line #1 2 Line #2 $ echo -e \"Line #1\\nLine #2\" | sed = | sed 'N;s/\\n/\\t/' 1 Line #1 2 Line #2 \u4e0a\u9762\u7684SED\u547d\u4ee4\u4f7f\u7528\u4e86\u4e24\u6b21\uff0c\u7b2c\u4e00\u6b21\u4f7f\u7528 = \u64cd\u4f5c\u7b26\u4e3a\u6bcf\u4e00\u884c\u8f93\u51fa\u884c\u53f7\uff0c\u6ce8\u610f\u8fd9\u4e2a\u884c\u53f7\u662f\u72ec\u5360\u4e00\u884c\u7684\uff0c\u56e0\u6b64\u4f7f\u7528\u7ba1\u9053\u7b26\u8fde\u63a5\u4e86\u7b2c\u4e8c\u4e2aSED\u547d\u4ee4\uff0c\u6bcf\u6b21\u8bfb\u53d6\u4e24\u884c\uff0c\u5c06\u6362\u884c\u7b26\u66ff\u6362\u4e3aTab\uff0c\u8fd9\u6837\u5c31\u6a21\u62df\u51fa\u4e86 nl \u547d\u4ee4\u7684\u6548\u679c\u3002 \u6a21\u62df cp \u547d\u4ee4 \u00b6 $ sed -n 'w dup.txt' data.txt $ diff data.txt dup.txt $ echo $? 0 \u6a21\u62df expand \u547d\u4ee4 \u00b6 expand \u547d\u4ee4\u4f1a\u8f6c\u6362\u8f93\u5165\u4e2d\u7684TAB\u4e3a\u7a7a\u683c\uff0c\u5728SED\u4e2d\u4e5f\u53ef\u4ee5\u6a21\u62df\u5b83 $ echo -e \"One\\tTwo\\tThree\" > test.txt $ expand test.txt > expand.txt $ sed 's/\\t/ /g' test.txt > new.txt $ diff new.txt expand.txt $ echo $? 0 \u6a21\u62df tee \u547d\u4ee4 \u00b6 tee \u547d\u4ee4\u4f1a\u5c06\u6570\u636e\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u7684\u540c\u65f6\u5199\u5165\u6587\u4ef6\u3002 $ echo -e \"Line #1\\nLine #2\" | tee test.txt Line #1 Line #2 \u5728SED\u4e2d\uff0c\u5b9e\u73b0\u8be5\u547d\u4ee4\u975e\u5e38\u7b80\u5355 $ sed -n 'p; w new.txt' test.txt One Two Three \u6a21\u62df cat -s \u547d\u4ee4 \u00b6 cat -s \u547d\u4ee4\u4f1a\u5c06\u8f93\u5165\u6587\u4ef6\u4e2d\u7684\u591a\u884c\u7a7a\u884c\u5408\u5e76\u4e3a\u4e00\u884c\u3002 $ echo -e \"Line #1\\n\\n\\n\\nLine #2\\n\\n\\nLine #3\" | cat -s Line #1 Line #2 Line #3 \u5728SED\u4e2d\u5b9e\u73b0 $ echo -e \"Line #1\\n\\n\\n\\nLine #2\\n\\n\\nLine #3\" | sed '1s/^$//p;/./,/^$/!d' Line #1 Line #2 Line #3 \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f /./,/^$/!d \u8fd9\u4e2a\u547d\u4ee4\uff0c\u5b83\u7684\u610f\u601d\u662f\u5339\u914d\u533a\u95f4 /./ \u5230 /^$ \uff0c\u533a\u95f4\u7684\u5f00\u59cb\u4f1a\u5339\u914d\u81f3\u5c11\u5305\u542b\u4e00\u4e2a\u5b57\u7b26\u7684\u884c\uff0c\u7ed3\u675f\u4f1a\u5339\u914d\u4e00\u4e2a\u7a7a\u884c\uff0c\u5728\u8fd9\u4e2a\u533a\u95f4\u4e2d\u7684\u884c\u4e0d\u4f1a\u88ab\u5220\u9664\u3002 \u6a21\u62df grep \u547d\u4ee4 \u00b6 $ echo -e \"Line #1\\nLine #2\\nLine #3\" | grep 'Line #1' Line #1 $ echo -e \"Line #1\\nLine #2\\nLine #3\" | sed -n '/Line #1/p' Line #1 \u6a21\u62df grep -v \u547d\u4ee4 \u00b6 $ echo -e \"Line #1\\nLine #2\\nLine #3\" | grep -v 'Line #1' Line #2 Line #3 $ echo -e \"Line #1\\nLine #2\\nLine #3\" | sed -n '/Line #1/!p' Line #2 Line #3 \u6a21\u62df tr \u547d\u4ee4 \u00b6 tr \u547d\u4ee4\u7528\u4e8e\u5b57\u7b26\u8f6c\u6362 $ echo \"ABC\" | tr \"ABC\" \"abc\" abc $ echo \"ABC\" | sed 'y/ABC/abc/' abc \u5199\u5728\u6700\u540e \u00b6 \u770b\u5230\u8fd9\u91cc\uff0c\u4f60\u80af\u5b9a\u8981\u5410\u69fd\u4e86\uff0c\u4e0d\u662f\u8bf4\u4e86\u4e09\u5341\u5206\u949f\u5b66\u4f1a\u5417\uff1f\u4f60\u786e\u5b9a\u4f60\u80fd\u4e09\u5341\u5206\u949f\u5b66\u4f1a\uff1f\u4e0a\u6b21\u7684[\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK][]\u8bf4\u4e09\u5341\u5206\u949f\u5b66\u4f1a\u4e0d\u9760\u8c31\uff0c\u8fd9\u6b21\u53c8\u4e0d\u9760\u8c31\u4e86\u3002\u4e0d\u597d\u610f\u601d\uff0c\u8fd9\u91cc\u7684\u4e09\u5341\u5206\u949f\u5176\u5b9e\u53ea\u662f\u4e3a\u4e86\u5438\u5f15\u4f60\u7684\u6ce8\u610f\u800c\u5df2\uff0c\u53ea\u6709\u5728\u4f60\u5df2\u7ecf\u7528\u8fc7SED\u5e76\u5bf9\u5b83\u7684\u4e00\u4e9b\u7279\u6027\u6709\u6240\u4e86\u89e3\u7684\u60c5\u51b5\u4e0b\u4e09\u5341\u5206\u949f\u770b\u5b8c\u624d\u662f\u6709\u53ef\u80fd\u7684\uff0c\u6bd5\u7adf\u90a3\u4e48\u591a\u7279\u6b8a\u5b57\u7b26\uff0c\u90a3\u4e48\u591a\u547d\u4ee4\u9700\u8981\u8bb0\u4f4f\u3002\u4e0d\u8fc7\u8bdd\u8bf4\u56de\u6765\uff0c\u770b\u5b8c\u4e4b\u540e\u4f60\u6709\u6536\u83b7\u5417\uff1f\u6709\u7684\u8bdd\uff0c\u90a3\u672c\u6587\u7684\u76ee\u7684\u5c31\u8fbe\u5230\u4e86\uff0c\u4e4b\u540e\u7528\u5230SED\u7684\u65f6\u5019\u518d\u56de\u6765\u53c2\u8003\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002 \u672c\u6587\u5c06\u4f1a\u6301\u7eed\u4fee\u6b63\u548c\u66f4\u65b0\uff0c\u6700\u65b0\u5185\u5bb9\u8bf7\u53c2\u8003\u6211\u7684 GITHUB \u4e0a\u7684 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6b22\u8fce Star\u3002 \u53c2\u8003 \u00b6 Sed Tutorial Linux\u547d\u4ee4\u884c\u4e0eshell\u811a\u672c\u7f16\u7a0b\u5927\u5168\uff08\u7b2c3\u7248\uff09","title":"sed"},{"location":"sed/#sed","text":"\u539f\u6587 \u672c\u6587\u627f\u63a5\u4e4b\u524d\u5199\u7684[\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK][]\u4e00\u6587\uff0c\u5728\u5b66\u4e60\u5b8cAWK\u4e4b\u540e\uff0c\u8d81\u70ed\u6253\u94c1\u53c8\u5b66\u4e60\u4e86\u4e00\u4e0bSED\uff0c\u4e0d\u5f97\u4e0d\u8bf4\u8fd9\u4e24\u4e2a\u5de5\u5177\u771f\u7684\u582a\u79f0\u6587\u672c\u5904\u7406\u795e\u5668\uff0c\u8c01\u7528\u8c01\u77e5\u9053\uff01\u672c\u6587\u5927\u90e8\u5206\u5185\u5bb9\u4f9d\u65e7\u662f\u7ffb\u8bd1\u81eaTutorialspoint\u4e0a\u7684\u5165\u95e8\u6559\u7a0b\uff0c\u8fd9\u6b21\u662f Sed Tutorial \u4e00\u6587\uff0c\u5185\u5bb9\u505a\u4e86\u4e00\u4e9b\u5220\u51cf\u548c\u8865\u5145\uff0c\u589e\u52a0\u4e86\u4e00\u4e9b\u539f\u6587\u4e2d\u6ca1\u6709\u63d0\u53ca\u5230\u7684\u8bed\u6cd5\u548c\u547d\u4ee4\u7684\u8bb2\u89e3\uff0c\u5e76\u4e14\u5bf9\u539f\u6587\u6240\u6709\u7684\u793a\u4f8b\u90fd\u4e00\u4e00\u8fdb\u884c\u4e86\u9a8c\u8bc1\uff0c\u5e0c\u671b\u672c\u6587\u5bf9\u5927\u5bb6\u5b66\u4e60\u548c\u4e86\u89e3Sed\u6709\u6240\u5e2e\u52a9\u3002 \u6587\u4e2d\u7528\u5230\u7684\u6d4b\u8bd5\u6587\u4ef6\u53ef\u4ee5\u5728 https://github.com/mylxsw/sed-demo \u627e\u5230\u3002 \u672c\u6587\u5c06\u4f1a\u6301\u7eed\u4fee\u6b63\u548c\u66f4\u65b0\uff0c\u6700\u65b0\u5185\u5bb9\u8bf7\u53c2\u8003\u6211\u7684 GITHUB \u4e0a\u7684 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6b22\u8fce Star\u3002 \u4e09\u5341\u5206\u949f\u5b66\u4f1aSED \u6982\u8ff0 SED\u7684\u5178\u578b\u7528\u9014 \u5de5\u4f5c\u6d41 \u9700\u8981\u6ce8\u610f\u7684\u51e0\u70b9 \u793a\u4f8b \u57fa\u7840\u8bed\u6cd5 \u6807\u51c6\u9009\u9879 GNU\u9009\u9879 \u5faa\u73af \u5206\u652f \u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4 \u6a21\u5f0f\u7a7a\u95f4 \u884c\u5bfb\u5740 \u6570\u5b57\u65b9\u5f0f\u7684\u884c\u5bfb\u5740 \u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u8fc7\u6ee4\u5668 \u4fdd\u6301\u7a7a\u95f4 \u57fa\u672c\u547d\u4ee4 \u5220\u9664\u547d\u4ee4 d \u6587\u4ef6\u5199\u5165\u547d\u4ee4 w \u8ffd\u52a0\u547d\u4ee4 a \u884c\u66ff\u6362\u547d\u4ee4 c \u63d2\u5165\u547d\u4ee4 i \u8f6c\u6362\u547d\u4ee4 y \u8f93\u51fa\u9690\u85cf\u5b57\u7b26\u547d\u4ee4 l \u9000\u51fa\u547d\u4ee4 q \u6587\u4ef6\u8bfb\u53d6\u547d\u4ee4 r \u6267\u884c\u5916\u90e8\u547d\u4ee4 e \u6392\u9664\u547d\u4ee4 ! \u591a\u884c\u547d\u4ee4 N - \u52a0\u8f7d\u4e0b\u4e00\u884c D - \u5220\u9664\u591a\u884c\u4e2d\u7684\u4e00\u884c P - \u8f93\u51fa\u591a\u884c\u4e2d\u7684\u4e00\u884c \u5176\u5b83\u547d\u4ee4 n - \u5355\u884cnext v - SED\u7248\u672c\u68c0\u67e5 \u7279\u6b8a\u5b57\u7b26 =\u547d\u4ee4 &\u547d\u4ee4 \u5b57\u7b26\u4e32 \u66ff\u6362\u547d\u4ee4 s \u5339\u914d\u5b50\u5b57\u7b26\u4e32 \u7ba1\u7406\u6a21\u5f0f \u6b63\u5219\u8868\u8fbe\u5f0f \u6807\u51c6\u6b63\u5219\u8868\u8fbe\u5f0f ^ $ . [] [\\^] [-] \\? \uff0c\\+ \uff0c* {n} \uff0c{n,} \uff0c{m, n} | POSIX\u517c\u5bb9\u7684\u6b63\u5219 \u5143\u5b57\u7b26 \\s \\S \\w \uff0c \\W \u5e38\u7528\u4ee3\u7801\u6bb5 Cat\u547d\u4ee4 \u79fb\u9664\u7a7a\u884c \u5220\u9664\u8fde\u7eed\u7a7a\u884c \u5220\u9664\u5f00\u5934\u7684\u7a7a\u884c \u5220\u9664\u7ed3\u5c3e\u7684\u7a7a\u884c \u8fc7\u6ee4\u6240\u6709\u7684html\u6807\u7b7e \u4eceC++\u7a0b\u5e8f\u4e2d\u79fb\u9664\u6ce8\u91ca \u4e3a\u67d0\u4e9b\u884c\u6dfb\u52a0\u6ce8\u91ca \u5b9e\u73b0Wc -l\u547d\u4ee4 \u6a21\u62df\u5b9e\u73b0head\u547d\u4ee4 \u6a21\u62dftail -1\u547d\u4ee4 \u6a21\u62dfDos2unix\u547d\u4ee4 \u6a21\u62dfUnix2dos\u547d\u4ee4 \u6a21\u62dfcat -E\u547d\u4ee4 \u6a21\u62dfcat -ET\u547d\u4ee4 \u6a21\u62dfnl\u547d\u4ee4 \u6a21\u62dfcp\u547d\u4ee4 \u6a21\u62dfexpand\u547d\u4ee4 \u6a21\u62dftee\u547d\u4ee4 \u6a21\u62dfcat -s\u547d\u4ee4 \u6a21\u62dfgrep\u547d\u4ee4 \u6a21\u62dfgrep -v\u547d\u4ee4 \u6a21\u62dftr\u547d\u4ee4 \u5199\u5728\u6700\u540e \u53c2\u8003","title":"\u4e09\u5341\u5206\u949f\u5b66\u4f1aSED"},{"location":"sed/#_1","text":"SED\u7684\u82f1\u6587\u5168\u79f0\u662f Stream EDitor \uff0c\u5b83\u662f\u4e00\u4e2a\u7b80\u5355\u800c\u5f3a\u5927\u7684\u6587\u672c\u89e3\u6790\u8f6c\u6362\u5de5\u5177\uff0c\u57281973-1974\u5e74\u671f\u95f4\u7531\u8d1d\u5c14\u5b9e\u9a8c\u5ba4\u7684 Lee E. McMahon \u5f00\u53d1\uff0c\u4eca\u5929\uff0c\u5b83\u5df2\u7ecf\u8fd0\u884c\u5728\u6240\u6709\u7684\u4e3b\u6d41\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u4e86\u3002 McMahon \u521b\u5efa\u4e86\u4e00\u4e2a\u901a\u7528\u7684\u884c\u7f16\u8f91\u5668\uff0c\u6700\u7ec8\u53d8\u6210\u4e3a\u4e86SED\u3002SED\u7684\u5f88\u591a\u8bed\u6cd5\u548c\u7279\u6027\u90fd\u501f\u9274\u4e86 ed \u7f16\u8f91\u5668\u3002\u8bbe\u8ba1\u4e4b\u521d\uff0c\u5b83\u5c31\u5df2\u7ecf\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\uff0cSED\u53ef\u4ee5\u4ece\u6587\u4ef6\u4e2d\u63a5\u53d7\u7c7b\u4f3c\u4e8e\u7ba1\u9053\u7684\u8f93\u5165\uff0c\u4e5f\u53ef\u4ee5\u63a5\u53d7\u6765\u81ea\u6807\u51c6\u8f93\u5165\u6d41\u7684\u8f93\u5165\u3002 SED\u7531\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u7ec4\u7ec7\uff08FSF\uff09\u5f00\u53d1\u548c\u7ef4\u62a4\u5e76\u4e14\u968f\u7740GNU/Linux\u8fdb\u884c\u5206\u53d1\uff0c\u56e0\u6b64\uff0c\u901a\u5e38\u5b83\u4e5f\u79f0\u4f5c GNU SED \u3002\u5bf9\u4e8e\u65b0\u624b\u6765\u8bf4\uff0cSED\u7684\u8bed\u6cd5\u770b\u8d77\u6765\u53ef\u80fd\u6709\u4e9b\u795e\u79d8\uff0c\u4f46\u662f\uff0c\u4e00\u65e6\u638c\u63e1\u4e86\u5b83\u7684\u8bed\u6cd5\uff0c\u4f60\u5c31\u53ef\u4ee5\u53ea\u7528\u51e0\u884c\u4ee3\u7801\u53bb\u89e3\u51b3\u975e\u5e38\u590d\u6742\u7684\u4efb\u52a1\uff0c\u8fd9\u5c31\u662fSED\u7684\u9b45\u529b\u6240\u5728\u3002","title":"\u6982\u8ff0"},{"location":"sed/#sed_1","text":"SED\u7684\u7528\u9014\u975e\u5e38\u5e7f\u6cdb\uff0c\u4f8b\u5982\uff1a \u6587\u672c\u66ff\u6362 \u9009\u62e9\u6027\u7684\u8f93\u51fa\u6587\u672c\u6587\u4ef6 \u4ece\u6587\u672c\u6587\u4ef6\u7684\u67d0\u5904\u5f00\u59cb\u7f16\u8f91 \u65e0\u4ea4\u4e92\u5f0f\u7684\u5bf9\u6587\u672c\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\u7b49","title":"SED\u7684\u5178\u578b\u7528\u9014"},{"location":"sed/#_2","text":"\u5728\u672c\u7ae0\u4e2d\uff0c\u6211\u4eec\u5c06\u4f1a\u63a2\u7d22SED\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u8981\u60f3\u6210\u4e3a\u4e00\u4e2aSED\u4e13\u5bb6\uff0c\u4f60\u9700\u8981\u77e5\u9053\u5b83\u7684\u5185\u90e8\u5b9e\u73b0\u3002SED\u9075\u5faa\u7b80\u5355\u7684\u5de5\u4f5c\u6d41\uff1a \u8bfb\u53d6 \uff0c \u6267\u884c \u548c \u663e\u793a \uff0c\u4e0b\u56fe\u63cf\u8ff0\u4e86\u8be5\u5de5\u4f5c\u6d41\uff1a \u8bfb\u53d6 \uff1a SED\u4ece\u8f93\u5165\u6d41\uff08\u6587\u4ef6\uff0c\u7ba1\u9053\u6216\u8005\u6807\u51c6\u8f93\u5165\uff09\u4e2d\u8bfb\u53d6\u4e00\u884c\u5e76\u4e14\u5b58\u50a8\u5230\u5b83\u53eb\u505a \u6a21\u5f0f\u7a7a\u95f4\uff08 pattern buffer \uff09 \u7684\u5185\u90e8\u7f13\u51b2\u533a \u6267\u884c \uff1a \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684SED\u547d\u4ee4\u90fd\u5728 \u6a21\u5f0f\u7a7a\u95f4 \u4e2d\u987a\u5e8f\u7684\u6267\u884c\uff0c\u9664\u975e\u6307\u5b9a\u4e86\u884c\u7684\u5730\u5740\uff0c\u5426\u5219SED\u547d\u4ee4\u5c06\u4f1a\u5728\u6240\u6709\u7684\u884c\u4e0a\u4f9d\u6b21\u6267\u884c \u663e\u793a \uff1a \u53d1\u9001\u4fee\u6539\u540e\u7684\u5185\u5bb9\u5230\u8f93\u51fa\u6d41\u3002\u5728\u53d1\u9001\u6570\u636e\u4e4b\u540e\uff0c \u6a21\u5f0f\u7a7a\u95f4 \u5c06\u4f1a\u88ab\u6e05\u7a7a\u3002 \u5728\u6587\u4ef6\u6240\u6709\u7684\u5185\u5bb9\u90fd\u88ab\u5904\u7406\u5b8c\u6210\u4e4b\u524d\uff0c\u4e0a\u8ff0\u8fc7\u7a0b\u5c06\u4f1a\u91cd\u590d\u6267\u884c","title":"\u5de5\u4f5c\u6d41"},{"location":"sed/#_3","text":"\u6a21\u5f0f\u7a7a\u95f4 \uff08 pattern buffer \uff09 \u662f\u4e00\u5757\u6d3b\u8dc3\u7684\u7f13\u51b2\u533a\uff0c\u5728sed\u7f16\u8f91\u5668\u6267\u884c\u547d\u4ee4\u65f6\u5b83\u4f1a\u4fdd\u5b58\u5f85\u68c0\u67e5\u7684\u6587\u672c \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u7684SED\u547d\u4ee4\u90fd\u662f\u5728\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u6267\u884c\uff0c\u56e0\u6b64\u8f93\u5165\u6587\u4ef6\u5e76\u4e0d\u4f1a\u53d1\u751f\u6539\u53d8 \u8fd8\u6709\u53e6\u5916\u4e00\u4e2a\u7f13\u51b2\u533a\u53eb\u505a \u4fdd\u6301\u7a7a\u95f4 \uff08 hold buffer \uff09\uff0c\u5728\u5904\u7406\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u67d0\u4e9b\u884c\u65f6\uff0c\u53ef\u4ee5\u7528\u4fdd\u6301\u7a7a\u95f4\u6765\u4e34\u65f6\u4fdd\u5b58\u4e00\u4e9b\u884c\u3002\u5728\u6bcf\u4e00\u4e2a\u5faa\u73af\u7ed3\u675f\u7684\u65f6\u5019\uff0cSED\u5c06\u4f1a\u79fb\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\uff0c\u4f46\u662f\u8be5\u7f13\u51b2\u533a\u4e2d\u7684\u5185\u5bb9\u5728\u6240\u6709\u7684\u5faa\u73af\u8fc7\u7a0b\u4e2d\u662f\u6301\u4e45\u5b58\u50a8\u7684\u3002SED\u547d\u4ee4\u65e0\u6cd5\u76f4\u63a5\u5728\u8be5\u7f13\u51b2\u533a\u4e2d\u6267\u884c\uff0c\u56e0\u6b64SED\u5141\u8bb8\u6570\u636e\u5728 \u4fdd\u6301\u7a7a\u95f4 \u548c \u6a21\u5f0f\u7a7a\u95f4 \u4e4b\u95f4\u5207\u6362 \u521d\u59cb\u60c5\u51b5\u4e0b\uff0c \u4fdd\u6301\u7a7a\u95f4 \u548c \u6a21\u5f0f\u7a7a\u95f4 \u8fd9\u4e24\u4e2a\u7f13\u51b2\u533a\u90fd\u662f\u7a7a\u7684 \u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u8f93\u5165\u6587\u4ef6\u7684\u8bdd\uff0cSED\u5c06\u4f1a\u4ece\u6807\u51c6\u8f93\u5165\u63a5\u6536\u8bf7\u6c42 \u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u5730\u5740\u8303\u56f4\u7684\u8bdd\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bSED\u5c06\u4f1a\u5bf9\u6240\u6709\u7684\u884c\u8fdb\u884c\u64cd\u4f5c","title":"\u9700\u8981\u6ce8\u610f\u7684\u51e0\u70b9"},{"location":"sed/#_4","text":"\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a quote.txt \u7684\u6587\u672c\u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u4e3a\u8457\u540d\u4f5c\u5bb6 Paulo Coelho \u7684\u4e00\u6bb5\u540d\u8a00 $ vi quote.txt There is only one thing that makes a dream impossible to achieve: the fear of failure. - Paulo Coelho, The Alchemist \u4e3a\u4e86\u7406\u89e3SED\u7684\u5de5\u4f5c\u6d41\uff0c\u6211\u4eec\u9996\u5148\u4f7f\u7528SED\u663e\u793a\u51faquote.txt\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u8be5\u793a\u4f8b\u4e0e cat \u547d\u4ee4\u7c7b\u4f3c $ sed '' quote.txt There is only one thing that makes a dream impossible to achieve: the fear of failure. - Paulo Coelho, The Alchemist \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0cquote.txt\u662f\u8f93\u5165\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u4e24\u4e2a\u5355\u5f15\u53f7\u662f\u8981\u6267\u884c\u7684SED\u547d\u4ee4\u3002 \u9996\u5148\uff0cSED\u5c06\u4f1a\u8bfb\u53d6quote.txt\u6587\u4ef6\u4e2d\u7684\u4e00\u884c\u5185\u5bb9\u5b58\u50a8\u5230\u5b83\u7684\u6a21\u5f0f\u7a7a\u95f4\u4e2d\uff0c\u7136\u540e\u4f1a\u5728\u8be5\u7f13\u51b2\u533a\u4e2d\u6267\u884cSED\u547d\u4ee4\u3002\u5728\u8fd9\u91cc\uff0c\u6ca1\u6709\u63d0\u4f9bSED\u547d\u4ee4\uff0c\u56e0\u6b64\u5bf9\u8be5\u7f13\u51b2\u533a\u6ca1\u6709\u8981\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u6700\u540e\u5b83\u4f1a\u5220\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u5e76\u4e14\u6253\u5370\u8be5\u5185\u5bb9\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u5f88\u7b80\u5355\u7684\u8fc7\u7a0b\uff0c\u5bf9\u5427? \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0cSED\u4f1a\u4ece\u6807\u51c6\u8f93\u5165\u6d41\u63a5\u53d7\u8f93\u5165 $ sed '' \u5f53\u4e0a\u8ff0\u547d\u4ee4\u88ab\u6267\u884c\u7684\u65f6\u5019\uff0c\u5c06\u4f1a\u4ea7\u751f\u4e0b\u5217\u7ed3\u679c There is only one thing that makes a dream impossible to achieve: the fear of failure. There is only one thing that makes a dream impossible to achieve: the fear of failure. \u5728\u8fd9\u91cc\uff0c\u7b2c\u4e00\u884c\u5185\u5bb9\u662f\u901a\u8fc7\u952e\u76d8\u8f93\u5165\u7684\u5185\u5bb9\uff0c\u7b2c\u4e8c\u884c\u662fSED\u8f93\u51fa\u7684\u5185\u5bb9\u3002 \u4eceSED\u4f1a\u8bdd\u4e2d\u9000\u51fa\uff0c\u4f7f\u7528\u7ec4\u5408\u952e ctrl-D (^D)","title":"\u793a\u4f8b"},{"location":"sed/#_5","text":"\u672c\u7ae0\u4e2d\u5c06\u4f1a\u4ecb\u7ecdSED\u4e2d\u7684\u57fa\u672c\u547d\u4ee4\u548c\u5b83\u7684\u547d\u4ee4\u884c\u4f7f\u7528\u65b9\u6cd5\u3002SED\u53ef\u4ee5\u7528\u4e0b\u5217\u4e24\u79cd\u65b9\u5f0f\u8c03\u7528\uff1a sed [-n] [-e] 'command(s)' files sed [-n] -f scriptfile files \u7b2c\u4e00\u79cd\u65b9\u5f0f\u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528\u5355\u5f15\u53f7\u6307\u5b9a\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u5219\u6307\u5b9a\u4e86\u5305\u542bSED\u547d\u4ee4\u7684\u811a\u672c\u6587\u4ef6\u3002\u5f53\u7136\uff0c\u8fd9\u4e24\u79cd\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\uff0cSED\u63d0\u4f9b\u4e86\u5f88\u591a\u53c2\u6570\u7528\u4e8e\u63a7\u5236\u8fd9\u79cd\u884c\u4e3a\u3002 \u8ba9\u6211\u4eec\u770b\u770b\u5982\u4f55\u6307\u5b9a\u591a\u4e2aSED\u547d\u4ee4\u3002SED\u63d0\u4f9b\u4e86 delete \u547d\u4ee4\u7528\u4e8e\u5220\u9664\u67d0\u4e9b\u884c\uff0c\u8fd9\u91cc\u8ba9\u6211\u4eec\u5220\u9664\u7b2c\u4e00\u884c\uff0c\u7b2c\u4e8c\u884c\u548c\u7b2c\u4e94\u884c\uff1a \u9996\u5148\uff0c\u4f7f\u7528 cat \u547d\u4ee4\u663e\u793a\u6587\u4ef6\u5185\u5bb9 $ cat books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u73b0\u5728\uff0c\u4f7f\u7528SED\u79fb\u9664\u6307\u5b9a\u7684\u884c\uff0c\u4e3a\u4e86\u5220\u9664\u4e09\u884c\uff0c\u6211\u4eec\u4f7f\u7528 -e \u9009\u9879\u6307\u5b9a\u4e09\u4e2a\u72ec\u7acb\u7684\u547d\u4ee4 $ sed -e '1d' -e '2d' -e '5d' books.txt 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06\u591a\u4e2aSED\u547d\u4ee4\u5199\u5728\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u5c06\u8be5\u6587\u4ef6\u4f5c\u4e3aSED\u547d\u4ee4\u7684\u53c2\u6570\uff0cSED\u53ef\u4ee5\u5bf9\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u6bcf\u4e00\u4e2a\u547d\u4ee4\uff0c\u4e0b\u9762\u7684\u4f8b\u5b50\u63cf\u8ff0\u4e86SED\u7684\u7b2c\u4e8c\u79cd\u7528\u6cd5 \u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a\u5305\u542bSED\u547d\u4ee4\u7684\u6587\u672c\u6587\u4ef6\uff0c\u4e3a\u4e86\u4fbf\u4e8e\u7406\u89e3\uff0c\u6211\u4eec\u4f7f\u7528\u4e0e\u4e4b\u524d\u76f8\u540c\u7684SED\u547d\u4ee4 $ echo -e \"1d\\n2d\\n5d\" > commands.txt $ cat commands.txt 1d 2d 5d \u63a5\u4e0b\u6765\u6784\u9020\u4e00\u4e2aSED\u547d\u4ee4\u53bb\u6267\u884c\u8be5\u64cd\u4f5c $ sed -f commands.txt books.txt 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864","title":"\u57fa\u7840\u8bed\u6cd5"},{"location":"sed/#_6","text":"SED\u652f\u6301\u4e0b\u5217\u6807\u51c6\u9009\u9879\uff1a -n \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u5728\u5904\u7406\u5b8c\u6210\u540e\u5c06\u4f1a\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u8be5\u9009\u9879\u7528\u4e8e\u963b\u6b62\u8be5\u884c\u4e3a $ sed -n '' quote.txt -e \u6307\u5b9a\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4f7f\u7528\u8be5\u53c2\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\u547d\u4ee4\uff0c\u8ba9\u6211\u4eec\u6253\u5370\u6bcf\u4e00\u884c\u4e24\u6b21\uff1a $ sed -e '' -e 'p' quote.txt There is only one thing that makes a dream impossible to achieve: the fear of failure. There is only one thing that makes a dream impossible to achieve: the fear of failure. - Paulo Coelho, The Alchemist - Paulo Coelho, The Alchemist -f \u6307\u5b9a\u5305\u542b\u8981\u6267\u884c\u7684\u547d\u4ee4\u7684\u811a\u672c\u6587\u4ef6 $ echo \"p\" > commands $ $ sed -n -f commands quote.txt There is only one thing that makes a dream impossible to achieve: the fear of failure. - Paulo Coelho, The Alchemist","title":"\u6807\u51c6\u9009\u9879"},{"location":"sed/#gnu","text":"\u8fd9\u4e9b\u9009\u9879\u662fGNU\u89c4\u8303\u5b9a\u4e49\u7684\uff0c\u53ef\u80fd\u5bf9\u4e8e\u67d0\u4e9b\u7248\u672c\u7684SED\u5e76\u4e0d\u652f\u6301\u3002 -n \uff0c --quiet , --slient \uff1a\u4e0e\u6807\u51c6\u7684-n\u9009\u9879\u76f8\u540c -e script \uff0c --expression=script \uff1a\u4e0e\u6807\u51c6\u7684-e\u9009\u9879\u76f8\u540c -f script-file \uff0c --file=script-file \uff1a\u4e0e\u6807\u51c6\u7684-f\u9009\u9879\u76f8\u540c --follow-symlinks \uff1a\u5982\u679c\u63d0\u4f9b\u8be5\u9009\u9879\u7684\u8bdd\uff0c\u5728\u7f16\u8f91\u7684\u6587\u4ef6\u662f\u7b26\u53f7\u94fe\u63a5\u65f6\uff0cSED\u5c06\u4f1a\u8ddf\u968f\u94fe\u63a5 -i[SUFFIX] \uff0c --in-place[=SUFFIX] \uff1a\u8be5\u9009\u9879\u7528\u4e8e\u5bf9\u5f53\u524d\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u5982\u679c\u63d0\u4f9b\u4e86SUFFIX\u7684\u8bdd\uff0c\u5c06\u4f1a\u5907\u4efd\u539f\u59cb\u6587\u4ef6\uff0c\u5426\u5219\u5c06\u4f1a\u8986\u76d6\u539f\u59cb\u6587\u4ef6 -l N \uff0c --line-lenght=N \uff1a\u8be5\u9009\u9879\u7528\u4e8e\u8bbe\u7f6e\u884c\u7684\u957f\u5ea6\u4e3aN\u4e2a\u5b57\u7b26 --posix \uff1a\u8be5\u9009\u9879\u7981\u7528\u6240\u6709\u7684GNU\u6269\u5c55 -r \uff0c --regexp-extended \uff1a\u8be5\u9009\u9879\u5c06\u542f\u7528\u6269\u5c55\u7684\u6b63\u5219\u8868\u8fbe\u5f0f -u \uff0c --unbuffered \uff1a\u6307\u5b9a\u8be5\u9009\u9879\u7684\u65f6\u5019\uff0cSED\u5c06\u4f1a\u4ece\u8f93\u5165\u6587\u4ef6\u4e2d\u52a0\u8f7d\u6700\u5c11\u7684\u6570\u636e\uff0c\u5e76\u4e14\u66f4\u52a0\u9891\u7e41\u7684\u5237\u51fa\u5230\u8f93\u51fa\u7f13\u51b2\u533a\u3002\u5728\u7f16\u8f91 tail -f \u547d\u4ee4\u7684\u8f93\u51fa\uff0c\u4f60\u4e0d\u5e0c\u671b\u7b49\u5f85\u8f93\u51fa\u7684\u65f6\u5019\u8be5\u9009\u9879\u662f\u975e\u5e38\u6709\u7528\u7684\u3002 -z \uff0c --null-data \uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u5bf9\u6bcf\u4e00\u884c\u4f7f\u7528\u6362\u884c\u7b26\u5206\u5272\uff0c\u5982\u679c\u63d0\u4f9b\u4e86\u8be5\u9009\u9879\u7684\u8bdd\uff0c\u5b83\u5c06\u4f7f\u7528NULL\u5b57\u7b26\u5206\u5272\u884c","title":"GNU\u9009\u9879"},{"location":"sed/#_7","text":"\u4e0e\u5176\u5b83\u7f16\u7a0b\u8bed\u8a00\u7c7b\u4f3c\uff0cSED\u63d0\u4f9b\u4e86\u7528\u4e8e\u63a7\u5236\u6267\u884c\u6d41\u7684\u5faa\u73af\u548c\u5206\u652f\u8bed\u53e5\u3002 SED\u4e2d\u7684\u5faa\u73af\u6709\u70b9\u7c7b\u4f3c\u4e8e goto \u8bed\u53e5\uff0cSED\u53ef\u4ee5\u6839\u636e\u6807\u7b7e\uff08label\uff09\u8df3\u8f6c\u5230\u67d0\u4e00\u884c\u7ee7\u7eed\u6267\u884c\uff0c\u5728SED\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u5982\u4e0b\u7684\u6807\u7b7e\uff1a :label :start :end :up \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u56db\u4e2a\u6807\u7b7e\u3002 \u8981\u8df3\u8f6c\u5230\u6307\u5b9a\u7684\u6807\u7b7e\uff0c\u4f7f\u7528 b \u547d\u4ee4\u540e\u9762\u8ddf\u7740\u6807\u7b7e\u540d\uff0c\u5982\u679c\u5ffd\u7565\u6807\u7b7e\u540d\u7684\u8bdd\uff0cSED\u5c06\u4f1a\u8df3\u8f6c\u5230SED\u6587\u4ef6\u7684\u7ed3\u5c3e\u3002 b \u6807\u7b7e\u7528\u4e8e\u65e0\u6761\u4ef6\u7684\u8df3\u8f6c\u5230\u6307\u5b9a\u7684label\u3002 \u4e3a\u4e86\u66f4\u597d\u5730\u7406\u89e3SED\u4e2d\u7684\u5faa\u73af\u548c\u5206\u652f\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3abooks2.txt\u7684\u6587\u672c\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e9b\u56fe\u4e66\u7684\u6807\u9898\u548c\u4f5c\u8005\u4fe1\u606f\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\u4f1a\u5408\u5e76\u56fe\u4e66\u7684\u6807\u9898\u548c\u4f5c\u8005\uff0c\u4f7f\u7528\u9017\u53f7\u5206\u9694\u3002\u4e4b\u540e\u641c\u7d22\u6240\u6709\u5339\u914d\u201cPaulo\u201d\u7684\u884c\uff0c\u5982\u679c\u5339\u914d\u7684\u8bdd\u5c31\u5728\u8fd9\u4e00\u884c\u7684\u5f00\u5934\u6dfb\u52a0 - \uff0c\u5426\u5219\u8df3\u8f6c\u5230 Print \u6807\u7b7e\uff0c\u6253\u5370\u51fa\u8be5\u884c\u5185\u5bb9\u3002 $ cat books2.txt A Storm of Swords George R. R. Martin The Two Towers J. R. R. Tolkien The Alchemist Paulo Coelho The Fellowship of the Ring J. R. R. Tolkien The Pilgrimage Paulo Coelho A Game of Thrones George R. R. Martin $ sed -n ' h;n;H;x s/\\n/, / /Paulo/!b Print s/^/- / :Print p' books2.txt A Storm of Swords , George R. R. Martin The Two Towers , J. R. R. Tolkien - The Alchemist , Paulo Coelho The Fellowship of the Ring , J. R. R. Tolkien - The Pilgrimage , Paulo Coelho A Game of Thrones , George R. R. Martin \u4e4d\u770b\u6765\u4e0a\u8ff0\u7684\u4ee3\u7801\u975e\u5e38\u795e\u79d8\uff0c\u8ba9\u6211\u4eec\u9010\u6b65\u62c6\u89e3\u4e00\u4e0b \u7b2c\u4e00\u884c\u662f h;n;H;x \u8fd9\u51e0\u4e2a\u547d\u4ee4\uff0c\u8bb0\u5f97\u4e0a\u9762\u6211\u4eec\u63d0\u5230\u7684 \u4fdd\u6301\u7a7a\u95f4 \u5417\uff1f\u7b2c\u4e00\u4e2a h \u662f\u6307\u5c06\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u8986\u76d6\u5230 \u4fdd\u6301\u7a7a\u95f4 \u4e2d\uff0c n \u7528\u4e8e\u63d0\u524d\u8bfb\u53d6\u4e0b\u4e00\u884c\uff0c\u5e76\u4e14\u8986\u76d6\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u8fd9\u4e00\u884c\uff0c H \u5c06\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u8ffd\u52a0\u5230 \u4fdd\u6301\u7a7a\u95f4 \u4e2d\uff0c\u6700\u540e\u7684 x \u7528\u4e8e\u4ea4\u6362\u6a21\u5f0f\u7a7a\u95f4\u548c \u4fdd\u6301\u7a7a\u95f4 \u4e2d\u7684\u5185\u5bb9\u3002\u56e0\u6b64\u8fd9\u91cc\u5c31\u662f\u6307\u6bcf\u6b21\u8bfb\u53d6\u4e24\u884c\u653e\u5230\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u4ea4\u7ed9\u4e0b\u9762\u7684\u547d\u4ee4\u8fdb\u884c\u5904\u7406 \u63a5\u4e0b\u6765\u662f s/\\n/, / \u7528\u4e8e\u5c06\u4e0a\u9762\u7684\u4e24\u884c\u5185\u5bb9\u4e2d\u7684\u6362\u884c\u7b26\u66ff\u6362\u4e3a\u9017\u53f7 \u7b2c\u4e09\u4e2a\u547d\u4ee4\u5728\u4e0d\u5339\u914d\u7684\u65f6\u5019\u8df3\u8f6c\u5230 Print \u6807\u7b7e\uff0c\u5426\u5219\u7ee7\u7eed\u6267\u884c\u7b2c\u56db\u4e2a\u547d\u4ee4 :Print \u4ec5\u4ec5\u662f\u4e00\u4e2a\u6807\u7b7e\u540d\uff0c\u800c p \u5219\u662fprint\u547d\u4ee4 \u4e3a\u4e86\u63d0\u9ad8\u53ef\u8bfb\u6027\uff0c\u6bcf\u4e00\u4e2a\u547d\u4ee4\u90fd\u5360\u4e86\u4e00\u884c\uff0c\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u628a\u6240\u6709\u547d\u4ee4\u653e\u5728\u4e00\u884c $ sed -n 'h;n;H;x;s/\\n/, /;/Paulo/!b Print; s/^/- /; :Print;p' books2.txt \u5173\u4e8e h \uff0c H \uff0c x \u547d\u4ee4\u53c2\u8003\u5b98\u65b9\u624b\u518c sed, a stream editor 3.6 Less Frequently-Used Commands \u8282","title":"\u5faa\u73af"},{"location":"sed/#_8","text":"\u4f7f\u7528 t \u547d\u4ee4\u521b\u5efa\u5206\u652f\u3002\u53ea\u6709\u5f53\u524d\u7f6e\u6761\u4ef6\u6210\u529f\u7684\u65f6\u5019\uff0c t \u547d\u4ee4\u624d\u4f1a\u8df3\u8f6c\u5230\u8be5\u6807\u7b7e\u3002 t \u547d\u4ee4\u53ea\u6709\u5728\u524d\u4e00\u4e2a\u66ff\u6362\uff08s\uff09\u547d\u4ee4\u6267\u884c\u6210\u529f\u7684\u65f6\u5019\u624d\u4f1a\u6267\u884c\u3002 \u8ba9\u6211\u4eec\u770b\u4e00\u4e9b\u524d\u9762\u7ae0\u8282\u4e2d\u7684\u4f8b\u5b50\uff0c\u4e0e\u4e4b\u524d\u4e0d\u540c\u7684\u662f\uff0c\u8fd9\u6b21\u6211\u4eec\u5c06\u6253\u5370\u56db\u4e2a\u8fde\u5b57\u7b26\"-\"\uff0c\u800c\u4e4b\u524d\u662f\u4e00\u4e2a\u3002 $ sed -n ' h;n;H;x s/\\n/, / :Loop /Paulo/s/^/-/ /----/!t Loop p' books2.txt A Storm of Swords , George R. R. Martin The Two Towers , J. R. R. Tolkien ----The Alchemist , Paulo Coelho The Fellowship of the Ring , J. R. R. Tolkien ----The Pilgrimage , Paulo Coelho A Game of Thrones , George R. R. Martin \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u524d\u9762\u4e24\u884c\u4e0e\u4e0a\u4e00\u8282\u4e2d\u8bb2\u7684\u4f5c\u7528\u4e00\u81f4\uff0c\u7b2c\u4e09\u884c\u5b9a\u4e49\u4e86\u4e00\u4e2a Loop \u6807\u7b7e\uff0c\u63a5\u4e0b\u6765\u5339\u914d\u5b58\u5728\u201cPaulo\u201d\u7684\u884c\uff0c\u5982\u679c\u5b58\u5728\u5219\u5728\u6700\u524d\u9762\u6dfb\u52a0\u4e00\u4e2a - \uff0c\u63a5\u4e0b\u6765\u662f\u6211\u4eec\u8fd9\u91cc\u7684\u91cd\u70b9\uff1a /----/!t Loop \u8fd9\u4e00\u884c\u9996\u5148\u68c0\u67e5\u4e0a\u9762\u6dfb\u52a0 - \u4e4b\u540e\u662f\u5426\u6ee1\u8db3\u56db\u4e2a - \uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\u5219\u8df3\u8f6c\u5230Loop\u7ee7\u7eed\u6267\u884c\u7b2c\u4e09\u884c\uff0c\u8fd9\u6837\u4e0d\u505c\u7684\u8ffd\u52a0 - \uff0c\u6700\u540e\u5982\u679c\u6539\u884c\u6ee1\u8db3\u524d\u9762\u6709\u56db\u4e2a - \u624d\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\u3002 \u4e3a\u4e86\u63d0\u9ad8\u53ef\u8bfb\u6027\uff0c\u6211\u4eec\u5c06\u6bcf\u4e00\u4e2aSED\u547d\u4ee4\u72ec\u7acb\u4e00\u884c\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u540c\u4e00\u884c\u4e2d\u4f7f\u7528\uff1a sed -n 'h;n;H;x; s/\\n/, /; :Loop;/Paulo/s/^/-/; /----/!t Loop; p' books.txt","title":"\u5206\u652f"},{"location":"sed/#_9","text":"","title":"\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4"},{"location":"sed/#_10","text":"\u5bf9\u4efb\u4f55\u6587\u4ef6\u7684\u6765\u8bf4\uff0c\u6700\u57fa\u672c\u7684\u64cd\u4f5c\u5c31\u662f\u8f93\u51fa\u5b83\u7684\u5185\u5bb9\uff0c\u4e3a\u4e86\u5b9e\u73b0\u8be5\u76ee\u7684\uff0c\u5728SED\u4e2d\u53ef\u4ee5\u4f7f\u7528 print \u547d\u4ee4\u6253\u5370\u51fa\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u3002 \u9996\u5148\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u884c\u53f7\uff0c\u4e66\u540d\uff0c\u4f5c\u8005\u548c\u9875\u7801\u6570\u7684\u6587\u4ef6\uff0c\u5728\u672c\u6587\u4e2d\u6211\u4eec\u5c06\u4f1a\u4f7f\u7528\u8be5\u6587\u4ef6\uff0c\u4f60\u4e5f\u53ef\u4ee5\u521b\u5efa\u4efb\u4f55\u5176\u5b83\u7684\u6587\u4ef6\uff0c\u4f46\u662f\u8fd9\u91cc\u6211\u4eec\u5c31\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\u7684\u6587\u4ef6 $ vi books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho,288 6) A Game of Thrones, George R. R. Martin, 864 \u6267\u884c p \u547d\u4ee4 $ sed 'p' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 6) A Game of Thrones, George R. R. Martin, 864 \u4f60\u53ef\u80fd\u4f1a\u7591\u60d1\uff0c\u4e3a\u4ec0\u4e48\u6bcf\u4e00\u884c\u88ab\u663e\u793a\u4e86\u4e24\u6b21\uff1f \u4f60\u8fd8\u8bb0\u5f97SED\u7684\u5de5\u4f5c\u6d41\u5417\uff1f\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u5c06\u4f1a\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\uff0c\u53e6\u5916\uff0c\u6211\u4eec\u7684\u547d\u4ee4\u4e2d\u5305\u542b\u4e86\u8f93\u51fa\u547d\u4ee4 p \uff0c\u56e0\u6b64\u6bcf\u4e00\u884c\u88ab\u6253\u5370\u4e24\u6b21\u3002\u4f46\u662f\u4e0d\u8981\u62c5\u5fc3\uff0cSED\u63d0\u4f9b\u4e86 -n \u53c2\u6570\u7528\u4e8e\u7981\u6b62\u81ea\u52a8\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u7684\u6bcf\u4e00\u884c\u7684\u884c\u4e3a $ sed -n 'p' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864","title":"\u6a21\u5f0f\u7a7a\u95f4"},{"location":"sed/#_11","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728SED\u4e2d\u4f7f\u7528\u7684\u547d\u4ee4\u4f1a\u4f5c\u7528\u4e8e\u6587\u672c\u6570\u636e\u7684\u6240\u6709\u884c\u3002\u5982\u679c\u53ea\u60f3\u5c06\u547d\u4ee4\u4f5c\u7528\u4e8e\u7279\u5b9a\u7684\u884c\u6216\u8005\u67d0\u4e9b\u884c\uff0c\u5219\u9700\u8981\u4f7f\u7528 \u884c\u5bfb\u5740 \u529f\u80fd\u3002 \u5728SED\u4e2d\u5305\u542b\u4e24\u79cd\u5f62\u5f0f\u7684\u884c\u5bfb\u5740\uff1a \u4ee5\u6570\u5b57\u5f62\u5f0f\u8868\u793a\u7684\u884c\u533a\u95f4 \u4ee5\u6587\u672c\u6a21\u5f0f\u6765\u8fc7\u6ee4\u884c \u4e24\u79cd\u5f62\u5f0f\u90fd\u4f7f\u7528\u76f8\u540c\u7684\u8bed\u6cd5\u683c\u5f0f [address]command","title":"\u884c\u5bfb\u5740"},{"location":"sed/#_12","text":"\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2dSED\u53ea\u4f1a\u5bf9\u7b2c3\u884c\u8fdb\u884c\u64cd\u4f5c $ sed -n '3p' books.txt 3) The Alchemist, Paulo Coelho, 197 \u5f53\u7136\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u8ba9SED\u8f93\u51fa\u67d0\u4e9b\u884c\u3002\u5728SED\u4e2d\u4f7f\u7528\u9017\u53f7 , \u5206\u9694\u8f93\u51fa\u884c\u53f7\u7684\u8303\u56f4\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u4ee3\u7801\u4f1a\u8f93\u51fa\u51fa2-5\u884c\u7684\u5185\u5bb9 $ sed -n '2,5 p' books.txt 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 \u7279\u6b8a\u5b57\u7b26 $ \u4ee3\u8868\u4e86\u6587\u4ef6\u7684\u6700\u540e\u4e00\u884c\uff0c\u8f93\u51fa\u6587\u4ef6\u7684\u6700\u540e\u4e00\u884c $ sed -n '$ p' books.txt 6) A Game of Thrones, George R. R. Martin, 864 \u4e5f\u53ef\u4ee5\u4f7f\u7528 $ \u6307\u5b9a\u8f93\u51fa\u7684\u5730\u5740\u8303\u56f4\uff0c\u4e0b\u5217\u547d\u4ee4\u8f93\u51fa\u7b2c\u4e09\u884c\u5230\u6700\u540e\u4e00\u884c $ sed -n '3,$ p' books.txt 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho,288 6) A Game of Thrones, George R. R. Martin, 864 SED\u8fd8\u63d0\u4f9b\u4e86\u53e6\u5916\u4e24\u79cd\u64cd\u4f5c\u7b26\u7528\u4e8e\u6307\u5b9a\u5730\u5740\u8303\u56f4\uff0c\u7b2c\u4e00\u4e2a\u662f\u52a0\u53f7\uff08 + \uff09\u64cd\u4f5c\u7b26\uff0c\u5b83\u53ef\u4ee5\u4e0e\u9017\u53f7\uff08 , \uff09\u64cd\u4f5c\u7b26\u4e00\u8d77\u4f7f\u7528\uff0c\u4f8b\u5982 M, +n \u5c06\u4f1a\u6253\u5370\u51fa\u4ece\u7b2c M \u884c\u5f00\u59cb\u7684\u4e0b n \u884c\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u4f1a\u8f93\u51fa\u7b2c\u4e8c\u884c\u5f00\u59cb\u7684\u4e0b\u9762\u56db\u884c $ sed -n '2,+4 p' books.txt 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u6ce2\u6d6a\u7ebf\u64cd\u4f5c\u7b26\uff08 ~ \uff09\u6307\u5b9a\u5730\u5740\u8303\u56f4\uff0c\u5b83\u4f7f\u7528 M~N \u7684\u5f62\u5f0f\uff0c\u5b83\u544a\u8bc9SED\u5e94\u8be5\u5904\u7406 M \u884c\u5f00\u59cb\u7684\u6bcf N \u884c\u3002\u4f8b\u5982\uff0c 50~5 \u5339\u914d\u884c\u53f750\uff0c55\uff0c60\uff0c65\u7b49\uff0c\u8ba9\u6211\u4eec\u53ea\u8f93\u51fa\u6587\u4ef6\u4e2d\u7684\u5947\u6570\u884c $ sed -n '1~2 p' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 3) The Alchemist, Paulo Coelho, 197 5) The Pilgrimage, Paulo Coelho, 288 \u4e0b\u9762\u7684\u4ee3\u7801\u5219\u662f\u53ea\u8f93\u51fa\u6587\u4ef6\u4e2d\u7684\u5076\u6570\u884c $ sed -n '2~2 p' books.txt 2) The Two Towers, J. R. R. Tolkien, 352 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u6ce8\u610f\uff0c\u5982\u679c\u4f7f\u7528\u7684\u662fMac\u7cfb\u7edf\u81ea\u5e26\u7684sed\u547d\u4ee4\uff0c\u53ef\u80fd\u4e0d\u652f\u6301 ~ \u548c + \u64cd\u4f5c\u7b26\u3002\u53ef\u4ee5\u4f7f\u7528 brew install gnu-sed --with-default-names \u91cd\u65b0\u5b89\u88c5GNU-SED\u3002","title":"\u6570\u5b57\u65b9\u5f0f\u7684\u884c\u5bfb\u5740"},{"location":"sed/#_13","text":"SED\u7f16\u8f91\u5668\u5141\u8bb8\u6307\u5b9a\u6587\u672c\u6a21\u5f0f\u6765\u8fc7\u6ee4\u51fa\u547d\u4ee4\u8981\u4f5c\u7528\u7684\u884c\u3002\u683c\u5f0f\u5982\u4e0b\uff1a /pattern/command \u5fc5\u987b\u7528\u6b63\u659c\u7ebf\u5c06\u8981\u6307\u5b9a\u7684pattern\u5c01\u8d77\u6765\u3002sed\u7f16\u8f91\u5668\u4f1a\u5c06\u8be5\u547d\u4ee4\u4f5c\u7528\u5230\u5305\u542b\u6307\u5b9a\u6587\u672c\u6a21\u5f0f\u7684\u884c\u4e0a\u3002 \u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u5c06\u4f1a\u8f93\u51fa\u6240\u6709\u4f5c\u8005\u4e3aPaulo Coelho\u7684\u4e66\u7c4d\u3002 $ sed -n '/Paulo/ p' books.txt 3) The Alchemist, Paulo Coelho, 197 5) The Pilgrimage, Paulo Coelho, 288 \u6a21\u5f0f\u5339\u914d\u4e5f\u53ef\u4ee5\u4e0e\u6570\u5b57\u5f62\u5f0f\u7684\u5bfb\u5740\u540c\u65f6\u4f7f\u7528\uff0c\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u4ece\u7b2c\u4e00\u6b21\u5339\u914d\u5230 Alchemist \u5f00\u59cb\u8f93\u51fa\uff0c\u76f4\u5230\u7b2c5\u884c\u4e3a\u6b62\u3002 $ sed -n '/Alchemist/, 5 p' books.txt 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 \u4f7f\u7528\u9017\u53f7\uff08 , \uff09\u64cd\u4f5c\u7b26\u6307\u5b9a\u5339\u914d\u591a\u4e2a\u5339\u914d\u7684\u6a21\u5f0f\u3002\u4e0b\u5217\u7684\u793a\u4f8b\u5c06\u4f1a\u8f93\u51faTwo\u548cPilgrimage\u4e4b\u95f4\u7684\u6240\u6709\u884c $ sed -n '/Two/, /Pilgrimage/ p' books.txt 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 \u5728\u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u8fc7\u6ee4\u5668\u7684\u65f6\u5019\uff0c\u4e0e\u6570\u5b57\u65b9\u5f0f\u7684\u884c\u5bfb\u5740\u7c7b\u4f3c\uff0c\u53ef\u4ee5\u4f7f\u7528\u52a0\u53f7\u64cd\u4f5c\u7b26 + \uff0c\u5b83\u4f1a\u8f93\u51fa\u4ece\u5f53\u524d\u5339\u914d\u4f4d\u7f6e\u5f00\u59cb\u7684\u67d0\u51e0\u884c\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u4ece\u7b2c\u4e00\u6b21Two\u51fa\u73b0\u7684\u4f4d\u7f6e\u5f00\u59cb\u8f93\u51fa\u63a5\u4e0b\u6765\u76844\u884c $ sed -n '/Two/, +4 p' books.txt 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864","title":"\u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u8fc7\u6ee4\u5668"},{"location":"sed/#_14","text":"\u5728\u5904\u7406\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u67d0\u4e9b\u884c\u65f6\uff0c\u53ef\u4ee5\u7528\u4fdd\u6301\u7a7a\u95f4\u6765\u4e34\u65f6\u4fdd\u5b58\u4e00\u4e9b\u884c\u3002\u67095\u6761\u547d\u4ee4\u53ef\u7528\u6765\u64cd\u4f5c\u4fdd\u6301\u7a7a\u95f4 \u547d\u4ee4 \u63cf\u8ff0 h \u5c06\u6a21\u5f0f\u7a7a\u95f4\u590d\u5236\u5230\u4fdd\u6301\u7a7a\u95f4 H \u5c06\u6a21\u5f0f\u7a7a\u95f4\u9644\u52a0\u5230\u4fdd\u6301\u7a7a\u95f4 g \u5c06\u4fdd\u6301\u7a7a\u95f4\u590d\u5236\u5230\u6a21\u5f0f\u7a7a\u95f4 G \u5c06\u4fdd\u6301\u7a7a\u95f4\u9644\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4 x \u4ea4\u6362\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4\u7684\u5185\u5bb9 \u5173\u4e8e\u4fdd\u6301\u7a7a\u95f4\u8fd9\u91cc\u5c31\u4e0d\u5728\u4e3e\u4f8b\u4e86\uff0c\u524d\u9762\u518d \u5faa\u73af \u90e8\u5206\u8bb2\u89e3\u4e0b\u9762\u8fd9\u4e2a\u547d\u4ee4\u7684\u65f6\u5019\u6211\u4eec\u5df2\u7ecf\u5bf9\u5b83\u7684\u4f7f\u7528\u505a\u4e86\u8bf4\u660e\u3002 $ sed -n 'h;n;H;x;s/\\n/, /;/Paulo/!b Print; s/^/- /; :Print;p' books2.txt","title":"\u4fdd\u6301\u7a7a\u95f4"},{"location":"sed/#_15","text":"\u672c\u7ae0\u5c06\u4f1a\u8bb2\u89e3\u4e00\u4e9b\u5e38\u7528\u7684SED\u547d\u4ee4\uff0c\u4e3b\u8981\u5305\u62ec DELETE \uff0c WRITE \uff0c APPEND \uff0c CHANGE \uff0c INSERT \uff0c TRANSLATE \uff0c QUIT \uff0c READ \uff0c EXECUTE \u7b49\u547d\u4ee4\u3002","title":"\u57fa\u672c\u547d\u4ee4"},{"location":"sed/#d","text":"\u5220\u9664\u547d\u4ee4\u683c\u5f0f\u5982\u4e0b [address1[,address2]]d address1 \u548c address2 \u662f\u5f00\u59cb\u548c\u622a\u6b62\u5730\u5740\uff0c\u5b83\u4eec\u53ef\u4ee5\u662f\u884c\u53f7\u6216\u8005\u5b57\u7b26\u4e32\u5339\u914d\u6a21\u5f0f\uff0c\u8fd9\u4e24\u79cd\u5730\u5740\u90fd\u662f\u53ef\u9009\u7684\u3002 \u7531\u547d\u4ee4\u7684\u540d\u79f0\u53ef\u4ee5\u77e5\u9053\uff0c delete \u547d\u4ee4\u662f\u7528\u6765\u6267\u884c\u5220\u9664\u64cd\u4f5c\u7684\uff0c\u5e76\u4e14\u56e0\u4e3aSED\u662f\u57fa\u4e8e\u884c\u7684\u7f16\u8f91\u5668\uff0c\u56e0\u6b64\u6211\u4eec\u8bf4\u8be5\u547d\u4ee4\u662f\u7528\u6765\u5220\u9664\u884c\u7684\u3002\u6ce8\u610f\u7684\u662f\uff0c\u8be5\u547d\u4ee4\u53ea\u4f1a\u79fb\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u884c\uff0c\u8fd9\u6837\u8be5\u884c\u5c31\u4e0d\u4f1a\u88ab\u53d1\u9001\u5230\u8f93\u51fa\u6d41\uff0c\u4f46\u539f\u59cb\u5185\u5bb9\u4e0d\u4f1a\u6539\u53d8\u3002 $ sed 'd' books.txt \u4e3a\u4ec0\u4e48\u6ca1\u6709\u8f93\u51fa\u4efb\u4f55\u5185\u5bb9\uff1f\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u5c06\u4f1a\u5bf9\u6bcf\u4e00\u884c\u6267\u884c\u5220\u9664\u64cd\u4f5c\uff0c\u8fd9\u5c31\u662f\u8be5\u547d\u4ee4\u4e3a\u4ec0\u4e48\u6ca1\u6709\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u8f93\u51fa\u4efb\u4f55\u5185\u5bb9\u7684\u539f\u56e0\u3002 \u4e0b\u5217\u547d\u4ee4\u53ea\u79fb\u9664\u7b2c\u56db\u884c [jerry]$ sed '4d' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 SED\u4e5f\u63a5\u53d7\u4f7f\u7528\u9017\u53f7(,)\u5206\u9694\u7684\u5730\u5740\u8303\u56f4\u3002\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u5730\u5740\u8303\u56f4\u53bb\u79fb\u9664N1\u5230N2\u884c\uff0c\u4f8b\u5982\uff0c\u4e0b\u5217\u547d\u4ee4\u5c06\u5220\u96642-4\u884c $ sed '2, 4 d' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 SED\u7684\u5730\u5740\u8303\u56f4\u5e76\u4e0d\u4ec5\u4ec5\u9650\u4e8e\u6570\u5b57\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6307\u5b9a\u6a21\u5f0f\u5339\u914d\u4f5c\u4e3a\u5730\u5740\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u79fb\u9664\u6240\u6709\u4f5c\u8005\u4e3aPaulo Coelho\u7684\u4e66\u7c4d $ sed '/Paulo Coelho/d' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u6211\u79fb\u9664\u6240\u6709\u4ee5 Storm \u548c Fellowship \u5f00\u5934\u7684\u884c $ sed '/Storm/,/Fellowship/d' books.txt 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864","title":"\u5220\u9664\u547d\u4ee4  d"},{"location":"sed/#w","text":"SED\u63d0\u4f9b\u4e86 write \u547d\u4ee4\u7528\u4e8e\u5c06\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u5199\u5165\u5230\u6587\u4ef6\uff0c\u4e0e delete \u547d\u4ee4\u7c7b\u4f3c\uff0c\u4e0b\u9762\u662f write \u547d\u4ee4\u7684\u8bed\u6cd5 [address1[,address2]]w file w \u6307\u5b9a\u662f\u5199\u547d\u4ee4\uff0c file \u6307\u7684\u662f\u5b58\u50a8\u6587\u4ef6\u5185\u5bb9\u7684\u6587\u4ef6\u540d\u3002\u4f7f\u7528 file \u64cd\u4f5c\u7b26\u7684\u65f6\u5019\u8981\u5c0f\u5fc3\uff0c\u5f53\u63d0\u4f9b\u4e86\u6587\u4ef6\u540d\u4f46\u662f\u6587\u4ef6\u4e0d\u5b58\u5728\u7684\u65f6\u5019\u5b83\u4f1a\u81ea\u52a8\u521b\u5efa\uff0c\u5982\u679c\u5df2\u7ecf\u5b58\u5728\u7684\u8bdd\u5219\u4f1a \u8986\u76d6 \u539f\u6587\u4ef6\u7684\u5185\u5bb9\u3002 \u4e0b\u9762\u7684SED\u547d\u4ee4\u4f1a\u521b\u5efa\u6587\u4ef6books.txt\u7684\u526f\u672c\uff0c\u5728 w \u548c file \u4e4b\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u7a7a\u683c $ sed -n 'w books.bak' books.txt \u4e0a\u8ff0\u547d\u4ee4\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a books.bak \u7684\u6587\u4ef6\uff0c\u9a8c\u8bc1\u4e00\u4e0b\u4e24\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u662f\u5426\u76f8\u540c $ diff books.txt books.bak $ echo $? \u4e00\u65e6\u6267\u884c\u4e0a\u8ff0\u7684\u4ee3\u7801\uff0c\u4f60\u5c06\u4f1a\u5f97\u5230\u4e0b\u5217\u8f93\u51fa 0 \u806a\u660e\u7684\u4f60\u53ef\u80fd\u5df2\u7ecf\u60f3\u5230\u4e86\uff0c\u8fd9\u4e0d\u5c31\u662f cp \u547d\u4ee4\u505a\u7684\u4e8b\u60c5\u5417\uff01\u786e\u5b9e\u5982\u6b64\uff0c cp \u547d\u4ee4\u4e5f\u505a\u4e86\u540c\u4e00\u4ef6\u4e8b\u60c5\uff0c\u4f46\u662fSED\u662f\u4e00\u4e2a\u6210\u719f\u7684\u5de5\u5177\uff0c\u4f7f\u7528\u5b83\u4f60\u53ef\u4ee5\u53ea\u590d\u5236\u6587\u4ef6\u4e2d\u7684\u67d0\u4e9b\u884c\u5230\u65b0\u7684\u6587\u4ef6\u4e2d\uff0c\u5982\u4e0b\u4ee3\u7801\u4f1a\u5b58\u50a8\u6587\u4ef6\u4e2d\u7684\u5947\u6570\u884c\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6 $ sed -n '2~2 w junk.txt' books.txt $ cat junk.txt 2) The Two Towers, J. R. R. Tolkien, 352 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u5047\u8bbe\u4f60\u5e0c\u671b\u5b58\u50a8\u6240\u6709\u72ec\u7acb\u4f5c\u8005\u7684\u4e66\u5230\u5355\u72ec\u7684\u6587\u4ef6\u3002\u5982\u679c\u4eba\u5de5\u53bb\u505a\u7684\u8bdd\uff0c\u80af\u5b9a\u662f\u975e\u5e38\u65e0\u804a\u800c\u4e14\u6ca1\u6709\u6280\u672f\u542b\u91cf\u7684\uff0c\u4f46\u662f\u4f7f\u7528SED\uff0c\u4f60\u5c31\u6709\u4e86\u66f4\u52a0\u806a\u660e\u7684\u65b9\u6cd5\u53bb\u5b9e\u73b0 $ sed -n -e '/Martin/ w Martin.txt' -e '/Paulo/ w Paulo.txt' -e '/Tolkien/ w Tolkien.txt' books.txt $ cat Martin.txt 1) A Storm of Swords, George R. R. Martin, 1216 6) A Game of Thrones, George R. R. Martin, 864 $ cat Paulo.txt 3) The Alchemist, Paulo Coelho, 197 5) The Pilgrimage, Paulo Coelho, 288 $ cat Tolkien.txt 2) The Two Towers, J. R. R. Tolkien, 352 4) The Fellowship of the Ring, J. R. R. Tolkien, 432","title":"\u6587\u4ef6\u5199\u5165\u547d\u4ee4 w"},{"location":"sed/#a","text":"\u6587\u672c\u8ffd\u52a0\u547d\u4ee4\u8bed\u6cd5\uff1a [address]a\\ Append text \u5728\u7b2c\u56db\u884c\u4e4b\u540e\u8ffd\u52a0\u4e00\u672c\u65b0\u4e66\uff1a $ sed '4 a 7) Adultry, Paulo Coelho, 234' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 7) Adultry, Paulo Coelho, 234 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u5728\u547d\u4ee4\u90e8\u5206\uff0c4\u6307\u7684\u662f\u884c\u53f7\uff0c a \u662fappend\u547d\u4ee4\uff0c\u5269\u4f59\u90e8\u5206\u4e3a\u8981\u8ffd\u52a0\u7684\u6587\u672c\u3002 \u5728\u6587\u4ef6\u7684\u7ed3\u5c3e\u63d2\u5165\u4e00\u884c\u6587\u672c\uff0c\u4f7f\u7528 $ \u4f5c\u4e3a\u5730\u5740 $ sed '$ a 7) Adultry, Paulo Coelho, 234' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 7) Adultry, Paulo Coelho, 234 \u9664\u4e86\u884c\u53f7\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u6307\u5b9a\u5730\u5740\uff0c\u4f8b\u5982\uff0c\u5728\u5339\u914d The Alchemist \u7684\u884c\u4e4b\u540e\u8ffd\u52a0\u6587\u672c $ sed '/The Alchemist/ a 7) Adultry, Paulo Coelho, 234' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 7) Adultry, Paulo Coelho, 234 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864","title":"\u8ffd\u52a0\u547d\u4ee4 a"},{"location":"sed/#c","text":"SED\u901a\u8fc7 c \u63d0\u4f9b\u4e86 change \u548c replace \u547d\u4ee4\uff0c\u8be5\u547d\u4ee4\u5e2e\u52a9\u6211\u4eec\u4f7f\u7528\u65b0\u6587\u672c\u66ff\u6362\u5df2\u7ecf\u5b58\u5728\u7684\u884c\uff0c\u5f53\u63d0\u4f9b\u884c\u7684\u5730\u5740\u8303\u56f4\u65f6\uff0c\u6240\u6709\u7684\u884c\u90fd\u88ab\u4f5c\u4e3a\u4e00\u7ec4\u88ab\u66ff\u6362\u4e3a\u5355\u884c\u6587\u672c\uff0c\u4e0b\u9762\u662f\u8be5\u547d\u4ee4\u7684\u8bed\u6cd5 [address1[,address2]]c\\ Replace text \u6bd4\u5982\uff0c\u66ff\u6362\u6587\u672c\u4e2d\u7684\u7b2c\u4e09\u884c\u4e3a\u65b0\u7684\u5185\u5bb9 $ sed '3 c 3) Adultry, Paulo Coelho, 324' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) Adultry, Paulo Coelho, 324 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 SED\u4e5f\u63a5\u53d7\u6a21\u5f0f\u4f5c\u4e3a\u5730\u5740 $ sed '/The Alchemist/ c 3) Adultry, Paulo Coelho, 324' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) Adultry, Paulo Coelho, 324 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u591a\u884c\u66ff\u6362\u4e5f\u662f\u652f\u6301\u7684\uff0c\u4e0b\u9762\u7684\u547d\u4ee4\u5b9e\u73b0\u4e86\u5c06\u7b2c4-6\u884c\u5185\u5bb9\u66ff\u6362\u4e3a\u5355\u884c $ sed '4, 6 c 4) Adultry, Paulo Coelho, 324' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) Adultry, Paulo Coelho, 324","title":"\u884c\u66ff\u6362\u547d\u4ee4 c"},{"location":"sed/#i","text":"\u63d2\u5165\u547d\u4ee4\u4e0e\u8ffd\u52a0\u547d\u4ee4\u7c7b\u4f3c\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\u63d2\u5165\u547d\u4ee4\u662f\u5728\u5339\u914d\u7684\u4f4d\u7f6e\u524d\u63d2\u5165\u65b0\u7684\u4e00\u884c\u3002 [address]i\\ Insert text \u4e0b\u9762\u7684\u547d\u4ee4\u4f1a\u5728\u7b2c\u56db\u884c\u524d\u63d2\u5165\u65b0\u7684\u4e00\u884c $ sed '4 i 7) Adultry, Paulo Coelho, 324' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 7) Adultry, Paulo Coelho, 324 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864","title":"\u63d2\u5165\u547d\u4ee4 i"},{"location":"sed/#y","text":"\u8f6c\u6362\uff08Translate\uff09\u547d\u4ee4 y \u662f\u552f\u4e00\u53ef\u4ee5\u5904\u7406\u5355\u4e2a\u5b57\u7b26\u7684sed\u7f16\u8f91\u5668\u547d\u4ee4\u3002\u8f6c\u6362\u547d\u4ee4\u683c\u5f0f \u5982\u4e0b [address]y/inchars/outchars/ \u8f6c\u6362\u547d\u4ee4\u4f1a\u5bf9inchars\u548coutchars\u503c\u8fdb\u884c\u4e00\u5bf9\u4e00\u7684\u6620\u5c04\u3002inchars\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4f1a\u88ab\u8f6c\u6362\u4e3aoutchars\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\uff0c\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4f1a\u88ab\u8f6c\u6362\u6210outchars\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u3002\u8fd9\u4e2a\u6620\u5c04\u8fc7\u7a0b\u4f1a\u4e00\u76f4\u6301\u7eed\u5230\u5904\u7406\u5b8c\u6307\u5b9a\u5b57\u7b26\u3002\u5982\u679cinchars\u548coutchars\u7684\u957f\u5ea6\u4e0d\u540c\uff0c\u5219sed\u7f16\u8f91\u5668\u4f1a\u4ea7\u751f\u4e00 \u6761\u9519\u8bef\u6d88\u606f\u3002 $ echo \"1 5 15 20\" | sed 'y/151520/IVXVXX/' I V IV XX","title":"\u8f6c\u6362\u547d\u4ee4 y"},{"location":"sed/#l","text":"\u4f60\u80fd\u901a\u8fc7\u76f4\u63a5\u89c2\u5bdf\u533a\u5206\u51fa\u5355\u8bcd\u662f\u901a\u8fc7\u7a7a\u683c\u8fd8\u662ftab\u8fdb\u884c\u5206\u9694\u7684\u5417\uff1f\u663e\u7136\u662f\u4e0d\u80fd\u7684\uff0c\u4f46\u662fSED\u53ef\u4ee5\u4e3a\u4f60\u505a\u5230\u8fd9\u70b9\u3002\u4f7f\u7528 l \u547d\u4ee4\uff08\u82f1\u6587\u5b57\u6bcdL\u7684\u5c0f\u5199\uff09\u53ef\u4ee5\u663e\u793a\u6587\u672c\u4e2d\u7684\u9690\u85cf\u5b57\u7b26\uff08\u4f8b\u5982 \\t \u6216\u8005 $ \u5b57\u7b26\uff09\u3002 [address1[,address2]]l [address1[,address2]]l [len] \u4e3a\u4e86\u6d4b\u8bd5\u8be5\u547d\u4ee4\uff0c\u6211\u4eec\u9996\u5148\u5c06books.txt\u4e2d\u7684\u7a7a\u683c\u66ff\u6362\u4e3atab\u3002 $ sed 's/ /\\t/g' books.txt > junk.txt \u63a5\u4e0b\u6765\u6267\u884c l \u547d\u4ee4 $ sed -n 'l' junk.txt 1)\\tStorm\\tof\\tSwords,\\tGeorge\\tR.\\tR.\\tMartin,\\t1216\\t$ 2)\\tThe\\tTwo\\tTowers,\\tJ.\\tR.\\tR.\\tTolkien,\\t352\\t$ 3)\\tThe\\tAlchemist,\\tPaulo\\tCoelho,\\t197\\t$ 4)\\tThe\\tFellowship\\tof\\tthe\\tRing,\\tJ.\\tR.\\tR.\\tTolkien,\\t432\\t$ 5)\\tThe\\tPilgrimage,\\tPaulo\\tCoelho,\\t288\\t$ 6)\\tA\\tGame\\tof\\tThrones,\\tGeorge\\tR.\\tR.\\tMartin,\\t864$ \u4f7f\u7528 l \u547d\u4ee4\u7684\u65f6\u5019\uff0c\u4e00\u4e2a\u5f88\u6709\u8da3\u7684\u7279\u6027\u662f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u5b9e\u73b0\u6587\u672c\u6309\u7167\u6307\u5b9a\u7684\u5bbd\u5ea6\u6362\u884c\u3002 $ sed -n 'l 25' books.txt 1) Storm of Swords, Geor\\ ge R. R. Martin, 1216 $ 2) The Two Towers, J. R.\\ R. Tolkien, 352 $ 3) The Alchemist, Paulo \\ Coelho, 197 $ 4) The Fellowship of the\\ Ring, J. R. R. Tolkien,\\ 432 $ 5) The Pilgrimage, Paulo\\ Coelho, 288 $ 6) A Game of Thrones, Ge\\ orge R. R. Martin, 864$ \u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\u5728 l \u547d\u4ee4\u540e\u8ddf\u4e86\u4e00\u4e2a\u6570\u5b5725\uff0c\u5b83\u544a\u8bc9SED\u6309\u7167\u6bcf\u884c25\u4e2a\u5b57\u7b26\u8fdb\u884c\u6362\u884c\uff0c\u5982\u679c\u6307\u5b9a\u8fd9\u4e2a\u6570\u5b57\u4e3a0\u7684\u8bdd\uff0c\u5219\u53ea\u6709\u5728\u5b58\u5728\u6362\u884c\u7b26\u7684\u60c5\u51b5\u4e0b\u624d\u8fdb\u884c\u6362\u884c\u3002 l \u547d\u4ee4\u662fGNU-SED\u7684\u4e00\u90e8\u5206\uff0c\u5176\u5b83\u7684\u4e00\u4e9b\u53d8\u4f53\u4e2d\u53ef\u80fd\u65e0\u6cd5\u4f7f\u7528\u8be5\u547d\u4ee4\u3002","title":"\u8f93\u51fa\u9690\u85cf\u5b57\u7b26\u547d\u4ee4 l"},{"location":"sed/#q","text":"\u5728SED\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 Quit \u547d\u4ee4\u9000\u51fa\u5f53\u524d\u7684\u6267\u884c\u6d41 [address]q [address]q [value] \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c q \u547d\u4ee4\u4e0d\u652f\u6301\u5730\u5740\u8303\u56f4\uff0c\u53ea\u652f\u6301\u5355\u4e2a\u5730\u5740\u5339\u914d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0bSED\u4f1a\u6309\u7167\u8bfb\u53d6\u3001\u6267\u884c\u3001\u91cd\u590d\u7684\u5de5\u4f5c\u6d41\u6267\u884c\uff0c\u4f46\u5f53\u5b83\u9047\u5230 q \u547d\u4ee4\u7684\u65f6\u5019\uff0c\u5b83\u4f1a\u9000\u51fa\u5f53\u524d\u7684\u6267\u884c\u6d41\u3002 $ sed '3 q' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 $ sed '/The Alchemist/ q' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 q \u547d\u4ee4\u4e5f\u652f\u6301\u63d0\u4f9b\u4e00\u4e2avalue\uff0c\u8fd9\u4e2avalue\u5c06\u4f5c\u4e3a\u7a0b\u5e8f\u7684\u8fd4\u56de\u4ee3\u7801\u8fd4\u56de $ sed '/The Alchemist/ q 100' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 $ echo $? 100","title":"\u9000\u51fa\u547d\u4ee4 q"},{"location":"sed/#r","text":"\u5728SED\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9SED\u4f7f\u7528Read\u547d\u4ee4\u4ece\u5916\u90e8\u6587\u4ef6\u4e2d\u8bfb\u53d6\u5185\u5bb9\u5e76\u4e14\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u65f6\u5019\u663e\u793a\u51fa\u6765\u3002 [address]r file \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c r \u547d\u4ee4\u548c\u6587\u4ef6\u540d\u4e4b\u95f4\u5fc5\u987b\u53ea\u6709\u4e00\u4e2a\u7a7a\u683c\u3002 \u4e0b\u9762\u7684\u793a\u4f8b\u4f1a\u6253\u5f00 junk.txt \u6587\u4ef6\uff0c\u5c06\u5176\u5185\u5bb9\u63d2\u5165\u5230 books.txt \u6587\u4ef6\u7684\u7b2c\u4e09\u884c\u4e4b\u540e $ echo \"This is junk text.\" > junk.txt $ sed '3 r junk.txt' books.txt 1) A Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 This is junk text. 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 r \u547d\u4ee4\u4e5f\u652f\u6301\u5730\u5740\u8303\u56f4\uff0c\u4f8b\u5982 3, 5 r junk.txt \u4f1a\u5728\u7b2c\u4e09\u884c\uff0c\u7b2c\u56db\u884c\uff0c\u7b2c\u4e94\u884c\u540e\u9762\u5206\u522b\u63d2\u5165 junk.txt \u7684\u5185\u5bb9","title":"\u6587\u4ef6\u8bfb\u53d6\u547d\u4ee4 r"},{"location":"sed/#e","text":"\u5982\u679c\u4f60\u770b\u8fc7[\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK][]\u4e00\u6587\uff0c\u4f60\u53ef\u80fd\u5df2\u7ecf\u77e5\u9053\u4e86\u5728AWK\u4e2d\u53ef\u4ee5\u6267\u884c\u5916\u90e8\u7684\u547d\u4ee4\uff0c\u90a3\u4e48\u5728SED\u4e2d\u6211\u4eec\u662f\u5426\u4e5f\u53ef\u4ee5\u8fd9\u6837\u505a\uff1f \u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u5728SED\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 e \u547d\u4ee4\u6267\u884c\u5916\u90e8\u547d\u4ee4 [address1[,address2]]e [command] \u4e0b\u9762\u7684\u547d\u4ee4\u4f1a\u5728\u7b2c\u4e09\u884c\u4e4b\u524d\u6267\u884c date \u547d\u4ee4 $ sed '3 e date' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 2016\u5e7411\u670829\u65e5 \u661f\u671f\u4e8c 22\u65f646\u520614\u79d2 CST 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u53e6\u4e00\u4e2a\u793a\u4f8b $ sed '3,5 e who' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 mylxsw console Nov 29 19:30 mylxsw ttys000 Nov 29 22:45 3) The Alchemist, Paulo Coelho, 197 mylxsw console Nov 29 19:30 mylxsw ttys000 Nov 29 22:45 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 mylxsw console Nov 29 19:30 mylxsw ttys000 Nov 29 22:45 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 \u5982\u679c\u4f60\u4ed4\u7ec6\u89c2\u5bdf e \u547d\u4ee4\u7684\u8bed\u6cd5\uff0c\u4f60\u4f1a\u53d1\u73b0\u5176\u5b9e\u5b83\u7684 command \u53c2\u6570\u662f\u53ef\u9009\u7684\u3002\u5728\u6ca1\u6709\u63d0\u4f9b\u5916\u90e8\u547d\u4ee4\u7684\u65f6\u5019\uff0cSED\u4f1a\u5c06\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u4f5c\u4e3a\u8981\u6267\u884c\u7684\u547d\u4ee4\u3002 $ echo -e \"date\\ncal\\nuname\" > commands.txt $ cat commands.txt date cal uname $ sed 'e' commands.txt 2016\u5e7411\u670829\u65e5 \u661f\u671f\u4e8c 22\u65f650\u520630\u79d2 CST \u5341\u4e00\u6708 2016 \u65e5 \u4e00 \u4e8c \u4e09 \u56db \u4e94 \u516d 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 Darwin","title":"\u6267\u884c\u5916\u90e8\u547d\u4ee4 e"},{"location":"sed/#_16","text":"\u611f\u53f9\u53f7\u547d\u4ee4\uff08 ! \uff09\u7528\u6765\u6392\u9664\u547d\u4ee4\uff0c\u4e5f\u5c31\u662f\u8ba9\u539f\u672c\u4f1a\u8d77\u4f5c\u7528\u7684\u547d\u4ee4\u4e0d\u8d77\u4f5c\u7528\u3002 $ sed -n '/Paulo/p' books.txt 3) The Alchemist, Paulo Coelho, 197 5) The Pilgrimage, Paulo Coelho, 288 $ sed -n '/Paulo/!p' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 6) A Game of Thrones, George R. R. Martin, 864 \u5982\u4e0a\u4f8b\u6240\u793a\uff0c p \u547d\u4ee4\u539f\u5148\u662f\u53ea\u8f93\u51fa\u5339\u914d Paulo \u7684\u884c\uff0c\u6dfb\u52a0 ! \u4e4b\u540e\uff0c\u53d8\u6210\u4e86\u53ea\u8f93\u51fa\u4e0d\u5339\u914d Paulo \u7684\u884c\u3002 $ sed -n '1!G; h; $p' books.txt 6) A Game of Thrones, George R. R. Martin, 864 5) The Pilgrimage, Paulo Coelho, 288 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 3) The Alchemist, Paulo Coelho, 197 2) The Two Towers, J. R. R. Tolkien, 352 1) Storm of Swords, George R. R. Martin, 1216 \u4e0a\u9762\u7684\u547d\u4ee4\u5b9e\u73b0\u4e86\u7c7b\u4f3c tac \u547d\u4ee4\u7c7b\u4f3c\u7684\u8f93\u51fa\uff0c\u5c06\u6587\u672c\u5185\u5bb9\u5012\u5e8f\u8f93\u51fa\u3002\u770b\u8d77\u6765\u6709\u4e9b\u6666\u6da9\u96be\u61c2\uff0c\u5206\u89e3\u4e00\u4e0b\u5374\u5341\u5206\u7b80\u5355\uff1a 1!G \u8fd9\u53e5\u7684\u610f\u601d\u662f\u51fa\u4e86\u7b2c\u4e00\u884c\u4e4b\u5916\uff0c\u5904\u7406\u6bcf\u4e00\u884c\u7684\u65f6\u5019\u90fd\u5c06\u4fdd\u6301\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u8ffd\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4\uff08\u6b63\u5e8f->\u5012\u5e8f\uff09 h \u5c06\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u590d\u5236\u5230\u4fdd\u6301\u7a7a\u95f4\u4ee5\u5907\u4e0b\u4e00\u884c\u5339\u914d\u7684\u65f6\u5019\u8ffd\u52a0\u5230\u4e0b\u4e00\u884c\u7684\u540e\u9762 $p \u5982\u679c\u5339\u914d\u5230\u6700\u540e\u4e00\u884c\u7684\u8bdd\u5219\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9 \u4e0a\u8ff0\u6b65\u9aa4\u4e0d\u65ad\u91cd\u590d\u76f4\u5230\u6587\u672c\u7ed3\u675f\u521a\u597d\u5c06\u6587\u4ef6\u5185\u5bb9\u7ffb\u8f6c\u4e86\u4e00\u6b21","title":"\u6392\u9664\u547d\u4ee4 !"},{"location":"sed/#_17","text":"\u5728\u4f7f\u7528sed\u7f16\u8f91\u5668\u7684\u57fa\u7840\u547d\u4ee4\u65f6\uff0c\u4f60\u53ef\u80fd\u6ce8\u610f\u5230\u4e86\u4e00\u4e2a\u5c40\u9650\u3002\u6240\u6709\u7684sed\u7f16\u8f91\u5668\u547d\u4ee4\u90fd\u662f\u9488\u5bf9 \u5355\u884c \u6570\u636e\u6267\u884c\u64cd\u4f5c\u7684\u3002\u5728sed\u7f16\u8f91\u5668\u8bfb\u53d6\u6570\u636e\u6d41\u65f6\uff0c\u5b83\u4f1a\u57fa\u4e8e \u6362\u884c\u7b26 \u7684\u4f4d\u7f6e\u5c06\u6570\u636e\u5206\u6210\u884c\u3002sed\u7f16\u8f91\u5668\u6839\u636e\u5b9a\u4e49\u597d\u7684\u811a\u672c\u547d\u4ee4\u4e00\u6b21\u5904\u7406\u4e00\u884c\u6570\u636e\uff0c\u7136\u540e\u79fb\u5230\u4e0b\u4e00\u884c\u91cd\u590d\u8fd9\u4e2a\u8fc7\u7a0b\u3002 \u5e78\u8fd0\u7684\u662f\uff0csed\u7f16\u8f91\u5668\u7684\u8bbe\u8ba1\u4eba\u5458\u5df2\u7ecf\u8003\u8651\u5230\u4e86\u8fd9\u79cd\u60c5\u51b5\uff0c\u5e76\u8bbe\u8ba1\u4e86\u5bf9\u5e94\u7684\u89e3\u51b3\u65b9\u6848\u3002sed\u7f16\u8f91\u5668\u5305\u542b\u4e86\u4e09\u4e2a\u53ef\u7528\u6765\u5904\u7406\u591a\u884c\u6587\u672c\u7684\u7279\u6b8a\u547d\u4ee4\u3002 N \uff1a\u5c06\u6570\u636e\u6d41\u4e2d\u7684\u4e0b\u4e00\u884c\u52a0\u8fdb\u6765\u521b\u5efa\u4e00\u4e2a\u591a\u884c\u7ec4\u6765\u5904\u7406 D \uff1a\u5220\u9664\u591a\u884c\u7ec4\u4e2d\u7684\u4e00\u884c P \uff1a\u6253\u5370\u591a\u884c\u7ec4\u4e2d\u7684\u4e00\u884c","title":"\u591a\u884c\u547d\u4ee4"},{"location":"sed/#n-","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cSED\u662f\u57fa\u4e8e\u5355\u884c\u8fdb\u884c\u64cd\u4f5c\u7684\uff0c\u6709\u4e9b\u60c5\u51b5\u4e0b\u6211\u4eec\u53ef\u80fd\u9700\u8981\u4f7f\u7528\u591a\u884c\u8fdb\u884c\u7f16\u8f91\uff0c\u542f\u7528\u591a\u884c\u7f16\u8f91\u4f7f\u7528 N \u547d\u4ee4\uff0c\u4e0e n \u4e0d\u540c\u7684\u662f\uff0c N \u5e76\u4e0d\u4f1a\u6e05\u9664\u3001\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u7684\u5185\u5bb9\uff0c\u800c\u662f\u91c7\u7528\u4e86\u8ffd\u52a0\u6a21\u5f0f\u3002 [address1[,address2]]N \u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u4f1a\u628a books2.txt \u4e2d\u7684\u6807\u9898\u548c\u4f5c\u8005\u653e\u5230\u540c\u4e00\u884c\u5c55\u793a\uff0c\u5e76\u4e14\u4f7f\u7528\u9017\u53f7\u8fdb\u884c\u5206\u9694 $ sed 'N; s/\\n/,/g' books2.txt A Storm of Swords ,George R. R. Martin The Two Towers ,J. R. R. Tolkien The Alchemist ,Paulo Coelho The Fellowship of the Ring ,J. R. R. Tolkien The Pilgrimage ,Paulo Coelho A Game of Thrones ,George R. R. Martin","title":"N - \u52a0\u8f7d\u4e0b\u4e00\u884c"},{"location":"sed/#d-","text":"sed\u7f16\u8f91\u5668\u63d0\u4f9b\u4e86\u591a\u884c\u5220\u9664\u547d\u4ee4 D \uff0c\u5b83\u53ea\u5220\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u7b2c\u4e00\u884c\u3002\u8be5\u547d\u4ee4\u4f1a\u5220\u9664\u5230\u6362\u884c\u7b26\uff08\u542b \u6362\u884c\u7b26\uff09\u4e3a\u6b62\u7684\u6240\u6709\u5b57\u7b26\u3002 $ echo '\\nThis is the header line.\\nThis is a data line.\\n\\nThis is the last line.' | sed '/^$/{N; /header/D}' This is the header line. This is a data line. This is the last line.","title":"D - \u5220\u9664\u591a\u884c\u4e2d\u7684\u4e00\u884c"},{"location":"sed/#p-","text":"P \u547d\u4ee4\u7528\u4e8e\u8f93\u51fa N \u547d\u4ee4\u521b\u5efa\u7684\u591a\u884c\u6587\u672c\u7684\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u7b2c\u4e00\u884c\u3002 [address1[,address2]]P \u4f8b\u5982\u4e0b\u9762\u7684\u547d\u4ee4\u53ea\u8f93\u51fa\u4e86\u56fe\u4e66\u7684\u6807\u9898 $ sed -n 'N;P' books2.txt A Storm of Swords The Two Towers The Alchemist The Fellowship of the Ring The Pilgrimage A Game of Thrones","title":"P - \u8f93\u51fa\u591a\u884c\u4e2d\u7684\u4e00\u884c"},{"location":"sed/#_18","text":"","title":"\u5176\u5b83\u547d\u4ee4"},{"location":"sed/#n-next","text":"\u5c0f\u5199\u7684n\u547d\u4ee4\u4f1a\u544a\u8bc9sed\u7f16\u8f91\u5668\u79fb\u52a8\u5230\u6570\u636e\u6d41\u4e2d\u7684\u4e0b\u4e00\u6587\u672c\u884c\uff0c\u5e76\u4e14\u8986\u76d6\u5f53\u524d\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u884c\u3002 $ cat data1.txt This is the header line. This is a data line. This is the last line. $ sed '/header/{n ; d}' data1.txt This is the header line. This is a data line. This is the last line. \u4e0a\u9762\u7684\u547d\u4ee4\u4e2d\uff0c\u9996\u5148\u4f1a\u5339\u914d\u5305\u542b header \u7684\u884c\uff0c\u4e4b\u540e\u5c06\u79fb\u52a8\u5230\u6570\u636e\u6d41\u7684\u4e0b\u4e00\u884c\uff0c\u8fd9\u91cc\u662f\u4e00\u4e2a\u7a7a\u884c\uff0c\u7136\u540e\u6267\u884c d \u547d\u4ee4\u5bf9\u6539\u884c\u8fdb\u884c\u5220\u9664\uff0c\u6240\u6709\u5c31\u770b\u5230\u4e86\u8fd9\u6837\u7684\u7ed3\u679c\uff1a\u7b2c\u4e00\u4e2a\u7a7a\u884c\u88ab\u5220\u9664\u6389\u4e86\u3002","title":"n - \u5355\u884cnext"},{"location":"sed/#v-sed","text":"v \u547d\u4ee4\u7528\u4e8e\u68c0\u67e5SED\u7684\u7248\u672c\uff0c\u5982\u679c\u7248\u672c\u5927\u4e8e\u53c2\u6570\u4e2d\u7684\u7248\u672c\u5219\u6b63\u5e38\u6267\u884c\uff0c\u5426\u5219\u5931\u8d25 [address1[,address2]]v [version] \u4f8b\u5982 $ sed --version sed (GNU sed) 4.2.2 $ sed 'v 4.2.3' books.txt sed: -e expression #1, char 7: expected newer version of sed $ sed 'v 4.2.2' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864","title":"v - SED\u7248\u672c\u68c0\u67e5"},{"location":"sed/#_19","text":"\u5728SED\u4e2d\u63d0\u4f9b\u4e86\u4e24\u4e2a\u53ef\u4ee5\u7528\u4f5c\u547d\u4ee4\u7684\u7279\u6b8a\u5b57\u7b26\uff1a = \u548c & \u3002","title":"\u7279\u6b8a\u5b57\u7b26"},{"location":"sed/#_20","text":"= \u547d\u4ee4\u7528\u4e8e\u8f93\u51fa\u884c\u53f7\uff0c\u8bed\u6cd5\u683c\u5f0f\u4e3a [/pattern/]= [address1[,address2]]= \u4f8b\u5982\u4e3a\u6bcf\u4e00\u884c\u8f93\u51fa\u884c\u53f7 $ sed '=' books2.txt 1 A Storm of Swords 2 George R. R. Martin ... \u53ea\u4e3a1-4\u884c\u8f93\u51fa\u884c\u53f7 $ sed '1, 4=' books2.txt 1 A Storm of Swords 2 George R. R. Martin 3 The Two Towers 4 J. R. R. Tolkien The Alchemist Paulo Coelho The Fellowship of the Ring J. R. R. Tolkien The Pilgrimage Paulo Coelho A Game of Thrones George R. R. Martin \u5339\u914dPaulo\u7684\u884c\u8f93\u51fa\u884c\u53f7 $ sed '/Paulo/ =' books2.txt A Storm of Swords George R. R. Martin The Two Towers J. R. R. Tolkien The Alchemist 6 Paulo Coelho The Fellowship of the Ring J. R. R. Tolkien The Pilgrimage 10 Paulo Coelho A Game of Thrones George R. R. Martin \u6700\u540e\u4e00\u884c\u8f93\u51fa\u884c\u53f7\uff0c\u8fd9\u4e2a\u547d\u4ee4\u6bd4\u8f83\u6709\u610f\u601d\u4e86\uff0c\u53ef\u4ee5\u7528\u4e8e\u8f93\u51fa\u6587\u4ef6\u603b\u5171\u6709\u591a\u5c11\u884c $ sed -n '$ =' books2.txt 12","title":"=\u547d\u4ee4"},{"location":"sed/#_21","text":"\u7279\u6b8a\u5b57\u7b26 & \u7528\u4e8e\u5b58\u50a8\u5339\u914d\u6a21\u5f0f\u7684\u5185\u5bb9\uff0c\u901a\u5e38\u4e0e\u66ff\u6362\u547d\u4ee4 s \u4e00\u8d77\u4f7f\u7528\u3002 $ sed 's/[[:digit:]]/Book number &/' books.txt Book number 1) Storm of Swords, George R. R. Martin, 1216 Book number 2) The Two Towers, J. R. R. Tolkien, 352 Book number 3) The Alchemist, Paulo Coelho, 197 Book number 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 Book number 5) The Pilgrimage, Paulo Coelho, 288 Book number 6) A Game of Thrones, George R. R. Martin, 864 \u4e0a\u8ff0\u547d\u4ee4\u7528\u4e8e\u5339\u914d\u6bcf\u4e00\u884c\u7b2c\u4e00\u4e2a\u6570\u5b57\uff0c\u5728\u5176\u524d\u9762\u6dfb\u52a0 Book number \u3002\u800c\u4e0b\u9762\u8fd9\u4e2a\u547d\u4ee4\u5219\u5339\u914d\u6700\u540e\u4e00\u4e2a\u6570\u5b57\uff0c\u5e76\u4fee\u6539\u4e3a Pages = \u3002\u5176\u4e2d [[:digit:]]* *$ \u53ef\u80fd\u6bd4\u8f83\u8d39\u89e3\uff0c\u8fd9\u4e00\u90e8\u5206\u5176\u5b9e\u662f\uff1a \u5339\u914d0\u4e2a\u6216\u591a\u4e2a\u6570\u5b57+0\u4e2a\u6216\u591a\u4e2a\u7a7a\u683c+\u884c\u5c3e \u3002 sed 's/[[:digit:]]* *$/Pages = &/' books.txt 1) Storm of Swords, George R. R. Martin, Pages = 1216 2) The Two Towers, J. R. R. Tolkien, Pages = 352 3) The Alchemist, Paulo Coelho, Pages = 197 4) The Fellowship of the Ring, J. R. R. Tolkien, Pages = 432 5) The Pilgrimage, Paulo Coelho, Pages = 288 6) A Game of Thrones, George R. R. Martin, Pages = 864","title":"&amp;\u547d\u4ee4"},{"location":"sed/#_22","text":"","title":"\u5b57\u7b26\u4e32"},{"location":"sed/#s","text":"\u6587\u672c\u66ff\u6362\u547d\u4ee4\u975e\u5e38\u5e38\u89c1\uff0c\u5176\u683c\u5f0f\u5982\u4e0b [address1[,address2]]s/pattern/replacement/[flags] \u5728\u524d\u9762\u6211\u4eec\u4f7f\u7528\u7684 books.txt \u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u9017\u53f7\u201c , \u201d\u5206\u9694\u6bcf\u4e00\u5217\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f1a\u4f7f\u7528\u66ff\u6362\u547d\u4ee4\u5c06\u5176\u66ff\u6362\u4e3a\u7ba1\u9053\u7b26\u201c | \u201d\uff1a $ sed 's/,/ |/' books.txt 1) Storm of Swords | George R. R. Martin, 1216 2) The Two Towers | J. R. R. Tolkien, 352 3) The Alchemist | Paulo Coelho, 197 4) The Fellowship of the Ring | J. R. R. Tolkien, 432 5) The Pilgrimage | Paulo Coelho, 288 6) A Game of Thrones | George R. R. Martin, 864 \u662f\u4e0d\u662f\u89c9\u5f97\u54ea\u91cc\u4e0d\u5bf9\uff1f\u76f8\u4fe1\u4f60\u5df2\u7ecf\u53d1\u73b0\uff0c\u6bcf\u4e00\u884c\u7684\u7b2c\u4e8c\u4e2a\u9017\u53f7\u90fd\u6ca1\u6709\u88ab\u66ff\u6362\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2a\u88ab\u66ff\u6362\u4e86\uff0c\u786e\u5b9e\u5982\u6b64\uff0c\u5728SED\u4e2d\uff0c\u4f7f\u7528\u66ff\u6362\u547d\u4ee4\u7684\u65f6\u5019\u9ed8\u8ba4\u53ea\u4f1a\u5bf9\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u4f4d\u7f6e\u8fdb\u884c\u66ff\u6362\u3002\u4f7f\u7528 g \u9009\u9879\u544a\u8bc9SED\u5bf9\u6240\u6709\u5185\u5bb9\u8fdb\u884c\u66ff\u6362\uff1a $ sed 's/,/ | /g' books.txt 1) Storm of Swords | George R. R. Martin | 1216 2) The Two Towers | J. R. R. Tolkien | 352 3) The Alchemist | Paulo Coelho | 197 4) The Fellowship of the Ring | J. R. R. Tolkien | 432 5) The Pilgrimage | Paulo Coelho | 288 6) A Game of Thrones | George R. R. Martin | 864 \u5982\u679c\u5bf9\u5339\u914d\u6a21\u5f0f\uff08\u6216\u5730\u5740\u8303\u56f4\uff09\u7684\u884c\u8fdb\u884c\u66ff\u6362\uff0c\u5219\u53ea\u9700\u8981\u5728 s \u547d\u4ee4\u524d\u6dfb\u52a0\u5730\u5740\u5373\u53ef\u3002\u6bd4\u5982\u53ea\u66ff\u6362\u5339\u914d The Pilgrimage \u7684\u884c\uff1a sed '/The Pilgrimage/ s/,/ | /g' books.txt \u8fd8\u6709\u4e00\u4e9b\u5176\u5b83\u7684\u9009\u9879\uff0c\u8fd9\u91cc\u5c31\u7b80\u5355\u7684\u63cf\u8ff0\u4e00\u4e0b\uff0c\u4e0d\u5728\u5c55\u5f00\u8bb2\u89e3 \u6570\u5b57n : \u53ea\u66ff\u6362\u7b2cn\u6b21\u5339\u914d\uff0c\u6bd4\u5982 sed 's/,/ | /2' books.txt \uff0c\u53ea\u66ff\u6362\u6bcf\u884c\u4e2d\u7b2c\u4e8c\u4e2a\u9017\u53f7 p \uff1a\u53ea\u8f93\u51fa\u6539\u53d8\u7684\u884c\uff0c\u6bd4\u5982 sed -n 's/Paulo Coelho/PAULO COELHO/p' books.txt w \uff1a\u5b58\u50a8\u6539\u53d8\u7684\u884c\u5230\u6587\u4ef6\uff0c\u6bd4\u5982 sed -n 's/Paulo Coelho/PAULO COELHO/w junk.txt' books.txt i \uff1a\u5339\u914d\u65f6\u5ffd\u7565\u5927\u5c0f\u5199\uff0c\u6bd4\u5982 sed -n 's/pAuLo CoElHo/PAULO COELHO/pi' books.txt \u5728\u6267\u884c\u66ff\u6362\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u5982\u679c\u8981\u66ff\u6362\u7684\u5185\u5bb9\u4e2d\u5305\u542b / \uff0c\u8fd9\u4e2a\u65f6\u5019\u600e\u4e48\u529e\uff1f\u5f88\u7b80\u5355\uff0c\u6dfb\u52a0\u8f6c\u4e49\u64cd\u4f5c\u7b26\u3002 $ echo \"/bin/sed\" | sed 's/\\/bin\\/sed/\\/home\\/mylxsw\\/src\\/sed\\/sed-4.2.2\\/sed/' /home/mylxsw/src/sed/sed-4.2.2/sed \u4e0a\u9762\u7684\u547d\u4ee4\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 \\ \u5bf9 / \u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u4e0d\u8fc7\u8868\u8fbe\u5f0f\u5df2\u7ecf\u770b\u8d77\u6765\u975e\u5e38\u96be\u770b\u4e86\uff0c\u5728SED\u4e2d\u8fd8\u53ef\u4ee5\u4f7f\u7528 | \uff0c @ \uff0c ^ \uff0c ! \u4f5c\u4e3a\u547d\u4ee4\u7684\u5206\u9694\u7b26\uff0c\u6240\u4ee5\uff0c\u4e0b\u9762\u7684\u51e0\u4e2a\u547d\u4ee4\u548c\u4e0a\u9762\u7684\u662f\u7b49\u4ef7\u7684 echo \"/bin/sed\" | sed 's|/bin/sed|/mylxsw/mylxsw/src/sed/sed-4.2.2/sed|' echo \"/bin/sed\" | sed 's@/bin/sed@/home/mylxsw/src/sed/sed-4.2.2/sed@' echo \"/bin/sed\" | sed 's^/bin/sed^/home/mylxsw/src/sed/sed-4.2.2/sed^' echo \"/bin/sed\" | sed 's!/bin/sed!/home/mylxsw/src/sed/sed-4.2.2/sed!'","title":"\u66ff\u6362\u547d\u4ee4 s"},{"location":"sed/#_23","text":"\u524d\u9762\u6211\u4eec\u5b66\u4e60\u4e86\u66ff\u6362\u547d\u4ee4\u7684\u7528\u6cd5\uff0c\u73b0\u5728\u8ba9\u6211\u4eec\u770b\u770b\u5982\u4f55\u83b7\u53d6\u5339\u914d\u6587\u672c\u4e2d\u7684\u67d0\u4e2a\u5b50\u4e32\u3002 \u5728SED\u4e2d\uff0c\u4f7f\u7528 \\( \u548c \\) \u5bf9\u5339\u914d\u7684\u5185\u5bb9\u8fdb\u884c\u5206\u7ec4\uff0c\u4f7f\u7528 \\N \u7684\u65b9\u5f0f\u8fdb\u884c\u5f15\u7528\u3002\u8bf7\u770b\u4e0b\u9762\u793a\u4f8b $ echo \"Three One Two\" | sed 's|\\(\\w\\+\\) \\(\\w\\+\\) \\(\\w\\+\\)|\\2 \\3 \\1|' One Two Three \u6211\u4eec\u8f93\u51fa\u4e86 Three \uff0c One \uff0c Two \u4e09\u4e2a\u5355\u8bcd\uff0c\u5728SED\u7684\u66ff\u6362\u89c4\u5219\u4e2d\uff0c\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u4e86\u4e09\u5c0f\u6bb5\u6b63\u5219\u8868\u8fbe\u5f0f \\(\\w\\+\\) \u6765\u5339\u914d\u6bcf\u4e00\u4e2a\u5355\u8bcd\uff0c\u540e\u9762\u4f7f\u7528 \\1 \uff0c\uff0c \\2 \uff0c \\3 \u5206\u522b\u5f15\u7528\u5b83\u4eec\u7684\u503c\u3002","title":"\u5339\u914d\u5b50\u5b57\u7b26\u4e32"},{"location":"sed/#_24","text":"\u524d\u9762\u5df2\u7ecf\u8bb2\u89e3\u8fc7\u6a21\u5f0f\u7a7a\u95f4\u548c \u4fdd\u6301\u7a7a\u95f4 \u7684\u7528\u6cd5\uff0c\u5728\u672c\u8282\u4e2d\u6211\u4eec\u5c06\u4f1a\u7ee7\u7eed\u63a2\u7d22\u5b83\u4eec\u7684\u7528\u6cd5\u3002 \u672c\u90e8\u5206\u5185\u5bb9\u6682\u672a\u66f4\u65b0\uff0c\u8bf7\u5173\u6ce8 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6211\u5c06\u6700\u5148\u5728Github\u7684\u8fd9\u4e2a\u4ed3\u5e93\u4e2d\u66f4\u65b0\u6700\u65b0\u5185\u5bb9\u3002","title":"\u7ba1\u7406\u6a21\u5f0f"},{"location":"sed/#_25","text":"\u8fd9\u4e00\u90e8\u5206\u5c31\u662f\u6807\u51c6\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u4ee5\u5143\u5b57\u7b26\uff0c\u6bd4\u8f83\u719f\u6089\u7684\u8bf7\u7565\u8fc7\u3002","title":"\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"sed/#_26","text":"","title":"\u6807\u51c6\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"sed/#_27","text":"\u5339\u914d\u884c\u7684\u5f00\u59cb\u3002 $ sed -n '/^The/ p' books2.txt The Two Towers, J. R. R. Tolkien The Alchemist, Paulo Coelho The Fellowship of the Ring, J. R. R. Tolkien The Pilgrimage, Paulo Coelho","title":"^"},{"location":"sed/#_28","text":"\u5339\u914d\u884c\u7684\u7ed3\u5c3e $ sed -n '/Coelho$/ p' books2.txt The Alchemist, Paulo Coelho The Pilgrimage, Paulo Coelho","title":"$"},{"location":"sed/#_29","text":"\u5339\u914d\u5355\u4e2a\u5b57\u7b26\uff08\u9664\u884c\u5c3e\uff09 $ echo -e \"cat\\nbat\\nrat\\nmat\\nbatting\\nrats\\nmats\" | sed -n '/^..t$/p' cat bat rat mat","title":"."},{"location":"sed/#_30","text":"\u5339\u914d\u5b57\u7b26\u96c6 $ echo -e \"Call\\nTall\\nBall\" | sed -n '/[CT]all/ p' Call Tall","title":"[]"},{"location":"sed/#_31","text":"\u6392\u9664\u5b57\u7b26\u96c6 $ echo -e \"Call\\nTall\\nBall\" | sed -n '/[^CT]all/ p' Ball","title":"[\\^]"},{"location":"sed/#-","text":"\u5b57\u7b26\u8303\u56f4\u3002 $ echo -e \"Call\\nTall\\nBall\" | sed -n '/[C-Z]all/ p' Call Tall","title":"[-]"},{"location":"sed/#_32","text":"\u5206\u522b\u5bf9\u5e940\u6b21\u52301\u6b21\uff0c\u4e00\u6b21\u5230\u591a\u6b21\uff0c0\u6b21\u5230\u591a\u6b21\u5339\u914d\u3002","title":"\\? \uff0c\\+ \uff0c*"},{"location":"sed/#n-n-m-n","text":"\u7cbe\u786e\u5339\u914dN\u6b21\uff0c\u81f3\u5c11\u5339\u914dN\u6b21\uff0c\u5339\u914dM-N\u6b21","title":"{n} \uff0c{n,} \uff0c{m, n}"},{"location":"sed/#_33","text":"\u6216\u64cd\u4f5c\u3002 $ echo -e \"str1\\nstr2\\nstr3\\nstr4\" | sed -n '/str\\(1\\|3\\)/ p' str1 str3","title":"|"},{"location":"sed/#posix","text":"\u4e3b\u8981\u5305\u542b [:alnum:] \uff0c [:alpha:] \uff0c [:blank:] \uff0c [:digit:] \uff0c [:lower:] \uff0c [:upper:] \uff0c [:punct:] \uff0c [:space:] \uff0c\u8fd9\u4e9b\u57fa\u672c\u90fd\u89c1\u540d\u4e4b\u610f\uff0c\u4e0d\u5728\u8d58\u8ff0\u3002","title":"POSIX\u517c\u5bb9\u7684\u6b63\u5219"},{"location":"sed/#_34","text":"","title":"\u5143\u5b57\u7b26"},{"location":"sed/#s_1","text":"\u5339\u914d\u5355\u4e2a\u7a7a\u767d\u5185\u5bb9 $ echo -e \"Line\\t1\\nLine2\" | sed -n '/Line\\s/ p' Line 1","title":"\\s"},{"location":"sed/#s_2","text":"\u5339\u914d\u5355\u4e2a\u975e\u7a7a\u767d\u5185\u5bb9\u3002","title":"\\S"},{"location":"sed/#w-w","text":"\u5355\u4e2a\u5355\u8bcd\u3001\u975e\u5355\u8bcd\u3002","title":"\\w \uff0c \\W"},{"location":"sed/#_35","text":"","title":"\u5e38\u7528\u4ee3\u7801\u6bb5"},{"location":"sed/#cat","text":"\u6a21\u62df cat \u547d\u4ee4\u6bd4\u8f83\u7b80\u5355\uff0c\u6709\u4e0b\u9762\u4e24\u79cd\u65b9\u5f0f $ sed '' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864 $ sed -n 'p' books.txt 1) Storm of Swords, George R. R. Martin, 1216 2) The Two Towers, J. R. R. Tolkien, 352 3) The Alchemist, Paulo Coelho, 197 4) The Fellowship of the Ring, J. R. R. Tolkien, 432 5) The Pilgrimage, Paulo Coelho, 288 6) A Game of Thrones, George R. R. Martin, 864","title":"Cat\u547d\u4ee4"},{"location":"sed/#_36","text":"$ echo -e \"Line #1\\n\\n\\nLine #2\" | sed '/^$/d' Line #1 Line #2","title":"\u79fb\u9664\u7a7a\u884c"},{"location":"sed/#_37","text":"$ echo -e \"Line #1\\n\\n\\nLine #2\" | sed '/./,/^$/!d' Line #1 Line #2","title":"\u5220\u9664\u8fde\u7eed\u7a7a\u884c"},{"location":"sed/#_38","text":"$ echo -e \"\\nLine #1\\n\\nLine #2\" | sed '/./,$!d' Line #1 Line #2","title":"\u5220\u9664\u5f00\u5934\u7684\u7a7a\u884c"},{"location":"sed/#_39","text":"$ echo -e \"\\nLine #1\\nLine #2\\n\\n\" | sed ':start /^\\n*$/{$d; N; b start }' Line #1 Line #2","title":"\u5220\u9664\u7ed3\u5c3e\u7684\u7a7a\u884c"},{"location":"sed/#html","text":"$ cat html.txt <html> <head> <title>This is the page title</title> </head> <body> <p> This is the <b>first</b> line in the Web page. This should provide some <i>useful</i> information to use in our sed script. </body> </html> $ sed 's/<[^>]*>//g ; /^$/d' html.txt This is the page title This is the first line in the Web page. This should provide some useful information to use in our sed script.","title":"\u8fc7\u6ee4\u6240\u6709\u7684html\u6807\u7b7e"},{"location":"sed/#c_1","text":"\u6709\u4e0b\u9762\u8fd9\u6837\u4e00\u4e2acpp\u6587\u4ef6 $ cat hello.cpp #include <iostream> using namespace std; int main(void) { // Displays message on stdout. cout >> \"Hello, World !!!\" >> endl; return 0; // Return success. } \u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u79fb\u9664\u6ce8\u91ca $ sed 's|//.*||g' hello.cpp #include <iostream> using namespace std; int main(void) { cout >> \"Hello, World !!!\" >> endl; return 0; }","title":"\u4eceC++\u7a0b\u5e8f\u4e2d\u79fb\u9664\u6ce8\u91ca"},{"location":"sed/#_40","text":"$ sed '3,5 s/^/#/' hello.sh #!/bin/bash #pwd #hostname #uname -a who who -r lsb_release -a","title":"\u4e3a\u67d0\u4e9b\u884c\u6dfb\u52a0\u6ce8\u91ca"},{"location":"sed/#wc-l","text":"wc -l \u547d\u4ee4\u7528\u4e8e\u7edf\u8ba1\u6587\u4ef6\u4e2d\u7684\u884c\u6570\uff0c\u4f7f\u7528SED\u4e5f\u53ef\u4ee5\u6a21\u62df\u8be5\u547d\u4ee4 $ wc -l hello.cpp 9 hello.cpp $ sed -n '$ =' hello.cpp 9","title":"\u5b9e\u73b0Wc -l\u547d\u4ee4"},{"location":"sed/#head","text":"head \u547d\u4ee4\u7528\u4e8e\u8f93\u51fa\u6587\u4ef6\u4e2d\u7684\u524d10\u884c\u5185\u5bb9\u3002 $ head books2.txt A Storm of Swords George R. R. Martin The Two Towers J. R. R. Tolkien The Alchemist Paulo Coelho The Fellowship of the Ring J. R. R. Tolkien The Pilgrimage Paulo Coelho \u4f7f\u7528SED\u4e2d\u7684 sed '10 q' \u53ef\u4ee5\u6a21\u62df\u5b83\u7684\u5b9e\u73b0 $ sed '10 q' books.txt A Storm of Swords George R. R. Martin The Two Towers J. R. R. Tolkien The Alchemist Paulo Coelho The Fellowship of the Ring J. R. R. Tolkien The Pilgrimage Paulo Coelho","title":"\u6a21\u62df\u5b9e\u73b0head\u547d\u4ee4"},{"location":"sed/#tail-1","text":"tail -1 \u8f93\u51fa\u6587\u4ef6\u7684\u6700\u540e\u4e00\u884c\u3002 $ cat test.txt Line #1 Line #2 $ tail -1 test.txt Line #2 $ sed $ sed -n '$p' test.txt Line #2","title":"\u6a21\u62dftail -1\u547d\u4ee4"},{"location":"sed/#dos2unix","text":"\u5728DOS\u73af\u5883\u4e2d\uff0c\u6362\u884c\u7b26\u662f\u4f7f\u7528 CR/LF \u4e24\u4e2a\u5b57\u7b26\u4e00\u8d77\u8868\u793a\u7684\uff0c\u4e0b\u9762\u547d\u4ee4\u6a21\u62df\u4e86 dos2unix \u547d\u4ee4\u8f6c\u6362\u8fd9\u4e9b\u6362\u884c\u7b26\u4e3aUNIX\u6362\u884c\u7b26\u3002 \u5728GNU/Linux\u73af\u5883\u4e2d\uff0c CR/LF \u901a\u5e38\u4f7f\u7528\"\\^M\"\uff08\u4e0d\u662f\u7b80\u5355\u7684\u4e24\u4e2a\u7b26\u53f7\u7ec4\u5408\uff0c\u8bf7\u4f7f\u7528\u5feb\u6377\u952eCtrl+v,Ctrl+m\u8f93\u5165\uff09\u8fdb\u884c\u8868\u793a\u3002 $ echo -e \"Line #1\\r\\nLine #2\\r\" > test.txt $ file test.txt test.txt: ASCII text, with CRLF line terminators $ sed 's/^M$//' test.txt > new.txt $ file new.txt new.txt: ASCII text $ cat -vte new.txt Line #1$ Line #2$","title":"\u6a21\u62dfDos2unix\u547d\u4ee4"},{"location":"sed/#unix2dos","text":"$ file new.txt new.txt: ASCII text $ sed 's/$/\\r/' new.txt > new2.txt $ file new2.txt new2.txt: ASCII text, with CRLF line terminators $ cat -vte new2.txt Line #1^M$ Line #2^M$","title":"\u6a21\u62dfUnix2dos\u547d\u4ee4"},{"location":"sed/#cat-e","text":"cat -E \u547d\u4ee4\u4f1a\u5728\u6bcf\u4e00\u884c\u7684\u884c\u5c3e\u8f93\u51fa\u4e00\u4e2a $ \u7b26\u53f7\u3002 $ echo -e \"Line #1\\nLine #2\" | cat -E Line #1$ Line #2$ $ echo -e \"Line #1\\nLine #2\" | sed 's|$|&$|' Line #1$ Line #2$ \u6ce8\u610f\uff0c\u5728Mac\u4e0b\u4e0d\u652f\u6301 cat -E \uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528sed\u4ee3\u66ff","title":"\u6a21\u62dfcat -E\u547d\u4ee4"},{"location":"sed/#cat-et","text":"cat -ET \u547d\u4ee4\u4e0d\u4ec5\u5bf9\u6bcf\u4e00\u884c\u7684\u884c\u5c3e\u6dfb\u52a0 $ \uff0c\u8fd8\u4f1a\u5c06\u6bcf\u4e00\u884c\u4e2d\u7684TAB\u663e\u793a\u4e3a ^I \u3002 $ echo -e \"Line #1\\tLine #2\" | cat -ET Line #1^ILine #2$ $ echo -e \"Line #1\\tLine #2\" | sed -n 'l' | sed 'y/\\\\t/^I/' Line #1^ILine #2$","title":"\u6a21\u62dfcat -ET\u547d\u4ee4"},{"location":"sed/#nl","text":"\u547d\u4ee4 nl \u53ef\u4ee5\u4e3a\u8f93\u5165\u5185\u5bb9\u7684\u6bcf\u4e00\u884c\u6dfb\u52a0\u884c\u53f7\uff0c\u8bb0\u5f97\u4e4b\u524d\u4ecb\u7ecd\u7684 = \u64cd\u4f5c\u7b26\u5427\uff0c\u5728SED\u4e2d\u6211\u4eec\u53ef\u4ee5\u7528\u5b83\u6765\u5b9e\u73b0\u4e0e nl \u547d\u4ee4\u7c7b\u4f3c\u7684\u529f\u80fd\u3002 $ echo -e \"Line #1\\nLine #2\" |nl 1 Line #1 2 Line #2 $ echo -e \"Line #1\\nLine #2\" | sed = | sed 'N;s/\\n/\\t/' 1 Line #1 2 Line #2 \u4e0a\u9762\u7684SED\u547d\u4ee4\u4f7f\u7528\u4e86\u4e24\u6b21\uff0c\u7b2c\u4e00\u6b21\u4f7f\u7528 = \u64cd\u4f5c\u7b26\u4e3a\u6bcf\u4e00\u884c\u8f93\u51fa\u884c\u53f7\uff0c\u6ce8\u610f\u8fd9\u4e2a\u884c\u53f7\u662f\u72ec\u5360\u4e00\u884c\u7684\uff0c\u56e0\u6b64\u4f7f\u7528\u7ba1\u9053\u7b26\u8fde\u63a5\u4e86\u7b2c\u4e8c\u4e2aSED\u547d\u4ee4\uff0c\u6bcf\u6b21\u8bfb\u53d6\u4e24\u884c\uff0c\u5c06\u6362\u884c\u7b26\u66ff\u6362\u4e3aTab\uff0c\u8fd9\u6837\u5c31\u6a21\u62df\u51fa\u4e86 nl \u547d\u4ee4\u7684\u6548\u679c\u3002","title":"\u6a21\u62dfnl\u547d\u4ee4"},{"location":"sed/#cp","text":"$ sed -n 'w dup.txt' data.txt $ diff data.txt dup.txt $ echo $? 0","title":"\u6a21\u62dfcp\u547d\u4ee4"},{"location":"sed/#expand","text":"expand \u547d\u4ee4\u4f1a\u8f6c\u6362\u8f93\u5165\u4e2d\u7684TAB\u4e3a\u7a7a\u683c\uff0c\u5728SED\u4e2d\u4e5f\u53ef\u4ee5\u6a21\u62df\u5b83 $ echo -e \"One\\tTwo\\tThree\" > test.txt $ expand test.txt > expand.txt $ sed 's/\\t/ /g' test.txt > new.txt $ diff new.txt expand.txt $ echo $? 0","title":"\u6a21\u62dfexpand\u547d\u4ee4"},{"location":"sed/#tee","text":"tee \u547d\u4ee4\u4f1a\u5c06\u6570\u636e\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u7684\u540c\u65f6\u5199\u5165\u6587\u4ef6\u3002 $ echo -e \"Line #1\\nLine #2\" | tee test.txt Line #1 Line #2 \u5728SED\u4e2d\uff0c\u5b9e\u73b0\u8be5\u547d\u4ee4\u975e\u5e38\u7b80\u5355 $ sed -n 'p; w new.txt' test.txt One Two Three","title":"\u6a21\u62dftee\u547d\u4ee4"},{"location":"sed/#cat-s","text":"cat -s \u547d\u4ee4\u4f1a\u5c06\u8f93\u5165\u6587\u4ef6\u4e2d\u7684\u591a\u884c\u7a7a\u884c\u5408\u5e76\u4e3a\u4e00\u884c\u3002 $ echo -e \"Line #1\\n\\n\\n\\nLine #2\\n\\n\\nLine #3\" | cat -s Line #1 Line #2 Line #3 \u5728SED\u4e2d\u5b9e\u73b0 $ echo -e \"Line #1\\n\\n\\n\\nLine #2\\n\\n\\nLine #3\" | sed '1s/^$//p;/./,/^$/!d' Line #1 Line #2 Line #3 \u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u7684\u662f /./,/^$/!d \u8fd9\u4e2a\u547d\u4ee4\uff0c\u5b83\u7684\u610f\u601d\u662f\u5339\u914d\u533a\u95f4 /./ \u5230 /^$ \uff0c\u533a\u95f4\u7684\u5f00\u59cb\u4f1a\u5339\u914d\u81f3\u5c11\u5305\u542b\u4e00\u4e2a\u5b57\u7b26\u7684\u884c\uff0c\u7ed3\u675f\u4f1a\u5339\u914d\u4e00\u4e2a\u7a7a\u884c\uff0c\u5728\u8fd9\u4e2a\u533a\u95f4\u4e2d\u7684\u884c\u4e0d\u4f1a\u88ab\u5220\u9664\u3002","title":"\u6a21\u62dfcat -s\u547d\u4ee4"},{"location":"sed/#grep","text":"$ echo -e \"Line #1\\nLine #2\\nLine #3\" | grep 'Line #1' Line #1 $ echo -e \"Line #1\\nLine #2\\nLine #3\" | sed -n '/Line #1/p' Line #1","title":"\u6a21\u62dfgrep\u547d\u4ee4"},{"location":"sed/#grep-v","text":"$ echo -e \"Line #1\\nLine #2\\nLine #3\" | grep -v 'Line #1' Line #2 Line #3 $ echo -e \"Line #1\\nLine #2\\nLine #3\" | sed -n '/Line #1/!p' Line #2 Line #3","title":"\u6a21\u62dfgrep -v\u547d\u4ee4"},{"location":"sed/#tr","text":"tr \u547d\u4ee4\u7528\u4e8e\u5b57\u7b26\u8f6c\u6362 $ echo \"ABC\" | tr \"ABC\" \"abc\" abc $ echo \"ABC\" | sed 'y/ABC/abc/' abc","title":"\u6a21\u62dftr\u547d\u4ee4"},{"location":"sed/#_41","text":"\u770b\u5230\u8fd9\u91cc\uff0c\u4f60\u80af\u5b9a\u8981\u5410\u69fd\u4e86\uff0c\u4e0d\u662f\u8bf4\u4e86\u4e09\u5341\u5206\u949f\u5b66\u4f1a\u5417\uff1f\u4f60\u786e\u5b9a\u4f60\u80fd\u4e09\u5341\u5206\u949f\u5b66\u4f1a\uff1f\u4e0a\u6b21\u7684[\u4e09\u5341\u5206\u949f\u5b66\u4f1aAWK][]\u8bf4\u4e09\u5341\u5206\u949f\u5b66\u4f1a\u4e0d\u9760\u8c31\uff0c\u8fd9\u6b21\u53c8\u4e0d\u9760\u8c31\u4e86\u3002\u4e0d\u597d\u610f\u601d\uff0c\u8fd9\u91cc\u7684\u4e09\u5341\u5206\u949f\u5176\u5b9e\u53ea\u662f\u4e3a\u4e86\u5438\u5f15\u4f60\u7684\u6ce8\u610f\u800c\u5df2\uff0c\u53ea\u6709\u5728\u4f60\u5df2\u7ecf\u7528\u8fc7SED\u5e76\u5bf9\u5b83\u7684\u4e00\u4e9b\u7279\u6027\u6709\u6240\u4e86\u89e3\u7684\u60c5\u51b5\u4e0b\u4e09\u5341\u5206\u949f\u770b\u5b8c\u624d\u662f\u6709\u53ef\u80fd\u7684\uff0c\u6bd5\u7adf\u90a3\u4e48\u591a\u7279\u6b8a\u5b57\u7b26\uff0c\u90a3\u4e48\u591a\u547d\u4ee4\u9700\u8981\u8bb0\u4f4f\u3002\u4e0d\u8fc7\u8bdd\u8bf4\u56de\u6765\uff0c\u770b\u5b8c\u4e4b\u540e\u4f60\u6709\u6536\u83b7\u5417\uff1f\u6709\u7684\u8bdd\uff0c\u90a3\u672c\u6587\u7684\u76ee\u7684\u5c31\u8fbe\u5230\u4e86\uff0c\u4e4b\u540e\u7528\u5230SED\u7684\u65f6\u5019\u518d\u56de\u6765\u53c2\u8003\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002 \u672c\u6587\u5c06\u4f1a\u6301\u7eed\u4fee\u6b63\u548c\u66f4\u65b0\uff0c\u6700\u65b0\u5185\u5bb9\u8bf7\u53c2\u8003\u6211\u7684 GITHUB \u4e0a\u7684 \u7a0b\u5e8f\u733f\u6210\u957f\u8ba1\u5212 \u9879\u76ee\uff0c\u6b22\u8fce Star\u3002","title":"\u5199\u5728\u6700\u540e"},{"location":"sed/#_42","text":"Sed Tutorial Linux\u547d\u4ee4\u884c\u4e0eshell\u811a\u672c\u7f16\u7a0b\u5927\u5168\uff08\u7b2c3\u7248\uff09","title":"\u53c2\u8003"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/","text":"\u30bf\u30b0VLAN \u3068\u306f \u00b6 \u30bf\u30b0VLAN (Tag VLAN) \u3068\u306f\u3001\u8907\u6570\u306eVLAN\u30921\u672c\u306eLAN\u63a5\u7d9a\u3060\u3051\u3067\u8907\u6570\u30b9\u30a4\u30c3\u30c1\u9593\u3067\u5171\u6709\u3067\u304d\u308b\u6280\u8853\u3067\u3059\u3002 IEEE802.1q \u3068\u3044\u3046\u898f\u683c\u3067\u898f\u5b9a\u3055\u308c\u3066\u304a\u308a\u3001VLAN ID \u306f 1\uff5e4094 \u304c\u4f7f\u3048\u307e\u3059\u3002 \u5177\u4f53\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30b9\u30a4\u30c3\u30c1\u540c\u58eb\u3092\u63a5\u7d9a\u3059\u308b\u30dd\u30fc\u30c8\u306b trunk port (\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3002 tag port \u3068\u547c\u3070\u308c\u305f\u308a\u3057\u307e\u3059) \u306e\u8a2d\u5b9a\u3092\u5165\u308c\u3066\u63a5\u7d9a\u3057\u307e\u3059\u3002 \u3059\u308b\u3068 \u305d\u306e\u30ea\u30f3\u30af(\u30c8\u30e9\u30f3\u30af\u30ea\u30f3\u30af)\u306f VLAN ID \u60c5\u5831\u3092\u542b\u3080 Tag \u3092\u4ed8\u3051\u3066\u901a\u4fe1\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059 \u3002 \u4f8b\u3067\u306f VLAN \u304c 3 \u3064\u3060\u3051\u3067\u3059\u306e\u3067\u3001\u5404VLAN 1\u672c\u305a\u3064\u3001 \u7cfb3\u672c\u306e\u30b1\u30fc\u30d6\u30eb\u3092\u30b9\u30a4\u30c3\u30c1\u9593\u3067\u63a5\u7d9a\u3059\u308b\u69cb\u6210\u3082\u53ef\u80fd\u3067\u3059\u304c\u3053\u308c\u306f\u975e\u52b9\u7387\u3067\u3059\u3002 \u4f8b\u3048\u3070\u3053\u308c\u304c\u3001VLAN \u304c20\u500b\u3042\u3063\u305f\u3068\u3057\u305f\u3089\u305d\u308c\u3060\u3051\u3067\u30b1\u30fc\u30d6\u30eb\u3068\u30dd\u30fc\u30c8\u309220\u30dd\u30fc\u30c8\u3082\u6d88\u8cbb\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002 \u3053\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u3067\u3082\u3001\u30bf\u30b0 VLAN \u3092\u4f7f\u3048\u3070 1 \u30dd\u30fc\u30c8\u3060\u3051\u3067 20 \u500b\u306e VLAN \u3092\u5171\u6709\u3067\u304d\u307e\u3059\u3002 Native VLAN (PVID) \u3068\u306f \u00b6 Native VLAN \u3068\u306f\u3001 \u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u306e\u4e2d\u3067\u3001\u30bf\u30b0\u3092\u4ed8\u3051\u306a\u3044 VLAN ID \u306e\u3053\u3068 \u3092\u6307\u3057\u307e\u3059\u3002 \u30c7\u30d5\u30a9\u30eb\u30c8VLAN \u3084 PVID (Port VLAN ID) \u3082\u540c\u3058\u610f\u5473\u3067\u3059\u3002 \u3053\u306e Native VLAN \u3082 IEEE802.1q \u306e\u898f\u683c\u3067\u6c7a\u307e\u3063\u3066\u304a\u308a\u3001 \u5404\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u30671\u3064\u3060\u3051\u3001\u3053\u306e Native VLAN \u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059 \uff08\u6a5f\u5668\u5358\u4f4d\u3067\u306f\u306a\u304f\u30dd\u30fc\u30c8\u5358\u4f4d\u3067\u6307\u5b9a\u3067\u304d\u308b\u3082\u306e\u304c\u591a\u3044\u3067\u3059\uff09\u3002 \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u5168\u30dd\u30fc\u30c8 VLAN ID=1 \u304c Native VLAN \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002 Native VLAN \u306e\u4e0d\u4e00\u81f4 \u00b6 \u4e0a\u56f3\u5de6\u5074\u306e\u4f8b\u306b\u793a\u3057\u305f\u901a\u308a\u3001 Native VLAN \u306f\u30c8\u30e9\u30f3\u30af\u30ea\u30f3\u30af\u306e\u4e21\u7aef\u3067\u63c3\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059 \uff08\u30b9\u30a4\u30c3\u30c1\u306e\u5168\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3067\u305d\u308d\u3048\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\uff09\u3002 \u3082\u3057\u63c3\u3048\u306a\u3044\u3068 \u3001\u4f8b\u306e\u53f3\u5074\u306e\u300c\u60aa\u3044\u4f8b\u300d\u306e\u3088\u3046\u306b\u3001VLAN 1 \u306e\u901a\u4fe1\u304c VLAN 2 \u306b\u6df7\u5165\u3057\u305f\u308a\u3068\u3001 \u8ad6\u7406\u69cb\u6210\u306b\u637b\u3058\u308c\u304c\u767a\u751f\u3057\u305f\u308a\u3057\u307e\u3059 \u3002 Native VLAN \u306e\u4e0d\u4e00\u81f4\u306f\u3001\u7279\u306b PVSTP\u3067\u306f\u30eb\u30fc\u30d7\u306e\u691c\u77e5\u304c\u51fa\u6765\u306a\u304f\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u305f\u3081\u3001 \u30a8\u30e9\u30fc\u306b\u3082\u51fa\u529b\u3055\u308c\u307e\u3059\u3002 \u306a\u304a\u3001 CDP (Cisco Discovery Protocol) \u306b\u306f Native VLAN \u60c5\u5831\u3082\u4e57\u3063\u3066\u304a\u308a\u3001\u4e0d\u4e00\u81f4\u304c\u3042\u308b\u3068 \"%CDP-4-NATIVE_VLAN_MISMATCH: Native VLAN mismatch discovered on \" \u3068\u3044\u3063\u305f\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002 \u3069\u3046\u3044\u3046\u6642\u306b\u30cd\u30a4\u30c6\u30a3\u30d6VLAN\u3092\u5909\u66f4\u3059\u308b\uff1f \u00b6 \u5909\u66f4\u3059\u308b\u7406\u7531\u306f\u57fa\u672c\u7684\u306b\u306f\u7121\u3044\u306f\u305a\u3067\u3059\u304c\u3001\u30b1\u30fc\u30b9\u3068\u3057\u30662\u3064\u4f8b\u3092\u6319\u3052\u307e\u3059\u3002 1\u3064\u76ee\u306f\u3001\u4f8b\u3048\u3070\u30cd\u30a4\u30c6\u30a3\u30d6 VLAN \u3092 10 \u306b\u3059\u308b\u3068\u3001 \u305d\u306e\u30dd\u30fc\u30c8\u306b PC \u3084 VLAN \u975e\u5bfe\u5fdc\u306e\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30cf\u30d6\u3092\u63a5\u7d9a\u3059\u308b\u3068\u3001 VLAN 10 \u3067\u901a\u4fe1\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u3042\u305f\u308a\u306f\u4e0b\u8a18\u8a18\u4e8b\u306b\u3082\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002 \u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3068\u30a2\u30af\u30bb\u30b9\u30dd\u30fc\u30c8\u306e\u9055\u3044\u3001trunk port \u306b access port \u3084 PC \u3092\u63a5\u7d9a\u3059\u308b\u3068\u3069\u3046\u306a\u308b\u304b 2\u3064\u76ee\u306f\u30011\u3064\u76ee\u306b\u95a2\u9023\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8 VLAN \u3067\u3042\u308b VLAN 1 \u306f\u3001 telnet \u63a5\u7d9a\u7528\u7b49\u306e \u7ba1\u7406\u7528\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u3053\u3068\u3082\u591a\u3044\u3067\u3059 \u3002 \u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3092\u4e00\u822c\u30e6\u30fc\u30b6\u304c\u7269\u7406\u7684\u306b\u3044\u3058\u308c\u308b\u4f4d\u7f6e\u306b\u3042\u308b\u3068\u3001 \u305d\u306e \u30dd\u30fc\u30c8\u3092\u5f15\u3063\u3053\u629c\u3044\u3066 PC \u306b\u63a5\u7d9a\u3059\u308b\u3068 VLAN 1 \u3078\u30a2\u30af\u30bb\u30b9\u3067\u304d\u3066\u3057\u307e\u3044\u307e\u3059 \u3002 \u305d\u306e\u3088\u3046\u306a\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u7406\u7531\u3067\u3001\u9069\u5f53\u306a VLAN \u306b\u5909\u66f4\u3059\u308b\u30b1\u30fc\u30b9\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u3002 access\u30dd\u30fc\u30c8\u3001trunk\u30dd\u30fc\u30c8\u3068tagged, untagged\u306b\u3064\u3044\u3066 \u00b6 \u30e1\u30fc\u30ab\u306b\u3088\u3063\u3066\u306f\u3001 access \u30dd\u30fc\u30c8 \u3001 trunk \u30dd\u30fc\u30c8 \u3068\u3044\u3046\u62ec\u308a\u304c\u306a\u304f\u3001 \u5358\u7d14\u306b\u30dd\u30fc\u30c8\u5358\u4f4d\u3067 tagged \u3001 untagged \u306eVLAN ID \u3092\u6307\u5b9a\u3059\u308b\u30b9\u30a4\u30c3\u30c1\u3082\u3042\u308a\u307e\u3059\u3002 \u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5bfe\u5fdc\u306b\u306a\u308a\u307e\u3059\u3002 access, trunk tagged, untagged access vlan=10 untagged=10 trunk vlan=10,20 tagged=10,20 trunk vlan=20(native vlan), 30,40 untagged=20, tagged=30,40 \u5404\u30dd\u30fc\u30c8\u3067 untagged \u306e VLAN \u306f 0\uff5e1\u500b\u3001tagged \u306e VLAN \u306f0\u500b\u4ee5\u4e0a\u3067\u3059\u3002 \u4e21\u65b9\u3068\u3082 0 \u500b\u306b\u306a\u308b\u3053\u3068\u306f\u306a\u304f\u3001untagged \u304c 1 \u500b\u3060\u3051\u306a\u3089\u305d\u306e\u30dd\u30fc\u30c8\u306f\u30a2\u30af\u30bb\u30b9\u30dd\u30fc\u30c8\u3001 \u305d\u3053\u306b tagged \u30821\u500b\u4ee5\u4e0a\u4e57\u308b\u306a\u3089\u305d\u308c\u306f\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8(untagged \u306f native VLAN)\u306b\u306a\u308a\u307e\u3059\u3002 Native VLAN \u3092\u30bf\u30b0\u4ed8\u304d\u3067\u53d7\u4fe1\u3057\u305f\u5834\u5408\u306e\u6319\u52d5 \u00b6 Native VLAN \u3084 untagged \u306b\u6307\u5b9a\u3057\u305fVLAN \u3092\u3001\u30bf\u30b0\u4ed8\u304d\u3067\u53d7\u4fe1\u3057\u305f\u5834\u5408\u306e\u6319\u52d5 \u306f\u3001\u30e1\u30fc\u30ab\u306b\u3088\u3063\u3066\u7570\u306a\u308a\u307e\u3059\u3002 \u4f8b\u3048\u3070\u3001Native VLAN=10 \u306b\u8a2d\u5b9a\u3057\u305f\u30dd\u30fc\u30c8\u3067\u3001\u30bf\u30b0\u4ed8\u304d\u306e VLAN 10 \u3092\u53d7\u4fe1\u3057\u305f\u5834\u5408\u3001 \u901a\u5e38\u306e VLAN=10 \u3068\u3057\u3066\u8a31\u53ef\u3059\u308b\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3057\u3001\u7834\u68c4\u3055\u308c\u3066\u3057\u307e\u3046\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u306e\u3067\u3001 \u3082\u3057\u305d\u306e\u3088\u3046\u306a\u69cb\u6210\u3092\u3059\u308b\u5834\u5408\u306f\u4e8b\u524d\u306b\u78ba\u8a8d\u304c\u5fc5\u8981\u3067\u3059\u3002 voice vlan \u3067\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u7406\u7531 \u00b6 voice vlan \u306f\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u306e\u304c cisco \u306e\u63a8\u5968\u3067\u3059\u3002 2 byte \u3068\u306f\u3044\u3048\u3001\u901f\u5ea6\u306b\u30b7\u30d3\u30a2\u306a\u97f3\u58f0\u30d1\u30b1\u30c3\u30c8\u306b\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9\u3068\u3082\u306a\u308b\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u306e\u306f\u4f55\u6545\u3067\u3057\u3087\u3046\u304b\uff1f \u3053\u308c\u306f\u3001 tag vlan \u306b\u306f IEEE802.1p \u3068\u3044\u3046 QoS \u3067\u5229\u7528\u3067\u304d\u308b\u30d5\u30a3\u30fc\u30eb\u30c9 (\u901a\u79f0 cos) \u304c\u3042\u308b\u304b\u3089\u3067\u3059\u3002 \u97f3\u58f0\u30d1\u30b1\u30c3\u30c8\u306f\u3053\u306e cos \u5024\u3092 5 \u306b\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\u30b9\u30a4\u30c3\u30c1\u306b\u300e \u3053\u306e\u30d1\u30b1\u30c3\u30c8\u306f\u512a\u5148\u3067\u901a\u904e\u3055\u305b\u3066\u306d \u300f\u3068\u4f1d\u3048\u308b\u306e\u3067\u3059\u3002 \u306a\u304a\u3001\u5358\u306b cos \u5024\u3092 5 \u306b\u30bb\u30c3\u30c8\u3059\u308b\u3060\u3051\u3067\u306f QoS \u306f\u52d5\u4f5c\u3057\u307e\u305b\u3093\u3002 \u7d4c\u7531\u3059\u308b\u5404\u30b9\u30a4\u30c3\u30c1\u3067\u300e cos \u5024 = 5 \u306e\u30d1\u30b1\u30c3\u30c8\u3092\u512a\u5148\u3067\u51fa\u529b\u3059\u308b \u300f\u3068\u3044\u3046\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002","title":"\u30bf\u30b0VLAN"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#vlan","text":"\u30bf\u30b0VLAN (Tag VLAN) \u3068\u306f\u3001\u8907\u6570\u306eVLAN\u30921\u672c\u306eLAN\u63a5\u7d9a\u3060\u3051\u3067\u8907\u6570\u30b9\u30a4\u30c3\u30c1\u9593\u3067\u5171\u6709\u3067\u304d\u308b\u6280\u8853\u3067\u3059\u3002 IEEE802.1q \u3068\u3044\u3046\u898f\u683c\u3067\u898f\u5b9a\u3055\u308c\u3066\u304a\u308a\u3001VLAN ID \u306f 1\uff5e4094 \u304c\u4f7f\u3048\u307e\u3059\u3002 \u5177\u4f53\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30b9\u30a4\u30c3\u30c1\u540c\u58eb\u3092\u63a5\u7d9a\u3059\u308b\u30dd\u30fc\u30c8\u306b trunk port (\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3002 tag port \u3068\u547c\u3070\u308c\u305f\u308a\u3057\u307e\u3059) \u306e\u8a2d\u5b9a\u3092\u5165\u308c\u3066\u63a5\u7d9a\u3057\u307e\u3059\u3002 \u3059\u308b\u3068 \u305d\u306e\u30ea\u30f3\u30af(\u30c8\u30e9\u30f3\u30af\u30ea\u30f3\u30af)\u306f VLAN ID \u60c5\u5831\u3092\u542b\u3080 Tag \u3092\u4ed8\u3051\u3066\u901a\u4fe1\u3059\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059 \u3002 \u4f8b\u3067\u306f VLAN \u304c 3 \u3064\u3060\u3051\u3067\u3059\u306e\u3067\u3001\u5404VLAN 1\u672c\u305a\u3064\u3001 \u7cfb3\u672c\u306e\u30b1\u30fc\u30d6\u30eb\u3092\u30b9\u30a4\u30c3\u30c1\u9593\u3067\u63a5\u7d9a\u3059\u308b\u69cb\u6210\u3082\u53ef\u80fd\u3067\u3059\u304c\u3053\u308c\u306f\u975e\u52b9\u7387\u3067\u3059\u3002 \u4f8b\u3048\u3070\u3053\u308c\u304c\u3001VLAN \u304c20\u500b\u3042\u3063\u305f\u3068\u3057\u305f\u3089\u305d\u308c\u3060\u3051\u3067\u30b1\u30fc\u30d6\u30eb\u3068\u30dd\u30fc\u30c8\u309220\u30dd\u30fc\u30c8\u3082\u6d88\u8cbb\u3057\u3066\u3057\u307e\u3044\u307e\u3059\u3002 \u3053\u306e\u3088\u3046\u306a\u30b1\u30fc\u30b9\u3067\u3082\u3001\u30bf\u30b0 VLAN \u3092\u4f7f\u3048\u3070 1 \u30dd\u30fc\u30c8\u3060\u3051\u3067 20 \u500b\u306e VLAN \u3092\u5171\u6709\u3067\u304d\u307e\u3059\u3002","title":"\u30bf\u30b0VLAN \u3068\u306f"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#native-vlan-pvid","text":"Native VLAN \u3068\u306f\u3001 \u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u306e\u4e2d\u3067\u3001\u30bf\u30b0\u3092\u4ed8\u3051\u306a\u3044 VLAN ID \u306e\u3053\u3068 \u3092\u6307\u3057\u307e\u3059\u3002 \u30c7\u30d5\u30a9\u30eb\u30c8VLAN \u3084 PVID (Port VLAN ID) \u3082\u540c\u3058\u610f\u5473\u3067\u3059\u3002 \u3053\u306e Native VLAN \u3082 IEEE802.1q \u306e\u898f\u683c\u3067\u6c7a\u307e\u3063\u3066\u304a\u308a\u3001 \u5404\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u30671\u3064\u3060\u3051\u3001\u3053\u306e Native VLAN \u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059 \uff08\u6a5f\u5668\u5358\u4f4d\u3067\u306f\u306a\u304f\u30dd\u30fc\u30c8\u5358\u4f4d\u3067\u6307\u5b9a\u3067\u304d\u308b\u3082\u306e\u304c\u591a\u3044\u3067\u3059\uff09\u3002 \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u5168\u30dd\u30fc\u30c8 VLAN ID=1 \u304c Native VLAN \u306b\u306a\u3063\u3066\u3044\u307e\u3059\u3002","title":"Native VLAN (PVID) \u3068\u306f"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#native-vlan","text":"\u4e0a\u56f3\u5de6\u5074\u306e\u4f8b\u306b\u793a\u3057\u305f\u901a\u308a\u3001 Native VLAN \u306f\u30c8\u30e9\u30f3\u30af\u30ea\u30f3\u30af\u306e\u4e21\u7aef\u3067\u63c3\u3048\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059 \uff08\u30b9\u30a4\u30c3\u30c1\u306e\u5168\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3067\u305d\u308d\u3048\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\uff09\u3002 \u3082\u3057\u63c3\u3048\u306a\u3044\u3068 \u3001\u4f8b\u306e\u53f3\u5074\u306e\u300c\u60aa\u3044\u4f8b\u300d\u306e\u3088\u3046\u306b\u3001VLAN 1 \u306e\u901a\u4fe1\u304c VLAN 2 \u306b\u6df7\u5165\u3057\u305f\u308a\u3068\u3001 \u8ad6\u7406\u69cb\u6210\u306b\u637b\u3058\u308c\u304c\u767a\u751f\u3057\u305f\u308a\u3057\u307e\u3059 \u3002 Native VLAN \u306e\u4e0d\u4e00\u81f4\u306f\u3001\u7279\u306b PVSTP\u3067\u306f\u30eb\u30fc\u30d7\u306e\u691c\u77e5\u304c\u51fa\u6765\u306a\u304f\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u305f\u3081\u3001 \u30a8\u30e9\u30fc\u306b\u3082\u51fa\u529b\u3055\u308c\u307e\u3059\u3002 \u306a\u304a\u3001 CDP (Cisco Discovery Protocol) \u306b\u306f Native VLAN \u60c5\u5831\u3082\u4e57\u3063\u3066\u304a\u308a\u3001\u4e0d\u4e00\u81f4\u304c\u3042\u308b\u3068 \"%CDP-4-NATIVE_VLAN_MISMATCH: Native VLAN mismatch discovered on \" \u3068\u3044\u3063\u305f\u30ed\u30b0\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002","title":"Native VLAN \u306e\u4e0d\u4e00\u81f4"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#vlan_1","text":"\u5909\u66f4\u3059\u308b\u7406\u7531\u306f\u57fa\u672c\u7684\u306b\u306f\u7121\u3044\u306f\u305a\u3067\u3059\u304c\u3001\u30b1\u30fc\u30b9\u3068\u3057\u30662\u3064\u4f8b\u3092\u6319\u3052\u307e\u3059\u3002 1\u3064\u76ee\u306f\u3001\u4f8b\u3048\u3070\u30cd\u30a4\u30c6\u30a3\u30d6 VLAN \u3092 10 \u306b\u3059\u308b\u3068\u3001 \u305d\u306e\u30dd\u30fc\u30c8\u306b PC \u3084 VLAN \u975e\u5bfe\u5fdc\u306e\u30b9\u30a4\u30c3\u30c1\u30f3\u30b0\u30cf\u30d6\u3092\u63a5\u7d9a\u3059\u308b\u3068\u3001 VLAN 10 \u3067\u901a\u4fe1\u3067\u304d\u307e\u3059\u3002\u3053\u306e\u3042\u305f\u308a\u306f\u4e0b\u8a18\u8a18\u4e8b\u306b\u3082\u8a18\u8f09\u3057\u3066\u3044\u307e\u3059\u3002 \u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3068\u30a2\u30af\u30bb\u30b9\u30dd\u30fc\u30c8\u306e\u9055\u3044\u3001trunk port \u306b access port \u3084 PC \u3092\u63a5\u7d9a\u3059\u308b\u3068\u3069\u3046\u306a\u308b\u304b 2\u3064\u76ee\u306f\u30011\u3064\u76ee\u306b\u95a2\u9023\u3059\u308b\u306e\u3067\u3059\u304c\u3001\u30c7\u30d5\u30a9\u30eb\u30c8 VLAN \u3067\u3042\u308b VLAN 1 \u306f\u3001 telnet \u63a5\u7d9a\u7528\u7b49\u306e \u7ba1\u7406\u7528\u3068\u3057\u3066\u4f7f\u308f\u308c\u308b\u3053\u3068\u3082\u591a\u3044\u3067\u3059 \u3002 \u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8\u3092\u4e00\u822c\u30e6\u30fc\u30b6\u304c\u7269\u7406\u7684\u306b\u3044\u3058\u308c\u308b\u4f4d\u7f6e\u306b\u3042\u308b\u3068\u3001 \u305d\u306e \u30dd\u30fc\u30c8\u3092\u5f15\u3063\u3053\u629c\u3044\u3066 PC \u306b\u63a5\u7d9a\u3059\u308b\u3068 VLAN 1 \u3078\u30a2\u30af\u30bb\u30b9\u3067\u304d\u3066\u3057\u307e\u3044\u307e\u3059 \u3002 \u305d\u306e\u3088\u3046\u306a\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u306e\u7406\u7531\u3067\u3001\u9069\u5f53\u306a VLAN \u306b\u5909\u66f4\u3059\u308b\u30b1\u30fc\u30b9\u304c\u8003\u3048\u3089\u308c\u307e\u3059\u3002","title":"\u3069\u3046\u3044\u3046\u6642\u306b\u30cd\u30a4\u30c6\u30a3\u30d6VLAN\u3092\u5909\u66f4\u3059\u308b\uff1f"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#accesstrunktagged-untagged","text":"\u30e1\u30fc\u30ab\u306b\u3088\u3063\u3066\u306f\u3001 access \u30dd\u30fc\u30c8 \u3001 trunk \u30dd\u30fc\u30c8 \u3068\u3044\u3046\u62ec\u308a\u304c\u306a\u304f\u3001 \u5358\u7d14\u306b\u30dd\u30fc\u30c8\u5358\u4f4d\u3067 tagged \u3001 untagged \u306eVLAN ID \u3092\u6307\u5b9a\u3059\u308b\u30b9\u30a4\u30c3\u30c1\u3082\u3042\u308a\u307e\u3059\u3002 \u4f8b\u3048\u3070\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5bfe\u5fdc\u306b\u306a\u308a\u307e\u3059\u3002 access, trunk tagged, untagged access vlan=10 untagged=10 trunk vlan=10,20 tagged=10,20 trunk vlan=20(native vlan), 30,40 untagged=20, tagged=30,40 \u5404\u30dd\u30fc\u30c8\u3067 untagged \u306e VLAN \u306f 0\uff5e1\u500b\u3001tagged \u306e VLAN \u306f0\u500b\u4ee5\u4e0a\u3067\u3059\u3002 \u4e21\u65b9\u3068\u3082 0 \u500b\u306b\u306a\u308b\u3053\u3068\u306f\u306a\u304f\u3001untagged \u304c 1 \u500b\u3060\u3051\u306a\u3089\u305d\u306e\u30dd\u30fc\u30c8\u306f\u30a2\u30af\u30bb\u30b9\u30dd\u30fc\u30c8\u3001 \u305d\u3053\u306b tagged \u30821\u500b\u4ee5\u4e0a\u4e57\u308b\u306a\u3089\u305d\u308c\u306f\u30c8\u30e9\u30f3\u30af\u30dd\u30fc\u30c8(untagged \u306f native VLAN)\u306b\u306a\u308a\u307e\u3059\u3002","title":"access\u30dd\u30fc\u30c8\u3001trunk\u30dd\u30fc\u30c8\u3068tagged, untagged\u306b\u3064\u3044\u3066"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#native-vlan_1","text":"Native VLAN \u3084 untagged \u306b\u6307\u5b9a\u3057\u305fVLAN \u3092\u3001\u30bf\u30b0\u4ed8\u304d\u3067\u53d7\u4fe1\u3057\u305f\u5834\u5408\u306e\u6319\u52d5 \u306f\u3001\u30e1\u30fc\u30ab\u306b\u3088\u3063\u3066\u7570\u306a\u308a\u307e\u3059\u3002 \u4f8b\u3048\u3070\u3001Native VLAN=10 \u306b\u8a2d\u5b9a\u3057\u305f\u30dd\u30fc\u30c8\u3067\u3001\u30bf\u30b0\u4ed8\u304d\u306e VLAN 10 \u3092\u53d7\u4fe1\u3057\u305f\u5834\u5408\u3001 \u901a\u5e38\u306e VLAN=10 \u3068\u3057\u3066\u8a31\u53ef\u3059\u308b\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u3057\u3001\u7834\u68c4\u3055\u308c\u3066\u3057\u307e\u3046\u5834\u5408\u3082\u3042\u308a\u307e\u3059\u306e\u3067\u3001 \u3082\u3057\u305d\u306e\u3088\u3046\u306a\u69cb\u6210\u3092\u3059\u308b\u5834\u5408\u306f\u4e8b\u524d\u306b\u78ba\u8a8d\u304c\u5fc5\u8981\u3067\u3059\u3002","title":"Native VLAN \u3092\u30bf\u30b0\u4ed8\u304d\u3067\u53d7\u4fe1\u3057\u305f\u5834\u5408\u306e\u6319\u52d5"},{"location":"taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/#voice-vlan","text":"voice vlan \u306f\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u306e\u304c cisco \u306e\u63a8\u5968\u3067\u3059\u3002 2 byte \u3068\u306f\u3044\u3048\u3001\u901f\u5ea6\u306b\u30b7\u30d3\u30a2\u306a\u97f3\u58f0\u30d1\u30b1\u30c3\u30c8\u306b\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9\u3068\u3082\u306a\u308b\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u306e\u306f\u4f55\u6545\u3067\u3057\u3087\u3046\u304b\uff1f \u3053\u308c\u306f\u3001 tag vlan \u306b\u306f IEEE802.1p \u3068\u3044\u3046 QoS \u3067\u5229\u7528\u3067\u304d\u308b\u30d5\u30a3\u30fc\u30eb\u30c9 (\u901a\u79f0 cos) \u304c\u3042\u308b\u304b\u3089\u3067\u3059\u3002 \u97f3\u58f0\u30d1\u30b1\u30c3\u30c8\u306f\u3053\u306e cos \u5024\u3092 5 \u306b\u8a2d\u5b9a\u3059\u308b\u3053\u3068\u3067\u3001\u30b9\u30a4\u30c3\u30c1\u306b\u300e \u3053\u306e\u30d1\u30b1\u30c3\u30c8\u306f\u512a\u5148\u3067\u901a\u904e\u3055\u305b\u3066\u306d \u300f\u3068\u4f1d\u3048\u308b\u306e\u3067\u3059\u3002 \u306a\u304a\u3001\u5358\u306b cos \u5024\u3092 5 \u306b\u30bb\u30c3\u30c8\u3059\u308b\u3060\u3051\u3067\u306f QoS \u306f\u52d5\u4f5c\u3057\u307e\u305b\u3093\u3002 \u7d4c\u7531\u3059\u308b\u5404\u30b9\u30a4\u30c3\u30c1\u3067\u300e cos \u5024 = 5 \u306e\u30d1\u30b1\u30c3\u30c8\u3092\u512a\u5148\u3067\u51fa\u529b\u3059\u308b \u300f\u3068\u3044\u3046\u8a2d\u5b9a\u304c\u5fc5\u8981\u3067\u3059\u3002","title":"voice vlan \u3067\u30bf\u30b0\u3092\u4ed8\u3051\u308b\u7406\u7531"},{"location":"ubnt/","text":"Edgerouter Lite-3\u3067DS-Lite Add nat \u00b6 EdgeRouter - Port Forwarding set firewall name WAN_IN rule 22 action accept set firewall name WAN_IN rule 22 destination address 192.168.1.100 set firewall name WAN_IN rule 22 destination port 22 set firewall name WAN_IN rule 22 protocol tcp set service nat rule 22 description \"port forward to Server (ssh)\" set service nat rule 22 destination port 22 set service nat rule 22 inbound-interface pppoe0 set service nat rule 22 inside-address address 192.168.1.100 set service nat rule 22 inside-address port 22 set service nat rule 22 protocol tcp set service nat rule 22 type destination commit save Add dynamic DNS \u00b6 \u8a2d\u5b9a\u5024 Duck DNS domain return-0.duckdns.org Interface pppoe0 Service custom-duckdns Hostname return-0 Login nouser Password Duck DNS \u306e\u30b5\u30a4\u30c8\u306b\u8868\u793a\u3055\u308c\u308b token Protocol dyndns2 Server www.duckdns.org duckdns EdgeRouter X - 5. \u30c0\u30a4\u30ca\u30df\u30c3\u30af DNS \u306e\u8a2d\u5b9a ( DDNS ) root@ubnt:/home/ubnt# configure [edit] root@ubnt# set service dns dynamic interface pppoe0 service custom-duckdns host-name return-0 [edit] root@ubnt# set service dns dynamic interface pppoe0 service custom-duckdns login nosuer [edit] root@ubnt# set service dns dynamic interface pppoe0 service custom-duckdns password xxxtokenxxxx [edit] root@ubnt# set service dns dynamic interface pppoe0 service custom-duckdns protocol dyndns2 [edit] root@ubnt# set service dns dynamic interface pppoe0 service custom-duckdns server www.duckdns.org [edit] root@ubnt# commit [edit] root@ubnt# save Saving configuration to '/config/config.boot'... Done [edit] root@ubnt# root@ubnt:/home/ubnt# show dns dynamic status # ddns interface : pppoe0 ip address : <PublicIP> host-name : <hostname> (xxx.ddns.net) last update : Wed Apr 25 10:28:27 2018 update-status: good # duckdns interface : pppoe0 ip address : <PublicIP> host-name : <hostname> (xxx) last update : Wed Apr 25 10:28:27 2018 update-status: good root@ubnt:/home/ubnt# create VPN L2TP \u00b6 SSH \u3067\u30eb\u30fc\u30bf\u30fc\u306b\u30a2\u30af\u30bb\u30b9 ## \u8a2d\u5b9a\u30e2\u30fc\u30c9\u306b\u5165\u308b configure Add firewall rules for the L2TP traffic to the local firewall policy. \u00b6 set firewall name WAN_LOCAL rule 30 action accept set firewall name WAN_LOCAL rule 30 description ike set firewall name WAN_LOCAL rule 30 destination port 500 set firewall name WAN_LOCAL rule 30 log disable set firewall name WAN_LOCAL rule 30 protocol udp set firewall name WAN_LOCAL rule 40 action accept set firewall name WAN_LOCAL rule 40 description esp set firewall name WAN_LOCAL rule 40 log disable set firewall name WAN_LOCAL rule 40 protocol esp set firewall name WAN_LOCAL rule 50 action accept set firewall name WAN_LOCAL rule 50 description nat-t set firewall name WAN_LOCAL rule 50 destination port 4500 set firewall name WAN_LOCAL rule 50 log disable set firewall name WAN_LOCAL rule 50 protocol udp set firewall name WAN_LOCAL rule 60 action accept set firewall name WAN_LOCAL rule 60 description l2tp set firewall name WAN_LOCAL rule 60 destination port 1701 set firewall name WAN_LOCAL rule 60 ipsec match-ipsec set firewall name WAN_LOCAL rule 60 log disable set firewall name WAN_LOCAL rule 60 protocol udp \u57fa\u672c\u7684\u306a IPsec \u306e\u8a2d\u5b9a \u00b6 set vpn ipsec ipsec-interfaces interface pppoe0 set vpn ipsec nat-networks allowed-network 0.0.0.0/0 set vpn ipsec nat-traversal enable WAN \u5074 IP \u30a2\u30c9\u30ec\u30b9\u304c pppoe0 \u7d4c\u7531\u3067\u5272\u308a\u5f53\u3066\u306e\u5834\u5408\u3053\u308c\u3092\u6307\u5b9a \u00b6 set vpn l2tp remote-access outside-address 0.0.0.0 L2TP \u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304d\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u5272\u308a\u5f53\u3066\u308b IP \u30a2\u30c9\u30ec\u30b9\u306e\u7bc4\u56f2\u3092\u6307\u5b9a \u00b6 set vpn l2tp remote-access client-ip-pool start 192.168.1.121 set vpn l2tp remote-access client-ip-pool stop 192.168.1.140 L2TP \u306e\u300c\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u300d\u3092\u8a2d\u5b9a \u00b6 PASSWORD \u306e\u90e8\u5206\u3092\u4efb\u610f\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u5909\u66f4\u3057\u3066\u5165\u529b set vpn l2tp remote-access ipsec-settings authentication mode pre-shared-secret set vpn l2tp remote-access ipsec-settings authentication pre-shared-secret PASSWORD set vpn l2tp remote-access ipsec-settings ike-lifetime 3600 L2TP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u8a8d\u8a3c\u65b9\u6cd5\u3092\u30ed\u30fc\u30ab\u30eb\u306b\u8a2d\u5b9a \u00b6 set vpn l2tp remote-access authentication mode local L2TP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30e6\u30fc\u30b6\u30fc\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a \u00b6 USER \u3068 PASSWORD \u306e\u90e8\u5206\u3092\u5909\u66f4\u3057\u3066\u5165\u529b set vpn l2tp remote-access authentication local-users username USER password PASSWORD L2TP \u306e MTU \u3092\u4fdd\u5b88\u7684\u306b\u8a2d\u5b9a \u00b6 set vpn l2tp remote-access mtu 1280 L2TP \u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u4f7f\u3046 DNS \u3092\u30eb\u30fc\u30bf\u30fc\u81ea\u8eab\u3068 Google DNS \u306b\u8a2d\u5b9a \u00b6 set vpn l2tp remote-access dns-servers server-1 192.168.1.1 set vpn l2tp remote-access dns-servers server-2 8.8.8.8 \u30eb\u30fc\u30bf\u30fc\u306e DNS \u304c L2TP \u304b\u3089\u4f7f\u3048\u308b\u3088\u3046 DNS Frowarding \u3092\u30eb\u30fc\u30bf\u30fc\u81ea\u8eab\u306b\u8a2d\u5b9a \u00b6 set service dns forwarding listen-on lo \u8a2d\u5b9a\u4fdd\u5b58 \u00b6 commit save \u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u3068\u306e\u7af6\u5408\u5bfe\u7b56 \u00b6 UDP \u30dd\u30fc\u30c8 4500\u306f\u3001\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u3067\u3082\u4f7f\u7528\u3057\u3066\u3044\u308b\u305f\u3081\u3001 Mac\u5074\u3067\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3001L2TP/IPSec\u3068\u7af6\u5408\u3057\u3066\u30a2\u30af\u30bb\u30b9\u4e0d\u80fd\u306b\u9665\u308a\u307e\u3059\u3002 \u3000\u30fb\u3000\u56de\u907f\u65b9\u6cd5 \u3000\u3000\u305d\u306e1\uff09 \u30ed\u30fc\u30ab\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306b\u3042\u308b\u3059\u3079\u3066\u306eMac\u3067\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u3092\u7121\u52b9\u306b\u3059\u308b \u3000\u3000\u305d\u306e2\uff09 Edgerouter\u306eUPnP2\u3092\u7121\u52b9\u306b\u3059\u308b\u3000\u203b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u7684\u306b\u306fUPnP\u3092\u7121\u52b9\u306b\u3059\u308b\u306e\u304c\u5409 \u3000\u3000\u305d\u306e3\uff09 UPnP\u304c\u5fc5\u8981\u306a\u5834\u5408\u3001UPnP2\u3067UDP \u30dd\u30fc\u30c8 4500\u3067\u306e\u8ee2\u9001\u3092\u6b62\u3081\u308b \u305d\u306e3\uff09\u3092\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u3059\u308b\u5834\u5408 \u00b6 \u5bfe\u7b56 \u8a2d\u5b9a\u30e2\u30fc\u30c9\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u8a2d\u5b9a \u00b6 configure set service upnp2 acl rule 10 action deny set service upnp2 acl rule 10 description \"Block Port 4500\" set service upnp2 acl rule 10 external-port 4500 set service upnp2 acl rule 10 local-port 4500 set service upnp2 acl rule 10 subnet 192.168.1.0/24 set service upnp2 listen-on pppoe0 set service upnp2 wan pppoe0 \u8a2d\u5b9a\u3092\u53cd\u6620\u3057\u3066\u4fdd\u5b58\u3001\u8a2d\u5b9a\u30e2\u30fc\u30c9\u7d42\u4e86 \u00b6 commit save exit \u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8 \u00b6 root@ubnt:/home/ubnt# df -h Filesystem Size Used Available Use% Mounted on ubi0_0 214.9M 155.8M 54.4M 74% /root.dev aufs 214.9M 155.8M 54.4M 74% / devtmpfs 124.3M 0 124.3M 0% /dev tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 18.7M 105.8M 15% /var/log tmpfs 124.4M 12.0K 124.4M 0% /tmp none 124.4M 756.0K 123.7M 1% /opt/vyatta/config root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# show system image The system currently has the following image(s) installed: v1.10.5.5098943.180622.1555 (running image) (default boot) v1.9.0.4901118.160804.1131 root@ubnt:/home/ubnt# show system image storage Image name Read-Only Read-Write Total ------------------------------ ------------ ------------ ------------ v1.10.5.5098943.180622.1555 77760 940 78700 v1.9.0.4901118.160804.1131 76760 14152 90912 root@ubnt:/home/ubnt# delete system image Possible completions: <Enter> Execute the current command root@ubnt:/home/ubnt# delete system image The system currently has the following image(s) installed: v1.10.5.5098943.180622.1555 (running image) (default boot) v1.9.0.4901118.160804.1131 You are about to delete image [v1.9.0.4901118.160804.1131] Are you sure you want to delete ? (Yes/No) [Yes]: Yes Removing old image... Done root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# df -h Filesystem Size Used Available Use% Mounted on ubi0_0 214.9M 74.1M 136.1M 35% /root.dev aufs 214.9M 74.1M 136.1M 35% / devtmpfs 124.3M 0 124.3M 0% /dev tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 18.7M 105.7M 15% /var/log tmpfs 124.4M 12.0K 124.4M 0% /tmp none 124.4M 756.0K 123.7M 1% /opt/vyatta/config root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# ls ER-e50.v1.10.7.5127989.tar root@ubnt:/home/ubnt# add system image ^C root@ubnt:/home/ubnt# show version Version: v1.10.5 Build ID: 5098943 Build on: 06/22/18 15:55 Copyright: 2012-2018 Ubiquiti Networks, Inc. HW model: EdgeRouter X 5-Port HW S/N: F09FC2087E8A Uptime: 12:45:43 up 85 days, 13:33, 1 user, load average: 1.26, 1.24, 1.19 root@ubnt:/home/ubnt# add system image ER-e50.v1.10.7.5127989.tar Checking upgrade image...Done Preparing to upgrade...Done Clearing directory /var/cache/apt (356.0K)...Done Copying upgrade image...Not enough disk space for root file system Do you want to delete old version first? (Yes/No) [Yes]: Yes Removing old image...Done Still not enough disk space for root file system Canceling upgrade /home/ubnt root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# df -h Filesystem Size Used Available Use% Mounted on ubi0_0 214.9M 149.9M 60.3M 71% /root.dev aufs 214.9M 149.9M 60.3M 71% / devtmpfs 124.3M 0 124.3M 0% /dev tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 18.7M 105.7M 15% /var/log tmpfs 124.4M 12.0K 124.4M 0% /tmp none 124.4M 756.0K 123.7M 1% /opt/vyatta/config root@ubnt:/home/ubnt# ls -lath ER-e50.v1.10.7.5127989.tar -rw-r--r-- 1 ubnt users 78.3M Nov 1 12:44 ER-e50.v1.10.7.5127989.tar root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# add system image https://dl.ubnt.com/firmwares/edgemax/v1.10.x/ER-e50.v1.10.7.5127989.tar Trying to get upgrade file from https://dl.ubnt.com/firmwares/edgemax/v1.10.x/ER-e50.v1.10.7.5127989.tar % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 78.3M 100 78.3M 0 0 3586k 0 0:00:22 0:00:22 --:--:-- 4926k Download succeeded Checking upgrade image...Done Preparing to upgrade...Done Clearing directory /var/cache/apt (356.0K)...Done Copying upgrade image...Done Removing old image...Done Checking upgrade image...Done Copying config data...Done Finishing upgrade...Done Upgrade completed root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# show system image The system currently has the following image(s) installed: v1.10.7.5127989.181001.1227 (default boot) v1.10.5.5098943.180622.1555 (running image) A reboot is needed to boot default image root@ubnt:/home/ubnt# show system image storage Image name Read-Only Read-Write Total ------------------------------ ------------ ------------ ------------ v1.10.7.5127989.181001.1227 78500 88 78588 v1.10.5.5098943.180622.1555 77760 588 78348 root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# show system image The system currently has the following image(s) installed: v1.10.7.5127989.181001.1227 (default boot) v1.10.5.5098943.180622.1555 (running image) A reboot is needed to boot default image root@ubnt:/home/ubnt# set system image default-boot The system currently has the following image(s) installed: v1.10.7.5127989.181001.1227 (default boot) v1.10.5.5098943.180622.1555 (running image) A reboot is needed to boot default image Are you sure you want to switch images? (Yes/No) [Yes]: Moving images... Done Switched from Version: v1.10.7.5127989.181001.1227 to Version: v1.10.5.5098943.180622.1555 root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# show system image The system currently has the following image(s) installed: v1.10.5.5098943.180622.1555 (running image) (default boot) v1.10.7.5127989.181001.1227 root@ubnt:/home/ubnt# set system image default-boot The system currently has the following image(s) installed: v1.10.5.5098943.180622.1555 (running image) (default boot) v1.10.7.5127989.181001.1227 Are you sure you want to switch images? (Yes/No) [Yes]: Moving images... Done Switched from Version: v1.10.5.5098943.180622.1555 to Version: v1.10.7.5127989.181001.1227 root@ubnt:/home/ubnt# show system image The system currently has the following image(s) installed: v1.10.7.5127989.181001.1227 (default boot) v1.10.5.5098943.180622.1555 (running image) A reboot is needed to boot default image root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# reboot","title":"ubnt"},{"location":"ubnt/#add-nat","text":"EdgeRouter - Port Forwarding set firewall name WAN_IN rule 22 action accept set firewall name WAN_IN rule 22 destination address 192.168.1.100 set firewall name WAN_IN rule 22 destination port 22 set firewall name WAN_IN rule 22 protocol tcp set service nat rule 22 description \"port forward to Server (ssh)\" set service nat rule 22 destination port 22 set service nat rule 22 inbound-interface pppoe0 set service nat rule 22 inside-address address 192.168.1.100 set service nat rule 22 inside-address port 22 set service nat rule 22 protocol tcp set service nat rule 22 type destination commit save","title":"Add nat"},{"location":"ubnt/#add-dynamic-dns","text":"\u8a2d\u5b9a\u5024 Duck DNS domain return-0.duckdns.org Interface pppoe0 Service custom-duckdns Hostname return-0 Login nouser Password Duck DNS \u306e\u30b5\u30a4\u30c8\u306b\u8868\u793a\u3055\u308c\u308b token Protocol dyndns2 Server www.duckdns.org duckdns EdgeRouter X - 5. \u30c0\u30a4\u30ca\u30df\u30c3\u30af DNS \u306e\u8a2d\u5b9a ( DDNS ) root@ubnt:/home/ubnt# configure [edit] root@ubnt# set service dns dynamic interface pppoe0 service custom-duckdns host-name return-0 [edit] root@ubnt# set service dns dynamic interface pppoe0 service custom-duckdns login nosuer [edit] root@ubnt# set service dns dynamic interface pppoe0 service custom-duckdns password xxxtokenxxxx [edit] root@ubnt# set service dns dynamic interface pppoe0 service custom-duckdns protocol dyndns2 [edit] root@ubnt# set service dns dynamic interface pppoe0 service custom-duckdns server www.duckdns.org [edit] root@ubnt# commit [edit] root@ubnt# save Saving configuration to '/config/config.boot'... Done [edit] root@ubnt# root@ubnt:/home/ubnt# show dns dynamic status # ddns interface : pppoe0 ip address : <PublicIP> host-name : <hostname> (xxx.ddns.net) last update : Wed Apr 25 10:28:27 2018 update-status: good # duckdns interface : pppoe0 ip address : <PublicIP> host-name : <hostname> (xxx) last update : Wed Apr 25 10:28:27 2018 update-status: good root@ubnt:/home/ubnt#","title":"Add dynamic DNS"},{"location":"ubnt/#create-vpn-l2tp","text":"SSH \u3067\u30eb\u30fc\u30bf\u30fc\u306b\u30a2\u30af\u30bb\u30b9 ## \u8a2d\u5b9a\u30e2\u30fc\u30c9\u306b\u5165\u308b configure","title":"create VPN L2TP"},{"location":"ubnt/#add-firewall-rules-for-the-l2tp-traffic-to-the-local-firewall-policy","text":"set firewall name WAN_LOCAL rule 30 action accept set firewall name WAN_LOCAL rule 30 description ike set firewall name WAN_LOCAL rule 30 destination port 500 set firewall name WAN_LOCAL rule 30 log disable set firewall name WAN_LOCAL rule 30 protocol udp set firewall name WAN_LOCAL rule 40 action accept set firewall name WAN_LOCAL rule 40 description esp set firewall name WAN_LOCAL rule 40 log disable set firewall name WAN_LOCAL rule 40 protocol esp set firewall name WAN_LOCAL rule 50 action accept set firewall name WAN_LOCAL rule 50 description nat-t set firewall name WAN_LOCAL rule 50 destination port 4500 set firewall name WAN_LOCAL rule 50 log disable set firewall name WAN_LOCAL rule 50 protocol udp set firewall name WAN_LOCAL rule 60 action accept set firewall name WAN_LOCAL rule 60 description l2tp set firewall name WAN_LOCAL rule 60 destination port 1701 set firewall name WAN_LOCAL rule 60 ipsec match-ipsec set firewall name WAN_LOCAL rule 60 log disable set firewall name WAN_LOCAL rule 60 protocol udp","title":"Add firewall rules for the L2TP traffic to the local firewall policy."},{"location":"ubnt/#ipsec","text":"set vpn ipsec ipsec-interfaces interface pppoe0 set vpn ipsec nat-networks allowed-network 0.0.0.0/0 set vpn ipsec nat-traversal enable","title":"\u57fa\u672c\u7684\u306a IPsec \u306e\u8a2d\u5b9a"},{"location":"ubnt/#wan-ip-pppoe0","text":"set vpn l2tp remote-access outside-address 0.0.0.0","title":"WAN \u5074 IP \u30a2\u30c9\u30ec\u30b9\u304c pppoe0 \u7d4c\u7531\u3067\u5272\u308a\u5f53\u3066\u306e\u5834\u5408\u3053\u308c\u3092\u6307\u5b9a"},{"location":"ubnt/#l2tp-ip","text":"set vpn l2tp remote-access client-ip-pool start 192.168.1.121 set vpn l2tp remote-access client-ip-pool stop 192.168.1.140","title":"L2TP \u3067\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304d\u305f\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306b\u5272\u308a\u5f53\u3066\u308b IP \u30a2\u30c9\u30ec\u30b9\u306e\u7bc4\u56f2\u3092\u6307\u5b9a"},{"location":"ubnt/#l2tp","text":"PASSWORD \u306e\u90e8\u5206\u3092\u4efb\u610f\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306b\u5909\u66f4\u3057\u3066\u5165\u529b set vpn l2tp remote-access ipsec-settings authentication mode pre-shared-secret set vpn l2tp remote-access ipsec-settings authentication pre-shared-secret PASSWORD set vpn l2tp remote-access ipsec-settings ike-lifetime 3600","title":"L2TP \u306e\u300c\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u300d\u3092\u8a2d\u5b9a"},{"location":"ubnt/#l2tp_1","text":"set vpn l2tp remote-access authentication mode local","title":"L2TP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u8a8d\u8a3c\u65b9\u6cd5\u3092\u30ed\u30fc\u30ab\u30eb\u306b\u8a2d\u5b9a"},{"location":"ubnt/#l2tp_2","text":"USER \u3068 PASSWORD \u306e\u90e8\u5206\u3092\u5909\u66f4\u3057\u3066\u5165\u529b set vpn l2tp remote-access authentication local-users username USER password PASSWORD","title":"L2TP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306e\u30e6\u30fc\u30b6\u30fc\u540d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a"},{"location":"ubnt/#l2tp-mtu","text":"set vpn l2tp remote-access mtu 1280","title":"L2TP \u306e MTU \u3092\u4fdd\u5b88\u7684\u306b\u8a2d\u5b9a"},{"location":"ubnt/#l2tp-dns-google-dns","text":"set vpn l2tp remote-access dns-servers server-1 192.168.1.1 set vpn l2tp remote-access dns-servers server-2 8.8.8.8","title":"L2TP \u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u304c\u4f7f\u3046 DNS \u3092\u30eb\u30fc\u30bf\u30fc\u81ea\u8eab\u3068 Google DNS \u306b\u8a2d\u5b9a"},{"location":"ubnt/#dns-l2tp-dns-frowarding","text":"set service dns forwarding listen-on lo","title":"\u30eb\u30fc\u30bf\u30fc\u306e DNS \u304c L2TP \u304b\u3089\u4f7f\u3048\u308b\u3088\u3046 DNS Frowarding \u3092\u30eb\u30fc\u30bf\u30fc\u81ea\u8eab\u306b\u8a2d\u5b9a"},{"location":"ubnt/#_1","text":"commit save","title":"\u8a2d\u5b9a\u4fdd\u5b58"},{"location":"ubnt/#my-mac","text":"UDP \u30dd\u30fc\u30c8 4500\u306f\u3001\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u3067\u3082\u4f7f\u7528\u3057\u3066\u3044\u308b\u305f\u3081\u3001 Mac\u5074\u3067\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u304c\u6709\u52b9\u306b\u306a\u3063\u3066\u3044\u308b\u3068\u3001L2TP/IPSec\u3068\u7af6\u5408\u3057\u3066\u30a2\u30af\u30bb\u30b9\u4e0d\u80fd\u306b\u9665\u308a\u307e\u3059\u3002 \u3000\u30fb\u3000\u56de\u907f\u65b9\u6cd5 \u3000\u3000\u305d\u306e1\uff09 \u30ed\u30fc\u30ab\u30eb\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u5185\u306b\u3042\u308b\u3059\u3079\u3066\u306eMac\u3067\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u3092\u7121\u52b9\u306b\u3059\u308b \u3000\u3000\u305d\u306e2\uff09 Edgerouter\u306eUPnP2\u3092\u7121\u52b9\u306b\u3059\u308b\u3000\u203b\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u7684\u306b\u306fUPnP\u3092\u7121\u52b9\u306b\u3059\u308b\u306e\u304c\u5409 \u3000\u3000\u305d\u306e3\uff09 UPnP\u304c\u5fc5\u8981\u306a\u5834\u5408\u3001UPnP2\u3067UDP \u30dd\u30fc\u30c8 4500\u3067\u306e\u8ee2\u9001\u3092\u6b62\u3081\u308b","title":"\u300c\u3069\u3053\u3067\u3082 My Mac\u300d\u3068\u306e\u7af6\u5408\u5bfe\u7b56"},{"location":"ubnt/#3","text":"","title":"\u305d\u306e3\uff09\u3092\u30b3\u30de\u30f3\u30c9\u3067\u8a2d\u5b9a\u3059\u308b\u5834\u5408"},{"location":"ubnt/#_2","text":"configure set service upnp2 acl rule 10 action deny set service upnp2 acl rule 10 description \"Block Port 4500\" set service upnp2 acl rule 10 external-port 4500 set service upnp2 acl rule 10 local-port 4500 set service upnp2 acl rule 10 subnet 192.168.1.0/24 set service upnp2 listen-on pppoe0 set service upnp2 wan pppoe0","title":"\u5bfe\u7b56 \u8a2d\u5b9a\u30e2\u30fc\u30c9\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3057\u3066\u8a2d\u5b9a"},{"location":"ubnt/#_3","text":"commit save exit","title":"\u8a2d\u5b9a\u3092\u53cd\u6620\u3057\u3066\u4fdd\u5b58\u3001\u8a2d\u5b9a\u30e2\u30fc\u30c9\u7d42\u4e86"},{"location":"ubnt/#_4","text":"root@ubnt:/home/ubnt# df -h Filesystem Size Used Available Use% Mounted on ubi0_0 214.9M 155.8M 54.4M 74% /root.dev aufs 214.9M 155.8M 54.4M 74% / devtmpfs 124.3M 0 124.3M 0% /dev tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 18.7M 105.8M 15% /var/log tmpfs 124.4M 12.0K 124.4M 0% /tmp none 124.4M 756.0K 123.7M 1% /opt/vyatta/config root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# show system image The system currently has the following image(s) installed: v1.10.5.5098943.180622.1555 (running image) (default boot) v1.9.0.4901118.160804.1131 root@ubnt:/home/ubnt# show system image storage Image name Read-Only Read-Write Total ------------------------------ ------------ ------------ ------------ v1.10.5.5098943.180622.1555 77760 940 78700 v1.9.0.4901118.160804.1131 76760 14152 90912 root@ubnt:/home/ubnt# delete system image Possible completions: <Enter> Execute the current command root@ubnt:/home/ubnt# delete system image The system currently has the following image(s) installed: v1.10.5.5098943.180622.1555 (running image) (default boot) v1.9.0.4901118.160804.1131 You are about to delete image [v1.9.0.4901118.160804.1131] Are you sure you want to delete ? (Yes/No) [Yes]: Yes Removing old image... Done root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# df -h Filesystem Size Used Available Use% Mounted on ubi0_0 214.9M 74.1M 136.1M 35% /root.dev aufs 214.9M 74.1M 136.1M 35% / devtmpfs 124.3M 0 124.3M 0% /dev tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 18.7M 105.7M 15% /var/log tmpfs 124.4M 12.0K 124.4M 0% /tmp none 124.4M 756.0K 123.7M 1% /opt/vyatta/config root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# ls ER-e50.v1.10.7.5127989.tar root@ubnt:/home/ubnt# add system image ^C root@ubnt:/home/ubnt# show version Version: v1.10.5 Build ID: 5098943 Build on: 06/22/18 15:55 Copyright: 2012-2018 Ubiquiti Networks, Inc. HW model: EdgeRouter X 5-Port HW S/N: F09FC2087E8A Uptime: 12:45:43 up 85 days, 13:33, 1 user, load average: 1.26, 1.24, 1.19 root@ubnt:/home/ubnt# add system image ER-e50.v1.10.7.5127989.tar Checking upgrade image...Done Preparing to upgrade...Done Clearing directory /var/cache/apt (356.0K)...Done Copying upgrade image...Not enough disk space for root file system Do you want to delete old version first? (Yes/No) [Yes]: Yes Removing old image...Done Still not enough disk space for root file system Canceling upgrade /home/ubnt root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# df -h Filesystem Size Used Available Use% Mounted on ubi0_0 214.9M 149.9M 60.3M 71% /root.dev aufs 214.9M 149.9M 60.3M 71% / devtmpfs 124.3M 0 124.3M 0% /dev tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 220.0K 124.2M 0% /run tmpfs 124.4M 18.7M 105.7M 15% /var/log tmpfs 124.4M 12.0K 124.4M 0% /tmp none 124.4M 756.0K 123.7M 1% /opt/vyatta/config root@ubnt:/home/ubnt# ls -lath ER-e50.v1.10.7.5127989.tar -rw-r--r-- 1 ubnt users 78.3M Nov 1 12:44 ER-e50.v1.10.7.5127989.tar root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# add system image https://dl.ubnt.com/firmwares/edgemax/v1.10.x/ER-e50.v1.10.7.5127989.tar Trying to get upgrade file from https://dl.ubnt.com/firmwares/edgemax/v1.10.x/ER-e50.v1.10.7.5127989.tar % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 78.3M 100 78.3M 0 0 3586k 0 0:00:22 0:00:22 --:--:-- 4926k Download succeeded Checking upgrade image...Done Preparing to upgrade...Done Clearing directory /var/cache/apt (356.0K)...Done Copying upgrade image...Done Removing old image...Done Checking upgrade image...Done Copying config data...Done Finishing upgrade...Done Upgrade completed root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# show system image The system currently has the following image(s) installed: v1.10.7.5127989.181001.1227 (default boot) v1.10.5.5098943.180622.1555 (running image) A reboot is needed to boot default image root@ubnt:/home/ubnt# show system image storage Image name Read-Only Read-Write Total ------------------------------ ------------ ------------ ------------ v1.10.7.5127989.181001.1227 78500 88 78588 v1.10.5.5098943.180622.1555 77760 588 78348 root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# show system image The system currently has the following image(s) installed: v1.10.7.5127989.181001.1227 (default boot) v1.10.5.5098943.180622.1555 (running image) A reboot is needed to boot default image root@ubnt:/home/ubnt# set system image default-boot The system currently has the following image(s) installed: v1.10.7.5127989.181001.1227 (default boot) v1.10.5.5098943.180622.1555 (running image) A reboot is needed to boot default image Are you sure you want to switch images? (Yes/No) [Yes]: Moving images... Done Switched from Version: v1.10.7.5127989.181001.1227 to Version: v1.10.5.5098943.180622.1555 root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# show system image The system currently has the following image(s) installed: v1.10.5.5098943.180622.1555 (running image) (default boot) v1.10.7.5127989.181001.1227 root@ubnt:/home/ubnt# set system image default-boot The system currently has the following image(s) installed: v1.10.5.5098943.180622.1555 (running image) (default boot) v1.10.7.5127989.181001.1227 Are you sure you want to switch images? (Yes/No) [Yes]: Moving images... Done Switched from Version: v1.10.5.5098943.180622.1555 to Version: v1.10.7.5127989.181001.1227 root@ubnt:/home/ubnt# show system image The system currently has the following image(s) installed: v1.10.7.5127989.181001.1227 (default boot) v1.10.5.5098943.180622.1555 (running image) A reboot is needed to boot default image root@ubnt:/home/ubnt# root@ubnt:/home/ubnt# reboot","title":"\u30d5\u30a1\u30fc\u30e0\u30a6\u30a7\u30a2\u306e\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8"},{"location":"vim/","text":"build vim \u00b6 $ ./configure --prefix=$HOME/myetc \\ --with-features=huge \\ --enable-gui=gnome2 \\ --enable-perlinterp \\ --enable-pythoninterp \\ --enable-python3interp \\ --enable-fail-if-missing \\ --disable-selinux \\ --enable-pythoninterp=dynamic \\ --with-python-config-dir=/home/user/.pyenv/versions/2.7.14/lib/python2.7/config \\ --enable-python3interp=dynamic \\ --with-python3-config-dir=/home/user/.pyenv/versions/3.6.5/lib/python3.6/config-3.6m \\ --enable-rubyinterp=dynamic \\ --enable-cscope \\ --enable-fontset \\ --enable-multibyte \\ vi_cv_path_python3=/home/uers/.pyenv/versions/3.6.5/bin/python3.6 make make install vim ~/.zshrc alias vi='~/myetc/bin/vim' alias vim='~/myetc/bin/vim' \u30ad\u30fc\u5165\u529b \u52d5\u4f5c vi \u30d5\u30a1\u30a4\u30eb\u540d \u5bfe\u8c61\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\uff08\u8907\u6570\u30d5\u30a1\u30a4\u30eb\u53ef\uff09 vi +n \u30d5\u30a1\u30a4\u30eb\u540d n \u884c\u76ee\u304b\u3089\u5bfe\u8c61\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f vi -r \u30d5\u30a1\u30a4\u30eb\u540d \u58ca\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30ab\u30d0\u30ea i \u30ab\u30fc\u30bd\u30eb\u306e\u5de6\u304b\u3089\u5165\u529b\u958b\u59cb I \u884c\u982d\u304b\u3089\u5165\u529b\u958b\u59cb a \u30ab\u30fc\u30bd\u30eb\u306e\u53f3\u304b\u3089\u5165\u529b\u958b\u59cb A \u884c\u672b\u304b\u3089\u5165\u529b\u958b\u59cb ZZ vi \u3092\u7d42\u4e86\uff08\u5185\u5bb9\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u4fdd\u5b58\uff09 :wq \u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\u3001vi \u3092\u7d42\u4e86 :#,# w #\u884c\u76ee\u304b\u3089#\u884c\u76ee\u307e\u3067\u3092\u4fdd\u5b58 :q vi \u3092\u7d42\u4e86\uff08\u5185\u5bb9\u304c\u5909\u66f4\u3055\u308c\u3044\u308b\u5834\u5408\u306f\u8b66\u544a\uff09 :q! vi \u3092\u5f37\u5236\u7d42\u4e86\uff08\u5185\u5bb9\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u3066\u3082\u4fdd\u5b58\u3057\u306a\u3044\uff09 :ls \u30d0\u30c3\u30d5\u30a1\u30ea\u30b9\u30c8\u306e\u8868\u793a :b \u30d0\u30c3\u30d5\u30a1 \u30d0\u30c3\u30d5\u30a1\u3092\u8868\u793a :bn \u6b21\u306e\u30d0\u30c3\u30d5\u30a1\u3092\u8868\u793a :bp \u524d\u306e\u30d0\u30c3\u30d5\u30a1\u3092\u8868\u793a [n] x \u30ab\u30fc\u30bd\u30eb\u4e0a\u306e1\u6587\u5b57\u524a\u9664 [n] X \u30ab\u30fc\u30bd\u30eb\u306e\u5de6\u306e\u6587\u5b57\u30921\u6587\u5b57\u524a\u9664 p \u30d0\u30c3\u30d5\u30a1\u5185\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u633f\u5165\uff08\u6587\u5b57\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u53f3\u3001\u884c\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u4e0b\u306b\u633f\u5165\uff09 P \u30d0\u30c3\u30d5\u30a1\u5185\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u633f\u5165\uff08\u6587\u5b57\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u5de6\u3001\u884c\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u4e0a\u306b\u633f\u5165\uff09 :r [\u30d5\u30a1\u30a4\u30eb\u540d] \u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u3092\u633f\u5165\u3059\u308b [n] d \u76ee\u7684\u8a9e \\ d [n] \u76ee\u7684\u8a9e \u76ee\u7684\u8a9e\u4e00\u89a7: ::: w - \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u7a7a\u767d\u3092\u542b\u3080\u5358\u8a9e\u306e\u672b\u5c3e\u307e\u3067\u524a\u9664 ::: e - \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u7a7a\u767d\u3092\u542b\u307e\u306a\u3044\u5358\u8a9e\u306e\u672b\u5c3e\u307e\u3067\u524a\u9664 ::: $ - \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u884c\u672b\u307e\u3067\u524a\u9664 ::: d - 1\u884c\u524a\u9664\u5207\u308a\u53d6\u308a\uff08\u30ab\u30c3\u30c8\uff09 /<\u6587\u5b57\u5217> \u6587\u5b57\u5217 \u3092\u691c\u7d22\u3059\u308b\uff08\u9806\u65b9\u5411\uff09 ?<\u6587\u5b57\u5217> \u6587\u5b57\u5217\u3092\u691c\u7d22\u3059\u308b\uff08\u9006\u65b9\u5411\uff09 n \u9806\u65b9\u5411\u3078\u691c\u7d22\u3059\u308b N \u9006\u65b9\u5411\u3078\u691c\u7d22\u3059\u308b % (,[\u306b\u5bfe\u3057\u3066\u5bfe\u5fdc\u3059\u308b ),] \u3084 } \u3092\u691c\u7d22 r \u30ab\u30fc\u30bd\u30eb\u306e\u4e0b\u306e\u6587\u5b57\u3092\u7f6e\u304d\u63db\u3048\u308b [n] c \u76ee\u7684\u8a9e \\ c [n] \u76ee\u7684\u8a9e \u76ee\u7684\u8a9e\u4e00\u89a7: ::: w - \u5358\u8a9e\u306e\u4e00\u90e8\u3092\u5909\u66f4\u3059\u308b ::: $ - \u884c\u306e\u4e00\u90e8\u3092\u5909\u66f4\u3059\u308b :s/[old]/[new] [old]\u3092[new]\u306b\u7f6e\u63db\u3059\u308b ::: \u73fe\u5728\u884c\u306e\u6700\u521d\u306e old \u3092 new \u306b\u7f6e\u63db\u3059\u308b :s/old/new ::: \u73fe\u5728\u884c\u306e\u5168\u3066\u306e old \u3092 new \u306b\u7f6e\u63db\u3059\u308b :s/old/new/g ::: 2\u3064\u306e # \u9593\u3067\u8a9e\u53e5\u3092\u7f6e\u63db\u3059\u308b :#,#s/old/new/g ::: \u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u306e\u5168\u3066\u306e\u691c\u7d22\u8a9e\u53e5\u3092\u7f6e\u63db\u3059\u308b: :%s/old/new/g ::: 'c' \u3092\u52a0\u3048\u308b\u3068\u7f6e\u63db\u306e\u5ea6\u306b\u78ba\u8a8d\u3092\u6c42\u3081\u308b :%s/old/new/gc CTRL-g \u30d5\u30a1\u30a4\u30eb\u5185\u3067\u306e\u4f4d\u7f6e\u3068\u30d5\u30a1\u30a4\u30eb\u306e\u72b6\u614b\u3092\u8868\u793a [n] Shift-g \u30d5\u30a1\u30a4\u30eb\u5185\u306en\u884c\u306b\u79fb\u52d5\uff08n\u304c\u7121\u3051\u308c\u3070\u30d5\u30a1\u30a4\u30eb\u672b\u306b\u79fb\u52d5\uff09 :sp [\u30d5\u30a1\u30a4\u30eb] \u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u6a2a\u306b\u5206\u5272 :vs [\u30d5\u30a1\u30a4\u30eb] \u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u7e26\u306b\u5206\u5272 : q , :only \u30ab\u30fc\u30bd\u30eb\u306e\u3042\u308b\u30a6\u30a3\u30f3\u30c9\u30a6\u4ee5\u5916\u3092\u5168\u90e8\u9589\u3058\u308b :new \u7a7a\u306e\u6a2a\u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u958b\u304f :vnew \u7a7a\u306e\u7e26\u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u958b\u304f Ctrl-w w \u6b21\u306e\u30a6\u30a4\u30f3\u30c9\u30a6\u306b\u79fb\u52d5 Ctrl-w p \u524d\u306e\u30a6\u30a4\u30f3\u30c9\u30a6\u306b\u79fb\u52d5 Ctrl-w o \u73fe\u5728\u306e\u30a6\u30a4\u30f3\u30c9\u30a6\u4ee5\u5916\u3092\u9589\u3058\u308b u \u76f4\u524d\u306e\u64cd\u4f5c\u3092\u53d6\u308a\u3084\u3081\u308b U \u884c\u5168\u4f53\u306e\u64cd\u4f5c\u3092\u53d6\u308a\u3084\u3081\u308b Ctrl-R \u53d6\u308a\u6d88\u3057\u306e\u53d6\u308a\u6d88\u3057 . \u76f4\u524d\u306e\u64cd\u4f5c\u306e\u7e70\u308a\u8fd4\u3057 :! [\u5916\u90e8\u30b3\u30de\u30f3\u30c9] \u5916\u90e8\u30b7\u30a7\u30eb\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c U \u884c\u5168\u4f53\u306e\u64cd\u4f5c\u3092\u53d6\u308a\u3084\u3081\u308b :set number\u3001 :set nu \u884c\u756a\u53f7\u3092\u8868\u793a :set no number\u3001 :set nonu \u884c\u756a\u53f7\u306e\u8868\u793a\u3092\u3084\u3081\u308b :set showmode \u73fe\u5728\u306e\u30e2\u30fc\u30c9\u3092\u8868\u793a :set showmatch () \u3084 {} \u306e\u5bfe\u5fdc\u3092\u5831\u544a :set ignorecase \u5927\u6587\u5b57/\u5c0f\u6587\u5b57\u306e\u533a\u5225\u306a\u304f\u691c\u7d22 :set autoindent \u81ea\u52d5\u30a4\u30f3\u30c7\u30f3\u30c8\u30e2\u30fc\u30c9 :set noautoindent \u81ea\u52d5\u30a4\u30f3\u30c7\u30f3\u30c8\u30e2\u30fc\u30c9\u3092\u3084\u3081\u308b :set all \u3059\u3079\u3066\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8868\u793a :e [\u30d5\u30a1\u30a4\u30eb] \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f :syntax on \u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u30cf\u30a4\u30e9\u30a4\u30c8\u8868\u793a\u3059\u308b :vert diffsplit [\u30d5\u30a1\u30a4\u30eb] \u4eca\u306e\u30d5\u30a1\u30a4\u30eb\u3068\u3001\u4ed6\u306e\u30d5\u30a1\u30a4\u30eb\u3068\u306e\u5dee\u5206\u3092\u53d6\u308b\u30b3\u30de\u30f3\u30c9 :Tutorial 30\u5206\u7a0b\u5ea6\u306eVi\u5229\u7528\u65b9\u6cd5\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb Vim\u306e\u4f7f\u3044\u65b9 \u57fa\u672c\u64cd\u4f5c\u307e\u3068\u3081 Vim \u306e \u4f7f\u3044\u65b9 , \u7279\u306b\u81ea\u5206\u304c\u3088\u304f\u4f7f\u3046 \u57fa\u672c\u64cd\u4f5c \u3092\u307e\u3068\u3081\u3066\u307f\u307e\u3057\u305f. \u76ee\u6b21 \u7de8\u96c6, \u4fdd\u5b58, \u7d42\u4e86 \u79fb\u52d5\u7cfb \u30e2\u30fc\u30c9\u5909\u66f4 \u524a\u9664, \u30b3\u30d4\u30fc \u691c\u7d22 Undo, Redo, \u7e70\u308a\u8fd4\u3057 \u30a4\u30f3\u30c7\u30f3\u30c8 \u7f6e\u63db \u30a6\u30a3\u30f3\u30c9\u30a6\u64cd\u4f5c \u30bf\u30d6 \u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8, \u30c7\u30af\u30ea\u30e1\u30f3\u30c8 \u6ce8\u610f \u7de8\u96c6, \u4fdd\u5b58, \u7d42\u4e86 \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c :e [file] file\u3092\u958b\u304f :e. \u30a8\u30af\u30b9\u30d7\u30ed\u30fc\u30e9\u30fc\u3092\u958b\u304f :w \u4fdd\u5b58 :q \u7d42\u4e86 :q! \u4fdd\u5b58\u305b\u305a\u7d42\u4e86 ZZ \u4fdd\u5b58\u3057\u3066\u7d42\u4e86 ZQ \u4fdd\u5b58\u305b\u305a\u306b\u7d42\u4e86 \u79fb\u52d5\u7cfb \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c h, j, k, l \u5de6, \u4e0b, \u4e0a, \u53f3 gj, gk \u4e0b, \u4e0a\u306b1\u884c\u79fb\u52d5. (\u30a8\u30c7\u30a3\u30bf\u3067\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u884c\u4e0a\u3067\u79fb\u52d5, \u3064\u307e\u308a, \u30a8\u30c7\u30a3\u30bf\u306e\u6a2a\u5e45\u306e\u5236\u7d04\u306b\u3088\u3063\u3066\u884c\u304c\u6298\u308a\u8fd4\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u3067\u3082, \u79fb\u52d5\u53ef\u80fd) w 1\u5358\u8a9e\u5206\u9032\u3080 W 1\u5358\u8a9e\u5206\u9032\u3080(\u8a18\u53f7\u3067\u306f\u533a\u5207\u3089\u308c\u306a\u3044\u306e\u3067, \u6b21\u306e\u30b9\u30da\u30fc\u30b9\u3084, \u6539\u884c\u6587\u5b57\u307e\u3067\u98db\u3076) b 1\u5358\u8a9e\u5206\u623b\u308b B 1\u5358\u8a9e\u5206\u623b\u308b(\u8a18\u53f7\u3067\u306f\u533a\u5207\u3089\u308c\u306a\u3044\u306e\u3067, \u524d\u306e\u30b9\u30da\u30fc\u30b9\u3084, \u6539\u884c\u6587\u5b57\u307e\u3067\u98db\u3076) f[\u6587\u5b57] \u6b21\u306e[\u6587\u5b57]\u307e\u3067\u98db\u3076 F[\u6587\u5b57] \u524d\u306e[\u6587\u5b57]\u307e\u3067\u98db\u3076 t[\u6587\u5b57] \u6b21\u306e[\u6587\u5b57]\u306e\u624b\u524d\u307e\u3067\u98db\u3076 T[\u6587\u5b57] \u524d\u306e[\u6587\u5b57]\u306e\u6b21\u307e\u3067\u98db\u3076 ; f, F, t, T\u3067\u691c\u7d22\u3057\u305f\u6587\u5b57\u3092\u540c\u65b9\u5411\u306b\u7e70\u308a\u8fd4\u3057\u691c\u7d22\u3059\u308b , f, F, t, T\u3067\u691c\u7d22\u3057\u305f\u6587\u5b57\u3092\u9006\u65b9\u5411\u306b\u7e70\u308a\u8fd4\u3057\u691c\u7d22\u3059\u308b g; \u76f4\u524d\u306b\u5909\u66f4\u3057\u305f\u4f4d\u7f6e\u306b\u30ab\u30fc\u30bd\u30eb\u3092\u79fb\u52d5(\u7e70\u308a\u8fd4\u3057\u5165\u529b\u3059\u308b\u3053\u3068\u3067, \u5909\u66f4\u30ea\u30b9\u30c8\u3092\u9061\u308b) g, g# \u3092\u4f7f\u7528\u3057\u3066\u9061\u3063\u305f\u5909\u66f4\u30ea\u30b9\u30c8\u3092\u9006\u9806\u306b\u9032\u3081, \u30ab\u30fc\u30bd\u30eb\u3092\u79fb\u52d5\u3059\u308b. gg \u30d5\u30a1\u30a4\u30eb\u306e\u5148\u982d\u306b\u79fb\u52d5 G \u30d5\u30a1\u30a4\u30eb\u306e\u6700\u5f8c\u306b\u79fb\u52d5 [\u6570\u5024]gg, [\u6570\u5024]G, :[\u6570\u5024] [\u6570\u5024]\u884c\u306b\u79fb\u52d5 H, M, L \u753b\u9762\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u884c\u306b\u3064\u3044\u3066, \u6700\u521d\u306e\u884c(H), \u771f\u3093\u4e2d\u306e\u884c(M), \u6700\u5f8c\u306e\u884c(L)\u306b\u79fb\u52d5 0 \u884c\u306e\u5148\u982d\u306b\u79fb\u52d5 ^ \u884c\u306e\u30c6\u30ad\u30b9\u30c8\u90e8\u5206\u306e\u5148\u982d\u306b\u79fb\u52d5 $ \u884c\u306e\u6700\u5f8c\u306b\u79fb\u52d5 % \u5bfe\u5fdc\u3059\u308b\u62ec\u5f27\u306b\u79fb\u52d5 ( \u6587\u5358\u4f4d\u3067\u306e\u79fb\u52d5. \u524d\u306e\u6587\u306e\u5148\u982d\u306b\u79fb\u52d5 ) \u6587\u5358\u4f4d\u3067\u306e\u79fb\u52d5. \u5f8c\u308d\u306e\u6587\u306e\u5148\u982d\u306b\u79fb\u52d5 { \u6bb5\u843d\u5358\u4f4d\u3067\u306e\u79fb\u52d5. \u524d\u306e\u6bb5\u843d\u306e\u5148\u982d\u306b\u79fb\u52d5 } \u6bb5\u843d\u5358\u4f4d\u3067\u306e\u79fb\u52d5. \u5f8c\u308d\u306e\u6bb5\u843d\u306e\u5148\u982d\u306b\u79fb\u52d5 Ctrl-u \u534a\u753b\u9762\u5206\u623b\u308b Ctrl-d \u534a\u753b\u9762\u5206\u9032\u3080 Ctrl-b 1\u753b\u9762\u5206\u623b\u308b Ctrl-f 1\u753b\u9762\u5206\u9032\u3080 Ctrl-o \u30b8\u30e3\u30f3\u30d7\u30ea\u30b9\u30c8\u3092\u9061\u3063\u3066\u30ab\u30fc\u30bd\u30eb\u3092\u79fb\u52d5\u3059\u308b(\u691c\u7d22\u3084\u884c\u6570\u6307\u5b9a\u79fb\u52d5\u306a\u3069\u304c\u30b8\u30e3\u30f3\u30d7\u30ea\u30b9\u30c8\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b) Ctrl-i \u30b8\u30e3\u30f3\u30d7\u30ea\u30b9\u30c8\u3092\u9032\u3081\u3066\u30ab\u30fc\u30bd\u30eb\u3092\u79fb\u52d5\u3059\u308b(\u691c\u7d22\u3084\u884c\u6570\u6307\u5b9a\u79fb\u52d5\u306a\u3069\u304c\u30b8\u30e3\u30f3\u30d7\u30ea\u30b9\u30c8\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b) \u30e2\u30fc\u30c9\u5909\u66f4 \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c esc \u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u308b Ctrl-[ \u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u308b i \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b a \u30ab\u30fc\u30bd\u30eb\u306e\u76f4\u5f8c\u304b\u3089\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b I \u884c\u982d\u304b\u3089\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b A \u884c\u672b\u304b\u3089\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b Ctrl-o(\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u4e2d\u306b) \u30a4\u30f3\u30b5\u30fc\u30c8\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u5165\u308b(\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u4e2d\u306b1\u30b3\u30de\u30f3\u30c9\u306e\u307f\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306e\u30b3\u30de\u30f3\u30c9\u3092\u4f7f\u7528\u3067\u304d\u308b) v \u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u306b\u5165\u308b V \u884c\u5358\u4f4d\u306e\u9078\u629e\u3092\u3059\u308b\u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u306b\u5165\u308b Ctrl-v \u77e9\u5f62\u9078\u629e\u3092\u3059\u308b\u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u306b\u5165\u308b gv \u524d\u56de\u9078\u629e\u3057\u305f\u7bc4\u56f2\u304c\u518d\u9078\u629e\u3055\u308c\u305f\u72b6\u614b\u3067\u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u306b\u5165\u308b : \u30b3\u30de\u30f3\u30c9\u30e9\u30a4\u30f3\u30e2\u30fc\u30c9\u306b\u5165\u308b(\u7d9a\u3051\u3066\u30b3\u30de\u30f3\u30c9\u3092\u6253\u3061, Enter\u3067\u5b9f\u884c) \u77e9\u5f62\u9078\u629e\u306e\u4f7f\u3044\u65b9\u306b\u3064\u3044\u3066\u306f, \uff62\u77e9\u5f62\u9078\u629e\u30e2\u30fc\u30c9\u306e\u4f7f\u3044\u65b9\uff63 \u3067\u3082\u89e3\u8aac\u3057\u3066\u3044\u307e\u3059\u306e\u3067, \u3088\u308d\u3057\u3051\u308c\u3070\u53c2\u8003\u306b\u306a\u3055\u3063\u3066\u304f\u3060\u3055\u3044. \u524a\u9664, \u30b3\u30d4\u30fc \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c x \u30ab\u30fc\u30bd\u30eb\u4e0a\u306e\u6587\u5b57\u3092\u6d88\u3059 s \u30ab\u30fc\u30bd\u30eb\u4e0a\u306e\u6587\u5b57\u3092\u6d88\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b dd \u30ab\u30fc\u30bd\u30eb\u304c\u3042\u308b\u884c\u3092\u6d88\u3059 dw \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u30891\u5358\u8a9e\u5206\u524a\u9664\u3059\u308b diw \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306b\u3042\u308b\u5358\u8a9e\u30921\u3064\u524a\u9664\u3059\u308b dt( \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089, \u6b21\u306b\u6700\u521d\u306b\u51fa\u73fe\u3059\u308b ( \u307e\u3067\u3092\u524a\u9664\u3059\u308b cc \u30ab\u30fc\u30bd\u30eb\u304c\u3042\u308b\u884c\u3092\u6d88\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b cw \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u30891\u5358\u8a9e\u5206\u524a\u9664\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b ciw \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306b\u3042\u308b\u5358\u8a9e\u30921\u3064\u524a\u9664\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b ct( \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089, \u6b21\u306b\u6700\u521d\u306b\u51fa\u73fe\u3059\u308b ( \u307e\u3067\u3092\u524a\u9664\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b D \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u884c\u672b\u307e\u3067\u524a\u9664 C \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u884c\u672b\u307e\u3067\u524a\u9664\u3057\u3066, \u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u308b yy \u30ab\u30fc\u30bd\u30eb\u304c\u3042\u308b\u884c\u3092\u30b3\u30d4\u30fc y \u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u3067\u9078\u629e\u3055\u308c\u3066\u3044\u308b\u90e8\u5206\u3092\u30b3\u30d4\u30fc p \u30ab\u30fc\u30bd\u30eb\u884c\u306e\u4e0b\u306e\u884c\u306b\u30da\u30fc\u30b9\u30c8 P \u30ab\u30fc\u30bd\u30eb\u884c\u306e\u4e0a\u306e\u884c\u306b\u30da\u30fc\u30b9\u30c8 Ctrl-r 0(\u30bc\u30ed)(\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u4e2d\u306b) \u30ec\u30b8\u30b9\u30bf0\u306b\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u6587\u5b57\u5217\u3092\u8cbc\u308a\u4ed8\u3051\u308b. \u901a\u5e38, y\u3092\u4f7f\u7528\u3057\u3066\u30b3\u30d4\u30fc\u3057\u305f\u6587\u5b57\u5217\u306f, \u30ec\u30b8\u30b9\u30bf0\u306b\u4fdd\u5b58\u3055\u308c\u308b. \u691c\u7d22 \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c / \u7d9a\u3051\u3066\u6587\u5b57\u3092\u6253\u3061, Enter\u3067\u6587\u5b57\u5217\u3092\u78ba\u5b9a\u3057, \u5f8c\u65b9\u691c\u7d22\u3092\u304b\u3051\u308b ? \u7d9a\u3051\u3066\u6587\u5b57\u3092\u6253\u3061, Enter\u3067\u6587\u5b57\u5217\u3092\u78ba\u5b9a\u3057, \u524d\u65b9\u691c\u7d22\u3092\u304b\u3051\u308b * \u30ab\u30fc\u30bd\u30eb\u4e0b\u306e\u5358\u8a9e\u3092, \u5f8c\u65b9\u691c\u7d22\u3059\u308b # \u30ab\u30fc\u30bd\u30eb\u4e0b\u306e\u5358\u8a9e\u3092, \u524d\u65b9\u691c\u7d22\u3059\u308b g* \u30ab\u30fc\u30bd\u30eb\u4e0b\u306e\u5358\u8a9e\u3092\u542b\u3080\u6587\u5b57\u5217\u3092, \u5f8c\u65b9\u691c\u7d22\u3059\u308b g# \u30ab\u30fc\u30bd\u30eb\u4e0b\u306e\u5358\u8a9e\u3092\u542b\u3080\u6587\u5b57\u5217\u3092, \u524d\u65b9\u691c\u7d22\u3059\u308b n \u6b21\u306e\u5358\u8a9e\u306b\u79fb\u308b N \u524d\u306e\u5358\u8a9e\u306b\u79fb\u308b Undo, Redo, \u7e70\u308a\u8fd4\u3057 \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c u Undo Ctrl-r Redo . \u76f4\u524d\u306e\u64cd\u4f5c\u306e\u7e70\u308a\u8fd4\u3057 Vim\u3067\u30b3\u30de\u30f3\u30c9\u3092\u7e70\u308a\u8fd4\u3057\u305f\u3044\u3068\u304d\u306b\u975e\u5e38\u306b\u4fbf\u5229\u306a\u6a5f\u80fd\u3068\u3057\u3066, \u30de\u30af\u30ed \u304c\u3042\u308a\u307e\u3059. \u4efb\u610f\u306e\u30b3\u30de\u30f3\u30c9\u3092\u8a18\u61b6\u3055\u305b\u3066, \u305d\u308c\u3092\u3044\u3064\u3067\u3082\u7e70\u308a\u8fd4\u305b\u308b\u3088\u3046\u306b\u3067\u304d\u308b\u3068\u3044\u3046\u3082\u306e\u3067\u3059. \u4f7f\u3044\u65b9\u3092\uff62 Vim\u306e\u30de\u30af\u30ed\u306e\u4f7f\u3044\u65b9 \uff63, \u30de\u30af\u30ed\u3092\u4f7f\u3063\u305f\u4fbf\u5229\u64cd\u4f5c\u306e\u4e00\u4f8b\u3092\uff62 Vim\u3067\u30de\u30af\u30ed\u3092\u4f7f\u3063\u3066\u9023\u756a\u306e\u6587\u3092\u7c21\u5358\u306b\u5165\u529b\u3059\u308b\u65b9\u6cd5 \uff63\u3067\u89e3\u8aac\u3057\u3066\u304a\u308a\u307e\u3059\u306e\u3067, \u3088\u308d\u3057\u3051\u308c\u3070\u53c2\u8003\u306b\u306a\u3055\u3063\u3066\u4e0b\u3055\u3044. \u30a4\u30f3\u30c7\u30f3\u30c8 \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c = \u30ab\u30fc\u30bd\u30eb\u304c\u3042\u308b\u884c\u3092\u30a4\u30f3\u30c7\u30f3\u30c8. \u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u3067\u7bc4\u56f2\u3092\u9078\u629e\u3057\u3066\u3044\u308c\u3070, \u305d\u306e\u7bc4\u56f2\u3092\u30a4\u30f3\u30c7\u30f3\u30c8 >> \u30a4\u30f3\u30c7\u30f3\u30c8\u3092\u8ffd\u52a0 << \u30a4\u30f3\u30c7\u30f3\u30c8\u3092\u524a\u9664 \u7f6e\u63db \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c r[\u6587\u5b57] \u30ab\u30fc\u30bd\u30eb\u4e0a\u306e\u6587\u5b57\u3092[\u6587\u5b57]\u306b\u7f6e\u63db :%s/before/after/g \u30d5\u30a1\u30a4\u30eb\u4e0a\u306e\u5168\u3066\u306e\"before\"\u3092\"after\"\u306b\u7f6e\u63db :s/before/after/g \u30ab\u30fc\u30bd\u30eb\u306e\u884c\u306e\u5168\u3066\u306e\"before\"\u3092\"after\"\u306b\u7f6e\u63db :10,20s/before/after/g 10~20\u884c\u76ee\u306e\u5168\u3066\u306e\"before\"\u3092\"after\"\u306b\u7f6e\u63db :'<,'>s/before/after/g \u30d3\u30b8\u30e5\u30a2\u30eb\u30e2\u30fc\u30c9\u3067\u9078\u629e\u4e2d\u306e\u7bc4\u56f2\u306e\u5168\u3066\u306e\"before\"\u3092\"after\"\u306b\u7f6e\u63db. \" '<,'> \"\u306e\u90e8\u5206\u306f, \u7bc4\u56f2\u3092\u9078\u629e\u4e2d\u306b\":\"\u3092\u62bc\u3059\u3068\u81ea\u52d5\u7684\u306b\u51fa\u307e\u3059. \u7f6e\u63db\u306b\u3064\u3044\u3066\u306f, \uff62Vim\u306e\u7f6e\u63db\u30b3\u30de\u30f3\u30c9\u306e\u4f7f\u3044\u65b9\uff63 \u3067\u3082\u89e3\u8aac\u3057\u3066\u3044\u307e\u3059\u306e\u3067, \u3088\u308d\u3057\u3051\u308c\u3070\u53c2\u8003\u306b\u306a\u3055\u3063\u3066\u304f\u3060\u3055\u3044. \u30a6\u30a3\u30f3\u30c9\u30a6\u64cd\u4f5c \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c :sp [file] \u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u6a2a\u306b\u5206\u5272\u3057, file\u3092\u958b\u304f(file\u540d\u306f\u306a\u304f\u3066\u3082\u826f\u3044) :vs [file] \u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u7e26\u306b\u5206\u5272\u3057, file\u3092\u958b\u304f(file\u540d\u306f\u306a\u304f\u3066\u3082\u826f\u3044) Ctrl-w s \u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u6a2a\u306b\u5206\u5272\u3059\u308b Ctrl-w v \u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u7e26\u306b\u5206\u5272\u3059\u308b :only \u30ab\u30fc\u30bd\u30eb\u306e\u3042\u308b\u30a6\u30a3\u30f3\u30c9\u30a6\u4ee5\u5916\u9589\u3058\u308b Ctrl-w o \u30ab\u30fc\u30bd\u30eb\u306e\u3042\u308b\u30a6\u30a3\u30f3\u30c9\u30a6\u4ee5\u5916\u9589\u3058\u308b Ctrl-w w \u6b21\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u306b\u79fb\u52d5 Ctrl-w p \u524d\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u306b\u79fb\u52d5 Ctrl-w h, j, k, l \u5de6, \u4e0b, \u4e0a, \u53f3\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u306b\u79fb\u52d5\u3059\u308b Ctrl-w H, J, K, L \u30ab\u30fc\u30bd\u30eb\u304c\u3042\u308b\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u5de6, \u4e0b, \u4e0a, \u53f3\u65b9\u5411\u306b\u79fb\u52d5\u3059\u308b \u30bf\u30d6 \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c :tabnew [file] \u65b0\u3057\u3044\u30bf\u30d6\u3092\u958b\u304f. \u30d5\u30a1\u30a4\u30eb\u540d\u3092\u5165\u529b\u3057\u305f\u5834\u5408\u306f, \u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f :tabclose \u30bf\u30d6\u3092\u9589\u3058\u308b( :q \u306a\u3069\u3067\u3082\u9589\u3058\u3089\u308c\u307e\u3059) :tabnext \u6b21\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b :tabprevious \u524d\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b :tabfirst 1\u756a\u76ee\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b :tablast \u6700\u5f8c\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b :tabonly \u73fe\u5728\u306e\u30bf\u30d6\u4ee5\u5916\u5168\u3066\u306e\u30bf\u30d6\u3092\u9589\u3058\u308b gt \u6b21\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b. gt\u306e\u76f4\u524d\u306b\u6570\u5b57\u3092\u3064\u3051\u308b\u3068, \u6570\u5b57\u756a\u76ee\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b gT \u4e00\u3064\u524d\u306e\u30bf\u30d6\u306b\u79fb\u52d5\u3059\u308b \u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8, \u30c7\u30af\u30ea\u30e1\u30f3\u30c8 \u30b3\u30de\u30f3\u30c9 \u52d5\u4f5c Ctrl-a \u30ab\u30fc\u30bd\u30eb\u884c\u4e0a\u3067, \u30ab\u30fc\u30bd\u30eb\u4ee5\u964d\u306e\u6700\u521d\u306b\u51fa\u73fe\u3057\u305f\u6570\u5b57\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8 Ctrl-x \u30ab\u30fc\u30bd\u30eb\u884c\u4e0a\u3067, \u30ab\u30fc\u30bd\u30eb\u4ee5\u964d\u306e\u6700\u521d\u306b\u51fa\u73fe\u3057\u305f\u6570\u5b57\u3092\u30c7\u30af\u30ea\u30e1\u30f3\u30c8 \u30ab\u30fc\u30bd\u30eb\u4e0b\u306b\u6570\u5b57\u304c\u306a\u304f\u3066\u3082\u4f7f\u7528\u3067\u304d\u308b\u305f\u3081, \u79fb\u52d5\u306b\u3082\u4f7f\u3048\u307e\u3059. \u6ce8\u610f \u4e3b\u306b\u3044\u3064\u3082\u4f7f\u3063\u3066\u3044\u308b\u30b3\u30de\u30f3\u30c9\u3092\u307e\u3068\u3081\u3066\u307f\u307e\u3057\u305f. \u591a\u304f\u306e\u30b3\u30de\u30f3\u30c9\u306f, \u76f4\u524d\u306b\u6570\u5b57\u306a\u3069\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059. \u4f8b\u3048\u3070, 3dd\u3068\u3059\u308c\u30703\u884c\u524a\u9664\u3067\u304d\u307e\u3059. 10i\u3067\u30a4\u30f3\u30b5\u30fc\u30c8\u30e2\u30fc\u30c9\u306b\u5165\u3063\u3066, \u6587\u5b57\u3092\u5165\u529b\u3057\u305f\u5f8c\u306b\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u3082\u3069\u308c\u306f, \u5165\u529b\u3057\u305f\u6587\u5b57\u304c10\u500b\u5206\u5165\u529b\u3055\u308c\u307e\u3059. \u3042\u3068, \u3053\u3053\u306b\u66f8\u3044\u3066\u3042\u308b\u4ee5\u5916\u306b\u3082\u305f\u304f\u3055\u3093\u30b3\u30de\u30f3\u30c9\u306f\u3042\u308a\u307e\u3059\u306e\u3067, \u3042\u3057\u304b\u3089\u305a.","title":"VIM"},{"location":"vim/#build-vim","text":"$ ./configure --prefix=$HOME/myetc \\ --with-features=huge \\ --enable-gui=gnome2 \\ --enable-perlinterp \\ --enable-pythoninterp \\ --enable-python3interp \\ --enable-fail-if-missing \\ --disable-selinux \\ --enable-pythoninterp=dynamic \\ --with-python-config-dir=/home/user/.pyenv/versions/2.7.14/lib/python2.7/config \\ --enable-python3interp=dynamic \\ --with-python3-config-dir=/home/user/.pyenv/versions/3.6.5/lib/python3.6/config-3.6m \\ --enable-rubyinterp=dynamic \\ --enable-cscope \\ --enable-fontset \\ --enable-multibyte \\ vi_cv_path_python3=/home/uers/.pyenv/versions/3.6.5/bin/python3.6 make make install vim ~/.zshrc alias vi='~/myetc/bin/vim' alias vim='~/myetc/bin/vim' \u30ad\u30fc\u5165\u529b \u52d5\u4f5c vi \u30d5\u30a1\u30a4\u30eb\u540d \u5bfe\u8c61\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\uff08\u8907\u6570\u30d5\u30a1\u30a4\u30eb\u53ef\uff09 vi +n \u30d5\u30a1\u30a4\u30eb\u540d n \u884c\u76ee\u304b\u3089\u5bfe\u8c61\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f vi -r \u30d5\u30a1\u30a4\u30eb\u540d \u58ca\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30ab\u30d0\u30ea i \u30ab\u30fc\u30bd\u30eb\u306e\u5de6\u304b\u3089\u5165\u529b\u958b\u59cb I \u884c\u982d\u304b\u3089\u5165\u529b\u958b\u59cb a \u30ab\u30fc\u30bd\u30eb\u306e\u53f3\u304b\u3089\u5165\u529b\u958b\u59cb A \u884c\u672b\u304b\u3089\u5165\u529b\u958b\u59cb ZZ vi \u3092\u7d42\u4e86\uff08\u5185\u5bb9\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u308b\u5834\u5408\u306f\u4fdd\u5b58\uff09 :wq \u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\u3001vi \u3092\u7d42\u4e86 :#,# w #\u884c\u76ee\u304b\u3089#\u884c\u76ee\u307e\u3067\u3092\u4fdd\u5b58 :q vi \u3092\u7d42\u4e86\uff08\u5185\u5bb9\u304c\u5909\u66f4\u3055\u308c\u3044\u308b\u5834\u5408\u306f\u8b66\u544a\uff09 :q! vi \u3092\u5f37\u5236\u7d42\u4e86\uff08\u5185\u5bb9\u304c\u5909\u66f4\u3055\u308c\u3066\u3044\u3066\u3082\u4fdd\u5b58\u3057\u306a\u3044\uff09 :ls \u30d0\u30c3\u30d5\u30a1\u30ea\u30b9\u30c8\u306e\u8868\u793a :b \u30d0\u30c3\u30d5\u30a1 \u30d0\u30c3\u30d5\u30a1\u3092\u8868\u793a :bn \u6b21\u306e\u30d0\u30c3\u30d5\u30a1\u3092\u8868\u793a :bp \u524d\u306e\u30d0\u30c3\u30d5\u30a1\u3092\u8868\u793a [n] x \u30ab\u30fc\u30bd\u30eb\u4e0a\u306e1\u6587\u5b57\u524a\u9664 [n] X \u30ab\u30fc\u30bd\u30eb\u306e\u5de6\u306e\u6587\u5b57\u30921\u6587\u5b57\u524a\u9664 p \u30d0\u30c3\u30d5\u30a1\u5185\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u633f\u5165\uff08\u6587\u5b57\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u53f3\u3001\u884c\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u4e0b\u306b\u633f\u5165\uff09 P \u30d0\u30c3\u30d5\u30a1\u5185\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u633f\u5165\uff08\u6587\u5b57\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u5de6\u3001\u884c\u306f\u30ab\u30fc\u30bd\u30eb\u306e\u4e0a\u306b\u633f\u5165\uff09 :r [\u30d5\u30a1\u30a4\u30eb\u540d] \u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u8eab\u3092\u633f\u5165\u3059\u308b [n] d \u76ee\u7684\u8a9e \\ d [n] \u76ee\u7684\u8a9e \u76ee\u7684\u8a9e\u4e00\u89a7: ::: w - \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u7a7a\u767d\u3092\u542b\u3080\u5358\u8a9e\u306e\u672b\u5c3e\u307e\u3067\u524a\u9664 ::: e - \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u7a7a\u767d\u3092\u542b\u307e\u306a\u3044\u5358\u8a9e\u306e\u672b\u5c3e\u307e\u3067\u524a\u9664 ::: $ - \u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u304b\u3089\u884c\u672b\u307e\u3067\u524a\u9664 ::: d - 1\u884c\u524a\u9664\u5207\u308a\u53d6\u308a\uff08\u30ab\u30c3\u30c8\uff09 /<\u6587\u5b57\u5217> \u6587\u5b57\u5217 \u3092\u691c\u7d22\u3059\u308b\uff08\u9806\u65b9\u5411\uff09 ?<\u6587\u5b57\u5217> \u6587\u5b57\u5217\u3092\u691c\u7d22\u3059\u308b\uff08\u9006\u65b9\u5411\uff09 n \u9806\u65b9\u5411\u3078\u691c\u7d22\u3059\u308b N \u9006\u65b9\u5411\u3078\u691c\u7d22\u3059\u308b % (,[\u306b\u5bfe\u3057\u3066\u5bfe\u5fdc\u3059\u308b ),] \u3084 } \u3092\u691c\u7d22 r \u30ab\u30fc\u30bd\u30eb\u306e\u4e0b\u306e\u6587\u5b57\u3092\u7f6e\u304d\u63db\u3048\u308b [n] c \u76ee\u7684\u8a9e \\ c [n] \u76ee\u7684\u8a9e \u76ee\u7684\u8a9e\u4e00\u89a7: ::: w - \u5358\u8a9e\u306e\u4e00\u90e8\u3092\u5909\u66f4\u3059\u308b ::: $ - \u884c\u306e\u4e00\u90e8\u3092\u5909\u66f4\u3059\u308b :s/[old]/[new] [old]\u3092[new]\u306b\u7f6e\u63db\u3059\u308b ::: \u73fe\u5728\u884c\u306e\u6700\u521d\u306e old \u3092 new \u306b\u7f6e\u63db\u3059\u308b :s/old/new ::: \u73fe\u5728\u884c\u306e\u5168\u3066\u306e old \u3092 new \u306b\u7f6e\u63db\u3059\u308b :s/old/new/g ::: 2\u3064\u306e # \u9593\u3067\u8a9e\u53e5\u3092\u7f6e\u63db\u3059\u308b :#,#s/old/new/g ::: \u30d5\u30a1\u30a4\u30eb\u306e\u4e2d\u306e\u5168\u3066\u306e\u691c\u7d22\u8a9e\u53e5\u3092\u7f6e\u63db\u3059\u308b: :%s/old/new/g ::: 'c' \u3092\u52a0\u3048\u308b\u3068\u7f6e\u63db\u306e\u5ea6\u306b\u78ba\u8a8d\u3092\u6c42\u3081\u308b :%s/old/new/gc CTRL-g \u30d5\u30a1\u30a4\u30eb\u5185\u3067\u306e\u4f4d\u7f6e\u3068\u30d5\u30a1\u30a4\u30eb\u306e\u72b6\u614b\u3092\u8868\u793a [n] Shift-g \u30d5\u30a1\u30a4\u30eb\u5185\u306en\u884c\u306b\u79fb\u52d5\uff08n\u304c\u7121\u3051\u308c\u3070\u30d5\u30a1\u30a4\u30eb\u672b\u306b\u79fb\u52d5\uff09 :sp [\u30d5\u30a1\u30a4\u30eb] \u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u6a2a\u306b\u5206\u5272 :vs [\u30d5\u30a1\u30a4\u30eb] \u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u7e26\u306b\u5206\u5272 : q , :only \u30ab\u30fc\u30bd\u30eb\u306e\u3042\u308b\u30a6\u30a3\u30f3\u30c9\u30a6\u4ee5\u5916\u3092\u5168\u90e8\u9589\u3058\u308b :new \u7a7a\u306e\u6a2a\u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u958b\u304f :vnew \u7a7a\u306e\u7e26\u30a6\u30a4\u30f3\u30c9\u30a6\u3092\u958b\u304f Ctrl-w w \u6b21\u306e\u30a6\u30a4\u30f3\u30c9\u30a6\u306b\u79fb\u52d5 Ctrl-w p \u524d\u306e\u30a6\u30a4\u30f3\u30c9\u30a6\u306b\u79fb\u52d5 Ctrl-w o \u73fe\u5728\u306e\u30a6\u30a4\u30f3\u30c9\u30a6\u4ee5\u5916\u3092\u9589\u3058\u308b u \u76f4\u524d\u306e\u64cd\u4f5c\u3092\u53d6\u308a\u3084\u3081\u308b U \u884c\u5168\u4f53\u306e\u64cd\u4f5c\u3092\u53d6\u308a\u3084\u3081\u308b Ctrl-R \u53d6\u308a\u6d88\u3057\u306e\u53d6\u308a\u6d88\u3057 . \u76f4\u524d\u306e\u64cd\u4f5c\u306e\u7e70\u308a\u8fd4\u3057 :! [\u5916\u90e8\u30b3\u30de\u30f3\u30c9] \u5916\u90e8\u30b7\u30a7\u30eb\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c U \u884c\u5168\u4f53\u306e\u64cd\u4f5c\u3092\u53d6\u308a\u3084\u3081\u308b :set number\u3001 :set nu \u884c\u756a\u53f7\u3092\u8868\u793a :set no number\u3001 :set nonu \u884c\u756a\u53f7\u306e\u8868\u793a\u3092\u3084\u3081\u308b :set showmode \u73fe\u5728\u306e\u30e2\u30fc\u30c9\u3092\u8868\u793a :set showmatch () \u3084 {} \u306e\u5bfe\u5fdc\u3092\u5831\u544a :set ignorecase \u5927\u6587\u5b57/\u5c0f\u6587\u5b57\u306e\u533a\u5225\u306a\u304f\u691c\u7d22 :set autoindent \u81ea\u52d5\u30a4\u30f3\u30c7\u30f3\u30c8\u30e2\u30fc\u30c9 :set noautoindent \u81ea\u52d5\u30a4\u30f3\u30c7\u30f3\u30c8\u30e2\u30fc\u30c9\u3092\u3084\u3081\u308b :set all \u3059\u3079\u3066\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u8868\u793a :e [\u30d5\u30a1\u30a4\u30eb] \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f :syntax on \u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u30cf\u30a4\u30e9\u30a4\u30c8\u8868\u793a\u3059\u308b :vert diffsplit [\u30d5\u30a1\u30a4\u30eb] \u4eca\u306e\u30d5\u30a1\u30a4\u30eb\u3068\u3001\u4ed6\u306e\u30d5\u30a1\u30a4\u30eb\u3068\u306e\u5dee\u5206\u3092\u53d6\u308b\u30b3\u30de\u30f3\u30c9 :Tutorial 30\u5206\u7a0b\u5ea6\u306eVi\u5229\u7528\u65b9\u6cd5\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","title":"build vim"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/","text":"\u539f\u6587 Python \u5728\u7a0b\u5e8f\u5e76\u884c\u5316\u65b9\u9762\u591a\u5c11\u6709\u4e9b\u58f0\u540d\u72fc\u85c9\u3002\u6487\u5f00\u6280\u672f\u4e0a\u7684\u95ee\u9898\uff0c\u4f8b\u5982\u7ebf\u7a0b\u7684\u5b9e\u73b0\u548c GIL1\uff0c\u6211\u89c9\u5f97\u9519\u8bef\u7684\u6559\u5b66\u6307\u5bfc\u624d\u662f\u4e3b\u8981\u95ee\u9898\u3002 \u5e38\u89c1\u7684\u7ecf\u5178 Python \u591a\u7ebf\u7a0b\u3001\u591a\u8fdb\u7a0b\u6559\u7a0b\u591a\u663e\u5f97\u504f\u201c\u91cd\u201d\u3002\u800c\u4e14\u5f80\u5f80\u9694\u9774\u6414\u75d2\uff0c\u6ca1\u6709\u6df1\u5165\u63a2\u8ba8\u65e5\u5e38\u5de5\u4f5c\u4e2d\u6700\u6709\u7528\u7684\u5185\u5bb9\u3002 \u4f20\u7edf\u7684\u4f8b\u5b50 \u00b6 \u7b80\u5355\u641c\u7d22\u4e0b\u201cPython \u591a\u7ebf\u7a0b\u6559\u7a0b\u201d\uff0c\u4e0d\u96be\u53d1\u73b0\u51e0\u4e4e\u6240\u6709\u7684\u6559\u7a0b\u90fd\u7ed9\u51fa\u6d89\u53ca\u7c7b\u548c\u961f\u5217\u7684\u4f8b\u5b50\uff1a #Example.py ''' Standard Producer/Consumer Threading Pattern ''' import time import threading import Queue class Consumer(threading.Thread): def __init__(self, queue): threading.Thread.__init__(self) self._queue = queue def run(self): while True: # queue.get() blocks the current thread until # an item is retrieved. msg = self._queue.get() # Checks if the current message is # the \"Poison Pill\" if isinstance(msg, str) and msg == 'quit': # if so, exists the loop break # \"Processes\" (or in our case, prints) the queue item print \"I'm a thread, and I received %s!!\" % msg # Always be friendly! print 'Bye byes!' def Producer(): # Queue is used to share items between # the threads. queue = Queue.Queue() # Create an instance of the worker worker = Consumer(queue) # start calls the internal run() method to # kick off the thread worker.start() # variable to keep track of when we started start_time = time.time() # While under 5 seconds.. while time.time() - start_time < 5: # \"Produce\" a piece of work and stick it in # the queue for the Consumer to process queue.put('something at %s' % time.time()) # Sleep a bit just to avoid an absurd number of messages time.sleep(1) # This the \"poison pill\" method of killing a thread. queue.put('quit') # wait for the thread to close down worker.join() if __name__ == '__main__': Producer() \u54c8\uff0c\u770b\u8d77\u6765\u6709\u4e9b\u50cf Java \u4e0d\u662f\u5417\uff1f \u6211\u5e76\u4e0d\u662f\u8bf4\u4f7f\u7528\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6a21\u578b\u5904\u7406\u591a\u7ebf\u7a0b/\u591a\u8fdb\u7a0b\u4efb\u52a1\u662f\u9519\u8bef\u7684\uff08\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e00\u6a21\u578b\u81ea\u6709\u5176\u7528\u6b66\u4e4b\u5730\uff09\u3002\u53ea\u662f\uff0c\u5904\u7406\u65e5\u5e38\u811a\u672c\u4efb\u52a1\u65f6\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u66f4\u6709\u6548\u7387\u7684\u6a21\u578b\u3002 \u95ee\u9898\u5728\u4e8e\u2026 \u00b6 \u9996\u5148\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u6837\u677f\u7c7b\uff1b \u5176\u6b21\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u961f\u5217\u6765\u4f20\u9012\u5bf9\u8c61\uff1b \u800c\u4e14\uff0c\u4f60\u8fd8\u9700\u8981\u5728\u901a\u9053\u4e24\u7aef\u90fd\u6784\u5efa\u76f8\u5e94\u7684\u65b9\u6cd5\u6765\u534f\u52a9\u5176\u5de5\u4f5c\uff08\u5982\u679c\u9700\u60f3\u8981\u8fdb\u884c\u53cc\u5411\u901a\u4fe1\u6216\u662f\u4fdd\u5b58\u7ed3\u679c\u8fd8\u9700\u8981\u518d\u5f15\u5165\u4e00\u4e2a\u961f\u5217\uff09\u3002 worker \u8d8a\u591a\uff0c\u95ee\u9898\u8d8a\u591a \u00b6 \u6309\u7167\u8fd9\u4e00\u601d\u8def\uff0c\u4f60\u73b0\u5728\u9700\u8981\u4e00\u4e2a worker \u7ebf\u7a0b\u7684\u7ebf\u7a0b\u6c60\u3002\u4e0b\u9762\u662f\u4e00\u7bc7 IBM \u7ecf\u5178\u6559\u7a0b \u4e2d\u7684\u4f8b\u5b50\u2014\u2014\u5728\u8fdb\u884c\u7f51\u9875\u68c0\u7d22\u65f6\u901a\u8fc7\u591a\u7ebf\u7a0b\u8fdb\u884c\u52a0\u901f\u3002 #Example2.py ''' A more realistic thread pool example ''' import time import threading import Queue import urllib2 class Consumer(threading.Thread): def __init__(self, queue): threading.Thread.__init__(self) self._queue = queue def run(self): while True: content = self._queue.get() if isinstance(content, str) and content == 'quit': break response = urllib2.urlopen(content) print 'Bye byes!' def Producer(): urls = [ 'http://www.python.org', 'http://www.yahoo.com' 'http://www.scala.org', 'http://www.google.com' # etc.. ] queue = Queue.Queue() worker_threads = build_worker_pool(queue, 4) start_time = time.time() # Add the urls to process for url in urls: queue.put(url) # Add the poison pillv for worker in worker_threads: queue.put('quit') for worker in worker_threads: worker.join() print 'Done! Time taken: {}'.format(time.time() - start_time) def build_worker_pool(queue, size): workers = [] for _ in range(size): worker = Consumer(queue) worker.start() workers.append(worker) return workers if __name__ == '__main__': Producer() \u8fd9\u6bb5\u4ee3\u7801\u80fd\u6b63\u786e\u7684\u8fd0\u884c\uff0c\u4f46\u4ed4\u7ec6\u770b\u770b\u6211\u4eec\u9700\u8981\u505a\u4e9b\u4ec0\u4e48\uff1a\u6784\u9020\u4e0d\u540c\u7684\u65b9\u6cd5\u3001\u8ffd\u8e2a\u4e00\u7cfb\u5217\u7684\u7ebf\u7a0b\uff0c\u8fd8\u6709\u4e3a\u4e86\u89e3\u51b3\u607c\u4eba\u7684\u6b7b\u9501\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u884c\u4e00\u7cfb\u5217\u7684 join \u64cd\u4f5c\u3002\u8fd9\u8fd8\u53ea\u662f\u5f00\u59cb\u2026\u2026 \u81f3\u6b64\u6211\u4eec\u56de\u987e\u4e86\u7ecf\u5178\u7684\u591a\u7ebf\u7a0b\u6559\u7a0b\uff0c\u591a\u5c11\u6709\u4e9b\u7a7a\u6d1e\u4e0d\u662f\u5417\uff1f\u6837\u677f\u5316\u800c\u4e14\u6613\u51fa\u9519\uff0c\u8fd9\u6837\u4e8b\u500d\u529f\u534a\u7684\u98ce\u683c\u663e\u7136\u4e0d\u90a3\u4e48\u9002\u5408\u65e5\u5e38\u4f7f\u7528\uff0c\u597d\u5728\u6211\u4eec\u8fd8\u6709\u66f4\u597d\u7684\u65b9\u6cd5\u3002 \u4f55\u4e0d\u8bd5\u8bd5 map \u00b6 map \u8fd9\u4e00\u5c0f\u5de7\u7cbe\u81f4\u7684\u51fd\u6570\u662f\u7b80\u6377\u5b9e\u73b0 Python \u7a0b\u5e8f\u5e76\u884c\u5316\u7684\u5173\u952e\u3002map \u6e90\u4e8e Lisp \u8fd9\u7c7b\u51fd\u6570\u5f0f\u7f16\u7a0b\u8bed\u8a00\u3002\u5b83\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u5e8f\u5217\u5b9e\u73b0\u4e24\u4e2a\u51fd\u6570\u4e4b\u95f4\u7684\u6620\u5c04\u3002 urls = ['http://www.yahoo.com', 'http://www.reddit.com'] results = map(urllib2.urlopen, urls) \u4e0a\u9762\u7684\u8fd9\u4e24\u884c\u4ee3\u7801\u5c06 urls \u8fd9\u4e00\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230 urlopen \u65b9\u6cd5\u4e2d\uff0c\u5e76\u5c06\u6240\u6709\u7ed3\u679c\u4fdd\u5b58\u5230 results \u8fd9\u4e00\u5217\u8868\u4e2d\u3002\u5176\u7ed3\u679c\u5927\u81f4\u76f8\u5f53\u4e8e\uff1a results = [] for url in urls: results.append(urllib2.urlopen(url)) map \u51fd\u6570\u4e00\u624b\u5305\u529e\u4e86\u5e8f\u5217\u64cd\u4f5c\u3001\u53c2\u6570\u4f20\u9012\u548c\u7ed3\u679c\u4fdd\u5b58\u7b49\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\u3002 \u4e3a\u4ec0\u4e48\u8fd9\u5f88\u91cd\u8981\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u501f\u52a9\u6b63\u786e\u7684\u5e93\uff0cmap \u53ef\u4ee5\u8f7b\u677e\u5b9e\u73b0\u5e76\u884c\u5316\u64cd\u4f5c\u3002 \u5728 Python \u4e2d\u6709\u4e2a\u4e24\u4e2a\u5e93\u5305\u542b\u4e86 map \u51fd\u6570\uff1a multiprocessing \u548c\u5b83\u9c9c\u4e3a\u4eba\u77e5\u7684\u5b50\u5e93 multiprocessing.dummy. \u8fd9\u91cc\u591a\u626f\u4e24\u53e5\uff1a multiprocessing.dummy\uff1f mltiprocessing \u5e93\u7684\u7ebf\u7a0b\u7248\u514b\u9686\uff1f\u8fd9\u662f\u867e\u7c73\uff1f\u5373\u4fbf\u5728 multiprocessing \u5e93\u7684\u5b98\u65b9\u6587\u6863\u91cc\u5173\u4e8e\u8fd9\u4e00\u5b50\u5e93\u4e5f\u53ea\u6709\u4e00\u53e5\u76f8\u5173\u63cf\u8ff0\u3002\u800c\u8fd9\u53e5\u63cf\u8ff0\u8bd1\u6210\u4eba\u8bdd\u57fa\u672c\u5c31\u662f\u8bf4:\"\u561b\uff0c\u6709\u8fd9\u4e48\u4e2a\u4e1c\u897f\uff0c\u4f60\u77e5\u9053\u5c31\u6210.\"\u76f8\u4fe1\u6211\uff0c\u8fd9\u4e2a\u5e93\u88ab\u4e25\u91cd\u4f4e\u4f30\u4e86\uff01 dummy \u662f multiprocessing \u6a21\u5757\u7684\u5b8c\u6574\u514b\u9686\uff0c\u552f\u4e00\u7684\u4e0d\u540c\u5728\u4e8e multiprocessing \u4f5c\u7528\u4e8e\u8fdb\u7a0b\uff0c\u800c dummy \u6a21\u5757\u4f5c\u7528\u4e8e\u7ebf\u7a0b\uff08\u56e0\u6b64\u4e5f\u5305\u62ec\u4e86 Python \u6240\u6709\u5e38\u89c1\u7684\u591a\u7ebf\u7a0b\u9650\u5236\uff09\u3002 \u6240\u4ee5\u66ff\u6362\u4f7f\u7528\u8fd9\u4e24\u4e2a\u5e93\u5f02\u5e38\u5bb9\u6613\u3002\u4f60\u53ef\u4ee5\u9488\u5bf9 IO \u5bc6\u96c6\u578b\u4efb\u52a1\u548c CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u6765\u9009\u62e9\u4e0d\u540c\u7684\u5e93\u3002 \u52a8\u624b\u5c1d\u8bd5 \u00b6 \u4f7f\u7528\u4e0b\u9762\u7684\u4e24\u884c\u4ee3\u7801\u6765\u5f15\u7528\u5305\u542b\u5e76\u884c\u5316 map \u51fd\u6570\u7684\u5e93\uff1a from multiprocessing import Pool from multiprocessing.dummy import Pool as ThreadPool \u5b9e\u4f8b\u5316 Pool \u5bf9\u8c61\uff1a pool = ThreadPool() \u8fd9\u6761\u7b80\u5355\u7684\u8bed\u53e5\u66ff\u4ee3\u4e86 example2.py \u4e2d build_worker_pool \u51fd\u6570 7 \u884c\u4ee3\u7801\u7684\u5de5\u4f5c\u3002\u5b83\u751f\u6210\u4e86\u4e00\u7cfb\u5217\u7684 worker \u7ebf\u7a0b\u5e76\u5b8c\u6210\u521d\u59cb\u5316\u5de5\u4f5c\u3001\u5c06\u5b83\u4eec\u50a8\u5b58\u5728\u53d8\u91cf\u4e2d\u4ee5\u65b9\u4fbf\u8bbf\u95ee\u3002 Pool \u5bf9\u8c61\u6709\u4e00\u4e9b\u53c2\u6570\uff0c\u8fd9\u91cc\u6211\u6240\u9700\u8981\u5173\u6ce8\u7684\u53ea\u662f\u5b83\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1aprocesses. \u8fd9\u4e00\u53c2\u6570\u7528\u4e8e\u8bbe\u5b9a\u7ebf\u7a0b\u6c60\u4e2d\u7684\u7ebf\u7a0b\u6570\u3002\u5176\u9ed8\u8ba4\u503c\u4e3a\u5f53\u524d\u673a\u5668 CPU \u7684\u6838\u6570\u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u6267\u884c CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u65f6\uff0c\u8c03\u7528\u8d8a\u591a\u7684\u6838\u901f\u5ea6\u5c31\u8d8a\u5feb\u3002\u4f46\u662f\u5f53\u5904\u7406\u7f51\u7edc\u5bc6\u96c6\u578b\u4efb\u52a1\u65f6\uff0c\u4e8b\u60c5\u6709\u6709\u4e9b\u96be\u4ee5\u9884\u8ba1\u4e86\uff0c\u901a\u8fc7\u5b9e\u9a8c\u6765\u786e\u5b9a\u7ebf\u7a0b\u6c60\u7684\u5927\u5c0f\u624d\u662f\u660e\u667a\u7684\u3002 pool = ThreadPool(4) # Sets the pool size to 4 \u7ebf\u7a0b\u6570\u8fc7\u591a\u65f6\uff0c\u5207\u6362\u7ebf\u7a0b\u6240\u6d88\u8017\u7684\u65f6\u95f4\u751a\u81f3\u4f1a\u8d85\u8fc7\u5b9e\u9645\u5de5\u4f5c\u65f6\u95f4\u3002\u5bf9\u4e8e\u4e0d\u540c\u7684\u5de5\u4f5c\uff0c\u901a\u8fc7\u5c1d\u8bd5\u6765\u627e\u5230\u7ebf\u7a0b\u6c60\u5927\u5c0f\u7684\u6700\u4f18\u503c\u662f\u4e2a\u4e0d\u9519\u7684\u4e3b\u610f\u3002 \u521b\u5efa\u597d Pool \u5bf9\u8c61\u540e\uff0c\u5e76\u884c\u5316\u7684\u7a0b\u5e8f\u4fbf\u547c\u4e4b\u6b32\u51fa\u4e86\u3002\u6211\u4eec\u6765\u770b\u770b\u6539\u5199\u540e\u7684 example2.py import urllib2 from multiprocessing.dummy import Pool as ThreadPool urls = [ 'http://www.python.org', 'http://www.python.org/about/', 'http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html', 'http://www.python.org/doc/', 'http://www.python.org/download/', 'http://www.python.org/getit/', 'http://www.python.org/community/', 'https://wiki.python.org/moin/', 'http://planet.python.org/', 'https://wiki.python.org/moin/LocalUserGroups', 'http://www.python.org/psf/', 'http://docs.python.org/devguide/', 'http://www.python.org/community/awards/' # etc.. ] # Make the Pool of workers pool = ThreadPool(4) # Open the urls in their own threads # and return the results results = pool.map(urllib2.urlopen, urls) #close the pool and wait for the work to finish pool.close() pool.join() \u5b9e\u9645\u8d77\u4f5c\u7528\u7684\u4ee3\u7801\u53ea\u6709 4 \u884c\uff0c\u5176\u4e2d\u53ea\u6709\u4e00\u884c\u662f\u5173\u952e\u7684\u3002map \u51fd\u6570\u8f7b\u800c\u6613\u4e3e\u7684\u53d6\u4ee3\u4e86\u524d\u6587\u4e2d\u8d85\u8fc7 40 \u884c\u7684\u4f8b\u5b50\u3002\u4e3a\u4e86\u66f4\u6709\u8da3\u4e00\u4e9b\uff0c\u6211\u7edf\u8ba1\u4e86\u4e0d\u540c\u65b9\u6cd5\u3001\u4e0d\u540c\u7ebf\u7a0b\u6c60\u5927\u5c0f\u7684\u8017\u65f6\u60c5\u51b5\u3002 # results = [] # for url in urls: # result = urllib2.urlopen(url) # results.append(result) # # ------- VERSUS ------- # # # ------- 4 Pool ------- # # pool = ThreadPool(4) # results = pool.map(urllib2.urlopen, urls) # # ------- 8 Pool ------- # # pool = ThreadPool(8) # results = pool.map(urllib2.urlopen, urls) # # ------- 13 Pool ------- # # pool = ThreadPool(13) # results = pool.map(urllib2.urlopen, urls) \u7ed3\u679c\uff1a # Single thread: 14.4 Seconds # 4 Pool: 3.1 Seconds # 8 Pool: 1.4 Seconds # 13 Pool: 1.3 Seconds \u5f88\u68d2\u7684\u7ed3\u679c\u4e0d\u662f\u5417\uff1f\u8fd9\u4e00\u7ed3\u679c\u4e5f\u8bf4\u660e\u4e86\u4e3a\u4ec0\u4e48\u8981\u901a\u8fc7\u5b9e\u9a8c\u6765\u786e\u5b9a\u7ebf\u7a0b\u6c60\u7684\u5927\u5c0f\u3002\u5728\u6211\u7684\u673a\u5668\u4e0a\u5f53\u7ebf\u7a0b\u6c60\u5927\u5c0f\u5927\u4e8e 9 \u5e26\u6765\u7684\u6536\u76ca\u5c31\u5341\u5206\u6709\u9650\u4e86\u3002 \u53e6\u4e00\u4e2a\u771f\u5b9e\u7684\u4f8b\u5b50 \u00b6 \u751f\u6210\u4e0a\u5343\u5f20\u56fe\u7247\u7684\u7f29\u7565\u56fe \u8fd9\u662f\u4e00\u4e2a CPU \u5bc6\u96c6\u578b\u7684\u4efb\u52a1\uff0c\u5e76\u4e14\u5341\u5206\u9002\u5408\u8fdb\u884c\u5e76\u884c\u5316\u3002 \u57fa\u7840\u5355\u8fdb\u7a0b\u7248\u672c \u00b6 import os import PIL from multiprocessing import Pool from PIL import Image SIZE = (75,75) SAVE_DIRECTORY = 'thumbs' def get_image_paths(folder): return (os.path.join(folder, f) for f in os.listdir(folder) if 'jpeg' in f) def create_thumbnail(filename): im = Image.open(filename) im.thumbnail(SIZE, Image.ANTIALIAS) base, fname = os.path.split(filename) save_path = os.path.join(base, SAVE_DIRECTORY, fname) im.save(save_path) if __name__ == '__main__': folder = os.path.abspath( '11_18_2013_R000_IQM_Big_Sur_Mon__e10d1958e7b766c3e840') os.mkdir(os.path.join(folder, SAVE_DIRECTORY)) images = get_image_paths(folder) for image in images: create_thumbnail(Image) \u4e0a\u8fb9\u8fd9\u6bb5\u4ee3\u7801\u7684\u4e3b\u8981\u5de5\u4f5c\u5c31\u662f\u5c06\u904d\u5386\u4f20\u5165\u7684\u6587\u4ef6\u5939\u4e2d\u7684\u56fe\u7247\u6587\u4ef6\uff0c\u4e00\u4e00\u751f\u6210\u7f29\u7565\u56fe\uff0c\u5e76\u5c06\u8fd9\u4e9b\u7f29\u7565\u56fe\u4fdd\u5b58\u5230\u7279\u5b9a\u6587\u4ef6\u5939\u4e2d\u3002 \u8fd9\u6211\u7684\u673a\u5668\u4e0a\uff0c\u7528\u8fd9\u4e00\u7a0b\u5e8f\u5904\u7406 6000 \u5f20\u56fe\u7247\u9700\u8981\u82b1\u8d39 27.9 \u79d2\u3002 \u5982\u679c\u6211\u4eec\u4f7f\u7528 map \u51fd\u6570\u6765\u4ee3\u66ff for \u5faa\u73af\uff1a import os import PIL from multiprocessing import Pool from PIL import Image SIZE = (75,75) SAVE_DIRECTORY = 'thumbs' def get_image_paths(folder): return (os.path.join(folder, f) for f in os.listdir(folder) if 'jpeg' in f) def create_thumbnail(filename): im = Image.open(filename) im.thumbnail(SIZE, Image.ANTIALIAS) base, fname = os.path.split(filename) save_path = os.path.join(base, SAVE_DIRECTORY, fname) im.save(save_path) if __name__ == '__main__': folder = os.path.abspath( '11_18_2013_R000_IQM_Big_Sur_Mon__e10d1958e7b766c3e840') os.mkdir(os.path.join(folder, SAVE_DIRECTORY)) images = get_image_paths(folder) pool = Pool() pool.map(creat_thumbnail, images) pool.close() pool.join() 5.6 \u79d2\uff01 \u00b6 \u867d\u7136\u53ea\u6539\u52a8\u4e86\u51e0\u884c\u4ee3\u7801\uff0c\u6211\u4eec\u5374\u660e\u663e\u63d0\u9ad8\u4e86\u7a0b\u5e8f\u7684\u6267\u884c\u901f\u5ea6\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u548c IO \u5bc6\u96c6\u578b\u4efb\u52a1\u5206\u522b\u9009\u62e9\u591a\u8fdb\u7a0b\u548c\u591a\u7ebf\u7a0b\u5e93\u6765\u8fdb\u4e00\u6b65\u63d0\u9ad8\u6267\u884c\u901f\u5ea6\u2014\u2014\u8fd9\u4e5f\u662f\u89e3\u51b3\u6b7b\u9501\u95ee\u9898\u7684\u826f\u65b9\u3002\u6b64\u5916\uff0c\u7531\u4e8e map \u51fd\u6570\u5e76\u4e0d\u652f\u6301\u624b\u52a8\u7ebf\u7a0b\u7ba1\u7406\uff0c\u53cd\u800c\u4f7f\u5f97\u76f8\u5173\u7684 debug \u5de5\u4f5c\u4e5f\u53d8\u5f97\u5f02\u5e38\u7b80\u5355\u3002 \u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\uff08\u57fa\u672c\uff09\u901a\u8fc7\u4e00\u884c Python \u5b9e\u73b0\u5e76\u884c\u5316\u3002 \u4e0b\u9762\u7684\u7f51\u5740\u4e2d\u53ef\u4ee5\u627e\u5230\u5173\u4e8e GIL\uff08Global Interpretor Lock\uff0c\u5168\u5c40\u89e3\u91ca\u5668\u9501\uff09\u66f4\u591a\u7684\u8ba8\u8bba\uff1a http://stackoverflow.com/questions/3044580/multiprocessing-vs-threading-python \u7b80\u8a00\u4e4b\uff0cIO \u5bc6\u96c6\u578b\u4efb\u52a1\u9009\u62e9multiprocessing.dummy\uff0cCPU \u5bc6\u96c6\u578b\u4efb\u52a1\u9009\u62e9multiprocessing","title":"\u4ee3\u7801\u5e76\u884c"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#_1","text":"\u7b80\u5355\u641c\u7d22\u4e0b\u201cPython \u591a\u7ebf\u7a0b\u6559\u7a0b\u201d\uff0c\u4e0d\u96be\u53d1\u73b0\u51e0\u4e4e\u6240\u6709\u7684\u6559\u7a0b\u90fd\u7ed9\u51fa\u6d89\u53ca\u7c7b\u548c\u961f\u5217\u7684\u4f8b\u5b50\uff1a #Example.py ''' Standard Producer/Consumer Threading Pattern ''' import time import threading import Queue class Consumer(threading.Thread): def __init__(self, queue): threading.Thread.__init__(self) self._queue = queue def run(self): while True: # queue.get() blocks the current thread until # an item is retrieved. msg = self._queue.get() # Checks if the current message is # the \"Poison Pill\" if isinstance(msg, str) and msg == 'quit': # if so, exists the loop break # \"Processes\" (or in our case, prints) the queue item print \"I'm a thread, and I received %s!!\" % msg # Always be friendly! print 'Bye byes!' def Producer(): # Queue is used to share items between # the threads. queue = Queue.Queue() # Create an instance of the worker worker = Consumer(queue) # start calls the internal run() method to # kick off the thread worker.start() # variable to keep track of when we started start_time = time.time() # While under 5 seconds.. while time.time() - start_time < 5: # \"Produce\" a piece of work and stick it in # the queue for the Consumer to process queue.put('something at %s' % time.time()) # Sleep a bit just to avoid an absurd number of messages time.sleep(1) # This the \"poison pill\" method of killing a thread. queue.put('quit') # wait for the thread to close down worker.join() if __name__ == '__main__': Producer() \u54c8\uff0c\u770b\u8d77\u6765\u6709\u4e9b\u50cf Java \u4e0d\u662f\u5417\uff1f \u6211\u5e76\u4e0d\u662f\u8bf4\u4f7f\u7528\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u6a21\u578b\u5904\u7406\u591a\u7ebf\u7a0b/\u591a\u8fdb\u7a0b\u4efb\u52a1\u662f\u9519\u8bef\u7684\uff08\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e00\u6a21\u578b\u81ea\u6709\u5176\u7528\u6b66\u4e4b\u5730\uff09\u3002\u53ea\u662f\uff0c\u5904\u7406\u65e5\u5e38\u811a\u672c\u4efb\u52a1\u65f6\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u66f4\u6709\u6548\u7387\u7684\u6a21\u578b\u3002","title":"\u4f20\u7edf\u7684\u4f8b\u5b50"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#_2","text":"\u9996\u5148\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u6837\u677f\u7c7b\uff1b \u5176\u6b21\uff0c\u4f60\u9700\u8981\u4e00\u4e2a\u961f\u5217\u6765\u4f20\u9012\u5bf9\u8c61\uff1b \u800c\u4e14\uff0c\u4f60\u8fd8\u9700\u8981\u5728\u901a\u9053\u4e24\u7aef\u90fd\u6784\u5efa\u76f8\u5e94\u7684\u65b9\u6cd5\u6765\u534f\u52a9\u5176\u5de5\u4f5c\uff08\u5982\u679c\u9700\u60f3\u8981\u8fdb\u884c\u53cc\u5411\u901a\u4fe1\u6216\u662f\u4fdd\u5b58\u7ed3\u679c\u8fd8\u9700\u8981\u518d\u5f15\u5165\u4e00\u4e2a\u961f\u5217\uff09\u3002","title":"\u95ee\u9898\u5728\u4e8e\u2026"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#worker","text":"\u6309\u7167\u8fd9\u4e00\u601d\u8def\uff0c\u4f60\u73b0\u5728\u9700\u8981\u4e00\u4e2a worker \u7ebf\u7a0b\u7684\u7ebf\u7a0b\u6c60\u3002\u4e0b\u9762\u662f\u4e00\u7bc7 IBM \u7ecf\u5178\u6559\u7a0b \u4e2d\u7684\u4f8b\u5b50\u2014\u2014\u5728\u8fdb\u884c\u7f51\u9875\u68c0\u7d22\u65f6\u901a\u8fc7\u591a\u7ebf\u7a0b\u8fdb\u884c\u52a0\u901f\u3002 #Example2.py ''' A more realistic thread pool example ''' import time import threading import Queue import urllib2 class Consumer(threading.Thread): def __init__(self, queue): threading.Thread.__init__(self) self._queue = queue def run(self): while True: content = self._queue.get() if isinstance(content, str) and content == 'quit': break response = urllib2.urlopen(content) print 'Bye byes!' def Producer(): urls = [ 'http://www.python.org', 'http://www.yahoo.com' 'http://www.scala.org', 'http://www.google.com' # etc.. ] queue = Queue.Queue() worker_threads = build_worker_pool(queue, 4) start_time = time.time() # Add the urls to process for url in urls: queue.put(url) # Add the poison pillv for worker in worker_threads: queue.put('quit') for worker in worker_threads: worker.join() print 'Done! Time taken: {}'.format(time.time() - start_time) def build_worker_pool(queue, size): workers = [] for _ in range(size): worker = Consumer(queue) worker.start() workers.append(worker) return workers if __name__ == '__main__': Producer() \u8fd9\u6bb5\u4ee3\u7801\u80fd\u6b63\u786e\u7684\u8fd0\u884c\uff0c\u4f46\u4ed4\u7ec6\u770b\u770b\u6211\u4eec\u9700\u8981\u505a\u4e9b\u4ec0\u4e48\uff1a\u6784\u9020\u4e0d\u540c\u7684\u65b9\u6cd5\u3001\u8ffd\u8e2a\u4e00\u7cfb\u5217\u7684\u7ebf\u7a0b\uff0c\u8fd8\u6709\u4e3a\u4e86\u89e3\u51b3\u607c\u4eba\u7684\u6b7b\u9501\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u884c\u4e00\u7cfb\u5217\u7684 join \u64cd\u4f5c\u3002\u8fd9\u8fd8\u53ea\u662f\u5f00\u59cb\u2026\u2026 \u81f3\u6b64\u6211\u4eec\u56de\u987e\u4e86\u7ecf\u5178\u7684\u591a\u7ebf\u7a0b\u6559\u7a0b\uff0c\u591a\u5c11\u6709\u4e9b\u7a7a\u6d1e\u4e0d\u662f\u5417\uff1f\u6837\u677f\u5316\u800c\u4e14\u6613\u51fa\u9519\uff0c\u8fd9\u6837\u4e8b\u500d\u529f\u534a\u7684\u98ce\u683c\u663e\u7136\u4e0d\u90a3\u4e48\u9002\u5408\u65e5\u5e38\u4f7f\u7528\uff0c\u597d\u5728\u6211\u4eec\u8fd8\u6709\u66f4\u597d\u7684\u65b9\u6cd5\u3002","title":"worker \u8d8a\u591a\uff0c\u95ee\u9898\u8d8a\u591a"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#map","text":"map \u8fd9\u4e00\u5c0f\u5de7\u7cbe\u81f4\u7684\u51fd\u6570\u662f\u7b80\u6377\u5b9e\u73b0 Python \u7a0b\u5e8f\u5e76\u884c\u5316\u7684\u5173\u952e\u3002map \u6e90\u4e8e Lisp \u8fd9\u7c7b\u51fd\u6570\u5f0f\u7f16\u7a0b\u8bed\u8a00\u3002\u5b83\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u5e8f\u5217\u5b9e\u73b0\u4e24\u4e2a\u51fd\u6570\u4e4b\u95f4\u7684\u6620\u5c04\u3002 urls = ['http://www.yahoo.com', 'http://www.reddit.com'] results = map(urllib2.urlopen, urls) \u4e0a\u9762\u7684\u8fd9\u4e24\u884c\u4ee3\u7801\u5c06 urls \u8fd9\u4e00\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230 urlopen \u65b9\u6cd5\u4e2d\uff0c\u5e76\u5c06\u6240\u6709\u7ed3\u679c\u4fdd\u5b58\u5230 results \u8fd9\u4e00\u5217\u8868\u4e2d\u3002\u5176\u7ed3\u679c\u5927\u81f4\u76f8\u5f53\u4e8e\uff1a results = [] for url in urls: results.append(urllib2.urlopen(url)) map \u51fd\u6570\u4e00\u624b\u5305\u529e\u4e86\u5e8f\u5217\u64cd\u4f5c\u3001\u53c2\u6570\u4f20\u9012\u548c\u7ed3\u679c\u4fdd\u5b58\u7b49\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\u3002 \u4e3a\u4ec0\u4e48\u8fd9\u5f88\u91cd\u8981\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u501f\u52a9\u6b63\u786e\u7684\u5e93\uff0cmap \u53ef\u4ee5\u8f7b\u677e\u5b9e\u73b0\u5e76\u884c\u5316\u64cd\u4f5c\u3002 \u5728 Python \u4e2d\u6709\u4e2a\u4e24\u4e2a\u5e93\u5305\u542b\u4e86 map \u51fd\u6570\uff1a multiprocessing \u548c\u5b83\u9c9c\u4e3a\u4eba\u77e5\u7684\u5b50\u5e93 multiprocessing.dummy. \u8fd9\u91cc\u591a\u626f\u4e24\u53e5\uff1a multiprocessing.dummy\uff1f mltiprocessing \u5e93\u7684\u7ebf\u7a0b\u7248\u514b\u9686\uff1f\u8fd9\u662f\u867e\u7c73\uff1f\u5373\u4fbf\u5728 multiprocessing \u5e93\u7684\u5b98\u65b9\u6587\u6863\u91cc\u5173\u4e8e\u8fd9\u4e00\u5b50\u5e93\u4e5f\u53ea\u6709\u4e00\u53e5\u76f8\u5173\u63cf\u8ff0\u3002\u800c\u8fd9\u53e5\u63cf\u8ff0\u8bd1\u6210\u4eba\u8bdd\u57fa\u672c\u5c31\u662f\u8bf4:\"\u561b\uff0c\u6709\u8fd9\u4e48\u4e2a\u4e1c\u897f\uff0c\u4f60\u77e5\u9053\u5c31\u6210.\"\u76f8\u4fe1\u6211\uff0c\u8fd9\u4e2a\u5e93\u88ab\u4e25\u91cd\u4f4e\u4f30\u4e86\uff01 dummy \u662f multiprocessing \u6a21\u5757\u7684\u5b8c\u6574\u514b\u9686\uff0c\u552f\u4e00\u7684\u4e0d\u540c\u5728\u4e8e multiprocessing \u4f5c\u7528\u4e8e\u8fdb\u7a0b\uff0c\u800c dummy \u6a21\u5757\u4f5c\u7528\u4e8e\u7ebf\u7a0b\uff08\u56e0\u6b64\u4e5f\u5305\u62ec\u4e86 Python \u6240\u6709\u5e38\u89c1\u7684\u591a\u7ebf\u7a0b\u9650\u5236\uff09\u3002 \u6240\u4ee5\u66ff\u6362\u4f7f\u7528\u8fd9\u4e24\u4e2a\u5e93\u5f02\u5e38\u5bb9\u6613\u3002\u4f60\u53ef\u4ee5\u9488\u5bf9 IO \u5bc6\u96c6\u578b\u4efb\u52a1\u548c CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u6765\u9009\u62e9\u4e0d\u540c\u7684\u5e93\u3002","title":"\u4f55\u4e0d\u8bd5\u8bd5 map"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#_3","text":"\u4f7f\u7528\u4e0b\u9762\u7684\u4e24\u884c\u4ee3\u7801\u6765\u5f15\u7528\u5305\u542b\u5e76\u884c\u5316 map \u51fd\u6570\u7684\u5e93\uff1a from multiprocessing import Pool from multiprocessing.dummy import Pool as ThreadPool \u5b9e\u4f8b\u5316 Pool \u5bf9\u8c61\uff1a pool = ThreadPool() \u8fd9\u6761\u7b80\u5355\u7684\u8bed\u53e5\u66ff\u4ee3\u4e86 example2.py \u4e2d build_worker_pool \u51fd\u6570 7 \u884c\u4ee3\u7801\u7684\u5de5\u4f5c\u3002\u5b83\u751f\u6210\u4e86\u4e00\u7cfb\u5217\u7684 worker \u7ebf\u7a0b\u5e76\u5b8c\u6210\u521d\u59cb\u5316\u5de5\u4f5c\u3001\u5c06\u5b83\u4eec\u50a8\u5b58\u5728\u53d8\u91cf\u4e2d\u4ee5\u65b9\u4fbf\u8bbf\u95ee\u3002 Pool \u5bf9\u8c61\u6709\u4e00\u4e9b\u53c2\u6570\uff0c\u8fd9\u91cc\u6211\u6240\u9700\u8981\u5173\u6ce8\u7684\u53ea\u662f\u5b83\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1aprocesses. \u8fd9\u4e00\u53c2\u6570\u7528\u4e8e\u8bbe\u5b9a\u7ebf\u7a0b\u6c60\u4e2d\u7684\u7ebf\u7a0b\u6570\u3002\u5176\u9ed8\u8ba4\u503c\u4e3a\u5f53\u524d\u673a\u5668 CPU \u7684\u6838\u6570\u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u6267\u884c CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u65f6\uff0c\u8c03\u7528\u8d8a\u591a\u7684\u6838\u901f\u5ea6\u5c31\u8d8a\u5feb\u3002\u4f46\u662f\u5f53\u5904\u7406\u7f51\u7edc\u5bc6\u96c6\u578b\u4efb\u52a1\u65f6\uff0c\u4e8b\u60c5\u6709\u6709\u4e9b\u96be\u4ee5\u9884\u8ba1\u4e86\uff0c\u901a\u8fc7\u5b9e\u9a8c\u6765\u786e\u5b9a\u7ebf\u7a0b\u6c60\u7684\u5927\u5c0f\u624d\u662f\u660e\u667a\u7684\u3002 pool = ThreadPool(4) # Sets the pool size to 4 \u7ebf\u7a0b\u6570\u8fc7\u591a\u65f6\uff0c\u5207\u6362\u7ebf\u7a0b\u6240\u6d88\u8017\u7684\u65f6\u95f4\u751a\u81f3\u4f1a\u8d85\u8fc7\u5b9e\u9645\u5de5\u4f5c\u65f6\u95f4\u3002\u5bf9\u4e8e\u4e0d\u540c\u7684\u5de5\u4f5c\uff0c\u901a\u8fc7\u5c1d\u8bd5\u6765\u627e\u5230\u7ebf\u7a0b\u6c60\u5927\u5c0f\u7684\u6700\u4f18\u503c\u662f\u4e2a\u4e0d\u9519\u7684\u4e3b\u610f\u3002 \u521b\u5efa\u597d Pool \u5bf9\u8c61\u540e\uff0c\u5e76\u884c\u5316\u7684\u7a0b\u5e8f\u4fbf\u547c\u4e4b\u6b32\u51fa\u4e86\u3002\u6211\u4eec\u6765\u770b\u770b\u6539\u5199\u540e\u7684 example2.py import urllib2 from multiprocessing.dummy import Pool as ThreadPool urls = [ 'http://www.python.org', 'http://www.python.org/about/', 'http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html', 'http://www.python.org/doc/', 'http://www.python.org/download/', 'http://www.python.org/getit/', 'http://www.python.org/community/', 'https://wiki.python.org/moin/', 'http://planet.python.org/', 'https://wiki.python.org/moin/LocalUserGroups', 'http://www.python.org/psf/', 'http://docs.python.org/devguide/', 'http://www.python.org/community/awards/' # etc.. ] # Make the Pool of workers pool = ThreadPool(4) # Open the urls in their own threads # and return the results results = pool.map(urllib2.urlopen, urls) #close the pool and wait for the work to finish pool.close() pool.join() \u5b9e\u9645\u8d77\u4f5c\u7528\u7684\u4ee3\u7801\u53ea\u6709 4 \u884c\uff0c\u5176\u4e2d\u53ea\u6709\u4e00\u884c\u662f\u5173\u952e\u7684\u3002map \u51fd\u6570\u8f7b\u800c\u6613\u4e3e\u7684\u53d6\u4ee3\u4e86\u524d\u6587\u4e2d\u8d85\u8fc7 40 \u884c\u7684\u4f8b\u5b50\u3002\u4e3a\u4e86\u66f4\u6709\u8da3\u4e00\u4e9b\uff0c\u6211\u7edf\u8ba1\u4e86\u4e0d\u540c\u65b9\u6cd5\u3001\u4e0d\u540c\u7ebf\u7a0b\u6c60\u5927\u5c0f\u7684\u8017\u65f6\u60c5\u51b5\u3002 # results = [] # for url in urls: # result = urllib2.urlopen(url) # results.append(result) # # ------- VERSUS ------- # # # ------- 4 Pool ------- # # pool = ThreadPool(4) # results = pool.map(urllib2.urlopen, urls) # # ------- 8 Pool ------- # # pool = ThreadPool(8) # results = pool.map(urllib2.urlopen, urls) # # ------- 13 Pool ------- # # pool = ThreadPool(13) # results = pool.map(urllib2.urlopen, urls) \u7ed3\u679c\uff1a # Single thread: 14.4 Seconds # 4 Pool: 3.1 Seconds # 8 Pool: 1.4 Seconds # 13 Pool: 1.3 Seconds \u5f88\u68d2\u7684\u7ed3\u679c\u4e0d\u662f\u5417\uff1f\u8fd9\u4e00\u7ed3\u679c\u4e5f\u8bf4\u660e\u4e86\u4e3a\u4ec0\u4e48\u8981\u901a\u8fc7\u5b9e\u9a8c\u6765\u786e\u5b9a\u7ebf\u7a0b\u6c60\u7684\u5927\u5c0f\u3002\u5728\u6211\u7684\u673a\u5668\u4e0a\u5f53\u7ebf\u7a0b\u6c60\u5927\u5c0f\u5927\u4e8e 9 \u5e26\u6765\u7684\u6536\u76ca\u5c31\u5341\u5206\u6709\u9650\u4e86\u3002","title":"\u52a8\u624b\u5c1d\u8bd5"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#_4","text":"\u751f\u6210\u4e0a\u5343\u5f20\u56fe\u7247\u7684\u7f29\u7565\u56fe \u8fd9\u662f\u4e00\u4e2a CPU \u5bc6\u96c6\u578b\u7684\u4efb\u52a1\uff0c\u5e76\u4e14\u5341\u5206\u9002\u5408\u8fdb\u884c\u5e76\u884c\u5316\u3002","title":"\u53e6\u4e00\u4e2a\u771f\u5b9e\u7684\u4f8b\u5b50"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#_5","text":"import os import PIL from multiprocessing import Pool from PIL import Image SIZE = (75,75) SAVE_DIRECTORY = 'thumbs' def get_image_paths(folder): return (os.path.join(folder, f) for f in os.listdir(folder) if 'jpeg' in f) def create_thumbnail(filename): im = Image.open(filename) im.thumbnail(SIZE, Image.ANTIALIAS) base, fname = os.path.split(filename) save_path = os.path.join(base, SAVE_DIRECTORY, fname) im.save(save_path) if __name__ == '__main__': folder = os.path.abspath( '11_18_2013_R000_IQM_Big_Sur_Mon__e10d1958e7b766c3e840') os.mkdir(os.path.join(folder, SAVE_DIRECTORY)) images = get_image_paths(folder) for image in images: create_thumbnail(Image) \u4e0a\u8fb9\u8fd9\u6bb5\u4ee3\u7801\u7684\u4e3b\u8981\u5de5\u4f5c\u5c31\u662f\u5c06\u904d\u5386\u4f20\u5165\u7684\u6587\u4ef6\u5939\u4e2d\u7684\u56fe\u7247\u6587\u4ef6\uff0c\u4e00\u4e00\u751f\u6210\u7f29\u7565\u56fe\uff0c\u5e76\u5c06\u8fd9\u4e9b\u7f29\u7565\u56fe\u4fdd\u5b58\u5230\u7279\u5b9a\u6587\u4ef6\u5939\u4e2d\u3002 \u8fd9\u6211\u7684\u673a\u5668\u4e0a\uff0c\u7528\u8fd9\u4e00\u7a0b\u5e8f\u5904\u7406 6000 \u5f20\u56fe\u7247\u9700\u8981\u82b1\u8d39 27.9 \u79d2\u3002 \u5982\u679c\u6211\u4eec\u4f7f\u7528 map \u51fd\u6570\u6765\u4ee3\u66ff for \u5faa\u73af\uff1a import os import PIL from multiprocessing import Pool from PIL import Image SIZE = (75,75) SAVE_DIRECTORY = 'thumbs' def get_image_paths(folder): return (os.path.join(folder, f) for f in os.listdir(folder) if 'jpeg' in f) def create_thumbnail(filename): im = Image.open(filename) im.thumbnail(SIZE, Image.ANTIALIAS) base, fname = os.path.split(filename) save_path = os.path.join(base, SAVE_DIRECTORY, fname) im.save(save_path) if __name__ == '__main__': folder = os.path.abspath( '11_18_2013_R000_IQM_Big_Sur_Mon__e10d1958e7b766c3e840') os.mkdir(os.path.join(folder, SAVE_DIRECTORY)) images = get_image_paths(folder) pool = Pool() pool.map(creat_thumbnail, images) pool.close() pool.join()","title":"\u57fa\u7840\u5355\u8fdb\u7a0b\u7248\u672c"},{"location":"%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/#56","text":"\u867d\u7136\u53ea\u6539\u52a8\u4e86\u51e0\u884c\u4ee3\u7801\uff0c\u6211\u4eec\u5374\u660e\u663e\u63d0\u9ad8\u4e86\u7a0b\u5e8f\u7684\u6267\u884c\u901f\u5ea6\u3002\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a CPU \u5bc6\u96c6\u578b\u4efb\u52a1\u548c IO \u5bc6\u96c6\u578b\u4efb\u52a1\u5206\u522b\u9009\u62e9\u591a\u8fdb\u7a0b\u548c\u591a\u7ebf\u7a0b\u5e93\u6765\u8fdb\u4e00\u6b65\u63d0\u9ad8\u6267\u884c\u901f\u5ea6\u2014\u2014\u8fd9\u4e5f\u662f\u89e3\u51b3\u6b7b\u9501\u95ee\u9898\u7684\u826f\u65b9\u3002\u6b64\u5916\uff0c\u7531\u4e8e map \u51fd\u6570\u5e76\u4e0d\u652f\u6301\u624b\u52a8\u7ebf\u7a0b\u7ba1\u7406\uff0c\u53cd\u800c\u4f7f\u5f97\u76f8\u5173\u7684 debug \u5de5\u4f5c\u4e5f\u53d8\u5f97\u5f02\u5e38\u7b80\u5355\u3002 \u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\uff08\u57fa\u672c\uff09\u901a\u8fc7\u4e00\u884c Python \u5b9e\u73b0\u5e76\u884c\u5316\u3002 \u4e0b\u9762\u7684\u7f51\u5740\u4e2d\u53ef\u4ee5\u627e\u5230\u5173\u4e8e GIL\uff08Global Interpretor Lock\uff0c\u5168\u5c40\u89e3\u91ca\u5668\u9501\uff09\u66f4\u591a\u7684\u8ba8\u8bba\uff1a http://stackoverflow.com/questions/3044580/multiprocessing-vs-threading-python \u7b80\u8a00\u4e4b\uff0cIO \u5bc6\u96c6\u578b\u4efb\u52a1\u9009\u62e9multiprocessing.dummy\uff0cCPU \u5bc6\u96c6\u578b\u4efb\u52a1\u9009\u62e9multiprocessing","title":"5.6 \u79d2\uff01"}]}