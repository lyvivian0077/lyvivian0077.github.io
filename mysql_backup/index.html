
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../mysql-clone/">
      
      
        <link rel="next" href="../mydumper/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.9">
    
    
      
        <title>Mysql バックアップツール - 总有刁民想要害朕</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mysql" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="总有刁民想要害朕" class="md-header__button md-logo" aria-label="总有刁民想要害朕" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            总有刁民想要害朕
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mysql バックアップツール
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="总有刁民想要害朕" class="md-nav__button md-logo" aria-label="总有刁民想要害朕" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    总有刁民想要害朕
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          ansbile
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          ansbile
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ansbile/" class="md-nav__link">
        ansbileオプション
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ansbile_async/" class="md-nav__link">
        ansbile_async
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../awk/" class="md-nav__link">
        awk
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sed/" class="md-nav__link">
        sed
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fio/" class="md-nav__link">
        fio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../MB-MiB%E7%9A%84%E5%8C%BA%E5%88%AB/" class="md-nav__link">
        MB_MiB的区别
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          MegaRAID
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          MegaRAID
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../megacli/" class="md-nav__link">
        megacli
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../megaraid/" class="md-nav__link">
        megaraid
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          PostgreSQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          PostgreSQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../psql-vs-mysql/" class="md-nav__link">
        MySQLとPostgreSQLコマンド比較表
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../psql-conf/" class="md-nav__link">
        从零开始学PostgreSQL (二)： 配置文件
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          MySQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          MySQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-ssl/" class="md-nav__link">
        MySQL安全SSL介绍
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-common/" class="md-nav__link">
        MySQL数据库常用脚本
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Explain%E8%AF%A6%E8%A7%A3%E4%B8%8E%E7%B4%A2%E5%BC%95%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" class="md-nav__link">
        Explain详解与索引最佳实践
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../server-status-variables/" class="md-nav__link">
        Mysqlサーバーステータス変数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql/" class="md-nav__link">
        Mysql参数优化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../isolation/" class="md-nav__link">
        事务隔离级别
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../show-engine-innodb-status/" class="md-nav__link">
        innodb status解读
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../show-engine-innodb-status2/" class="md-nav__link">
        innodb status解读2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../undo-log/" class="md-nav__link">
        undo-log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../buffer-pool/" class="md-nav__link">
        Buffer-Pool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../my-cnf/" class="md-nav__link">
        mysql5.7性能提升一百倍调优宝典
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-table/" class="md-nav__link">
        MySQL-table
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql%E3%82%92%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%8B%E3%82%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/" class="md-nav__link">
        MySQLビルド
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-add-del-user/" class="md-nav__link">
        Mysqlユーザ作成削除
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-sysbench/" class="md-nav__link">
        Mysql sysbench
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-dummy/" class="md-nav__link">
        ダミーデータを作成
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-kill/" class="md-nav__link">
        mysqladmin kill
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../MySQL-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        学习笔记
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql8-basic/" class="md-nav__link">
        Mysql8
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_20" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9_20" id="__nav_9_20_label" tabindex="0">
          MGR
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_20_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9_20">
          <span class="md-nav__icon md-icon"></span>
          MGR
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-group-replication/" class="md-nav__link">
        3種類のMGR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-mgr/" class="md-nav__link">
        MGR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-group-replication-how-to-elect-the-new-primary-node/" class="md-nav__link">
        MGR 如何选举新的主节点
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-mgr-copy/" class="md-nav__link">
        転載MGR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-ha/" class="md-nav__link">
        mysql+keepalived搭建教程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-clone/" class="md-nav__link">
        mysqlクローン機能
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          MySQL DUMP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          MySQL DUMP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Mysql バックアップツール
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Mysql バックアップツール
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mysql_1" class="md-nav__link">
    MySQL备份工具
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    文件系统工具
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    第三组工具:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    他社のツール
  </a>
  
    <nav class="md-nav" aria-label="他社のツール">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xtrabackup" class="md-nav__link">
    下载XtraBackup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-xbstream" class="md-nav__link">
    远程完全备份(ssh,压缩) xbstream
  </a>
  
    <nav class="md-nav" aria-label="远程完全备份(ssh,压缩) xbstream">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    方法一(不采用)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    方法二(采用)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-tar" class="md-nav__link">
    远程完全备份(ssh,压缩) tar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-xbstream_1" class="md-nav__link">
    远程增量备份(ssh,压缩) xbstream
  </a>
  
    <nav class="md-nav" aria-label="远程增量备份(ssh,压缩) xbstream">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    方法一(不采用)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    方法二(采用)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-xbstream_2" class="md-nav__link">
    远程完全备份(ssh,未压缩) xbstream
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare" class="md-nav__link">
    "准备"(prepare)增量备份
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    例
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mydumper/" class="md-nav__link">
        mydumper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          Python Tips
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Python Tips
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-styleguide/" class="md-nav__link">
        Python风格规范
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-config/" class="md-nav__link">
        Python程序配置文件管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-decorator/" class="md-nav__link">
        装饰器
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-dunder/" class="md-nav__link">
        5种下划线
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-function/" class="md-nav__link">
        传入参数的几种方法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python/" class="md-nav__link">
        非常规的技巧
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-mysql/" class="md-nav__link">
        操作mysql基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python-Re-%E6%A8%A1%E5%9D%97%E8%B6%85%E5%85%A8%E8%A7%A3%E8%AF%BB/" class="md-nav__link">
        Re 模块
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Python%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E6%80%BB%E7%BB%93/" class="md-nav__link">
        字符串拼接总结
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%B8%80%E8%A1%8C-Python-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C/" class="md-nav__link">
        代码并行
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../py-pip/" class="md-nav__link">
        使用 Python Pip 的 10 个技巧
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Regular-Expression/" class="md-nav__link">
        正規表現
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../taged-VLAN%E3%81%A8untagedVLAN%E3%81%AE%E9%81%95%E3%81%84/" class="md-nav__link">
        タグVLAN
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sar/" class="md-nav__link">
        sar
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Bash%E7%BC%96%E7%A8%8B%E8%B6%85%E8%AF%A6%E7%BB%86%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/" class="md-nav__link">
        Bash编程超详细语法总结
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
          iptables
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          iptables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables/" class="md-nav__link">
        iptables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_1/" class="md-nav__link">
        iptables概念(1)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_2/" class="md-nav__link">
        iptables实际操作之规则查询(2)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_3/" class="md-nav__link">
        iptables规则管理(3)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_4/" class="md-nav__link">
        iptables匹配条件总结之一(4)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_5/" class="md-nav__link">
        iptables匹配条件总结之二（常用扩展模块）(5)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_6/" class="md-nav__link">
        iptables扩展匹配条件之’–tcp-flags’(6)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_7/" class="md-nav__link">
        iptables扩展之udp扩展与icmp扩展(7)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_8/" class="md-nav__link">
        iptables扩展模块之state扩展(8)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_9/" class="md-nav__link">
        iptables的黑白名单机制(9)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_10/" class="md-nav__link">
        iptables自定义链(10)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_11/" class="md-nav__link">
        iptables之网络防火墙(11)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_12/" class="md-nav__link">
        iptables动作总结之一(12)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_13/" class="md-nav__link">
        iptables动作总结之二(13)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iptables_14/" class="md-nav__link">
        iptables小结之常用套路(14)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
          virt
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_17">
          <span class="md-nav__icon md-icon"></span>
          virt
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../virt-migrate/" class="md-nav__link">
        KVM迁移
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_18" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_18" id="__nav_18_label" tabindex="0">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_18_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_18">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../centos7-set-kernel/" class="md-nav__link">
        centos7-set-kernel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../centos-network-device-naming/" class="md-nav__link">
        centos-network-device-naming
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Linux-Performance/" class="md-nav__link">
        Linux Performance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Linux-shell-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6-%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%A6%E8%A7%A3/" class="md-nav__link">
        Linux-shell-逻辑运算符-逻辑表达式详解
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../busybox/" class="md-nav__link">
        busybox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linux-img/" class="md-nav__link">
        rocky img 作成
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../osinfo-query/" class="md-nav__link">
        osinfo-query更新
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_19" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_19" id="__nav_19_label" tabindex="0">
          LVM
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_19_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_19">
          <span class="md-nav__icon md-icon"></span>
          LVM
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LVM%E9%80%BB%E8%BE%91%E5%8D%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%8F%8ALVM%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86/" class="md-nav__link">
        LVM逻辑卷基本概念及LVM的工作原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../linux-lvm/" class="md-nav__link">
        LVM逻辑卷的建立、扩容和减容
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lvm-snapshot/" class="md-nav__link">
        LVM-snapshot
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../macOS%E8%BD%AF%E4%BB%B6%E7%BC%96%E8%AF%91%E6%97%B6%E6%89%BE%E4%B8%8D%E5%88%B0%E5%A4%B4%E6%96%87%E4%BB%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-%E6%9B%B4%E6%96%B010-15/" class="md-nav__link">
        macOS软件编译时找不到头文件解决方法[更新10.15]
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ubnt/" class="md-nav__link">
        ubnt
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../vim/" class="md-nav__link">
        VIM
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../teslak20c/" class="md-nav__link">
        Tesla K20c をゲーム用に改造してみた
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../terminal-shortcut/" class="md-nav__link">
        ターミナルを使うためのショートカット集
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_25" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_25" id="__nav_25_label" tabindex="0">
          Zabbix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_25_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_25">
          <span class="md-nav__icon md-icon"></span>
          Zabbix
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../zabbix6/" class="md-nav__link">
        zabbix6検証
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_26" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_26" id="__nav_26_label" tabindex="0">
          SWAP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_26_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_26">
          <span class="md-nav__icon md-icon"></span>
          SWAP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../swap-find/" class="md-nav__link">
        Swapを使ってるプロセスを探す
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../swap-schema/" class="md-nav__link">
        Swap原理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../swap-linux/" class="md-nav__link">
        Linux内存回收与swap
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../pfctl/" class="md-nav__link">
        pfctlのコマンドを毎回忘れるのでメモ
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_28" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_28" id="__nav_28_label" tabindex="0">
          Prometheus
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_28_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_28">
          <span class="md-nav__icon md-icon"></span>
          Prometheus
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prometheus/" class="md-nav__link">
        prometheus構築
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mysqld_exporter_flags/" class="md-nav__link">
        mysqld_exporterコレクタFlags
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mysql_1" class="md-nav__link">
    MySQL备份工具
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    文件系统工具
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    第三组工具:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    他社のツール
  </a>
  
    <nav class="md-nav" aria-label="他社のツール">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xtrabackup" class="md-nav__link">
    下载XtraBackup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-xbstream" class="md-nav__link">
    远程完全备份(ssh,压缩) xbstream
  </a>
  
    <nav class="md-nav" aria-label="远程完全备份(ssh,压缩) xbstream">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    方法一(不采用)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    方法二(采用)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-tar" class="md-nav__link">
    远程完全备份(ssh,压缩) tar
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-xbstream_1" class="md-nav__link">
    远程增量备份(ssh,压缩) xbstream
  </a>
  
    <nav class="md-nav" aria-label="远程增量备份(ssh,压缩) xbstream">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    方法一(不采用)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    方法二(采用)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-xbstream_2" class="md-nav__link">
    远程完全备份(ssh,未压缩) xbstream
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare" class="md-nav__link">
    "准备"(prepare)增量备份
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    例
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="mysql">MySQL备份类型<a class="headerlink" href="#mysql" title="Permanent link">&para;</a></h1>
<ul>
<li>
<p>热备份,文备份和冷备份</p>
<ul>
<li>热备份: 读,写不受影响</li>
<li>温备份:仅可以执行度读操作</li>
<li>冷备份:离线备份,读写操作终止</li>
</ul>
</li>
<li>
<p>物理备份和逻辑备份</p>
<ul>
<li>物理备份: 复制数据文件</li>
<li>逻辑备份: 将数据导出至文本文件中.</li>
</ul>
</li>
</ul>
<h3 id="mysql_1">MySQL备份工具<a class="headerlink" href="#mysql_1" title="Permanent link">&para;</a></h3>
<ul>
<li>mysqldump: 逻辑备份工具, MyISAM(温), InnoDB(热备份)</li>
<li>mysqlshotcopy: 文件备份工具(锁表),温备份,实际是冷备份</li>
</ul>
<h3 id="_1">文件系统工具<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<ul>
<li>cp: 冷备份</li>
<li>LV: 逻辑卷的快照功能,几乎热备<ul>
<li>mysql&gt; FLUSH TABLES;</li>
<li>mysql&gt; LOCK TABLES;</li>
<li>创建快照: 释放锁,而后复制数据</li>
</ul>
</li>
</ul>
<h3 id="_2">第三组工具:<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<ul>
<li>ibbackup:商业工具</li>
<li>xtrabackup: 开源工具</li>
<li>https://www.processon.com/mindmap/61b2bbc863768956b5f5c7da</li>
</ul>
<h3 id="_3">他社のツール<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<ul>
<li>https://main.qcloudimg.com/raw/document/intl/product/pdf/236_19886_jp.pdf</li>
<li>https://intl.cloud.tencent.com/jp/document/product/236/31910</li>
<li>https://intl.cloud.tencent.com/jp/document/product/236/31910</li>
</ul>
<h5 id="xtrabackup">下载XtraBackup<a class="headerlink" href="#xtrabackup" title="Permanent link">&para;</a></h5>
<ul>
<li>https://www.percona.com/doc/percona-xtrabackup/2.4/installation.html#installing-percona-xtrabackup-from-a-binary-tarball</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>$ wget https://downloads.percona.com/downloads/Percona-XtraBackup-2.4/Percona-XtraBackup-2.4.21/binary/tarball/percona-xtrabackup-2.4.21-Linux-x86_64.glibc2.12.tar.gz
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>$ tar xvf percona-xtrabackup-2.4.21-Linux-x86_64.glibc2.12.tar.gz
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>$ ln -sv /root/work/percona-xtrabackup-2.4.21-Linux-x86_64.glibc2.12 /usr/local/percona-xtrabackup
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a># 安装必要工具
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a># yum install -y https://repo.percona.com/yum/percona-release-latest.noarch.rpm
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a># yum install qpress perl-Digest-MD5 &quot;perl(DBD::mysql)&quot; -y
</span></code></pre></div>
<h3 id="ssh-xbstream">远程完全备份(ssh,压缩) xbstream<a class="headerlink" href="#ssh-xbstream" title="Permanent link">&para;</a></h3>
<h4 id="_4">方法一(不采用)<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<ul>
<li>直接保存在backup服务器上</li>
<li>无法记录to_lsn
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a># [root@test ]# ssh mysql5.7 &quot;/usr/bin/xtrabackup --backup --stream=xbstream --compress --compress-thread=8 --parallel=8 --target-dir=/home/backup/test/&quot; &gt; full-mysql5.7-20211125.xbstream
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>- 1.4G Nov 25 15:07 full-mysql5.7-20211125.xbstream &lt;- 打包压缩后为1.4G
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>- 拆包xbstream
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>- # ./bin/xbstream -x &lt; full-mysql5.7-20211125 -C ./test/
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>- # 1.4G   ./test     &lt;- 拆包后为1.4G,容量不会变大,因为仅仅是拆包.
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>- 解压拆包后的文件夹 (可使用 --remove-original 来删除压缩的源文件)
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>- # ./bin/xtrabackup --decompress --parallel=8 --target-dir=./test/
</span></code></pre></div></li>
</ul>
<h4 id="_5">方法二(采用)<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<ul>
<li>在被备份服务器上创建DB,记录完全备份时的to_lsn</li>
<li>--history=NAME</li>
<li>在被备份服务器上新建数据库 (PERCONA_SCHEMA), 后在该数据库内建立表(xtrabackup_history),该表内记录了完全备份时的详细信息.</li>
<li>https://www.percona.com/doc/percona-xtrabackup/2.4/innobackupex/innobackupex_option_reference.html#cmdoption-innobackupex-no-lock</li>
<li>
<p>--no-lock 备份时不锁表</p>
<ul>
<li>由于mysql318等大型服务器,备份时的锁表时间过长会影响user的连接体验[锁表为大约6分钟],所以为了提高效率及用户体验,决定不锁表</li>
<li>MyISAM由于不是InnoDB,无论如何都会锁表
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>使用此选项可通过 FLUSH TABLES WITH READ LOCK 禁用表锁定。仅当您的所有表都是 InnoDB 并且您不关心备份的二进制日志位置时才使用它。如果有任何 DDL 语句正在执行或在非 InnoDB 表（这包括 mysql 数据库中的系统 MyISAM 表）上发生任何更新，则不应使用此选项，否则可能导致不一致的备份。在支持（Percona Server 5.6+）的情况下，xtrabackup 将自动使用备份锁作为 FLUSH TABLES WITH READ LOCK 的轻量级替代方案来复制非 InnoDB 数据，以避免阻塞修改 InnoDB 表的 DML 查询。如果您正在考虑使用 innobackupex --no-lock 因为您的备份无法获取锁，这可能是因为传入的复制事件阻止了锁成功。请尝试使用 innobackupex --safe-slave-backup 暂时停止复制副本线程，这可能有助于备份成功，然后您无需求助于使用此选项。使用 –no-lock 选项时不会创建 xtrabackup_binlog_info（因为 SHOW MASTER STATUS 可能不一致），但在某些情况下，可以使用 xtrabackup_binlog_pos_innodb 来获得一致的 binlog 坐标，如使用二进制日志中所述。
</span></code></pre></div></li>
<li>
<p>--no-lock
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Use this option to disable table lock with FLUSH TABLES WITH READ LOCK. Use it only if ALL your tables are InnoDB and you DO NOT CARE about the binary log position of the backup. This option shouldn’t be used if there are any DDL statements being executed or if any updates are happening on non-InnoDB tables (this includes the system MyISAM tables in the mysql database), otherwise it could lead to an inconsistent backup. Where supported (Percona Server 5.6+) xtrabackup will automatically use Backup Locks as a lightweight alternative to FLUSH TABLES WITH READ LOCK to copy non-InnoDB data to avoid blocking DML queries that modify InnoDB tables. If you are considering to use innobackupex --no-lock because your backups are failing to acquire the lock, this could be because of incoming replication events preventing the lock from succeeding. Please try using innobackupex --safe-slave-backup to momentarily stop the replication replica thread, this may help the backup to succeed and you then don’t need to resort to using this option. xtrabackup_binlog_info is not created when –no-lock option is used (because SHOW MASTER STATUS may be inconsistent), but under certain conditions xtrabackup_binlog_pos_innodb can be used instead to get consistent binlog coordinates as described in Working with Binary Logs.
</span></code></pre></div></p>
</li>
<li>
<details class="note">
<summary>例</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># [root@test]# ssh mysql5.7 &quot;/usr/bin/xtrabackup --backup --no-lock --history=testhis --stream=xbstream --compress --compress-thread=8 --parallel=8 --target-dir=/home/backup/test/&quot;  &gt; full-mysql5.7-compress-`date +%F`.xbstream</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span>-<span class="w"> </span>--history<span class="o">=</span>testhis
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span>-<span class="w"> </span>--no-lock<span class="w"> </span><span class="o">(</span>由于mysql5.7_test等大型服务器,备份时的锁表时间过长会影响user的连接体验<span class="o">[</span>锁表为大约6分钟<span class="o">]</span>,所以为了提高效率及用户体验,决定不锁表<span class="o">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span>-<span class="w"> </span>MyISAM由于不是InnoDB,无论如何都会锁表
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span>-<span class="w"> </span>在被备份服务器上新建数据库<span class="w"> </span><span class="o">(</span>PERCONA_SCHEMA<span class="o">)</span>,<span class="w"> </span>后在该数据库内建立表<span class="o">(</span>xtrabackup_history<span class="o">)</span>,该表内记录了完全备份时的详细信息.
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span><span class="o">=====================================================================</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">      </span><span class="m">01</span>:40:32<span class="w"> </span>root@localhost<span class="o">[</span>PERCONA_SCHEMA<span class="o">]</span>&gt;<span class="w"> </span><span class="k">select</span><span class="w"> </span>*<span class="w"> </span>from<span class="w"> </span>xtrabackup_history<span class="se">\G</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span>***************************<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>row<span class="w"> </span>***************************
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">                </span>uuid:<span class="w"> </span>d7dce218-50c1-11ec-96c6-9ca3ba306e71
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">                </span>name:<span class="w"> </span>testhis<span class="w">         </span>&lt;--<span class="w"> </span>此项为--history<span class="o">=</span>的名字
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">           </span>tool_name:<span class="w"> </span>xtrabackup
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">        </span>tool_command:<span class="w"> </span>--backup<span class="w"> </span>--history<span class="o">=</span>testhis<span class="w"> </span>--stream<span class="o">=</span>xbstream<span class="w"> </span>--compress<span class="w"> </span>--compress-thread<span class="o">=</span><span class="m">8</span><span class="w"> </span>--parallel<span class="o">=</span><span class="m">8</span><span class="w"> </span>--target-dir<span class="o">=</span>/home/backup/test/
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">        </span>tool_version:<span class="w"> </span><span class="m">2</span>.4.18
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span>ibbackup_version:<span class="w"> </span><span class="m">2</span>.4.18
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">      </span>server_version:<span class="w"> </span><span class="m">5</span>.7.28-log
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">          </span>start_time:<span class="w"> </span><span class="m">2021</span>-11-29<span class="w"> </span><span class="m">12</span>:09:24
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">            </span>end_time:<span class="w"> </span><span class="m">2021</span>-11-29<span class="w"> </span><span class="m">12</span>:10:02
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">           </span>lock_time:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="w">          </span>binlog_pos:<span class="w"> </span>NULL
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="w">     </span>innodb_from_lsn:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="w">       </span>innodb_to_lsn:<span class="w"> </span><span class="m">632730709693</span><span class="w">   </span>&lt;-------<span class="w"> </span>此项为完全备份时的to_lsn
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="w">             </span>partial:<span class="w"> </span>N
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="w">         </span>incremental:<span class="w"> </span>N
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="w">              </span>format:<span class="w"> </span>xbstream
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="w">             </span>compact:<span class="w"> </span>N
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="w">          </span>compressed:<span class="w"> </span>Y
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="w">           </span>encrypted:<span class="w"> </span>N
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="w">    </span><span class="m">1</span><span class="w"> </span>row<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.00<span class="w"> </span>sec<span class="o">)</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a><span class="w">    </span><span class="m">01</span>:40:39<span class="w"> </span>root@localhost<span class="o">[</span>PERCONA_SCHEMA<span class="o">]</span>&gt;<span class="w"> </span>show<span class="w"> </span>tables<span class="p">;</span>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="o">=====================================================================</span>
</span></code></pre></div>
</details>
</li>
</ul>
</li>
</ul>
<h3 id="ssh-tar">远程完全备份(ssh,压缩) tar<a class="headerlink" href="#ssh-tar" title="Permanent link">&para;</a></h3>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># [root@test]# ssh mysql5.7 &quot;/usr/bin/xtrabackup --backup --stream=tar --parallel=8 --target-dir=/home/backup/test/&quot; | gzip - &gt; full-mysql5.7-20211126.tar.gz</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span>-<span class="w"> </span><span class="m">1</span>.1G<span class="w"> </span>Nov<span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">11</span>:00<span class="w"> </span>full-mysql5.7-20211126.tar.gz<span class="w">   </span>&lt;-<span class="w"> </span>打包压缩后为1.1G
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span>-<span class="w"> </span>解压缩
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span>-<span class="w"> </span><span class="c1"># tar xf full-mysql5.7-20211126.tar.gz -C test-tar/</span>
</span></code></pre></div>
<h3 id="ssh-xbstream_1">远程增量备份(ssh,压缩) xbstream<a class="headerlink" href="#ssh-xbstream_1" title="Permanent link">&para;</a></h3>
<ul>
<li>增量备份仅能应用于InnoDB或XtraDB表.</li>
<li>对于MyISAM表而言,执行增量备份其实进行的是完全备份</li>
</ul>
<h4 id="_6">方法一(不采用)<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<ul>
<li>
<details class="note">
<summary>例</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># [root@test inc1]# ssh mysql5.7 &quot;/usr/bin/xtrabackup --backup --stream=xbstream --compress --compress-thread=8 --parallel=8  --target-dir=/home/backup/test/ --incremental-lsn=626713424502&quot; &gt; inc1/inc1-mysql5.7-20211125.xbstream</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">  </span>-<span class="w"> </span>取得to_lsn的方法1
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span>-<span class="w"> </span>通过上面的拆包后的目录里的xtrabackup_checkpoints文件取得to_lsn的值.<span class="w"> </span><span class="nv">to_lsn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">626713424502</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">  </span>-<span class="w"> </span>将to_lsn的值带入--incremental-lsn里,就是得到从上次的完全备份开始进行增量备份的起始点.
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span>-<span class="w"> </span>最终得到增量备份.
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>-<span class="w"> </span>增量备份拆包解压
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">  </span>-<span class="w"> </span>拆包
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span><span class="c1"># ../bin/xbstream -x &lt; inc1-mysql5.7-20211125.xbstream  -C ./</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">  </span>-<span class="w"> </span>解压
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">    </span><span class="c1"># ../bin/xtrabackup --decompress --remove-original --target-dir=./</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">  </span>-<span class="w"> </span>确认
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">    </span><span class="c1"># cat xtrabackup_checkpoints</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">          </span><span class="nv">backup_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>incremental<span class="w">  </span>&lt;--<span class="w"> </span>增量备份
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">          </span><span class="nv">from_lsn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">626713424502</span><span class="w">    </span>&lt;--<span class="w"> </span>备份起始点
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w">          </span><span class="nv">to_lsn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">627081604734</span><span class="w">      </span>&lt;--<span class="w"> </span>备份结束点
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">          </span><span class="nv">last_lsn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">627081604743</span><span class="w">    </span>&lt;--<span class="w"> </span>DB的最后节点
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">          </span><span class="nv">compact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">          </span><span class="nv">recover_binlog_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">          </span><span class="nv">flushed_lsn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">627081604743</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">  </span>-<span class="w"> </span>取得to_lsn的方法2
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">    </span>-<span class="w"> </span>远程完全备份<span class="o">(</span>ssh,压缩<span class="o">)</span><span class="w"> </span>xbstream,<span class="w"> </span>远程完全备份<span class="o">(</span>ssh,压缩<span class="o">)</span><span class="w"> </span>tar,<span class="w"> </span>时,stdout的log最终行显示了to_lsn的信息.
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">    </span>-<span class="w"> </span><span class="o">[</span>xtrabackup:<span class="w"> </span>Transaction<span class="w"> </span>log<span class="w"> </span>of<span class="w"> </span>lsn<span class="w"> </span><span class="o">(</span><span class="m">632523322653</span><span class="o">)</span><span class="w"> </span>to<span class="w"> </span><span class="o">(</span><span class="m">632524719449</span><span class="o">)</span><span class="w"> </span>was<span class="w"> </span>copied.<span class="o">]</span><span class="w"> </span>的<span class="w"> </span>to<span class="w"> </span><span class="o">(</span><span class="m">632524719449</span><span class="o">)</span><span class="w"> </span>就是此次备份时的最终lsn点
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="w">    </span>-<span class="w"> </span>此方法需要保存标准输出,后查询最后输出值,很不方便.<span class="o">(</span>不采用<span class="o">)</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:38<span class="w"> </span><span class="o">[</span><span class="m">01</span><span class="o">]</span><span class="w"> </span>Streaming<span class="w"> </span>./mysql/event.MYD<span class="w"> </span>to<span class="w"> </span>&lt;STDOUT&gt;
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:38<span class="w"> </span><span class="o">[</span><span class="m">01</span><span class="o">]</span><span class="w">        </span>...done
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:38<span class="w"> </span>Finished<span class="w"> </span>backing<span class="w"> </span>up<span class="w"> </span>non-InnoDB<span class="w"> </span>tables<span class="w"> </span>and<span class="w"> </span>files
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:38<span class="w"> </span>Executing<span class="w"> </span>FLUSH<span class="w"> </span>NO_WRITE_TO_BINLOG<span class="w"> </span>ENGINE<span class="w"> </span>LOGS...
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="w">    </span>xtrabackup:<span class="w"> </span>The<span class="w"> </span>latest<span class="w"> </span>check<span class="w"> </span>point<span class="w"> </span><span class="o">(</span><span class="k">for</span><span class="w"> </span>incremental<span class="o">)</span>:<span class="w"> </span><span class="s1">&#39;632524361908&#39;</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="w">    </span>xtrabackup:<span class="w"> </span>Stopping<span class="w"> </span>log<span class="w"> </span>copying<span class="w"> </span>thread.
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="w">    </span>.211129<span class="w"> </span><span class="m">11</span>:36:38<span class="w"> </span>&gt;&gt;<span class="w"> </span>log<span class="w"> </span>scanned<span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span><span class="o">(</span><span class="m">632524719449</span><span class="o">)</span>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:38<span class="w"> </span>Executing<span class="w"> </span>UNLOCK<span class="w"> </span>TABLES
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:38<span class="w"> </span>All<span class="w"> </span>tables<span class="w"> </span>unlocked
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:38<span class="w"> </span><span class="o">[</span><span class="m">00</span><span class="o">]</span><span class="w"> </span>Streaming<span class="w"> </span>ib_buffer_pool<span class="w"> </span>to<span class="w"> </span>&lt;STDOUT&gt;
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:39<span class="w"> </span><span class="o">[</span><span class="m">00</span><span class="o">]</span><span class="w">        </span>...done
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:39<span class="w"> </span>Backup<span class="w"> </span>created<span class="w"> </span><span class="k">in</span><span class="w"> </span>directory<span class="w"> </span><span class="s1">&#39;/home/backup/test/&#39;</span>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:39<span class="w"> </span><span class="o">[</span><span class="m">00</span><span class="o">]</span><span class="w"> </span>Streaming<span class="w"> </span>&lt;STDOUT&gt;
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:39<span class="w"> </span><span class="o">[</span><span class="m">00</span><span class="o">]</span><span class="w">        </span>...done
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:39<span class="w"> </span><span class="o">[</span><span class="m">00</span><span class="o">]</span><span class="w"> </span>Streaming<span class="w"> </span>&lt;STDOUT&gt;
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:39<span class="w"> </span><span class="o">[</span><span class="m">00</span><span class="o">]</span><span class="w">        </span>...done
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a><span class="w">    </span>xtrabackup:<span class="w"> </span>Transaction<span class="w"> </span>log<span class="w"> </span>of<span class="w"> </span>lsn<span class="w"> </span><span class="o">(</span><span class="m">632523322653</span><span class="o">)</span><span class="w"> </span>to<span class="w"> </span><span class="o">(</span><span class="m">632524719449</span><span class="o">)</span><span class="w"> </span>was<span class="w"> </span>copied.<span class="w">     </span>&lt;---<span class="w"> </span><span class="o">{</span>to<span class="w"> </span><span class="o">(</span><span class="m">632524719449</span><span class="o">)}</span>的数据就是to_lsn点
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a><span class="w">    </span><span class="m">211129</span><span class="w"> </span><span class="m">11</span>:36:39<span class="w"> </span>completed<span class="w"> </span>OK!
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a><span class="w">    </span><span class="o">[</span>root@test<span class="w"> </span><span class="o">]</span><span class="c1">#</span>
</span></code></pre></div></details>
</li>
</ul>
<h4 id="_7">方法二(采用)<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<ul>
<li>此方法通过被备份服务器上的DB数据库PERCONA_SCHEMA,表xtrabackup_history 来获取上次完全备份时的to_lsn点.</li>
<li>不需要额外配置选项,而且DB上有上次备份的详细信息,可供之后的故障查询.非常方便.</li>
<li>增量备份时只需增加选项<ul>
<li>--incremental-history-name=NAME(testhis) 此name为完全备份时设定的NAME</li>
<li>--history=NAME(testhis) 此name为完全备份时设定的NAME</li>
</ul>
</li>
<li>增量备份时,只需增加这两项,XtraBackup会自动识别最新的备份点,之后进行增量备份
<div class="language-shell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># [root@test ]# ssh mysql5.7 &quot;/usr/bin/xtrabackup --backup --no-lock --history=testhis --stream=xbstream --compress --compress-thread=8 --parallel=8  --target-dir=/home/backup/test/ --incremental-history-name=testhis&quot;  &gt; inc1/inc1-mysql5.7-`date +%F`.xbstream</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">  </span>-<span class="w"> </span>增量备份时只需增加选项
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span>-<span class="w"> </span>--incremental-history-name<span class="o">=</span>NAME<span class="o">(</span>testhis<span class="o">)</span><span class="w"> </span>此name为完全备份时设定的NAME
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">      </span>-<span class="w"> </span>https://www.percona.com/doc/percona-xtrabackup/2.4/innobackupex/innobackupex_option_reference.html#cmdoption-innobackupex-incremental-history-name
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span>-<span class="w"> </span>--history<span class="o">=</span>NAME<span class="o">(</span>testhis<span class="o">)</span><span class="w"> </span>此name为完全备份时设定的NAME
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">      </span>-<span class="w"> </span>https://www.percona.com/doc/percona-xtrabackup/2.4/innobackupex/innobackupex_option_reference.html#cmdoption-innobackupex-history
</span></code></pre></div></li>
</ul>
<h3 id="ssh-xbstream_2">远程完全备份(ssh,未压缩) xbstream<a class="headerlink" href="#ssh-xbstream_2" title="Permanent link">&para;</a></h3>
<ul>
<li>远程完全备份(ssh,未压缩) xbstream
<div class="language-shell highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># [root@test]# ssh mysql5.7 &quot;/usr/bin/xtrabackup --backup --stream=xbstream --parallel=8 --target-dir=/home/backup/test/&quot; &gt; full-mysql5.7.xbstream</span>
</span></code></pre></div></li>
</ul>
<h3 id="prepare">"准备"(prepare)增量备份<a class="headerlink" href="#prepare" title="Permanent link">&para;</a></h3>
<ul>
<li>需要在每个备份(包含完全备份和各个增量备份)上,将已经提交的事务进行"重放"."重放"之后,所有的备份数据将合并到完全备份上.</li>
<li>基于所有的备份将未提交的事务进行"回滚".</li>
<li>Preparing an Incremental Backup with innobackupex</li>
<li>BASE-DIR 为完全备份所在的目录.</li>
<li>INCREMENTAL-DIR-1 为第一次增量备份的目录</li>
<li>INCREMENTAL-DIR-2 为第二次增量备份的目录</li>
<li>
<details class="note">
<summary>例</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>如何为打包压缩文件,需先拆包,后解压.
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span>-<span class="w"> </span>拆包xbstream
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">  </span>-<span class="w"> </span><span class="c1"># ./bin/xbstream -x &lt; full-mysql5.7-20211125 -C ./test/</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">  </span>-<span class="w"> </span><span class="c1"># 1.4G    ./test      &lt;- 拆包后为1.4G,容量不会变大,因为仅仅是拆包.</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">  </span>-<span class="w"> </span>解压拆包后的文件夹<span class="w"> </span><span class="o">(</span>可使用<span class="w"> </span>--remove-original<span class="w"> </span>来删除压缩的源文件<span class="o">)</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">  </span>-<span class="w"> </span><span class="c1"># ./bin/xtrabackup --decompress  --parallel=8 --target-dir=./test/</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">  </span>-<span class="w"> </span>拆包完全备份
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span><span class="c1"># mkdir full-mysql5.7</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">    </span><span class="c1"># ../bin/xbstream -x &lt; full-mysql5.7-compress-2021-11-30.xbstream  -C ./full-mysql5.7</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">  </span>-<span class="w"> </span>解压拆包后的完全备份<span class="w"> </span><span class="o">(</span>可使用<span class="w"> </span>--remove-original<span class="w"> </span>来删除压缩的源文件<span class="o">)</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">    </span><span class="c1"># ../bin/xtrabackup --decompress --remove-original --target-dir=./full-mysql5.7</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">  </span>-<span class="w"> </span>确认
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">  </span>-<span class="w"> </span>拆包增量备份
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">    </span><span class="c1"># [root@test inc1]# mkdir inc1-mysql5.7-2021-11-30</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">    </span><span class="c1"># [root@test inc1]# mkdir inc1-mysql5.7-2021-12-01</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">    </span><span class="c1"># [root@test inc1]# xbstream -x &lt; inc1-mysql5.7-2021-11-30.xbstream -C ./inc1-mysql5.7-2021-11-30</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w">    </span><span class="c1"># [root@test inc1]# xbstream -x &lt; inc1-mysql5.7-2021-12-01.xbstream -C ./inc1-mysql5.7-2021-12-01</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">    </span><span class="c1"># [root@test inc1]# xbstream -x &lt; inc1-mysql5.7-2021-12-02.xbstream -C ./inc1-mysql5.7-2021-12-02</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">  </span>-<span class="w"> </span>解压拆包后的增量备份
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">    </span><span class="c1"># [root@test inc1]# xtrabackup --decompress --remove-original --target-dir=./inc1-mysql5.7-2021-11-30</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="w">    </span><span class="c1"># [root@test inc1]# xtrabackup --decompress --remove-original --target-dir=./inc1-mysql5.7-2021-12-01</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="w">    </span><span class="c1"># [root@test inc1]# xtrabackup --decompress --remove-original --target-dir=./inc1-mysql5.7-2021-12-02</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="m">1</span>,<span class="w"> </span>准备完全备份
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="c1"># innobackupex --apply-log --redo-only BASE-DIR</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="m">2</span>,<span class="w"> </span>执行第一次的增量备份
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="c1"># innobackupex --apply-log --redo-only BASE-DIR --incremental-dir=INCREMENTAL-DIR-1</span>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="m">3</span>,<span class="w"> </span>执行第二次的增量备份
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="c1"># innobackupex --apply-log --redo-only BASE-DIR --incremental-dir=INCREMENTAL-DIR-2</span>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a>
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a>依次类推.
</span></code></pre></div></details>
</li>
</ul>
<h2 id="_8">例<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<ul>
<li>
<details class="note">
<summary>例</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># 第一次完全备份</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>-<span class="w"> </span>--rsync
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">  </span>-<span class="w"> </span>https://www.percona.com/doc/percona-xtrabackup/8.0/xtrabackup_bin/backup.accelerating.html
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c1"># ssh mysql5.7 &quot;/usr/bin/xtrabackup --backup --no-lock --history=full_bk --stream=xbstream --compress --compress-thread=8 --parallel=8 --target-dir=/home/backup/&quot;  &gt; full-mysql5.7-compress-`date +%F`.xbstream</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c1"># 第一次增量备份</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="c1"># ssh mysql5.7 &quot;/usr/bin/xtrabackup --backup --no-lock --history=inc_bk --stream=xbstream --compress --compress-thread=8 --parallel=8 --target-dir=/home/backup/ --incremental-history-name=full_bk&quot;  &gt; inc1/inc1-mysql5.7-`date +%F-%H-%M`.xbstream</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="c1"># MySQL的数据库PERCONA_SCHEMA上的备份履历</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="m">04</span>:10:02<span class="w"> </span>root@localhost<span class="o">[</span>PERCONA_SCHEMA<span class="o">]</span>&gt;<span class="w"> </span><span class="k">select</span><span class="w"> </span>name,innodb_from_lsn,innodb_to_lsn,start_time<span class="w"> </span>from<span class="w"> </span>xtrabackup_history<span class="w"> </span>where<span class="w"> </span>start_time<span class="w"> </span>like<span class="w"> </span><span class="s1">&#39;2021-12%&#39;</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>+----------+-----------------+---------------+---------------------+
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="p">|</span><span class="w"> </span>name<span class="w">     </span><span class="p">|</span><span class="w"> </span>innodb_from_lsn<span class="w"> </span><span class="p">|</span><span class="w"> </span>innodb_to_lsn<span class="w"> </span><span class="p">|</span><span class="w"> </span>start_time<span class="w">          </span><span class="p">|</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>+----------+-----------------+---------------+---------------------+
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="p">|</span><span class="w"> </span>inc_bk<span class="w">   </span><span class="p">|</span><span class="w">    </span><span class="m">639056296812</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">639056301332</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-03<span class="w"> </span><span class="m">16</span>:09:45<span class="w"> </span><span class="p">|</span><span class="w">  </span>&lt;--<span class="w"> </span>增量备份<span class="o">(</span>from_lsn为完全备份的to_lsn值<span class="o">)</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="p">|</span><span class="w"> </span>testhis<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">635749601741</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">637257897756</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-02<span class="w"> </span><span class="m">14</span>:45:36<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="p">|</span><span class="w"> </span>testhis<span class="w">  </span><span class="p">|</span><span class="w">    </span><span class="m">634038213077</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">635749601741</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-01<span class="w"> </span><span class="m">14</span>:32:58<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="p">|</span><span class="w"> </span>mysql_bk<span class="w"> </span><span class="p">|</span><span class="w">    </span><span class="m">639056292808</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">639056295402</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-03<span class="w"> </span><span class="m">16</span>:03:47<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="p">|</span><span class="w"> </span>mysql_bk<span class="w"> </span><span class="p">|</span><span class="w">               </span><span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">639056292808</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-03<span class="w"> </span><span class="m">15</span>:57:34<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="p">|</span><span class="w"> </span>full_bk<span class="w">  </span><span class="p">|</span><span class="w">               </span><span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="m">639056296812</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-03<span class="w"> </span><span class="m">16</span>:07:30<span class="w"> </span><span class="p">|</span><span class="w">  </span>&lt;--<span class="w"> </span>完全备份<span class="o">(</span>from_lsn为0<span class="o">)</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>+----------+-----------------+---------------+---------------------+
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="m">6</span><span class="w"> </span>rows<span class="w"> </span><span class="k">in</span><span class="w"> </span>set,<span class="w"> </span><span class="m">1</span><span class="w"> </span>warning<span class="w"> </span><span class="o">(</span><span class="m">0</span>.00<span class="w"> </span>sec<span class="o">)</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="m">04</span>:10:23<span class="w"> </span>root@localhost<span class="o">[</span>PERCONA_SCHEMA<span class="o">]</span>&gt;
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="m">10</span>:23:24<span class="w"> </span>root@localhost<span class="o">[</span>PERCONA_SCHEMA<span class="o">]</span>&gt;<span class="w"> </span><span class="k">select</span><span class="w"> </span>name,innodb_from_lsn,innodb_to_lsn,start_time<span class="w"> </span>from<span class="w"> </span>xtrabackup_history<span class="w">  </span>order<span class="w"> </span>by<span class="w"> </span>start_time<span class="p">;</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>+---------+-----------------+---------------+---------------------+
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="p">|</span><span class="w"> </span>name<span class="w">    </span><span class="p">|</span><span class="w"> </span>innodb_from_lsn<span class="w"> </span><span class="p">|</span><span class="w"> </span>innodb_to_lsn<span class="w"> </span><span class="p">|</span><span class="w"> </span>start_time<span class="w">          </span><span class="p">|</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>+---------+-----------------+---------------+---------------------+
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="p">|</span><span class="w"> </span>full_bk<span class="w"> </span><span class="p">|</span><span class="w">               </span><span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">64701439242</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-13<span class="w"> </span><span class="m">15</span>:32:32<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="p">|</span><span class="w"> </span>inc_bk<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">64701439242</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">64701499648</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-14<span class="w"> </span><span class="m">08</span>:30:07<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="p">|</span><span class="w"> </span>inc_bk<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">64701439242</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">64701562443</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-15<span class="w"> </span><span class="m">08</span>:30:02<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="p">|</span><span class="w"> </span>inc_bk<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">64701439242</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">64701624918</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-16<span class="w"> </span><span class="m">08</span>:30:09<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="p">|</span><span class="w"> </span>inc_bk<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">64701439242</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">64701687401</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-17<span class="w"> </span><span class="m">08</span>:30:02<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="p">|</span><span class="w"> </span>inc_bk<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">64701439242</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">64701757198</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-18<span class="w"> </span><span class="m">08</span>:30:04<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="p">|</span><span class="w"> </span>inc_bk<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">64701439242</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">64701846068</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-19<span class="w"> </span><span class="m">08</span>:30:02<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="p">|</span><span class="w"> </span>inc_bk<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">64701439242</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">64701908176</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-20<span class="w"> </span><span class="m">08</span>:30:05<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="p">|</span><span class="w"> </span>full_bk<span class="w"> </span><span class="p">|</span><span class="w">               </span><span class="m">0</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">64701970385</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-21<span class="w"> </span><span class="m">08</span>:30:01<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="p">|</span><span class="w"> </span>inc_bk<span class="w">  </span><span class="p">|</span><span class="w">     </span><span class="m">64701970385</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="m">64702034882</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">2021</span>-12-22<span class="w"> </span><span class="m">08</span>:30:02<span class="w"> </span><span class="p">|</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a>+---------+-----------------+---------------+---------------------+
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="m">10</span><span class="w"> </span>rows<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.00<span class="w"> </span>sec<span class="o">)</span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a>
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a><span class="m">10</span>:23:25<span class="w"> </span>root@localhost<span class="o">[</span>PERCONA_SCHEMA<span class="o">]</span>&gt;
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a>
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a>
</span><span id="__span-10-48"><a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a>@@<span class="w"> </span>拆包完全备份
</span><span id="__span-10-49"><a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a><span class="c1"># mkdir full-mysql5.7</span>
</span><span id="__span-10-50"><a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a><span class="o">[</span>root@test<span class="w"> </span>mysql5.7<span class="o">]</span><span class="c1"># xbstream -x &lt; full-mysql5.7-compress-2021-12-03.xbstream  -C ./full-mysql5.7</span>
</span><span id="__span-10-51"><a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a>
</span><span id="__span-10-52"><a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a>@@<span class="w"> </span>解压拆包后的完全备份<span class="w"> </span><span class="o">(</span>可使用<span class="w"> </span>--remove-original<span class="w"> </span>来删除压缩的源文件<span class="o">)</span>
</span><span id="__span-10-53"><a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a><span class="o">[</span>root@test<span class="w"> </span>mysql5.7<span class="o">]</span><span class="c1"># xtrabackup --decompress --remove-original --target-dir=./full-mysql5.7</span>
</span><span id="__span-10-54"><a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a>
</span><span id="__span-10-55"><a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a>
</span><span id="__span-10-56"><a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a>@@<span class="w"> </span>拆包增量备份
</span><span id="__span-10-57"><a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a><span class="o">[</span>root@test<span class="w"> </span>inc1<span class="o">]</span><span class="c1"># mkdir inc1-mysql5.7-2021-12-03</span>
</span><span id="__span-10-58"><a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a><span class="o">[</span>root@test<span class="w"> </span>inc1<span class="o">]</span><span class="c1"># xbstream -x &lt; inc1-mysql5.7-2021-12-03-16-09.xbstream -C ./inc1-mysql5.7-2021-12-03</span>
</span><span id="__span-10-59"><a id="__codelineno-10-59" name="__codelineno-10-59" href="#__codelineno-10-59"></a>
</span><span id="__span-10-60"><a id="__codelineno-10-60" name="__codelineno-10-60" href="#__codelineno-10-60"></a>@@<span class="w"> </span>解压拆包后的增量备份
</span><span id="__span-10-61"><a id="__codelineno-10-61" name="__codelineno-10-61" href="#__codelineno-10-61"></a><span class="o">[</span>root@<span class="w"> </span>inc1<span class="o">]</span><span class="c1"># xtrabackup --decompress --remove-original --target-dir=./inc1-mysql5.7-2021-12-03</span>
</span><span id="__span-10-62"><a id="__codelineno-10-62" name="__codelineno-10-62" href="#__codelineno-10-62"></a>
</span><span id="__span-10-63"><a id="__codelineno-10-63" name="__codelineno-10-63" href="#__codelineno-10-63"></a>
</span><span id="__span-10-64"><a id="__codelineno-10-64" name="__codelineno-10-64" href="#__codelineno-10-64"></a>@@<span class="w"> </span>准备完全备份目录
</span><span id="__span-10-65"><a id="__codelineno-10-65" name="__codelineno-10-65" href="#__codelineno-10-65"></a><span class="w">  </span>-<span class="w"> </span>完全备份目录:full-mysql5.7
</span><span id="__span-10-66"><a id="__codelineno-10-66" name="__codelineno-10-66" href="#__codelineno-10-66"></a>
</span><span id="__span-10-67"><a id="__codelineno-10-67" name="__codelineno-10-67" href="#__codelineno-10-67"></a><span class="o">[</span>root@test<span class="w"> </span>mysql5.7<span class="o">]</span><span class="c1"># xtrabackup --prepare --apply-log-only --target-dir=./full-mysql5.7</span>
</span><span id="__span-10-68"><a id="__codelineno-10-68" name="__codelineno-10-68" href="#__codelineno-10-68"></a>trabackup:<span class="w"> </span>starting<span class="w"> </span>shutdown<span class="w"> </span>with<span class="w"> </span><span class="nv">innodb_fast_shutdown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-10-69"><a id="__codelineno-10-69" name="__codelineno-10-69" href="#__codelineno-10-69"></a>InnoDB:<span class="w"> </span>Starting<span class="w"> </span>shutdown...
</span><span id="__span-10-70"><a id="__codelineno-10-70" name="__codelineno-10-70" href="#__codelineno-10-70"></a>InnoDB:<span class="w"> </span>Shutdown<span class="w"> </span>completed<span class="p">;</span><span class="w"> </span>log<span class="w"> </span>sequence<span class="w"> </span>number<span class="w"> </span><span class="m">639056296830</span>
</span><span id="__span-10-71"><a id="__codelineno-10-71" name="__codelineno-10-71" href="#__codelineno-10-71"></a>InnoDB:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>pools:<span class="w"> </span><span class="m">1</span>
</span><span id="__span-10-72"><a id="__codelineno-10-72" name="__codelineno-10-72" href="#__codelineno-10-72"></a><span class="m">211203</span><span class="w"> </span><span class="m">16</span>:35:55<span class="w"> </span>completed<span class="w"> </span>OK!
</span><span id="__span-10-73"><a id="__codelineno-10-73" name="__codelineno-10-73" href="#__codelineno-10-73"></a>
</span><span id="__span-10-74"><a id="__codelineno-10-74" name="__codelineno-10-74" href="#__codelineno-10-74"></a>@@<span class="w"> </span>执行第一次的增量备份<span class="o">(</span>这里既是第一次增量备份,也是最后一次增量备份<span class="o">)</span>
</span><span id="__span-10-75"><a id="__codelineno-10-75" name="__codelineno-10-75" href="#__codelineno-10-75"></a><span class="w">  </span>-<span class="w"> </span>无apply-log-only
</span><span id="__span-10-76"><a id="__codelineno-10-76" name="__codelineno-10-76" href="#__codelineno-10-76"></a><span class="w">  </span>-<span class="w"> </span>完全备份目录:full-mysql5.7
</span><span id="__span-10-77"><a id="__codelineno-10-77" name="__codelineno-10-77" href="#__codelineno-10-77"></a><span class="w">  </span>-<span class="w"> </span>增量备份目录:inc1-mysql5.7-2021-12-03
</span><span id="__span-10-78"><a id="__codelineno-10-78" name="__codelineno-10-78" href="#__codelineno-10-78"></a>
</span><span id="__span-10-79"><a id="__codelineno-10-79" name="__codelineno-10-79" href="#__codelineno-10-79"></a><span class="o">[</span>root@test<span class="w"> </span>mysql5.7<span class="o">]</span><span class="c1"># xtrabackup --prepare --target-dir=full-mysql5.7 --incremental-dir=inc1/inc1-mysql5.7-2021-12-03</span>
</span><span id="__span-10-80"><a id="__codelineno-10-80" name="__codelineno-10-80" href="#__codelineno-10-80"></a>InnoDB:<span class="w"> </span><span class="m">5</span>.7.32<span class="w"> </span>started<span class="p">;</span><span class="w"> </span>log<span class="w"> </span>sequence<span class="w"> </span>number<span class="w"> </span><span class="m">639056306197</span>
</span><span id="__span-10-81"><a id="__codelineno-10-81" name="__codelineno-10-81" href="#__codelineno-10-81"></a>xtrabackup:<span class="w"> </span>starting<span class="w"> </span>shutdown<span class="w"> </span>with<span class="w"> </span><span class="nv">innodb_fast_shutdown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-10-82"><a id="__codelineno-10-82" name="__codelineno-10-82" href="#__codelineno-10-82"></a>InnoDB:<span class="w"> </span>FTS<span class="w"> </span>optimize<span class="w"> </span>thread<span class="w"> </span>exiting.
</span><span id="__span-10-83"><a id="__codelineno-10-83" name="__codelineno-10-83" href="#__codelineno-10-83"></a>InnoDB:<span class="w"> </span>Starting<span class="w"> </span>shutdown...
</span><span id="__span-10-84"><a id="__codelineno-10-84" name="__codelineno-10-84" href="#__codelineno-10-84"></a>InnoDB:<span class="w"> </span>Shutdown<span class="w"> </span>completed<span class="p">;</span><span class="w"> </span>log<span class="w"> </span>sequence<span class="w"> </span>number<span class="w"> </span><span class="m">639056309393</span>
</span><span id="__span-10-85"><a id="__codelineno-10-85" name="__codelineno-10-85" href="#__codelineno-10-85"></a><span class="m">211203</span><span class="w"> </span><span class="m">16</span>:38:15<span class="w"> </span>completed<span class="w"> </span>OK!
</span><span id="__span-10-86"><a id="__codelineno-10-86" name="__codelineno-10-86" href="#__codelineno-10-86"></a><span class="o">[</span>root@rs-os1a-backup1<span class="w"> </span>mysql318<span class="o">]</span><span class="c1">#</span>
</span><span id="__span-10-87"><a id="__codelineno-10-87" name="__codelineno-10-87" href="#__codelineno-10-87"></a>
</span><span id="__span-10-88"><a id="__codelineno-10-88" name="__codelineno-10-88" href="#__codelineno-10-88"></a>
</span><span id="__span-10-89"><a id="__codelineno-10-89" name="__codelineno-10-89" href="#__codelineno-10-89"></a><span class="c1"># 从备份文件恢复</span>
</span><span id="__span-10-90"><a id="__codelineno-10-90" name="__codelineno-10-90" href="#__codelineno-10-90"></a><span class="w">  </span>-<span class="w"> </span>首先把准备好的完全备份目录<span class="o">(</span>已执行过增量准备<span class="o">)</span>传到对应的主机<span class="o">(</span>需要恢复的主机<span class="o">)</span>
</span><span id="__span-10-91"><a id="__codelineno-10-91" name="__codelineno-10-91" href="#__codelineno-10-91"></a><span class="w">  </span>-<span class="w"> </span>stop<span class="w"> </span>mysqld
</span><span id="__span-10-92"><a id="__codelineno-10-92" name="__codelineno-10-92" href="#__codelineno-10-92"></a><span class="w">  </span>-<span class="w"> </span>清空数据库所在目录.<span class="w"> </span>或使用<span class="w"> </span>--force-non-empty-directories<span class="w"> </span>选项.
</span><span id="__span-10-93"><a id="__codelineno-10-93" name="__codelineno-10-93" href="#__codelineno-10-93"></a>
</span><span id="__span-10-94"><a id="__codelineno-10-94" name="__codelineno-10-94" href="#__codelineno-10-94"></a><span class="c1"># 开始恢复数据</span>
</span><span id="__span-10-95"><a id="__codelineno-10-95" name="__codelineno-10-95" href="#__codelineno-10-95"></a><span class="w">  </span>-<span class="w"> </span>只需指定备份目录,不需要指定mysql<span class="w"> </span>datadir<span class="w"> </span>目录,<span class="w"> </span>extrabackup会根据备份文件中的设置文件自行寻找.
</span><span id="__span-10-96"><a id="__codelineno-10-96" name="__codelineno-10-96" href="#__codelineno-10-96"></a>$<span class="w"> </span>xtrabackup<span class="w"> </span>--copy-back<span class="w"> </span>/path/to/BACKUP-DIR
</span><span id="__span-10-97"><a id="__codelineno-10-97" name="__codelineno-10-97" href="#__codelineno-10-97"></a>
</span><span id="__span-10-98"><a id="__codelineno-10-98" name="__codelineno-10-98" href="#__codelineno-10-98"></a><span class="c1"># 恢复完成后要恢复数据库的权限</span>
</span><span id="__span-10-99"><a id="__codelineno-10-99" name="__codelineno-10-99" href="#__codelineno-10-99"></a>$<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span>mysql:mysql<span class="w"> </span>/home/mysql
</span><span id="__span-10-100"><a id="__codelineno-10-100" name="__codelineno-10-100" href="#__codelineno-10-100"></a>
</span><span id="__span-10-101"><a id="__codelineno-10-101" name="__codelineno-10-101" href="#__codelineno-10-101"></a><span class="c1"># 启动mysqld</span>
</span><span id="__span-10-102"><a id="__codelineno-10-102" name="__codelineno-10-102" href="#__codelineno-10-102"></a>$<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>mysqld
</span></code></pre></div></details>
</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2022 - 2023 - lyvivian0077
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.top", "navigation.indexes", "navigation.path", "content.code.copy", "toc.follow"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fac441b0.min.js"></script>
      
    
  </body>
</html>